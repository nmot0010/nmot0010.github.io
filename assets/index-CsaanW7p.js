(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const d of document.querySelectorAll('link[rel="modulepreload"]'))l(d);new MutationObserver(d=>{for(const f of d)if(f.type==="childList")for(const x of f.addedNodes)x.tagName==="LINK"&&x.rel==="modulepreload"&&l(x)}).observe(document,{childList:!0,subtree:!0});function n(d){const f={};return d.integrity&&(f.integrity=d.integrity),d.referrerPolicy&&(f.referrerPolicy=d.referrerPolicy),d.crossOrigin==="use-credentials"?f.credentials="include":d.crossOrigin==="anonymous"?f.credentials="omit":f.credentials="same-origin",f}function l(d){if(d.ep)return;d.ep=!0;const f=n(d);fetch(d.href,f)}})();/**
* @vue/shared v3.5.20
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**//*! #__NO_SIDE_EFFECTS__ */function CI(t){const e=Object.create(null);for(const n of t.split(","))e[n]=1;return n=>n in e}const wo={},yg=[],iu=()=>{},y4=()=>!1,Ww=t=>t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&(t.charCodeAt(2)>122||t.charCodeAt(2)<97),II=t=>t.startsWith("onUpdate:"),ks=Object.assign,AI=(t,e)=>{const n=t.indexOf(e);n>-1&&t.splice(n,1)},F9=Object.prototype.hasOwnProperty,co=(t,e)=>F9.call(t,e),Cr=Array.isArray,vg=t=>V0(t)==="[object Map]",Yg=t=>V0(t)==="[object Set]",wO=t=>V0(t)==="[object Date]",ri=t=>typeof t=="function",Go=t=>typeof t=="string",pc=t=>typeof t=="symbol",To=t=>t!==null&&typeof t=="object",v4=t=>(To(t)||ri(t))&&ri(t.then)&&ri(t.catch),b4=Object.prototype.toString,V0=t=>b4.call(t),B9=t=>V0(t).slice(8,-1),x4=t=>V0(t)==="[object Object]",PI=t=>Go(t)&&t!=="NaN"&&t[0]!=="-"&&""+parseInt(t,10)===t,mv=CI(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),qw=t=>{const e=Object.create(null);return(n=>e[n]||(e[n]=t(n)))},N9=/-(\w)/g,zl=qw(t=>t.replace(N9,(e,n)=>n?n.toUpperCase():"")),V9=/\B([A-Z])/g,rf=qw(t=>t.replace(V9,"-$1").toLowerCase()),Kw=qw(t=>t.charAt(0).toUpperCase()+t.slice(1)),Rx=qw(t=>t?`on${Kw(t)}`:""),Bh=(t,e)=>!Object.is(t,e),kx=(t,...e)=>{for(let n=0;n<t.length;n++)t[n](...e)},w4=(t,e,n,l=!1)=>{Object.defineProperty(t,e,{configurable:!0,enumerable:!1,writable:l,value:n})},tw=t=>{const e=parseFloat(t);return isNaN(e)?t:e},$9=t=>{const e=Go(t)?Number(t):NaN;return isNaN(e)?t:e};let TO;const Zw=()=>TO||(TO=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function $0(t){if(Cr(t)){const e={};for(let n=0;n<t.length;n++){const l=t[n],d=Go(l)?H9(l):$0(l);if(d)for(const f in d)e[f]=d[f]}return e}else if(Go(t)||To(t))return t}const U9=/;(?![^(]*\))/g,j9=/:([^]+)/,G9=/\/\*[^]*?\*\//g;function H9(t){const e={};return t.replace(G9,"").split(U9).forEach(n=>{if(n){const l=n.split(j9);l.length>1&&(e[l[0].trim()]=l[1].trim())}}),e}function wr(t){let e="";if(Go(t))e=t;else if(Cr(t))for(let n=0;n<t.length;n++){const l=wr(t[n]);l&&(e+=l+" ")}else if(To(t))for(const n in t)t[n]&&(e+=n+" ");return e.trim()}function Xw(t){if(!t)return null;let{class:e,style:n}=t;return e&&!Go(e)&&(t.class=wr(e)),n&&(t.style=$0(n)),t}const W9="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",q9=CI(W9);function T4(t){return!!t||t===""}function K9(t,e){if(t.length!==e.length)return!1;let n=!0;for(let l=0;n&&l<t.length;l++)n=U0(t[l],e[l]);return n}function U0(t,e){if(t===e)return!0;let n=wO(t),l=wO(e);if(n||l)return n&&l?t.getTime()===e.getTime():!1;if(n=pc(t),l=pc(e),n||l)return t===e;if(n=Cr(t),l=Cr(e),n||l)return n&&l?K9(t,e):!1;if(n=To(t),l=To(e),n||l){if(!n||!l)return!1;const d=Object.keys(t).length,f=Object.keys(e).length;if(d!==f)return!1;for(const x in t){const s=t.hasOwnProperty(x),C=e.hasOwnProperty(x);if(s&&!C||!s&&C||!U0(t[x],e[x]))return!1}}return String(t)===String(e)}function RI(t,e){return t.findIndex(n=>U0(n,e))}const S4=t=>!!(t&&t.__v_isRef===!0),Fr=t=>Go(t)?t:t==null?"":Cr(t)||To(t)&&(t.toString===b4||!ri(t.toString))?S4(t)?Fr(t.value):JSON.stringify(t,E4,2):String(t),E4=(t,e)=>S4(e)?E4(t,e.value):vg(e)?{[`Map(${e.size})`]:[...e.entries()].reduce((n,[l,d],f)=>(n[qE(l,f)+" =>"]=d,n),{})}:Yg(e)?{[`Set(${e.size})`]:[...e.values()].map(n=>qE(n))}:pc(e)?qE(e):To(e)&&!Cr(e)&&!x4(e)?String(e):e,qE=(t,e="")=>{var n;return pc(t)?`Symbol(${(n=t.description)!=null?n:e})`:t};/**
* @vue/reactivity v3.5.20
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let Va;class C4{constructor(e=!1){this.detached=e,this._active=!0,this._on=0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=Va,!e&&Va&&(this.index=(Va.scopes||(Va.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let e,n;if(this.scopes)for(e=0,n=this.scopes.length;e<n;e++)this.scopes[e].pause();for(e=0,n=this.effects.length;e<n;e++)this.effects[e].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let e,n;if(this.scopes)for(e=0,n=this.scopes.length;e<n;e++)this.scopes[e].resume();for(e=0,n=this.effects.length;e<n;e++)this.effects[e].resume()}}run(e){if(this._active){const n=Va;try{return Va=this,e()}finally{Va=n}}}on(){++this._on===1&&(this.prevScope=Va,Va=this)}off(){this._on>0&&--this._on===0&&(Va=this.prevScope,this.prevScope=void 0)}stop(e){if(this._active){this._active=!1;let n,l;for(n=0,l=this.effects.length;n<l;n++)this.effects[n].stop();for(this.effects.length=0,n=0,l=this.cleanups.length;n<l;n++)this.cleanups[n]();if(this.cleanups.length=0,this.scopes){for(n=0,l=this.scopes.length;n<l;n++)this.scopes[n].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!e){const d=this.parent.scopes.pop();d&&d!==this&&(this.parent.scopes[this.index]=d,d.index=this.index)}this.parent=void 0}}}function Z9(t){return new C4(t)}function X9(){return Va}let Ro;const KE=new WeakSet;class I4{constructor(e){this.fn=e,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,Va&&Va.active&&Va.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,KE.has(this)&&(KE.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||P4(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,SO(this),R4(this);const e=Ro,n=hc;Ro=this,hc=!0;try{return this.fn()}finally{k4(this),Ro=e,hc=n,this.flags&=-3}}stop(){if(this.flags&1){for(let e=this.deps;e;e=e.nextDep)MI(e);this.deps=this.depsTail=void 0,SO(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?KE.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){NC(this)&&this.run()}get dirty(){return NC(this)}}let A4=0,gv,_v;function P4(t,e=!1){if(t.flags|=8,e){t.next=_v,_v=t;return}t.next=gv,gv=t}function kI(){A4++}function OI(){if(--A4>0)return;if(_v){let e=_v;for(_v=void 0;e;){const n=e.next;e.next=void 0,e.flags&=-9,e=n}}let t;for(;gv;){let e=gv;for(gv=void 0;e;){const n=e.next;if(e.next=void 0,e.flags&=-9,e.flags&1)try{e.trigger()}catch(l){t||(t=l)}e=n}}if(t)throw t}function R4(t){for(let e=t.deps;e;e=e.nextDep)e.version=-1,e.prevActiveLink=e.dep.activeLink,e.dep.activeLink=e}function k4(t){let e,n=t.depsTail,l=n;for(;l;){const d=l.prevDep;l.version===-1?(l===n&&(n=d),MI(l),Y9(l)):e=l,l.dep.activeLink=l.prevActiveLink,l.prevActiveLink=void 0,l=d}t.deps=e,t.depsTail=n}function NC(t){for(let e=t.deps;e;e=e.nextDep)if(e.dep.version!==e.version||e.dep.computed&&(O4(e.dep.computed)||e.dep.version!==e.version))return!0;return!!t._dirty}function O4(t){if(t.flags&4&&!(t.flags&16)||(t.flags&=-17,t.globalVersion===Lv)||(t.globalVersion=Lv,!t.isSSR&&t.flags&128&&(!t.deps&&!t._dirty||!NC(t))))return;t.flags|=2;const e=t.dep,n=Ro,l=hc;Ro=t,hc=!0;try{R4(t);const d=t.fn(t._value);(e.version===0||Bh(d,t._value))&&(t.flags|=128,t._value=d,e.version++)}catch(d){throw e.version++,d}finally{Ro=n,hc=l,k4(t),t.flags&=-3}}function MI(t,e=!1){const{dep:n,prevSub:l,nextSub:d}=t;if(l&&(l.nextSub=d,t.prevSub=void 0),d&&(d.prevSub=l,t.nextSub=void 0),n.subs===t&&(n.subs=l,!l&&n.computed)){n.computed.flags&=-5;for(let f=n.computed.deps;f;f=f.nextDep)MI(f,!0)}!e&&!--n.sc&&n.map&&n.map.delete(n.key)}function Y9(t){const{prevDep:e,nextDep:n}=t;e&&(e.nextDep=n,t.prevDep=void 0),n&&(n.prevDep=e,t.nextDep=void 0)}let hc=!0;const M4=[];function yd(){M4.push(hc),hc=!1}function vd(){const t=M4.pop();hc=t===void 0?!0:t}function SO(t){const{cleanup:e}=t;if(t.cleanup=void 0,e){const n=Ro;Ro=void 0;try{e()}finally{Ro=n}}}let Lv=0;class J9{constructor(e,n){this.sub=e,this.dep=n,this.version=n.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class DI{constructor(e){this.computed=e,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0,this.__v_skip=!0}track(e){if(!Ro||!hc||Ro===this.computed)return;let n=this.activeLink;if(n===void 0||n.sub!==Ro)n=this.activeLink=new J9(Ro,this),Ro.deps?(n.prevDep=Ro.depsTail,Ro.depsTail.nextDep=n,Ro.depsTail=n):Ro.deps=Ro.depsTail=n,D4(n);else if(n.version===-1&&(n.version=this.version,n.nextDep)){const l=n.nextDep;l.prevDep=n.prevDep,n.prevDep&&(n.prevDep.nextDep=l),n.prevDep=Ro.depsTail,n.nextDep=void 0,Ro.depsTail.nextDep=n,Ro.depsTail=n,Ro.deps===n&&(Ro.deps=l)}return n}trigger(e){this.version++,Lv++,this.notify(e)}notify(e){kI();try{for(let n=this.subs;n;n=n.prevSub)n.sub.notify()&&n.sub.dep.notify()}finally{OI()}}}function D4(t){if(t.dep.sc++,t.sub.flags&4){const e=t.dep.computed;if(e&&!t.dep.subs){e.flags|=20;for(let l=e.deps;l;l=l.nextDep)D4(l)}const n=t.dep.subs;n!==t&&(t.prevSub=n,n&&(n.nextSub=t)),t.dep.subs=t}}const VC=new WeakMap,up=Symbol(""),$C=Symbol(""),zv=Symbol("");function ia(t,e,n){if(hc&&Ro){let l=VC.get(t);l||VC.set(t,l=new Map);let d=l.get(n);d||(l.set(n,d=new DI),d.map=l,d.key=n),d.track()}}function cd(t,e,n,l,d,f){const x=VC.get(t);if(!x){Lv++;return}const s=C=>{C&&C.trigger()};if(kI(),e==="clear")x.forEach(s);else{const C=Cr(t),P=C&&PI(n);if(C&&n==="length"){const L=Number(l);x.forEach(($,V)=>{(V==="length"||V===zv||!pc(V)&&V>=L)&&s($)})}else switch((n!==void 0||x.has(void 0))&&s(x.get(n)),P&&s(x.get(zv)),e){case"add":C?P&&s(x.get("length")):(s(x.get(up)),vg(t)&&s(x.get($C)));break;case"delete":C||(s(x.get(up)),vg(t)&&s(x.get($C)));break;case"set":vg(t)&&s(x.get(up));break}}OI()}function Qm(t){const e=io(t);return e===t?e:(ia(e,"iterate",zv),Dl(t)?e:e.map($s))}function Yw(t){return ia(t=io(t),"iterate",zv),t}const Q9={__proto__:null,[Symbol.iterator](){return ZE(this,Symbol.iterator,$s)},concat(...t){return Qm(this).concat(...t.map(e=>Cr(e)?Qm(e):e))},entries(){return ZE(this,"entries",t=>(t[1]=$s(t[1]),t))},every(t,e){return rd(this,"every",t,e,void 0,arguments)},filter(t,e){return rd(this,"filter",t,e,n=>n.map($s),arguments)},find(t,e){return rd(this,"find",t,e,$s,arguments)},findIndex(t,e){return rd(this,"findIndex",t,e,void 0,arguments)},findLast(t,e){return rd(this,"findLast",t,e,$s,arguments)},findLastIndex(t,e){return rd(this,"findLastIndex",t,e,void 0,arguments)},forEach(t,e){return rd(this,"forEach",t,e,void 0,arguments)},includes(...t){return XE(this,"includes",t)},indexOf(...t){return XE(this,"indexOf",t)},join(t){return Qm(this).join(t)},lastIndexOf(...t){return XE(this,"lastIndexOf",t)},map(t,e){return rd(this,"map",t,e,void 0,arguments)},pop(){return Ky(this,"pop")},push(...t){return Ky(this,"push",t)},reduce(t,...e){return EO(this,"reduce",t,e)},reduceRight(t,...e){return EO(this,"reduceRight",t,e)},shift(){return Ky(this,"shift")},some(t,e){return rd(this,"some",t,e,void 0,arguments)},splice(...t){return Ky(this,"splice",t)},toReversed(){return Qm(this).toReversed()},toSorted(t){return Qm(this).toSorted(t)},toSpliced(...t){return Qm(this).toSpliced(...t)},unshift(...t){return Ky(this,"unshift",t)},values(){return ZE(this,"values",$s)}};function ZE(t,e,n){const l=Yw(t),d=l[e]();return l!==t&&!Dl(t)&&(d._next=d.next,d.next=()=>{const f=d._next();return f.value&&(f.value=n(f.value)),f}),d}const eU=Array.prototype;function rd(t,e,n,l,d,f){const x=Yw(t),s=x!==t&&!Dl(t),C=x[e];if(C!==eU[e]){const $=C.apply(t,f);return s?$s($):$}let P=n;x!==t&&(s?P=function($,V){return n.call(this,$s($),V,t)}:n.length>2&&(P=function($,V){return n.call(this,$,V,t)}));const L=C.call(x,P,l);return s&&d?d(L):L}function EO(t,e,n,l){const d=Yw(t);let f=n;return d!==t&&(Dl(t)?n.length>3&&(f=function(x,s,C){return n.call(this,x,s,C,t)}):f=function(x,s,C){return n.call(this,x,$s(s),C,t)}),d[e](f,...l)}function XE(t,e,n){const l=io(t);ia(l,"iterate",zv);const d=l[e](...n);return(d===-1||d===!1)&&BI(n[0])?(n[0]=io(n[0]),l[e](...n)):d}function Ky(t,e,n=[]){yd(),kI();const l=io(t)[e].apply(t,n);return OI(),vd(),l}const tU=CI("__proto__,__v_isRef,__isVue"),L4=new Set(Object.getOwnPropertyNames(Symbol).filter(t=>t!=="arguments"&&t!=="caller").map(t=>Symbol[t]).filter(pc));function nU(t){pc(t)||(t=String(t));const e=io(this);return ia(e,"has",t),e.hasOwnProperty(t)}class z4{constructor(e=!1,n=!1){this._isReadonly=e,this._isShallow=n}get(e,n,l){if(n==="__v_skip")return e.__v_skip;const d=this._isReadonly,f=this._isShallow;if(n==="__v_isReactive")return!d;if(n==="__v_isReadonly")return d;if(n==="__v_isShallow")return f;if(n==="__v_raw")return l===(d?f?hU:V4:f?N4:B4).get(e)||Object.getPrototypeOf(e)===Object.getPrototypeOf(l)?e:void 0;const x=Cr(e);if(!d){let C;if(x&&(C=Q9[n]))return C;if(n==="hasOwnProperty")return nU}const s=Reflect.get(e,n,aa(e)?e:l);return(pc(n)?L4.has(n):tU(n))||(d||ia(e,"get",n),f)?s:aa(s)?x&&PI(n)?s:s.value:To(s)?d?zI(s):Fl(s):s}}class F4 extends z4{constructor(e=!1){super(!1,e)}set(e,n,l,d){let f=e[n];if(!this._isShallow){const C=jh(f);if(!Dl(l)&&!jh(l)&&(f=io(f),l=io(l)),!Cr(e)&&aa(f)&&!aa(l))return C||(f.value=l),!0}const x=Cr(e)&&PI(n)?Number(n)<e.length:co(e,n),s=Reflect.set(e,n,l,aa(e)?e:d);return e===io(d)&&(x?Bh(l,f)&&cd(e,"set",n,l):cd(e,"add",n,l)),s}deleteProperty(e,n){const l=co(e,n);e[n];const d=Reflect.deleteProperty(e,n);return d&&l&&cd(e,"delete",n,void 0),d}has(e,n){const l=Reflect.has(e,n);return(!pc(n)||!L4.has(n))&&ia(e,"has",n),l}ownKeys(e){return ia(e,"iterate",Cr(e)?"length":up),Reflect.ownKeys(e)}}class rU extends z4{constructor(e=!1){super(!0,e)}set(e,n){return!0}deleteProperty(e,n){return!0}}const iU=new F4,oU=new rU,sU=new F4(!0);const UC=t=>t,nx=t=>Reflect.getPrototypeOf(t);function aU(t,e,n){return function(...l){const d=this.__v_raw,f=io(d),x=vg(f),s=t==="entries"||t===Symbol.iterator&&x,C=t==="keys"&&x,P=d[t](...l),L=n?UC:e?nw:$s;return!e&&ia(f,"iterate",C?$C:up),{next(){const{value:$,done:V}=P.next();return V?{value:$,done:V}:{value:s?[L($[0]),L($[1])]:L($),done:V}},[Symbol.iterator](){return this}}}}function rx(t){return function(...e){return t==="delete"?!1:t==="clear"?void 0:this}}function lU(t,e){const n={get(d){const f=this.__v_raw,x=io(f),s=io(d);t||(Bh(d,s)&&ia(x,"get",d),ia(x,"get",s));const{has:C}=nx(x),P=e?UC:t?nw:$s;if(C.call(x,d))return P(f.get(d));if(C.call(x,s))return P(f.get(s));f!==x&&f.get(d)},get size(){const d=this.__v_raw;return!t&&ia(io(d),"iterate",up),d.size},has(d){const f=this.__v_raw,x=io(f),s=io(d);return t||(Bh(d,s)&&ia(x,"has",d),ia(x,"has",s)),d===s?f.has(d):f.has(d)||f.has(s)},forEach(d,f){const x=this,s=x.__v_raw,C=io(s),P=e?UC:t?nw:$s;return!t&&ia(C,"iterate",up),s.forEach((L,$)=>d.call(f,P(L),P($),x))}};return ks(n,t?{add:rx("add"),set:rx("set"),delete:rx("delete"),clear:rx("clear")}:{add(d){!e&&!Dl(d)&&!jh(d)&&(d=io(d));const f=io(this);return nx(f).has.call(f,d)||(f.add(d),cd(f,"add",d,d)),this},set(d,f){!e&&!Dl(f)&&!jh(f)&&(f=io(f));const x=io(this),{has:s,get:C}=nx(x);let P=s.call(x,d);P||(d=io(d),P=s.call(x,d));const L=C.call(x,d);return x.set(d,f),P?Bh(f,L)&&cd(x,"set",d,f):cd(x,"add",d,f),this},delete(d){const f=io(this),{has:x,get:s}=nx(f);let C=x.call(f,d);C||(d=io(d),C=x.call(f,d)),s&&s.call(f,d);const P=f.delete(d);return C&&cd(f,"delete",d,void 0),P},clear(){const d=io(this),f=d.size!==0,x=d.clear();return f&&cd(d,"clear",void 0,void 0),x}}),["keys","values","entries",Symbol.iterator].forEach(d=>{n[d]=aU(d,t,e)}),n}function LI(t,e){const n=lU(t,e);return(l,d,f)=>d==="__v_isReactive"?!t:d==="__v_isReadonly"?t:d==="__v_raw"?l:Reflect.get(co(n,d)&&d in l?n:l,d,f)}const cU={get:LI(!1,!1)},uU={get:LI(!1,!0)},dU={get:LI(!0,!1)};const B4=new WeakMap,N4=new WeakMap,V4=new WeakMap,hU=new WeakMap;function fU(t){switch(t){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function pU(t){return t.__v_skip||!Object.isExtensible(t)?0:fU(B9(t))}function Fl(t){return jh(t)?t:FI(t,!1,iU,cU,B4)}function $4(t){return FI(t,!1,sU,uU,N4)}function zI(t){return FI(t,!0,oU,dU,V4)}function FI(t,e,n,l,d){if(!To(t)||t.__v_raw&&!(e&&t.__v_isReactive))return t;const f=pU(t);if(f===0)return t;const x=d.get(t);if(x)return x;const s=new Proxy(t,f===2?l:n);return d.set(t,s),s}function bg(t){return jh(t)?bg(t.__v_raw):!!(t&&t.__v_isReactive)}function jh(t){return!!(t&&t.__v_isReadonly)}function Dl(t){return!!(t&&t.__v_isShallow)}function BI(t){return t?!!t.__v_raw:!1}function io(t){const e=t&&t.__v_raw;return e?io(e):t}function U4(t){return!co(t,"__v_skip")&&Object.isExtensible(t)&&w4(t,"__v_skip",!0),t}const $s=t=>To(t)?Fl(t):t,nw=t=>To(t)?zI(t):t;function aa(t){return t?t.__v_isRef===!0:!1}function bi(t){return j4(t,!1)}function mU(t){return j4(t,!0)}function j4(t,e){return aa(t)?t:new gU(t,e)}class gU{constructor(e,n){this.dep=new DI,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=n?e:io(e),this._value=n?e:$s(e),this.__v_isShallow=n}get value(){return this.dep.track(),this._value}set value(e){const n=this._rawValue,l=this.__v_isShallow||Dl(e)||jh(e);e=l?e:io(e),Bh(e,n)&&(this._rawValue=e,this._value=l?e:$s(e),this.dep.trigger())}}function Ai(t){return aa(t)?t.value:t}const _U={get:(t,e,n)=>e==="__v_raw"?t:Ai(Reflect.get(t,e,n)),set:(t,e,n,l)=>{const d=t[e];return aa(d)&&!aa(n)?(d.value=n,!0):Reflect.set(t,e,n,l)}};function G4(t){return bg(t)?t:new Proxy(t,_U)}class yU{constructor(e,n,l){this.fn=e,this.setter=n,this._value=void 0,this.dep=new DI(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=Lv-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!n,this.isSSR=l}notify(){if(this.flags|=16,!(this.flags&8)&&Ro!==this)return P4(this,!0),!0}get value(){const e=this.dep.track();return O4(this),e&&(e.version=this.dep.version),this._value}set value(e){this.setter&&this.setter(e)}}function vU(t,e,n=!1){let l,d;return ri(t)?l=t:(l=t.get,d=t.set),new yU(l,d,n)}const ix={},rw=new WeakMap;let tp;function bU(t,e=!1,n=tp){if(n){let l=rw.get(n);l||rw.set(n,l=[]),l.push(t)}}function xU(t,e,n=wo){const{immediate:l,deep:d,once:f,scheduler:x,augmentJob:s,call:C}=n,P=Ne=>d?Ne:Dl(Ne)||d===!1||d===0?ud(Ne,1):ud(Ne);let L,$,V,j,ue=!1,de=!1;if(aa(t)?($=()=>t.value,ue=Dl(t)):bg(t)?($=()=>P(t),ue=!0):Cr(t)?(de=!0,ue=t.some(Ne=>bg(Ne)||Dl(Ne)),$=()=>t.map(Ne=>{if(aa(Ne))return Ne.value;if(bg(Ne))return P(Ne);if(ri(Ne))return C?C(Ne,2):Ne()})):ri(t)?e?$=C?()=>C(t,2):t:$=()=>{if(V){yd();try{V()}finally{vd()}}const Ne=tp;tp=L;try{return C?C(t,3,[j]):t(j)}finally{tp=Ne}}:$=iu,e&&d){const Ne=$,Mt=d===!0?1/0:d;$=()=>ud(Ne(),Mt)}const Te=X9(),Be=()=>{L.stop(),Te&&Te.active&&AI(Te.effects,L)};if(f&&e){const Ne=e;e=(...Mt)=>{Ne(...Mt),Be()}}let Ge=de?new Array(t.length).fill(ix):ix;const Ye=Ne=>{if(!(!(L.flags&1)||!L.dirty&&!Ne))if(e){const Mt=L.run();if(d||ue||(de?Mt.some((kt,Pe)=>Bh(kt,Ge[Pe])):Bh(Mt,Ge))){V&&V();const kt=tp;tp=L;try{const Pe=[Mt,Ge===ix?void 0:de&&Ge[0]===ix?[]:Ge,j];Ge=Mt,C?C(e,3,Pe):e(...Pe)}finally{tp=kt}}}else L.run()};return s&&s(Ye),L=new I4($),L.scheduler=x?()=>x(Ye,!1):Ye,j=Ne=>bU(Ne,!1,L),V=L.onStop=()=>{const Ne=rw.get(L);if(Ne){if(C)C(Ne,4);else for(const Mt of Ne)Mt();rw.delete(L)}},e?l?Ye(!0):Ge=L.run():x?x(Ye.bind(null,!0),!0):L.run(),Be.pause=L.pause.bind(L),Be.resume=L.resume.bind(L),Be.stop=Be,Be}function ud(t,e=1/0,n){if(e<=0||!To(t)||t.__v_skip||(n=n||new Set,n.has(t)))return t;if(n.add(t),e--,aa(t))ud(t.value,e,n);else if(Cr(t))for(let l=0;l<t.length;l++)ud(t[l],e,n);else if(Yg(t)||vg(t))t.forEach(l=>{ud(l,e,n)});else if(x4(t)){for(const l in t)ud(t[l],e,n);for(const l of Object.getOwnPropertySymbols(t))Object.prototype.propertyIsEnumerable.call(t,l)&&ud(t[l],e,n)}return t}/**
* @vue/runtime-core v3.5.20
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function j0(t,e,n,l){try{return l?t(...l):t()}catch(d){Jw(d,e,n)}}function mc(t,e,n,l){if(ri(t)){const d=j0(t,e,n,l);return d&&v4(d)&&d.catch(f=>{Jw(f,e,n)}),d}if(Cr(t)){const d=[];for(let f=0;f<t.length;f++)d.push(mc(t[f],e,n,l));return d}}function Jw(t,e,n,l=!0){const d=e?e.vnode:null,{errorHandler:f,throwUnhandledErrorInProduction:x}=e&&e.appContext.config||wo;if(e){let s=e.parent;const C=e.proxy,P=`https://vuejs.org/error-reference/#runtime-${n}`;for(;s;){const L=s.ec;if(L){for(let $=0;$<L.length;$++)if(L[$](t,C,P)===!1)return}s=s.parent}if(f){yd(),j0(f,null,10,[t,C,P]),vd();return}}wU(t,n,d,l,x)}function wU(t,e,n,l=!0,d=!1){if(d)throw t;console.error(t)}const Ca=[];let Jc=-1;const xg=[];let Th=null,ng=0;const H4=Promise.resolve();let iw=null;function G0(t){const e=iw||H4;return t?e.then(this?t.bind(this):t):e}function TU(t){let e=Jc+1,n=Ca.length;for(;e<n;){const l=e+n>>>1,d=Ca[l],f=Fv(d);f<t||f===t&&d.flags&2?e=l+1:n=l}return e}function NI(t){if(!(t.flags&1)){const e=Fv(t),n=Ca[Ca.length-1];!n||!(t.flags&2)&&e>=Fv(n)?Ca.push(t):Ca.splice(TU(e),0,t),t.flags|=1,W4()}}function W4(){iw||(iw=H4.then(K4))}function SU(t){Cr(t)?xg.push(...t):Th&&t.id===-1?Th.splice(ng+1,0,t):t.flags&1||(xg.push(t),t.flags|=1),W4()}function CO(t,e,n=Jc+1){for(;n<Ca.length;n++){const l=Ca[n];if(l&&l.flags&2){if(t&&l.id!==t.uid)continue;Ca.splice(n,1),n--,l.flags&4&&(l.flags&=-2),l(),l.flags&4||(l.flags&=-2)}}}function q4(t){if(xg.length){const e=[...new Set(xg)].sort((n,l)=>Fv(n)-Fv(l));if(xg.length=0,Th){Th.push(...e);return}for(Th=e,ng=0;ng<Th.length;ng++){const n=Th[ng];n.flags&4&&(n.flags&=-2),n.flags&8||n(),n.flags&=-2}Th=null,ng=0}}const Fv=t=>t.id==null?t.flags&2?-1:1/0:t.id;function K4(t){try{for(Jc=0;Jc<Ca.length;Jc++){const e=Ca[Jc];e&&!(e.flags&8)&&(e.flags&4&&(e.flags&=-2),j0(e,e.i,e.i?15:14),e.flags&4||(e.flags&=-2))}}finally{for(;Jc<Ca.length;Jc++){const e=Ca[Jc];e&&(e.flags&=-2)}Jc=-1,Ca.length=0,q4(),iw=null,(Ca.length||xg.length)&&K4()}}let js=null,Z4=null;function ow(t){const e=js;return js=t,Z4=t&&t.type.__scopeId||null,e}function zr(t,e=js,n){if(!e||t._n)return t;const l=(...d)=>{l._d&&VO(-1);const f=ow(e);let x;try{x=t(...d)}finally{ow(f),l._d&&VO(1)}return x};return l._n=!0,l._c=!0,l._d=!0,l}function Xi(t,e){if(js===null)return t;const n=rT(js),l=t.dirs||(t.dirs=[]);for(let d=0;d<e.length;d++){let[f,x,s,C=wo]=e[d];f&&(ri(f)&&(f={mounted:f,updated:f}),f.deep&&ud(x),l.push({dir:f,instance:n,value:x,oldValue:void 0,arg:s,modifiers:C}))}return t}function Xf(t,e,n,l){const d=t.dirs,f=e&&e.dirs;for(let x=0;x<d.length;x++){const s=d[x];f&&(s.oldValue=f[x].value);let C=s.dir[l];C&&(yd(),mc(C,n,8,[t.el,s,t,e]),vd())}}const X4=Symbol("_vte"),Y4=t=>t.__isTeleport,yv=t=>t&&(t.disabled||t.disabled===""),IO=t=>t&&(t.defer||t.defer===""),AO=t=>typeof SVGElement<"u"&&t instanceof SVGElement,PO=t=>typeof MathMLElement=="function"&&t instanceof MathMLElement,jC=(t,e)=>{const n=t&&t.to;return Go(n)?e?e(n):null:n},J4={name:"Teleport",__isTeleport:!0,process(t,e,n,l,d,f,x,s,C,P){const{mc:L,pc:$,pbc:V,o:{insert:j,querySelector:ue,createText:de,createComment:Te}}=P,Be=yv(e.props);let{shapeFlag:Ge,children:Ye,dynamicChildren:Ne}=e;if(t==null){const Mt=e.el=de(""),kt=e.anchor=de("");j(Mt,n,l),j(kt,n,l);const Pe=(Se,je)=>{Ge&16&&(d&&d.isCE&&(d.ce._teleportTarget=Se),L(Ye,Se,je,d,f,x,s,C))},we=()=>{const Se=e.target=jC(e.props,ue),je=Q4(Se,e,de,j);Se&&(x!=="svg"&&AO(Se)?x="svg":x!=="mathml"&&PO(Se)&&(x="mathml"),Be||(Pe(Se,je),Ox(e,!1)))};Be&&(Pe(n,kt),Ox(e,!0)),IO(e.props)?(e.el.__isMounted=!1,Sa(()=>{we(),delete e.el.__isMounted},f)):we()}else{if(IO(e.props)&&t.el.__isMounted===!1){Sa(()=>{J4.process(t,e,n,l,d,f,x,s,C,P)},f);return}e.el=t.el,e.targetStart=t.targetStart;const Mt=e.anchor=t.anchor,kt=e.target=t.target,Pe=e.targetAnchor=t.targetAnchor,we=yv(t.props),Se=we?n:kt,je=we?Mt:Pe;if(x==="svg"||AO(kt)?x="svg":(x==="mathml"||PO(kt))&&(x="mathml"),Ne?(V(t.dynamicChildren,Ne,Se,d,f,x,s),HI(t,e,!0)):C||$(t,e,Se,je,d,f,x,s,!1),Be)we?e.props&&t.props&&e.props.to!==t.props.to&&(e.props.to=t.props.to):ox(e,n,Mt,P,1);else if((e.props&&e.props.to)!==(t.props&&t.props.to)){const Re=e.target=jC(e.props,ue);Re&&ox(e,Re,null,P,0)}else we&&ox(e,kt,Pe,P,1);Ox(e,Be)}},remove(t,e,n,{um:l,o:{remove:d}},f){const{shapeFlag:x,children:s,anchor:C,targetStart:P,targetAnchor:L,target:$,props:V}=t;if($&&(d(P),d(L)),f&&d(C),x&16){const j=f||!yv(V);for(let ue=0;ue<s.length;ue++){const de=s[ue];l(de,e,n,j,!!de.dynamicChildren)}}},move:ox,hydrate:EU};function ox(t,e,n,{o:{insert:l},m:d},f=2){f===0&&l(t.targetAnchor,e,n);const{el:x,anchor:s,shapeFlag:C,children:P,props:L}=t,$=f===2;if($&&l(x,e,n),(!$||yv(L))&&C&16)for(let V=0;V<P.length;V++)d(P[V],e,n,2);$&&l(s,e,n)}function EU(t,e,n,l,d,f,{o:{nextSibling:x,parentNode:s,querySelector:C,insert:P,createText:L}},$){const V=e.target=jC(e.props,C);if(V){const j=yv(e.props),ue=V._lpa||V.firstChild;if(e.shapeFlag&16)if(j)e.anchor=$(x(t),e,s(t),n,l,d,f),e.targetStart=ue,e.targetAnchor=ue&&x(ue);else{e.anchor=x(t);let de=ue;for(;de;){if(de&&de.nodeType===8){if(de.data==="teleport start anchor")e.targetStart=de;else if(de.data==="teleport anchor"){e.targetAnchor=de,V._lpa=e.targetAnchor&&x(e.targetAnchor);break}}de=x(de)}e.targetAnchor||Q4(V,e,L,P),$(ue&&x(ue),e,V,n,l,d,f)}Ox(e,j)}return e.anchor&&x(e.anchor)}const CU=J4;function Ox(t,e){const n=t.ctx;if(n&&n.ut){let l,d;for(e?(l=t.el,d=t.anchor):(l=t.targetStart,d=t.targetAnchor);l&&l!==d;)l.nodeType===1&&l.setAttribute("data-v-owner",n.uid),l=l.nextSibling;n.ut()}}function Q4(t,e,n,l){const d=e.targetStart=n(""),f=e.targetAnchor=n("");return d[X4]=f,t&&(l(d,t),l(f,t)),f}const ld=Symbol("_leaveCb"),sx=Symbol("_enterCb");function IU(){const t={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return H0(()=>{t.isMounted=!0}),VI(()=>{t.isUnmounting=!0}),t}const Ol=[Function,Array],e6={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:Ol,onEnter:Ol,onAfterEnter:Ol,onEnterCancelled:Ol,onBeforeLeave:Ol,onLeave:Ol,onAfterLeave:Ol,onLeaveCancelled:Ol,onBeforeAppear:Ol,onAppear:Ol,onAfterAppear:Ol,onAppearCancelled:Ol},t6=t=>{const e=t.subTree;return e.component?t6(e.component):e},AU={name:"BaseTransition",props:e6,setup(t,{slots:e}){const n=Uv(),l=IU();return()=>{const d=e.default&&i6(e.default(),!0);if(!d||!d.length)return;const f=n6(d),x=io(t),{mode:s}=x;if(l.isLeaving)return YE(f);const C=RO(f);if(!C)return YE(f);let P=GC(C,x,l,n,$=>P=$);C.type!==oa&&Bv(C,P);let L=n.subTree&&RO(n.subTree);if(L&&L.type!==oa&&!ip(C,L)&&t6(n).type!==oa){let $=GC(L,x,l,n);if(Bv(L,$),s==="out-in"&&C.type!==oa)return l.isLeaving=!0,$.afterLeave=()=>{l.isLeaving=!1,n.job.flags&8||n.update(),delete $.afterLeave,L=void 0},YE(f);s==="in-out"&&C.type!==oa?$.delayLeave=(V,j,ue)=>{const de=r6(l,L);de[String(L.key)]=L,V[ld]=()=>{j(),V[ld]=void 0,delete P.delayedLeave,L=void 0},P.delayedLeave=()=>{ue(),delete P.delayedLeave,L=void 0}}:L=void 0}else L&&(L=void 0);return f}}};function n6(t){let e=t[0];if(t.length>1){for(const n of t)if(n.type!==oa){e=n;break}}return e}const PU=AU;function r6(t,e){const{leavingVNodes:n}=t;let l=n.get(e.type);return l||(l=Object.create(null),n.set(e.type,l)),l}function GC(t,e,n,l,d){const{appear:f,mode:x,persisted:s=!1,onBeforeEnter:C,onEnter:P,onAfterEnter:L,onEnterCancelled:$,onBeforeLeave:V,onLeave:j,onAfterLeave:ue,onLeaveCancelled:de,onBeforeAppear:Te,onAppear:Be,onAfterAppear:Ge,onAppearCancelled:Ye}=e,Ne=String(t.key),Mt=r6(n,t),kt=(Se,je)=>{Se&&mc(Se,l,9,je)},Pe=(Se,je)=>{const Re=je[1];kt(Se,je),Cr(Se)?Se.every(Ve=>Ve.length<=1)&&Re():Se.length<=1&&Re()},we={mode:x,persisted:s,beforeEnter(Se){let je=C;if(!n.isMounted)if(f)je=Te||C;else return;Se[ld]&&Se[ld](!0);const Re=Mt[Ne];Re&&ip(t,Re)&&Re.el[ld]&&Re.el[ld](),kt(je,[Se])},enter(Se){let je=P,Re=L,Ve=$;if(!n.isMounted)if(f)je=Be||P,Re=Ge||L,Ve=Ye||$;else return;let ke=!1;const Mn=Se[sx]=bn=>{ke||(ke=!0,bn?kt(Ve,[Se]):kt(Re,[Se]),we.delayedLeave&&we.delayedLeave(),Se[sx]=void 0)};je?Pe(je,[Se,Mn]):Mn()},leave(Se,je){const Re=String(t.key);if(Se[sx]&&Se[sx](!0),n.isUnmounting)return je();kt(V,[Se]);let Ve=!1;const ke=Se[ld]=Mn=>{Ve||(Ve=!0,je(),Mn?kt(de,[Se]):kt(ue,[Se]),Se[ld]=void 0,Mt[Re]===t&&delete Mt[Re])};Mt[Re]=t,j?Pe(j,[Se,ke]):ke()},clone(Se){const je=GC(Se,e,n,l,d);return d&&d(je),je}};return we}function YE(t){if(Qw(t))return t=Gh(t),t.children=null,t}function RO(t){if(!Qw(t))return Y4(t.type)&&t.children?n6(t.children):t;if(t.component)return t.component.subTree;const{shapeFlag:e,children:n}=t;if(n){if(e&16)return n[0];if(e&32&&ri(n.default))return n.default()}}function Bv(t,e){t.shapeFlag&6&&t.component?(t.transition=e,Bv(t.component.subTree,e)):t.shapeFlag&128?(t.ssContent.transition=e.clone(t.ssContent),t.ssFallback.transition=e.clone(t.ssFallback)):t.transition=e}function i6(t,e=!1,n){let l=[],d=0;for(let f=0;f<t.length;f++){let x=t[f];const s=n==null?x.key:String(n)+String(x.key!=null?x.key:f);x.type===Tr?(x.patchFlag&128&&d++,l=l.concat(i6(x.children,e,s))):(e||x.type!==oa)&&l.push(s!=null?Gh(x,{key:s}):x)}if(d>1)for(let f=0;f<l.length;f++)l[f].patchFlag=-2;return l}/*! #__NO_SIDE_EFFECTS__ */function vu(t,e){return ri(t)?ks({name:t.name},e,{setup:t}):t}function RU(){const t=Uv();return t?(t.appContext.config.idPrefix||"v")+"-"+t.ids[0]+t.ids[1]++:""}function o6(t){t.ids=[t.ids[0]+t.ids[2]+++"-",0,0]}function vv(t,e,n,l,d=!1){if(Cr(t)){t.forEach((ue,de)=>vv(ue,e&&(Cr(e)?e[de]:e),n,l,d));return}if(wg(l)&&!d){l.shapeFlag&512&&l.type.__asyncResolved&&l.component.subTree.component&&vv(t,e,n,l.component.subTree);return}const f=l.shapeFlag&4?rT(l.component):l.el,x=d?null:f,{i:s,r:C}=t,P=e&&e.r,L=s.refs===wo?s.refs={}:s.refs,$=s.setupState,V=io($),j=$===wo?y4:ue=>co(V,ue);if(P!=null&&P!==C){if(Go(P))L[P]=null,j(P)&&($[P]=null);else if(aa(P)){P.value=null;const ue=e;ue.k&&(L[ue.k]=null)}}if(ri(C))j0(C,s,12,[x,L]);else{const ue=Go(C),de=aa(C);if(ue||de){const Te=()=>{if(t.f){const Be=ue?j(C)?$[C]:L[C]:C.value;if(d)Cr(Be)&&AI(Be,f);else if(Cr(Be))Be.includes(f)||Be.push(f);else if(ue)L[C]=[f],j(C)&&($[C]=L[C]);else{const Ge=[f];C.value=Ge,t.k&&(L[t.k]=Ge)}}else ue?(L[C]=x,j(C)&&($[C]=x)):de&&(C.value=x,t.k&&(L[t.k]=x))};x?(Te.id=-1,Sa(Te,n)):Te()}}}Zw().requestIdleCallback;Zw().cancelIdleCallback;const wg=t=>!!t.type.__asyncLoader,Qw=t=>t.type.__isKeepAlive;function kU(t,e){s6(t,"a",e)}function OU(t,e){s6(t,"da",e)}function s6(t,e,n=sa){const l=t.__wdc||(t.__wdc=()=>{let d=n;for(;d;){if(d.isDeactivated)return;d=d.parent}return t()});if(eT(e,l,n),n){let d=n.parent;for(;d&&d.parent;)Qw(d.parent.vnode)&&MU(l,e,n,d),d=d.parent}}function MU(t,e,n,l){const d=eT(e,t,l,!0);a6(()=>{AI(l[e],d)},n)}function eT(t,e,n=sa,l=!1){if(n){const d=n[t]||(n[t]=[]),f=e.__weh||(e.__weh=(...x)=>{yd();const s=W0(n),C=mc(e,n,t,x);return s(),vd(),C});return l?d.unshift(f):d.push(f),f}}const Ed=t=>(e,n=sa)=>{(!jv||t==="sp")&&eT(t,(...l)=>e(...l),n)},DU=Ed("bm"),H0=Ed("m"),LU=Ed("bu"),zU=Ed("u"),VI=Ed("bum"),a6=Ed("um"),FU=Ed("sp"),BU=Ed("rtg"),NU=Ed("rtc");function VU(t,e=sa){eT("ec",t,e)}const $I="components",$U="directives";function _r(t,e){return UI($I,t,!0,e)||t}const l6=Symbol.for("v-ndc");function Hr(t){return Go(t)?UI($I,t,!1)||t:t||l6}function Cd(t){return UI($U,t)}function UI(t,e,n=!0,l=!1){const d=js||sa;if(d){const f=d.type;if(t===$I){const s=Ij(f,!1);if(s&&(s===e||s===zl(e)||s===Kw(zl(e))))return f}const x=kO(d[t]||f[t],e)||kO(d.appContext[t],e);return!x&&l?f:x}}function kO(t,e){return t&&(t[e]||t[zl(e)]||t[Kw(zl(e))])}function ms(t,e,n,l){let d;const f=n,x=Cr(t);if(x||Go(t)){const s=x&&bg(t);let C=!1,P=!1;s&&(C=!Dl(t),P=jh(t),t=Yw(t)),d=new Array(t.length);for(let L=0,$=t.length;L<$;L++)d[L]=e(C?P?nw($s(t[L])):$s(t[L]):t[L],L,void 0,f)}else if(typeof t=="number"){d=new Array(t);for(let s=0;s<t;s++)d[s]=e(s+1,s,void 0,f)}else if(To(t))if(t[Symbol.iterator])d=Array.from(t,(s,C)=>e(s,C,void 0,f));else{const s=Object.keys(t);d=new Array(s.length);for(let C=0,P=s.length;C<P;C++){const L=s[C];d[C]=e(t[L],L,C,f)}}else d=[];return d}function Nv(t,e){for(let n=0;n<e.length;n++){const l=e[n];if(Cr(l))for(let d=0;d<l.length;d++)t[l[d].name]=l[d].fn;else l&&(t[l.name]=l.key?(...d)=>{const f=l.fn(...d);return f&&(f.key=l.key),f}:l.fn)}return t}function ir(t,e,n={},l,d){if(js.ce||js.parent&&wg(js.parent)&&js.parent.ce)return e!=="default"&&(n.name=e),Me(),rn(Tr,null,[pr("slot",n,l&&l())],64);let f=t[e];f&&f._c&&(f._d=!1),Me();const x=f&&c6(f(n)),s=n.key||x&&x.key,C=rn(Tr,{key:(s&&!pc(s)?s:`_${e}`)+(!x&&l?"_fb":"")},x||(l?l():[]),x&&t._===1?64:-2);return C.scopeId&&(C.slotScopeIds=[C.scopeId+"-s"]),f&&f._c&&(f._d=!0),C}function c6(t){return t.some(e=>$v(e)?!(e.type===oa||e.type===Tr&&!c6(e.children)):!0)?t:null}function ax(t,e){const n={};for(const l in t)n[/[A-Z]/.test(l)?`on:${l}`:Rx(l)]=t[l];return n}const HC=t=>t?A6(t)?rT(t):HC(t.parent):null,bv=ks(Object.create(null),{$:t=>t,$el:t=>t.vnode.el,$data:t=>t.data,$props:t=>t.props,$attrs:t=>t.attrs,$slots:t=>t.slots,$refs:t=>t.refs,$parent:t=>HC(t.parent),$root:t=>HC(t.root),$host:t=>t.ce,$emit:t=>t.emit,$options:t=>d6(t),$forceUpdate:t=>t.f||(t.f=()=>{NI(t.update)}),$nextTick:t=>t.n||(t.n=G0.bind(t.proxy)),$watch:t=>lj.bind(t)}),JE=(t,e)=>t!==wo&&!t.__isScriptSetup&&co(t,e),UU={get({_:t},e){if(e==="__v_skip")return!0;const{ctx:n,setupState:l,data:d,props:f,accessCache:x,type:s,appContext:C}=t;let P;if(e[0]!=="$"){const j=x[e];if(j!==void 0)switch(j){case 1:return l[e];case 2:return d[e];case 4:return n[e];case 3:return f[e]}else{if(JE(l,e))return x[e]=1,l[e];if(d!==wo&&co(d,e))return x[e]=2,d[e];if((P=t.propsOptions[0])&&co(P,e))return x[e]=3,f[e];if(n!==wo&&co(n,e))return x[e]=4,n[e];WC&&(x[e]=0)}}const L=bv[e];let $,V;if(L)return e==="$attrs"&&ia(t.attrs,"get",""),L(t);if(($=s.__cssModules)&&($=$[e]))return $;if(n!==wo&&co(n,e))return x[e]=4,n[e];if(V=C.config.globalProperties,co(V,e))return V[e]},set({_:t},e,n){const{data:l,setupState:d,ctx:f}=t;return JE(d,e)?(d[e]=n,!0):l!==wo&&co(l,e)?(l[e]=n,!0):co(t.props,e)||e[0]==="$"&&e.slice(1)in t?!1:(f[e]=n,!0)},has({_:{data:t,setupState:e,accessCache:n,ctx:l,appContext:d,propsOptions:f,type:x}},s){let C,P;return!!(n[s]||t!==wo&&s[0]!=="$"&&co(t,s)||JE(e,s)||(C=f[0])&&co(C,s)||co(l,s)||co(bv,s)||co(d.config.globalProperties,s)||(P=x.__cssModules)&&P[s])},defineProperty(t,e,n){return n.get!=null?t._.accessCache[e]=0:co(n,"value")&&this.set(t,e,n.value,null),Reflect.defineProperty(t,e,n)}};function OO(t){return Cr(t)?t.reduce((e,n)=>(e[n]=null,e),{}):t}let WC=!0;function jU(t){const e=d6(t),n=t.proxy,l=t.ctx;WC=!1,e.beforeCreate&&MO(e.beforeCreate,t,"bc");const{data:d,computed:f,methods:x,watch:s,provide:C,inject:P,created:L,beforeMount:$,mounted:V,beforeUpdate:j,updated:ue,activated:de,deactivated:Te,beforeDestroy:Be,beforeUnmount:Ge,destroyed:Ye,unmounted:Ne,render:Mt,renderTracked:kt,renderTriggered:Pe,errorCaptured:we,serverPrefetch:Se,expose:je,inheritAttrs:Re,components:Ve,directives:ke,filters:Mn}=e;if(P&&GU(P,l,null),x)for(const Sn in x){const ar=x[Sn];ri(ar)&&(l[Sn]=ar.bind(n))}if(d){const Sn=d.call(n,n);To(Sn)&&(t.data=Fl(Sn))}if(WC=!0,f)for(const Sn in f){const ar=f[Sn],Br=ri(ar)?ar.bind(n,n):ri(ar.get)?ar.get.bind(n,n):iu,ei=!ri(ar)&&ri(ar.set)?ar.set.bind(n):iu,or=ps({get:Br,set:ei});Object.defineProperty(l,Sn,{enumerable:!0,configurable:!0,get:()=>or.value,set:vr=>or.value=vr})}if(s)for(const Sn in s)u6(s[Sn],l,n,Sn);if(C){const Sn=ri(C)?C.call(n):C;Reflect.ownKeys(Sn).forEach(ar=>{Mx(ar,Sn[ar])})}L&&MO(L,t,"c");function mn(Sn,ar){Cr(ar)?ar.forEach(Br=>Sn(Br.bind(n))):ar&&Sn(ar.bind(n))}if(mn(DU,$),mn(H0,V),mn(LU,j),mn(zU,ue),mn(kU,de),mn(OU,Te),mn(VU,we),mn(NU,kt),mn(BU,Pe),mn(VI,Ge),mn(a6,Ne),mn(FU,Se),Cr(je))if(je.length){const Sn=t.exposed||(t.exposed={});je.forEach(ar=>{Object.defineProperty(Sn,ar,{get:()=>n[ar],set:Br=>n[ar]=Br,enumerable:!0})})}else t.exposed||(t.exposed={});Mt&&t.render===iu&&(t.render=Mt),Re!=null&&(t.inheritAttrs=Re),Ve&&(t.components=Ve),ke&&(t.directives=ke),Se&&o6(t)}function GU(t,e,n=iu){Cr(t)&&(t=qC(t));for(const l in t){const d=t[l];let f;To(d)?"default"in d?f=fc(d.from||l,d.default,!0):f=fc(d.from||l):f=fc(d),aa(f)?Object.defineProperty(e,l,{enumerable:!0,configurable:!0,get:()=>f.value,set:x=>f.value=x}):e[l]=f}}function MO(t,e,n){mc(Cr(t)?t.map(l=>l.bind(e.proxy)):t.bind(e.proxy),e,n)}function u6(t,e,n,l){let d=l.includes(".")?T6(n,l):()=>n[l];if(Go(t)){const f=e[t];ri(f)&&ru(d,f)}else if(ri(t))ru(d,t.bind(n));else if(To(t))if(Cr(t))t.forEach(f=>u6(f,e,n,l));else{const f=ri(t.handler)?t.handler.bind(n):e[t.handler];ri(f)&&ru(d,f,t)}}function d6(t){const e=t.type,{mixins:n,extends:l}=e,{mixins:d,optionsCache:f,config:{optionMergeStrategies:x}}=t.appContext,s=f.get(e);let C;return s?C=s:!d.length&&!n&&!l?C=e:(C={},d.length&&d.forEach(P=>sw(C,P,x,!0)),sw(C,e,x)),To(e)&&f.set(e,C),C}function sw(t,e,n,l=!1){const{mixins:d,extends:f}=e;f&&sw(t,f,n,!0),d&&d.forEach(x=>sw(t,x,n,!0));for(const x in e)if(!(l&&x==="expose")){const s=HU[x]||n&&n[x];t[x]=s?s(t[x],e[x]):e[x]}return t}const HU={data:DO,props:LO,emits:LO,methods:iv,computed:iv,beforeCreate:Ta,created:Ta,beforeMount:Ta,mounted:Ta,beforeUpdate:Ta,updated:Ta,beforeDestroy:Ta,beforeUnmount:Ta,destroyed:Ta,unmounted:Ta,activated:Ta,deactivated:Ta,errorCaptured:Ta,serverPrefetch:Ta,components:iv,directives:iv,watch:qU,provide:DO,inject:WU};function DO(t,e){return e?t?function(){return ks(ri(t)?t.call(this,this):t,ri(e)?e.call(this,this):e)}:e:t}function WU(t,e){return iv(qC(t),qC(e))}function qC(t){if(Cr(t)){const e={};for(let n=0;n<t.length;n++)e[t[n]]=t[n];return e}return t}function Ta(t,e){return t?[...new Set([].concat(t,e))]:e}function iv(t,e){return t?ks(Object.create(null),t,e):e}function LO(t,e){return t?Cr(t)&&Cr(e)?[...new Set([...t,...e])]:ks(Object.create(null),OO(t),OO(e??{})):e}function qU(t,e){if(!t)return e;if(!e)return t;const n=ks(Object.create(null),t);for(const l in e)n[l]=Ta(t[l],e[l]);return n}function h6(){return{app:null,config:{isNativeTag:y4,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let KU=0;function ZU(t,e){return function(l,d=null){ri(l)||(l=ks({},l)),d!=null&&!To(d)&&(d=null);const f=h6(),x=new WeakSet,s=[];let C=!1;const P=f.app={_uid:KU++,_component:l,_props:d,_container:null,_context:f,_instance:null,version:Pj,get config(){return f.config},set config(L){},use(L,...$){return x.has(L)||(L&&ri(L.install)?(x.add(L),L.install(P,...$)):ri(L)&&(x.add(L),L(P,...$))),P},mixin(L){return f.mixins.includes(L)||f.mixins.push(L),P},component(L,$){return $?(f.components[L]=$,P):f.components[L]},directive(L,$){return $?(f.directives[L]=$,P):f.directives[L]},mount(L,$,V){if(!C){const j=P._ceVNode||pr(l,d);return j.appContext=f,V===!0?V="svg":V===!1&&(V=void 0),t(j,L,V),C=!0,P._container=L,L.__vue_app__=P,rT(j.component)}},onUnmount(L){s.push(L)},unmount(){C&&(mc(s,P._instance,16),t(null,P._container),delete P._container.__vue_app__)},provide(L,$){return f.provides[L]=$,P},runWithContext(L){const $=Tg;Tg=P;try{return L()}finally{Tg=$}}};return P}}let Tg=null;function Mx(t,e){if(sa){let n=sa.provides;const l=sa.parent&&sa.parent.provides;l===n&&(n=sa.provides=Object.create(l)),n[t]=e}}function fc(t,e,n=!1){const l=Uv();if(l||Tg){let d=Tg?Tg._context.provides:l?l.parent==null||l.ce?l.vnode.appContext&&l.vnode.appContext.provides:l.parent.provides:void 0;if(d&&t in d)return d[t];if(arguments.length>1)return n&&ri(e)?e.call(l&&l.proxy):e}}const f6={},p6=()=>Object.create(f6),m6=t=>Object.getPrototypeOf(t)===f6;function XU(t,e,n,l=!1){const d={},f=p6();t.propsDefaults=Object.create(null),g6(t,e,d,f);for(const x in t.propsOptions[0])x in d||(d[x]=void 0);n?t.props=l?d:$4(d):t.type.props?t.props=d:t.props=f,t.attrs=f}function YU(t,e,n,l){const{props:d,attrs:f,vnode:{patchFlag:x}}=t,s=io(d),[C]=t.propsOptions;let P=!1;if((l||x>0)&&!(x&16)){if(x&8){const L=t.vnode.dynamicProps;for(let $=0;$<L.length;$++){let V=L[$];if(tT(t.emitsOptions,V))continue;const j=e[V];if(C)if(co(f,V))j!==f[V]&&(f[V]=j,P=!0);else{const ue=zl(V);d[ue]=KC(C,s,ue,j,t,!1)}else j!==f[V]&&(f[V]=j,P=!0)}}}else{g6(t,e,d,f)&&(P=!0);let L;for(const $ in s)(!e||!co(e,$)&&((L=rf($))===$||!co(e,L)))&&(C?n&&(n[$]!==void 0||n[L]!==void 0)&&(d[$]=KC(C,s,$,void 0,t,!0)):delete d[$]);if(f!==s)for(const $ in f)(!e||!co(e,$))&&(delete f[$],P=!0)}P&&cd(t.attrs,"set","")}function g6(t,e,n,l){const[d,f]=t.propsOptions;let x=!1,s;if(e)for(let C in e){if(mv(C))continue;const P=e[C];let L;d&&co(d,L=zl(C))?!f||!f.includes(L)?n[L]=P:(s||(s={}))[L]=P:tT(t.emitsOptions,C)||(!(C in l)||P!==l[C])&&(l[C]=P,x=!0)}if(f){const C=io(n),P=s||wo;for(let L=0;L<f.length;L++){const $=f[L];n[$]=KC(d,C,$,P[$],t,!co(P,$))}}return x}function KC(t,e,n,l,d,f){const x=t[n];if(x!=null){const s=co(x,"default");if(s&&l===void 0){const C=x.default;if(x.type!==Function&&!x.skipFactory&&ri(C)){const{propsDefaults:P}=d;if(n in P)l=P[n];else{const L=W0(d);l=P[n]=C.call(null,e),L()}}else l=C;d.ce&&d.ce._setProp(n,l)}x[0]&&(f&&!s?l=!1:x[1]&&(l===""||l===rf(n))&&(l=!0))}return l}const JU=new WeakMap;function _6(t,e,n=!1){const l=n?JU:e.propsCache,d=l.get(t);if(d)return d;const f=t.props,x={},s=[];let C=!1;if(!ri(t)){const L=$=>{C=!0;const[V,j]=_6($,e,!0);ks(x,V),j&&s.push(...j)};!n&&e.mixins.length&&e.mixins.forEach(L),t.extends&&L(t.extends),t.mixins&&t.mixins.forEach(L)}if(!f&&!C)return To(t)&&l.set(t,yg),yg;if(Cr(f))for(let L=0;L<f.length;L++){const $=zl(f[L]);zO($)&&(x[$]=wo)}else if(f)for(const L in f){const $=zl(L);if(zO($)){const V=f[L],j=x[$]=Cr(V)||ri(V)?{type:V}:ks({},V),ue=j.type;let de=!1,Te=!0;if(Cr(ue))for(let Be=0;Be<ue.length;++Be){const Ge=ue[Be],Ye=ri(Ge)&&Ge.name;if(Ye==="Boolean"){de=!0;break}else Ye==="String"&&(Te=!1)}else de=ri(ue)&&ue.name==="Boolean";j[0]=de,j[1]=Te,(de||co(j,"default"))&&s.push($)}}const P=[x,s];return To(t)&&l.set(t,P),P}function zO(t){return t[0]!=="$"&&!mv(t)}const jI=t=>t==="_"||t==="_ctx"||t==="$stable",GI=t=>Cr(t)?t.map(eu):[eu(t)],QU=(t,e,n)=>{if(e._n)return e;const l=zr((...d)=>GI(e(...d)),n);return l._c=!1,l},y6=(t,e,n)=>{const l=t._ctx;for(const d in t){if(jI(d))continue;const f=t[d];if(ri(f))e[d]=QU(d,f,l);else if(f!=null){const x=GI(f);e[d]=()=>x}}},v6=(t,e)=>{const n=GI(e);t.slots.default=()=>n},b6=(t,e,n)=>{for(const l in e)(n||!jI(l))&&(t[l]=e[l])},ej=(t,e,n)=>{const l=t.slots=p6();if(t.vnode.shapeFlag&32){const d=e._;d?(b6(l,e,n),n&&w4(l,"_",d,!0)):y6(e,l)}else e&&v6(t,e)},tj=(t,e,n)=>{const{vnode:l,slots:d}=t;let f=!0,x=wo;if(l.shapeFlag&32){const s=e._;s?n&&s===1?f=!1:b6(d,e,n):(f=!e.$stable,y6(e,d)),x=e}else e&&(v6(t,e),x={default:1});if(f)for(const s in d)!jI(s)&&x[s]==null&&delete d[s]},Sa=mj;function nj(t){return rj(t)}function rj(t,e){const n=Zw();n.__VUE__=!0;const{insert:l,remove:d,patchProp:f,createElement:x,createText:s,createComment:C,setText:P,setElementText:L,parentNode:$,nextSibling:V,setScopeId:j=iu,insertStaticContent:ue}=t,de=(He,Qe,dt,Lt=null,qt=null,jt=null,Rn=void 0,fn=null,cn=!!Qe.dynamicChildren)=>{if(He===Qe)return;He&&!ip(He,Qe)&&(Lt=Ot(He),vr(He,qt,jt,!0),He=null),Qe.patchFlag===-2&&(cn=!1,Qe.dynamicChildren=null);const{type:Zt,ref:Xn,shapeFlag:En}=Qe;switch(Zt){case nT:Te(He,Qe,dt,Lt);break;case oa:Be(He,Qe,dt,Lt);break;case Dx:He==null&&Ge(Qe,dt,Lt,Rn);break;case Tr:Ve(He,Qe,dt,Lt,qt,jt,Rn,fn,cn);break;default:En&1?Mt(He,Qe,dt,Lt,qt,jt,Rn,fn,cn):En&6?ke(He,Qe,dt,Lt,qt,jt,Rn,fn,cn):(En&64||En&128)&&Zt.process(He,Qe,dt,Lt,qt,jt,Rn,fn,cn,vn)}Xn!=null&&qt?vv(Xn,He&&He.ref,jt,Qe||He,!Qe):Xn==null&&He&&He.ref!=null&&vv(He.ref,null,jt,He,!0)},Te=(He,Qe,dt,Lt)=>{if(He==null)l(Qe.el=s(Qe.children),dt,Lt);else{const qt=Qe.el=He.el;Qe.children!==He.children&&P(qt,Qe.children)}},Be=(He,Qe,dt,Lt)=>{He==null?l(Qe.el=C(Qe.children||""),dt,Lt):Qe.el=He.el},Ge=(He,Qe,dt,Lt)=>{[He.el,He.anchor]=ue(He.children,Qe,dt,Lt,He.el,He.anchor)},Ye=({el:He,anchor:Qe},dt,Lt)=>{let qt;for(;He&&He!==Qe;)qt=V(He),l(He,dt,Lt),He=qt;l(Qe,dt,Lt)},Ne=({el:He,anchor:Qe})=>{let dt;for(;He&&He!==Qe;)dt=V(He),d(He),He=dt;d(Qe)},Mt=(He,Qe,dt,Lt,qt,jt,Rn,fn,cn)=>{Qe.type==="svg"?Rn="svg":Qe.type==="math"&&(Rn="mathml"),He==null?kt(Qe,dt,Lt,qt,jt,Rn,fn,cn):Se(He,Qe,qt,jt,Rn,fn,cn)},kt=(He,Qe,dt,Lt,qt,jt,Rn,fn)=>{let cn,Zt;const{props:Xn,shapeFlag:En,transition:jn,dirs:dr}=He;if(cn=He.el=x(He.type,jt,Xn&&Xn.is,Xn),En&8?L(cn,He.children):En&16&&we(He.children,cn,null,Lt,qt,QE(He,jt),Rn,fn),dr&&Xf(He,null,Lt,"created"),Pe(cn,He,He.scopeId,Rn,Lt),Xn){for(const hr in Xn)hr!=="value"&&!mv(hr)&&f(cn,hr,null,Xn[hr],jt,Lt);"value"in Xn&&f(cn,"value",null,Xn.value,jt),(Zt=Xn.onVnodeBeforeMount)&&Xc(Zt,Lt,He)}dr&&Xf(He,null,Lt,"beforeMount");const Gn=ij(qt,jn);Gn&&jn.beforeEnter(cn),l(cn,Qe,dt),((Zt=Xn&&Xn.onVnodeMounted)||Gn||dr)&&Sa(()=>{Zt&&Xc(Zt,Lt,He),Gn&&jn.enter(cn),dr&&Xf(He,null,Lt,"mounted")},qt)},Pe=(He,Qe,dt,Lt,qt)=>{if(dt&&j(He,dt),Lt)for(let jt=0;jt<Lt.length;jt++)j(He,Lt[jt]);if(qt){let jt=qt.subTree;if(Qe===jt||E6(jt.type)&&(jt.ssContent===Qe||jt.ssFallback===Qe)){const Rn=qt.vnode;Pe(He,Rn,Rn.scopeId,Rn.slotScopeIds,qt.parent)}}},we=(He,Qe,dt,Lt,qt,jt,Rn,fn,cn=0)=>{for(let Zt=cn;Zt<He.length;Zt++){const Xn=He[Zt]=fn?Sh(He[Zt]):eu(He[Zt]);de(null,Xn,Qe,dt,Lt,qt,jt,Rn,fn)}},Se=(He,Qe,dt,Lt,qt,jt,Rn)=>{const fn=Qe.el=He.el;let{patchFlag:cn,dynamicChildren:Zt,dirs:Xn}=Qe;cn|=He.patchFlag&16;const En=He.props||wo,jn=Qe.props||wo;let dr;if(dt&&Yf(dt,!1),(dr=jn.onVnodeBeforeUpdate)&&Xc(dr,dt,Qe,He),Xn&&Xf(Qe,He,dt,"beforeUpdate"),dt&&Yf(dt,!0),(En.innerHTML&&jn.innerHTML==null||En.textContent&&jn.textContent==null)&&L(fn,""),Zt?je(He.dynamicChildren,Zt,fn,dt,Lt,QE(Qe,qt),jt):Rn||ar(He,Qe,fn,null,dt,Lt,QE(Qe,qt),jt,!1),cn>0){if(cn&16)Re(fn,En,jn,dt,qt);else if(cn&2&&En.class!==jn.class&&f(fn,"class",null,jn.class,qt),cn&4&&f(fn,"style",En.style,jn.style,qt),cn&8){const Gn=Qe.dynamicProps;for(let hr=0;hr<Gn.length;hr++){const Yr=Gn[hr],ho=En[Yr],So=jn[Yr];(So!==ho||Yr==="value")&&f(fn,Yr,ho,So,qt,dt)}}cn&1&&He.children!==Qe.children&&L(fn,Qe.children)}else!Rn&&Zt==null&&Re(fn,En,jn,dt,qt);((dr=jn.onVnodeUpdated)||Xn)&&Sa(()=>{dr&&Xc(dr,dt,Qe,He),Xn&&Xf(Qe,He,dt,"updated")},Lt)},je=(He,Qe,dt,Lt,qt,jt,Rn)=>{for(let fn=0;fn<Qe.length;fn++){const cn=He[fn],Zt=Qe[fn],Xn=cn.el&&(cn.type===Tr||!ip(cn,Zt)||cn.shapeFlag&198)?$(cn.el):dt;de(cn,Zt,Xn,null,Lt,qt,jt,Rn,!0)}},Re=(He,Qe,dt,Lt,qt)=>{if(Qe!==dt){if(Qe!==wo)for(const jt in Qe)!mv(jt)&&!(jt in dt)&&f(He,jt,Qe[jt],null,qt,Lt);for(const jt in dt){if(mv(jt))continue;const Rn=dt[jt],fn=Qe[jt];Rn!==fn&&jt!=="value"&&f(He,jt,fn,Rn,qt,Lt)}"value"in dt&&f(He,"value",Qe.value,dt.value,qt)}},Ve=(He,Qe,dt,Lt,qt,jt,Rn,fn,cn)=>{const Zt=Qe.el=He?He.el:s(""),Xn=Qe.anchor=He?He.anchor:s("");let{patchFlag:En,dynamicChildren:jn,slotScopeIds:dr}=Qe;dr&&(fn=fn?fn.concat(dr):dr),He==null?(l(Zt,dt,Lt),l(Xn,dt,Lt),we(Qe.children||[],dt,Xn,qt,jt,Rn,fn,cn)):En>0&&En&64&&jn&&He.dynamicChildren?(je(He.dynamicChildren,jn,dt,qt,jt,Rn,fn),(Qe.key!=null||qt&&Qe===qt.subTree)&&HI(He,Qe,!0)):ar(He,Qe,dt,Xn,qt,jt,Rn,fn,cn)},ke=(He,Qe,dt,Lt,qt,jt,Rn,fn,cn)=>{Qe.slotScopeIds=fn,He==null?Qe.shapeFlag&512?qt.ctx.activate(Qe,dt,Lt,Rn,cn):Mn(Qe,dt,Lt,qt,jt,Rn,cn):bn(He,Qe,cn)},Mn=(He,Qe,dt,Lt,qt,jt,Rn)=>{const fn=He.component=wj(He,Lt,qt);if(Qw(He)&&(fn.ctx.renderer=vn),Tj(fn,!1,Rn),fn.asyncDep){if(qt&&qt.registerDep(fn,mn,Rn),!He.el){const cn=fn.subTree=pr(oa);Be(null,cn,Qe,dt),He.placeholder=cn.el}}else mn(fn,He,Qe,dt,qt,jt,Rn)},bn=(He,Qe,dt)=>{const Lt=Qe.component=He.component;if(fj(He,Qe,dt))if(Lt.asyncDep&&!Lt.asyncResolved){Sn(Lt,Qe,dt);return}else Lt.next=Qe,Lt.update();else Qe.el=He.el,Lt.vnode=Qe},mn=(He,Qe,dt,Lt,qt,jt,Rn)=>{const fn=()=>{if(He.isMounted){let{next:En,bu:jn,u:dr,parent:Gn,vnode:hr}=He;{const oo=x6(He);if(oo){En&&(En.el=hr.el,Sn(He,En,Rn)),oo.asyncDep.then(()=>{He.isUnmounted||fn()});return}}let Yr=En,ho;Yf(He,!1),En?(En.el=hr.el,Sn(He,En,Rn)):En=hr,jn&&kx(jn),(ho=En.props&&En.props.onVnodeBeforeUpdate)&&Xc(ho,Gn,En,hr),Yf(He,!0);const So=BO(He),Vi=He.subTree;He.subTree=So,de(Vi,So,$(Vi.el),Ot(Vi),He,qt,jt),En.el=So.el,Yr===null&&pj(He,So.el),dr&&Sa(dr,qt),(ho=En.props&&En.props.onVnodeUpdated)&&Sa(()=>Xc(ho,Gn,En,hr),qt)}else{let En;const{el:jn,props:dr}=Qe,{bm:Gn,m:hr,parent:Yr,root:ho,type:So}=He,Vi=wg(Qe);Yf(He,!1),Gn&&kx(Gn),!Vi&&(En=dr&&dr.onVnodeBeforeMount)&&Xc(En,Yr,Qe),Yf(He,!0);{ho.ce&&ho.ce._def.shadowRoot!==!1&&ho.ce._injectChildStyle(So);const oo=He.subTree=BO(He);de(null,oo,dt,Lt,He,qt,jt),Qe.el=oo.el}if(hr&&Sa(hr,qt),!Vi&&(En=dr&&dr.onVnodeMounted)){const oo=Qe;Sa(()=>Xc(En,Yr,oo),qt)}(Qe.shapeFlag&256||Yr&&wg(Yr.vnode)&&Yr.vnode.shapeFlag&256)&&He.a&&Sa(He.a,qt),He.isMounted=!0,Qe=dt=Lt=null}};He.scope.on();const cn=He.effect=new I4(fn);He.scope.off();const Zt=He.update=cn.run.bind(cn),Xn=He.job=cn.runIfDirty.bind(cn);Xn.i=He,Xn.id=He.uid,cn.scheduler=()=>NI(Xn),Yf(He,!0),Zt()},Sn=(He,Qe,dt)=>{Qe.component=He;const Lt=He.vnode.props;He.vnode=Qe,He.next=null,YU(He,Qe.props,Lt,dt),tj(He,Qe.children,dt),yd(),CO(He),vd()},ar=(He,Qe,dt,Lt,qt,jt,Rn,fn,cn=!1)=>{const Zt=He&&He.children,Xn=He?He.shapeFlag:0,En=Qe.children,{patchFlag:jn,shapeFlag:dr}=Qe;if(jn>0){if(jn&128){ei(Zt,En,dt,Lt,qt,jt,Rn,fn,cn);return}else if(jn&256){Br(Zt,En,dt,Lt,qt,jt,Rn,fn,cn);return}}dr&8?(Xn&16&&ur(Zt,qt,jt),En!==Zt&&L(dt,En)):Xn&16?dr&16?ei(Zt,En,dt,Lt,qt,jt,Rn,fn,cn):ur(Zt,qt,jt,!0):(Xn&8&&L(dt,""),dr&16&&we(En,dt,Lt,qt,jt,Rn,fn,cn))},Br=(He,Qe,dt,Lt,qt,jt,Rn,fn,cn)=>{He=He||yg,Qe=Qe||yg;const Zt=He.length,Xn=Qe.length,En=Math.min(Zt,Xn);let jn;for(jn=0;jn<En;jn++){const dr=Qe[jn]=cn?Sh(Qe[jn]):eu(Qe[jn]);de(He[jn],dr,dt,null,qt,jt,Rn,fn,cn)}Zt>Xn?ur(He,qt,jt,!0,!1,En):we(Qe,dt,Lt,qt,jt,Rn,fn,cn,En)},ei=(He,Qe,dt,Lt,qt,jt,Rn,fn,cn)=>{let Zt=0;const Xn=Qe.length;let En=He.length-1,jn=Xn-1;for(;Zt<=En&&Zt<=jn;){const dr=He[Zt],Gn=Qe[Zt]=cn?Sh(Qe[Zt]):eu(Qe[Zt]);if(ip(dr,Gn))de(dr,Gn,dt,null,qt,jt,Rn,fn,cn);else break;Zt++}for(;Zt<=En&&Zt<=jn;){const dr=He[En],Gn=Qe[jn]=cn?Sh(Qe[jn]):eu(Qe[jn]);if(ip(dr,Gn))de(dr,Gn,dt,null,qt,jt,Rn,fn,cn);else break;En--,jn--}if(Zt>En){if(Zt<=jn){const dr=jn+1,Gn=dr<Xn?Qe[dr].el:Lt;for(;Zt<=jn;)de(null,Qe[Zt]=cn?Sh(Qe[Zt]):eu(Qe[Zt]),dt,Gn,qt,jt,Rn,fn,cn),Zt++}}else if(Zt>jn)for(;Zt<=En;)vr(He[Zt],qt,jt,!0),Zt++;else{const dr=Zt,Gn=Zt,hr=new Map;for(Zt=Gn;Zt<=jn;Zt++){const so=Qe[Zt]=cn?Sh(Qe[Zt]):eu(Qe[Zt]);so.key!=null&&hr.set(so.key,Zt)}let Yr,ho=0;const So=jn-Gn+1;let Vi=!1,oo=0;const Hs=new Array(So);for(Zt=0;Zt<So;Zt++)Hs[Zt]=0;for(Zt=dr;Zt<=En;Zt++){const so=He[Zt];if(ho>=So){vr(so,qt,jt,!0);continue}let Fo;if(so.key!=null)Fo=hr.get(so.key);else for(Yr=Gn;Yr<=jn;Yr++)if(Hs[Yr-Gn]===0&&ip(so,Qe[Yr])){Fo=Yr;break}Fo===void 0?vr(so,qt,jt,!0):(Hs[Fo-Gn]=Zt+1,Fo>=oo?oo=Fo:Vi=!0,de(so,Qe[Fo],dt,null,qt,jt,Rn,fn,cn),ho++)}const Ws=Vi?oj(Hs):yg;for(Yr=Ws.length-1,Zt=So-1;Zt>=0;Zt--){const so=Gn+Zt,Fo=Qe[so],Ma=Qe[so+1],ai=so+1<Xn?Ma.el||Ma.placeholder:Lt;Hs[Zt]===0?de(null,Fo,dt,ai,qt,jt,Rn,fn,cn):Vi&&(Yr<0||Zt!==Ws[Yr]?or(Fo,dt,ai,2):Yr--)}}},or=(He,Qe,dt,Lt,qt=null)=>{const{el:jt,type:Rn,transition:fn,children:cn,shapeFlag:Zt}=He;if(Zt&6){or(He.component.subTree,Qe,dt,Lt);return}if(Zt&128){He.suspense.move(Qe,dt,Lt);return}if(Zt&64){Rn.move(He,Qe,dt,vn);return}if(Rn===Tr){l(jt,Qe,dt);for(let En=0;En<cn.length;En++)or(cn[En],Qe,dt,Lt);l(He.anchor,Qe,dt);return}if(Rn===Dx){Ye(He,Qe,dt);return}if(Lt!==2&&Zt&1&&fn)if(Lt===0)fn.beforeEnter(jt),l(jt,Qe,dt),Sa(()=>fn.enter(jt),qt);else{const{leave:En,delayLeave:jn,afterLeave:dr}=fn,Gn=()=>{He.ctx.isUnmounted?d(jt):l(jt,Qe,dt)},hr=()=>{jt._isLeaving&&jt[ld](!0),En(jt,()=>{Gn(),dr&&dr()})};jn?jn(jt,Gn,hr):hr()}else l(jt,Qe,dt)},vr=(He,Qe,dt,Lt=!1,qt=!1)=>{const{type:jt,props:Rn,ref:fn,children:cn,dynamicChildren:Zt,shapeFlag:Xn,patchFlag:En,dirs:jn,cacheIndex:dr}=He;if(En===-2&&(qt=!1),fn!=null&&(yd(),vv(fn,null,dt,He,!0),vd()),dr!=null&&(Qe.renderCache[dr]=void 0),Xn&256){Qe.ctx.deactivate(He);return}const Gn=Xn&1&&jn,hr=!wg(He);let Yr;if(hr&&(Yr=Rn&&Rn.onVnodeBeforeUnmount)&&Xc(Yr,Qe,He),Xn&6)Gi(He.component,dt,Lt);else{if(Xn&128){He.suspense.unmount(dt,Lt);return}Gn&&Xf(He,null,Qe,"beforeUnmount"),Xn&64?He.type.remove(He,Qe,dt,vn,Lt):Zt&&!Zt.hasOnce&&(jt!==Tr||En>0&&En&64)?ur(Zt,Qe,dt,!1,!0):(jt===Tr&&En&384||!qt&&Xn&16)&&ur(cn,Qe,dt),Lt&&oi(He)}(hr&&(Yr=Rn&&Rn.onVnodeUnmounted)||Gn)&&Sa(()=>{Yr&&Xc(Yr,Qe,He),Gn&&Xf(He,null,Qe,"unmounted")},dt)},oi=He=>{const{type:Qe,el:dt,anchor:Lt,transition:qt}=He;if(Qe===Tr){uo(dt,Lt);return}if(Qe===Dx){Ne(He);return}const jt=()=>{d(dt),qt&&!qt.persisted&&qt.afterLeave&&qt.afterLeave()};if(He.shapeFlag&1&&qt&&!qt.persisted){const{leave:Rn,delayLeave:fn}=qt,cn=()=>Rn(dt,jt);fn?fn(He.el,jt,cn):cn()}else jt()},uo=(He,Qe)=>{let dt;for(;He!==Qe;)dt=V(He),d(He),He=dt;d(Qe)},Gi=(He,Qe,dt)=>{const{bum:Lt,scope:qt,job:jt,subTree:Rn,um:fn,m:cn,a:Zt}=He;FO(cn),FO(Zt),Lt&&kx(Lt),qt.stop(),jt&&(jt.flags|=8,vr(Rn,He,Qe,dt)),fn&&Sa(fn,Qe),Sa(()=>{He.isUnmounted=!0},Qe)},ur=(He,Qe,dt,Lt=!1,qt=!1,jt=0)=>{for(let Rn=jt;Rn<He.length;Rn++)vr(He[Rn],Qe,dt,Lt,qt)},Ot=He=>{if(He.shapeFlag&6)return Ot(He.component.subTree);if(He.shapeFlag&128)return He.suspense.next();const Qe=V(He.anchor||He.el),dt=Qe&&Qe[X4];return dt?V(dt):Qe};let ln=!1;const yn=(He,Qe,dt)=>{He==null?Qe._vnode&&vr(Qe._vnode,null,null,!0):de(Qe._vnode||null,He,Qe,null,null,null,dt),Qe._vnode=He,ln||(ln=!0,CO(),q4(),ln=!1)},vn={p:de,um:vr,m:or,r:oi,mt:Mn,mc:we,pc:ar,pbc:je,n:Ot,o:t};return{render:yn,hydrate:void 0,createApp:ZU(yn)}}function QE({type:t,props:e},n){return n==="svg"&&t==="foreignObject"||n==="mathml"&&t==="annotation-xml"&&e&&e.encoding&&e.encoding.includes("html")?void 0:n}function Yf({effect:t,job:e},n){n?(t.flags|=32,e.flags|=4):(t.flags&=-33,e.flags&=-5)}function ij(t,e){return(!t||t&&!t.pendingBranch)&&e&&!e.persisted}function HI(t,e,n=!1){const l=t.children,d=e.children;if(Cr(l)&&Cr(d))for(let f=0;f<l.length;f++){const x=l[f];let s=d[f];s.shapeFlag&1&&!s.dynamicChildren&&((s.patchFlag<=0||s.patchFlag===32)&&(s=d[f]=Sh(d[f]),s.el=x.el),!n&&s.patchFlag!==-2&&HI(x,s)),s.type===nT&&s.patchFlag!==-1&&(s.el=x.el),s.type===oa&&!s.el&&(s.el=x.el)}}function oj(t){const e=t.slice(),n=[0];let l,d,f,x,s;const C=t.length;for(l=0;l<C;l++){const P=t[l];if(P!==0){if(d=n[n.length-1],t[d]<P){e[l]=d,n.push(l);continue}for(f=0,x=n.length-1;f<x;)s=f+x>>1,t[n[s]]<P?f=s+1:x=s;P<t[n[f]]&&(f>0&&(e[l]=n[f-1]),n[f]=l)}}for(f=n.length,x=n[f-1];f-- >0;)n[f]=x,x=e[x];return n}function x6(t){const e=t.subTree.component;if(e)return e.asyncDep&&!e.asyncResolved?e:x6(e)}function FO(t){if(t)for(let e=0;e<t.length;e++)t[e].flags|=8}const sj=Symbol.for("v-scx"),aj=()=>fc(sj);function ru(t,e,n){return w6(t,e,n)}function w6(t,e,n=wo){const{immediate:l,deep:d,flush:f,once:x}=n,s=ks({},n),C=e&&l||!e&&f!=="post";let P;if(jv){if(f==="sync"){const j=aj();P=j.__watcherHandles||(j.__watcherHandles=[])}else if(!C){const j=()=>{};return j.stop=iu,j.resume=iu,j.pause=iu,j}}const L=sa;s.call=(j,ue,de)=>mc(j,L,ue,de);let $=!1;f==="post"?s.scheduler=j=>{Sa(j,L&&L.suspense)}:f!=="sync"&&($=!0,s.scheduler=(j,ue)=>{ue?j():NI(j)}),s.augmentJob=j=>{e&&(j.flags|=4),$&&(j.flags|=2,L&&(j.id=L.uid,j.i=L))};const V=xU(t,e,s);return jv&&(P?P.push(V):C&&V()),V}function lj(t,e,n){const l=this.proxy,d=Go(t)?t.includes(".")?T6(l,t):()=>l[t]:t.bind(l,l);let f;ri(e)?f=e:(f=e.handler,n=e);const x=W0(this),s=w6(d,f.bind(l),n);return x(),s}function T6(t,e){const n=e.split(".");return()=>{let l=t;for(let d=0;d<n.length&&l;d++)l=l[n[d]];return l}}const cj=(t,e)=>e==="modelValue"||e==="model-value"?t.modelModifiers:t[`${e}Modifiers`]||t[`${zl(e)}Modifiers`]||t[`${rf(e)}Modifiers`];function uj(t,e,...n){if(t.isUnmounted)return;const l=t.vnode.props||wo;let d=n;const f=e.startsWith("update:"),x=f&&cj(l,e.slice(7));x&&(x.trim&&(d=n.map(L=>Go(L)?L.trim():L)),x.number&&(d=n.map(tw)));let s,C=l[s=Rx(e)]||l[s=Rx(zl(e))];!C&&f&&(C=l[s=Rx(rf(e))]),C&&mc(C,t,6,d);const P=l[s+"Once"];if(P){if(!t.emitted)t.emitted={};else if(t.emitted[s])return;t.emitted[s]=!0,mc(P,t,6,d)}}function S6(t,e,n=!1){const l=e.emitsCache,d=l.get(t);if(d!==void 0)return d;const f=t.emits;let x={},s=!1;if(!ri(t)){const C=P=>{const L=S6(P,e,!0);L&&(s=!0,ks(x,L))};!n&&e.mixins.length&&e.mixins.forEach(C),t.extends&&C(t.extends),t.mixins&&t.mixins.forEach(C)}return!f&&!s?(To(t)&&l.set(t,null),null):(Cr(f)?f.forEach(C=>x[C]=null):ks(x,f),To(t)&&l.set(t,x),x)}function tT(t,e){return!t||!Ww(e)?!1:(e=e.slice(2).replace(/Once$/,""),co(t,e[0].toLowerCase()+e.slice(1))||co(t,rf(e))||co(t,e))}function BO(t){const{type:e,vnode:n,proxy:l,withProxy:d,propsOptions:[f],slots:x,attrs:s,emit:C,render:P,renderCache:L,props:$,data:V,setupState:j,ctx:ue,inheritAttrs:de}=t,Te=ow(t);let Be,Ge;try{if(n.shapeFlag&4){const Ne=d||l,Mt=Ne;Be=eu(P.call(Mt,Ne,L,$,j,V,ue)),Ge=s}else{const Ne=e;Be=eu(Ne.length>1?Ne($,{attrs:s,slots:x,emit:C}):Ne($,null)),Ge=e.props?s:dj(s)}}catch(Ne){xv.length=0,Jw(Ne,t,1),Be=pr(oa)}let Ye=Be;if(Ge&&de!==!1){const Ne=Object.keys(Ge),{shapeFlag:Mt}=Ye;Ne.length&&Mt&7&&(f&&Ne.some(II)&&(Ge=hj(Ge,f)),Ye=Gh(Ye,Ge,!1,!0))}return n.dirs&&(Ye=Gh(Ye,null,!1,!0),Ye.dirs=Ye.dirs?Ye.dirs.concat(n.dirs):n.dirs),n.transition&&Bv(Ye,n.transition),Be=Ye,ow(Te),Be}const dj=t=>{let e;for(const n in t)(n==="class"||n==="style"||Ww(n))&&((e||(e={}))[n]=t[n]);return e},hj=(t,e)=>{const n={};for(const l in t)(!II(l)||!(l.slice(9)in e))&&(n[l]=t[l]);return n};function fj(t,e,n){const{props:l,children:d,component:f}=t,{props:x,children:s,patchFlag:C}=e,P=f.emitsOptions;if(e.dirs||e.transition)return!0;if(n&&C>=0){if(C&1024)return!0;if(C&16)return l?NO(l,x,P):!!x;if(C&8){const L=e.dynamicProps;for(let $=0;$<L.length;$++){const V=L[$];if(x[V]!==l[V]&&!tT(P,V))return!0}}}else return(d||s)&&(!s||!s.$stable)?!0:l===x?!1:l?x?NO(l,x,P):!0:!!x;return!1}function NO(t,e,n){const l=Object.keys(e);if(l.length!==Object.keys(t).length)return!0;for(let d=0;d<l.length;d++){const f=l[d];if(e[f]!==t[f]&&!tT(n,f))return!0}return!1}function pj({vnode:t,parent:e},n){for(;e;){const l=e.subTree;if(l.suspense&&l.suspense.activeBranch===t&&(l.el=t.el),l===t)(t=e.vnode).el=n,e=e.parent;else break}}const E6=t=>t.__isSuspense;function mj(t,e){e&&e.pendingBranch?Cr(t)?e.effects.push(...t):e.effects.push(t):SU(t)}const Tr=Symbol.for("v-fgt"),nT=Symbol.for("v-txt"),oa=Symbol.for("v-cmt"),Dx=Symbol.for("v-stc"),xv=[];let ll=null;function Me(t=!1){xv.push(ll=t?null:[])}function gj(){xv.pop(),ll=xv[xv.length-1]||null}let Vv=1;function VO(t,e=!1){Vv+=t,t<0&&ll&&e&&(ll.hasOnce=!0)}function C6(t){return t.dynamicChildren=Vv>0?ll||yg:null,gj(),Vv>0&&ll&&ll.push(t),t}function ft(t,e,n,l,d,f){return C6(Ze(t,e,n,l,d,f,!0))}function rn(t,e,n,l,d){return C6(pr(t,e,n,l,d,!0))}function $v(t){return t?t.__v_isVNode===!0:!1}function ip(t,e){return t.type===e.type&&t.key===e.key}const I6=({key:t})=>t??null,Lx=({ref:t,ref_key:e,ref_for:n})=>(typeof t=="number"&&(t=""+t),t!=null?Go(t)||aa(t)||ri(t)?{i:js,r:t,k:e,f:!!n}:t:null);function Ze(t,e=null,n=null,l=0,d=null,f=t===Tr?0:1,x=!1,s=!1){const C={__v_isVNode:!0,__v_skip:!0,type:t,props:e,key:e&&I6(e),ref:e&&Lx(e),scopeId:Z4,slotScopeIds:null,children:n,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:f,patchFlag:l,dynamicProps:d,dynamicChildren:null,appContext:null,ctx:js};return s?(WI(C,n),f&128&&t.normalize(C)):n&&(C.shapeFlag|=Go(n)?8:16),Vv>0&&!x&&ll&&(C.patchFlag>0||f&6)&&C.patchFlag!==32&&ll.push(C),C}const pr=_j;function _j(t,e=null,n=null,l=0,d=null,f=!1){if((!t||t===l6)&&(t=oa),$v(t)){const s=Gh(t,e,!0);return n&&WI(s,n),Vv>0&&!f&&ll&&(s.shapeFlag&6?ll[ll.indexOf(t)]=s:ll.push(s)),s.patchFlag=-2,s}if(Aj(t)&&(t=t.__vccOpts),e){e=yj(e);let{class:s,style:C}=e;s&&!Go(s)&&(e.class=wr(s)),To(C)&&(BI(C)&&!Cr(C)&&(C=ks({},C)),e.style=$0(C))}const x=Go(t)?1:E6(t)?128:Y4(t)?64:To(t)?4:ri(t)?2:0;return Ze(t,e,n,l,d,x,f,!0)}function yj(t){return t?BI(t)||m6(t)?ks({},t):t:null}function Gh(t,e,n=!1,l=!1){const{props:d,ref:f,patchFlag:x,children:s,transition:C}=t,P=e?ot(d||{},e):d,L={__v_isVNode:!0,__v_skip:!0,type:t.type,props:P,key:P&&I6(P),ref:e&&e.ref?n&&f?Cr(f)?f.concat(Lx(e)):[f,Lx(e)]:Lx(e):f,scopeId:t.scopeId,slotScopeIds:t.slotScopeIds,children:s,target:t.target,targetStart:t.targetStart,targetAnchor:t.targetAnchor,staticCount:t.staticCount,shapeFlag:t.shapeFlag,patchFlag:e&&t.type!==Tr?x===-1?16:x|16:x,dynamicProps:t.dynamicProps,dynamicChildren:t.dynamicChildren,appContext:t.appContext,dirs:t.dirs,transition:C,component:t.component,suspense:t.suspense,ssContent:t.ssContent&&Gh(t.ssContent),ssFallback:t.ssFallback&&Gh(t.ssFallback),placeholder:t.placeholder,el:t.el,anchor:t.anchor,ctx:t.ctx,ce:t.ce};return C&&l&&Bv(L,C.clone(L)),L}function Ra(t=" ",e=0){return pr(nT,null,t,e)}function vj(t,e){const n=pr(Dx,null,t);return n.staticCount=e,n}function Pn(t="",e=!1){return e?(Me(),rn(oa,null,t)):pr(oa,null,t)}function eu(t){return t==null||typeof t=="boolean"?pr(oa):Cr(t)?pr(Tr,null,t.slice()):$v(t)?Sh(t):pr(nT,null,String(t))}function Sh(t){return t.el===null&&t.patchFlag!==-1||t.memo?t:Gh(t)}function WI(t,e){let n=0;const{shapeFlag:l}=t;if(e==null)e=null;else if(Cr(e))n=16;else if(typeof e=="object")if(l&65){const d=e.default;d&&(d._c&&(d._d=!1),WI(t,d()),d._c&&(d._d=!0));return}else{n=32;const d=e._;!d&&!m6(e)?e._ctx=js:d===3&&js&&(js.slots._===1?e._=1:(e._=2,t.patchFlag|=1024))}else ri(e)?(e={default:e,_ctx:js},n=32):(e=String(e),l&64?(n=16,e=[Ra(e)]):n=8);t.children=e,t.shapeFlag|=n}function ot(...t){const e={};for(let n=0;n<t.length;n++){const l=t[n];for(const d in l)if(d==="class")e.class!==l.class&&(e.class=wr([e.class,l.class]));else if(d==="style")e.style=$0([e.style,l.style]);else if(Ww(d)){const f=e[d],x=l[d];x&&f!==x&&!(Cr(f)&&f.includes(x))&&(e[d]=f?[].concat(f,x):x)}else d!==""&&(e[d]=l[d])}return e}function Xc(t,e,n,l=null){mc(t,e,7,[n,l])}const bj=h6();let xj=0;function wj(t,e,n){const l=t.type,d=(e?e.appContext:t.appContext)||bj,f={uid:xj++,vnode:t,type:l,parent:e,appContext:d,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new C4(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:e?e.provides:Object.create(d.provides),ids:e?e.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:_6(l,d),emitsOptions:S6(l,d),emit:null,emitted:null,propsDefaults:wo,inheritAttrs:l.inheritAttrs,ctx:wo,data:wo,props:wo,attrs:wo,slots:wo,refs:wo,setupState:wo,setupContext:null,suspense:n,suspenseId:n?n.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return f.ctx={_:f},f.root=e?e.root:f,f.emit=uj.bind(null,f),t.ce&&t.ce(f),f}let sa=null;const Uv=()=>sa||js;let aw,ZC;{const t=Zw(),e=(n,l)=>{let d;return(d=t[n])||(d=t[n]=[]),d.push(l),f=>{d.length>1?d.forEach(x=>x(f)):d[0](f)}};aw=e("__VUE_INSTANCE_SETTERS__",n=>sa=n),ZC=e("__VUE_SSR_SETTERS__",n=>jv=n)}const W0=t=>{const e=sa;return aw(t),t.scope.on(),()=>{t.scope.off(),aw(e)}},$O=()=>{sa&&sa.scope.off(),aw(null)};function A6(t){return t.vnode.shapeFlag&4}let jv=!1;function Tj(t,e=!1,n=!1){e&&ZC(e);const{props:l,children:d}=t.vnode,f=A6(t);XU(t,l,f,e),ej(t,d,n||e);const x=f?Sj(t,e):void 0;return e&&ZC(!1),x}function Sj(t,e){const n=t.type;t.accessCache=Object.create(null),t.proxy=new Proxy(t.ctx,UU);const{setup:l}=n;if(l){yd();const d=t.setupContext=l.length>1?Cj(t):null,f=W0(t),x=j0(l,t,0,[t.props,d]),s=v4(x);if(vd(),f(),(s||t.sp)&&!wg(t)&&o6(t),s){if(x.then($O,$O),e)return x.then(C=>{UO(t,C)}).catch(C=>{Jw(C,t,0)});t.asyncDep=x}else UO(t,x)}else P6(t)}function UO(t,e,n){ri(e)?t.type.__ssrInlineRender?t.ssrRender=e:t.render=e:To(e)&&(t.setupState=G4(e)),P6(t)}function P6(t,e,n){const l=t.type;t.render||(t.render=l.render||iu);{const d=W0(t);yd();try{jU(t)}finally{vd(),d()}}}const Ej={get(t,e){return ia(t,"get",""),t[e]}};function Cj(t){const e=n=>{t.exposed=n||{}};return{attrs:new Proxy(t.attrs,Ej),slots:t.slots,emit:t.emit,expose:e}}function rT(t){return t.exposed?t.exposeProxy||(t.exposeProxy=new Proxy(G4(U4(t.exposed)),{get(e,n){if(n in e)return e[n];if(n in bv)return bv[n](t)},has(e,n){return n in e||n in bv}})):t.proxy}function Ij(t,e=!0){return ri(t)?t.displayName||t.name:t.name||e&&t.__name}function Aj(t){return ri(t)&&"__vccOpts"in t}const ps=(t,e)=>vU(t,e,jv);function qI(t,e,n){const l=arguments.length;return l===2?To(e)&&!Cr(e)?$v(e)?pr(t,null,[e]):pr(t,e):pr(t,null,e):(l>3?n=Array.prototype.slice.call(arguments,2):l===3&&$v(n)&&(n=[n]),pr(t,e,n))}const Pj="3.5.20";/**
* @vue/runtime-dom v3.5.20
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let XC;const jO=typeof window<"u"&&window.trustedTypes;if(jO)try{XC=jO.createPolicy("vue",{createHTML:t=>t})}catch{}const R6=XC?t=>XC.createHTML(t):t=>t,Rj="http://www.w3.org/2000/svg",kj="http://www.w3.org/1998/Math/MathML",ad=typeof document<"u"?document:null,GO=ad&&ad.createElement("template"),Oj={insert:(t,e,n)=>{e.insertBefore(t,n||null)},remove:t=>{const e=t.parentNode;e&&e.removeChild(t)},createElement:(t,e,n,l)=>{const d=e==="svg"?ad.createElementNS(Rj,t):e==="mathml"?ad.createElementNS(kj,t):n?ad.createElement(t,{is:n}):ad.createElement(t);return t==="select"&&l&&l.multiple!=null&&d.setAttribute("multiple",l.multiple),d},createText:t=>ad.createTextNode(t),createComment:t=>ad.createComment(t),setText:(t,e)=>{t.nodeValue=e},setElementText:(t,e)=>{t.textContent=e},parentNode:t=>t.parentNode,nextSibling:t=>t.nextSibling,querySelector:t=>ad.querySelector(t),setScopeId(t,e){t.setAttribute(e,"")},insertStaticContent(t,e,n,l,d,f){const x=n?n.previousSibling:e.lastChild;if(d&&(d===f||d.nextSibling))for(;e.insertBefore(d.cloneNode(!0),n),!(d===f||!(d=d.nextSibling)););else{GO.innerHTML=R6(l==="svg"?`<svg>${t}</svg>`:l==="mathml"?`<math>${t}</math>`:t);const s=GO.content;if(l==="svg"||l==="mathml"){const C=s.firstChild;for(;C.firstChild;)s.appendChild(C.firstChild);s.removeChild(C)}e.insertBefore(s,n)}return[x?x.nextSibling:e.firstChild,n?n.previousSibling:e.lastChild]}},yh="transition",Zy="animation",Gv=Symbol("_vtc"),k6={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},Mj=ks({},e6,k6),Dj=t=>(t.displayName="Transition",t.props=Mj,t),O6=Dj((t,{slots:e})=>qI(PU,Lj(t),e)),Jf=(t,e=[])=>{Cr(t)?t.forEach(n=>n(...e)):t&&t(...e)},HO=t=>t?Cr(t)?t.some(e=>e.length>1):t.length>1:!1;function Lj(t){const e={};for(const Ve in t)Ve in k6||(e[Ve]=t[Ve]);if(t.css===!1)return e;const{name:n="v",type:l,duration:d,enterFromClass:f=`${n}-enter-from`,enterActiveClass:x=`${n}-enter-active`,enterToClass:s=`${n}-enter-to`,appearFromClass:C=f,appearActiveClass:P=x,appearToClass:L=s,leaveFromClass:$=`${n}-leave-from`,leaveActiveClass:V=`${n}-leave-active`,leaveToClass:j=`${n}-leave-to`}=t,ue=zj(d),de=ue&&ue[0],Te=ue&&ue[1],{onBeforeEnter:Be,onEnter:Ge,onEnterCancelled:Ye,onLeave:Ne,onLeaveCancelled:Mt,onBeforeAppear:kt=Be,onAppear:Pe=Ge,onAppearCancelled:we=Ye}=e,Se=(Ve,ke,Mn,bn)=>{Ve._enterCancelled=bn,Qf(Ve,ke?L:s),Qf(Ve,ke?P:x),Mn&&Mn()},je=(Ve,ke)=>{Ve._isLeaving=!1,Qf(Ve,$),Qf(Ve,j),Qf(Ve,V),ke&&ke()},Re=Ve=>(ke,Mn)=>{const bn=Ve?Pe:Ge,mn=()=>Se(ke,Ve,Mn);Jf(bn,[ke,mn]),WO(()=>{Qf(ke,Ve?C:f),id(ke,Ve?L:s),HO(bn)||qO(ke,l,de,mn)})};return ks(e,{onBeforeEnter(Ve){Jf(Be,[Ve]),id(Ve,f),id(Ve,x)},onBeforeAppear(Ve){Jf(kt,[Ve]),id(Ve,C),id(Ve,P)},onEnter:Re(!1),onAppear:Re(!0),onLeave(Ve,ke){Ve._isLeaving=!0;const Mn=()=>je(Ve,ke);id(Ve,$),Ve._enterCancelled?(id(Ve,V),XO()):(XO(),id(Ve,V)),WO(()=>{Ve._isLeaving&&(Qf(Ve,$),id(Ve,j),HO(Ne)||qO(Ve,l,Te,Mn))}),Jf(Ne,[Ve,Mn])},onEnterCancelled(Ve){Se(Ve,!1,void 0,!0),Jf(Ye,[Ve])},onAppearCancelled(Ve){Se(Ve,!0,void 0,!0),Jf(we,[Ve])},onLeaveCancelled(Ve){je(Ve),Jf(Mt,[Ve])}})}function zj(t){if(t==null)return null;if(To(t))return[eC(t.enter),eC(t.leave)];{const e=eC(t);return[e,e]}}function eC(t){return $9(t)}function id(t,e){e.split(/\s+/).forEach(n=>n&&t.classList.add(n)),(t[Gv]||(t[Gv]=new Set)).add(e)}function Qf(t,e){e.split(/\s+/).forEach(l=>l&&t.classList.remove(l));const n=t[Gv];n&&(n.delete(e),n.size||(t[Gv]=void 0))}function WO(t){requestAnimationFrame(()=>{requestAnimationFrame(t)})}let Fj=0;function qO(t,e,n,l){const d=t._endId=++Fj,f=()=>{d===t._endId&&l()};if(n!=null)return setTimeout(f,n);const{type:x,timeout:s,propCount:C}=Bj(t,e);if(!x)return l();const P=x+"end";let L=0;const $=()=>{t.removeEventListener(P,V),f()},V=j=>{j.target===t&&++L>=C&&$()};setTimeout(()=>{L<C&&$()},s+1),t.addEventListener(P,V)}function Bj(t,e){const n=window.getComputedStyle(t),l=ue=>(n[ue]||"").split(", "),d=l(`${yh}Delay`),f=l(`${yh}Duration`),x=KO(d,f),s=l(`${Zy}Delay`),C=l(`${Zy}Duration`),P=KO(s,C);let L=null,$=0,V=0;e===yh?x>0&&(L=yh,$=x,V=f.length):e===Zy?P>0&&(L=Zy,$=P,V=C.length):($=Math.max(x,P),L=$>0?x>P?yh:Zy:null,V=L?L===yh?f.length:C.length:0);const j=L===yh&&/\b(transform|all)(,|$)/.test(l(`${yh}Property`).toString());return{type:L,timeout:$,propCount:V,hasTransform:j}}function KO(t,e){for(;t.length<e.length;)t=t.concat(t);return Math.max(...e.map((n,l)=>ZO(n)+ZO(t[l])))}function ZO(t){return t==="auto"?0:Number(t.slice(0,-1).replace(",","."))*1e3}function XO(){return document.body.offsetHeight}function Nj(t,e,n){const l=t[Gv];l&&(e=(e?[e,...l]:[...l]).join(" ")),e==null?t.removeAttribute("class"):n?t.setAttribute("class",e):t.className=e}const lw=Symbol("_vod"),M6=Symbol("_vsh"),Vj={name:"show",beforeMount(t,{value:e},{transition:n}){t[lw]=t.style.display==="none"?"":t.style.display,n&&e?n.beforeEnter(t):Xy(t,e)},mounted(t,{value:e},{transition:n}){n&&e&&n.enter(t)},updated(t,{value:e,oldValue:n},{transition:l}){!e!=!n&&(l?e?(l.beforeEnter(t),Xy(t,!0),l.enter(t)):l.leave(t,()=>{Xy(t,!1)}):Xy(t,e))},beforeUnmount(t,{value:e}){Xy(t,e)}};function Xy(t,e){t.style.display=e?t[lw]:"none",t[M6]=!e}const $j=Symbol(""),Uj=/(^|;)\s*display\s*:/;function jj(t,e,n){const l=t.style,d=Go(n);let f=!1;if(n&&!d){if(e)if(Go(e))for(const x of e.split(";")){const s=x.slice(0,x.indexOf(":")).trim();n[s]==null&&zx(l,s,"")}else for(const x in e)n[x]==null&&zx(l,x,"");for(const x in n)x==="display"&&(f=!0),zx(l,x,n[x])}else if(d){if(e!==n){const x=l[$j];x&&(n+=";"+x),l.cssText=n,f=Uj.test(n)}}else e&&t.removeAttribute("style");lw in t&&(t[lw]=f?l.display:"",t[M6]&&(l.display="none"))}const YO=/\s*!important$/;function zx(t,e,n){if(Cr(n))n.forEach(l=>zx(t,e,l));else if(n==null&&(n=""),e.startsWith("--"))t.setProperty(e,n);else{const l=Gj(t,e);YO.test(n)?t.setProperty(rf(l),n.replace(YO,""),"important"):t[l]=n}}const JO=["Webkit","Moz","ms"],tC={};function Gj(t,e){const n=tC[e];if(n)return n;let l=zl(e);if(l!=="filter"&&l in t)return tC[e]=l;l=Kw(l);for(let d=0;d<JO.length;d++){const f=JO[d]+l;if(f in t)return tC[e]=f}return e}const QO="http://www.w3.org/1999/xlink";function eM(t,e,n,l,d,f=q9(e)){l&&e.startsWith("xlink:")?n==null?t.removeAttributeNS(QO,e.slice(6,e.length)):t.setAttributeNS(QO,e,n):n==null||f&&!T4(n)?t.removeAttribute(e):t.setAttribute(e,f?"":pc(n)?String(n):n)}function tM(t,e,n,l,d){if(e==="innerHTML"||e==="textContent"){n!=null&&(t[e]=e==="innerHTML"?R6(n):n);return}const f=t.tagName;if(e==="value"&&f!=="PROGRESS"&&!f.includes("-")){const s=f==="OPTION"?t.getAttribute("value")||"":t.value,C=n==null?t.type==="checkbox"?"on":"":String(n);(s!==C||!("_value"in t))&&(t.value=C),n==null&&t.removeAttribute(e),t._value=n;return}let x=!1;if(n===""||n==null){const s=typeof t[e];s==="boolean"?n=T4(n):n==null&&s==="string"?(n="",x=!0):s==="number"&&(n=0,x=!0)}try{t[e]=n}catch{}x&&t.removeAttribute(d||e)}function Ch(t,e,n,l){t.addEventListener(e,n,l)}function Hj(t,e,n,l){t.removeEventListener(e,n,l)}const nM=Symbol("_vei");function Wj(t,e,n,l,d=null){const f=t[nM]||(t[nM]={}),x=f[e];if(l&&x)x.value=l;else{const[s,C]=qj(e);if(l){const P=f[e]=Xj(l,d);Ch(t,s,P,C)}else x&&(Hj(t,s,x,C),f[e]=void 0)}}const rM=/(?:Once|Passive|Capture)$/;function qj(t){let e;if(rM.test(t)){e={};let l;for(;l=t.match(rM);)t=t.slice(0,t.length-l[0].length),e[l[0].toLowerCase()]=!0}return[t[2]===":"?t.slice(3):rf(t.slice(2)),e]}let nC=0;const Kj=Promise.resolve(),Zj=()=>nC||(Kj.then(()=>nC=0),nC=Date.now());function Xj(t,e){const n=l=>{if(!l._vts)l._vts=Date.now();else if(l._vts<=n.attached)return;mc(Yj(l,n.value),e,5,[l])};return n.value=t,n.attached=Zj(),n}function Yj(t,e){if(Cr(e)){const n=t.stopImmediatePropagation;return t.stopImmediatePropagation=()=>{n.call(t),t._stopped=!0},e.map(l=>d=>!d._stopped&&l&&l(d))}else return e}const iM=t=>t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&t.charCodeAt(2)>96&&t.charCodeAt(2)<123,Jj=(t,e,n,l,d,f)=>{const x=d==="svg";e==="class"?Nj(t,l,x):e==="style"?jj(t,n,l):Ww(e)?II(e)||Wj(t,e,n,l,f):(e[0]==="."?(e=e.slice(1),!0):e[0]==="^"?(e=e.slice(1),!1):Qj(t,e,l,x))?(tM(t,e,l),!t.tagName.includes("-")&&(e==="value"||e==="checked"||e==="selected")&&eM(t,e,l,x,f,e!=="value")):t._isVueCE&&(/[A-Z]/.test(e)||!Go(l))?tM(t,zl(e),l,f,e):(e==="true-value"?t._trueValue=l:e==="false-value"&&(t._falseValue=l),eM(t,e,l,x))};function Qj(t,e,n,l){if(l)return!!(e==="innerHTML"||e==="textContent"||e in t&&iM(e)&&ri(n));if(e==="spellcheck"||e==="draggable"||e==="translate"||e==="autocorrect"||e==="form"||e==="list"&&t.tagName==="INPUT"||e==="type"&&t.tagName==="TEXTAREA")return!1;if(e==="width"||e==="height"){const d=t.tagName;if(d==="IMG"||d==="VIDEO"||d==="CANVAS"||d==="SOURCE")return!1}return iM(e)&&Go(n)?!1:e in t}const Rg=t=>{const e=t.props["onUpdate:modelValue"]||!1;return Cr(e)?n=>kx(e,n):e};function eG(t){t.target.composing=!0}function oM(t){const e=t.target;e.composing&&(e.composing=!1,e.dispatchEvent(new Event("input")))}const fd=Symbol("_assign"),Ps={created(t,{modifiers:{lazy:e,trim:n,number:l}},d){t[fd]=Rg(d);const f=l||d.props&&d.props.type==="number";Ch(t,e?"change":"input",x=>{if(x.target.composing)return;let s=t.value;n&&(s=s.trim()),f&&(s=tw(s)),t[fd](s)}),n&&Ch(t,"change",()=>{t.value=t.value.trim()}),e||(Ch(t,"compositionstart",eG),Ch(t,"compositionend",oM),Ch(t,"change",oM))},mounted(t,{value:e}){t.value=e??""},beforeUpdate(t,{value:e,oldValue:n,modifiers:{lazy:l,trim:d,number:f}},x){if(t[fd]=Rg(x),t.composing)return;const s=(f||t.type==="number")&&!/^0\d/.test(t.value)?tw(t.value):t.value,C=e??"";s!==C&&(document.activeElement===t&&t.type!=="range"&&(l&&e===n||d&&t.value.trim()===C)||(t.value=C))}},tG={deep:!0,created(t,e,n){t[fd]=Rg(n),Ch(t,"change",()=>{const l=t._modelValue,d=Hv(t),f=t.checked,x=t[fd];if(Cr(l)){const s=RI(l,d),C=s!==-1;if(f&&!C)x(l.concat(d));else if(!f&&C){const P=[...l];P.splice(s,1),x(P)}}else if(Yg(l)){const s=new Set(l);f?s.add(d):s.delete(d),x(s)}else x(D6(t,f))})},mounted:sM,beforeUpdate(t,e,n){t[fd]=Rg(n),sM(t,e,n)}};function sM(t,{value:e,oldValue:n},l){t._modelValue=e;let d;if(Cr(e))d=RI(e,l.props.value)>-1;else if(Yg(e))d=e.has(l.props.value);else{if(e===n)return;d=U0(e,D6(t,!0))}t.checked!==d&&(t.checked=d)}const Fx={deep:!0,created(t,{value:e,modifiers:{number:n}},l){const d=Yg(e);Ch(t,"change",()=>{const f=Array.prototype.filter.call(t.options,x=>x.selected).map(x=>n?tw(Hv(x)):Hv(x));t[fd](t.multiple?d?new Set(f):f:f[0]),t._assigning=!0,G0(()=>{t._assigning=!1})}),t[fd]=Rg(l)},mounted(t,{value:e}){aM(t,e)},beforeUpdate(t,e,n){t[fd]=Rg(n)},updated(t,{value:e}){t._assigning||aM(t,e)}};function aM(t,e){const n=t.multiple,l=Cr(e);if(!(n&&!l&&!Yg(e))){for(let d=0,f=t.options.length;d<f;d++){const x=t.options[d],s=Hv(x);if(n)if(l){const C=typeof s;C==="string"||C==="number"?x.selected=e.some(P=>String(P)===String(s)):x.selected=RI(e,s)>-1}else x.selected=e.has(s);else if(U0(Hv(x),e)){t.selectedIndex!==d&&(t.selectedIndex=d);return}}!n&&t.selectedIndex!==-1&&(t.selectedIndex=-1)}}function Hv(t){return"_value"in t?t._value:t.value}function D6(t,e){const n=e?"_trueValue":"_falseValue";return n in t?t[n]:e}const nG=["ctrl","shift","alt","meta"],rG={stop:t=>t.stopPropagation(),prevent:t=>t.preventDefault(),self:t=>t.target!==t.currentTarget,ctrl:t=>!t.ctrlKey,shift:t=>!t.shiftKey,alt:t=>!t.altKey,meta:t=>!t.metaKey,left:t=>"button"in t&&t.button!==0,middle:t=>"button"in t&&t.button!==1,right:t=>"button"in t&&t.button!==2,exact:(t,e)=>nG.some(n=>t[`${n}Key`]&&!e.includes(n))},Id=(t,e)=>{const n=t._withMods||(t._withMods={}),l=e.join(".");return n[l]||(n[l]=((d,...f)=>{for(let x=0;x<e.length;x++){const s=rG[e[x]];if(s&&s(d,e))return}return t(d,...f)}))},iG={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},rC=(t,e)=>{const n=t._withKeys||(t._withKeys={}),l=e.join(".");return n[l]||(n[l]=(d=>{if(!("key"in d))return;const f=rf(d.key);if(e.some(x=>x===f||iG[x]===f))return t(d)}))},oG=ks({patchProp:Jj},Oj);let lM;function sG(){return lM||(lM=nj(oG))}const aG=((...t)=>{const e=sG().createApp(...t),{mount:n}=e;return e.mount=l=>{const d=cG(l);if(!d)return;const f=e._component;!ri(f)&&!f.render&&!f.template&&(f.template=d.innerHTML),d.nodeType===1&&(d.textContent="");const x=n(d,!1,lG(d));return d instanceof Element&&(d.removeAttribute("v-cloak"),d.setAttribute("data-v-app","")),x},e});function lG(t){if(t instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&t instanceof MathMLElement)return"mathml"}function cG(t){return Go(t)?document.querySelector(t):t}/*!
  * vue-router v4.5.1
  * (c) 2025 Eduardo San Martin Morote
  * @license MIT
  */const rg=typeof document<"u";function L6(t){return typeof t=="object"||"displayName"in t||"props"in t||"__vccOpts"in t}function uG(t){return t.__esModule||t[Symbol.toStringTag]==="Module"||t.default&&L6(t.default)}const ao=Object.assign;function iC(t,e){const n={};for(const l in e){const d=e[l];n[l]=gc(d)?d.map(t):t(d)}return n}const wv=()=>{},gc=Array.isArray,z6=/#/g,dG=/&/g,hG=/\//g,fG=/=/g,pG=/\?/g,F6=/\+/g,mG=/%5B/g,gG=/%5D/g,B6=/%5E/g,_G=/%60/g,N6=/%7B/g,yG=/%7C/g,V6=/%7D/g,vG=/%20/g;function KI(t){return encodeURI(""+t).replace(yG,"|").replace(mG,"[").replace(gG,"]")}function bG(t){return KI(t).replace(N6,"{").replace(V6,"}").replace(B6,"^")}function YC(t){return KI(t).replace(F6,"%2B").replace(vG,"+").replace(z6,"%23").replace(dG,"%26").replace(_G,"`").replace(N6,"{").replace(V6,"}").replace(B6,"^")}function xG(t){return YC(t).replace(fG,"%3D")}function wG(t){return KI(t).replace(z6,"%23").replace(pG,"%3F")}function TG(t){return t==null?"":wG(t).replace(hG,"%2F")}function Wv(t){try{return decodeURIComponent(""+t)}catch{}return""+t}const SG=/\/$/,EG=t=>t.replace(SG,"");function oC(t,e,n="/"){let l,d={},f="",x="";const s=e.indexOf("#");let C=e.indexOf("?");return s<C&&s>=0&&(C=-1),C>-1&&(l=e.slice(0,C),f=e.slice(C+1,s>-1?s:e.length),d=t(f)),s>-1&&(l=l||e.slice(0,s),x=e.slice(s,e.length)),l=PG(l??e,n),{fullPath:l+(f&&"?")+f+x,path:l,query:d,hash:Wv(x)}}function CG(t,e){const n=e.query?t(e.query):"";return e.path+(n&&"?")+n+(e.hash||"")}function cM(t,e){return!e||!t.toLowerCase().startsWith(e.toLowerCase())?t:t.slice(e.length)||"/"}function IG(t,e,n){const l=e.matched.length-1,d=n.matched.length-1;return l>-1&&l===d&&kg(e.matched[l],n.matched[d])&&$6(e.params,n.params)&&t(e.query)===t(n.query)&&e.hash===n.hash}function kg(t,e){return(t.aliasOf||t)===(e.aliasOf||e)}function $6(t,e){if(Object.keys(t).length!==Object.keys(e).length)return!1;for(const n in t)if(!AG(t[n],e[n]))return!1;return!0}function AG(t,e){return gc(t)?uM(t,e):gc(e)?uM(e,t):t===e}function uM(t,e){return gc(e)?t.length===e.length&&t.every((n,l)=>n===e[l]):t.length===1&&t[0]===e}function PG(t,e){if(t.startsWith("/"))return t;if(!t)return e;const n=e.split("/"),l=t.split("/"),d=l[l.length-1];(d===".."||d===".")&&l.push("");let f=n.length-1,x,s;for(x=0;x<l.length;x++)if(s=l[x],s!==".")if(s==="..")f>1&&f--;else break;return n.slice(0,f).join("/")+"/"+l.slice(x).join("/")}const vh={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0};var qv;(function(t){t.pop="pop",t.push="push"})(qv||(qv={}));var Tv;(function(t){t.back="back",t.forward="forward",t.unknown=""})(Tv||(Tv={}));function RG(t){if(!t)if(rg){const e=document.querySelector("base");t=e&&e.getAttribute("href")||"/",t=t.replace(/^\w+:\/\/[^\/]+/,"")}else t="/";return t[0]!=="/"&&t[0]!=="#"&&(t="/"+t),EG(t)}const kG=/^[^#]+#/;function OG(t,e){return t.replace(kG,"#")+e}function MG(t,e){const n=document.documentElement.getBoundingClientRect(),l=t.getBoundingClientRect();return{behavior:e.behavior,left:l.left-n.left-(e.left||0),top:l.top-n.top-(e.top||0)}}const iT=()=>({left:window.scrollX,top:window.scrollY});function DG(t){let e;if("el"in t){const n=t.el,l=typeof n=="string"&&n.startsWith("#"),d=typeof n=="string"?l?document.getElementById(n.slice(1)):document.querySelector(n):n;if(!d)return;e=MG(d,t)}else e=t;"scrollBehavior"in document.documentElement.style?window.scrollTo(e):window.scrollTo(e.left!=null?e.left:window.scrollX,e.top!=null?e.top:window.scrollY)}function dM(t,e){return(history.state?history.state.position-e:-1)+t}const JC=new Map;function LG(t,e){JC.set(t,e)}function zG(t){const e=JC.get(t);return JC.delete(t),e}let FG=()=>location.protocol+"//"+location.host;function U6(t,e){const{pathname:n,search:l,hash:d}=e,f=t.indexOf("#");if(f>-1){let s=d.includes(t.slice(f))?t.slice(f).length:1,C=d.slice(s);return C[0]!=="/"&&(C="/"+C),cM(C,"")}return cM(n,t)+l+d}function BG(t,e,n,l){let d=[],f=[],x=null;const s=({state:V})=>{const j=U6(t,location),ue=n.value,de=e.value;let Te=0;if(V){if(n.value=j,e.value=V,x&&x===ue){x=null;return}Te=de?V.position-de.position:0}else l(j);d.forEach(Be=>{Be(n.value,ue,{delta:Te,type:qv.pop,direction:Te?Te>0?Tv.forward:Tv.back:Tv.unknown})})};function C(){x=n.value}function P(V){d.push(V);const j=()=>{const ue=d.indexOf(V);ue>-1&&d.splice(ue,1)};return f.push(j),j}function L(){const{history:V}=window;V.state&&V.replaceState(ao({},V.state,{scroll:iT()}),"")}function $(){for(const V of f)V();f=[],window.removeEventListener("popstate",s),window.removeEventListener("beforeunload",L)}return window.addEventListener("popstate",s),window.addEventListener("beforeunload",L,{passive:!0}),{pauseListeners:C,listen:P,destroy:$}}function hM(t,e,n,l=!1,d=!1){return{back:t,current:e,forward:n,replaced:l,position:window.history.length,scroll:d?iT():null}}function NG(t){const{history:e,location:n}=window,l={value:U6(t,n)},d={value:e.state};d.value||f(l.value,{back:null,current:l.value,forward:null,position:e.length-1,replaced:!0,scroll:null},!0);function f(C,P,L){const $=t.indexOf("#"),V=$>-1?(n.host&&document.querySelector("base")?t:t.slice($))+C:FG()+t+C;try{e[L?"replaceState":"pushState"](P,"",V),d.value=P}catch(j){console.error(j),n[L?"replace":"assign"](V)}}function x(C,P){const L=ao({},e.state,hM(d.value.back,C,d.value.forward,!0),P,{position:d.value.position});f(C,L,!0),l.value=C}function s(C,P){const L=ao({},d.value,e.state,{forward:C,scroll:iT()});f(L.current,L,!0);const $=ao({},hM(l.value,C,null),{position:L.position+1},P);f(C,$,!1),l.value=C}return{location:l,state:d,push:s,replace:x}}function VG(t){t=RG(t);const e=NG(t),n=BG(t,e.state,e.location,e.replace);function l(f,x=!0){x||n.pauseListeners(),history.go(f)}const d=ao({location:"",base:t,go:l,createHref:OG.bind(null,t)},e,n);return Object.defineProperty(d,"location",{enumerable:!0,get:()=>e.location.value}),Object.defineProperty(d,"state",{enumerable:!0,get:()=>e.state.value}),d}function $G(t){return typeof t=="string"||t&&typeof t=="object"}function j6(t){return typeof t=="string"||typeof t=="symbol"}const G6=Symbol("");var fM;(function(t){t[t.aborted=4]="aborted",t[t.cancelled=8]="cancelled",t[t.duplicated=16]="duplicated"})(fM||(fM={}));function Og(t,e){return ao(new Error,{type:t,[G6]:!0},e)}function od(t,e){return t instanceof Error&&G6 in t&&(e==null||!!(t.type&e))}const pM="[^/]+?",UG={sensitive:!1,strict:!1,start:!0,end:!0},jG=/[.+*?^${}()[\]/\\]/g;function GG(t,e){const n=ao({},UG,e),l=[];let d=n.start?"^":"";const f=[];for(const P of t){const L=P.length?[]:[90];n.strict&&!P.length&&(d+="/");for(let $=0;$<P.length;$++){const V=P[$];let j=40+(n.sensitive?.25:0);if(V.type===0)$||(d+="/"),d+=V.value.replace(jG,"\\$&"),j+=40;else if(V.type===1){const{value:ue,repeatable:de,optional:Te,regexp:Be}=V;f.push({name:ue,repeatable:de,optional:Te});const Ge=Be||pM;if(Ge!==pM){j+=10;try{new RegExp(`(${Ge})`)}catch(Ne){throw new Error(`Invalid custom RegExp for param "${ue}" (${Ge}): `+Ne.message)}}let Ye=de?`((?:${Ge})(?:/(?:${Ge}))*)`:`(${Ge})`;$||(Ye=Te&&P.length<2?`(?:/${Ye})`:"/"+Ye),Te&&(Ye+="?"),d+=Ye,j+=20,Te&&(j+=-8),de&&(j+=-20),Ge===".*"&&(j+=-50)}L.push(j)}l.push(L)}if(n.strict&&n.end){const P=l.length-1;l[P][l[P].length-1]+=.7000000000000001}n.strict||(d+="/?"),n.end?d+="$":n.strict&&!d.endsWith("/")&&(d+="(?:/|$)");const x=new RegExp(d,n.sensitive?"":"i");function s(P){const L=P.match(x),$={};if(!L)return null;for(let V=1;V<L.length;V++){const j=L[V]||"",ue=f[V-1];$[ue.name]=j&&ue.repeatable?j.split("/"):j}return $}function C(P){let L="",$=!1;for(const V of t){(!$||!L.endsWith("/"))&&(L+="/"),$=!1;for(const j of V)if(j.type===0)L+=j.value;else if(j.type===1){const{value:ue,repeatable:de,optional:Te}=j,Be=ue in P?P[ue]:"";if(gc(Be)&&!de)throw new Error(`Provided param "${ue}" is an array but it is not repeatable (* or + modifiers)`);const Ge=gc(Be)?Be.join("/"):Be;if(!Ge)if(Te)V.length<2&&(L.endsWith("/")?L=L.slice(0,-1):$=!0);else throw new Error(`Missing required param "${ue}"`);L+=Ge}}return L||"/"}return{re:x,score:l,keys:f,parse:s,stringify:C}}function HG(t,e){let n=0;for(;n<t.length&&n<e.length;){const l=e[n]-t[n];if(l)return l;n++}return t.length<e.length?t.length===1&&t[0]===80?-1:1:t.length>e.length?e.length===1&&e[0]===80?1:-1:0}function H6(t,e){let n=0;const l=t.score,d=e.score;for(;n<l.length&&n<d.length;){const f=HG(l[n],d[n]);if(f)return f;n++}if(Math.abs(d.length-l.length)===1){if(mM(l))return 1;if(mM(d))return-1}return d.length-l.length}function mM(t){const e=t[t.length-1];return t.length>0&&e[e.length-1]<0}const WG={type:0,value:""},qG=/[a-zA-Z0-9_]/;function KG(t){if(!t)return[[]];if(t==="/")return[[WG]];if(!t.startsWith("/"))throw new Error(`Invalid path "${t}"`);function e(j){throw new Error(`ERR (${n})/"${P}": ${j}`)}let n=0,l=n;const d=[];let f;function x(){f&&d.push(f),f=[]}let s=0,C,P="",L="";function $(){P&&(n===0?f.push({type:0,value:P}):n===1||n===2||n===3?(f.length>1&&(C==="*"||C==="+")&&e(`A repeatable param (${P}) must be alone in its segment. eg: '/:ids+.`),f.push({type:1,value:P,regexp:L,repeatable:C==="*"||C==="+",optional:C==="*"||C==="?"})):e("Invalid state to consume buffer"),P="")}function V(){P+=C}for(;s<t.length;){if(C=t[s++],C==="\\"&&n!==2){l=n,n=4;continue}switch(n){case 0:C==="/"?(P&&$(),x()):C===":"?($(),n=1):V();break;case 4:V(),n=l;break;case 1:C==="("?n=2:qG.test(C)?V():($(),n=0,C!=="*"&&C!=="?"&&C!=="+"&&s--);break;case 2:C===")"?L[L.length-1]=="\\"?L=L.slice(0,-1)+C:n=3:L+=C;break;case 3:$(),n=0,C!=="*"&&C!=="?"&&C!=="+"&&s--,L="";break;default:e("Unknown state");break}}return n===2&&e(`Unfinished custom RegExp for param "${P}"`),$(),x(),d}function ZG(t,e,n){const l=GG(KG(t.path),n),d=ao(l,{record:t,parent:e,children:[],alias:[]});return e&&!d.record.aliasOf==!e.record.aliasOf&&e.children.push(d),d}function XG(t,e){const n=[],l=new Map;e=vM({strict:!1,end:!0,sensitive:!1},e);function d($){return l.get($)}function f($,V,j){const ue=!j,de=_M($);de.aliasOf=j&&j.record;const Te=vM(e,$),Be=[de];if("alias"in $){const Ne=typeof $.alias=="string"?[$.alias]:$.alias;for(const Mt of Ne)Be.push(_M(ao({},de,{components:j?j.record.components:de.components,path:Mt,aliasOf:j?j.record:de})))}let Ge,Ye;for(const Ne of Be){const{path:Mt}=Ne;if(V&&Mt[0]!=="/"){const kt=V.record.path,Pe=kt[kt.length-1]==="/"?"":"/";Ne.path=V.record.path+(Mt&&Pe+Mt)}if(Ge=ZG(Ne,V,Te),j?j.alias.push(Ge):(Ye=Ye||Ge,Ye!==Ge&&Ye.alias.push(Ge),ue&&$.name&&!yM(Ge)&&x($.name)),W6(Ge)&&C(Ge),de.children){const kt=de.children;for(let Pe=0;Pe<kt.length;Pe++)f(kt[Pe],Ge,j&&j.children[Pe])}j=j||Ge}return Ye?()=>{x(Ye)}:wv}function x($){if(j6($)){const V=l.get($);V&&(l.delete($),n.splice(n.indexOf(V),1),V.children.forEach(x),V.alias.forEach(x))}else{const V=n.indexOf($);V>-1&&(n.splice(V,1),$.record.name&&l.delete($.record.name),$.children.forEach(x),$.alias.forEach(x))}}function s(){return n}function C($){const V=QG($,n);n.splice(V,0,$),$.record.name&&!yM($)&&l.set($.record.name,$)}function P($,V){let j,ue={},de,Te;if("name"in $&&$.name){if(j=l.get($.name),!j)throw Og(1,{location:$});Te=j.record.name,ue=ao(gM(V.params,j.keys.filter(Ye=>!Ye.optional).concat(j.parent?j.parent.keys.filter(Ye=>Ye.optional):[]).map(Ye=>Ye.name)),$.params&&gM($.params,j.keys.map(Ye=>Ye.name))),de=j.stringify(ue)}else if($.path!=null)de=$.path,j=n.find(Ye=>Ye.re.test(de)),j&&(ue=j.parse(de),Te=j.record.name);else{if(j=V.name?l.get(V.name):n.find(Ye=>Ye.re.test(V.path)),!j)throw Og(1,{location:$,currentLocation:V});Te=j.record.name,ue=ao({},V.params,$.params),de=j.stringify(ue)}const Be=[];let Ge=j;for(;Ge;)Be.unshift(Ge.record),Ge=Ge.parent;return{name:Te,path:de,params:ue,matched:Be,meta:JG(Be)}}t.forEach($=>f($));function L(){n.length=0,l.clear()}return{addRoute:f,resolve:P,removeRoute:x,clearRoutes:L,getRoutes:s,getRecordMatcher:d}}function gM(t,e){const n={};for(const l of e)l in t&&(n[l]=t[l]);return n}function _M(t){const e={path:t.path,redirect:t.redirect,name:t.name,meta:t.meta||{},aliasOf:t.aliasOf,beforeEnter:t.beforeEnter,props:YG(t),children:t.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in t?t.components||null:t.component&&{default:t.component}};return Object.defineProperty(e,"mods",{value:{}}),e}function YG(t){const e={},n=t.props||!1;if("component"in t)e.default=n;else for(const l in t.components)e[l]=typeof n=="object"?n[l]:n;return e}function yM(t){for(;t;){if(t.record.aliasOf)return!0;t=t.parent}return!1}function JG(t){return t.reduce((e,n)=>ao(e,n.meta),{})}function vM(t,e){const n={};for(const l in t)n[l]=l in e?e[l]:t[l];return n}function QG(t,e){let n=0,l=e.length;for(;n!==l;){const f=n+l>>1;H6(t,e[f])<0?l=f:n=f+1}const d=eH(t);return d&&(l=e.lastIndexOf(d,l-1)),l}function eH(t){let e=t;for(;e=e.parent;)if(W6(e)&&H6(t,e)===0)return e}function W6({record:t}){return!!(t.name||t.components&&Object.keys(t.components).length||t.redirect)}function tH(t){const e={};if(t===""||t==="?")return e;const l=(t[0]==="?"?t.slice(1):t).split("&");for(let d=0;d<l.length;++d){const f=l[d].replace(F6," "),x=f.indexOf("="),s=Wv(x<0?f:f.slice(0,x)),C=x<0?null:Wv(f.slice(x+1));if(s in e){let P=e[s];gc(P)||(P=e[s]=[P]),P.push(C)}else e[s]=C}return e}function bM(t){let e="";for(let n in t){const l=t[n];if(n=xG(n),l==null){l!==void 0&&(e+=(e.length?"&":"")+n);continue}(gc(l)?l.map(f=>f&&YC(f)):[l&&YC(l)]).forEach(f=>{f!==void 0&&(e+=(e.length?"&":"")+n,f!=null&&(e+="="+f))})}return e}function nH(t){const e={};for(const n in t){const l=t[n];l!==void 0&&(e[n]=gc(l)?l.map(d=>d==null?null:""+d):l==null?l:""+l)}return e}const rH=Symbol(""),xM=Symbol(""),oT=Symbol(""),ZI=Symbol(""),QC=Symbol("");function Yy(){let t=[];function e(l){return t.push(l),()=>{const d=t.indexOf(l);d>-1&&t.splice(d,1)}}function n(){t=[]}return{add:e,list:()=>t.slice(),reset:n}}function Eh(t,e,n,l,d,f=x=>x()){const x=l&&(l.enterCallbacks[d]=l.enterCallbacks[d]||[]);return()=>new Promise((s,C)=>{const P=V=>{V===!1?C(Og(4,{from:n,to:e})):V instanceof Error?C(V):$G(V)?C(Og(2,{from:e,to:V})):(x&&l.enterCallbacks[d]===x&&typeof V=="function"&&x.push(V),s())},L=f(()=>t.call(l&&l.instances[d],e,n,P));let $=Promise.resolve(L);t.length<3&&($=$.then(P)),$.catch(V=>C(V))})}function sC(t,e,n,l,d=f=>f()){const f=[];for(const x of t)for(const s in x.components){let C=x.components[s];if(!(e!=="beforeRouteEnter"&&!x.instances[s]))if(L6(C)){const L=(C.__vccOpts||C)[e];L&&f.push(Eh(L,n,l,x,s,d))}else{let P=C();f.push(()=>P.then(L=>{if(!L)throw new Error(`Couldn't resolve component "${s}" at "${x.path}"`);const $=uG(L)?L.default:L;x.mods[s]=L,x.components[s]=$;const j=($.__vccOpts||$)[e];return j&&Eh(j,n,l,x,s,d)()}))}}return f}function wM(t){const e=fc(oT),n=fc(ZI),l=ps(()=>{const C=Ai(t.to);return e.resolve(C)}),d=ps(()=>{const{matched:C}=l.value,{length:P}=C,L=C[P-1],$=n.matched;if(!L||!$.length)return-1;const V=$.findIndex(kg.bind(null,L));if(V>-1)return V;const j=TM(C[P-2]);return P>1&&TM(L)===j&&$[$.length-1].path!==j?$.findIndex(kg.bind(null,C[P-2])):V}),f=ps(()=>d.value>-1&&aH(n.params,l.value.params)),x=ps(()=>d.value>-1&&d.value===n.matched.length-1&&$6(n.params,l.value.params));function s(C={}){if(sH(C)){const P=e[Ai(t.replace)?"replace":"push"](Ai(t.to)).catch(wv);return t.viewTransition&&typeof document<"u"&&"startViewTransition"in document&&document.startViewTransition(()=>P),P}return Promise.resolve()}return{route:l,href:ps(()=>l.value.href),isActive:f,isExactActive:x,navigate:s}}function iH(t){return t.length===1?t[0]:t}const oH=vu({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"},viewTransition:Boolean},useLink:wM,setup(t,{slots:e}){const n=Fl(wM(t)),{options:l}=fc(oT),d=ps(()=>({[SM(t.activeClass,l.linkActiveClass,"router-link-active")]:n.isActive,[SM(t.exactActiveClass,l.linkExactActiveClass,"router-link-exact-active")]:n.isExactActive}));return()=>{const f=e.default&&iH(e.default(n));return t.custom?f:qI("a",{"aria-current":n.isExactActive?t.ariaCurrentValue:null,href:n.href,onClick:n.navigate,class:d.value},f)}}}),ov=oH;function sH(t){if(!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)&&!t.defaultPrevented&&!(t.button!==void 0&&t.button!==0)){if(t.currentTarget&&t.currentTarget.getAttribute){const e=t.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(e))return}return t.preventDefault&&t.preventDefault(),!0}}function aH(t,e){for(const n in e){const l=e[n],d=t[n];if(typeof l=="string"){if(l!==d)return!1}else if(!gc(d)||d.length!==l.length||l.some((f,x)=>f!==d[x]))return!1}return!0}function TM(t){return t?t.aliasOf?t.aliasOf.path:t.path:""}const SM=(t,e,n)=>t??e??n,lH=vu({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(t,{attrs:e,slots:n}){const l=fc(QC),d=ps(()=>t.route||l.value),f=fc(xM,0),x=ps(()=>{let P=Ai(f);const{matched:L}=d.value;let $;for(;($=L[P])&&!$.components;)P++;return P}),s=ps(()=>d.value.matched[x.value]);Mx(xM,ps(()=>x.value+1)),Mx(rH,s),Mx(QC,d);const C=bi();return ru(()=>[C.value,s.value,t.name],([P,L,$],[V,j,ue])=>{L&&(L.instances[$]=P,j&&j!==L&&P&&P===V&&(L.leaveGuards.size||(L.leaveGuards=j.leaveGuards),L.updateGuards.size||(L.updateGuards=j.updateGuards))),P&&L&&(!j||!kg(L,j)||!V)&&(L.enterCallbacks[$]||[]).forEach(de=>de(P))},{flush:"post"}),()=>{const P=d.value,L=t.name,$=s.value,V=$&&$.components[L];if(!V)return EM(n.default,{Component:V,route:P});const j=$.props[L],ue=j?j===!0?P.params:typeof j=="function"?j(P):j:null,Te=qI(V,ao({},ue,e,{onVnodeUnmounted:Be=>{Be.component.isUnmounted&&($.instances[L]=null)},ref:C}));return EM(n.default,{Component:Te,route:P})||Te}}});function EM(t,e){if(!t)return null;const n=t(e);return n.length===1?n[0]:n}const q6=lH;function cH(t){const e=XG(t.routes,t),n=t.parseQuery||tH,l=t.stringifyQuery||bM,d=t.history,f=Yy(),x=Yy(),s=Yy(),C=mU(vh);let P=vh;rg&&t.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const L=iC.bind(null,Ot=>""+Ot),$=iC.bind(null,TG),V=iC.bind(null,Wv);function j(Ot,ln){let yn,vn;return j6(Ot)?(yn=e.getRecordMatcher(Ot),vn=ln):vn=Ot,e.addRoute(vn,yn)}function ue(Ot){const ln=e.getRecordMatcher(Ot);ln&&e.removeRoute(ln)}function de(){return e.getRoutes().map(Ot=>Ot.record)}function Te(Ot){return!!e.getRecordMatcher(Ot)}function Be(Ot,ln){if(ln=ao({},ln||C.value),typeof Ot=="string"){const dt=oC(n,Ot,ln.path),Lt=e.resolve({path:dt.path},ln),qt=d.createHref(dt.fullPath);return ao(dt,Lt,{params:V(Lt.params),hash:Wv(dt.hash),redirectedFrom:void 0,href:qt})}let yn;if(Ot.path!=null)yn=ao({},Ot,{path:oC(n,Ot.path,ln.path).path});else{const dt=ao({},Ot.params);for(const Lt in dt)dt[Lt]==null&&delete dt[Lt];yn=ao({},Ot,{params:$(dt)}),ln.params=$(ln.params)}const vn=e.resolve(yn,ln),Nr=Ot.hash||"";vn.params=L(V(vn.params));const He=CG(l,ao({},Ot,{hash:bG(Nr),path:vn.path})),Qe=d.createHref(He);return ao({fullPath:He,hash:Nr,query:l===bM?nH(Ot.query):Ot.query||{}},vn,{redirectedFrom:void 0,href:Qe})}function Ge(Ot){return typeof Ot=="string"?oC(n,Ot,C.value.path):ao({},Ot)}function Ye(Ot,ln){if(P!==Ot)return Og(8,{from:ln,to:Ot})}function Ne(Ot){return Pe(Ot)}function Mt(Ot){return Ne(ao(Ge(Ot),{replace:!0}))}function kt(Ot){const ln=Ot.matched[Ot.matched.length-1];if(ln&&ln.redirect){const{redirect:yn}=ln;let vn=typeof yn=="function"?yn(Ot):yn;return typeof vn=="string"&&(vn=vn.includes("?")||vn.includes("#")?vn=Ge(vn):{path:vn},vn.params={}),ao({query:Ot.query,hash:Ot.hash,params:vn.path!=null?{}:Ot.params},vn)}}function Pe(Ot,ln){const yn=P=Be(Ot),vn=C.value,Nr=Ot.state,He=Ot.force,Qe=Ot.replace===!0,dt=kt(yn);if(dt)return Pe(ao(Ge(dt),{state:typeof dt=="object"?ao({},Nr,dt.state):Nr,force:He,replace:Qe}),ln||yn);const Lt=yn;Lt.redirectedFrom=ln;let qt;return!He&&IG(l,vn,yn)&&(qt=Og(16,{to:Lt,from:vn}),or(vn,vn,!0,!1)),(qt?Promise.resolve(qt):je(Lt,vn)).catch(jt=>od(jt)?od(jt,2)?jt:ei(jt):ar(jt,Lt,vn)).then(jt=>{if(jt){if(od(jt,2))return Pe(ao({replace:Qe},Ge(jt.to),{state:typeof jt.to=="object"?ao({},Nr,jt.to.state):Nr,force:He}),ln||Lt)}else jt=Ve(Lt,vn,!0,Qe,Nr);return Re(Lt,vn,jt),jt})}function we(Ot,ln){const yn=Ye(Ot,ln);return yn?Promise.reject(yn):Promise.resolve()}function Se(Ot){const ln=uo.values().next().value;return ln&&typeof ln.runWithContext=="function"?ln.runWithContext(Ot):Ot()}function je(Ot,ln){let yn;const[vn,Nr,He]=uH(Ot,ln);yn=sC(vn.reverse(),"beforeRouteLeave",Ot,ln);for(const dt of vn)dt.leaveGuards.forEach(Lt=>{yn.push(Eh(Lt,Ot,ln))});const Qe=we.bind(null,Ot,ln);return yn.push(Qe),ur(yn).then(()=>{yn=[];for(const dt of f.list())yn.push(Eh(dt,Ot,ln));return yn.push(Qe),ur(yn)}).then(()=>{yn=sC(Nr,"beforeRouteUpdate",Ot,ln);for(const dt of Nr)dt.updateGuards.forEach(Lt=>{yn.push(Eh(Lt,Ot,ln))});return yn.push(Qe),ur(yn)}).then(()=>{yn=[];for(const dt of He)if(dt.beforeEnter)if(gc(dt.beforeEnter))for(const Lt of dt.beforeEnter)yn.push(Eh(Lt,Ot,ln));else yn.push(Eh(dt.beforeEnter,Ot,ln));return yn.push(Qe),ur(yn)}).then(()=>(Ot.matched.forEach(dt=>dt.enterCallbacks={}),yn=sC(He,"beforeRouteEnter",Ot,ln,Se),yn.push(Qe),ur(yn))).then(()=>{yn=[];for(const dt of x.list())yn.push(Eh(dt,Ot,ln));return yn.push(Qe),ur(yn)}).catch(dt=>od(dt,8)?dt:Promise.reject(dt))}function Re(Ot,ln,yn){s.list().forEach(vn=>Se(()=>vn(Ot,ln,yn)))}function Ve(Ot,ln,yn,vn,Nr){const He=Ye(Ot,ln);if(He)return He;const Qe=ln===vh,dt=rg?history.state:{};yn&&(vn||Qe?d.replace(Ot.fullPath,ao({scroll:Qe&&dt&&dt.scroll},Nr)):d.push(Ot.fullPath,Nr)),C.value=Ot,or(Ot,ln,yn,Qe),ei()}let ke;function Mn(){ke||(ke=d.listen((Ot,ln,yn)=>{if(!Gi.listening)return;const vn=Be(Ot),Nr=kt(vn);if(Nr){Pe(ao(Nr,{replace:!0,force:!0}),vn).catch(wv);return}P=vn;const He=C.value;rg&&LG(dM(He.fullPath,yn.delta),iT()),je(vn,He).catch(Qe=>od(Qe,12)?Qe:od(Qe,2)?(Pe(ao(Ge(Qe.to),{force:!0}),vn).then(dt=>{od(dt,20)&&!yn.delta&&yn.type===qv.pop&&d.go(-1,!1)}).catch(wv),Promise.reject()):(yn.delta&&d.go(-yn.delta,!1),ar(Qe,vn,He))).then(Qe=>{Qe=Qe||Ve(vn,He,!1),Qe&&(yn.delta&&!od(Qe,8)?d.go(-yn.delta,!1):yn.type===qv.pop&&od(Qe,20)&&d.go(-1,!1)),Re(vn,He,Qe)}).catch(wv)}))}let bn=Yy(),mn=Yy(),Sn;function ar(Ot,ln,yn){ei(Ot);const vn=mn.list();return vn.length?vn.forEach(Nr=>Nr(Ot,ln,yn)):console.error(Ot),Promise.reject(Ot)}function Br(){return Sn&&C.value!==vh?Promise.resolve():new Promise((Ot,ln)=>{bn.add([Ot,ln])})}function ei(Ot){return Sn||(Sn=!Ot,Mn(),bn.list().forEach(([ln,yn])=>Ot?yn(Ot):ln()),bn.reset()),Ot}function or(Ot,ln,yn,vn){const{scrollBehavior:Nr}=t;if(!rg||!Nr)return Promise.resolve();const He=!yn&&zG(dM(Ot.fullPath,0))||(vn||!yn)&&history.state&&history.state.scroll||null;return G0().then(()=>Nr(Ot,ln,He)).then(Qe=>Qe&&DG(Qe)).catch(Qe=>ar(Qe,Ot,ln))}const vr=Ot=>d.go(Ot);let oi;const uo=new Set,Gi={currentRoute:C,listening:!0,addRoute:j,removeRoute:ue,clearRoutes:e.clearRoutes,hasRoute:Te,getRoutes:de,resolve:Be,options:t,push:Ne,replace:Mt,go:vr,back:()=>vr(-1),forward:()=>vr(1),beforeEach:f.add,beforeResolve:x.add,afterEach:s.add,onError:mn.add,isReady:Br,install(Ot){const ln=this;Ot.component("RouterLink",ov),Ot.component("RouterView",q6),Ot.config.globalProperties.$router=ln,Object.defineProperty(Ot.config.globalProperties,"$route",{enumerable:!0,get:()=>Ai(C)}),rg&&!oi&&C.value===vh&&(oi=!0,Ne(d.location).catch(Nr=>{}));const yn={};for(const Nr in vh)Object.defineProperty(yn,Nr,{get:()=>C.value[Nr],enumerable:!0});Ot.provide(oT,ln),Ot.provide(ZI,$4(yn)),Ot.provide(QC,C);const vn=Ot.unmount;uo.add(Ot),Ot.unmount=function(){uo.delete(Ot),uo.size<1&&(P=vh,ke&&ke(),ke=null,C.value=vh,oi=!1,Sn=!1),vn()}}};function ur(Ot){return Ot.reduce((ln,yn)=>ln.then(()=>Se(yn)),Promise.resolve())}return Gi}function uH(t,e){const n=[],l=[],d=[],f=Math.max(e.matched.length,t.matched.length);for(let x=0;x<f;x++){const s=e.matched[x];s&&(t.matched.find(P=>kg(P,s))?l.push(s):n.push(s));const C=t.matched[x];C&&(e.matched.find(P=>kg(P,C))||d.push(C))}return[n,l,d]}function sT(){return fc(oT)}function dH(t){return fc(ZI)}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hH=()=>{};var CM={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const K6=function(t){const e=[];let n=0;for(let l=0;l<t.length;l++){let d=t.charCodeAt(l);d<128?e[n++]=d:d<2048?(e[n++]=d>>6|192,e[n++]=d&63|128):(d&64512)===55296&&l+1<t.length&&(t.charCodeAt(l+1)&64512)===56320?(d=65536+((d&1023)<<10)+(t.charCodeAt(++l)&1023),e[n++]=d>>18|240,e[n++]=d>>12&63|128,e[n++]=d>>6&63|128,e[n++]=d&63|128):(e[n++]=d>>12|224,e[n++]=d>>6&63|128,e[n++]=d&63|128)}return e},fH=function(t){const e=[];let n=0,l=0;for(;n<t.length;){const d=t[n++];if(d<128)e[l++]=String.fromCharCode(d);else if(d>191&&d<224){const f=t[n++];e[l++]=String.fromCharCode((d&31)<<6|f&63)}else if(d>239&&d<365){const f=t[n++],x=t[n++],s=t[n++],C=((d&7)<<18|(f&63)<<12|(x&63)<<6|s&63)-65536;e[l++]=String.fromCharCode(55296+(C>>10)),e[l++]=String.fromCharCode(56320+(C&1023))}else{const f=t[n++],x=t[n++];e[l++]=String.fromCharCode((d&15)<<12|(f&63)<<6|x&63)}}return e.join("")},Z6={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,l=[];for(let d=0;d<t.length;d+=3){const f=t[d],x=d+1<t.length,s=x?t[d+1]:0,C=d+2<t.length,P=C?t[d+2]:0,L=f>>2,$=(f&3)<<4|s>>4;let V=(s&15)<<2|P>>6,j=P&63;C||(j=64,x||(V=64)),l.push(n[L],n[$],n[V],n[j])}return l.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(K6(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):fH(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,l=[];for(let d=0;d<t.length;){const f=n[t.charAt(d++)],s=d<t.length?n[t.charAt(d)]:0;++d;const P=d<t.length?n[t.charAt(d)]:64;++d;const $=d<t.length?n[t.charAt(d)]:64;if(++d,f==null||s==null||P==null||$==null)throw new pH;const V=f<<2|s>>4;if(l.push(V),P!==64){const j=s<<4&240|P>>2;if(l.push(j),$!==64){const ue=P<<6&192|$;l.push(ue)}}}return l},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class pH extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const mH=function(t){const e=K6(t);return Z6.encodeByteArray(e,!0)},cw=function(t){return mH(t).replace(/\./g,"")},XI=function(t){try{return Z6.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function uw(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:const n=e;return new Date(n.getTime());case Object:t===void 0&&(t={});break;case Array:t=[];break;default:return e}for(const n in e)!e.hasOwnProperty(n)||!gH(n)||(t[n]=uw(t[n],e[n]));return t}function gH(t){return t!=="__proto__"}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function X6(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _H=()=>X6().__FIREBASE_DEFAULTS__,yH=()=>{if(typeof process>"u"||typeof CM>"u")return;const t=CM.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},vH=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&XI(t[1]);return e&&JSON.parse(e)},aT=()=>{try{return hH()||_H()||yH()||vH()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},Y6=t=>aT()?.emulatorHosts?.[t],YI=t=>{const e=Y6(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const l=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),l]:[e.substring(0,n),l]},JI=()=>aT()?.config,J6=t=>aT()?.[`_${t}`];/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bH{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,l)=>{n?this.reject(n):this.resolve(l),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,l))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ad(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function lT(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Q6(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},l=e||"demo-project",d=t.iat||0,f=t.sub||t.user_id;if(!f)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const x={iss:`https://securetoken.google.com/${l}`,aud:l,iat:d,exp:d+3600,auth_time:d,sub:f,user_id:f,firebase:{sign_in_provider:"custom",identities:{}},...t};return[cw(JSON.stringify(n)),cw(JSON.stringify(x)),""].join(".")}const Sv={};function xH(){const t={prod:[],emulator:[]};for(const e of Object.keys(Sv))Sv[e]?t.emulator.push(e):t.prod.push(e);return t}function wH(t){let e=document.getElementById(t),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),n=!0),{created:n,element:e}}let IM=!1;function cT(t,e){if(typeof window>"u"||typeof document>"u"||!Ad(window.location.host)||Sv[t]===e||Sv[t]||IM)return;Sv[t]=e;function n(V){return`__firebase__banner__${V}`}const l="__firebase__banner",f=xH().prod.length>0;function x(){const V=document.getElementById(l);V&&V.remove()}function s(V){V.style.display="flex",V.style.background="#7faaf0",V.style.position="fixed",V.style.bottom="5px",V.style.left="5px",V.style.padding=".5em",V.style.borderRadius="5px",V.style.alignItems="center"}function C(V,j){V.setAttribute("width","24"),V.setAttribute("id",j),V.setAttribute("height","24"),V.setAttribute("viewBox","0 0 24 24"),V.setAttribute("fill","none"),V.style.marginLeft="-6px"}function P(){const V=document.createElement("span");return V.style.cursor="pointer",V.style.marginLeft="16px",V.style.fontSize="24px",V.innerHTML=" &times;",V.onclick=()=>{IM=!0,x()},V}function L(V,j){V.setAttribute("id",j),V.innerText="Learn more",V.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",V.setAttribute("target","__blank"),V.style.paddingLeft="5px",V.style.textDecoration="underline"}function $(){const V=wH(l),j=n("text"),ue=document.getElementById(j)||document.createElement("span"),de=n("learnmore"),Te=document.getElementById(de)||document.createElement("a"),Be=n("preprendIcon"),Ge=document.getElementById(Be)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(V.created){const Ye=V.element;s(Ye),L(Te,de);const Ne=P();C(Ge,Be),Ye.append(Ge,ue,Te,Ne),document.body.appendChild(Ye)}f?(ue.innerText="Preview backend disconnected.",Ge.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(Ge.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,ue.innerText="Preview backend running in this workspace."),ue.setAttribute("id",j)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",$):$()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ca(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function TH(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(ca())}function SH(){const t=aT()?.forceEnvironment;if(t==="node")return!0;if(t==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function EH(){return typeof window<"u"||ez()}function ez(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function CH(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function IH(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function AH(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function PH(){const t=ca();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function RH(){return!SH()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function kH(){try{return typeof indexedDB=="object"}catch{return!1}}function OH(){return new Promise((t,e)=>{try{let n=!0;const l="validate-browser-context-for-indexeddb-analytics-module",d=self.indexedDB.open(l);d.onsuccess=()=>{d.result.close(),n||self.indexedDB.deleteDatabase(l),t(!0)},d.onupgradeneeded=()=>{n=!1},d.onerror=()=>{e(d.error?.message||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MH="FirebaseError";class Vl extends Error{constructor(e,n,l){super(n),this.code=e,this.customData=l,this.name=MH,Object.setPrototypeOf(this,Vl.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Tp.prototype.create)}}class Tp{constructor(e,n,l){this.service=e,this.serviceName=n,this.errors=l}create(e,...n){const l=n[0]||{},d=`${this.service}/${e}`,f=this.errors[e],x=f?DH(f,l):"Error",s=`${this.serviceName}: ${x} (${d}).`;return new Vl(d,s,l)}}function DH(t,e){return t.replace(LH,(n,l)=>{const d=e[l];return d!=null?String(d):`<${l}?>`})}const LH=/\{\$([^}]+)}/g;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function AM(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function zH(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Hh(t,e){if(t===e)return!0;const n=Object.keys(t),l=Object.keys(e);for(const d of n){if(!l.includes(d))return!1;const f=t[d],x=e[d];if(PM(f)&&PM(x)){if(!Hh(f,x))return!1}else if(f!==x)return!1}for(const d of l)if(!n.includes(d))return!1;return!0}function PM(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function q0(t){const e=[];for(const[n,l]of Object.entries(t))Array.isArray(l)?l.forEach(d=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(d))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(l));return e.length?"&"+e.join("&"):""}function sv(t){const e={};return t.replace(/^\?/,"").split("&").forEach(l=>{if(l){const[d,f]=l.split("=");e[decodeURIComponent(d)]=decodeURIComponent(f)}}),e}function av(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}function tz(t,e){const n=new FH(t,e);return n.subscribe.bind(n)}class FH{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(l=>{this.error(l)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,l){let d;if(e===void 0&&n===void 0&&l===void 0)throw new Error("Missing Observer.");BH(e,["next","error","complete"])?d=e:d={next:e,error:n,complete:l},d.next===void 0&&(d.next=aC),d.error===void 0&&(d.error=aC),d.complete===void 0&&(d.complete=aC);const f=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?d.error(this.finalError):d.complete()}catch{}}),this.observers.push(d),f}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(l){typeof console<"u"&&console.error&&console.error(l)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function BH(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function aC(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zo(t){return t&&t._delegate?t._delegate:t}class pu{constructor(e,n,l){this.name=e,this.instanceFactory=n,this.type=l,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const np="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NH{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const l=new bH;if(this.instancesDeferred.set(n,l),this.isInitialized(n)||this.shouldAutoInitialize())try{const d=this.getOrInitializeService({instanceIdentifier:n});d&&l.resolve(d)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){const n=this.normalizeInstanceIdentifier(e?.identifier),l=e?.optional??!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(d){if(l)return null;throw d}else{if(l)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if($H(e))try{this.getOrInitializeService({instanceIdentifier:np})}catch{}for(const[n,l]of this.instancesDeferred.entries()){const d=this.normalizeInstanceIdentifier(n);try{const f=this.getOrInitializeService({instanceIdentifier:d});l.resolve(f)}catch{}}}}clearInstance(e=np){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=np){return this.instances.has(e)}getOptions(e=np){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,l=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(l))throw Error(`${this.name}(${l}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const d=this.getOrInitializeService({instanceIdentifier:l,options:n});for(const[f,x]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(f);l===s&&x.resolve(d)}return d}onInit(e,n){const l=this.normalizeInstanceIdentifier(n),d=this.onInitCallbacks.get(l)??new Set;d.add(e),this.onInitCallbacks.set(l,d);const f=this.instances.get(l);return f&&e(f,l),()=>{d.delete(e)}}invokeOnInitCallbacks(e,n){const l=this.onInitCallbacks.get(n);if(l)for(const d of l)try{d(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let l=this.instances.get(e);if(!l&&this.component&&(l=this.component.instanceFactory(this.container,{instanceIdentifier:VH(e),options:n}),this.instances.set(e,l),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(l,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,l)}catch{}return l||null}normalizeInstanceIdentifier(e=np){return this.component?this.component.multipleInstances?e:np:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function VH(t){return t===np?void 0:t}function $H(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nz{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new NH(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QI=[];var Pi;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Pi||(Pi={}));const rz={debug:Pi.DEBUG,verbose:Pi.VERBOSE,info:Pi.INFO,warn:Pi.WARN,error:Pi.ERROR,silent:Pi.SILENT},UH=Pi.INFO,jH={[Pi.DEBUG]:"log",[Pi.VERBOSE]:"log",[Pi.INFO]:"info",[Pi.WARN]:"warn",[Pi.ERROR]:"error"},GH=(t,e,...n)=>{if(e<t.logLevel)return;const l=new Date().toISOString(),d=jH[e];if(d)console[d](`[${l}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class uT{constructor(e){this.name=e,this._logLevel=UH,this._logHandler=GH,this._userLogHandler=null,QI.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Pi))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?rz[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Pi.DEBUG,...e),this._logHandler(this,Pi.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Pi.VERBOSE,...e),this._logHandler(this,Pi.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Pi.INFO,...e),this._logHandler(this,Pi.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Pi.WARN,...e),this._logHandler(this,Pi.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Pi.ERROR,...e),this._logHandler(this,Pi.ERROR,...e)}}function HH(t){QI.forEach(e=>{e.setLogLevel(t)})}function WH(t,e){for(const n of QI){let l=null;e&&e.level&&(l=rz[e.level]),t===null?n.userLogHandler=null:n.userLogHandler=(d,f,...x)=>{const s=x.map(C=>{if(C==null)return null;if(typeof C=="string")return C;if(typeof C=="number"||typeof C=="boolean")return C.toString();if(C instanceof Error)return C.message;try{return JSON.stringify(C)}catch{return null}}).filter(C=>C).join(" ");f>=(l??d.logLevel)&&t({level:Pi[f].toLowerCase(),message:s,args:x,type:d.name})}}}const qH=(t,e)=>e.some(n=>t instanceof n);let RM,kM;function KH(){return RM||(RM=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function ZH(){return kM||(kM=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const iz=new WeakMap,e2=new WeakMap,oz=new WeakMap,lC=new WeakMap,eA=new WeakMap;function XH(t){const e=new Promise((n,l)=>{const d=()=>{t.removeEventListener("success",f),t.removeEventListener("error",x)},f=()=>{n(Nh(t.result)),d()},x=()=>{l(t.error),d()};t.addEventListener("success",f),t.addEventListener("error",x)});return e.then(n=>{n instanceof IDBCursor&&iz.set(n,t)}).catch(()=>{}),eA.set(e,t),e}function YH(t){if(e2.has(t))return;const e=new Promise((n,l)=>{const d=()=>{t.removeEventListener("complete",f),t.removeEventListener("error",x),t.removeEventListener("abort",x)},f=()=>{n(),d()},x=()=>{l(t.error||new DOMException("AbortError","AbortError")),d()};t.addEventListener("complete",f),t.addEventListener("error",x),t.addEventListener("abort",x)});e2.set(t,e)}let t2={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return e2.get(t);if(e==="objectStoreNames")return t.objectStoreNames||oz.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Nh(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function JH(t){t2=t(t2)}function QH(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const l=t.call(cC(this),e,...n);return oz.set(l,e.sort?e.sort():[e]),Nh(l)}:ZH().includes(t)?function(...e){return t.apply(cC(this),e),Nh(iz.get(this))}:function(...e){return Nh(t.apply(cC(this),e))}}function eW(t){return typeof t=="function"?QH(t):(t instanceof IDBTransaction&&YH(t),qH(t,KH())?new Proxy(t,t2):t)}function Nh(t){if(t instanceof IDBRequest)return XH(t);if(lC.has(t))return lC.get(t);const e=eW(t);return e!==t&&(lC.set(t,e),eA.set(e,t)),e}const cC=t=>eA.get(t);function tW(t,e,{blocked:n,upgrade:l,blocking:d,terminated:f}={}){const x=indexedDB.open(t,e),s=Nh(x);return l&&x.addEventListener("upgradeneeded",C=>{l(Nh(x.result),C.oldVersion,C.newVersion,Nh(x.transaction),C)}),n&&x.addEventListener("blocked",C=>n(C.oldVersion,C.newVersion,C)),s.then(C=>{f&&C.addEventListener("close",()=>f()),d&&C.addEventListener("versionchange",P=>d(P.oldVersion,P.newVersion,P))}).catch(()=>{}),s}const nW=["get","getKey","getAll","getAllKeys","count"],rW=["put","add","delete","clear"],uC=new Map;function OM(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(uC.get(e))return uC.get(e);const n=e.replace(/FromIndex$/,""),l=e!==n,d=rW.includes(n);if(!(n in(l?IDBIndex:IDBObjectStore).prototype)||!(d||nW.includes(n)))return;const f=async function(x,...s){const C=this.transaction(x,d?"readwrite":"readonly");let P=C.store;return l&&(P=P.index(s.shift())),(await Promise.all([P[n](...s),d&&C.done]))[0]};return uC.set(e,f),f}JH(t=>({...t,get:(e,n,l)=>OM(e,n)||t.get(e,n,l),has:(e,n)=>!!OM(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iW{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(oW(n)){const l=n.getImmediate();return`${l.library}/${l.version}`}else return null}).filter(n=>n).join(" ")}}function oW(t){return t.getComponent()?.type==="VERSION"}const dw="@firebase/app",n2="0.14.2";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bd=new uT("@firebase/app"),sW="@firebase/app-compat",aW="@firebase/analytics-compat",lW="@firebase/analytics",cW="@firebase/app-check-compat",uW="@firebase/app-check",dW="@firebase/auth",hW="@firebase/auth-compat",fW="@firebase/database",pW="@firebase/data-connect",mW="@firebase/database-compat",gW="@firebase/functions",_W="@firebase/functions-compat",yW="@firebase/installations",vW="@firebase/installations-compat",bW="@firebase/messaging",xW="@firebase/messaging-compat",wW="@firebase/performance",TW="@firebase/performance-compat",SW="@firebase/remote-config",EW="@firebase/remote-config-compat",CW="@firebase/storage",IW="@firebase/storage-compat",AW="@firebase/firestore",PW="@firebase/ai",RW="@firebase/firestore-compat",kW="firebase",OW="12.2.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wh="[DEFAULT]",MW={[dw]:"fire-core",[sW]:"fire-core-compat",[lW]:"fire-analytics",[aW]:"fire-analytics-compat",[uW]:"fire-app-check",[cW]:"fire-app-check-compat",[dW]:"fire-auth",[hW]:"fire-auth-compat",[fW]:"fire-rtdb",[pW]:"fire-data-connect",[mW]:"fire-rtdb-compat",[gW]:"fire-fn",[_W]:"fire-fn-compat",[yW]:"fire-iid",[vW]:"fire-iid-compat",[bW]:"fire-fcm",[xW]:"fire-fcm-compat",[wW]:"fire-perf",[TW]:"fire-perf-compat",[SW]:"fire-rc",[EW]:"fire-rc-compat",[CW]:"fire-gcs",[IW]:"fire-gcs-compat",[AW]:"fire-fst",[RW]:"fire-fst-compat",[PW]:"fire-vertex","fire-js":"fire-js",[kW]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qh=new Map,Mg=new Map,Dg=new Map;function Kv(t,e){try{t.container.addComponent(e)}catch(n){bd.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function sz(t,e){t.container.addOrOverwriteComponent(e)}function mu(t){const e=t.name;if(Dg.has(e))return bd.debug(`There were multiple attempts to register component ${e}.`),!1;Dg.set(e,t);for(const n of qh.values())Kv(n,t);for(const n of Mg.values())Kv(n,t);return!0}function Sp(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function DW(t,e,n=Wh){Sp(t,e).clearInstance(n)}function tA(t){return t.options!==void 0}function az(t){return tA(t)?!1:"authIdToken"in t||"appCheckToken"in t||"releaseOnDeref"in t||"automaticDataCollectionEnabled"in t}function Ia(t){return t==null?!1:t.settings!==void 0}function LW(){Dg.clear()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zW={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},dl=new Tp("app","Firebase",zW);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let lz=class{constructor(e,n,l){this._isDeleted=!1,this._options={...e},this._config={...n},this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=l,this.container.addComponent(new pu("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw dl.create("app-deleted",{appName:this._name})}};/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function MM(t,e){const n=XI(t.split(".")[1]);if(n===null){console.error(`FirebaseServerApp ${e} is invalid: second part could not be parsed.`);return}if(JSON.parse(n).exp===void 0){console.error(`FirebaseServerApp ${e} is invalid: expiration claim could not be parsed`);return}const d=JSON.parse(n).exp*1e3,f=new Date().getTime();d-f<=0&&console.error(`FirebaseServerApp ${e} is invalid: the token has expired.`)}class FW extends lz{constructor(e,n,l,d){const f=n.automaticDataCollectionEnabled!==void 0?n.automaticDataCollectionEnabled:!0,x={name:l,automaticDataCollectionEnabled:f};if(e.apiKey!==void 0)super(e,x,d);else{const s=e;super(s.options,x,d)}this._serverConfig={automaticDataCollectionEnabled:f,...n},this._serverConfig.authIdToken&&MM(this._serverConfig.authIdToken,"authIdToken"),this._serverConfig.appCheckToken&&MM(this._serverConfig.appCheckToken,"appCheckToken"),this._finalizationRegistry=null,typeof FinalizationRegistry<"u"&&(this._finalizationRegistry=new FinalizationRegistry(()=>{this.automaticCleanup()})),this._refCount=0,this.incRefCount(this._serverConfig.releaseOnDeref),this._serverConfig.releaseOnDeref=void 0,n.releaseOnDeref=void 0,la(dw,n2,"serverapp")}toJSON(){}get refCount(){return this._refCount}incRefCount(e){this.isDeleted||(this._refCount++,e!==void 0&&this._finalizationRegistry!==null&&this._finalizationRegistry.register(e,this))}decRefCount(){return this.isDeleted?0:--this._refCount}automaticCleanup(){nA(this)}get settings(){return this.checkDestroyed(),this._serverConfig}checkDestroyed(){if(this.isDeleted)throw dl.create("server-app-deleted")}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pd=OW;function dT(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const l={name:Wh,automaticDataCollectionEnabled:!0,...e},d=l.name;if(typeof d!="string"||!d)throw dl.create("bad-app-name",{appName:String(d)});if(n||(n=JI()),!n)throw dl.create("no-options");const f=qh.get(d);if(f){if(Hh(n,f.options)&&Hh(l,f.config))return f;throw dl.create("duplicate-app",{appName:d})}const x=new nz(d);for(const C of Dg.values())x.addComponent(C);const s=new lz(n,l,x);return qh.set(d,s),s}function BW(t,e={}){if(EH()&&!ez())throw dl.create("invalid-server-app-environment");let n,l=e||{};if(t&&(tA(t)?n=t.options:az(t)?l=t:n=t),l.automaticDataCollectionEnabled===void 0&&(l.automaticDataCollectionEnabled=!0),n||(n=JI()),!n)throw dl.create("no-options");const d={...l,...n};d.releaseOnDeref!==void 0&&delete d.releaseOnDeref;const f=L=>[...L].reduce(($,V)=>Math.imul(31,$)+V.charCodeAt(0)|0,0);if(l.releaseOnDeref!==void 0&&typeof FinalizationRegistry>"u")throw dl.create("finalization-registry-not-supported",{});const x=""+f(JSON.stringify(d)),s=Mg.get(x);if(s)return s.incRefCount(l.releaseOnDeref),s;const C=new nz(x);for(const L of Dg.values())C.addComponent(L);const P=new FW(n,l,x,C);return Mg.set(x,P),P}function K0(t=Wh){const e=qh.get(t);if(!e&&t===Wh&&JI())return dT();if(!e)throw dl.create("no-app",{appName:t});return e}function NW(){return Array.from(qh.values())}async function nA(t){let e=!1;const n=t.name;qh.has(n)?(e=!0,qh.delete(n)):Mg.has(n)&&t.decRefCount()<=0&&(Mg.delete(n),e=!0),e&&(await Promise.all(t.container.getProviders().map(l=>l.delete())),t.isDeleted=!0)}function la(t,e,n){let l=MW[t]??t;n&&(l+=`-${n}`);const d=l.match(/\s|\//),f=e.match(/\s|\//);if(d||f){const x=[`Unable to register library "${l}" with version "${e}":`];d&&x.push(`library name "${l}" contains illegal characters (whitespace or "/")`),d&&f&&x.push("and"),f&&x.push(`version name "${e}" contains illegal characters (whitespace or "/")`),bd.warn(x.join(" "));return}mu(new pu(`${l}-version`,()=>({library:l,version:e}),"VERSION"))}function cz(t,e){if(t!==null&&typeof t!="function")throw dl.create("invalid-log-argument");WH(t,e)}function uz(t){HH(t)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VW="firebase-heartbeat-database",$W=1,Zv="firebase-heartbeat-store";let dC=null;function dz(){return dC||(dC=tW(VW,$W,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Zv)}catch(n){console.warn(n)}}}}).catch(t=>{throw dl.create("idb-open",{originalErrorMessage:t.message})})),dC}async function UW(t){try{const n=(await dz()).transaction(Zv),l=await n.objectStore(Zv).get(hz(t));return await n.done,l}catch(e){if(e instanceof Vl)bd.warn(e.message);else{const n=dl.create("idb-get",{originalErrorMessage:e?.message});bd.warn(n.message)}}}async function DM(t,e){try{const l=(await dz()).transaction(Zv,"readwrite");await l.objectStore(Zv).put(e,hz(t)),await l.done}catch(n){if(n instanceof Vl)bd.warn(n.message);else{const l=dl.create("idb-set",{originalErrorMessage:n?.message});bd.warn(l.message)}}}function hz(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jW=1024,GW=30;class HW{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new qW(n),this._heartbeatsCachePromise=this._storage.read().then(l=>(this._heartbeatsCache=l,l))}async triggerHeartbeat(){try{const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),l=LM();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===l||this._heartbeatsCache.heartbeats.some(d=>d.date===l))return;if(this._heartbeatsCache.heartbeats.push({date:l,agent:n}),this._heartbeatsCache.heartbeats.length>GW){const d=KW(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(d,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){bd.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=LM(),{heartbeatsToSend:n,unsentEntries:l}=WW(this._heartbeatsCache.heartbeats),d=cw(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=e,l.length>0?(this._heartbeatsCache.heartbeats=l,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),d}catch(e){return bd.warn(e),""}}}function LM(){return new Date().toISOString().substring(0,10)}function WW(t,e=jW){const n=[];let l=t.slice();for(const d of t){const f=n.find(x=>x.agent===d.agent);if(f){if(f.dates.push(d.date),zM(n)>e){f.dates.pop();break}}else if(n.push({agent:d.agent,dates:[d.date]}),zM(n)>e){n.pop();break}l=l.slice(1)}return{heartbeatsToSend:n,unsentEntries:l}}class qW{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return kH()?OH().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await UW(this.app);return n?.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const l=await this.read();return DM(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??l.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const l=await this.read();return DM(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??l.lastSentHeartbeatDate,heartbeats:[...l.heartbeats,...e.heartbeats]})}else return}}function zM(t){return cw(JSON.stringify({version:2,heartbeats:t})).length}function KW(t){if(t.length===0)return-1;let e=0,n=t[0].date;for(let l=1;l<t.length;l++)t[l].date<n&&(n=t[l].date,e=l);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZW(t){mu(new pu("platform-logger",e=>new iW(e),"PRIVATE")),mu(new pu("heartbeat",e=>new HW(e),"PRIVATE")),la(dw,n2,t),la(dw,n2,"esm2020"),la("fire-js","")}ZW("");const XW=Object.freeze(Object.defineProperty({__proto__:null,FirebaseError:Vl,SDK_VERSION:Pd,_DEFAULT_ENTRY_NAME:Wh,_addComponent:Kv,_addOrOverwriteComponent:sz,_apps:qh,_clearComponents:LW,_components:Dg,_getProvider:Sp,_isFirebaseApp:tA,_isFirebaseServerApp:Ia,_isFirebaseServerAppSettings:az,_registerComponent:mu,_removeServiceInstance:DW,_serverApps:Mg,deleteApp:nA,getApp:K0,getApps:NW,initializeApp:dT,initializeServerApp:BW,onLog:cz,registerVersion:la,setLogLevel:uz},Symbol.toStringTag,{value:"Module"}));var YW="firebase",JW="12.2.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */la(YW,JW,"app");function fz(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const QW=fz,pz=new Tp("auth","Firebase",fz());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hw=new uT("@firebase/auth");function eq(t,...e){hw.logLevel<=Pi.WARN&&hw.warn(`Auth (${Pd}): ${t}`,...e)}function Bx(t,...e){hw.logLevel<=Pi.ERROR&&hw.error(`Auth (${Pd}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _c(t,...e){throw rA(t,...e)}function ou(t,...e){return rA(t,...e)}function mz(t,e,n){const l={...QW(),[e]:n};return new Tp("auth","Firebase",l).create(e,{appName:t.name})}function pd(t){return mz(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function rA(t,...e){if(typeof t!="string"){const n=e[0],l=[...e.slice(1)];return l[0]&&(l[0].appName=t.name),t._errorFactory.create(n,...l)}return pz.create(t,...e)}function jr(t,e,...n){if(!t)throw rA(e,...n)}function dd(t){const e="INTERNAL ASSERTION FAILED: "+t;throw Bx(e),new Error(e)}function xd(t,e){t||dd(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function r2(){return typeof self<"u"&&self.location?.href||""}function tq(){return FM()==="http:"||FM()==="https:"}function FM(){return typeof self<"u"&&self.location?.protocol||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nq(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(tq()||IH()||"connection"in navigator)?navigator.onLine:!0}function rq(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z0{constructor(e,n){this.shortDelay=e,this.longDelay=n,xd(n>e,"Short delay should be less than long delay!"),this.isMobile=TH()||AH()}get(){return nq()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iA(t,e){xd(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gz{static initialize(e,n,l){this.fetchImpl=e,n&&(this.headersImpl=n),l&&(this.responseImpl=l)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;dd("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;dd("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;dd("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iq={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oq=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],sq=new Z0(3e4,6e4);function of(t,e){return t.tenantId&&!e.tenantId?{...e,tenantId:t.tenantId}:e}async function sf(t,e,n,l,d={}){return _z(t,d,async()=>{let f={},x={};l&&(e==="GET"?x=l:f={body:JSON.stringify(l)});const s=q0({key:t.config.apiKey,...x}).slice(1),C=await t._getAdditionalHeaders();C["Content-Type"]="application/json",t.languageCode&&(C["X-Firebase-Locale"]=t.languageCode);const P={method:e,headers:C,...f};return CH()||(P.referrerPolicy="no-referrer"),t.emulatorConfig&&Ad(t.emulatorConfig.host)&&(P.credentials="include"),gz.fetch()(await yz(t,t.config.apiHost,n,s),P)})}async function _z(t,e,n){t._canInitEmulator=!1;const l={...iq,...e};try{const d=new lq(t),f=await Promise.race([n(),d.promise]);d.clearNetworkTimeout();const x=await f.json();if("needConfirmation"in x)throw lx(t,"account-exists-with-different-credential",x);if(f.ok&&!("errorMessage"in x))return x;{const s=f.ok?x.errorMessage:x.error.message,[C,P]=s.split(" : ");if(C==="FEDERATED_USER_ID_ALREADY_LINKED")throw lx(t,"credential-already-in-use",x);if(C==="EMAIL_EXISTS")throw lx(t,"email-already-in-use",x);if(C==="USER_DISABLED")throw lx(t,"user-disabled",x);const L=l[C]||C.toLowerCase().replace(/[_\s]+/g,"-");if(P)throw mz(t,L,P);_c(t,L)}}catch(d){if(d instanceof Vl)throw d;_c(t,"network-request-failed",{message:String(d)})}}async function X0(t,e,n,l,d={}){const f=await sf(t,e,n,l,d);return"mfaPendingCredential"in f&&_c(t,"multi-factor-auth-required",{_serverResponse:f}),f}async function yz(t,e,n,l){const d=`${e}${n}?${l}`,f=t,x=f.config.emulator?iA(t.config,d):`${t.config.apiScheme}://${d}`;return oq.includes(n)&&(await f._persistenceManagerAvailable,f._getPersistenceType()==="COOKIE")?f._getPersistence()._getFinalTarget(x).toString():x}function aq(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class lq{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,l)=>{this.timer=setTimeout(()=>l(ou(this.auth,"network-request-failed")),sq.get())})}}function lx(t,e,n){const l={appName:t.name};n.email&&(l.email=n.email),n.phoneNumber&&(l.phoneNumber=n.phoneNumber);const d=ou(t,e,l);return d.customData._tokenResponse=n,d}function BM(t){return t!==void 0&&t.enterprise!==void 0}class cq{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const n of this.recaptchaEnforcementState)if(n.provider&&n.provider===e)return aq(n.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function uq(t,e){return sf(t,"GET","/v2/recaptchaConfig",of(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function dq(t,e){return sf(t,"POST","/v1/accounts:delete",e)}async function fw(t,e){return sf(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ev(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function hq(t,e=!1){const n=zo(t),l=await n.getIdToken(e),d=oA(l);jr(d&&d.exp&&d.auth_time&&d.iat,n.auth,"internal-error");const f=typeof d.firebase=="object"?d.firebase:void 0,x=f?.sign_in_provider;return{claims:d,token:l,authTime:Ev(hC(d.auth_time)),issuedAtTime:Ev(hC(d.iat)),expirationTime:Ev(hC(d.exp)),signInProvider:x||null,signInSecondFactor:f?.sign_in_second_factor||null}}function hC(t){return Number(t)*1e3}function oA(t){const[e,n,l]=t.split(".");if(e===void 0||n===void 0||l===void 0)return Bx("JWT malformed, contained fewer than 3 sections"),null;try{const d=XI(n);return d?JSON.parse(d):(Bx("Failed to decode base64 JWT payload"),null)}catch(d){return Bx("Caught error parsing JWT payload as JSON",d?.toString()),null}}function NM(t){const e=oA(t);return jr(e,"internal-error"),jr(typeof e.exp<"u","internal-error"),jr(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Xv(t,e,n=!1){if(n)return e;try{return await e}catch(l){throw l instanceof Vl&&fq(l)&&t.auth.currentUser===t&&await t.auth.signOut(),l}}function fq({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pq{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const l=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,l)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i2{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=Ev(this.lastLoginAt),this.creationTime=Ev(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function pw(t){const e=t.auth,n=await t.getIdToken(),l=await Xv(t,fw(e,{idToken:n}));jr(l?.users.length,e,"internal-error");const d=l.users[0];t._notifyReloadListener(d);const f=d.providerUserInfo?.length?vz(d.providerUserInfo):[],x=gq(t.providerData,f),s=t.isAnonymous,C=!(t.email&&d.passwordHash)&&!x?.length,P=s?C:!1,L={uid:d.localId,displayName:d.displayName||null,photoURL:d.photoUrl||null,email:d.email||null,emailVerified:d.emailVerified||!1,phoneNumber:d.phoneNumber||null,tenantId:d.tenantId||null,providerData:x,metadata:new i2(d.createdAt,d.lastLoginAt),isAnonymous:P};Object.assign(t,L)}async function mq(t){const e=zo(t);await pw(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function gq(t,e){return[...t.filter(l=>!e.some(d=>d.providerId===l.providerId)),...e]}function vz(t){return t.map(({providerId:e,...n})=>({providerId:e,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _q(t,e){const n=await _z(t,{},async()=>{const l=q0({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:d,apiKey:f}=t.config,x=await yz(t,d,"/v1/token",`key=${f}`),s=await t._getAdditionalHeaders();s["Content-Type"]="application/x-www-form-urlencoded";const C={method:"POST",headers:s,body:l};return t.emulatorConfig&&Ad(t.emulatorConfig.host)&&(C.credentials="include"),gz.fetch()(x,C)});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function yq(t,e){return sf(t,"POST","/v2/accounts:revokeToken",of(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sg{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){jr(e.idToken,"internal-error"),jr(typeof e.idToken<"u","internal-error"),jr(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):NM(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){jr(e.length!==0,"internal-error");const n=NM(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(jr(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:l,refreshToken:d,expiresIn:f}=await _q(e,n);this.updateTokensAndExpiration(l,d,Number(f))}updateTokensAndExpiration(e,n,l){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+l*1e3}static fromJSON(e,n){const{refreshToken:l,accessToken:d,expirationTime:f}=n,x=new Sg;return l&&(jr(typeof l=="string","internal-error",{appName:e}),x.refreshToken=l),d&&(jr(typeof d=="string","internal-error",{appName:e}),x.accessToken=d),f&&(jr(typeof f=="number","internal-error",{appName:e}),x.expirationTime=f),x}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Sg,this.toJSON())}_performRefresh(){return dd("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bh(t,e){jr(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class uc{constructor({uid:e,auth:n,stsTokenManager:l,...d}){this.providerId="firebase",this.proactiveRefresh=new pq(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=n,this.stsTokenManager=l,this.accessToken=l.accessToken,this.displayName=d.displayName||null,this.email=d.email||null,this.emailVerified=d.emailVerified||!1,this.phoneNumber=d.phoneNumber||null,this.photoURL=d.photoURL||null,this.isAnonymous=d.isAnonymous||!1,this.tenantId=d.tenantId||null,this.providerData=d.providerData?[...d.providerData]:[],this.metadata=new i2(d.createdAt||void 0,d.lastLoginAt||void 0)}async getIdToken(e){const n=await Xv(this,this.stsTokenManager.getToken(this.auth,e));return jr(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return hq(this,e)}reload(){return mq(this)}_assign(e){this!==e&&(jr(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>({...n})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new uc({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return n.metadata._copy(this.metadata),n}_onReload(e){jr(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let l=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),l=!0),n&&await pw(this),await this.auth._persistUserIfCurrent(this),l&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Ia(this.auth.app))return Promise.reject(pd(this.auth));const e=await this.getIdToken();return await Xv(this,dq(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){const l=n.displayName??void 0,d=n.email??void 0,f=n.phoneNumber??void 0,x=n.photoURL??void 0,s=n.tenantId??void 0,C=n._redirectEventId??void 0,P=n.createdAt??void 0,L=n.lastLoginAt??void 0,{uid:$,emailVerified:V,isAnonymous:j,providerData:ue,stsTokenManager:de}=n;jr($&&de,e,"internal-error");const Te=Sg.fromJSON(this.name,de);jr(typeof $=="string",e,"internal-error"),bh(l,e.name),bh(d,e.name),jr(typeof V=="boolean",e,"internal-error"),jr(typeof j=="boolean",e,"internal-error"),bh(f,e.name),bh(x,e.name),bh(s,e.name),bh(C,e.name),bh(P,e.name),bh(L,e.name);const Be=new uc({uid:$,auth:e,email:d,emailVerified:V,displayName:l,isAnonymous:j,photoURL:x,phoneNumber:f,tenantId:s,stsTokenManager:Te,createdAt:P,lastLoginAt:L});return ue&&Array.isArray(ue)&&(Be.providerData=ue.map(Ge=>({...Ge}))),C&&(Be._redirectEventId=C),Be}static async _fromIdTokenResponse(e,n,l=!1){const d=new Sg;d.updateFromServerResponse(n);const f=new uc({uid:n.localId,auth:e,stsTokenManager:d,isAnonymous:l});return await pw(f),f}static async _fromGetAccountInfoResponse(e,n,l){const d=n.users[0];jr(d.localId!==void 0,"internal-error");const f=d.providerUserInfo!==void 0?vz(d.providerUserInfo):[],x=!(d.email&&d.passwordHash)&&!f?.length,s=new Sg;s.updateFromIdToken(l);const C=new uc({uid:d.localId,auth:e,stsTokenManager:s,isAnonymous:x}),P={uid:d.localId,displayName:d.displayName||null,photoURL:d.photoUrl||null,email:d.email||null,emailVerified:d.emailVerified||!1,phoneNumber:d.phoneNumber||null,tenantId:d.tenantId||null,providerData:f,metadata:new i2(d.createdAt,d.lastLoginAt),isAnonymous:!(d.email&&d.passwordHash)&&!f?.length};return Object.assign(C,P),C}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VM=new Map;function hd(t){xd(t instanceof Function,"Expected a class definition");let e=VM.get(t);return e?(xd(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,VM.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bz{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}bz.type="NONE";const $M=bz;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nx(t,e,n){return`firebase:${t}:${e}:${n}`}class Eg{constructor(e,n,l){this.persistence=e,this.auth=n,this.userKey=l;const{config:d,name:f}=this.auth;this.fullUserKey=Nx(this.userKey,d.apiKey,f),this.fullPersistenceKey=Nx("persistence",d.apiKey,f),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const n=await fw(this.auth,{idToken:e}).catch(()=>{});return n?uc._fromGetAccountInfoResponse(this.auth,n,e):null}return uc._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,l="authUser"){if(!n.length)return new Eg(hd($M),e,l);const d=(await Promise.all(n.map(async P=>{if(await P._isAvailable())return P}))).filter(P=>P);let f=d[0]||hd($M);const x=Nx(l,e.config.apiKey,e.name);let s=null;for(const P of n)try{const L=await P._get(x);if(L){let $;if(typeof L=="string"){const V=await fw(e,{idToken:L}).catch(()=>{});if(!V)break;$=await uc._fromGetAccountInfoResponse(e,V,L)}else $=uc._fromJSON(e,L);P!==f&&(s=$),f=P;break}}catch{}const C=d.filter(P=>P._shouldAllowMigration);return!f._shouldAllowMigration||!C.length?new Eg(f,e,l):(f=C[0],s&&await f._set(x,s.toJSON()),await Promise.all(n.map(async P=>{if(P!==f)try{await P._remove(x)}catch{}})),new Eg(f,e,l))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function UM(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(Sz(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(xz(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(Cz(e))return"Blackberry";if(Iz(e))return"Webos";if(wz(e))return"Safari";if((e.includes("chrome/")||Tz(e))&&!e.includes("edge/"))return"Chrome";if(Ez(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,l=t.match(n);if(l?.length===2)return l[1]}return"Other"}function xz(t=ca()){return/firefox\//i.test(t)}function wz(t=ca()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Tz(t=ca()){return/crios\//i.test(t)}function Sz(t=ca()){return/iemobile/i.test(t)}function Ez(t=ca()){return/android/i.test(t)}function Cz(t=ca()){return/blackberry/i.test(t)}function Iz(t=ca()){return/webos/i.test(t)}function sA(t=ca()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function vq(t=ca()){return sA(t)&&!!window.navigator?.standalone}function bq(){return PH()&&document.documentMode===10}function Az(t=ca()){return sA(t)||Ez(t)||Iz(t)||Cz(t)||/windows phone/i.test(t)||Sz(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pz(t,e=[]){let n;switch(t){case"Browser":n=UM(ca());break;case"Worker":n=`${UM(ca())}-${t}`;break;default:n=t}const l=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${Pd}/${l}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xq{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const l=f=>new Promise((x,s)=>{try{const C=e(f);x(C)}catch(C){s(C)}});l.onAbort=n,this.queue.push(l);const d=this.queue.length-1;return()=>{this.queue[d]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const l of this.queue)await l(e),l.onAbort&&n.push(l.onAbort)}catch(l){n.reverse();for(const d of n)try{d()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:l?.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function wq(t,e={}){return sf(t,"GET","/v2/passwordPolicy",of(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tq=6;class Sq{constructor(e){const n=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=n.minPasswordLength??Tq,n.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=n.maxPasswordLength),n.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=n.containsLowercaseCharacter),n.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=n.containsUppercaseCharacter),n.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=n.containsNumericCharacter),n.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=n.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const n={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,n),this.validatePasswordCharacterOptions(e,n),n.isValid&&(n.isValid=n.meetsMinPasswordLength??!0),n.isValid&&(n.isValid=n.meetsMaxPasswordLength??!0),n.isValid&&(n.isValid=n.containsLowercaseLetter??!0),n.isValid&&(n.isValid=n.containsUppercaseLetter??!0),n.isValid&&(n.isValid=n.containsNumericCharacter??!0),n.isValid&&(n.isValid=n.containsNonAlphanumericCharacter??!0),n}validatePasswordLengthOptions(e,n){const l=this.customStrengthOptions.minPasswordLength,d=this.customStrengthOptions.maxPasswordLength;l&&(n.meetsMinPasswordLength=e.length>=l),d&&(n.meetsMaxPasswordLength=e.length<=d)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let l;for(let d=0;d<e.length;d++)l=e.charAt(d),this.updatePasswordCharacterOptionsStatuses(n,l>="a"&&l<="z",l>="A"&&l<="Z",l>="0"&&l<="9",this.allowedNonAlphanumericCharacters.includes(l))}updatePasswordCharacterOptionsStatuses(e,n,l,d,f){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=l)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=d)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=f))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Eq{constructor(e,n,l,d){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=l,this.config=d,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new jM(this),this.idTokenSubscription=new jM(this),this.beforeStateQueue=new xq(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=pz,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=d.sdkClientVersion,this._persistenceManagerAvailable=new Promise(f=>this._resolvePersistenceManagerAvailable=f)}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=hd(n)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await Eg.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await fw(this,{idToken:e}),l=await uc._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(l)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(Ia(this.app)){const f=this.app.settings.authIdToken;return f?new Promise(x=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(f).then(x,x))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let l=n,d=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const f=this.redirectUser?._redirectEventId,x=l?._redirectEventId,s=await this.tryRedirectSignIn(e);(!f||f===x)&&s?.user&&(l=s.user,d=!0)}if(!l)return this.directlySetCurrentUser(null);if(!l._redirectEventId){if(d)try{await this.beforeStateQueue.runMiddleware(l)}catch(f){l=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(f))}return l?this.reloadAndSetCurrentUserOrClear(l):this.directlySetCurrentUser(null)}return jr(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===l._redirectEventId?this.directlySetCurrentUser(l):this.reloadAndSetCurrentUserOrClear(l)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await pw(e)}catch(n){if(n?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=rq()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Ia(this.app))return Promise.reject(pd(this));const n=e?zo(e):null;return n&&jr(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&jr(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Ia(this.app)?Promise.reject(pd(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Ia(this.app)?Promise.reject(pd(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(hd(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await wq(this),n=new Sq(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Tp("auth","Firebase",e())}onAuthStateChanged(e,n,l){return this.registerStateListener(this.authStateSubscription,e,n,l)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,l){return this.registerStateListener(this.idTokenSubscription,e,n,l)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const l=this.onAuthStateChanged(()=>{l(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),l={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(l.tenantId=this.tenantId),await yq(this,l)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,n){const l=await this.getOrInitRedirectPersistenceManager(n);return e===null?l.removeCurrentUser():l.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&hd(e)||this._popupRedirectResolver;jr(n,this,"argument-error"),this.redirectPersistenceManager=await Eg.create(this,[hd(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,l,d){if(this._deleted)return()=>{};const f=typeof n=="function"?n:n.next.bind(n);let x=!1;const s=this._isInitialized?Promise.resolve():this._initializationPromise;if(jr(s,this,"internal-error"),s.then(()=>{x||f(this.currentUser)}),typeof n=="function"){const C=e.addObserver(n,l,d);return()=>{x=!0,C()}}else{const C=e.addObserver(n);return()=>{x=!0,C()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return jr(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Pz(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const n=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();n&&(e["X-Firebase-Client"]=n);const l=await this._getAppCheckToken();return l&&(e["X-Firebase-AppCheck"]=l),e}async _getAppCheckToken(){if(Ia(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&eq(`Error while retrieving App Check token: ${e.error}`),e?.token}}function Ep(t){return zo(t)}class jM{constructor(e){this.auth=e,this.observer=null,this.addObserver=tz(n=>this.observer=n)}get next(){return jr(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let hT={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function Cq(t){hT=t}function Rz(t){return hT.loadJS(t)}function Iq(){return hT.recaptchaEnterpriseScript}function Aq(){return hT.gapiScript}function Pq(t){return`__${t}${Math.floor(Math.random()*1e6)}`}class Rq{constructor(){this.enterprise=new kq}ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}class kq{ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}const Oq="recaptcha-enterprise",kz="NO_RECAPTCHA";class Mq{constructor(e){this.type=Oq,this.auth=Ep(e)}async verify(e="verify",n=!1){async function l(f){if(!n){if(f.tenantId==null&&f._agentRecaptchaConfig!=null)return f._agentRecaptchaConfig.siteKey;if(f.tenantId!=null&&f._tenantRecaptchaConfigs[f.tenantId]!==void 0)return f._tenantRecaptchaConfigs[f.tenantId].siteKey}return new Promise(async(x,s)=>{uq(f,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(C=>{if(C.recaptchaKey===void 0)s(new Error("recaptcha Enterprise site key undefined"));else{const P=new cq(C);return f.tenantId==null?f._agentRecaptchaConfig=P:f._tenantRecaptchaConfigs[f.tenantId]=P,x(P.siteKey)}}).catch(C=>{s(C)})})}function d(f,x,s){const C=window.grecaptcha;BM(C)?C.enterprise.ready(()=>{C.enterprise.execute(f,{action:e}).then(P=>{x(P)}).catch(()=>{x(kz)})}):s(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new Rq().execute("siteKey",{action:"verify"}):new Promise((f,x)=>{l(this.auth).then(s=>{if(!n&&BM(window.grecaptcha))d(s,f,x);else{if(typeof window>"u"){x(new Error("RecaptchaVerifier is only supported in browser"));return}let C=Iq();C.length!==0&&(C+=s),Rz(C).then(()=>{d(s,f,x)}).catch(P=>{x(P)})}}).catch(s=>{x(s)})})}}async function GM(t,e,n,l=!1,d=!1){const f=new Mq(t);let x;if(d)x=kz;else try{x=await f.verify(n)}catch{x=await f.verify(n,!0)}const s={...e};if(n==="mfaSmsEnrollment"||n==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in s){const C=s.phoneEnrollmentInfo.phoneNumber,P=s.phoneEnrollmentInfo.recaptchaToken;Object.assign(s,{phoneEnrollmentInfo:{phoneNumber:C,recaptchaToken:P,captchaResponse:x,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in s){const C=s.phoneSignInInfo.recaptchaToken;Object.assign(s,{phoneSignInInfo:{recaptchaToken:C,captchaResponse:x,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return s}return l?Object.assign(s,{captchaResp:x}):Object.assign(s,{captchaResponse:x}),Object.assign(s,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(s,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),s}async function o2(t,e,n,l,d){if(t._getRecaptchaConfig()?.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const f=await GM(t,e,n,n==="getOobCode");return l(t,f)}else return l(t,e).catch(async f=>{if(f.code==="auth/missing-recaptcha-token"){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const x=await GM(t,e,n,n==="getOobCode");return l(t,x)}else return Promise.reject(f)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dq(t,e){const n=Sp(t,"auth");if(n.isInitialized()){const d=n.getImmediate(),f=n.getOptions();if(Hh(f,e??{}))return d;_c(d,"already-initialized")}return n.initialize({options:e})}function Lq(t,e){const n=e?.persistence||[],l=(Array.isArray(n)?n:[n]).map(hd);e?.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(l,e?.popupRedirectResolver)}function zq(t,e,n){const l=Ep(t);jr(/^https?:\/\//.test(e),l,"invalid-emulator-scheme");const d=!1,f=Oz(e),{host:x,port:s}=Fq(e),C=s===null?"":`:${s}`,P={url:`${f}//${x}${C}/`},L=Object.freeze({host:x,port:s,protocol:f.replace(":",""),options:Object.freeze({disableWarnings:d})});if(!l._canInitEmulator){jr(l.config.emulator&&l.emulatorConfig,l,"emulator-config-failed"),jr(Hh(P,l.config.emulator)&&Hh(L,l.emulatorConfig),l,"emulator-config-failed");return}l.config.emulator=P,l.emulatorConfig=L,l.settings.appVerificationDisabledForTesting=!0,Ad(x)?(lT(`${f}//${x}${C}`),cT("Auth",!0)):Bq()}function Oz(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function Fq(t){const e=Oz(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const l=n[2].split("@").pop()||"",d=/^(\[[^\]]+\])(:|$)/.exec(l);if(d){const f=d[1];return{host:f,port:HM(l.substr(f.length+1))}}else{const[f,x]=l.split(":");return{host:f,port:HM(x)}}}function HM(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function Bq(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aA{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return dd("not implemented")}_getIdTokenResponse(e){return dd("not implemented")}_linkToIdToken(e,n){return dd("not implemented")}_getReauthenticationResolver(e){return dd("not implemented")}}async function Nq(t,e){return sf(t,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Vq(t,e){return X0(t,"POST","/v1/accounts:signInWithPassword",of(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $q(t,e){return X0(t,"POST","/v1/accounts:signInWithEmailLink",of(t,e))}async function Uq(t,e){return X0(t,"POST","/v1/accounts:signInWithEmailLink",of(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yv extends aA{constructor(e,n,l,d=null){super("password",l),this._email=e,this._password=n,this._tenantId=d}static _fromEmailAndPassword(e,n){return new Yv(e,n,"password")}static _fromEmailAndCode(e,n,l=null){return new Yv(e,n,"emailLink",l)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;if(n?.email&&n?.password){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return o2(e,n,"signInWithPassword",Vq);case"emailLink":return $q(e,{email:this._email,oobCode:this._password});default:_c(e,"internal-error")}}async _linkToIdToken(e,n){switch(this.signInMethod){case"password":const l={idToken:n,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return o2(e,l,"signUpPassword",Nq);case"emailLink":return Uq(e,{idToken:n,email:this._email,oobCode:this._password});default:_c(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Cg(t,e){return X0(t,"POST","/v1/accounts:signInWithIdp",of(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jq="http://localhost";class gp extends aA{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new gp(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):_c("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:l,signInMethod:d,...f}=n;if(!l||!d)return null;const x=new gp(l,d);return x.idToken=f.idToken||void 0,x.accessToken=f.accessToken||void 0,x.secret=f.secret,x.nonce=f.nonce,x.pendingToken=f.pendingToken||null,x}_getIdTokenResponse(e){const n=this.buildRequest();return Cg(e,n)}_linkToIdToken(e,n){const l=this.buildRequest();return l.idToken=n,Cg(e,l)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,Cg(e,n)}buildRequest(){const e={requestUri:jq,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=q0(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gq(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function Hq(t){const e=sv(av(t)).link,n=e?sv(av(e)).deep_link_id:null,l=sv(av(t)).deep_link_id;return(l?sv(av(l)).link:null)||l||n||e||t}class lA{constructor(e){const n=sv(av(e)),l=n.apiKey??null,d=n.oobCode??null,f=Gq(n.mode??null);jr(l&&d&&f,"argument-error"),this.apiKey=l,this.operation=f,this.code=d,this.continueUrl=n.continueUrl??null,this.languageCode=n.lang??null,this.tenantId=n.tenantId??null}static parseLink(e){const n=Hq(e);try{return new lA(n)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jg{constructor(){this.providerId=Jg.PROVIDER_ID}static credential(e,n){return Yv._fromEmailAndPassword(e,n)}static credentialWithLink(e,n){const l=lA.parseLink(n);return jr(l,"argument-error"),Yv._fromEmailAndCode(e,l.code,l.tenantId)}}Jg.PROVIDER_ID="password";Jg.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Jg.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mz{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y0 extends Mz{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ih extends Y0{constructor(){super("facebook.com")}static credential(e){return gp._fromParams({providerId:Ih.PROVIDER_ID,signInMethod:Ih.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ih.credentialFromTaggedObject(e)}static credentialFromError(e){return Ih.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ih.credential(e.oauthAccessToken)}catch{return null}}}Ih.FACEBOOK_SIGN_IN_METHOD="facebook.com";Ih.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ah extends Y0{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return gp._fromParams({providerId:Ah.PROVIDER_ID,signInMethod:Ah.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return Ah.credentialFromTaggedObject(e)}static credentialFromError(e){return Ah.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:l}=e;if(!n&&!l)return null;try{return Ah.credential(n,l)}catch{return null}}}Ah.GOOGLE_SIGN_IN_METHOD="google.com";Ah.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ph extends Y0{constructor(){super("github.com")}static credential(e){return gp._fromParams({providerId:Ph.PROVIDER_ID,signInMethod:Ph.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ph.credentialFromTaggedObject(e)}static credentialFromError(e){return Ph.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ph.credential(e.oauthAccessToken)}catch{return null}}}Ph.GITHUB_SIGN_IN_METHOD="github.com";Ph.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rh extends Y0{constructor(){super("twitter.com")}static credential(e,n){return gp._fromParams({providerId:Rh.PROVIDER_ID,signInMethod:Rh.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return Rh.credentialFromTaggedObject(e)}static credentialFromError(e){return Rh.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:l}=e;if(!n||!l)return null;try{return Rh.credential(n,l)}catch{return null}}}Rh.TWITTER_SIGN_IN_METHOD="twitter.com";Rh.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Wq(t,e){return X0(t,"POST","/v1/accounts:signUp",of(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _p{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,l,d=!1){const f=await uc._fromIdTokenResponse(e,l,d),x=WM(l);return new _p({user:f,providerId:x,_tokenResponse:l,operationType:n})}static async _forOperation(e,n,l){await e._updateTokensIfNecessary(l,!0);const d=WM(l);return new _p({user:e,providerId:d,_tokenResponse:l,operationType:n})}}function WM(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mw extends Vl{constructor(e,n,l,d){super(n.code,n.message),this.operationType=l,this.user=d,Object.setPrototypeOf(this,mw.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:n.customData._serverResponse,operationType:l}}static _fromErrorAndOperation(e,n,l,d){return new mw(e,n,l,d)}}function Dz(t,e,n,l){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(f=>{throw f.code==="auth/multi-factor-auth-required"?mw._fromErrorAndOperation(t,f,e,l):f})}async function qq(t,e,n=!1){const l=await Xv(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return _p._forOperation(t,"link",l)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Kq(t,e,n=!1){const{auth:l}=t;if(Ia(l.app))return Promise.reject(pd(l));const d="reauthenticate";try{const f=await Xv(t,Dz(l,d,e,t),n);jr(f.idToken,l,"internal-error");const x=oA(f.idToken);jr(x,l,"internal-error");const{sub:s}=x;return jr(t.uid===s,l,"user-mismatch"),_p._forOperation(t,d,f)}catch(f){throw f?.code==="auth/user-not-found"&&_c(l,"user-mismatch"),f}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Lz(t,e,n=!1){if(Ia(t.app))return Promise.reject(pd(t));const l="signIn",d=await Dz(t,l,e),f=await _p._fromIdTokenResponse(t,l,d);return n||await t._updateCurrentUser(f.user),f}async function Zq(t,e){return Lz(Ep(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function zz(t){const e=Ep(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function Xq(t,e,n){if(Ia(t.app))return Promise.reject(pd(t));const l=Ep(t),x=await o2(l,{returnSecureToken:!0,email:e,password:n,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",Wq).catch(C=>{throw C.code==="auth/password-does-not-meet-requirements"&&zz(t),C}),s=await _p._fromIdTokenResponse(l,"signIn",x);return await l._updateCurrentUser(s.user),s}function Yq(t,e,n){return Ia(t.app)?Promise.reject(pd(t)):Zq(zo(t),Jg.credential(e,n)).catch(async l=>{throw l.code==="auth/password-does-not-meet-requirements"&&zz(t),l})}function Jq(t,e,n,l){return zo(t).onIdTokenChanged(e,n,l)}function Qq(t,e,n){return zo(t).beforeAuthStateChanged(e,n)}function Fz(t,e,n,l){return zo(t).onAuthStateChanged(e,n,l)}function eK(t){return zo(t).signOut()}const gw="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bz{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(gw,"1"),this.storage.removeItem(gw),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tK=1e3,nK=10;class Nz extends Bz{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=Az(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const l=this.storage.getItem(n),d=this.localCache[n];l!==d&&e(n,d,l)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((x,s,C)=>{this.notifyListeners(x,C)});return}const l=e.key;n?this.detachListener():this.stopPolling();const d=()=>{const x=this.storage.getItem(l);!n&&this.localCache[l]===x||this.notifyListeners(l,x)},f=this.storage.getItem(l);bq()&&f!==e.newValue&&e.newValue!==e.oldValue?setTimeout(d,nK):d()}notifyListeners(e,n){this.localCache[e]=n;const l=this.listeners[e];if(l)for(const d of Array.from(l))d(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,l)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:l}),!0)})},tK)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}Nz.type="LOCAL";const rK=Nz;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vz extends Bz{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}Vz.type="SESSION";const $z=Vz;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iK(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fT{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(d=>d.isListeningto(e));if(n)return n;const l=new fT(e);return this.receivers.push(l),l}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:l,eventType:d,data:f}=n.data,x=this.handlersMap[d];if(!x?.size)return;n.ports[0].postMessage({status:"ack",eventId:l,eventType:d});const s=Array.from(x).map(async P=>P(n.origin,f)),C=await iK(s);n.ports[0].postMessage({status:"done",eventId:l,eventType:d,response:C})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}fT.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cA(t="",e=10){let n="";for(let l=0;l<e;l++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oK{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,l=50){const d=typeof MessageChannel<"u"?new MessageChannel:null;if(!d)throw new Error("connection_unavailable");let f,x;return new Promise((s,C)=>{const P=cA("",20);d.port1.start();const L=setTimeout(()=>{C(new Error("unsupported_event"))},l);x={messageChannel:d,onMessage($){const V=$;if(V.data.eventId===P)switch(V.data.status){case"ack":clearTimeout(L),f=setTimeout(()=>{C(new Error("timeout"))},3e3);break;case"done":clearTimeout(f),s(V.data.response);break;default:clearTimeout(L),clearTimeout(f),C(new Error("invalid_response"));break}}},this.handlers.add(x),d.port1.addEventListener("message",x.onMessage),this.target.postMessage({eventType:e,eventId:P,data:n},[d.port2])}).finally(()=>{x&&this.removeMessageHandler(x)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function su(){return window}function sK(t){su().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Uz(){return typeof su().WorkerGlobalScope<"u"&&typeof su().importScripts=="function"}async function aK(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function lK(){return navigator?.serviceWorker?.controller||null}function cK(){return Uz()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jz="firebaseLocalStorageDb",uK=1,_w="firebaseLocalStorage",Gz="fbase_key";class J0{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function pT(t,e){return t.transaction([_w],e?"readwrite":"readonly").objectStore(_w)}function dK(){const t=indexedDB.deleteDatabase(jz);return new J0(t).toPromise()}function s2(){const t=indexedDB.open(jz,uK);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const l=t.result;try{l.createObjectStore(_w,{keyPath:Gz})}catch(d){n(d)}}),t.addEventListener("success",async()=>{const l=t.result;l.objectStoreNames.contains(_w)?e(l):(l.close(),await dK(),e(await s2()))})})}async function qM(t,e,n){const l=pT(t,!0).put({[Gz]:e,value:n});return new J0(l).toPromise()}async function hK(t,e){const n=pT(t,!1).get(e),l=await new J0(n).toPromise();return l===void 0?null:l.value}function KM(t,e){const n=pT(t,!0).delete(e);return new J0(n).toPromise()}const fK=800,pK=3;class Hz{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await s2(),this.db)}async _withRetries(e){let n=0;for(;;)try{const l=await this._openDb();return await e(l)}catch(l){if(n++>pK)throw l;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Uz()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=fT._getInstance(cK()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await aK(),!this.activeServiceWorker)return;this.sender=new oK(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||lK()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await s2();return await qM(e,gw,"1"),await KM(e,gw),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(l=>qM(l,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(l=>hK(l,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>KM(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(d=>{const f=pT(d,!1).getAll();return new J0(f).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],l=new Set;if(e.length!==0)for(const{fbase_key:d,value:f}of e)l.add(d),JSON.stringify(this.localCache[d])!==JSON.stringify(f)&&(this.notifyListeners(d,f),n.push(d));for(const d of Object.keys(this.localCache))this.localCache[d]&&!l.has(d)&&(this.notifyListeners(d,null),n.push(d));return n}notifyListeners(e,n){this.localCache[e]=n;const l=this.listeners[e];if(l)for(const d of Array.from(l))d(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),fK)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}Hz.type="LOCAL";const mK=Hz;new Z0(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gK(t,e){return e?hd(e):(jr(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uA extends aA{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Cg(e,this._buildIdpRequest())}_linkToIdToken(e,n){return Cg(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return Cg(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function _K(t){return Lz(t.auth,new uA(t),t.bypassAuthState)}function yK(t){const{auth:e,user:n}=t;return jr(n,e,"internal-error"),Kq(n,new uA(t),t.bypassAuthState)}async function vK(t){const{auth:e,user:n}=t;return jr(n,e,"internal-error"),qq(n,new uA(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wz{constructor(e,n,l,d,f=!1){this.auth=e,this.resolver=l,this.user=d,this.bypassAuthState=f,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(l){this.reject(l)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:l,postBody:d,tenantId:f,error:x,type:s}=e;if(x){this.reject(x);return}const C={auth:this.auth,requestUri:n,sessionId:l,tenantId:f||void 0,postBody:d||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(s)(C))}catch(P){this.reject(P)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return _K;case"linkViaPopup":case"linkViaRedirect":return vK;case"reauthViaPopup":case"reauthViaRedirect":return yK;default:_c(this.auth,"internal-error")}}resolve(e){xd(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){xd(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bK=new Z0(2e3,1e4);class pg extends Wz{constructor(e,n,l,d,f){super(e,n,d,f),this.provider=l,this.authWindow=null,this.pollId=null,pg.currentPopupAction&&pg.currentPopupAction.cancel(),pg.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return jr(e,this.auth,"internal-error"),e}async onExecution(){xd(this.filter.length===1,"Popup operations only handle one event");const e=cA();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(ou(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(ou(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,pg.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(ou(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,bK.get())};e()}}pg.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xK="pendingRedirect",Vx=new Map;class wK extends Wz{constructor(e,n,l=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,l),this.eventId=null}async execute(){let e=Vx.get(this.auth._key());if(!e){try{const l=await TK(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(l)}catch(n){e=()=>Promise.reject(n)}Vx.set(this.auth._key(),e)}return this.bypassAuthState||Vx.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function TK(t,e){const n=CK(e),l=EK(t);if(!await l._isAvailable())return!1;const d=await l._get(n)==="true";return await l._remove(n),d}function SK(t,e){Vx.set(t._key(),e)}function EK(t){return hd(t._redirectPersistence)}function CK(t){return Nx(xK,t.config.apiKey,t.name)}async function IK(t,e,n=!1){if(Ia(t.app))return Promise.reject(pd(t));const l=Ep(t),d=gK(l,e),x=await new wK(l,d,n).execute();return x&&!n&&(delete x.user._redirectEventId,await l._persistUserIfCurrent(x.user),await l._setRedirectUser(null,e)),x}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AK=600*1e3;class PK{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(l=>{this.isEventForConsumer(e,l)&&(n=!0,this.sendToConsumer(e,l),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!RK(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){if(e.error&&!qz(e)){const l=e.error.code?.split("auth/")[1]||"internal-error";n.onError(ou(this.auth,l))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const l=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&l}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=AK&&this.cachedEventUids.clear(),this.cachedEventUids.has(ZM(e))}saveEventToCache(e){this.cachedEventUids.add(ZM(e)),this.lastProcessedEventTime=Date.now()}}function ZM(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function qz({type:t,error:e}){return t==="unknown"&&e?.code==="auth/no-auth-event"}function RK(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return qz(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function kK(t,e={}){return sf(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OK=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,MK=/^https?/;async function DK(t){if(t.config.emulator)return;const{authorizedDomains:e}=await kK(t);for(const n of e)try{if(LK(n))return}catch{}_c(t,"unauthorized-domain")}function LK(t){const e=r2(),{protocol:n,hostname:l}=new URL(e);if(t.startsWith("chrome-extension://")){const x=new URL(t);return x.hostname===""&&l===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&x.hostname===l}if(!MK.test(n))return!1;if(OK.test(t))return l===t;const d=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+d+"|"+d+")$","i").test(l)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zK=new Z0(3e4,6e4);function XM(){const t=su().___jsl;if(t?.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function FK(t){return new Promise((e,n)=>{function l(){XM(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{XM(),n(ou(t,"network-request-failed"))},timeout:zK.get()})}if(su().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(su().gapi?.load)l();else{const d=Pq("iframefcb");return su()[d]=()=>{gapi.load?l():n(ou(t,"network-request-failed"))},Rz(`${Aq()}?onload=${d}`).catch(f=>n(f))}}).catch(e=>{throw $x=null,e})}let $x=null;function BK(t){return $x=$x||FK(t),$x}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NK=new Z0(5e3,15e3),VK="__/auth/iframe",$K="emulator/auth/iframe",UK={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},jK=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function GK(t){const e=t.config;jr(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?iA(e,$K):`https://${t.config.authDomain}/${VK}`,l={apiKey:e.apiKey,appName:t.name,v:Pd},d=jK.get(t.config.apiHost);d&&(l.eid=d);const f=t._getFrameworks();return f.length&&(l.fw=f.join(",")),`${n}?${q0(l).slice(1)}`}async function HK(t){const e=await BK(t),n=su().gapi;return jr(n,t,"internal-error"),e.open({where:document.body,url:GK(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:UK,dontclear:!0},l=>new Promise(async(d,f)=>{await l.restyle({setHideOnLeave:!1});const x=ou(t,"network-request-failed"),s=su().setTimeout(()=>{f(x)},NK.get());function C(){su().clearTimeout(s),d(l)}l.ping(C).then(C,()=>{f(x)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WK={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},qK=500,KK=600,ZK="_blank",XK="http://localhost";class YM{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function YK(t,e,n,l=qK,d=KK){const f=Math.max((window.screen.availHeight-d)/2,0).toString(),x=Math.max((window.screen.availWidth-l)/2,0).toString();let s="";const C={...WK,width:l.toString(),height:d.toString(),top:f,left:x},P=ca().toLowerCase();n&&(s=Tz(P)?ZK:n),xz(P)&&(e=e||XK,C.scrollbars="yes");const L=Object.entries(C).reduce((V,[j,ue])=>`${V}${j}=${ue},`,"");if(vq(P)&&s!=="_self")return JK(e||"",s),new YM(null);const $=window.open(e||"",s,L);jr($,t,"popup-blocked");try{$.focus()}catch{}return new YM($)}function JK(t,e){const n=document.createElement("a");n.href=t,n.target=e;const l=document.createEvent("MouseEvent");l.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(l)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QK="__/auth/handler",eZ="emulator/auth/handler",tZ=encodeURIComponent("fac");async function JM(t,e,n,l,d,f){jr(t.config.authDomain,t,"auth-domain-config-required"),jr(t.config.apiKey,t,"invalid-api-key");const x={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:l,v:Pd,eventId:d};if(e instanceof Mz){e.setDefaultLanguage(t.languageCode),x.providerId=e.providerId||"",zH(e.getCustomParameters())||(x.customParameters=JSON.stringify(e.getCustomParameters()));for(const[L,$]of Object.entries({}))x[L]=$}if(e instanceof Y0){const L=e.getScopes().filter($=>$!=="");L.length>0&&(x.scopes=L.join(","))}t.tenantId&&(x.tid=t.tenantId);const s=x;for(const L of Object.keys(s))s[L]===void 0&&delete s[L];const C=await t._getAppCheckToken(),P=C?`#${tZ}=${encodeURIComponent(C)}`:"";return`${nZ(t)}?${q0(s).slice(1)}${P}`}function nZ({config:t}){return t.emulator?iA(t,eZ):`https://${t.authDomain}/${QK}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fC="webStorageSupport";class rZ{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=$z,this._completeRedirectFn=IK,this._overrideRedirectResult=SK}async _openPopup(e,n,l,d){xd(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const f=await JM(e,n,l,r2(),d);return YK(e,f,cA())}async _openRedirect(e,n,l,d){await this._originValidation(e);const f=await JM(e,n,l,r2(),d);return sK(f),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:d,promise:f}=this.eventManagers[n];return d?Promise.resolve(d):(xd(f,"If manager is not set, promise should be"),f)}const l=this.initAndGetManager(e);return this.eventManagers[n]={promise:l},l.catch(()=>{delete this.eventManagers[n]}),l}async initAndGetManager(e){const n=await HK(e),l=new PK(e);return n.register("authEvent",d=>(jr(d?.authEvent,e,"invalid-auth-event"),{status:l.onEvent(d.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:l},this.iframes[e._key()]=n,l}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(fC,{type:fC},d=>{const f=d?.[0]?.[fC];f!==void 0&&n(!!f),_c(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=DK(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return Az()||wz()||sA()}}const iZ=rZ;var QM="@firebase/auth",eD="1.11.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oZ{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(l=>{e(l?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){jr(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sZ(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function aZ(t){mu(new pu("auth",(e,{options:n})=>{const l=e.getProvider("app").getImmediate(),d=e.getProvider("heartbeat"),f=e.getProvider("app-check-internal"),{apiKey:x,authDomain:s}=l.options;jr(x&&!x.includes(":"),"invalid-api-key",{appName:l.name});const C={apiKey:x,authDomain:s,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Pz(t)},P=new Eq(l,d,f,C);return Lq(P,n),P},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,l)=>{e.getProvider("auth-internal").initialize()})),mu(new pu("auth-internal",e=>{const n=Ep(e.getProvider("auth").getImmediate());return(l=>new oZ(l))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),la(QM,eD,sZ(t)),la(QM,eD,"esm2020")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lZ=300,cZ=J6("authIdTokenMaxAge")||lZ;let tD=null;const uZ=t=>async e=>{const n=e&&await e.getIdTokenResult(),l=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(l&&l>cZ)return;const d=n?.token;tD!==d&&(tD=d,await fetch(t,{method:d?"POST":"DELETE",headers:d?{Authorization:`Bearer ${d}`}:{}}))};function dZ(t=K0()){const e=Sp(t,"auth");if(e.isInitialized())return e.getImmediate();const n=Dq(t,{popupRedirectResolver:iZ,persistence:[mK,rK,$z]}),l=J6("authTokenSyncURL");if(l&&typeof isSecureContext=="boolean"&&isSecureContext){const f=new URL(l,location.origin);if(location.origin===f.origin){const x=uZ(f.toString());Qq(n,x,()=>x(n.currentUser)),Jq(n,s=>x(s))}}const d=Y6("auth");return d&&zq(n,`http://${d}`),n}function hZ(){return document.getElementsByTagName("head")?.[0]??document}Cq({loadJS(t){return new Promise((e,n)=>{const l=document.createElement("script");l.setAttribute("src",t),l.onload=e,l.onerror=d=>{const f=ou("internal-error");f.customData=d,n(f)},l.type="text/javascript",l.charset="UTF-8",hZ().appendChild(l)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});aZ("Browser");var nD=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Vh,Kz;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(Pe,we){function Se(){}Se.prototype=we.prototype,Pe.D=we.prototype,Pe.prototype=new Se,Pe.prototype.constructor=Pe,Pe.C=function(je,Re,Ve){for(var ke=Array(arguments.length-2),Mn=2;Mn<arguments.length;Mn++)ke[Mn-2]=arguments[Mn];return we.prototype[Re].apply(je,ke)}}function n(){this.blockSize=-1}function l(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(l,n),l.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function d(Pe,we,Se){Se||(Se=0);var je=Array(16);if(typeof we=="string")for(var Re=0;16>Re;++Re)je[Re]=we.charCodeAt(Se++)|we.charCodeAt(Se++)<<8|we.charCodeAt(Se++)<<16|we.charCodeAt(Se++)<<24;else for(Re=0;16>Re;++Re)je[Re]=we[Se++]|we[Se++]<<8|we[Se++]<<16|we[Se++]<<24;we=Pe.g[0],Se=Pe.g[1],Re=Pe.g[2];var Ve=Pe.g[3],ke=we+(Ve^Se&(Re^Ve))+je[0]+3614090360&4294967295;we=Se+(ke<<7&4294967295|ke>>>25),ke=Ve+(Re^we&(Se^Re))+je[1]+3905402710&4294967295,Ve=we+(ke<<12&4294967295|ke>>>20),ke=Re+(Se^Ve&(we^Se))+je[2]+606105819&4294967295,Re=Ve+(ke<<17&4294967295|ke>>>15),ke=Se+(we^Re&(Ve^we))+je[3]+3250441966&4294967295,Se=Re+(ke<<22&4294967295|ke>>>10),ke=we+(Ve^Se&(Re^Ve))+je[4]+4118548399&4294967295,we=Se+(ke<<7&4294967295|ke>>>25),ke=Ve+(Re^we&(Se^Re))+je[5]+1200080426&4294967295,Ve=we+(ke<<12&4294967295|ke>>>20),ke=Re+(Se^Ve&(we^Se))+je[6]+2821735955&4294967295,Re=Ve+(ke<<17&4294967295|ke>>>15),ke=Se+(we^Re&(Ve^we))+je[7]+4249261313&4294967295,Se=Re+(ke<<22&4294967295|ke>>>10),ke=we+(Ve^Se&(Re^Ve))+je[8]+1770035416&4294967295,we=Se+(ke<<7&4294967295|ke>>>25),ke=Ve+(Re^we&(Se^Re))+je[9]+2336552879&4294967295,Ve=we+(ke<<12&4294967295|ke>>>20),ke=Re+(Se^Ve&(we^Se))+je[10]+4294925233&4294967295,Re=Ve+(ke<<17&4294967295|ke>>>15),ke=Se+(we^Re&(Ve^we))+je[11]+2304563134&4294967295,Se=Re+(ke<<22&4294967295|ke>>>10),ke=we+(Ve^Se&(Re^Ve))+je[12]+1804603682&4294967295,we=Se+(ke<<7&4294967295|ke>>>25),ke=Ve+(Re^we&(Se^Re))+je[13]+4254626195&4294967295,Ve=we+(ke<<12&4294967295|ke>>>20),ke=Re+(Se^Ve&(we^Se))+je[14]+2792965006&4294967295,Re=Ve+(ke<<17&4294967295|ke>>>15),ke=Se+(we^Re&(Ve^we))+je[15]+1236535329&4294967295,Se=Re+(ke<<22&4294967295|ke>>>10),ke=we+(Re^Ve&(Se^Re))+je[1]+4129170786&4294967295,we=Se+(ke<<5&4294967295|ke>>>27),ke=Ve+(Se^Re&(we^Se))+je[6]+3225465664&4294967295,Ve=we+(ke<<9&4294967295|ke>>>23),ke=Re+(we^Se&(Ve^we))+je[11]+643717713&4294967295,Re=Ve+(ke<<14&4294967295|ke>>>18),ke=Se+(Ve^we&(Re^Ve))+je[0]+3921069994&4294967295,Se=Re+(ke<<20&4294967295|ke>>>12),ke=we+(Re^Ve&(Se^Re))+je[5]+3593408605&4294967295,we=Se+(ke<<5&4294967295|ke>>>27),ke=Ve+(Se^Re&(we^Se))+je[10]+38016083&4294967295,Ve=we+(ke<<9&4294967295|ke>>>23),ke=Re+(we^Se&(Ve^we))+je[15]+3634488961&4294967295,Re=Ve+(ke<<14&4294967295|ke>>>18),ke=Se+(Ve^we&(Re^Ve))+je[4]+3889429448&4294967295,Se=Re+(ke<<20&4294967295|ke>>>12),ke=we+(Re^Ve&(Se^Re))+je[9]+568446438&4294967295,we=Se+(ke<<5&4294967295|ke>>>27),ke=Ve+(Se^Re&(we^Se))+je[14]+3275163606&4294967295,Ve=we+(ke<<9&4294967295|ke>>>23),ke=Re+(we^Se&(Ve^we))+je[3]+4107603335&4294967295,Re=Ve+(ke<<14&4294967295|ke>>>18),ke=Se+(Ve^we&(Re^Ve))+je[8]+1163531501&4294967295,Se=Re+(ke<<20&4294967295|ke>>>12),ke=we+(Re^Ve&(Se^Re))+je[13]+2850285829&4294967295,we=Se+(ke<<5&4294967295|ke>>>27),ke=Ve+(Se^Re&(we^Se))+je[2]+4243563512&4294967295,Ve=we+(ke<<9&4294967295|ke>>>23),ke=Re+(we^Se&(Ve^we))+je[7]+1735328473&4294967295,Re=Ve+(ke<<14&4294967295|ke>>>18),ke=Se+(Ve^we&(Re^Ve))+je[12]+2368359562&4294967295,Se=Re+(ke<<20&4294967295|ke>>>12),ke=we+(Se^Re^Ve)+je[5]+4294588738&4294967295,we=Se+(ke<<4&4294967295|ke>>>28),ke=Ve+(we^Se^Re)+je[8]+2272392833&4294967295,Ve=we+(ke<<11&4294967295|ke>>>21),ke=Re+(Ve^we^Se)+je[11]+1839030562&4294967295,Re=Ve+(ke<<16&4294967295|ke>>>16),ke=Se+(Re^Ve^we)+je[14]+4259657740&4294967295,Se=Re+(ke<<23&4294967295|ke>>>9),ke=we+(Se^Re^Ve)+je[1]+2763975236&4294967295,we=Se+(ke<<4&4294967295|ke>>>28),ke=Ve+(we^Se^Re)+je[4]+1272893353&4294967295,Ve=we+(ke<<11&4294967295|ke>>>21),ke=Re+(Ve^we^Se)+je[7]+4139469664&4294967295,Re=Ve+(ke<<16&4294967295|ke>>>16),ke=Se+(Re^Ve^we)+je[10]+3200236656&4294967295,Se=Re+(ke<<23&4294967295|ke>>>9),ke=we+(Se^Re^Ve)+je[13]+681279174&4294967295,we=Se+(ke<<4&4294967295|ke>>>28),ke=Ve+(we^Se^Re)+je[0]+3936430074&4294967295,Ve=we+(ke<<11&4294967295|ke>>>21),ke=Re+(Ve^we^Se)+je[3]+3572445317&4294967295,Re=Ve+(ke<<16&4294967295|ke>>>16),ke=Se+(Re^Ve^we)+je[6]+76029189&4294967295,Se=Re+(ke<<23&4294967295|ke>>>9),ke=we+(Se^Re^Ve)+je[9]+3654602809&4294967295,we=Se+(ke<<4&4294967295|ke>>>28),ke=Ve+(we^Se^Re)+je[12]+3873151461&4294967295,Ve=we+(ke<<11&4294967295|ke>>>21),ke=Re+(Ve^we^Se)+je[15]+530742520&4294967295,Re=Ve+(ke<<16&4294967295|ke>>>16),ke=Se+(Re^Ve^we)+je[2]+3299628645&4294967295,Se=Re+(ke<<23&4294967295|ke>>>9),ke=we+(Re^(Se|~Ve))+je[0]+4096336452&4294967295,we=Se+(ke<<6&4294967295|ke>>>26),ke=Ve+(Se^(we|~Re))+je[7]+1126891415&4294967295,Ve=we+(ke<<10&4294967295|ke>>>22),ke=Re+(we^(Ve|~Se))+je[14]+2878612391&4294967295,Re=Ve+(ke<<15&4294967295|ke>>>17),ke=Se+(Ve^(Re|~we))+je[5]+4237533241&4294967295,Se=Re+(ke<<21&4294967295|ke>>>11),ke=we+(Re^(Se|~Ve))+je[12]+1700485571&4294967295,we=Se+(ke<<6&4294967295|ke>>>26),ke=Ve+(Se^(we|~Re))+je[3]+2399980690&4294967295,Ve=we+(ke<<10&4294967295|ke>>>22),ke=Re+(we^(Ve|~Se))+je[10]+4293915773&4294967295,Re=Ve+(ke<<15&4294967295|ke>>>17),ke=Se+(Ve^(Re|~we))+je[1]+2240044497&4294967295,Se=Re+(ke<<21&4294967295|ke>>>11),ke=we+(Re^(Se|~Ve))+je[8]+1873313359&4294967295,we=Se+(ke<<6&4294967295|ke>>>26),ke=Ve+(Se^(we|~Re))+je[15]+4264355552&4294967295,Ve=we+(ke<<10&4294967295|ke>>>22),ke=Re+(we^(Ve|~Se))+je[6]+2734768916&4294967295,Re=Ve+(ke<<15&4294967295|ke>>>17),ke=Se+(Ve^(Re|~we))+je[13]+1309151649&4294967295,Se=Re+(ke<<21&4294967295|ke>>>11),ke=we+(Re^(Se|~Ve))+je[4]+4149444226&4294967295,we=Se+(ke<<6&4294967295|ke>>>26),ke=Ve+(Se^(we|~Re))+je[11]+3174756917&4294967295,Ve=we+(ke<<10&4294967295|ke>>>22),ke=Re+(we^(Ve|~Se))+je[2]+718787259&4294967295,Re=Ve+(ke<<15&4294967295|ke>>>17),ke=Se+(Ve^(Re|~we))+je[9]+3951481745&4294967295,Pe.g[0]=Pe.g[0]+we&4294967295,Pe.g[1]=Pe.g[1]+(Re+(ke<<21&4294967295|ke>>>11))&4294967295,Pe.g[2]=Pe.g[2]+Re&4294967295,Pe.g[3]=Pe.g[3]+Ve&4294967295}l.prototype.u=function(Pe,we){we===void 0&&(we=Pe.length);for(var Se=we-this.blockSize,je=this.B,Re=this.h,Ve=0;Ve<we;){if(Re==0)for(;Ve<=Se;)d(this,Pe,Ve),Ve+=this.blockSize;if(typeof Pe=="string"){for(;Ve<we;)if(je[Re++]=Pe.charCodeAt(Ve++),Re==this.blockSize){d(this,je),Re=0;break}}else for(;Ve<we;)if(je[Re++]=Pe[Ve++],Re==this.blockSize){d(this,je),Re=0;break}}this.h=Re,this.o+=we},l.prototype.v=function(){var Pe=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);Pe[0]=128;for(var we=1;we<Pe.length-8;++we)Pe[we]=0;var Se=8*this.o;for(we=Pe.length-8;we<Pe.length;++we)Pe[we]=Se&255,Se/=256;for(this.u(Pe),Pe=Array(16),we=Se=0;4>we;++we)for(var je=0;32>je;je+=8)Pe[Se++]=this.g[we]>>>je&255;return Pe};function f(Pe,we){var Se=s;return Object.prototype.hasOwnProperty.call(Se,Pe)?Se[Pe]:Se[Pe]=we(Pe)}function x(Pe,we){this.h=we;for(var Se=[],je=!0,Re=Pe.length-1;0<=Re;Re--){var Ve=Pe[Re]|0;je&&Ve==we||(Se[Re]=Ve,je=!1)}this.g=Se}var s={};function C(Pe){return-128<=Pe&&128>Pe?f(Pe,function(we){return new x([we|0],0>we?-1:0)}):new x([Pe|0],0>Pe?-1:0)}function P(Pe){if(isNaN(Pe)||!isFinite(Pe))return $;if(0>Pe)return Te(P(-Pe));for(var we=[],Se=1,je=0;Pe>=Se;je++)we[je]=Pe/Se|0,Se*=4294967296;return new x(we,0)}function L(Pe,we){if(Pe.length==0)throw Error("number format error: empty string");if(we=we||10,2>we||36<we)throw Error("radix out of range: "+we);if(Pe.charAt(0)=="-")return Te(L(Pe.substring(1),we));if(0<=Pe.indexOf("-"))throw Error('number format error: interior "-" character');for(var Se=P(Math.pow(we,8)),je=$,Re=0;Re<Pe.length;Re+=8){var Ve=Math.min(8,Pe.length-Re),ke=parseInt(Pe.substring(Re,Re+Ve),we);8>Ve?(Ve=P(Math.pow(we,Ve)),je=je.j(Ve).add(P(ke))):(je=je.j(Se),je=je.add(P(ke)))}return je}var $=C(0),V=C(1),j=C(16777216);t=x.prototype,t.m=function(){if(de(this))return-Te(this).m();for(var Pe=0,we=1,Se=0;Se<this.g.length;Se++){var je=this.i(Se);Pe+=(0<=je?je:4294967296+je)*we,we*=4294967296}return Pe},t.toString=function(Pe){if(Pe=Pe||10,2>Pe||36<Pe)throw Error("radix out of range: "+Pe);if(ue(this))return"0";if(de(this))return"-"+Te(this).toString(Pe);for(var we=P(Math.pow(Pe,6)),Se=this,je="";;){var Re=Ne(Se,we).g;Se=Be(Se,Re.j(we));var Ve=((0<Se.g.length?Se.g[0]:Se.h)>>>0).toString(Pe);if(Se=Re,ue(Se))return Ve+je;for(;6>Ve.length;)Ve="0"+Ve;je=Ve+je}},t.i=function(Pe){return 0>Pe?0:Pe<this.g.length?this.g[Pe]:this.h};function ue(Pe){if(Pe.h!=0)return!1;for(var we=0;we<Pe.g.length;we++)if(Pe.g[we]!=0)return!1;return!0}function de(Pe){return Pe.h==-1}t.l=function(Pe){return Pe=Be(this,Pe),de(Pe)?-1:ue(Pe)?0:1};function Te(Pe){for(var we=Pe.g.length,Se=[],je=0;je<we;je++)Se[je]=~Pe.g[je];return new x(Se,~Pe.h).add(V)}t.abs=function(){return de(this)?Te(this):this},t.add=function(Pe){for(var we=Math.max(this.g.length,Pe.g.length),Se=[],je=0,Re=0;Re<=we;Re++){var Ve=je+(this.i(Re)&65535)+(Pe.i(Re)&65535),ke=(Ve>>>16)+(this.i(Re)>>>16)+(Pe.i(Re)>>>16);je=ke>>>16,Ve&=65535,ke&=65535,Se[Re]=ke<<16|Ve}return new x(Se,Se[Se.length-1]&-2147483648?-1:0)};function Be(Pe,we){return Pe.add(Te(we))}t.j=function(Pe){if(ue(this)||ue(Pe))return $;if(de(this))return de(Pe)?Te(this).j(Te(Pe)):Te(Te(this).j(Pe));if(de(Pe))return Te(this.j(Te(Pe)));if(0>this.l(j)&&0>Pe.l(j))return P(this.m()*Pe.m());for(var we=this.g.length+Pe.g.length,Se=[],je=0;je<2*we;je++)Se[je]=0;for(je=0;je<this.g.length;je++)for(var Re=0;Re<Pe.g.length;Re++){var Ve=this.i(je)>>>16,ke=this.i(je)&65535,Mn=Pe.i(Re)>>>16,bn=Pe.i(Re)&65535;Se[2*je+2*Re]+=ke*bn,Ge(Se,2*je+2*Re),Se[2*je+2*Re+1]+=Ve*bn,Ge(Se,2*je+2*Re+1),Se[2*je+2*Re+1]+=ke*Mn,Ge(Se,2*je+2*Re+1),Se[2*je+2*Re+2]+=Ve*Mn,Ge(Se,2*je+2*Re+2)}for(je=0;je<we;je++)Se[je]=Se[2*je+1]<<16|Se[2*je];for(je=we;je<2*we;je++)Se[je]=0;return new x(Se,0)};function Ge(Pe,we){for(;(Pe[we]&65535)!=Pe[we];)Pe[we+1]+=Pe[we]>>>16,Pe[we]&=65535,we++}function Ye(Pe,we){this.g=Pe,this.h=we}function Ne(Pe,we){if(ue(we))throw Error("division by zero");if(ue(Pe))return new Ye($,$);if(de(Pe))return we=Ne(Te(Pe),we),new Ye(Te(we.g),Te(we.h));if(de(we))return we=Ne(Pe,Te(we)),new Ye(Te(we.g),we.h);if(30<Pe.g.length){if(de(Pe)||de(we))throw Error("slowDivide_ only works with positive integers.");for(var Se=V,je=we;0>=je.l(Pe);)Se=Mt(Se),je=Mt(je);var Re=kt(Se,1),Ve=kt(je,1);for(je=kt(je,2),Se=kt(Se,2);!ue(je);){var ke=Ve.add(je);0>=ke.l(Pe)&&(Re=Re.add(Se),Ve=ke),je=kt(je,1),Se=kt(Se,1)}return we=Be(Pe,Re.j(we)),new Ye(Re,we)}for(Re=$;0<=Pe.l(we);){for(Se=Math.max(1,Math.floor(Pe.m()/we.m())),je=Math.ceil(Math.log(Se)/Math.LN2),je=48>=je?1:Math.pow(2,je-48),Ve=P(Se),ke=Ve.j(we);de(ke)||0<ke.l(Pe);)Se-=je,Ve=P(Se),ke=Ve.j(we);ue(Ve)&&(Ve=V),Re=Re.add(Ve),Pe=Be(Pe,ke)}return new Ye(Re,Pe)}t.A=function(Pe){return Ne(this,Pe).h},t.and=function(Pe){for(var we=Math.max(this.g.length,Pe.g.length),Se=[],je=0;je<we;je++)Se[je]=this.i(je)&Pe.i(je);return new x(Se,this.h&Pe.h)},t.or=function(Pe){for(var we=Math.max(this.g.length,Pe.g.length),Se=[],je=0;je<we;je++)Se[je]=this.i(je)|Pe.i(je);return new x(Se,this.h|Pe.h)},t.xor=function(Pe){for(var we=Math.max(this.g.length,Pe.g.length),Se=[],je=0;je<we;je++)Se[je]=this.i(je)^Pe.i(je);return new x(Se,this.h^Pe.h)};function Mt(Pe){for(var we=Pe.g.length+1,Se=[],je=0;je<we;je++)Se[je]=Pe.i(je)<<1|Pe.i(je-1)>>>31;return new x(Se,Pe.h)}function kt(Pe,we){var Se=we>>5;we%=32;for(var je=Pe.g.length-Se,Re=[],Ve=0;Ve<je;Ve++)Re[Ve]=0<we?Pe.i(Ve+Se)>>>we|Pe.i(Ve+Se+1)<<32-we:Pe.i(Ve+Se);return new x(Re,Pe.h)}l.prototype.digest=l.prototype.v,l.prototype.reset=l.prototype.s,l.prototype.update=l.prototype.u,Kz=l,x.prototype.add=x.prototype.add,x.prototype.multiply=x.prototype.j,x.prototype.modulo=x.prototype.A,x.prototype.compare=x.prototype.l,x.prototype.toNumber=x.prototype.m,x.prototype.toString=x.prototype.toString,x.prototype.getBits=x.prototype.i,x.fromNumber=P,x.fromString=L,Vh=x}).apply(typeof nD<"u"?nD:typeof self<"u"?self:typeof window<"u"?window:{});var cx=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Zz,lv,Xz,Ux,a2,Yz,Jz,Qz;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(k,X,te){return k==Array.prototype||k==Object.prototype||(k[X]=te.value),k};function n(k){k=[typeof globalThis=="object"&&globalThis,k,typeof window=="object"&&window,typeof self=="object"&&self,typeof cx=="object"&&cx];for(var X=0;X<k.length;++X){var te=k[X];if(te&&te.Math==Math)return te}throw Error("Cannot find global object")}var l=n(this);function d(k,X){if(X)e:{var te=l;k=k.split(".");for(var Ee=0;Ee<k.length-1;Ee++){var pt=k[Ee];if(!(pt in te))break e;te=te[pt]}k=k[k.length-1],Ee=te[k],X=X(Ee),X!=Ee&&X!=null&&e(te,k,{configurable:!0,writable:!0,value:X})}}function f(k,X){k instanceof String&&(k+="");var te=0,Ee=!1,pt={next:function(){if(!Ee&&te<k.length){var Ft=te++;return{value:X(Ft,k[Ft]),done:!1}}return Ee=!0,{done:!0,value:void 0}}};return pt[Symbol.iterator]=function(){return pt},pt}d("Array.prototype.values",function(k){return k||function(){return f(this,function(X,te){return te})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var x=x||{},s=this||self;function C(k){var X=typeof k;return X=X!="object"?X:k?Array.isArray(k)?"array":X:"null",X=="array"||X=="object"&&typeof k.length=="number"}function P(k){var X=typeof k;return X=="object"&&k!=null||X=="function"}function L(k,X,te){return k.call.apply(k.bind,arguments)}function $(k,X,te){if(!k)throw Error();if(2<arguments.length){var Ee=Array.prototype.slice.call(arguments,2);return function(){var pt=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(pt,Ee),k.apply(X,pt)}}return function(){return k.apply(X,arguments)}}function V(k,X,te){return V=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?L:$,V.apply(null,arguments)}function j(k,X){var te=Array.prototype.slice.call(arguments,1);return function(){var Ee=te.slice();return Ee.push.apply(Ee,arguments),k.apply(this,Ee)}}function ue(k,X){function te(){}te.prototype=X.prototype,k.aa=X.prototype,k.prototype=new te,k.prototype.constructor=k,k.Qb=function(Ee,pt,Ft){for(var gn=Array(arguments.length-2),Qi=2;Qi<arguments.length;Qi++)gn[Qi-2]=arguments[Qi];return X.prototype[pt].apply(Ee,gn)}}function de(k){const X=k.length;if(0<X){const te=Array(X);for(let Ee=0;Ee<X;Ee++)te[Ee]=k[Ee];return te}return[]}function Te(k,X){for(let te=1;te<arguments.length;te++){const Ee=arguments[te];if(C(Ee)){const pt=k.length||0,Ft=Ee.length||0;k.length=pt+Ft;for(let gn=0;gn<Ft;gn++)k[pt+gn]=Ee[gn]}else k.push(Ee)}}class Be{constructor(X,te){this.i=X,this.j=te,this.h=0,this.g=null}get(){let X;return 0<this.h?(this.h--,X=this.g,this.g=X.next,X.next=null):X=this.i(),X}}function Ge(k){return/^[\s\xa0]*$/.test(k)}function Ye(){var k=s.navigator;return k&&(k=k.userAgent)?k:""}function Ne(k){return Ne[" "](k),k}Ne[" "]=function(){};var Mt=Ye().indexOf("Gecko")!=-1&&!(Ye().toLowerCase().indexOf("webkit")!=-1&&Ye().indexOf("Edge")==-1)&&!(Ye().indexOf("Trident")!=-1||Ye().indexOf("MSIE")!=-1)&&Ye().indexOf("Edge")==-1;function kt(k,X,te){for(const Ee in k)X.call(te,k[Ee],Ee,k)}function Pe(k,X){for(const te in k)X.call(void 0,k[te],te,k)}function we(k){const X={};for(const te in k)X[te]=k[te];return X}const Se="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function je(k,X){let te,Ee;for(let pt=1;pt<arguments.length;pt++){Ee=arguments[pt];for(te in Ee)k[te]=Ee[te];for(let Ft=0;Ft<Se.length;Ft++)te=Se[Ft],Object.prototype.hasOwnProperty.call(Ee,te)&&(k[te]=Ee[te])}}function Re(k){var X=1;k=k.split(":");const te=[];for(;0<X&&k.length;)te.push(k.shift()),X--;return k.length&&te.push(k.join(":")),te}function Ve(k){s.setTimeout(()=>{throw k},0)}function ke(){var k=Br;let X=null;return k.g&&(X=k.g,k.g=k.g.next,k.g||(k.h=null),X.next=null),X}class Mn{constructor(){this.h=this.g=null}add(X,te){const Ee=bn.get();Ee.set(X,te),this.h?this.h.next=Ee:this.g=Ee,this.h=Ee}}var bn=new Be(()=>new mn,k=>k.reset());class mn{constructor(){this.next=this.g=this.h=null}set(X,te){this.h=X,this.g=te,this.next=null}reset(){this.next=this.g=this.h=null}}let Sn,ar=!1,Br=new Mn,ei=()=>{const k=s.Promise.resolve(void 0);Sn=()=>{k.then(or)}};var or=()=>{for(var k;k=ke();){try{k.h.call(k.g)}catch(te){Ve(te)}var X=bn;X.j(k),100>X.h&&(X.h++,k.next=X.g,X.g=k)}ar=!1};function vr(){this.s=this.s,this.C=this.C}vr.prototype.s=!1,vr.prototype.ma=function(){this.s||(this.s=!0,this.N())},vr.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function oi(k,X){this.type=k,this.g=this.target=X,this.defaultPrevented=!1}oi.prototype.h=function(){this.defaultPrevented=!0};var uo=(function(){if(!s.addEventListener||!Object.defineProperty)return!1;var k=!1,X=Object.defineProperty({},"passive",{get:function(){k=!0}});try{const te=()=>{};s.addEventListener("test",te,X),s.removeEventListener("test",te,X)}catch{}return k})();function Gi(k,X){if(oi.call(this,k?k.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,k){var te=this.type=k.type,Ee=k.changedTouches&&k.changedTouches.length?k.changedTouches[0]:null;if(this.target=k.target||k.srcElement,this.g=X,X=k.relatedTarget){if(Mt){e:{try{Ne(X.nodeName);var pt=!0;break e}catch{}pt=!1}pt||(X=null)}}else te=="mouseover"?X=k.fromElement:te=="mouseout"&&(X=k.toElement);this.relatedTarget=X,Ee?(this.clientX=Ee.clientX!==void 0?Ee.clientX:Ee.pageX,this.clientY=Ee.clientY!==void 0?Ee.clientY:Ee.pageY,this.screenX=Ee.screenX||0,this.screenY=Ee.screenY||0):(this.clientX=k.clientX!==void 0?k.clientX:k.pageX,this.clientY=k.clientY!==void 0?k.clientY:k.pageY,this.screenX=k.screenX||0,this.screenY=k.screenY||0),this.button=k.button,this.key=k.key||"",this.ctrlKey=k.ctrlKey,this.altKey=k.altKey,this.shiftKey=k.shiftKey,this.metaKey=k.metaKey,this.pointerId=k.pointerId||0,this.pointerType=typeof k.pointerType=="string"?k.pointerType:ur[k.pointerType]||"",this.state=k.state,this.i=k,k.defaultPrevented&&Gi.aa.h.call(this)}}ue(Gi,oi);var ur={2:"touch",3:"pen",4:"mouse"};Gi.prototype.h=function(){Gi.aa.h.call(this);var k=this.i;k.preventDefault?k.preventDefault():k.returnValue=!1};var Ot="closure_listenable_"+(1e6*Math.random()|0),ln=0;function yn(k,X,te,Ee,pt){this.listener=k,this.proxy=null,this.src=X,this.type=te,this.capture=!!Ee,this.ha=pt,this.key=++ln,this.da=this.fa=!1}function vn(k){k.da=!0,k.listener=null,k.proxy=null,k.src=null,k.ha=null}function Nr(k){this.src=k,this.g={},this.h=0}Nr.prototype.add=function(k,X,te,Ee,pt){var Ft=k.toString();k=this.g[Ft],k||(k=this.g[Ft]=[],this.h++);var gn=Qe(k,X,Ee,pt);return-1<gn?(X=k[gn],te||(X.fa=!1)):(X=new yn(X,this.src,Ft,!!Ee,pt),X.fa=te,k.push(X)),X};function He(k,X){var te=X.type;if(te in k.g){var Ee=k.g[te],pt=Array.prototype.indexOf.call(Ee,X,void 0),Ft;(Ft=0<=pt)&&Array.prototype.splice.call(Ee,pt,1),Ft&&(vn(X),k.g[te].length==0&&(delete k.g[te],k.h--))}}function Qe(k,X,te,Ee){for(var pt=0;pt<k.length;++pt){var Ft=k[pt];if(!Ft.da&&Ft.listener==X&&Ft.capture==!!te&&Ft.ha==Ee)return pt}return-1}var dt="closure_lm_"+(1e6*Math.random()|0),Lt={};function qt(k,X,te,Ee,pt){if(Array.isArray(X)){for(var Ft=0;Ft<X.length;Ft++)qt(k,X[Ft],te,Ee,pt);return null}return te=dr(te),k&&k[Ot]?k.K(X,te,P(Ee)?!!Ee.capture:!1,pt):jt(k,X,te,!1,Ee,pt)}function jt(k,X,te,Ee,pt,Ft){if(!X)throw Error("Invalid event type");var gn=P(pt)?!!pt.capture:!!pt,Qi=En(k);if(Qi||(k[dt]=Qi=new Nr(k)),te=Qi.add(X,te,Ee,gn,Ft),te.proxy)return te;if(Ee=Rn(),te.proxy=Ee,Ee.src=k,Ee.listener=te,k.addEventListener)uo||(pt=gn),pt===void 0&&(pt=!1),k.addEventListener(X.toString(),Ee,pt);else if(k.attachEvent)k.attachEvent(Zt(X.toString()),Ee);else if(k.addListener&&k.removeListener)k.addListener(Ee);else throw Error("addEventListener and attachEvent are unavailable.");return te}function Rn(){function k(te){return X.call(k.src,k.listener,te)}const X=Xn;return k}function fn(k,X,te,Ee,pt){if(Array.isArray(X))for(var Ft=0;Ft<X.length;Ft++)fn(k,X[Ft],te,Ee,pt);else Ee=P(Ee)?!!Ee.capture:!!Ee,te=dr(te),k&&k[Ot]?(k=k.i,X=String(X).toString(),X in k.g&&(Ft=k.g[X],te=Qe(Ft,te,Ee,pt),-1<te&&(vn(Ft[te]),Array.prototype.splice.call(Ft,te,1),Ft.length==0&&(delete k.g[X],k.h--)))):k&&(k=En(k))&&(X=k.g[X.toString()],k=-1,X&&(k=Qe(X,te,Ee,pt)),(te=-1<k?X[k]:null)&&cn(te))}function cn(k){if(typeof k!="number"&&k&&!k.da){var X=k.src;if(X&&X[Ot])He(X.i,k);else{var te=k.type,Ee=k.proxy;X.removeEventListener?X.removeEventListener(te,Ee,k.capture):X.detachEvent?X.detachEvent(Zt(te),Ee):X.addListener&&X.removeListener&&X.removeListener(Ee),(te=En(X))?(He(te,k),te.h==0&&(te.src=null,X[dt]=null)):vn(k)}}}function Zt(k){return k in Lt?Lt[k]:Lt[k]="on"+k}function Xn(k,X){if(k.da)k=!0;else{X=new Gi(X,this);var te=k.listener,Ee=k.ha||k.src;k.fa&&cn(k),k=te.call(Ee,X)}return k}function En(k){return k=k[dt],k instanceof Nr?k:null}var jn="__closure_events_fn_"+(1e9*Math.random()>>>0);function dr(k){return typeof k=="function"?k:(k[jn]||(k[jn]=function(X){return k.handleEvent(X)}),k[jn])}function Gn(){vr.call(this),this.i=new Nr(this),this.M=this,this.F=null}ue(Gn,vr),Gn.prototype[Ot]=!0,Gn.prototype.removeEventListener=function(k,X,te,Ee){fn(this,k,X,te,Ee)};function hr(k,X){var te,Ee=k.F;if(Ee)for(te=[];Ee;Ee=Ee.F)te.push(Ee);if(k=k.M,Ee=X.type||X,typeof X=="string")X=new oi(X,k);else if(X instanceof oi)X.target=X.target||k;else{var pt=X;X=new oi(Ee,k),je(X,pt)}if(pt=!0,te)for(var Ft=te.length-1;0<=Ft;Ft--){var gn=X.g=te[Ft];pt=Yr(gn,Ee,!0,X)&&pt}if(gn=X.g=k,pt=Yr(gn,Ee,!0,X)&&pt,pt=Yr(gn,Ee,!1,X)&&pt,te)for(Ft=0;Ft<te.length;Ft++)gn=X.g=te[Ft],pt=Yr(gn,Ee,!1,X)&&pt}Gn.prototype.N=function(){if(Gn.aa.N.call(this),this.i){var k=this.i,X;for(X in k.g){for(var te=k.g[X],Ee=0;Ee<te.length;Ee++)vn(te[Ee]);delete k.g[X],k.h--}}this.F=null},Gn.prototype.K=function(k,X,te,Ee){return this.i.add(String(k),X,!1,te,Ee)},Gn.prototype.L=function(k,X,te,Ee){return this.i.add(String(k),X,!0,te,Ee)};function Yr(k,X,te,Ee){if(X=k.i.g[String(X)],!X)return!0;X=X.concat();for(var pt=!0,Ft=0;Ft<X.length;++Ft){var gn=X[Ft];if(gn&&!gn.da&&gn.capture==te){var Qi=gn.listener,Eo=gn.ha||gn.src;gn.fa&&He(k.i,gn),pt=Qi.call(Eo,Ee)!==!1&&pt}}return pt&&!Ee.defaultPrevented}function ho(k,X,te){if(typeof k=="function")te&&(k=V(k,te));else if(k&&typeof k.handleEvent=="function")k=V(k.handleEvent,k);else throw Error("Invalid listener argument");return 2147483647<Number(X)?-1:s.setTimeout(k,X||0)}function So(k){k.g=ho(()=>{k.g=null,k.i&&(k.i=!1,So(k))},k.l);const X=k.h;k.h=null,k.m.apply(null,X)}class Vi extends vr{constructor(X,te){super(),this.m=X,this.l=te,this.h=null,this.i=!1,this.g=null}j(X){this.h=arguments,this.g?this.i=!0:So(this)}N(){super.N(),this.g&&(s.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function oo(k){vr.call(this),this.h=k,this.g={}}ue(oo,vr);var Hs=[];function Ws(k){kt(k.g,function(X,te){this.g.hasOwnProperty(te)&&cn(X)},k),k.g={}}oo.prototype.N=function(){oo.aa.N.call(this),Ws(this)},oo.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var so=s.JSON.stringify,Fo=s.JSON.parse,Ma=class{stringify(k){return s.JSON.stringify(k,void 0)}parse(k){return s.JSON.parse(k,void 0)}};function ai(){}ai.prototype.h=null;function ko(k){return k.h||(k.h=k.i())}function bc(){}var ua={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Os(){oi.call(this,"d")}ue(Os,oi);function Ul(){oi.call(this,"c")}ue(Ul,oi);var da={},xu=null;function xt(){return xu=xu||new Gn}da.La="serverreachability";function Da(k){oi.call(this,da.La,k)}ue(Da,oi);function jl(k){const X=xt();hr(X,new Da(X))}da.STAT_EVENT="statevent";function Gl(k,X){oi.call(this,da.STAT_EVENT,k),this.stat=X}ue(Gl,oi);function Fe(k){const X=xt();hr(X,new Gl(X,k))}da.Ma="timingevent";function Y(k,X){oi.call(this,da.Ma,k),this.size=X}ue(Y,oi);function Q(k,X){if(typeof k!="function")throw Error("Fn must not be null and must be a function");return s.setTimeout(function(){k()},X)}function ce(){this.g=!0}ce.prototype.xa=function(){this.g=!1};function Ie(k,X,te,Ee,pt,Ft){k.info(function(){if(k.g)if(Ft)for(var gn="",Qi=Ft.split("&"),Eo=0;Eo<Qi.length;Eo++){var yr=Qi[Eo].split("=");if(1<yr.length){var $i=yr[0];yr=yr[1];var In=$i.split("_");gn=2<=In.length&&In[1]=="type"?gn+($i+"="+yr+"&"):gn+($i+"=redacted&")}}else gn=null;else gn=Ft;return"XMLHTTP REQ ("+Ee+") [attempt "+pt+"]: "+X+`
`+te+`
`+gn})}function xe(k,X,te,Ee,pt,Ft,gn){k.info(function(){return"XMLHTTP RESP ("+Ee+") [ attempt "+pt+"]: "+X+`
`+te+`
`+Ft+" "+gn})}function be(k,X,te,Ee){k.info(function(){return"XMLHTTP TEXT ("+X+"): "+ze(k,te)+(Ee?" "+Ee:"")})}function tt(k,X){k.info(function(){return"TIMEOUT: "+X})}ce.prototype.info=function(){};function ze(k,X){if(!k.g)return X;if(!X)return null;try{var te=JSON.parse(X);if(te){for(k=0;k<te.length;k++)if(Array.isArray(te[k])){var Ee=te[k];if(!(2>Ee.length)){var pt=Ee[1];if(Array.isArray(pt)&&!(1>pt.length)){var Ft=pt[0];if(Ft!="noop"&&Ft!="stop"&&Ft!="close")for(var gn=1;gn<pt.length;gn++)pt[gn]=""}}}}return so(te)}catch{return X}}var nt={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Rt={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},gt;function on(){}ue(on,ai),on.prototype.g=function(){return new XMLHttpRequest},on.prototype.i=function(){return{}},gt=new on;function xn(k,X,te,Ee){this.j=k,this.i=X,this.l=te,this.R=Ee||1,this.U=new oo(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new zn}function zn(){this.i=null,this.g="",this.h=!1}var lr={},Yn={};function fr(k,X,te){k.L=1,k.v=ys(pa(X)),k.m=te,k.P=!0,ti(k,null)}function ti(k,X){k.F=Date.now(),to(k),k.A=pa(k.v);var te=k.A,Ee=k.R;Array.isArray(Ee)||(Ee=[String(Ee)]),Eu(te.i,"t",Ee),k.C=0,te=k.j.J,k.h=new zn,k.g=Xa(k.j,te?X:null,!k.m),0<k.O&&(k.M=new Vi(V(k.Y,k,k.g),k.O)),X=k.U,te=k.g,Ee=k.ca;var pt="readystatechange";Array.isArray(pt)||(pt&&(Hs[0]=pt.toString()),pt=Hs);for(var Ft=0;Ft<pt.length;Ft++){var gn=qt(te,pt[Ft],Ee||X.handleEvent,!1,X.h||X);if(!gn)break;X.g[gn.key]=gn}X=k.H?we(k.H):{},k.m?(k.u||(k.u="POST"),X["Content-Type"]="application/x-www-form-urlencoded",k.g.ea(k.A,k.u,k.m,X)):(k.u="GET",k.g.ea(k.A,k.u,null,X)),jl(),Ie(k.i,k.u,k.A,k.l,k.R,k.m)}xn.prototype.ca=function(k){k=k.target;const X=this.M;X&&Oo(k)==3?X.j():this.Y(k)},xn.prototype.Y=function(k){try{if(k==this.g)e:{const In=Oo(this.g);var X=this.g.Ba();const Gt=this.g.Z();if(!(3>In)&&(In!=3||this.g&&(this.h.h||this.g.oa()||xl(this.g)))){this.J||In!=4||X==7||(X==8||0>=Gt?jl(3):jl(2)),Zr(this);var te=this.g.Z();this.X=te;t:if(cr(this)){var Ee=xl(this.g);k="";var pt=Ee.length,Ft=Oo(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){di(this),Sr(this);var gn="";break t}this.h.i=new s.TextDecoder}for(X=0;X<pt;X++)this.h.h=!0,k+=this.h.i.decode(Ee[X],{stream:!(Ft&&X==pt-1)});Ee.length=0,this.h.g+=k,this.C=0,gn=this.h.g}else gn=this.g.oa();if(this.o=te==200,xe(this.i,this.u,this.A,this.l,this.R,In,te),this.o){if(this.T&&!this.K){t:{if(this.g){var Qi,Eo=this.g;if((Qi=Eo.g?Eo.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Ge(Qi)){var yr=Qi;break t}}yr=null}if(te=yr)be(this.i,this.l,te,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Ri(this,te);else{this.o=!1,this.s=3,Fe(12),di(this),Sr(this);break e}}if(this.P){te=!0;let ds;for(;!this.J&&this.C<gn.length;)if(ds=Hi(this,gn),ds==Yn){In==4&&(this.s=4,Fe(14),te=!1),be(this.i,this.l,null,"[Incomplete Response]");break}else if(ds==lr){this.s=4,Fe(15),be(this.i,this.l,gn,"[Invalid Chunk]"),te=!1;break}else be(this.i,this.l,ds,null),Ri(this,ds);if(cr(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),In!=4||gn.length!=0||this.h.h||(this.s=1,Fe(16),te=!1),this.o=this.o&&te,!te)be(this.i,this.l,gn,"[Invalid Chunked Response]"),di(this),Sr(this);else if(0<gn.length&&!this.W){this.W=!0;var $i=this.j;$i.g==this&&$i.ba&&!$i.M&&($i.j.info("Great, no buffering proxy detected. Bytes received: "+gn.length),Zs($i),$i.M=!0,Fe(11))}}else be(this.i,this.l,gn,null),Ri(this,gn);In==4&&di(this),this.o&&!this.J&&(In==4?Vr(this.j,this):(this.o=!1,to(this)))}else zs(this.g),te==400&&0<gn.indexOf("Unknown SID")?(this.s=3,Fe(12)):(this.s=0,Fe(13)),di(this),Sr(this)}}}catch{}finally{}};function cr(k){return k.g?k.u=="GET"&&k.L!=2&&k.j.Ca:!1}function Hi(k,X){var te=k.C,Ee=X.indexOf(`
`,te);return Ee==-1?Yn:(te=Number(X.substring(te,Ee)),isNaN(te)?lr:(Ee+=1,Ee+te>X.length?Yn:(X=X.slice(Ee,Ee+te),k.C=Ee+te,X)))}xn.prototype.cancel=function(){this.J=!0,di(this)};function to(k){k.S=Date.now()+k.I,fo(k,k.I)}function fo(k,X){if(k.B!=null)throw Error("WatchDog timer not null");k.B=Q(V(k.ba,k),X)}function Zr(k){k.B&&(s.clearTimeout(k.B),k.B=null)}xn.prototype.ba=function(){this.B=null;const k=Date.now();0<=k-this.S?(tt(this.i,this.A),this.L!=2&&(jl(),Fe(17)),di(this),this.s=2,Sr(this)):fo(this,this.S-k)};function Sr(k){k.j.G==0||k.J||Vr(k.j,k)}function di(k){Zr(k);var X=k.M;X&&typeof X.ma=="function"&&X.ma(),k.M=null,Ws(k.U),k.g&&(X=k.g,k.g=null,X.abort(),X.ma())}function Ri(k,X){try{var te=k.j;if(te.G!=0&&(te.g==k||ha(te.h,k))){if(!k.K&&ha(te.h,k)&&te.G==3){try{var Ee=te.Da.g.parse(X)}catch{Ee=null}if(Array.isArray(Ee)&&Ee.length==3){var pt=Ee;if(pt[0]==0){e:if(!te.u){if(te.g)if(te.g.F+3e3<k.F)Rr(te),Pr(te);else break e;Cc(te),Fe(18)}}else te.za=pt[1],0<te.za-te.T&&37500>pt[2]&&te.F&&te.v==0&&!te.C&&(te.C=Q(V(te.Za,te),6e3));if(1>=_s(te.h)&&te.ca){try{te.ca()}catch{}te.ca=void 0}}else Fs(te,11)}else if((k.K||te.g==k)&&Rr(te),!Ge(X))for(pt=te.Da.g.parse(X),X=0;X<pt.length;X++){let yr=pt[X];if(te.T=yr[0],yr=yr[1],te.G==2)if(yr[0]=="c"){te.K=yr[1],te.ia=yr[2];const $i=yr[3];$i!=null&&(te.la=$i,te.j.info("VER="+te.la));const In=yr[4];In!=null&&(te.Aa=In,te.j.info("SVER="+te.Aa));const Gt=yr[5];Gt!=null&&typeof Gt=="number"&&0<Gt&&(Ee=1.5*Gt,te.L=Ee,te.j.info("backChannelRequestTimeoutMs_="+Ee)),Ee=te;const ds=k.g;if(ds){const Tn=ds.g?ds.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Tn){var Ft=Ee.h;Ft.g||Tn.indexOf("spdy")==-1&&Tn.indexOf("quic")==-1&&Tn.indexOf("h2")==-1||(Ft.j=Ft.l,Ft.g=new Set,Ft.h&&(Ho(Ft,Ft.h),Ft.h=null))}if(Ee.D){const Ya=ds.g?ds.g.getResponseHeader("X-HTTP-Session-Id"):null;Ya&&(Ee.ya=Ya,li(Ee.I,Ee.D,Ya))}}te.G=3,te.l&&te.l.ua(),te.ba&&(te.R=Date.now()-k.F,te.j.info("Handshake RTT: "+te.R+"ms")),Ee=te;var gn=k;if(Ee.qa=Mu(Ee,Ee.J?Ee.ia:null,Ee.W),gn.K){Hl(Ee.h,gn);var Qi=gn,Eo=Ee.L;Eo&&(Qi.I=Eo),Qi.B&&(Zr(Qi),to(Qi)),Ee.g=gn}else Ks(Ee);0<te.i.length&&Ou(te)}else yr[0]!="stop"&&yr[0]!="close"||Fs(te,7);else te.G==3&&(yr[0]=="stop"||yr[0]=="close"?yr[0]=="stop"?Fs(te,7):ku(te):yr[0]!="noop"&&te.l&&te.l.ta(yr),te.v=0)}}jl(4)}catch{}}var hi=class{constructor(k,X){this.g=k,this.map=X}};function Bo(k){this.l=k||10,s.PerformanceNavigationTiming?(k=s.performance.getEntriesByType("navigation"),k=0<k.length&&(k[0].nextHopProtocol=="hq"||k[0].nextHopProtocol=="h2")):k=!!(s.chrome&&s.chrome.loadTimes&&s.chrome.loadTimes()&&s.chrome.loadTimes().wasFetchedViaSpdy),this.j=k?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Xo(k){return k.h?!0:k.g?k.g.size>=k.j:!1}function _s(k){return k.h?1:k.g?k.g.size:0}function ha(k,X){return k.h?k.h==X:k.g?k.g.has(X):!1}function Ho(k,X){k.g?k.g.add(X):k.h=X}function Hl(k,X){k.h&&k.h==X?k.h=null:k.g&&k.g.has(X)&&k.g.delete(X)}Bo.prototype.cancel=function(){if(this.i=pf(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const k of this.g.values())k.cancel();this.g.clear()}};function pf(k){if(k.h!=null)return k.i.concat(k.h.D);if(k.g!=null&&k.g.size!==0){let X=k.i;for(const te of k.g.values())X=X.concat(te.D);return X}return de(k.i)}function gl(k){if(k.V&&typeof k.V=="function")return k.V();if(typeof Map<"u"&&k instanceof Map||typeof Set<"u"&&k instanceof Set)return Array.from(k.values());if(typeof k=="string")return k.split("");if(C(k)){for(var X=[],te=k.length,Ee=0;Ee<te;Ee++)X.push(k[Ee]);return X}X=[],te=0;for(Ee in k)X[te++]=k[Ee];return X}function xc(k){if(k.na&&typeof k.na=="function")return k.na();if(!k.V||typeof k.V!="function"){if(typeof Map<"u"&&k instanceof Map)return Array.from(k.keys());if(!(typeof Set<"u"&&k instanceof Set)){if(C(k)||typeof k=="string"){var X=[];k=k.length;for(var te=0;te<k;te++)X.push(te);return X}X=[],te=0;for(const Ee in k)X[te++]=Ee;return X}}}function wc(k,X){if(k.forEach&&typeof k.forEach=="function")k.forEach(X,void 0);else if(C(k)||typeof k=="string")Array.prototype.forEach.call(k,X,void 0);else for(var te=xc(k),Ee=gl(k),pt=Ee.length,Ft=0;Ft<pt;Ft++)X.call(void 0,Ee[Ft],te&&te[Ft],k)}var Tc=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function _l(k,X){if(k){k=k.split("&");for(var te=0;te<k.length;te++){var Ee=k[te].indexOf("="),pt=null;if(0<=Ee){var Ft=k[te].substring(0,Ee);pt=k[te].substring(Ee+1)}else Ft=k[te];X(Ft,pt?decodeURIComponent(pt.replace(/\+/g," ")):"")}}}function fa(k){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,k instanceof fa){this.h=k.h,Ms(this,k.j),this.o=k.o,this.g=k.g,Sc(this,k.s),this.l=k.l;var X=k.i,te=new qa;te.i=X.i,X.g&&(te.g=new Map(X.g),te.h=X.h),wu(this,te),this.m=k.m}else k&&(X=String(k).match(Tc))?(this.h=!1,Ms(this,X[1]||"",!0),this.o=Ds(X[2]||""),this.g=Ds(X[3]||"",!0),Sc(this,X[4]),this.l=Ds(X[5]||"",!0),wu(this,X[6]||"",!0),this.m=Ds(X[7]||"")):(this.h=!1,this.i=new qa(null,this.h))}fa.prototype.toString=function(){var k=[],X=this.j;X&&k.push(cs(X,yl,!0),":");var te=this.g;return(te||X=="file")&&(k.push("//"),(X=this.o)&&k.push(cs(X,yl,!0),"@"),k.push(encodeURIComponent(String(te)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),te=this.s,te!=null&&k.push(":",String(te))),(te=this.l)&&(this.g&&te.charAt(0)!="/"&&k.push("/"),k.push(cs(te,te.charAt(0)=="/"?Tu:mf,!0))),(te=this.i.toString())&&k.push("?",te),(te=this.m)&&k.push("#",cs(te,Su)),k.join("")};function pa(k){return new fa(k)}function Ms(k,X,te){k.j=te?Ds(X,!0):X,k.j&&(k.j=k.j.replace(/:$/,""))}function Sc(k,X){if(X){if(X=Number(X),isNaN(X)||0>X)throw Error("Bad port number "+X);k.s=X}else k.s=null}function wu(k,X,te){X instanceof qa?(k.i=X,Od(k.i,k.h)):(te||(X=cs(X,vl)),k.i=new qa(X,k.h))}function li(k,X,te){k.i.set(X,te)}function ys(k){return li(k,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),k}function Ds(k,X){return k?X?decodeURI(k.replace(/%25/g,"%2525")):decodeURIComponent(k):""}function cs(k,X,te){return typeof k=="string"?(k=encodeURI(k).replace(X,ts),te&&(k=k.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),k):null}function ts(k){return k=k.charCodeAt(0),"%"+(k>>4&15).toString(16)+(k&15).toString(16)}var yl=/[#\/\?@]/g,mf=/[#\?:]/g,Tu=/[#\?]/g,vl=/[#\?@]/g,Su=/#/g;function qa(k,X){this.h=this.g=null,this.i=k||null,this.j=!!X}function Ls(k){k.g||(k.g=new Map,k.h=0,k.i&&_l(k.i,function(X,te){k.add(decodeURIComponent(X.replace(/\+/g," ")),te)}))}t=qa.prototype,t.add=function(k,X){Ls(this),this.i=null,k=ma(this,k);var te=this.g.get(k);return te||this.g.set(k,te=[]),te.push(X),this.h+=1,this};function vs(k,X){Ls(k),X=ma(k,X),k.g.has(X)&&(k.i=null,k.h-=k.g.get(X).length,k.g.delete(X))}function kd(k,X){return Ls(k),X=ma(k,X),k.g.has(X)}t.forEach=function(k,X){Ls(this),this.g.forEach(function(te,Ee){te.forEach(function(pt){k.call(X,pt,Ee,this)},this)},this)},t.na=function(){Ls(this);const k=Array.from(this.g.values()),X=Array.from(this.g.keys()),te=[];for(let Ee=0;Ee<X.length;Ee++){const pt=k[Ee];for(let Ft=0;Ft<pt.length;Ft++)te.push(X[Ee])}return te},t.V=function(k){Ls(this);let X=[];if(typeof k=="string")kd(this,k)&&(X=X.concat(this.g.get(ma(this,k))));else{k=Array.from(this.g.values());for(let te=0;te<k.length;te++)X=X.concat(k[te])}return X},t.set=function(k,X){return Ls(this),this.i=null,k=ma(this,k),kd(this,k)&&(this.h-=this.g.get(k).length),this.g.set(k,[X]),this.h+=1,this},t.get=function(k,X){return k?(k=this.V(k),0<k.length?String(k[0]):X):X};function Eu(k,X,te){vs(k,X),0<te.length&&(k.i=null,k.g.set(ma(k,X),de(te)),k.h+=te.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const k=[],X=Array.from(this.g.keys());for(var te=0;te<X.length;te++){var Ee=X[te];const Ft=encodeURIComponent(String(Ee)),gn=this.V(Ee);for(Ee=0;Ee<gn.length;Ee++){var pt=Ft;gn[Ee]!==""&&(pt+="="+encodeURIComponent(String(gn[Ee]))),k.push(pt)}}return this.i=k.join("&")};function ma(k,X){return X=String(X),k.j&&(X=X.toLowerCase()),X}function Od(k,X){X&&!k.j&&(Ls(k),k.i=null,k.g.forEach(function(te,Ee){var pt=Ee.toLowerCase();Ee!=pt&&(vs(this,Ee),Eu(this,pt,te))},k)),k.j=X}function gf(k,X){const te=new ce;if(s.Image){const Ee=new Image;Ee.onload=j(sr,te,"TestLoadImage: loaded",!0,X,Ee),Ee.onerror=j(sr,te,"TestLoadImage: error",!1,X,Ee),Ee.onabort=j(sr,te,"TestLoadImage: abort",!1,X,Ee),Ee.ontimeout=j(sr,te,"TestLoadImage: timeout",!1,X,Ee),s.setTimeout(function(){Ee.ontimeout&&Ee.ontimeout()},1e4),Ee.src=k}else X(!1)}function Md(k,X){const te=new ce,Ee=new AbortController,pt=setTimeout(()=>{Ee.abort(),sr(te,"TestPingServer: timeout",!1,X)},1e4);fetch(k,{signal:Ee.signal}).then(Ft=>{clearTimeout(pt),Ft.ok?sr(te,"TestPingServer: ok",!0,X):sr(te,"TestPingServer: server error",!1,X)}).catch(()=>{clearTimeout(pt),sr(te,"TestPingServer: error",!1,X)})}function sr(k,X,te,Ee,pt){try{pt&&(pt.onload=null,pt.onerror=null,pt.onabort=null,pt.ontimeout=null),Ee(te)}catch{}}function Ec(){this.g=new Ma}function Dp(k,X,te){const Ee=te||"";try{wc(k,function(pt,Ft){let gn=pt;P(pt)&&(gn=so(pt)),X.push(Ee+Ft+"="+encodeURIComponent(gn))})}catch(pt){throw X.push(Ee+"type="+encodeURIComponent("_badmap")),pt}}function Cu(k){this.l=k.Ub||null,this.j=k.eb||!1}ue(Cu,ai),Cu.prototype.g=function(){return new Wl(this.l,this.j)},Cu.prototype.i=(function(k){return function(){return k}})({});function Wl(k,X){Gn.call(this),this.D=k,this.o=X,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}ue(Wl,Gn),t=Wl.prototype,t.open=function(k,X){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=k,this.A=X,this.readyState=1,Za(this)},t.send=function(k){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const X={headers:this.u,method:this.B,credentials:this.m,cache:void 0};k&&(X.body=k),(this.D||s).fetch(new Request(this.A,X)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,La(this)),this.readyState=0},t.Sa=function(k){if(this.g&&(this.l=k,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=k.headers,this.readyState=2,Za(this)),this.g&&(this.readyState=3,Za(this),this.g)))if(this.responseType==="arraybuffer")k.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof s.ReadableStream<"u"&&"body"in k){if(this.j=k.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Ka(this)}else k.text().then(this.Ra.bind(this),this.ga.bind(this))};function Ka(k){k.j.read().then(k.Pa.bind(k)).catch(k.ga.bind(k))}t.Pa=function(k){if(this.g){if(this.o&&k.value)this.response.push(k.value);else if(!this.o){var X=k.value?k.value:new Uint8Array(0);(X=this.v.decode(X,{stream:!k.done}))&&(this.response=this.responseText+=X)}k.done?La(this):Za(this),this.readyState==3&&Ka(this)}},t.Ra=function(k){this.g&&(this.response=this.responseText=k,La(this))},t.Qa=function(k){this.g&&(this.response=k,La(this))},t.ga=function(){this.g&&La(this)};function La(k){k.readyState=4,k.l=null,k.j=null,k.v=null,Za(k)}t.setRequestHeader=function(k,X){this.u.append(k,X)},t.getResponseHeader=function(k){return this.h&&this.h.get(k.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const k=[],X=this.h.entries();for(var te=X.next();!te.done;)te=te.value,k.push(te[0]+": "+te[1]),te=X.next();return k.join(`\r
`)};function Za(k){k.onreadystatechange&&k.onreadystatechange.call(k)}Object.defineProperty(Wl.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(k){this.m=k?"include":"same-origin"}});function Iu(k){let X="";return kt(k,function(te,Ee){X+=Ee,X+=":",X+=te,X+=`\r
`}),X}function Dd(k,X,te){e:{for(Ee in te){var Ee=!1;break e}Ee=!0}Ee||(te=Iu(te),typeof k=="string"?te!=null&&encodeURIComponent(String(te)):li(k,X,te))}function Ji(k){Gn.call(this),this.headers=new Map,this.o=k||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}ue(Ji,Gn);var Lp=/^https?$/i,_f=["POST","PUT"];t=Ji.prototype,t.Ha=function(k){this.J=k},t.ea=function(k,X,te,Ee){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+k);X=X?X.toUpperCase():"GET",this.D=k,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():gt.g(),this.v=this.o?ko(this.o):ko(gt),this.g.onreadystatechange=V(this.Ea,this);try{this.B=!0,this.g.open(X,String(k),!0),this.B=!1}catch(Ft){ql(this,Ft);return}if(k=te||"",te=new Map(this.headers),Ee)if(Object.getPrototypeOf(Ee)===Object.prototype)for(var pt in Ee)te.set(pt,Ee[pt]);else if(typeof Ee.keys=="function"&&typeof Ee.get=="function")for(const Ft of Ee.keys())te.set(Ft,Ee.get(Ft));else throw Error("Unknown input type for opt_headers: "+String(Ee));Ee=Array.from(te.keys()).find(Ft=>Ft.toLowerCase()=="content-type"),pt=s.FormData&&k instanceof s.FormData,!(0<=Array.prototype.indexOf.call(_f,X,void 0))||Ee||pt||te.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[Ft,gn]of te)this.g.setRequestHeader(Ft,gn);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Pu(this),this.u=!0,this.g.send(k),this.u=!1}catch(Ft){ql(this,Ft)}};function ql(k,X){k.h=!1,k.g&&(k.j=!0,k.g.abort(),k.j=!1),k.l=X,k.m=5,Au(k),bl(k)}function Au(k){k.A||(k.A=!0,hr(k,"complete"),hr(k,"error"))}t.abort=function(k){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=k||7,hr(this,"complete"),hr(this,"abort"),bl(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),bl(this,!0)),Ji.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?qs(this):this.bb())},t.bb=function(){qs(this)};function qs(k){if(k.h&&typeof x<"u"&&(!k.v[1]||Oo(k)!=4||k.Z()!=2)){if(k.u&&Oo(k)==4)ho(k.Ea,0,k);else if(hr(k,"readystatechange"),Oo(k)==4){k.h=!1;try{const gn=k.Z();e:switch(gn){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var X=!0;break e;default:X=!1}var te;if(!(te=X)){var Ee;if(Ee=gn===0){var pt=String(k.D).match(Tc)[1]||null;!pt&&s.self&&s.self.location&&(pt=s.self.location.protocol.slice(0,-1)),Ee=!Lp.test(pt?pt.toLowerCase():"")}te=Ee}if(te)hr(k,"complete"),hr(k,"success");else{k.m=6;try{var Ft=2<Oo(k)?k.g.statusText:""}catch{Ft=""}k.l=Ft+" ["+k.Z()+"]",Au(k)}}finally{bl(k)}}}}function bl(k,X){if(k.g){Pu(k);const te=k.g,Ee=k.v[0]?()=>{}:null;k.g=null,k.v=null,X||hr(k,"ready");try{te.onreadystatechange=Ee}catch{}}}function Pu(k){k.I&&(s.clearTimeout(k.I),k.I=null)}t.isActive=function(){return!!this.g};function Oo(k){return k.g?k.g.readyState:0}t.Z=function(){try{return 2<Oo(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(k){if(this.g){var X=this.g.responseText;return k&&X.indexOf(k)==0&&(X=X.substring(k.length)),Fo(X)}};function xl(k){try{if(!k.g)return null;if("response"in k.g)return k.g.response;switch(k.H){case"":case"text":return k.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in k.g)return k.g.mozResponseArrayBuffer}return null}catch{return null}}function zs(k){const X={};k=(k.g&&2<=Oo(k)&&k.g.getAllResponseHeaders()||"").split(`\r
`);for(let Ee=0;Ee<k.length;Ee++){if(Ge(k[Ee]))continue;var te=Re(k[Ee]);const pt=te[0];if(te=te[1],typeof te!="string")continue;te=te.trim();const Ft=X[pt]||[];X[pt]=Ft,Ft.push(te)}Pe(X,function(Ee){return Ee.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Kl(k,X,te){return te&&te.internalChannelParams&&te.internalChannelParams[k]||X}function Ru(k){this.Aa=0,this.i=[],this.j=new ce,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Kl("failFast",!1,k),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Kl("baseRetryDelayMs",5e3,k),this.cb=Kl("retryDelaySeedMs",1e4,k),this.Wa=Kl("forwardChannelMaxRetries",2,k),this.wa=Kl("forwardChannelRequestTimeoutMs",2e4,k),this.pa=k&&k.xmlHttpFactory||void 0,this.Xa=k&&k.Tb||void 0,this.Ca=k&&k.useFetchStreams||!1,this.L=void 0,this.J=k&&k.supportsCrossDomainXhr||!1,this.K="",this.h=new Bo(k&&k.concurrentRequestLimit),this.Da=new Ec,this.P=k&&k.fastHandshake||!1,this.O=k&&k.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=k&&k.Rb||!1,k&&k.xa&&this.j.xa(),k&&k.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&k&&k.detectBufferingProxy||!1,this.ja=void 0,k&&k.longPollingTimeout&&0<k.longPollingTimeout&&(this.ja=k.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=Ru.prototype,t.la=8,t.G=1,t.connect=function(k,X,te,Ee){Fe(0),this.W=k,this.H=X||{},te&&Ee!==void 0&&(this.H.OSID=te,this.H.OAID=Ee),this.F=this.X,this.I=Mu(this,null,this.W),Ou(this)};function ku(k){if(Ld(k),k.G==3){var X=k.U++,te=pa(k.I);if(li(te,"SID",k.K),li(te,"RID",X),li(te,"TYPE","terminate"),Zl(k,te),X=new xn(k,k.j,X),X.L=2,X.v=ys(pa(te)),te=!1,s.navigator&&s.navigator.sendBeacon)try{te=s.navigator.sendBeacon(X.v.toString(),"")}catch{}!te&&s.Image&&(new Image().src=X.v,te=!0),te||(X.g=Xa(X.j,null),X.g.ea(X.v)),X.F=Date.now(),to(X)}kr(k)}function Pr(k){k.g&&(Zs(k),k.g.cancel(),k.g=null)}function Ld(k){Pr(k),k.u&&(s.clearTimeout(k.u),k.u=null),Rr(k),k.h.cancel(),k.s&&(typeof k.s=="number"&&s.clearTimeout(k.s),k.s=null)}function Ou(k){if(!Xo(k.h)&&!k.s){k.s=!0;var X=k.Ga;Sn||ei(),ar||(Sn(),ar=!0),Br.add(X,k),k.B=0}}function zd(k,X){return _s(k.h)>=k.h.j-(k.s?1:0)?!1:k.s?(k.i=X.D.concat(k.i),!0):k.G==1||k.G==2||k.B>=(k.Va?0:k.Wa)?!1:(k.s=Q(V(k.Ga,k,X),us(k,k.B)),k.B++,!0)}t.Ga=function(k){if(this.s)if(this.s=null,this.G==1){if(!k){this.U=Math.floor(1e5*Math.random()),k=this.U++;const pt=new xn(this,this.j,k);let Ft=this.o;if(this.S&&(Ft?(Ft=we(Ft),je(Ft,this.S)):Ft=this.S),this.m!==null||this.O||(pt.H=Ft,Ft=null),this.P)e:{for(var X=0,te=0;te<this.i.length;te++){t:{var Ee=this.i[te];if("__data__"in Ee.map&&(Ee=Ee.map.__data__,typeof Ee=="string")){Ee=Ee.length;break t}Ee=void 0}if(Ee===void 0)break;if(X+=Ee,4096<X){X=te;break e}if(X===4096||te===this.i.length-1){X=te+1;break e}}X=1e3}else X=1e3;X=bs(this,pt,X),te=pa(this.I),li(te,"RID",k),li(te,"CVER",22),this.D&&li(te,"X-HTTP-Session-Id",this.D),Zl(this,te),Ft&&(this.O?X="headers="+encodeURIComponent(String(Iu(Ft)))+"&"+X:this.m&&Dd(te,this.m,Ft)),Ho(this.h,pt),this.Ua&&li(te,"TYPE","init"),this.P?(li(te,"$req",X),li(te,"SID","null"),pt.T=!0,fr(pt,te,null)):fr(pt,te,X),this.G=2}}else this.G==3&&(k?wn(this,k):this.i.length==0||Xo(this.h)||wn(this))};function wn(k,X){var te;X?te=X.l:te=k.U++;const Ee=pa(k.I);li(Ee,"SID",k.K),li(Ee,"RID",te),li(Ee,"AID",k.T),Zl(k,Ee),k.m&&k.o&&Dd(Ee,k.m,k.o),te=new xn(k,k.j,te,k.B+1),k.m===null&&(te.H=k.o),X&&(k.i=X.D.concat(k.i)),X=bs(k,te,1e3),te.I=Math.round(.5*k.wa)+Math.round(.5*k.wa*Math.random()),Ho(k.h,te),fr(te,Ee,X)}function Zl(k,X){k.H&&kt(k.H,function(te,Ee){li(X,Ee,te)}),k.l&&wc({},function(te,Ee){li(X,Ee,te)})}function bs(k,X,te){te=Math.min(k.i.length,te);var Ee=k.l?V(k.l.Na,k.l,k):null;e:{var pt=k.i;let Ft=-1;for(;;){const gn=["count="+te];Ft==-1?0<te?(Ft=pt[0].g,gn.push("ofs="+Ft)):Ft=0:gn.push("ofs="+Ft);let Qi=!0;for(let Eo=0;Eo<te;Eo++){let yr=pt[Eo].g;const $i=pt[Eo].map;if(yr-=Ft,0>yr)Ft=Math.max(0,pt[Eo].g-100),Qi=!1;else try{Dp($i,gn,"req"+yr+"_")}catch{Ee&&Ee($i)}}if(Qi){Ee=gn.join("&");break e}}}return k=k.i.splice(0,te),X.D=k,Ee}function Ks(k){if(!k.g&&!k.u){k.Y=1;var X=k.Fa;Sn||ei(),ar||(Sn(),ar=!0),Br.add(X,k),k.v=0}}function Cc(k){return k.g||k.u||3<=k.v?!1:(k.Y++,k.u=Q(V(k.Fa,k),us(k,k.v)),k.v++,!0)}t.Fa=function(){if(this.u=null,sn(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var k=2*this.R;this.j.info("BP detection timer enabled: "+k),this.A=Q(V(this.ab,this),k)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Fe(10),Pr(this),sn(this))};function Zs(k){k.A!=null&&(s.clearTimeout(k.A),k.A=null)}function sn(k){k.g=new xn(k,k.j,"rpc",k.Y),k.m===null&&(k.g.H=k.o),k.g.O=0;var X=pa(k.qa);li(X,"RID","rpc"),li(X,"SID",k.K),li(X,"AID",k.T),li(X,"CI",k.F?"0":"1"),!k.F&&k.ja&&li(X,"TO",k.ja),li(X,"TYPE","xmlhttp"),Zl(k,X),k.m&&k.o&&Dd(X,k.m,k.o),k.L&&(k.g.I=k.L);var te=k.g;k=k.ia,te.L=1,te.v=ys(pa(X)),te.m=null,te.P=!0,ti(te,k)}t.Za=function(){this.C!=null&&(this.C=null,Pr(this),Cc(this),Fe(19))};function Rr(k){k.C!=null&&(s.clearTimeout(k.C),k.C=null)}function Vr(k,X){var te=null;if(k.g==X){Rr(k),Zs(k),k.g=null;var Ee=2}else if(ha(k.h,X))te=X.D,Hl(k.h,X),Ee=1;else return;if(k.G!=0){if(X.o)if(Ee==1){te=X.m?X.m.length:0,X=Date.now()-X.F;var pt=k.B;Ee=xt(),hr(Ee,new Y(Ee,te)),Ou(k)}else Ks(k);else if(pt=X.s,pt==3||pt==0&&0<X.X||!(Ee==1&&zd(k,X)||Ee==2&&Cc(k)))switch(te&&0<te.length&&(X=k.h,X.i=X.i.concat(te)),pt){case 1:Fs(k,5);break;case 4:Fs(k,10);break;case 3:Fs(k,6);break;default:Fs(k,2)}}}function us(k,X){let te=k.Ta+Math.floor(Math.random()*k.cb);return k.isActive()||(te*=2),te*X}function Fs(k,X){if(k.j.info("Error code "+X),X==2){var te=V(k.fb,k),Ee=k.Xa;const pt=!Ee;Ee=new fa(Ee||"//www.google.com/images/cleardot.gif"),s.location&&s.location.protocol=="http"||Ms(Ee,"https"),ys(Ee),pt?gf(Ee.toString(),te):Md(Ee.toString(),te)}else Fe(2);k.G=0,k.l&&k.l.sa(X),kr(k),Ld(k)}t.fb=function(k){k?(this.j.info("Successfully pinged google.com"),Fe(2)):(this.j.info("Failed to ping google.com"),Fe(1))};function kr(k){if(k.G=0,k.ka=[],k.l){const X=pf(k.h);(X.length!=0||k.i.length!=0)&&(Te(k.ka,X),Te(k.ka,k.i),k.h.i.length=0,de(k.i),k.i.length=0),k.l.ra()}}function Mu(k,X,te){var Ee=te instanceof fa?pa(te):new fa(te);if(Ee.g!="")X&&(Ee.g=X+"."+Ee.g),Sc(Ee,Ee.s);else{var pt=s.location;Ee=pt.protocol,X=X?X+"."+pt.hostname:pt.hostname,pt=+pt.port;var Ft=new fa(null);Ee&&Ms(Ft,Ee),X&&(Ft.g=X),pt&&Sc(Ft,pt),te&&(Ft.l=te),Ee=Ft}return te=k.D,X=k.ya,te&&X&&li(Ee,te,X),li(Ee,"VER",k.la),Zl(k,Ee),Ee}function Xa(k,X,te){if(X&&!k.J)throw Error("Can't create secondary domain capable XhrIo object.");return X=k.Ca&&!k.pa?new Ji(new Cu({eb:te})):new Ji(k.pa),X.Ha(k.J),X}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function Ic(){}t=Ic.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function No(){}No.prototype.g=function(k,X){return new fi(k,X)};function fi(k,X){Gn.call(this),this.g=new Ru(X),this.l=k,this.h=X&&X.messageUrlParams||null,k=X&&X.messageHeaders||null,X&&X.clientProtocolHeaderRequired&&(k?k["X-Client-Protocol"]="webchannel":k={"X-Client-Protocol":"webchannel"}),this.g.o=k,k=X&&X.initMessageHeaders||null,X&&X.messageContentType&&(k?k["X-WebChannel-Content-Type"]=X.messageContentType:k={"X-WebChannel-Content-Type":X.messageContentType}),X&&X.va&&(k?k["X-WebChannel-Client-Profile"]=X.va:k={"X-WebChannel-Client-Profile":X.va}),this.g.S=k,(k=X&&X.Sb)&&!Ge(k)&&(this.g.m=k),this.v=X&&X.supportsCrossDomainXhr||!1,this.u=X&&X.sendRawJson||!1,(X=X&&X.httpSessionIdParam)&&!Ge(X)&&(this.g.D=X,k=this.h,k!==null&&X in k&&(k=this.h,X in k&&delete k[X])),this.j=new wl(this)}ue(fi,Gn),fi.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},fi.prototype.close=function(){ku(this.g)},fi.prototype.o=function(k){var X=this.g;if(typeof k=="string"){var te={};te.__data__=k,k=te}else this.u&&(te={},te.__data__=so(k),k=te);X.i.push(new hi(X.Ya++,k)),X.G==3&&Ou(X)},fi.prototype.N=function(){this.g.l=null,delete this.j,ku(this.g),delete this.g,fi.aa.N.call(this)};function zp(k){Os.call(this),k.__headers__&&(this.headers=k.__headers__,this.statusCode=k.__status__,delete k.__headers__,delete k.__status__);var X=k.__sm__;if(X){e:{for(const te in X){k=te;break e}k=void 0}(this.i=k)&&(k=this.i,X=X!==null&&k in X?X[k]:void 0),this.data=X}else this.data=k}ue(zp,Os);function Ac(){Ul.call(this),this.status=1}ue(Ac,Ul);function wl(k){this.g=k}ue(wl,Ic),wl.prototype.ua=function(){hr(this.g,"a")},wl.prototype.ta=function(k){hr(this.g,new zp(k))},wl.prototype.sa=function(k){hr(this.g,new Ac)},wl.prototype.ra=function(){hr(this.g,"b")},No.prototype.createWebChannel=No.prototype.g,fi.prototype.send=fi.prototype.o,fi.prototype.open=fi.prototype.m,fi.prototype.close=fi.prototype.close,Qz=function(){return new No},Jz=function(){return xt()},Yz=da,a2={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},nt.NO_ERROR=0,nt.TIMEOUT=8,nt.HTTP_ERROR=6,Ux=nt,Rt.COMPLETE="complete",Xz=Rt,bc.EventType=ua,ua.OPEN="a",ua.CLOSE="b",ua.ERROR="c",ua.MESSAGE="d",Gn.prototype.listen=Gn.prototype.K,lv=bc,Ji.prototype.listenOnce=Ji.prototype.L,Ji.prototype.getLastError=Ji.prototype.Ka,Ji.prototype.getLastErrorCode=Ji.prototype.Ba,Ji.prototype.getStatus=Ji.prototype.Z,Ji.prototype.getResponseJson=Ji.prototype.Oa,Ji.prototype.getResponseText=Ji.prototype.oa,Ji.prototype.send=Ji.prototype.ea,Ji.prototype.setWithCredentials=Ji.prototype.Ha,Zz=Ji}).apply(typeof cx<"u"?cx:typeof self<"u"?self:typeof window<"u"?window:{});const rD="@firebase/firestore",iD="4.9.1";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ra{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}ra.UNAUTHENTICATED=new ra(null),ra.GOOGLE_CREDENTIALS=new ra("google-credentials-uid"),ra.FIRST_PARTY=new ra("first-party-uid"),ra.MOCK_USER=new ra("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Qg="12.2.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yp=new uT("@firebase/firestore");function ig(){return yp.logLevel}function Qn(t,...e){if(yp.logLevel<=Pi.DEBUG){const n=e.map(dA);yp.debug(`Firestore (${Qg}): ${t}`,...n)}}function wd(t,...e){if(yp.logLevel<=Pi.ERROR){const n=e.map(dA);yp.error(`Firestore (${Qg}): ${t}`,...n)}}function Lg(t,...e){if(yp.logLevel<=Pi.WARN){const n=e.map(dA);yp.warn(`Firestore (${Qg}): ${t}`,...n)}}function dA(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return(function(n){return JSON.stringify(n)})(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ar(t,e,n){let l="Unexpected state";typeof e=="string"?l=e:n=e,eF(t,l,n)}function eF(t,e,n){let l=`FIRESTORE (${Qg}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(n!==void 0)try{l+=" CONTEXT: "+JSON.stringify(n)}catch{l+=" CONTEXT: "+n}throw wd(l),new Error(l)}function ji(t,e,n,l){let d="Unexpected state";typeof n=="string"?d=n:l=n,t||eF(e,d,l)}function Xr(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yt={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class $n extends Vl{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class md{constructor(){this.promise=new Promise(((e,n)=>{this.resolve=e,this.reject=n}))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tF{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class fZ{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable((()=>n(ra.UNAUTHENTICATED)))}shutdown(){}}class pZ{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable((()=>n(this.token.user)))}shutdown(){this.changeListener=null}}class mZ{constructor(e){this.t=e,this.currentUser=ra.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){ji(this.o===void 0,42304);let l=this.i;const d=C=>this.i!==l?(l=this.i,n(C)):Promise.resolve();let f=new md;this.o=()=>{this.i++,this.currentUser=this.u(),f.resolve(),f=new md,e.enqueueRetryable((()=>d(this.currentUser)))};const x=()=>{const C=f;e.enqueueRetryable((async()=>{await C.promise,await d(this.currentUser)}))},s=C=>{Qn("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=C,this.o&&(this.auth.addAuthTokenListener(this.o),x())};this.t.onInit((C=>s(C))),setTimeout((()=>{if(!this.auth){const C=this.t.getImmediate({optional:!0});C?s(C):(Qn("FirebaseAuthCredentialsProvider","Auth not yet detected"),f.resolve(),f=new md)}}),0),x()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then((l=>this.i!==e?(Qn("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):l?(ji(typeof l.accessToken=="string",31837,{l}),new tF(l.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return ji(e===null||typeof e=="string",2055,{h:e}),new ra(e)}}class gZ{constructor(e,n,l){this.P=e,this.T=n,this.I=l,this.type="FirstParty",this.user=ra.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class _Z{constructor(e,n,l){this.P=e,this.T=n,this.I=l}getToken(){return Promise.resolve(new gZ(this.P,this.T,this.I))}start(e,n){e.enqueueRetryable((()=>n(ra.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class oD{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class yZ{constructor(e,n){this.V=n,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Ia(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,n){ji(this.o===void 0,3512);const l=f=>{f.error!=null&&Qn("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${f.error.message}`);const x=f.token!==this.m;return this.m=f.token,Qn("FirebaseAppCheckTokenProvider",`Received ${x?"new":"existing"} token.`),x?n(f.token):Promise.resolve()};this.o=f=>{e.enqueueRetryable((()=>l(f)))};const d=f=>{Qn("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=f,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((f=>d(f))),setTimeout((()=>{if(!this.appCheck){const f=this.V.getImmediate({optional:!0});f?d(f):Qn("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new oD(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((n=>n?(ji(typeof n.token=="string",44558,{tokenResult:n}),this.m=n.token,new oD(n.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vZ(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let l=0;l<t;l++)n[l]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hA{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=62*Math.floor(4.129032258064516);let l="";for(;l.length<20;){const d=vZ(40);for(let f=0;f<d.length;++f)l.length<20&&d[f]<n&&(l+=e.charAt(d[f]%62))}return l}}function Li(t,e){return t<e?-1:t>e?1:0}function l2(t,e){const n=Math.min(t.length,e.length);for(let l=0;l<n;l++){const d=t.charAt(l),f=e.charAt(l);if(d!==f)return pC(d)===pC(f)?Li(d,f):pC(d)?1:-1}return Li(t.length,e.length)}const bZ=55296,xZ=57343;function pC(t){const e=t.charCodeAt(0);return e>=bZ&&e<=xZ}function zg(t,e,n){return t.length===e.length&&t.every(((l,d)=>n(l,e[d])))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sD="__name__";class Qc{constructor(e,n,l){n===void 0?n=0:n>e.length&&Ar(637,{offset:n,range:e.length}),l===void 0?l=e.length-n:l>e.length-n&&Ar(1746,{length:l,range:e.length-n}),this.segments=e,this.offset=n,this.len=l}get length(){return this.len}isEqual(e){return Qc.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof Qc?e.forEach((l=>{n.push(l)})):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,l=this.limit();n<l;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const l=Math.min(e.length,n.length);for(let d=0;d<l;d++){const f=Qc.compareSegments(e.get(d),n.get(d));if(f!==0)return f}return Li(e.length,n.length)}static compareSegments(e,n){const l=Qc.isNumericId(e),d=Qc.isNumericId(n);return l&&!d?-1:!l&&d?1:l&&d?Qc.extractNumericId(e).compare(Qc.extractNumericId(n)):l2(e,n)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Vh.fromString(e.substring(4,e.length-2))}}class bo extends Qc{construct(e,n,l){return new bo(e,n,l)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const l of e){if(l.indexOf("//")>=0)throw new $n(Yt.INVALID_ARGUMENT,`Invalid segment (${l}). Paths must not contain // in them.`);n.push(...l.split("/").filter((d=>d.length>0)))}return new bo(n)}static emptyPath(){return new bo([])}}const wZ=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Us extends Qc{construct(e,n,l){return new Us(e,n,l)}static isValidIdentifier(e){return wZ.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Us.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===sD}static keyField(){return new Us([sD])}static fromServerFormat(e){const n=[];let l="",d=0;const f=()=>{if(l.length===0)throw new $n(Yt.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(l),l=""};let x=!1;for(;d<e.length;){const s=e[d];if(s==="\\"){if(d+1===e.length)throw new $n(Yt.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const C=e[d+1];if(C!=="\\"&&C!=="."&&C!=="`")throw new $n(Yt.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);l+=C,d+=2}else s==="`"?(x=!x,d++):s!=="."||x?(l+=s,d++):(f(),d++)}if(f(),x)throw new $n(Yt.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Us(n)}static emptyPath(){return new Us([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xr{constructor(e){this.path=e}static fromPath(e){return new xr(bo.fromString(e))}static fromName(e){return new xr(bo.fromString(e).popFirst(5))}static empty(){return new xr(bo.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&bo.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return bo.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new xr(new bo(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nF(t,e,n){if(!n)throw new $n(Yt.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function TZ(t,e,n,l){if(e===!0&&l===!0)throw new $n(Yt.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function aD(t){if(!xr.isDocumentKey(t))throw new $n(Yt.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function lD(t){if(xr.isDocumentKey(t))throw new $n(Yt.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function rF(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function mT(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=(function(l){return l.constructor?l.constructor.name:null})(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":Ar(12329,{type:typeof t})}function au(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new $n(Yt.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=mT(t);throw new $n(Yt.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ls(t,e){const n={typeString:t};return e&&(n.value=e),n}function Q0(t,e){if(!rF(t))throw new $n(Yt.INVALID_ARGUMENT,"JSON must be an object");let n;for(const l in e)if(e[l]){const d=e[l].typeString,f="value"in e[l]?{value:e[l].value}:void 0;if(!(l in t)){n=`JSON missing required field: '${l}'`;break}const x=t[l];if(d&&typeof x!==d){n=`JSON field '${l}' must be a ${d}.`;break}if(f!==void 0&&x!==f.value){n=`Expected '${l}' field to equal '${f.value}'`;break}}if(n)throw new $n(Yt.INVALID_ARGUMENT,n);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cD=-62135596800,uD=1e6;class Lo{static now(){return Lo.fromMillis(Date.now())}static fromDate(e){return Lo.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),l=Math.floor((e-1e3*n)*uD);return new Lo(n,l)}constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new $n(Yt.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new $n(Yt.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<cD)throw new $n(Yt.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new $n(Yt.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/uD}_compareTo(e){return this.seconds===e.seconds?Li(this.nanoseconds,e.nanoseconds):Li(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Lo._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Q0(e,Lo._jsonSchema))return new Lo(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-cD;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Lo._jsonSchemaVersion="firestore/timestamp/1.0",Lo._jsonSchema={type:ls("string",Lo._jsonSchemaVersion),seconds:ls("number"),nanoseconds:ls("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ur{static fromTimestamp(e){return new Ur(e)}static min(){return new Ur(new Lo(0,0))}static max(){return new Ur(new Lo(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jv=-1;function SZ(t,e){const n=t.toTimestamp().seconds,l=t.toTimestamp().nanoseconds+1,d=Ur.fromTimestamp(l===1e9?new Lo(n+1,0):new Lo(n,l));return new Kh(d,xr.empty(),e)}function EZ(t){return new Kh(t.readTime,t.key,Jv)}class Kh{constructor(e,n,l){this.readTime=e,this.documentKey=n,this.largestBatchId=l}static min(){return new Kh(Ur.min(),xr.empty(),Jv)}static max(){return new Kh(Ur.max(),xr.empty(),Jv)}}function CZ(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=xr.comparator(t.documentKey,e.documentKey),n!==0?n:Li(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IZ="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class AZ{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function e_(t){if(t.code!==Yt.FAILED_PRECONDITION||t.message!==IZ)throw t;Qn("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nn{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)}),(n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)}))}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&Ar(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new nn(((l,d)=>{this.nextCallback=f=>{this.wrapSuccess(e,f).next(l,d)},this.catchCallback=f=>{this.wrapFailure(n,f).next(l,d)}}))}toPromise(){return new Promise(((e,n)=>{this.next(e,n)}))}wrapUserFunction(e){try{const n=e();return n instanceof nn?n:nn.resolve(n)}catch(n){return nn.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction((()=>e(n))):nn.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction((()=>e(n))):nn.reject(n)}static resolve(e){return new nn(((n,l)=>{n(e)}))}static reject(e){return new nn(((n,l)=>{l(e)}))}static waitFor(e){return new nn(((n,l)=>{let d=0,f=0,x=!1;e.forEach((s=>{++d,s.next((()=>{++f,x&&f===d&&n()}),(C=>l(C)))})),x=!0,f===d&&n()}))}static or(e){let n=nn.resolve(!1);for(const l of e)n=n.next((d=>d?nn.resolve(d):l()));return n}static forEach(e,n){const l=[];return e.forEach(((d,f)=>{l.push(n.call(this,d,f))})),this.waitFor(l)}static mapArray(e,n){return new nn(((l,d)=>{const f=e.length,x=new Array(f);let s=0;for(let C=0;C<f;C++){const P=C;n(e[P]).next((L=>{x[P]=L,++s,s===f&&l(x)}),(L=>d(L)))}}))}static doWhile(e,n){return new nn(((l,d)=>{const f=()=>{e()===!0?n().next((()=>{f()}),d):l()};f()}))}}function PZ(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function t_(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gT{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=l=>this.ae(l),this.ue=l=>n.writeSequenceNumber(l))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}gT.ce=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fA=-1;function eb(t){return t==null}function yw(t){return t===0&&1/t==-1/0}function RZ(t){return typeof t=="number"&&Number.isInteger(t)&&!yw(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iF="";function kZ(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=dD(e)),e=OZ(t.get(n),e);return dD(e)}function OZ(t,e){let n=e;const l=t.length;for(let d=0;d<l;d++){const f=t.charAt(d);switch(f){case"\0":n+="";break;case iF:n+="";break;default:n+=f}}return n}function dD(t){return t+iF+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hD(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function af(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function oF(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qo{constructor(e,n){this.comparator=e,this.root=n||Ns.EMPTY}insert(e,n){return new qo(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Ns.BLACK,null,null))}remove(e){return new qo(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Ns.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const l=this.comparator(e,n.key);if(l===0)return n.value;l<0?n=n.left:l>0&&(n=n.right)}return null}indexOf(e){let n=0,l=this.root;for(;!l.isEmpty();){const d=this.comparator(e,l.key);if(d===0)return n+l.left.size;d<0?l=l.left:(n+=l.left.size+1,l=l.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((n,l)=>(e(n,l),!1)))}toString(){const e=[];return this.inorderTraversal(((n,l)=>(e.push(`${n}:${l}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new ux(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new ux(this.root,e,this.comparator,!1)}getReverseIterator(){return new ux(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new ux(this.root,e,this.comparator,!0)}}class ux{constructor(e,n,l,d){this.isReverse=d,this.nodeStack=[];let f=1;for(;!e.isEmpty();)if(f=n?l(e.key,n):1,n&&d&&(f*=-1),f<0)e=this.isReverse?e.left:e.right;else{if(f===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Ns{constructor(e,n,l,d,f){this.key=e,this.value=n,this.color=l??Ns.RED,this.left=d??Ns.EMPTY,this.right=f??Ns.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,l,d,f){return new Ns(e??this.key,n??this.value,l??this.color,d??this.left,f??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,l){let d=this;const f=l(e,d.key);return d=f<0?d.copy(null,null,null,d.left.insert(e,n,l),null):f===0?d.copy(null,n,null,null,null):d.copy(null,null,null,null,d.right.insert(e,n,l)),d.fixUp()}removeMin(){if(this.left.isEmpty())return Ns.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let l,d=this;if(n(e,d.key)<0)d.left.isEmpty()||d.left.isRed()||d.left.left.isRed()||(d=d.moveRedLeft()),d=d.copy(null,null,null,d.left.remove(e,n),null);else{if(d.left.isRed()&&(d=d.rotateRight()),d.right.isEmpty()||d.right.isRed()||d.right.left.isRed()||(d=d.moveRedRight()),n(e,d.key)===0){if(d.right.isEmpty())return Ns.EMPTY;l=d.right.min(),d=d.copy(l.key,l.value,null,null,d.right.removeMin())}d=d.copy(null,null,null,null,d.right.remove(e,n))}return d.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Ns.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Ns.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Ar(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Ar(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Ar(27949);return e+(this.isRed()?0:1)}}Ns.EMPTY=null,Ns.RED=!0,Ns.BLACK=!1;Ns.EMPTY=new class{constructor(){this.size=0}get key(){throw Ar(57766)}get value(){throw Ar(16141)}get color(){throw Ar(16727)}get left(){throw Ar(29726)}get right(){throw Ar(36894)}copy(e,n,l,d,f){return this}insert(e,n,l){return new Ns(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gs{constructor(e){this.comparator=e,this.data=new qo(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((n,l)=>(e(n),!1)))}forEachInRange(e,n){const l=this.data.getIteratorFrom(e[0]);for(;l.hasNext();){const d=l.getNext();if(this.comparator(d.key,e[1])>=0)return;n(d.key)}}forEachWhile(e,n){let l;for(l=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();l.hasNext();)if(!e(l.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new fD(this.data.getIterator())}getIteratorFrom(e){return new fD(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach((l=>{n=n.add(l)})),n}isEqual(e){if(!(e instanceof gs)||this.size!==e.size)return!1;const n=this.data.getIterator(),l=e.data.getIterator();for(;n.hasNext();){const d=n.getNext().key,f=l.getNext().key;if(this.comparator(d,f)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((n=>{e.push(n)})),e}toString(){const e=[];return this.forEach((n=>e.push(n))),"SortedSet("+e.toString()+")"}copy(e){const n=new gs(this.comparator);return n.data=e,n}}class fD{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cl{constructor(e){this.fields=e,e.sort(Us.comparator)}static empty(){return new cl([])}unionWith(e){let n=new gs(Us.comparator);for(const l of this.fields)n=n.add(l);for(const l of e)n=n.add(l);return new cl(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return zg(this.fields,e.fields,((n,l)=>n.isEqual(l)))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sF extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gs{constructor(e){this.binaryString=e}static fromBase64String(e){const n=(function(d){try{return atob(d)}catch(f){throw typeof DOMException<"u"&&f instanceof DOMException?new sF("Invalid base64 string: "+f):f}})(e);return new Gs(n)}static fromUint8Array(e){const n=(function(d){let f="";for(let x=0;x<d.length;++x)f+=String.fromCharCode(d[x]);return f})(e);return new Gs(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(n){return btoa(n)})(this.binaryString)}toUint8Array(){return(function(n){const l=new Uint8Array(n.length);for(let d=0;d<n.length;d++)l[d]=n.charCodeAt(d);return l})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Li(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Gs.EMPTY_BYTE_STRING=new Gs("");const MZ=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Zh(t){if(ji(!!t,39018),typeof t=="string"){let e=0;const n=MZ.exec(t);if(ji(!!n,46558,{timestamp:t}),n[1]){let d=n[1];d=(d+"000000000").substr(0,9),e=Number(d)}const l=new Date(t);return{seconds:Math.floor(l.getTime()/1e3),nanos:e}}return{seconds:Qo(t.seconds),nanos:Qo(t.nanos)}}function Qo(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Xh(t){return typeof t=="string"?Gs.fromBase64String(t):Gs.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aF="server_timestamp",lF="__type__",cF="__previous_value__",uF="__local_write_time__";function pA(t){return(t?.mapValue?.fields||{})[lF]?.stringValue===aF}function _T(t){const e=t.mapValue.fields[cF];return pA(e)?_T(e):e}function Qv(t){const e=Zh(t.mapValue.fields[uF].timestampValue);return new Lo(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DZ{constructor(e,n,l,d,f,x,s,C,P,L){this.databaseId=e,this.appId=n,this.persistenceKey=l,this.host=d,this.ssl=f,this.forceLongPolling=x,this.autoDetectLongPolling=s,this.longPollingOptions=C,this.useFetchStreams=P,this.isUsingEmulator=L}}const vw="(default)";class e0{constructor(e,n){this.projectId=e,this.database=n||vw}static empty(){return new e0("","")}get isDefaultDatabase(){return this.database===vw}isEqual(e){return e instanceof e0&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dF="__type__",LZ="__max__",dx={mapValue:{}},hF="__vector__",bw="value";function Yh(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?pA(t)?4:FZ(t)?9007199254740991:zZ(t)?10:11:Ar(28295,{value:t})}function gu(t,e){if(t===e)return!0;const n=Yh(t);if(n!==Yh(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Qv(t).isEqual(Qv(e));case 3:return(function(d,f){if(typeof d.timestampValue=="string"&&typeof f.timestampValue=="string"&&d.timestampValue.length===f.timestampValue.length)return d.timestampValue===f.timestampValue;const x=Zh(d.timestampValue),s=Zh(f.timestampValue);return x.seconds===s.seconds&&x.nanos===s.nanos})(t,e);case 5:return t.stringValue===e.stringValue;case 6:return(function(d,f){return Xh(d.bytesValue).isEqual(Xh(f.bytesValue))})(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return(function(d,f){return Qo(d.geoPointValue.latitude)===Qo(f.geoPointValue.latitude)&&Qo(d.geoPointValue.longitude)===Qo(f.geoPointValue.longitude)})(t,e);case 2:return(function(d,f){if("integerValue"in d&&"integerValue"in f)return Qo(d.integerValue)===Qo(f.integerValue);if("doubleValue"in d&&"doubleValue"in f){const x=Qo(d.doubleValue),s=Qo(f.doubleValue);return x===s?yw(x)===yw(s):isNaN(x)&&isNaN(s)}return!1})(t,e);case 9:return zg(t.arrayValue.values||[],e.arrayValue.values||[],gu);case 10:case 11:return(function(d,f){const x=d.mapValue.fields||{},s=f.mapValue.fields||{};if(hD(x)!==hD(s))return!1;for(const C in x)if(x.hasOwnProperty(C)&&(s[C]===void 0||!gu(x[C],s[C])))return!1;return!0})(t,e);default:return Ar(52216,{left:t})}}function t0(t,e){return(t.values||[]).find((n=>gu(n,e)))!==void 0}function Fg(t,e){if(t===e)return 0;const n=Yh(t),l=Yh(e);if(n!==l)return Li(n,l);switch(n){case 0:case 9007199254740991:return 0;case 1:return Li(t.booleanValue,e.booleanValue);case 2:return(function(f,x){const s=Qo(f.integerValue||f.doubleValue),C=Qo(x.integerValue||x.doubleValue);return s<C?-1:s>C?1:s===C?0:isNaN(s)?isNaN(C)?0:-1:1})(t,e);case 3:return pD(t.timestampValue,e.timestampValue);case 4:return pD(Qv(t),Qv(e));case 5:return l2(t.stringValue,e.stringValue);case 6:return(function(f,x){const s=Xh(f),C=Xh(x);return s.compareTo(C)})(t.bytesValue,e.bytesValue);case 7:return(function(f,x){const s=f.split("/"),C=x.split("/");for(let P=0;P<s.length&&P<C.length;P++){const L=Li(s[P],C[P]);if(L!==0)return L}return Li(s.length,C.length)})(t.referenceValue,e.referenceValue);case 8:return(function(f,x){const s=Li(Qo(f.latitude),Qo(x.latitude));return s!==0?s:Li(Qo(f.longitude),Qo(x.longitude))})(t.geoPointValue,e.geoPointValue);case 9:return mD(t.arrayValue,e.arrayValue);case 10:return(function(f,x){const s=f.fields||{},C=x.fields||{},P=s[bw]?.arrayValue,L=C[bw]?.arrayValue,$=Li(P?.values?.length||0,L?.values?.length||0);return $!==0?$:mD(P,L)})(t.mapValue,e.mapValue);case 11:return(function(f,x){if(f===dx.mapValue&&x===dx.mapValue)return 0;if(f===dx.mapValue)return 1;if(x===dx.mapValue)return-1;const s=f.fields||{},C=Object.keys(s),P=x.fields||{},L=Object.keys(P);C.sort(),L.sort();for(let $=0;$<C.length&&$<L.length;++$){const V=l2(C[$],L[$]);if(V!==0)return V;const j=Fg(s[C[$]],P[L[$]]);if(j!==0)return j}return Li(C.length,L.length)})(t.mapValue,e.mapValue);default:throw Ar(23264,{he:n})}}function pD(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return Li(t,e);const n=Zh(t),l=Zh(e),d=Li(n.seconds,l.seconds);return d!==0?d:Li(n.nanos,l.nanos)}function mD(t,e){const n=t.values||[],l=e.values||[];for(let d=0;d<n.length&&d<l.length;++d){const f=Fg(n[d],l[d]);if(f)return f}return Li(n.length,l.length)}function Bg(t){return c2(t)}function c2(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?(function(n){const l=Zh(n);return`time(${l.seconds},${l.nanos})`})(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?(function(n){return Xh(n).toBase64()})(t.bytesValue):"referenceValue"in t?(function(n){return xr.fromName(n).toString()})(t.referenceValue):"geoPointValue"in t?(function(n){return`geo(${n.latitude},${n.longitude})`})(t.geoPointValue):"arrayValue"in t?(function(n){let l="[",d=!0;for(const f of n.values||[])d?d=!1:l+=",",l+=c2(f);return l+"]"})(t.arrayValue):"mapValue"in t?(function(n){const l=Object.keys(n.fields||{}).sort();let d="{",f=!0;for(const x of l)f?f=!1:d+=",",d+=`${x}:${c2(n.fields[x])}`;return d+"}"})(t.mapValue):Ar(61005,{value:t})}function jx(t){switch(Yh(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=_T(t);return e?16+jx(e):16;case 5:return 2*t.stringValue.length;case 6:return Xh(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return(function(l){return(l.values||[]).reduce(((d,f)=>d+jx(f)),0)})(t.arrayValue);case 10:case 11:return(function(l){let d=0;return af(l.fields,((f,x)=>{d+=f.length+jx(x)})),d})(t.mapValue);default:throw Ar(13486,{value:t})}}function gD(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function u2(t){return!!t&&"integerValue"in t}function mA(t){return!!t&&"arrayValue"in t}function _D(t){return!!t&&"nullValue"in t}function yD(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Gx(t){return!!t&&"mapValue"in t}function zZ(t){return(t?.mapValue?.fields||{})[dF]?.stringValue===hF}function Cv(t){if(t.geoPointValue)return{geoPointValue:{...t.geoPointValue}};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:{...t.timestampValue}};if(t.mapValue){const e={mapValue:{fields:{}}};return af(t.mapValue.fields,((n,l)=>e.mapValue.fields[n]=Cv(l))),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=Cv(t.arrayValue.values[n]);return e}return{...t}}function FZ(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===LZ}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Aa{constructor(e){this.value=e}static empty(){return new Aa({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let l=0;l<e.length-1;++l)if(n=(n.mapValue.fields||{})[e.get(l)],!Gx(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=Cv(n)}setAll(e){let n=Us.emptyPath(),l={},d=[];e.forEach(((x,s)=>{if(!n.isImmediateParentOf(s)){const C=this.getFieldsMap(n);this.applyChanges(C,l,d),l={},d=[],n=s.popLast()}x?l[s.lastSegment()]=Cv(x):d.push(s.lastSegment())}));const f=this.getFieldsMap(n);this.applyChanges(f,l,d)}delete(e){const n=this.field(e.popLast());Gx(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return gu(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let l=0;l<e.length;++l){let d=n.mapValue.fields[e.get(l)];Gx(d)&&d.mapValue.fields||(d={mapValue:{fields:{}}},n.mapValue.fields[e.get(l)]=d),n=d}return n.mapValue.fields}applyChanges(e,n,l){af(n,((d,f)=>e[d]=f));for(const d of l)delete e[d]}clone(){return new Aa(Cv(this.value))}}function fF(t){const e=[];return af(t.fields,((n,l)=>{const d=new Us([n]);if(Gx(l)){const f=fF(l.mapValue).fields;if(f.length===0)e.push(d);else for(const x of f)e.push(d.child(x))}else e.push(d)})),new cl(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class As{constructor(e,n,l,d,f,x,s){this.key=e,this.documentType=n,this.version=l,this.readTime=d,this.createTime=f,this.data=x,this.documentState=s}static newInvalidDocument(e){return new As(e,0,Ur.min(),Ur.min(),Ur.min(),Aa.empty(),0)}static newFoundDocument(e,n,l,d){return new As(e,1,n,Ur.min(),l,d,0)}static newNoDocument(e,n){return new As(e,2,n,Ur.min(),Ur.min(),Aa.empty(),0)}static newUnknownDocument(e,n){return new As(e,3,n,Ur.min(),Ur.min(),Aa.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(Ur.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Aa.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Aa.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Ur.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof As&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new As(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xw{constructor(e,n){this.position=e,this.inclusive=n}}function vD(t,e,n){let l=0;for(let d=0;d<t.position.length;d++){const f=e[d],x=t.position[d];if(f.field.isKeyField()?l=xr.comparator(xr.fromName(x.referenceValue),n.key):l=Fg(x,n.data.field(f.field)),f.dir==="desc"&&(l*=-1),l!==0)break}return l}function bD(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!gu(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ww{constructor(e,n="asc"){this.field=e,this.dir=n}}function BZ(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pF{}class as extends pF{constructor(e,n,l){super(),this.field=e,this.op=n,this.value=l}static create(e,n,l){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,l):new VZ(e,n,l):n==="array-contains"?new jZ(e,l):n==="in"?new GZ(e,l):n==="not-in"?new HZ(e,l):n==="array-contains-any"?new WZ(e,l):new as(e,n,l)}static createKeyFieldInFilter(e,n,l){return n==="in"?new $Z(e,l):new UZ(e,l)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&n.nullValue===void 0&&this.matchesComparison(Fg(n,this.value)):n!==null&&Yh(this.value)===Yh(n)&&this.matchesComparison(Fg(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Ar(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class yc extends pF{constructor(e,n){super(),this.filters=e,this.op=n,this.Pe=null}static create(e,n){return new yc(e,n)}matches(e){return mF(this)?this.filters.find((n=>!n.matches(e)))===void 0:this.filters.find((n=>n.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,n)=>e.concat(n.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function mF(t){return t.op==="and"}function gF(t){return NZ(t)&&mF(t)}function NZ(t){for(const e of t.filters)if(e instanceof yc)return!1;return!0}function d2(t){if(t instanceof as)return t.field.canonicalString()+t.op.toString()+Bg(t.value);if(gF(t))return t.filters.map((e=>d2(e))).join(",");{const e=t.filters.map((n=>d2(n))).join(",");return`${t.op}(${e})`}}function _F(t,e){return t instanceof as?(function(l,d){return d instanceof as&&l.op===d.op&&l.field.isEqual(d.field)&&gu(l.value,d.value)})(t,e):t instanceof yc?(function(l,d){return d instanceof yc&&l.op===d.op&&l.filters.length===d.filters.length?l.filters.reduce(((f,x,s)=>f&&_F(x,d.filters[s])),!0):!1})(t,e):void Ar(19439)}function yF(t){return t instanceof as?(function(n){return`${n.field.canonicalString()} ${n.op} ${Bg(n.value)}`})(t):t instanceof yc?(function(n){return n.op.toString()+" {"+n.getFilters().map(yF).join(" ,")+"}"})(t):"Filter"}class VZ extends as{constructor(e,n,l){super(e,n,l),this.key=xr.fromName(l.referenceValue)}matches(e){const n=xr.comparator(e.key,this.key);return this.matchesComparison(n)}}class $Z extends as{constructor(e,n){super(e,"in",n),this.keys=vF("in",n)}matches(e){return this.keys.some((n=>n.isEqual(e.key)))}}class UZ extends as{constructor(e,n){super(e,"not-in",n),this.keys=vF("not-in",n)}matches(e){return!this.keys.some((n=>n.isEqual(e.key)))}}function vF(t,e){return(e.arrayValue?.values||[]).map((n=>xr.fromName(n.referenceValue)))}class jZ extends as{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return mA(n)&&t0(n.arrayValue,this.value)}}class GZ extends as{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&t0(this.value.arrayValue,n)}}class HZ extends as{constructor(e,n){super(e,"not-in",n)}matches(e){if(t0(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&n.nullValue===void 0&&!t0(this.value.arrayValue,n)}}class WZ extends as{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!mA(n)||!n.arrayValue.values)&&n.arrayValue.values.some((l=>t0(this.value.arrayValue,l)))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qZ{constructor(e,n=null,l=[],d=[],f=null,x=null,s=null){this.path=e,this.collectionGroup=n,this.orderBy=l,this.filters=d,this.limit=f,this.startAt=x,this.endAt=s,this.Te=null}}function xD(t,e=null,n=[],l=[],d=null,f=null,x=null){return new qZ(t,e,n,l,d,f,x)}function gA(t){const e=Xr(t);if(e.Te===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map((l=>d2(l))).join(","),n+="|ob:",n+=e.orderBy.map((l=>(function(f){return f.field.canonicalString()+f.dir})(l))).join(","),eb(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map((l=>Bg(l))).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map((l=>Bg(l))).join(",")),e.Te=n}return e.Te}function _A(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!BZ(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!_F(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!bD(t.startAt,e.startAt)&&bD(t.endAt,e.endAt)}function h2(t){return xr.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tb{constructor(e,n=null,l=[],d=[],f=null,x="F",s=null,C=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=l,this.filters=d,this.limit=f,this.limitType=x,this.startAt=s,this.endAt=C,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function KZ(t,e,n,l,d,f,x,s){return new tb(t,e,n,l,d,f,x,s)}function yA(t){return new tb(t)}function wD(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function bF(t){return t.collectionGroup!==null}function Iv(t){const e=Xr(t);if(e.Ie===null){e.Ie=[];const n=new Set;for(const f of e.explicitOrderBy)e.Ie.push(f),n.add(f.field.canonicalString());const l=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(x){let s=new gs(Us.comparator);return x.filters.forEach((C=>{C.getFlattenedFilters().forEach((P=>{P.isInequality()&&(s=s.add(P.field))}))})),s})(e).forEach((f=>{n.has(f.canonicalString())||f.isKeyField()||e.Ie.push(new ww(f,l))})),n.has(Us.keyField().canonicalString())||e.Ie.push(new ww(Us.keyField(),l))}return e.Ie}function lu(t){const e=Xr(t);return e.Ee||(e.Ee=ZZ(e,Iv(t))),e.Ee}function ZZ(t,e){if(t.limitType==="F")return xD(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map((d=>{const f=d.dir==="desc"?"asc":"desc";return new ww(d.field,f)}));const n=t.endAt?new xw(t.endAt.position,t.endAt.inclusive):null,l=t.startAt?new xw(t.startAt.position,t.startAt.inclusive):null;return xD(t.path,t.collectionGroup,e,t.filters,t.limit,n,l)}}function f2(t,e){const n=t.filters.concat([e]);return new tb(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function p2(t,e,n){return new tb(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function yT(t,e){return _A(lu(t),lu(e))&&t.limitType===e.limitType}function xF(t){return`${gA(lu(t))}|lt:${t.limitType}`}function og(t){return`Query(target=${(function(n){let l=n.path.canonicalString();return n.collectionGroup!==null&&(l+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(l+=`, filters: [${n.filters.map((d=>yF(d))).join(", ")}]`),eb(n.limit)||(l+=", limit: "+n.limit),n.orderBy.length>0&&(l+=`, orderBy: [${n.orderBy.map((d=>(function(x){return`${x.field.canonicalString()} (${x.dir})`})(d))).join(", ")}]`),n.startAt&&(l+=", startAt: ",l+=n.startAt.inclusive?"b:":"a:",l+=n.startAt.position.map((d=>Bg(d))).join(",")),n.endAt&&(l+=", endAt: ",l+=n.endAt.inclusive?"a:":"b:",l+=n.endAt.position.map((d=>Bg(d))).join(",")),`Target(${l})`})(lu(t))}; limitType=${t.limitType})`}function vT(t,e){return e.isFoundDocument()&&(function(l,d){const f=d.key.path;return l.collectionGroup!==null?d.key.hasCollectionId(l.collectionGroup)&&l.path.isPrefixOf(f):xr.isDocumentKey(l.path)?l.path.isEqual(f):l.path.isImmediateParentOf(f)})(t,e)&&(function(l,d){for(const f of Iv(l))if(!f.field.isKeyField()&&d.data.field(f.field)===null)return!1;return!0})(t,e)&&(function(l,d){for(const f of l.filters)if(!f.matches(d))return!1;return!0})(t,e)&&(function(l,d){return!(l.startAt&&!(function(x,s,C){const P=vD(x,s,C);return x.inclusive?P<=0:P<0})(l.startAt,Iv(l),d)||l.endAt&&!(function(x,s,C){const P=vD(x,s,C);return x.inclusive?P>=0:P>0})(l.endAt,Iv(l),d))})(t,e)}function XZ(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function wF(t){return(e,n)=>{let l=!1;for(const d of Iv(t)){const f=YZ(d,e,n);if(f!==0)return f;l=l||d.field.isKeyField()}return 0}}function YZ(t,e,n){const l=t.field.isKeyField()?xr.comparator(e.key,n.key):(function(f,x,s){const C=x.data.field(f),P=s.data.field(f);return C!==null&&P!==null?Fg(C,P):Ar(42886)})(t.field,e,n);switch(t.dir){case"asc":return l;case"desc":return-1*l;default:return Ar(19790,{direction:t.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cp{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),l=this.inner[n];if(l!==void 0){for(const[d,f]of l)if(this.equalsFn(d,e))return f}}has(e){return this.get(e)!==void 0}set(e,n){const l=this.mapKeyFn(e),d=this.inner[l];if(d===void 0)return this.inner[l]=[[e,n]],void this.innerSize++;for(let f=0;f<d.length;f++)if(this.equalsFn(d[f][0],e))return void(d[f]=[e,n]);d.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),l=this.inner[n];if(l===void 0)return!1;for(let d=0;d<l.length;d++)if(this.equalsFn(l[d][0],e))return l.length===1?delete this.inner[n]:l.splice(d,1),this.innerSize--,!0;return!1}forEach(e){af(this.inner,((n,l)=>{for(const[d,f]of l)e(d,f)}))}isEmpty(){return oF(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JZ=new qo(xr.comparator);function Td(){return JZ}const TF=new qo(xr.comparator);function cv(...t){let e=TF;for(const n of t)e=e.insert(n.key,n);return e}function SF(t){let e=TF;return t.forEach(((n,l)=>e=e.insert(n,l.overlayedDocument))),e}function ap(){return Av()}function EF(){return Av()}function Av(){return new Cp((t=>t.toString()),((t,e)=>t.isEqual(e)))}const QZ=new qo(xr.comparator),eX=new gs(xr.comparator);function zi(...t){let e=eX;for(const n of t)e=e.add(n);return e}const tX=new gs(Li);function nX(){return tX}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vA(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:yw(e)?"-0":e}}function CF(t){return{integerValue:""+t}}function IF(t,e){return RZ(e)?CF(e):vA(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bT{constructor(){this._=void 0}}function rX(t,e,n){return t instanceof n0?(function(d,f){const x={fields:{[lF]:{stringValue:aF},[uF]:{timestampValue:{seconds:d.seconds,nanos:d.nanoseconds}}}};return f&&pA(f)&&(f=_T(f)),f&&(x.fields[cF]=f),{mapValue:x}})(n,e):t instanceof Ng?PF(t,e):t instanceof r0?RF(t,e):(function(d,f){const x=AF(d,f),s=TD(x)+TD(d.Ae);return u2(x)&&u2(d.Ae)?CF(s):vA(d.serializer,s)})(t,e)}function iX(t,e,n){return t instanceof Ng?PF(t,e):t instanceof r0?RF(t,e):n}function AF(t,e){return t instanceof i0?(function(l){return u2(l)||(function(f){return!!f&&"doubleValue"in f})(l)})(e)?e:{integerValue:0}:null}class n0 extends bT{}class Ng extends bT{constructor(e){super(),this.elements=e}}function PF(t,e){const n=kF(e);for(const l of t.elements)n.some((d=>gu(d,l)))||n.push(l);return{arrayValue:{values:n}}}class r0 extends bT{constructor(e){super(),this.elements=e}}function RF(t,e){let n=kF(e);for(const l of t.elements)n=n.filter((d=>!gu(d,l)));return{arrayValue:{values:n}}}class i0 extends bT{constructor(e,n){super(),this.serializer=e,this.Ae=n}}function TD(t){return Qo(t.integerValue||t.doubleValue)}function kF(t){return mA(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bA{constructor(e,n){this.field=e,this.transform=n}}function oX(t,e){return t.field.isEqual(e.field)&&(function(l,d){return l instanceof Ng&&d instanceof Ng||l instanceof r0&&d instanceof r0?zg(l.elements,d.elements,gu):l instanceof i0&&d instanceof i0?gu(l.Ae,d.Ae):l instanceof n0&&d instanceof n0})(t.transform,e.transform)}class sX{constructor(e,n){this.version=e,this.transformResults=n}}class Pa{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new Pa}static exists(e){return new Pa(void 0,e)}static updateTime(e){return new Pa(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Hx(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class xT{}function OF(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new xA(t.key,Pa.none()):new nb(t.key,t.data,Pa.none());{const n=t.data,l=Aa.empty();let d=new gs(Us.comparator);for(let f of e.fields)if(!d.has(f)){let x=n.field(f);x===null&&f.length>1&&(f=f.popLast(),x=n.field(f)),x===null?l.delete(f):l.set(f,x),d=d.add(f)}return new lf(t.key,l,new cl(d.toArray()),Pa.none())}}function aX(t,e,n){t instanceof nb?(function(d,f,x){const s=d.value.clone(),C=ED(d.fieldTransforms,f,x.transformResults);s.setAll(C),f.convertToFoundDocument(x.version,s).setHasCommittedMutations()})(t,e,n):t instanceof lf?(function(d,f,x){if(!Hx(d.precondition,f))return void f.convertToUnknownDocument(x.version);const s=ED(d.fieldTransforms,f,x.transformResults),C=f.data;C.setAll(MF(d)),C.setAll(s),f.convertToFoundDocument(x.version,C).setHasCommittedMutations()})(t,e,n):(function(d,f,x){f.convertToNoDocument(x.version).setHasCommittedMutations()})(0,e,n)}function Pv(t,e,n,l){return t instanceof nb?(function(f,x,s,C){if(!Hx(f.precondition,x))return s;const P=f.value.clone(),L=CD(f.fieldTransforms,C,x);return P.setAll(L),x.convertToFoundDocument(x.version,P).setHasLocalMutations(),null})(t,e,n,l):t instanceof lf?(function(f,x,s,C){if(!Hx(f.precondition,x))return s;const P=CD(f.fieldTransforms,C,x),L=x.data;return L.setAll(MF(f)),L.setAll(P),x.convertToFoundDocument(x.version,L).setHasLocalMutations(),s===null?null:s.unionWith(f.fieldMask.fields).unionWith(f.fieldTransforms.map(($=>$.field)))})(t,e,n,l):(function(f,x,s){return Hx(f.precondition,x)?(x.convertToNoDocument(x.version).setHasLocalMutations(),null):s})(t,e,n)}function lX(t,e){let n=null;for(const l of t.fieldTransforms){const d=e.data.field(l.field),f=AF(l.transform,d||null);f!=null&&(n===null&&(n=Aa.empty()),n.set(l.field,f))}return n||null}function SD(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!(function(l,d){return l===void 0&&d===void 0||!(!l||!d)&&zg(l,d,((f,x)=>oX(f,x)))})(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class nb extends xT{constructor(e,n,l,d=[]){super(),this.key=e,this.value=n,this.precondition=l,this.fieldTransforms=d,this.type=0}getFieldMask(){return null}}class lf extends xT{constructor(e,n,l,d,f=[]){super(),this.key=e,this.data=n,this.fieldMask=l,this.precondition=d,this.fieldTransforms=f,this.type=1}getFieldMask(){return this.fieldMask}}function MF(t){const e=new Map;return t.fieldMask.fields.forEach((n=>{if(!n.isEmpty()){const l=t.data.field(n);e.set(n,l)}})),e}function ED(t,e,n){const l=new Map;ji(t.length===n.length,32656,{Re:n.length,Ve:t.length});for(let d=0;d<n.length;d++){const f=t[d],x=f.transform,s=e.data.field(f.field);l.set(f.field,iX(x,s,n[d]))}return l}function CD(t,e,n){const l=new Map;for(const d of t){const f=d.transform,x=n.data.field(d.field);l.set(d.field,rX(f,x,e))}return l}class xA extends xT{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class DF extends xT{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cX{constructor(e,n,l,d){this.batchId=e,this.localWriteTime=n,this.baseMutations=l,this.mutations=d}applyToRemoteDocument(e,n){const l=n.mutationResults;for(let d=0;d<this.mutations.length;d++){const f=this.mutations[d];f.key.isEqual(e.key)&&aX(f,e,l[d])}}applyToLocalView(e,n){for(const l of this.baseMutations)l.key.isEqual(e.key)&&(n=Pv(l,e,n,this.localWriteTime));for(const l of this.mutations)l.key.isEqual(e.key)&&(n=Pv(l,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const l=EF();return this.mutations.forEach((d=>{const f=e.get(d.key),x=f.overlayedDocument;let s=this.applyToLocalView(x,f.mutatedFields);s=n.has(d.key)?null:s;const C=OF(x,s);C!==null&&l.set(d.key,C),x.isValidDocument()||x.convertToNoDocument(Ur.min())})),l}keys(){return this.mutations.reduce(((e,n)=>e.add(n.key)),zi())}isEqual(e){return this.batchId===e.batchId&&zg(this.mutations,e.mutations,((n,l)=>SD(n,l)))&&zg(this.baseMutations,e.baseMutations,((n,l)=>SD(n,l)))}}class wA{constructor(e,n,l,d){this.batch=e,this.commitVersion=n,this.mutationResults=l,this.docVersions=d}static from(e,n,l){ji(e.mutations.length===l.length,58842,{me:e.mutations.length,fe:l.length});let d=(function(){return QZ})();const f=e.mutations;for(let x=0;x<f.length;x++)d=d.insert(f[x].key,l[x].version);return new wA(e,n,l,d)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uX{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dX{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ss,Ui;function LF(t){switch(t){case Yt.OK:return Ar(64938);case Yt.CANCELLED:case Yt.UNKNOWN:case Yt.DEADLINE_EXCEEDED:case Yt.RESOURCE_EXHAUSTED:case Yt.INTERNAL:case Yt.UNAVAILABLE:case Yt.UNAUTHENTICATED:return!1;case Yt.INVALID_ARGUMENT:case Yt.NOT_FOUND:case Yt.ALREADY_EXISTS:case Yt.PERMISSION_DENIED:case Yt.FAILED_PRECONDITION:case Yt.ABORTED:case Yt.OUT_OF_RANGE:case Yt.UNIMPLEMENTED:case Yt.DATA_LOSS:return!0;default:return Ar(15467,{code:t})}}function zF(t){if(t===void 0)return wd("GRPC error has no .code"),Yt.UNKNOWN;switch(t){case ss.OK:return Yt.OK;case ss.CANCELLED:return Yt.CANCELLED;case ss.UNKNOWN:return Yt.UNKNOWN;case ss.DEADLINE_EXCEEDED:return Yt.DEADLINE_EXCEEDED;case ss.RESOURCE_EXHAUSTED:return Yt.RESOURCE_EXHAUSTED;case ss.INTERNAL:return Yt.INTERNAL;case ss.UNAVAILABLE:return Yt.UNAVAILABLE;case ss.UNAUTHENTICATED:return Yt.UNAUTHENTICATED;case ss.INVALID_ARGUMENT:return Yt.INVALID_ARGUMENT;case ss.NOT_FOUND:return Yt.NOT_FOUND;case ss.ALREADY_EXISTS:return Yt.ALREADY_EXISTS;case ss.PERMISSION_DENIED:return Yt.PERMISSION_DENIED;case ss.FAILED_PRECONDITION:return Yt.FAILED_PRECONDITION;case ss.ABORTED:return Yt.ABORTED;case ss.OUT_OF_RANGE:return Yt.OUT_OF_RANGE;case ss.UNIMPLEMENTED:return Yt.UNIMPLEMENTED;case ss.DATA_LOSS:return Yt.DATA_LOSS;default:return Ar(39323,{code:t})}}(Ui=ss||(ss={}))[Ui.OK=0]="OK",Ui[Ui.CANCELLED=1]="CANCELLED",Ui[Ui.UNKNOWN=2]="UNKNOWN",Ui[Ui.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ui[Ui.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ui[Ui.NOT_FOUND=5]="NOT_FOUND",Ui[Ui.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ui[Ui.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ui[Ui.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ui[Ui.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ui[Ui.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ui[Ui.ABORTED=10]="ABORTED",Ui[Ui.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ui[Ui.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ui[Ui.INTERNAL=13]="INTERNAL",Ui[Ui.UNAVAILABLE=14]="UNAVAILABLE",Ui[Ui.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hX(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fX=new Vh([4294967295,4294967295],0);function ID(t){const e=hX().encode(t),n=new Kz;return n.update(e),new Uint8Array(n.digest())}function AD(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),l=e.getUint32(4,!0),d=e.getUint32(8,!0),f=e.getUint32(12,!0);return[new Vh([n,l],0),new Vh([d,f],0)]}class TA{constructor(e,n,l){if(this.bitmap=e,this.padding=n,this.hashCount=l,n<0||n>=8)throw new uv(`Invalid padding: ${n}`);if(l<0)throw new uv(`Invalid hash count: ${l}`);if(e.length>0&&this.hashCount===0)throw new uv(`Invalid hash count: ${l}`);if(e.length===0&&n!==0)throw new uv(`Invalid padding when bitmap length is 0: ${n}`);this.ge=8*e.length-n,this.pe=Vh.fromNumber(this.ge)}ye(e,n,l){let d=e.add(n.multiply(Vh.fromNumber(l)));return d.compare(fX)===1&&(d=new Vh([d.getBits(0),d.getBits(1)],0)),d.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;const n=ID(e),[l,d]=AD(n);for(let f=0;f<this.hashCount;f++){const x=this.ye(l,d,f);if(!this.we(x))return!1}return!0}static create(e,n,l){const d=e%8==0?0:8-e%8,f=new Uint8Array(Math.ceil(e/8)),x=new TA(f,d,n);return l.forEach((s=>x.insert(s))),x}insert(e){if(this.ge===0)return;const n=ID(e),[l,d]=AD(n);for(let f=0;f<this.hashCount;f++){const x=this.ye(l,d,f);this.Se(x)}}Se(e){const n=Math.floor(e/8),l=e%8;this.bitmap[n]|=1<<l}}class uv extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wT{constructor(e,n,l,d,f){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=l,this.documentUpdates=d,this.resolvedLimboDocuments=f}static createSynthesizedRemoteEventForCurrentChange(e,n,l){const d=new Map;return d.set(e,rb.createSynthesizedTargetChangeForCurrentChange(e,n,l)),new wT(Ur.min(),d,new qo(Li),Td(),zi())}}class rb{constructor(e,n,l,d,f){this.resumeToken=e,this.current=n,this.addedDocuments=l,this.modifiedDocuments=d,this.removedDocuments=f}static createSynthesizedTargetChangeForCurrentChange(e,n,l){return new rb(l,n,zi(),zi(),zi())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wx{constructor(e,n,l,d){this.be=e,this.removedTargetIds=n,this.key=l,this.De=d}}class FF{constructor(e,n){this.targetId=e,this.Ce=n}}class BF{constructor(e,n,l=Gs.EMPTY_BYTE_STRING,d=null){this.state=e,this.targetIds=n,this.resumeToken=l,this.cause=d}}class PD{constructor(){this.ve=0,this.Fe=RD(),this.Me=Gs.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=zi(),n=zi(),l=zi();return this.Fe.forEach(((d,f)=>{switch(f){case 0:e=e.add(d);break;case 2:n=n.add(d);break;case 1:l=l.add(d);break;default:Ar(38017,{changeType:f})}})),new rb(this.Me,this.xe,e,n,l)}qe(){this.Oe=!1,this.Fe=RD()}Qe(e,n){this.Oe=!0,this.Fe=this.Fe.insert(e,n)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,ji(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class pX{constructor(e){this.Ge=e,this.ze=new Map,this.je=Td(),this.Je=hx(),this.He=hx(),this.Ye=new qo(Li)}Ze(e){for(const n of e.be)e.De&&e.De.isFoundDocument()?this.Xe(n,e.De):this.et(n,e.key,e.De);for(const n of e.removedTargetIds)this.et(n,e.key,e.De)}tt(e){this.forEachTarget(e,(n=>{const l=this.nt(n);switch(e.state){case 0:this.rt(n)&&l.Le(e.resumeToken);break;case 1:l.Ke(),l.Ne||l.qe(),l.Le(e.resumeToken);break;case 2:l.Ke(),l.Ne||this.removeTarget(n);break;case 3:this.rt(n)&&(l.We(),l.Le(e.resumeToken));break;case 4:this.rt(n)&&(this.it(n),l.Le(e.resumeToken));break;default:Ar(56790,{state:e.state})}}))}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.ze.forEach(((l,d)=>{this.rt(d)&&n(d)}))}st(e){const n=e.targetId,l=e.Ce.count,d=this.ot(n);if(d){const f=d.target;if(h2(f))if(l===0){const x=new xr(f.path);this.et(n,x,As.newNoDocument(x,Ur.min()))}else ji(l===1,20013,{expectedCount:l});else{const x=this._t(n);if(x!==l){const s=this.ut(e),C=s?this.ct(s,e,x):1;if(C!==0){this.it(n);const P=C===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(n,P)}}}}}ut(e){const n=e.Ce.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:l="",padding:d=0},hashCount:f=0}=n;let x,s;try{x=Xh(l).toUint8Array()}catch(C){if(C instanceof sF)return Lg("Decoding the base64 bloom filter in existence filter failed ("+C.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw C}try{s=new TA(x,d,f)}catch(C){return Lg(C instanceof uv?"BloomFilter error: ":"Applying bloom filter failed: ",C),null}return s.ge===0?null:s}ct(e,n,l){return n.Ce.count===l-this.Pt(e,n.targetId)?0:2}Pt(e,n){const l=this.Ge.getRemoteKeysForTarget(n);let d=0;return l.forEach((f=>{const x=this.Ge.ht(),s=`projects/${x.projectId}/databases/${x.database}/documents/${f.path.canonicalString()}`;e.mightContain(s)||(this.et(n,f,null),d++)})),d}Tt(e){const n=new Map;this.ze.forEach(((f,x)=>{const s=this.ot(x);if(s){if(f.current&&h2(s.target)){const C=new xr(s.target.path);this.It(C).has(x)||this.Et(x,C)||this.et(x,C,As.newNoDocument(C,e))}f.Be&&(n.set(x,f.ke()),f.qe())}}));let l=zi();this.He.forEach(((f,x)=>{let s=!0;x.forEachWhile((C=>{const P=this.ot(C);return!P||P.purpose==="TargetPurposeLimboResolution"||(s=!1,!1)})),s&&(l=l.add(f))})),this.je.forEach(((f,x)=>x.setReadTime(e)));const d=new wT(e,n,this.Ye,this.je,l);return this.je=Td(),this.Je=hx(),this.He=hx(),this.Ye=new qo(Li),d}Xe(e,n){if(!this.rt(e))return;const l=this.Et(e,n.key)?2:0;this.nt(e).Qe(n.key,l),this.je=this.je.insert(n.key,n),this.Je=this.Je.insert(n.key,this.It(n.key).add(e)),this.He=this.He.insert(n.key,this.dt(n.key).add(e))}et(e,n,l){if(!this.rt(e))return;const d=this.nt(e);this.Et(e,n)?d.Qe(n,1):d.$e(n),this.He=this.He.insert(n,this.dt(n).delete(e)),this.He=this.He.insert(n,this.dt(n).add(e)),l&&(this.je=this.je.insert(n,l))}removeTarget(e){this.ze.delete(e)}_t(e){const n=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let n=this.ze.get(e);return n||(n=new PD,this.ze.set(e,n)),n}dt(e){let n=this.He.get(e);return n||(n=new gs(Li),this.He=this.He.insert(e,n)),n}It(e){let n=this.Je.get(e);return n||(n=new gs(Li),this.Je=this.Je.insert(e,n)),n}rt(e){const n=this.ot(e)!==null;return n||Qn("WatchChangeAggregator","Detected inactive target",e),n}ot(e){const n=this.ze.get(e);return n&&n.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new PD),this.Ge.getRemoteKeysForTarget(e).forEach((n=>{this.et(e,n,null)}))}Et(e,n){return this.Ge.getRemoteKeysForTarget(e).has(n)}}function hx(){return new qo(xr.comparator)}function RD(){return new qo(xr.comparator)}const mX={asc:"ASCENDING",desc:"DESCENDING"},gX={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},_X={and:"AND",or:"OR"};class yX{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function m2(t,e){return t.useProto3Json||eb(e)?e:{value:e}}function Tw(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function NF(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function vX(t,e){return Tw(t,e.toTimestamp())}function hl(t){return ji(!!t,49232),Ur.fromTimestamp((function(n){const l=Zh(n);return new Lo(l.seconds,l.nanos)})(t))}function SA(t,e){return g2(t,e).canonicalString()}function g2(t,e){const n=(function(d){return new bo(["projects",d.projectId,"databases",d.database])})(t).child("documents");return e===void 0?n:n.child(e)}function VF(t){const e=bo.fromString(t);return ji(WF(e),10190,{key:e.toString()}),e}function Sw(t,e){return SA(t.databaseId,e.path)}function Rv(t,e){const n=VF(e);if(n.get(1)!==t.databaseId.projectId)throw new $n(Yt.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new $n(Yt.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new xr(UF(n))}function $F(t,e){return SA(t.databaseId,e)}function bX(t){const e=VF(t);return e.length===4?bo.emptyPath():UF(e)}function _2(t){return new bo(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function UF(t){return ji(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function kD(t,e,n){return{name:Sw(t,e),fields:n.value.mapValue.fields}}function xX(t,e){return"found"in e?(function(l,d){ji(!!d.found,43571),d.found.name,d.found.updateTime;const f=Rv(l,d.found.name),x=hl(d.found.updateTime),s=d.found.createTime?hl(d.found.createTime):Ur.min(),C=new Aa({mapValue:{fields:d.found.fields}});return As.newFoundDocument(f,x,s,C)})(t,e):"missing"in e?(function(l,d){ji(!!d.missing,3894),ji(!!d.readTime,22933);const f=Rv(l,d.missing),x=hl(d.readTime);return As.newNoDocument(f,x)})(t,e):Ar(7234,{result:e})}function wX(t,e){let n;if("targetChange"in e){e.targetChange;const l=(function(P){return P==="NO_CHANGE"?0:P==="ADD"?1:P==="REMOVE"?2:P==="CURRENT"?3:P==="RESET"?4:Ar(39313,{state:P})})(e.targetChange.targetChangeType||"NO_CHANGE"),d=e.targetChange.targetIds||[],f=(function(P,L){return P.useProto3Json?(ji(L===void 0||typeof L=="string",58123),Gs.fromBase64String(L||"")):(ji(L===void 0||L instanceof Buffer||L instanceof Uint8Array,16193),Gs.fromUint8Array(L||new Uint8Array))})(t,e.targetChange.resumeToken),x=e.targetChange.cause,s=x&&(function(P){const L=P.code===void 0?Yt.UNKNOWN:zF(P.code);return new $n(L,P.message||"")})(x);n=new BF(l,d,f,s||null)}else if("documentChange"in e){e.documentChange;const l=e.documentChange;l.document,l.document.name,l.document.updateTime;const d=Rv(t,l.document.name),f=hl(l.document.updateTime),x=l.document.createTime?hl(l.document.createTime):Ur.min(),s=new Aa({mapValue:{fields:l.document.fields}}),C=As.newFoundDocument(d,f,x,s),P=l.targetIds||[],L=l.removedTargetIds||[];n=new Wx(P,L,C.key,C)}else if("documentDelete"in e){e.documentDelete;const l=e.documentDelete;l.document;const d=Rv(t,l.document),f=l.readTime?hl(l.readTime):Ur.min(),x=As.newNoDocument(d,f),s=l.removedTargetIds||[];n=new Wx([],s,x.key,x)}else if("documentRemove"in e){e.documentRemove;const l=e.documentRemove;l.document;const d=Rv(t,l.document),f=l.removedTargetIds||[];n=new Wx([],f,d,null)}else{if(!("filter"in e))return Ar(11601,{Rt:e});{e.filter;const l=e.filter;l.targetId;const{count:d=0,unchangedNames:f}=l,x=new dX(d,f),s=l.targetId;n=new FF(s,x)}}return n}function jF(t,e){let n;if(e instanceof nb)n={update:kD(t,e.key,e.value)};else if(e instanceof xA)n={delete:Sw(t,e.key)};else if(e instanceof lf)n={update:kD(t,e.key,e.data),updateMask:kX(e.fieldMask)};else{if(!(e instanceof DF))return Ar(16599,{Vt:e.type});n={verify:Sw(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map((l=>(function(f,x){const s=x.transform;if(s instanceof n0)return{fieldPath:x.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(s instanceof Ng)return{fieldPath:x.field.canonicalString(),appendMissingElements:{values:s.elements}};if(s instanceof r0)return{fieldPath:x.field.canonicalString(),removeAllFromArray:{values:s.elements}};if(s instanceof i0)return{fieldPath:x.field.canonicalString(),increment:s.Ae};throw Ar(20930,{transform:x.transform})})(0,l)))),e.precondition.isNone||(n.currentDocument=(function(d,f){return f.updateTime!==void 0?{updateTime:vX(d,f.updateTime)}:f.exists!==void 0?{exists:f.exists}:Ar(27497)})(t,e.precondition)),n}function TX(t,e){return t&&t.length>0?(ji(e!==void 0,14353),t.map((n=>(function(d,f){let x=d.updateTime?hl(d.updateTime):hl(f);return x.isEqual(Ur.min())&&(x=hl(f)),new sX(x,d.transformResults||[])})(n,e)))):[]}function SX(t,e){return{documents:[$F(t,e.path)]}}function EX(t,e){const n={structuredQuery:{}},l=e.path;let d;e.collectionGroup!==null?(d=l,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(d=l.popLast(),n.structuredQuery.from=[{collectionId:l.lastSegment()}]),n.parent=$F(t,d);const f=(function(P){if(P.length!==0)return HF(yc.create(P,"and"))})(e.filters);f&&(n.structuredQuery.where=f);const x=(function(P){if(P.length!==0)return P.map((L=>(function(V){return{field:sg(V.field),direction:AX(V.dir)}})(L)))})(e.orderBy);x&&(n.structuredQuery.orderBy=x);const s=m2(t,e.limit);return s!==null&&(n.structuredQuery.limit=s),e.startAt&&(n.structuredQuery.startAt=(function(P){return{before:P.inclusive,values:P.position}})(e.startAt)),e.endAt&&(n.structuredQuery.endAt=(function(P){return{before:!P.inclusive,values:P.position}})(e.endAt)),{ft:n,parent:d}}function CX(t){let e=bX(t.parent);const n=t.structuredQuery,l=n.from?n.from.length:0;let d=null;if(l>0){ji(l===1,65062);const L=n.from[0];L.allDescendants?d=L.collectionId:e=e.child(L.collectionId)}let f=[];n.where&&(f=(function($){const V=GF($);return V instanceof yc&&gF(V)?V.getFilters():[V]})(n.where));let x=[];n.orderBy&&(x=(function($){return $.map((V=>(function(ue){return new ww(ag(ue.field),(function(Te){switch(Te){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(ue.direction))})(V)))})(n.orderBy));let s=null;n.limit&&(s=(function($){let V;return V=typeof $=="object"?$.value:$,eb(V)?null:V})(n.limit));let C=null;n.startAt&&(C=(function($){const V=!!$.before,j=$.values||[];return new xw(j,V)})(n.startAt));let P=null;return n.endAt&&(P=(function($){const V=!$.before,j=$.values||[];return new xw(j,V)})(n.endAt)),KZ(e,d,x,f,s,"F",C,P)}function IX(t,e){const n=(function(d){switch(d){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Ar(28987,{purpose:d})}})(e.purpose);return n==null?null:{"goog-listen-tags":n}}function GF(t){return t.unaryFilter!==void 0?(function(n){switch(n.unaryFilter.op){case"IS_NAN":const l=ag(n.unaryFilter.field);return as.create(l,"==",{doubleValue:NaN});case"IS_NULL":const d=ag(n.unaryFilter.field);return as.create(d,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const f=ag(n.unaryFilter.field);return as.create(f,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const x=ag(n.unaryFilter.field);return as.create(x,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Ar(61313);default:return Ar(60726)}})(t):t.fieldFilter!==void 0?(function(n){return as.create(ag(n.fieldFilter.field),(function(d){switch(d){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Ar(58110);default:return Ar(50506)}})(n.fieldFilter.op),n.fieldFilter.value)})(t):t.compositeFilter!==void 0?(function(n){return yc.create(n.compositeFilter.filters.map((l=>GF(l))),(function(d){switch(d){case"AND":return"and";case"OR":return"or";default:return Ar(1026)}})(n.compositeFilter.op))})(t):Ar(30097,{filter:t})}function AX(t){return mX[t]}function PX(t){return gX[t]}function RX(t){return _X[t]}function sg(t){return{fieldPath:t.canonicalString()}}function ag(t){return Us.fromServerFormat(t.fieldPath)}function HF(t){return t instanceof as?(function(n){if(n.op==="=="){if(yD(n.value))return{unaryFilter:{field:sg(n.field),op:"IS_NAN"}};if(_D(n.value))return{unaryFilter:{field:sg(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(yD(n.value))return{unaryFilter:{field:sg(n.field),op:"IS_NOT_NAN"}};if(_D(n.value))return{unaryFilter:{field:sg(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:sg(n.field),op:PX(n.op),value:n.value}}})(t):t instanceof yc?(function(n){const l=n.getFilters().map((d=>HF(d)));return l.length===1?l[0]:{compositeFilter:{op:RX(n.op),filters:l}}})(t):Ar(54877,{filter:t})}function kX(t){const e=[];return t.fields.forEach((n=>e.push(n.canonicalString()))),{fieldPaths:e}}function WF(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dh{constructor(e,n,l,d,f=Ur.min(),x=Ur.min(),s=Gs.EMPTY_BYTE_STRING,C=null){this.target=e,this.targetId=n,this.purpose=l,this.sequenceNumber=d,this.snapshotVersion=f,this.lastLimboFreeSnapshotVersion=x,this.resumeToken=s,this.expectedCount=C}withSequenceNumber(e){return new Dh(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new Dh(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Dh(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Dh(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OX{constructor(e){this.yt=e}}function MX(t){const e=CX({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?p2(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DX{constructor(){this.Cn=new LX}addToCollectionParentIndex(e,n){return this.Cn.add(n),nn.resolve()}getCollectionParents(e,n){return nn.resolve(this.Cn.getEntries(n))}addFieldIndex(e,n){return nn.resolve()}deleteFieldIndex(e,n){return nn.resolve()}deleteAllFieldIndexes(e){return nn.resolve()}createTargetIndexes(e,n){return nn.resolve()}getDocumentsMatchingTarget(e,n){return nn.resolve(null)}getIndexType(e,n){return nn.resolve(0)}getFieldIndexes(e,n){return nn.resolve([])}getNextCollectionGroupToUpdate(e){return nn.resolve(null)}getMinOffset(e,n){return nn.resolve(Kh.min())}getMinOffsetFromCollectionGroup(e,n){return nn.resolve(Kh.min())}updateCollectionGroup(e,n,l){return nn.resolve()}updateIndexEntries(e,n){return nn.resolve()}}class LX{constructor(){this.index={}}add(e){const n=e.lastSegment(),l=e.popLast(),d=this.index[n]||new gs(bo.comparator),f=!d.has(l);return this.index[n]=d.add(l),f}has(e){const n=e.lastSegment(),l=e.popLast(),d=this.index[n];return d&&d.has(l)}getEntries(e){return(this.index[e]||new gs(bo.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OD={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},qF=41943040;class $a{static withCacheSize(e){return new $a(e,$a.DEFAULT_COLLECTION_PERCENTILE,$a.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,n,l){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=l}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */$a.DEFAULT_COLLECTION_PERCENTILE=10,$a.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,$a.DEFAULT=new $a(qF,$a.DEFAULT_COLLECTION_PERCENTILE,$a.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),$a.DISABLED=new $a(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vg{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new Vg(0)}static cr(){return new Vg(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MD="LruGarbageCollector",zX=1048576;function DD([t,e],[n,l]){const d=Li(t,n);return d===0?Li(e,l):d}class FX{constructor(e){this.Ir=e,this.buffer=new gs(DD),this.Er=0}dr(){return++this.Er}Ar(e){const n=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(n);else{const l=this.buffer.last();DD(n,l)<0&&(this.buffer=this.buffer.delete(l).add(n))}}get maxValue(){return this.buffer.last()[0]}}class BX{constructor(e,n,l){this.garbageCollector=e,this.asyncQueue=n,this.localStore=l,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){Qn(MD,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){t_(n)?Qn(MD,"Ignoring IndexedDB error during garbage collection: ",n):await e_(n)}await this.Vr(3e5)}))}}class NX{constructor(e,n){this.mr=e,this.params=n}calculateTargetCount(e,n){return this.mr.gr(e).next((l=>Math.floor(n/100*l)))}nthSequenceNumber(e,n){if(n===0)return nn.resolve(gT.ce);const l=new FX(n);return this.mr.forEachTarget(e,(d=>l.Ar(d.sequenceNumber))).next((()=>this.mr.pr(e,(d=>l.Ar(d))))).next((()=>l.maxValue))}removeTargets(e,n,l){return this.mr.removeTargets(e,n,l)}removeOrphanedDocuments(e,n){return this.mr.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(Qn("LruGarbageCollector","Garbage collection skipped; disabled"),nn.resolve(OD)):this.getCacheSize(e).next((l=>l<this.params.cacheSizeCollectionThreshold?(Qn("LruGarbageCollector",`Garbage collection skipped; Cache size ${l} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),OD):this.yr(e,n)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,n){let l,d,f,x,s,C,P;const L=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(($=>($>this.params.maximumSequenceNumbersToCollect?(Qn("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${$}`),d=this.params.maximumSequenceNumbersToCollect):d=$,x=Date.now(),this.nthSequenceNumber(e,d)))).next(($=>(l=$,s=Date.now(),this.removeTargets(e,l,n)))).next(($=>(f=$,C=Date.now(),this.removeOrphanedDocuments(e,l)))).next(($=>(P=Date.now(),ig()<=Pi.DEBUG&&Qn("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${x-L}ms
	Determined least recently used ${d} in `+(s-x)+`ms
	Removed ${f} targets in `+(C-s)+`ms
	Removed ${$} documents in `+(P-C)+`ms
Total Duration: ${P-L}ms`),nn.resolve({didRun:!0,sequenceNumbersCollected:d,targetsRemoved:f,documentsRemoved:$}))))}}function VX(t,e){return new NX(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $X{constructor(){this.changes=new Cp((e=>e.toString()),((e,n)=>e.isEqual(n))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,As.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const l=this.changes.get(n);return l!==void 0?nn.resolve(l):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UX{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jX{constructor(e,n,l,d){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=l,this.indexManager=d}getDocument(e,n){let l=null;return this.documentOverlayCache.getOverlay(e,n).next((d=>(l=d,this.remoteDocumentCache.getEntry(e,n)))).next((d=>(l!==null&&Pv(l.mutation,d,cl.empty(),Lo.now()),d)))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next((l=>this.getLocalViewOfDocuments(e,l,zi()).next((()=>l))))}getLocalViewOfDocuments(e,n,l=zi()){const d=ap();return this.populateOverlays(e,d,n).next((()=>this.computeViews(e,n,d,l).next((f=>{let x=cv();return f.forEach(((s,C)=>{x=x.insert(s,C.overlayedDocument)})),x}))))}getOverlayedDocuments(e,n){const l=ap();return this.populateOverlays(e,l,n).next((()=>this.computeViews(e,n,l,zi())))}populateOverlays(e,n,l){const d=[];return l.forEach((f=>{n.has(f)||d.push(f)})),this.documentOverlayCache.getOverlays(e,d).next((f=>{f.forEach(((x,s)=>{n.set(x,s)}))}))}computeViews(e,n,l,d){let f=Td();const x=Av(),s=(function(){return Av()})();return n.forEach(((C,P)=>{const L=l.get(P.key);d.has(P.key)&&(L===void 0||L.mutation instanceof lf)?f=f.insert(P.key,P):L!==void 0?(x.set(P.key,L.mutation.getFieldMask()),Pv(L.mutation,P,L.mutation.getFieldMask(),Lo.now())):x.set(P.key,cl.empty())})),this.recalculateAndSaveOverlays(e,f).next((C=>(C.forEach(((P,L)=>x.set(P,L))),n.forEach(((P,L)=>s.set(P,new UX(L,x.get(P)??null)))),s)))}recalculateAndSaveOverlays(e,n){const l=Av();let d=new qo(((x,s)=>x-s)),f=zi();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next((x=>{for(const s of x)s.keys().forEach((C=>{const P=n.get(C);if(P===null)return;let L=l.get(C)||cl.empty();L=s.applyToLocalView(P,L),l.set(C,L);const $=(d.get(s.batchId)||zi()).add(C);d=d.insert(s.batchId,$)}))})).next((()=>{const x=[],s=d.getReverseIterator();for(;s.hasNext();){const C=s.getNext(),P=C.key,L=C.value,$=EF();L.forEach((V=>{if(!f.has(V)){const j=OF(n.get(V),l.get(V));j!==null&&$.set(V,j),f=f.add(V)}})),x.push(this.documentOverlayCache.saveOverlays(e,P,$))}return nn.waitFor(x)})).next((()=>l))}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next((l=>this.recalculateAndSaveOverlays(e,l)))}getDocumentsMatchingQuery(e,n,l,d){return(function(x){return xr.isDocumentKey(x.path)&&x.collectionGroup===null&&x.filters.length===0})(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):bF(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,l,d):this.getDocumentsMatchingCollectionQuery(e,n,l,d)}getNextDocuments(e,n,l,d){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,l,d).next((f=>{const x=d-f.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,l.largestBatchId,d-f.size):nn.resolve(ap());let s=Jv,C=f;return x.next((P=>nn.forEach(P,((L,$)=>(s<$.largestBatchId&&(s=$.largestBatchId),f.get(L)?nn.resolve():this.remoteDocumentCache.getEntry(e,L).next((V=>{C=C.insert(L,V)}))))).next((()=>this.populateOverlays(e,P,f))).next((()=>this.computeViews(e,C,P,zi()))).next((L=>({batchId:s,changes:SF(L)})))))}))}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new xr(n)).next((l=>{let d=cv();return l.isFoundDocument()&&(d=d.insert(l.key,l)),d}))}getDocumentsMatchingCollectionGroupQuery(e,n,l,d){const f=n.collectionGroup;let x=cv();return this.indexManager.getCollectionParents(e,f).next((s=>nn.forEach(s,(C=>{const P=(function($,V){return new tb(V,null,$.explicitOrderBy.slice(),$.filters.slice(),$.limit,$.limitType,$.startAt,$.endAt)})(n,C.child(f));return this.getDocumentsMatchingCollectionQuery(e,P,l,d).next((L=>{L.forEach((($,V)=>{x=x.insert($,V)}))}))})).next((()=>x))))}getDocumentsMatchingCollectionQuery(e,n,l,d){let f;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,l.largestBatchId).next((x=>(f=x,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,l,f,d)))).next((x=>{f.forEach(((C,P)=>{const L=P.getKey();x.get(L)===null&&(x=x.insert(L,As.newInvalidDocument(L)))}));let s=cv();return x.forEach(((C,P)=>{const L=f.get(C);L!==void 0&&Pv(L.mutation,P,cl.empty(),Lo.now()),vT(n,P)&&(s=s.insert(C,P))})),s}))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GX{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,n){return nn.resolve(this.Lr.get(n))}saveBundleMetadata(e,n){return this.Lr.set(n.id,(function(d){return{id:d.id,version:d.version,createTime:hl(d.createTime)}})(n)),nn.resolve()}getNamedQuery(e,n){return nn.resolve(this.kr.get(n))}saveNamedQuery(e,n){return this.kr.set(n.name,(function(d){return{name:d.name,query:MX(d.bundledQuery),readTime:hl(d.readTime)}})(n)),nn.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HX{constructor(){this.overlays=new qo(xr.comparator),this.qr=new Map}getOverlay(e,n){return nn.resolve(this.overlays.get(n))}getOverlays(e,n){const l=ap();return nn.forEach(n,(d=>this.getOverlay(e,d).next((f=>{f!==null&&l.set(d,f)})))).next((()=>l))}saveOverlays(e,n,l){return l.forEach(((d,f)=>{this.St(e,n,f)})),nn.resolve()}removeOverlaysForBatchId(e,n,l){const d=this.qr.get(l);return d!==void 0&&(d.forEach((f=>this.overlays=this.overlays.remove(f))),this.qr.delete(l)),nn.resolve()}getOverlaysForCollection(e,n,l){const d=ap(),f=n.length+1,x=new xr(n.child("")),s=this.overlays.getIteratorFrom(x);for(;s.hasNext();){const C=s.getNext().value,P=C.getKey();if(!n.isPrefixOf(P.path))break;P.path.length===f&&C.largestBatchId>l&&d.set(C.getKey(),C)}return nn.resolve(d)}getOverlaysForCollectionGroup(e,n,l,d){let f=new qo(((P,L)=>P-L));const x=this.overlays.getIterator();for(;x.hasNext();){const P=x.getNext().value;if(P.getKey().getCollectionGroup()===n&&P.largestBatchId>l){let L=f.get(P.largestBatchId);L===null&&(L=ap(),f=f.insert(P.largestBatchId,L)),L.set(P.getKey(),P)}}const s=ap(),C=f.getIterator();for(;C.hasNext()&&(C.getNext().value.forEach(((P,L)=>s.set(P,L))),!(s.size()>=d)););return nn.resolve(s)}St(e,n,l){const d=this.overlays.get(l.key);if(d!==null){const x=this.qr.get(d.largestBatchId).delete(l.key);this.qr.set(d.largestBatchId,x)}this.overlays=this.overlays.insert(l.key,new uX(n,l));let f=this.qr.get(n);f===void 0&&(f=zi(),this.qr.set(n,f)),this.qr.set(n,f.add(l.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WX{constructor(){this.sessionToken=Gs.EMPTY_BYTE_STRING}getSessionToken(e){return nn.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,nn.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EA{constructor(){this.Qr=new gs(Is.$r),this.Ur=new gs(Is.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,n){const l=new Is(e,n);this.Qr=this.Qr.add(l),this.Ur=this.Ur.add(l)}Wr(e,n){e.forEach((l=>this.addReference(l,n)))}removeReference(e,n){this.Gr(new Is(e,n))}zr(e,n){e.forEach((l=>this.removeReference(l,n)))}jr(e){const n=new xr(new bo([])),l=new Is(n,e),d=new Is(n,e+1),f=[];return this.Ur.forEachInRange([l,d],(x=>{this.Gr(x),f.push(x.key)})),f}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const n=new xr(new bo([])),l=new Is(n,e),d=new Is(n,e+1);let f=zi();return this.Ur.forEachInRange([l,d],(x=>{f=f.add(x.key)})),f}containsKey(e){const n=new Is(e,0),l=this.Qr.firstAfterOrEqual(n);return l!==null&&e.isEqual(l.key)}}class Is{constructor(e,n){this.key=e,this.Yr=n}static $r(e,n){return xr.comparator(e.key,n.key)||Li(e.Yr,n.Yr)}static Kr(e,n){return Li(e.Yr,n.Yr)||xr.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qX{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.tr=1,this.Zr=new gs(Is.$r)}checkEmpty(e){return nn.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,l,d){const f=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const x=new cX(f,n,l,d);this.mutationQueue.push(x);for(const s of d)this.Zr=this.Zr.add(new Is(s.key,f)),this.indexManager.addToCollectionParentIndex(e,s.key.path.popLast());return nn.resolve(x)}lookupMutationBatch(e,n){return nn.resolve(this.Xr(n))}getNextMutationBatchAfterBatchId(e,n){const l=n+1,d=this.ei(l),f=d<0?0:d;return nn.resolve(this.mutationQueue.length>f?this.mutationQueue[f]:null)}getHighestUnacknowledgedBatchId(){return nn.resolve(this.mutationQueue.length===0?fA:this.tr-1)}getAllMutationBatches(e){return nn.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const l=new Is(n,0),d=new Is(n,Number.POSITIVE_INFINITY),f=[];return this.Zr.forEachInRange([l,d],(x=>{const s=this.Xr(x.Yr);f.push(s)})),nn.resolve(f)}getAllMutationBatchesAffectingDocumentKeys(e,n){let l=new gs(Li);return n.forEach((d=>{const f=new Is(d,0),x=new Is(d,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([f,x],(s=>{l=l.add(s.Yr)}))})),nn.resolve(this.ti(l))}getAllMutationBatchesAffectingQuery(e,n){const l=n.path,d=l.length+1;let f=l;xr.isDocumentKey(f)||(f=f.child(""));const x=new Is(new xr(f),0);let s=new gs(Li);return this.Zr.forEachWhile((C=>{const P=C.key.path;return!!l.isPrefixOf(P)&&(P.length===d&&(s=s.add(C.Yr)),!0)}),x),nn.resolve(this.ti(s))}ti(e){const n=[];return e.forEach((l=>{const d=this.Xr(l);d!==null&&n.push(d)})),n}removeMutationBatch(e,n){ji(this.ni(n.batchId,"removed")===0,55003),this.mutationQueue.shift();let l=this.Zr;return nn.forEach(n.mutations,(d=>{const f=new Is(d.key,n.batchId);return l=l.delete(f),this.referenceDelegate.markPotentiallyOrphaned(e,d.key)})).next((()=>{this.Zr=l}))}ir(e){}containsKey(e,n){const l=new Is(n,0),d=this.Zr.firstAfterOrEqual(l);return nn.resolve(n.isEqual(d&&d.key))}performConsistencyCheck(e){return this.mutationQueue.length,nn.resolve()}ni(e,n){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){const n=this.ei(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KX{constructor(e){this.ri=e,this.docs=(function(){return new qo(xr.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const l=n.key,d=this.docs.get(l),f=d?d.size:0,x=this.ri(n);return this.docs=this.docs.insert(l,{document:n.mutableCopy(),size:x}),this.size+=x-f,this.indexManager.addToCollectionParentIndex(e,l.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const l=this.docs.get(n);return nn.resolve(l?l.document.mutableCopy():As.newInvalidDocument(n))}getEntries(e,n){let l=Td();return n.forEach((d=>{const f=this.docs.get(d);l=l.insert(d,f?f.document.mutableCopy():As.newInvalidDocument(d))})),nn.resolve(l)}getDocumentsMatchingQuery(e,n,l,d){let f=Td();const x=n.path,s=new xr(x.child("__id-9223372036854775808__")),C=this.docs.getIteratorFrom(s);for(;C.hasNext();){const{key:P,value:{document:L}}=C.getNext();if(!x.isPrefixOf(P.path))break;P.path.length>x.length+1||CZ(EZ(L),l)<=0||(d.has(L.key)||vT(n,L))&&(f=f.insert(L.key,L.mutableCopy()))}return nn.resolve(f)}getAllFromCollectionGroup(e,n,l,d){Ar(9500)}ii(e,n){return nn.forEach(this.docs,(l=>n(l)))}newChangeBuffer(e){return new ZX(this)}getSize(e){return nn.resolve(this.size)}}class ZX extends $X{constructor(e){super(),this.Nr=e}applyChanges(e){const n=[];return this.changes.forEach(((l,d)=>{d.isValidDocument()?n.push(this.Nr.addEntry(e,d)):this.Nr.removeEntry(l)})),nn.waitFor(n)}getFromCache(e,n){return this.Nr.getEntry(e,n)}getAllFromCache(e,n){return this.Nr.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XX{constructor(e){this.persistence=e,this.si=new Cp((n=>gA(n)),_A),this.lastRemoteSnapshotVersion=Ur.min(),this.highestTargetId=0,this.oi=0,this._i=new EA,this.targetCount=0,this.ai=Vg.ur()}forEachTarget(e,n){return this.si.forEach(((l,d)=>n(d))),nn.resolve()}getLastRemoteSnapshotVersion(e){return nn.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return nn.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),nn.resolve(this.highestTargetId)}setTargetsMetadata(e,n,l){return l&&(this.lastRemoteSnapshotVersion=l),n>this.oi&&(this.oi=n),nn.resolve()}Pr(e){this.si.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.ai=new Vg(n),this.highestTargetId=n),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,n){return this.Pr(n),this.targetCount+=1,nn.resolve()}updateTargetData(e,n){return this.Pr(n),nn.resolve()}removeTargetData(e,n){return this.si.delete(n.target),this._i.jr(n.targetId),this.targetCount-=1,nn.resolve()}removeTargets(e,n,l){let d=0;const f=[];return this.si.forEach(((x,s)=>{s.sequenceNumber<=n&&l.get(s.targetId)===null&&(this.si.delete(x),f.push(this.removeMatchingKeysForTargetId(e,s.targetId)),d++)})),nn.waitFor(f).next((()=>d))}getTargetCount(e){return nn.resolve(this.targetCount)}getTargetData(e,n){const l=this.si.get(n)||null;return nn.resolve(l)}addMatchingKeys(e,n,l){return this._i.Wr(n,l),nn.resolve()}removeMatchingKeys(e,n,l){this._i.zr(n,l);const d=this.persistence.referenceDelegate,f=[];return d&&n.forEach((x=>{f.push(d.markPotentiallyOrphaned(e,x))})),nn.waitFor(f)}removeMatchingKeysForTargetId(e,n){return this._i.jr(n),nn.resolve()}getMatchingKeysForTargetId(e,n){const l=this._i.Hr(n);return nn.resolve(l)}containsKey(e,n){return nn.resolve(this._i.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KF{constructor(e,n){this.ui={},this.overlays={},this.ci=new gT(0),this.li=!1,this.li=!0,this.hi=new WX,this.referenceDelegate=e(this),this.Pi=new XX(this),this.indexManager=new DX,this.remoteDocumentCache=(function(d){return new KX(d)})((l=>this.referenceDelegate.Ti(l))),this.serializer=new OX(n),this.Ii=new GX(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new HX,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let l=this.ui[e.toKey()];return l||(l=new qX(n,this.referenceDelegate),this.ui[e.toKey()]=l),l}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,n,l){Qn("MemoryPersistence","Starting transaction:",e);const d=new YX(this.ci.next());return this.referenceDelegate.Ei(),l(d).next((f=>this.referenceDelegate.di(d).next((()=>f)))).toPromise().then((f=>(d.raiseOnCommittedEvent(),f)))}Ai(e,n){return nn.or(Object.values(this.ui).map((l=>()=>l.containsKey(e,n))))}}class YX extends AZ{constructor(e){super(),this.currentSequenceNumber=e}}class CA{constructor(e){this.persistence=e,this.Ri=new EA,this.Vi=null}static mi(e){return new CA(e)}get fi(){if(this.Vi)return this.Vi;throw Ar(60996)}addReference(e,n,l){return this.Ri.addReference(l,n),this.fi.delete(l.toString()),nn.resolve()}removeReference(e,n,l){return this.Ri.removeReference(l,n),this.fi.add(l.toString()),nn.resolve()}markPotentiallyOrphaned(e,n){return this.fi.add(n.toString()),nn.resolve()}removeTarget(e,n){this.Ri.jr(n.targetId).forEach((d=>this.fi.add(d.toString())));const l=this.persistence.getTargetCache();return l.getMatchingKeysForTargetId(e,n.targetId).next((d=>{d.forEach((f=>this.fi.add(f.toString())))})).next((()=>l.removeTargetData(e,n)))}Ei(){this.Vi=new Set}di(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return nn.forEach(this.fi,(l=>{const d=xr.fromPath(l);return this.gi(e,d).next((f=>{f||n.removeEntry(d,Ur.min())}))})).next((()=>(this.Vi=null,n.apply(e))))}updateLimboDocument(e,n){return this.gi(e,n).next((l=>{l?this.fi.delete(n.toString()):this.fi.add(n.toString())}))}Ti(e){return 0}gi(e,n){return nn.or([()=>nn.resolve(this.Ri.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Ai(e,n)])}}class Ew{constructor(e,n){this.persistence=e,this.pi=new Cp((l=>kZ(l.path)),((l,d)=>l.isEqual(d))),this.garbageCollector=VX(this,n)}static mi(e,n){return new Ew(e,n)}Ei(){}di(e){return nn.resolve()}forEachTarget(e,n){return this.persistence.getTargetCache().forEachTarget(e,n)}gr(e){const n=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next((l=>n.next((d=>l+d))))}wr(e){let n=0;return this.pr(e,(l=>{n++})).next((()=>n))}pr(e,n){return nn.forEach(this.pi,((l,d)=>this.br(e,l,d).next((f=>f?nn.resolve():n(d)))))}removeTargets(e,n,l){return this.persistence.getTargetCache().removeTargets(e,n,l)}removeOrphanedDocuments(e,n){let l=0;const d=this.persistence.getRemoteDocumentCache(),f=d.newChangeBuffer();return d.ii(e,(x=>this.br(e,x,n).next((s=>{s||(l++,f.removeEntry(x,Ur.min()))})))).next((()=>f.apply(e))).next((()=>l))}markPotentiallyOrphaned(e,n){return this.pi.set(n,e.currentSequenceNumber),nn.resolve()}removeTarget(e,n){const l=n.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,l)}addReference(e,n,l){return this.pi.set(l,e.currentSequenceNumber),nn.resolve()}removeReference(e,n,l){return this.pi.set(l,e.currentSequenceNumber),nn.resolve()}updateLimboDocument(e,n){return this.pi.set(n,e.currentSequenceNumber),nn.resolve()}Ti(e){let n=e.key.toString().length;return e.isFoundDocument()&&(n+=jx(e.data.value)),n}br(e,n,l){return nn.or([()=>this.persistence.Ai(e,n),()=>this.persistence.getTargetCache().containsKey(e,n),()=>{const d=this.pi.get(n);return nn.resolve(d!==void 0&&d>l)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IA{constructor(e,n,l,d){this.targetId=e,this.fromCache=n,this.Es=l,this.ds=d}static As(e,n){let l=zi(),d=zi();for(const f of n.docChanges)switch(f.type){case 0:l=l.add(f.doc.key);break;case 1:d=d.add(f.doc.key)}return new IA(e,n.fromCache,l,d)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JX{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QX{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return RH()?8:PZ(ca())>0?6:4})()}initialize(e,n){this.ps=e,this.indexManager=n,this.Rs=!0}getDocumentsMatchingQuery(e,n,l,d){const f={result:null};return this.ys(e,n).next((x=>{f.result=x})).next((()=>{if(!f.result)return this.ws(e,n,d,l).next((x=>{f.result=x}))})).next((()=>{if(f.result)return;const x=new JX;return this.Ss(e,n,x).next((s=>{if(f.result=s,this.Vs)return this.bs(e,n,x,s.size)}))})).next((()=>f.result))}bs(e,n,l,d){return l.documentReadCount<this.fs?(ig()<=Pi.DEBUG&&Qn("QueryEngine","SDK will not create cache indexes for query:",og(n),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),nn.resolve()):(ig()<=Pi.DEBUG&&Qn("QueryEngine","Query:",og(n),"scans",l.documentReadCount,"local documents and returns",d,"documents as results."),l.documentReadCount>this.gs*d?(ig()<=Pi.DEBUG&&Qn("QueryEngine","The SDK decides to create cache indexes for query:",og(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,lu(n))):nn.resolve())}ys(e,n){if(wD(n))return nn.resolve(null);let l=lu(n);return this.indexManager.getIndexType(e,l).next((d=>d===0?null:(n.limit!==null&&d===1&&(n=p2(n,null,"F"),l=lu(n)),this.indexManager.getDocumentsMatchingTarget(e,l).next((f=>{const x=zi(...f);return this.ps.getDocuments(e,x).next((s=>this.indexManager.getMinOffset(e,l).next((C=>{const P=this.Ds(n,s);return this.Cs(n,P,x,C.readTime)?this.ys(e,p2(n,null,"F")):this.vs(e,P,n,C)}))))})))))}ws(e,n,l,d){return wD(n)||d.isEqual(Ur.min())?nn.resolve(null):this.ps.getDocuments(e,l).next((f=>{const x=this.Ds(n,f);return this.Cs(n,x,l,d)?nn.resolve(null):(ig()<=Pi.DEBUG&&Qn("QueryEngine","Re-using previous result from %s to execute query: %s",d.toString(),og(n)),this.vs(e,x,n,SZ(d,Jv)).next((s=>s)))}))}Ds(e,n){let l=new gs(wF(e));return n.forEach(((d,f)=>{vT(e,f)&&(l=l.add(f))})),l}Cs(e,n,l,d){if(e.limit===null)return!1;if(l.size!==n.size)return!0;const f=e.limitType==="F"?n.last():n.first();return!!f&&(f.hasPendingWrites||f.version.compareTo(d)>0)}Ss(e,n,l){return ig()<=Pi.DEBUG&&Qn("QueryEngine","Using full collection scan to execute query:",og(n)),this.ps.getDocumentsMatchingQuery(e,n,Kh.min(),l)}vs(e,n,l,d){return this.ps.getDocumentsMatchingQuery(e,l,d).next((f=>(n.forEach((x=>{f=f.insert(x.key,x)})),f)))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AA="LocalStore",eY=3e8;class tY{constructor(e,n,l,d){this.persistence=e,this.Fs=n,this.serializer=d,this.Ms=new qo(Li),this.xs=new Cp((f=>gA(f)),_A),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(l)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new jX(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(n=>e.collect(n,this.Ms)))}}function nY(t,e,n,l){return new tY(t,e,n,l)}async function ZF(t,e){const n=Xr(t);return await n.persistence.runTransaction("Handle user change","readonly",(l=>{let d;return n.mutationQueue.getAllMutationBatches(l).next((f=>(d=f,n.Bs(e),n.mutationQueue.getAllMutationBatches(l)))).next((f=>{const x=[],s=[];let C=zi();for(const P of d){x.push(P.batchId);for(const L of P.mutations)C=C.add(L.key)}for(const P of f){s.push(P.batchId);for(const L of P.mutations)C=C.add(L.key)}return n.localDocuments.getDocuments(l,C).next((P=>({Ls:P,removedBatchIds:x,addedBatchIds:s})))}))}))}function rY(t,e){const n=Xr(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(l=>{const d=e.batch.keys(),f=n.Ns.newChangeBuffer({trackRemovals:!0});return(function(s,C,P,L){const $=P.batch,V=$.keys();let j=nn.resolve();return V.forEach((ue=>{j=j.next((()=>L.getEntry(C,ue))).next((de=>{const Te=P.docVersions.get(ue);ji(Te!==null,48541),de.version.compareTo(Te)<0&&($.applyToRemoteDocument(de,P),de.isValidDocument()&&(de.setReadTime(P.commitVersion),L.addEntry(de)))}))})),j.next((()=>s.mutationQueue.removeMutationBatch(C,$)))})(n,l,e,f).next((()=>f.apply(l))).next((()=>n.mutationQueue.performConsistencyCheck(l))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(l,d,e.batch.batchId))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(l,(function(s){let C=zi();for(let P=0;P<s.mutationResults.length;++P)s.mutationResults[P].transformResults.length>0&&(C=C.add(s.batch.mutations[P].key));return C})(e)))).next((()=>n.localDocuments.getDocuments(l,d)))}))}function XF(t){const e=Xr(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(n=>e.Pi.getLastRemoteSnapshotVersion(n)))}function iY(t,e){const n=Xr(t),l=e.snapshotVersion;let d=n.Ms;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(f=>{const x=n.Ns.newChangeBuffer({trackRemovals:!0});d=n.Ms;const s=[];e.targetChanges.forEach(((L,$)=>{const V=d.get($);if(!V)return;s.push(n.Pi.removeMatchingKeys(f,L.removedDocuments,$).next((()=>n.Pi.addMatchingKeys(f,L.addedDocuments,$))));let j=V.withSequenceNumber(f.currentSequenceNumber);e.targetMismatches.get($)!==null?j=j.withResumeToken(Gs.EMPTY_BYTE_STRING,Ur.min()).withLastLimboFreeSnapshotVersion(Ur.min()):L.resumeToken.approximateByteSize()>0&&(j=j.withResumeToken(L.resumeToken,l)),d=d.insert($,j),(function(de,Te,Be){return de.resumeToken.approximateByteSize()===0||Te.snapshotVersion.toMicroseconds()-de.snapshotVersion.toMicroseconds()>=eY?!0:Be.addedDocuments.size+Be.modifiedDocuments.size+Be.removedDocuments.size>0})(V,j,L)&&s.push(n.Pi.updateTargetData(f,j))}));let C=Td(),P=zi();if(e.documentUpdates.forEach((L=>{e.resolvedLimboDocuments.has(L)&&s.push(n.persistence.referenceDelegate.updateLimboDocument(f,L))})),s.push(oY(f,x,e.documentUpdates).next((L=>{C=L.ks,P=L.qs}))),!l.isEqual(Ur.min())){const L=n.Pi.getLastRemoteSnapshotVersion(f).next(($=>n.Pi.setTargetsMetadata(f,f.currentSequenceNumber,l)));s.push(L)}return nn.waitFor(s).next((()=>x.apply(f))).next((()=>n.localDocuments.getLocalViewOfDocuments(f,C,P))).next((()=>C))})).then((f=>(n.Ms=d,f)))}function oY(t,e,n){let l=zi(),d=zi();return n.forEach((f=>l=l.add(f))),e.getEntries(t,l).next((f=>{let x=Td();return n.forEach(((s,C)=>{const P=f.get(s);C.isFoundDocument()!==P.isFoundDocument()&&(d=d.add(s)),C.isNoDocument()&&C.version.isEqual(Ur.min())?(e.removeEntry(s,C.readTime),x=x.insert(s,C)):!P.isValidDocument()||C.version.compareTo(P.version)>0||C.version.compareTo(P.version)===0&&P.hasPendingWrites?(e.addEntry(C),x=x.insert(s,C)):Qn(AA,"Ignoring outdated watch update for ",s,". Current version:",P.version," Watch version:",C.version)})),{ks:x,qs:d}}))}function sY(t,e){const n=Xr(t);return n.persistence.runTransaction("Get next mutation batch","readonly",(l=>(e===void 0&&(e=fA),n.mutationQueue.getNextMutationBatchAfterBatchId(l,e))))}function aY(t,e){const n=Xr(t);return n.persistence.runTransaction("Allocate target","readwrite",(l=>{let d;return n.Pi.getTargetData(l,e).next((f=>f?(d=f,nn.resolve(d)):n.Pi.allocateTargetId(l).next((x=>(d=new Dh(e,x,"TargetPurposeListen",l.currentSequenceNumber),n.Pi.addTargetData(l,d).next((()=>d)))))))})).then((l=>{const d=n.Ms.get(l.targetId);return(d===null||l.snapshotVersion.compareTo(d.snapshotVersion)>0)&&(n.Ms=n.Ms.insert(l.targetId,l),n.xs.set(e,l.targetId)),l}))}async function y2(t,e,n){const l=Xr(t),d=l.Ms.get(e),f=n?"readwrite":"readwrite-primary";try{n||await l.persistence.runTransaction("Release target",f,(x=>l.persistence.referenceDelegate.removeTarget(x,d)))}catch(x){if(!t_(x))throw x;Qn(AA,`Failed to update sequence numbers for target ${e}: ${x}`)}l.Ms=l.Ms.remove(e),l.xs.delete(d.target)}function LD(t,e,n){const l=Xr(t);let d=Ur.min(),f=zi();return l.persistence.runTransaction("Execute query","readwrite",(x=>(function(C,P,L){const $=Xr(C),V=$.xs.get(L);return V!==void 0?nn.resolve($.Ms.get(V)):$.Pi.getTargetData(P,L)})(l,x,lu(e)).next((s=>{if(s)return d=s.lastLimboFreeSnapshotVersion,l.Pi.getMatchingKeysForTargetId(x,s.targetId).next((C=>{f=C}))})).next((()=>l.Fs.getDocumentsMatchingQuery(x,e,n?d:Ur.min(),n?f:zi()))).next((s=>(lY(l,XZ(e),s),{documents:s,Qs:f})))))}function lY(t,e,n){let l=t.Os.get(e)||Ur.min();n.forEach(((d,f)=>{f.readTime.compareTo(l)>0&&(l=f.readTime)})),t.Os.set(e,l)}class zD{constructor(){this.activeTargetIds=nX()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class cY{constructor(){this.Mo=new zD,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,l){}addLocalQueryTarget(e,n=!0){return n&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,n,l){this.xo[e]=n}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new zD,Promise.resolve()}handleUserChange(e,n,l){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uY{Oo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FD="ConnectivityMonitor";class BD{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){Qn(FD,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){Qn(FD,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let fx=null;function v2(){return fx===null?fx=(function(){return 268435456+Math.round(2147483648*Math.random())})():fx++,"0x"+fx.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mC="RestConnection",dY={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class hY{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const n=e.ssl?"https":"http",l=encodeURIComponent(this.databaseId.projectId),d=encodeURIComponent(this.databaseId.database);this.Uo=n+"://"+e.host,this.Ko=`projects/${l}/databases/${d}`,this.Wo=this.databaseId.database===vw?`project_id=${l}`:`project_id=${l}&database_id=${d}`}Go(e,n,l,d,f){const x=v2(),s=this.zo(e,n.toUriEncodedString());Qn(mC,`Sending RPC '${e}' ${x}:`,s,l);const C={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(C,d,f);const{host:P}=new URL(s),L=Ad(P);return this.Jo(e,s,C,l,L).then(($=>(Qn(mC,`Received RPC '${e}' ${x}: `,$),$)),($=>{throw Lg(mC,`RPC '${e}' ${x} failed with error: `,$,"url: ",s,"request:",l),$}))}Ho(e,n,l,d,f,x){return this.Go(e,n,l,d,f)}jo(e,n,l){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Qg})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach(((d,f)=>e[f]=d)),l&&l.headers.forEach(((d,f)=>e[f]=d))}zo(e,n){const l=dY[e];return`${this.Uo}/v1/${n}:${l}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fY{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ta="WebChannelConnection";class pY extends hY{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,n,l,d,f){const x=v2();return new Promise(((s,C)=>{const P=new Zz;P.setWithCredentials(!0),P.listenOnce(Xz.COMPLETE,(()=>{try{switch(P.getLastErrorCode()){case Ux.NO_ERROR:const $=P.getResponseJson();Qn(ta,`XHR for RPC '${e}' ${x} received:`,JSON.stringify($)),s($);break;case Ux.TIMEOUT:Qn(ta,`RPC '${e}' ${x} timed out`),C(new $n(Yt.DEADLINE_EXCEEDED,"Request time out"));break;case Ux.HTTP_ERROR:const V=P.getStatus();if(Qn(ta,`RPC '${e}' ${x} failed with status:`,V,"response text:",P.getResponseText()),V>0){let j=P.getResponseJson();Array.isArray(j)&&(j=j[0]);const ue=j?.error;if(ue&&ue.status&&ue.message){const de=(function(Be){const Ge=Be.toLowerCase().replace(/_/g,"-");return Object.values(Yt).indexOf(Ge)>=0?Ge:Yt.UNKNOWN})(ue.status);C(new $n(de,ue.message))}else C(new $n(Yt.UNKNOWN,"Server responded with status "+P.getStatus()))}else C(new $n(Yt.UNAVAILABLE,"Connection failed."));break;default:Ar(9055,{l_:e,streamId:x,h_:P.getLastErrorCode(),P_:P.getLastError()})}}finally{Qn(ta,`RPC '${e}' ${x} completed.`)}}));const L=JSON.stringify(d);Qn(ta,`RPC '${e}' ${x} sending request:`,d),P.send(n,"POST",L,l,15)}))}T_(e,n,l){const d=v2(),f=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],x=Qz(),s=Jz(),C={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},P=this.longPollingOptions.timeoutSeconds;P!==void 0&&(C.longPollingTimeout=Math.round(1e3*P)),this.useFetchStreams&&(C.useFetchStreams=!0),this.jo(C.initMessageHeaders,n,l),C.encodeInitMessageHeaders=!0;const L=f.join("");Qn(ta,`Creating RPC '${e}' stream ${d}: ${L}`,C);const $=x.createWebChannel(L,C);this.I_($);let V=!1,j=!1;const ue=new fY({Yo:Te=>{j?Qn(ta,`Not sending because RPC '${e}' stream ${d} is closed:`,Te):(V||(Qn(ta,`Opening RPC '${e}' stream ${d} transport.`),$.open(),V=!0),Qn(ta,`RPC '${e}' stream ${d} sending:`,Te),$.send(Te))},Zo:()=>$.close()}),de=(Te,Be,Ge)=>{Te.listen(Be,(Ye=>{try{Ge(Ye)}catch(Ne){setTimeout((()=>{throw Ne}),0)}}))};return de($,lv.EventType.OPEN,(()=>{j||(Qn(ta,`RPC '${e}' stream ${d} transport opened.`),ue.o_())})),de($,lv.EventType.CLOSE,(()=>{j||(j=!0,Qn(ta,`RPC '${e}' stream ${d} transport closed`),ue.a_(),this.E_($))})),de($,lv.EventType.ERROR,(Te=>{j||(j=!0,Lg(ta,`RPC '${e}' stream ${d} transport errored. Name:`,Te.name,"Message:",Te.message),ue.a_(new $n(Yt.UNAVAILABLE,"The operation could not be completed")))})),de($,lv.EventType.MESSAGE,(Te=>{if(!j){const Be=Te.data[0];ji(!!Be,16349);const Ge=Be,Ye=Ge?.error||Ge[0]?.error;if(Ye){Qn(ta,`RPC '${e}' stream ${d} received error:`,Ye);const Ne=Ye.status;let Mt=(function(we){const Se=ss[we];if(Se!==void 0)return zF(Se)})(Ne),kt=Ye.message;Mt===void 0&&(Mt=Yt.INTERNAL,kt="Unknown error status: "+Ne+" with message "+Ye.message),j=!0,ue.a_(new $n(Mt,kt)),$.close()}else Qn(ta,`RPC '${e}' stream ${d} received:`,Be),ue.u_(Be)}})),de(s,Yz.STAT_EVENT,(Te=>{Te.stat===a2.PROXY?Qn(ta,`RPC '${e}' stream ${d} detected buffering proxy`):Te.stat===a2.NOPROXY&&Qn(ta,`RPC '${e}' stream ${d} detected no buffering proxy`)})),setTimeout((()=>{ue.__()}),0),ue}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((n=>n===e))}}function gC(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TT(t){return new yX(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PA{constructor(e,n,l=1e3,d=1.5,f=6e4){this.Mi=e,this.timerId=n,this.d_=l,this.A_=d,this.R_=f,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const n=Math.floor(this.V_+this.y_()),l=Math.max(0,Date.now()-this.f_),d=Math.max(0,n-l);d>0&&Qn("ExponentialBackoff",`Backing off for ${d} ms (base delay: ${this.V_} ms, delay with jitter: ${n} ms, last attempt: ${l} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,d,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ND="PersistentStream";class YF{constructor(e,n,l,d,f,x,s,C){this.Mi=e,this.S_=l,this.b_=d,this.connection=f,this.authCredentialsProvider=x,this.appCheckCredentialsProvider=s,this.listener=C,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new PA(e,n)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,n){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():n&&n.code===Yt.RESOURCE_EXHAUSTED?(wd(n.toString()),wd("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):n&&n.code===Yt.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(n)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),n=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([l,d])=>{this.D_===n&&this.G_(l,d)}),(l=>{e((()=>{const d=new $n(Yt.UNKNOWN,"Fetching auth token failed: "+l.message);return this.z_(d)}))}))}G_(e,n){const l=this.W_(this.D_);this.stream=this.j_(e,n),this.stream.Xo((()=>{l((()=>this.listener.Xo()))})),this.stream.t_((()=>{l((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((d=>{l((()=>this.z_(d)))})),this.stream.onMessage((d=>{l((()=>++this.F_==1?this.J_(d):this.onNext(d)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return Qn(ND,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return n=>{this.Mi.enqueueAndForget((()=>this.D_===e?n():(Qn(ND,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class mY extends YF{constructor(e,n,l,d,f,x){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,l,d,x),this.serializer=f}j_(e,n){return this.connection.T_("Listen",e,n)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const n=wX(this.serializer,e),l=(function(f){if(!("targetChange"in f))return Ur.min();const x=f.targetChange;return x.targetIds&&x.targetIds.length?Ur.min():x.readTime?hl(x.readTime):Ur.min()})(e);return this.listener.H_(n,l)}Y_(e){const n={};n.database=_2(this.serializer),n.addTarget=(function(f,x){let s;const C=x.target;if(s=h2(C)?{documents:SX(f,C)}:{query:EX(f,C).ft},s.targetId=x.targetId,x.resumeToken.approximateByteSize()>0){s.resumeToken=NF(f,x.resumeToken);const P=m2(f,x.expectedCount);P!==null&&(s.expectedCount=P)}else if(x.snapshotVersion.compareTo(Ur.min())>0){s.readTime=Tw(f,x.snapshotVersion.toTimestamp());const P=m2(f,x.expectedCount);P!==null&&(s.expectedCount=P)}return s})(this.serializer,e);const l=IX(this.serializer,e);l&&(n.labels=l),this.q_(n)}Z_(e){const n={};n.database=_2(this.serializer),n.removeTarget=e,this.q_(n)}}class gY extends YF{constructor(e,n,l,d,f,x){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,l,d,x),this.serializer=f}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,n){return this.connection.T_("Write",e,n)}J_(e){return ji(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,ji(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){ji(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const n=TX(e.writeResults,e.commitTime),l=hl(e.commitTime);return this.listener.na(l,n)}ra(){const e={};e.database=_2(this.serializer),this.q_(e)}ea(e){const n={streamToken:this.lastStreamToken,writes:e.map((l=>jF(this.serializer,l)))};this.q_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _Y{}class yY extends _Y{constructor(e,n,l,d){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=l,this.serializer=d,this.ia=!1}sa(){if(this.ia)throw new $n(Yt.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,n,l,d){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([f,x])=>this.connection.Go(e,g2(n,l),d,f,x))).catch((f=>{throw f.name==="FirebaseError"?(f.code===Yt.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),f):new $n(Yt.UNKNOWN,f.toString())}))}Ho(e,n,l,d,f){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([x,s])=>this.connection.Ho(e,g2(n,l),d,x,s,f))).catch((x=>{throw x.name==="FirebaseError"?(x.code===Yt.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),x):new $n(Yt.UNKNOWN,x.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class vY{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(wd(n),this.aa=!1):Qn("OnlineStateTracker",n)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vp="RemoteStore";class bY{constructor(e,n,l,d,f){this.localStore=e,this.datastore=n,this.asyncQueue=l,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=f,this.Aa.Oo((x=>{l.enqueueAndForget((async()=>{Ip(this)&&(Qn(vp,"Restarting streams for network reachability change."),await(async function(C){const P=Xr(C);P.Ea.add(4),await ib(P),P.Ra.set("Unknown"),P.Ea.delete(4),await ST(P)})(this))}))})),this.Ra=new vY(l,d)}}async function ST(t){if(Ip(t))for(const e of t.da)await e(!0)}async function ib(t){for(const e of t.da)await e(!1)}function JF(t,e){const n=Xr(t);n.Ia.has(e.targetId)||(n.Ia.set(e.targetId,e),MA(n)?OA(n):n_(n).O_()&&kA(n,e))}function RA(t,e){const n=Xr(t),l=n_(n);n.Ia.delete(e),l.O_()&&QF(n,e),n.Ia.size===0&&(l.O_()?l.L_():Ip(n)&&n.Ra.set("Unknown"))}function kA(t,e){if(t.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Ur.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}n_(t).Y_(e)}function QF(t,e){t.Va.Ue(e),n_(t).Z_(e)}function OA(t){t.Va=new pX({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),At:e=>t.Ia.get(e)||null,ht:()=>t.datastore.serializer.databaseId}),n_(t).start(),t.Ra.ua()}function MA(t){return Ip(t)&&!n_(t).x_()&&t.Ia.size>0}function Ip(t){return Xr(t).Ea.size===0}function eB(t){t.Va=void 0}async function xY(t){t.Ra.set("Online")}async function wY(t){t.Ia.forEach(((e,n)=>{kA(t,e)}))}async function TY(t,e){eB(t),MA(t)?(t.Ra.ha(e),OA(t)):t.Ra.set("Unknown")}async function SY(t,e,n){if(t.Ra.set("Online"),e instanceof BF&&e.state===2&&e.cause)try{await(async function(d,f){const x=f.cause;for(const s of f.targetIds)d.Ia.has(s)&&(await d.remoteSyncer.rejectListen(s,x),d.Ia.delete(s),d.Va.removeTarget(s))})(t,e)}catch(l){Qn(vp,"Failed to remove targets %s: %s ",e.targetIds.join(","),l),await Cw(t,l)}else if(e instanceof Wx?t.Va.Ze(e):e instanceof FF?t.Va.st(e):t.Va.tt(e),!n.isEqual(Ur.min()))try{const l=await XF(t.localStore);n.compareTo(l)>=0&&await(function(f,x){const s=f.Va.Tt(x);return s.targetChanges.forEach(((C,P)=>{if(C.resumeToken.approximateByteSize()>0){const L=f.Ia.get(P);L&&f.Ia.set(P,L.withResumeToken(C.resumeToken,x))}})),s.targetMismatches.forEach(((C,P)=>{const L=f.Ia.get(C);if(!L)return;f.Ia.set(C,L.withResumeToken(Gs.EMPTY_BYTE_STRING,L.snapshotVersion)),QF(f,C);const $=new Dh(L.target,C,P,L.sequenceNumber);kA(f,$)})),f.remoteSyncer.applyRemoteEvent(s)})(t,n)}catch(l){Qn(vp,"Failed to raise snapshot:",l),await Cw(t,l)}}async function Cw(t,e,n){if(!t_(e))throw e;t.Ea.add(1),await ib(t),t.Ra.set("Offline"),n||(n=()=>XF(t.localStore)),t.asyncQueue.enqueueRetryable((async()=>{Qn(vp,"Retrying IndexedDB access"),await n(),t.Ea.delete(1),await ST(t)}))}function tB(t,e){return e().catch((n=>Cw(t,n,e)))}async function ET(t){const e=Xr(t),n=Jh(e);let l=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:fA;for(;EY(e);)try{const d=await sY(e.localStore,l);if(d===null){e.Ta.length===0&&n.L_();break}l=d.batchId,CY(e,d)}catch(d){await Cw(e,d)}nB(e)&&rB(e)}function EY(t){return Ip(t)&&t.Ta.length<10}function CY(t,e){t.Ta.push(e);const n=Jh(t);n.O_()&&n.X_&&n.ea(e.mutations)}function nB(t){return Ip(t)&&!Jh(t).x_()&&t.Ta.length>0}function rB(t){Jh(t).start()}async function IY(t){Jh(t).ra()}async function AY(t){const e=Jh(t);for(const n of t.Ta)e.ea(n.mutations)}async function PY(t,e,n){const l=t.Ta.shift(),d=wA.from(l,e,n);await tB(t,(()=>t.remoteSyncer.applySuccessfulWrite(d))),await ET(t)}async function RY(t,e){e&&Jh(t).X_&&await(async function(l,d){if((function(x){return LF(x)&&x!==Yt.ABORTED})(d.code)){const f=l.Ta.shift();Jh(l).B_(),await tB(l,(()=>l.remoteSyncer.rejectFailedWrite(f.batchId,d))),await ET(l)}})(t,e),nB(t)&&rB(t)}async function VD(t,e){const n=Xr(t);n.asyncQueue.verifyOperationInProgress(),Qn(vp,"RemoteStore received new credentials");const l=Ip(n);n.Ea.add(3),await ib(n),l&&n.Ra.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.Ea.delete(3),await ST(n)}async function kY(t,e){const n=Xr(t);e?(n.Ea.delete(2),await ST(n)):e||(n.Ea.add(2),await ib(n),n.Ra.set("Unknown"))}function n_(t){return t.ma||(t.ma=(function(n,l,d){const f=Xr(n);return f.sa(),new mY(l,f.connection,f.authCredentials,f.appCheckCredentials,f.serializer,d)})(t.datastore,t.asyncQueue,{Xo:xY.bind(null,t),t_:wY.bind(null,t),r_:TY.bind(null,t),H_:SY.bind(null,t)}),t.da.push((async e=>{e?(t.ma.B_(),MA(t)?OA(t):t.Ra.set("Unknown")):(await t.ma.stop(),eB(t))}))),t.ma}function Jh(t){return t.fa||(t.fa=(function(n,l,d){const f=Xr(n);return f.sa(),new gY(l,f.connection,f.authCredentials,f.appCheckCredentials,f.serializer,d)})(t.datastore,t.asyncQueue,{Xo:()=>Promise.resolve(),t_:IY.bind(null,t),r_:RY.bind(null,t),ta:AY.bind(null,t),na:PY.bind(null,t)}),t.da.push((async e=>{e?(t.fa.B_(),await ET(t)):(await t.fa.stop(),t.Ta.length>0&&(Qn(vp,`Stopping write stream with ${t.Ta.length} pending writes`),t.Ta=[]))}))),t.fa}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DA{constructor(e,n,l,d,f){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=l,this.op=d,this.removalCallback=f,this.deferred=new md,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((x=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,n,l,d,f){const x=Date.now()+l,s=new DA(e,n,x,d,f);return s.start(l),s}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new $n(Yt.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function LA(t,e){if(wd("AsyncQueue",`${e}: ${t}`),t_(t))return new $n(Yt.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ig{static emptySet(e){return new Ig(e.comparator)}constructor(e){this.comparator=e?(n,l)=>e(n,l)||xr.comparator(n.key,l.key):(n,l)=>xr.comparator(n.key,l.key),this.keyedMap=cv(),this.sortedSet=new qo(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((n,l)=>(e(n),!1)))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof Ig)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),l=e.sortedSet.getIterator();for(;n.hasNext();){const d=n.getNext().key,f=l.getNext().key;if(!d.isEqual(f))return!1}return!0}toString(){const e=[];return this.forEach((n=>{e.push(n.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const l=new Ig;return l.comparator=this.comparator,l.keyedMap=e,l.sortedSet=n,l}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $D{constructor(){this.ga=new qo(xr.comparator)}track(e){const n=e.doc.key,l=this.ga.get(n);l?e.type!==0&&l.type===3?this.ga=this.ga.insert(n,e):e.type===3&&l.type!==1?this.ga=this.ga.insert(n,{type:l.type,doc:e.doc}):e.type===2&&l.type===2?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):e.type===2&&l.type===0?this.ga=this.ga.insert(n,{type:0,doc:e.doc}):e.type===1&&l.type===0?this.ga=this.ga.remove(n):e.type===1&&l.type===2?this.ga=this.ga.insert(n,{type:1,doc:l.doc}):e.type===0&&l.type===1?this.ga=this.ga.insert(n,{type:2,doc:e.doc}):Ar(63341,{Rt:e,pa:l}):this.ga=this.ga.insert(n,e)}ya(){const e=[];return this.ga.inorderTraversal(((n,l)=>{e.push(l)})),e}}class $g{constructor(e,n,l,d,f,x,s,C,P){this.query=e,this.docs=n,this.oldDocs=l,this.docChanges=d,this.mutatedKeys=f,this.fromCache=x,this.syncStateChanged=s,this.excludesMetadataChanges=C,this.hasCachedResults=P}static fromInitialDocuments(e,n,l,d,f){const x=[];return n.forEach((s=>{x.push({type:0,doc:s})})),new $g(e,n,Ig.emptySet(n),x,l,d,!0,!1,f)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&yT(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,l=e.docChanges;if(n.length!==l.length)return!1;for(let d=0;d<n.length;d++)if(n[d].type!==l[d].type||!n[d].doc.isEqual(l[d].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OY{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((e=>e.Da()))}}class MY{constructor(){this.queries=UD(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(n,l){const d=Xr(n),f=d.queries;d.queries=UD(),f.forEach(((x,s)=>{for(const C of s.Sa)C.onError(l)}))})(this,new $n(Yt.ABORTED,"Firestore shutting down"))}}function UD(){return new Cp((t=>xF(t)),yT)}async function iB(t,e){const n=Xr(t);let l=3;const d=e.query;let f=n.queries.get(d);f?!f.ba()&&e.Da()&&(l=2):(f=new OY,l=e.Da()?0:1);try{switch(l){case 0:f.wa=await n.onListen(d,!0);break;case 1:f.wa=await n.onListen(d,!1);break;case 2:await n.onFirstRemoteStoreListen(d)}}catch(x){const s=LA(x,`Initialization of query '${og(e.query)}' failed`);return void e.onError(s)}n.queries.set(d,f),f.Sa.push(e),e.va(n.onlineState),f.wa&&e.Fa(f.wa)&&zA(n)}async function oB(t,e){const n=Xr(t),l=e.query;let d=3;const f=n.queries.get(l);if(f){const x=f.Sa.indexOf(e);x>=0&&(f.Sa.splice(x,1),f.Sa.length===0?d=e.Da()?0:1:!f.ba()&&e.Da()&&(d=2))}switch(d){case 0:return n.queries.delete(l),n.onUnlisten(l,!0);case 1:return n.queries.delete(l),n.onUnlisten(l,!1);case 2:return n.onLastRemoteStoreUnlisten(l);default:return}}function DY(t,e){const n=Xr(t);let l=!1;for(const d of e){const f=d.query,x=n.queries.get(f);if(x){for(const s of x.Sa)s.Fa(d)&&(l=!0);x.wa=d}}l&&zA(n)}function LY(t,e,n){const l=Xr(t),d=l.queries.get(e);if(d)for(const f of d.Sa)f.onError(n);l.queries.delete(e)}function zA(t){t.Ca.forEach((e=>{e.next()}))}var b2,jD;(jD=b2||(b2={})).Ma="default",jD.Cache="cache";class sB{constructor(e,n,l){this.query=e,this.xa=n,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=l||{}}Fa(e){if(!this.options.includeMetadataChanges){const l=[];for(const d of e.docChanges)d.type!==3&&l.push(d);e=new $g(e.query,e.docs,e.oldDocs,l,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),n=!0):this.La(e,this.onlineState)&&(this.ka(e),n=!0),this.Na=e,n}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let n=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),n=!0),n}La(e,n){if(!e.fromCache||!this.Da())return!0;const l=n!=="Offline";return(!this.options.qa||!l)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;const n=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}ka(e){e=$g.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==b2.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aB{constructor(e){this.key=e}}class lB{constructor(e){this.key=e}}class zY{constructor(e,n){this.query=e,this.Ya=n,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=zi(),this.mutatedKeys=zi(),this.eu=wF(e),this.tu=new Ig(this.eu)}get nu(){return this.Ya}ru(e,n){const l=n?n.iu:new $D,d=n?n.tu:this.tu;let f=n?n.mutatedKeys:this.mutatedKeys,x=d,s=!1;const C=this.query.limitType==="F"&&d.size===this.query.limit?d.last():null,P=this.query.limitType==="L"&&d.size===this.query.limit?d.first():null;if(e.inorderTraversal(((L,$)=>{const V=d.get(L),j=vT(this.query,$)?$:null,ue=!!V&&this.mutatedKeys.has(V.key),de=!!j&&(j.hasLocalMutations||this.mutatedKeys.has(j.key)&&j.hasCommittedMutations);let Te=!1;V&&j?V.data.isEqual(j.data)?ue!==de&&(l.track({type:3,doc:j}),Te=!0):this.su(V,j)||(l.track({type:2,doc:j}),Te=!0,(C&&this.eu(j,C)>0||P&&this.eu(j,P)<0)&&(s=!0)):!V&&j?(l.track({type:0,doc:j}),Te=!0):V&&!j&&(l.track({type:1,doc:V}),Te=!0,(C||P)&&(s=!0)),Te&&(j?(x=x.add(j),f=de?f.add(L):f.delete(L)):(x=x.delete(L),f=f.delete(L)))})),this.query.limit!==null)for(;x.size>this.query.limit;){const L=this.query.limitType==="F"?x.last():x.first();x=x.delete(L.key),f=f.delete(L.key),l.track({type:1,doc:L})}return{tu:x,iu:l,Cs:s,mutatedKeys:f}}su(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,l,d){const f=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const x=e.iu.ya();x.sort(((L,$)=>(function(j,ue){const de=Te=>{switch(Te){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Ar(20277,{Rt:Te})}};return de(j)-de(ue)})(L.type,$.type)||this.eu(L.doc,$.doc))),this.ou(l),d=d??!1;const s=n&&!d?this._u():[],C=this.Xa.size===0&&this.current&&!d?1:0,P=C!==this.Za;return this.Za=C,x.length!==0||P?{snapshot:new $g(this.query,e.tu,f,x,e.mutatedKeys,C===0,P,!1,!!l&&l.resumeToken.approximateByteSize()>0),au:s}:{au:s}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new $D,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((n=>this.Ya=this.Ya.add(n))),e.modifiedDocuments.forEach((n=>{})),e.removedDocuments.forEach((n=>this.Ya=this.Ya.delete(n))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=zi(),this.tu.forEach((l=>{this.uu(l.key)&&(this.Xa=this.Xa.add(l.key))}));const n=[];return e.forEach((l=>{this.Xa.has(l)||n.push(new lB(l))})),this.Xa.forEach((l=>{e.has(l)||n.push(new aB(l))})),n}cu(e){this.Ya=e.Qs,this.Xa=zi();const n=this.ru(e.documents);return this.applyChanges(n,!0)}lu(){return $g.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}}const FA="SyncEngine";class FY{constructor(e,n,l){this.query=e,this.targetId=n,this.view=l}}class BY{constructor(e){this.key=e,this.hu=!1}}class NY{constructor(e,n,l,d,f,x){this.localStore=e,this.remoteStore=n,this.eventManager=l,this.sharedClientState=d,this.currentUser=f,this.maxConcurrentLimboResolutions=x,this.Pu={},this.Tu=new Cp((s=>xF(s)),yT),this.Iu=new Map,this.Eu=new Set,this.du=new qo(xr.comparator),this.Au=new Map,this.Ru=new EA,this.Vu={},this.mu=new Map,this.fu=Vg.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}}async function VY(t,e,n=!0){const l=pB(t);let d;const f=l.Tu.get(e);return f?(l.sharedClientState.addLocalQueryTarget(f.targetId),d=f.view.lu()):d=await cB(l,e,n,!0),d}async function $Y(t,e){const n=pB(t);await cB(n,e,!0,!1)}async function cB(t,e,n,l){const d=await aY(t.localStore,lu(e)),f=d.targetId,x=t.sharedClientState.addLocalQueryTarget(f,n);let s;return l&&(s=await UY(t,e,f,x==="current",d.resumeToken)),t.isPrimaryClient&&n&&JF(t.remoteStore,d),s}async function UY(t,e,n,l,d){t.pu=($,V,j)=>(async function(de,Te,Be,Ge){let Ye=Te.view.ru(Be);Ye.Cs&&(Ye=await LD(de.localStore,Te.query,!1).then((({documents:Pe})=>Te.view.ru(Pe,Ye))));const Ne=Ge&&Ge.targetChanges.get(Te.targetId),Mt=Ge&&Ge.targetMismatches.get(Te.targetId)!=null,kt=Te.view.applyChanges(Ye,de.isPrimaryClient,Ne,Mt);return HD(de,Te.targetId,kt.au),kt.snapshot})(t,$,V,j);const f=await LD(t.localStore,e,!0),x=new zY(e,f.Qs),s=x.ru(f.documents),C=rb.createSynthesizedTargetChangeForCurrentChange(n,l&&t.onlineState!=="Offline",d),P=x.applyChanges(s,t.isPrimaryClient,C);HD(t,n,P.au);const L=new FY(e,n,x);return t.Tu.set(e,L),t.Iu.has(n)?t.Iu.get(n).push(e):t.Iu.set(n,[e]),P.snapshot}async function jY(t,e,n){const l=Xr(t),d=l.Tu.get(e),f=l.Iu.get(d.targetId);if(f.length>1)return l.Iu.set(d.targetId,f.filter((x=>!yT(x,e)))),void l.Tu.delete(e);l.isPrimaryClient?(l.sharedClientState.removeLocalQueryTarget(d.targetId),l.sharedClientState.isActiveQueryTarget(d.targetId)||await y2(l.localStore,d.targetId,!1).then((()=>{l.sharedClientState.clearQueryState(d.targetId),n&&RA(l.remoteStore,d.targetId),x2(l,d.targetId)})).catch(e_)):(x2(l,d.targetId),await y2(l.localStore,d.targetId,!0))}async function GY(t,e){const n=Xr(t),l=n.Tu.get(e),d=n.Iu.get(l.targetId);n.isPrimaryClient&&d.length===1&&(n.sharedClientState.removeLocalQueryTarget(l.targetId),RA(n.remoteStore,l.targetId))}async function HY(t,e,n){const l=JY(t);try{const d=await(function(x,s){const C=Xr(x),P=Lo.now(),L=s.reduce(((j,ue)=>j.add(ue.key)),zi());let $,V;return C.persistence.runTransaction("Locally write mutations","readwrite",(j=>{let ue=Td(),de=zi();return C.Ns.getEntries(j,L).next((Te=>{ue=Te,ue.forEach(((Be,Ge)=>{Ge.isValidDocument()||(de=de.add(Be))}))})).next((()=>C.localDocuments.getOverlayedDocuments(j,ue))).next((Te=>{$=Te;const Be=[];for(const Ge of s){const Ye=lX(Ge,$.get(Ge.key).overlayedDocument);Ye!=null&&Be.push(new lf(Ge.key,Ye,fF(Ye.value.mapValue),Pa.exists(!0)))}return C.mutationQueue.addMutationBatch(j,P,Be,s)})).next((Te=>{V=Te;const Be=Te.applyToLocalDocumentSet($,de);return C.documentOverlayCache.saveOverlays(j,Te.batchId,Be)}))})).then((()=>({batchId:V.batchId,changes:SF($)})))})(l.localStore,e);l.sharedClientState.addPendingMutation(d.batchId),(function(x,s,C){let P=x.Vu[x.currentUser.toKey()];P||(P=new qo(Li)),P=P.insert(s,C),x.Vu[x.currentUser.toKey()]=P})(l,d.batchId,n),await ob(l,d.changes),await ET(l.remoteStore)}catch(d){const f=LA(d,"Failed to persist write");n.reject(f)}}async function uB(t,e){const n=Xr(t);try{const l=await iY(n.localStore,e);e.targetChanges.forEach(((d,f)=>{const x=n.Au.get(f);x&&(ji(d.addedDocuments.size+d.modifiedDocuments.size+d.removedDocuments.size<=1,22616),d.addedDocuments.size>0?x.hu=!0:d.modifiedDocuments.size>0?ji(x.hu,14607):d.removedDocuments.size>0&&(ji(x.hu,42227),x.hu=!1))})),await ob(n,l,e)}catch(l){await e_(l)}}function GD(t,e,n){const l=Xr(t);if(l.isPrimaryClient&&n===0||!l.isPrimaryClient&&n===1){const d=[];l.Tu.forEach(((f,x)=>{const s=x.view.va(e);s.snapshot&&d.push(s.snapshot)})),(function(x,s){const C=Xr(x);C.onlineState=s;let P=!1;C.queries.forEach(((L,$)=>{for(const V of $.Sa)V.va(s)&&(P=!0)})),P&&zA(C)})(l.eventManager,e),d.length&&l.Pu.H_(d),l.onlineState=e,l.isPrimaryClient&&l.sharedClientState.setOnlineState(e)}}async function WY(t,e,n){const l=Xr(t);l.sharedClientState.updateQueryState(e,"rejected",n);const d=l.Au.get(e),f=d&&d.key;if(f){let x=new qo(xr.comparator);x=x.insert(f,As.newNoDocument(f,Ur.min()));const s=zi().add(f),C=new wT(Ur.min(),new Map,new qo(Li),x,s);await uB(l,C),l.du=l.du.remove(f),l.Au.delete(e),BA(l)}else await y2(l.localStore,e,!1).then((()=>x2(l,e,n))).catch(e_)}async function qY(t,e){const n=Xr(t),l=e.batch.batchId;try{const d=await rY(n.localStore,e);hB(n,l,null),dB(n,l),n.sharedClientState.updateMutationState(l,"acknowledged"),await ob(n,d)}catch(d){await e_(d)}}async function KY(t,e,n){const l=Xr(t);try{const d=await(function(x,s){const C=Xr(x);return C.persistence.runTransaction("Reject batch","readwrite-primary",(P=>{let L;return C.mutationQueue.lookupMutationBatch(P,s).next(($=>(ji($!==null,37113),L=$.keys(),C.mutationQueue.removeMutationBatch(P,$)))).next((()=>C.mutationQueue.performConsistencyCheck(P))).next((()=>C.documentOverlayCache.removeOverlaysForBatchId(P,L,s))).next((()=>C.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(P,L))).next((()=>C.localDocuments.getDocuments(P,L)))}))})(l.localStore,e);hB(l,e,n),dB(l,e),l.sharedClientState.updateMutationState(e,"rejected",n),await ob(l,d)}catch(d){await e_(d)}}function dB(t,e){(t.mu.get(e)||[]).forEach((n=>{n.resolve()})),t.mu.delete(e)}function hB(t,e,n){const l=Xr(t);let d=l.Vu[l.currentUser.toKey()];if(d){const f=d.get(e);f&&(n?f.reject(n):f.resolve(),d=d.remove(e)),l.Vu[l.currentUser.toKey()]=d}}function x2(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const l of t.Iu.get(e))t.Tu.delete(l),n&&t.Pu.yu(l,n);t.Iu.delete(e),t.isPrimaryClient&&t.Ru.jr(e).forEach((l=>{t.Ru.containsKey(l)||fB(t,l)}))}function fB(t,e){t.Eu.delete(e.path.canonicalString());const n=t.du.get(e);n!==null&&(RA(t.remoteStore,n),t.du=t.du.remove(e),t.Au.delete(n),BA(t))}function HD(t,e,n){for(const l of n)l instanceof aB?(t.Ru.addReference(l.key,e),ZY(t,l)):l instanceof lB?(Qn(FA,"Document no longer in limbo: "+l.key),t.Ru.removeReference(l.key,e),t.Ru.containsKey(l.key)||fB(t,l.key)):Ar(19791,{wu:l})}function ZY(t,e){const n=e.key,l=n.path.canonicalString();t.du.get(n)||t.Eu.has(l)||(Qn(FA,"New document in limbo: "+n),t.Eu.add(l),BA(t))}function BA(t){for(;t.Eu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){const e=t.Eu.values().next().value;t.Eu.delete(e);const n=new xr(bo.fromString(e)),l=t.fu.next();t.Au.set(l,new BY(n)),t.du=t.du.insert(n,l),JF(t.remoteStore,new Dh(lu(yA(n.path)),l,"TargetPurposeLimboResolution",gT.ce))}}async function ob(t,e,n){const l=Xr(t),d=[],f=[],x=[];l.Tu.isEmpty()||(l.Tu.forEach(((s,C)=>{x.push(l.pu(C,e,n).then((P=>{if((P||n)&&l.isPrimaryClient){const L=P?!P.fromCache:n?.targetChanges.get(C.targetId)?.current;l.sharedClientState.updateQueryState(C.targetId,L?"current":"not-current")}if(P){d.push(P);const L=IA.As(C.targetId,P);f.push(L)}})))})),await Promise.all(x),l.Pu.H_(d),await(async function(C,P){const L=Xr(C);try{await L.persistence.runTransaction("notifyLocalViewChanges","readwrite",($=>nn.forEach(P,(V=>nn.forEach(V.Es,(j=>L.persistence.referenceDelegate.addReference($,V.targetId,j))).next((()=>nn.forEach(V.ds,(j=>L.persistence.referenceDelegate.removeReference($,V.targetId,j)))))))))}catch($){if(!t_($))throw $;Qn(AA,"Failed to update sequence numbers: "+$)}for(const $ of P){const V=$.targetId;if(!$.fromCache){const j=L.Ms.get(V),ue=j.snapshotVersion,de=j.withLastLimboFreeSnapshotVersion(ue);L.Ms=L.Ms.insert(V,de)}}})(l.localStore,f))}async function XY(t,e){const n=Xr(t);if(!n.currentUser.isEqual(e)){Qn(FA,"User change. New user:",e.toKey());const l=await ZF(n.localStore,e);n.currentUser=e,(function(f,x){f.mu.forEach((s=>{s.forEach((C=>{C.reject(new $n(Yt.CANCELLED,x))}))})),f.mu.clear()})(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,l.removedBatchIds,l.addedBatchIds),await ob(n,l.Ls)}}function YY(t,e){const n=Xr(t),l=n.Au.get(e);if(l&&l.hu)return zi().add(l.key);{let d=zi();const f=n.Iu.get(e);if(!f)return d;for(const x of f){const s=n.Tu.get(x);d=d.unionWith(s.view.nu)}return d}}function pB(t){const e=Xr(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=uB.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=YY.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=WY.bind(null,e),e.Pu.H_=DY.bind(null,e.eventManager),e.Pu.yu=LY.bind(null,e.eventManager),e}function JY(t){const e=Xr(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=qY.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=KY.bind(null,e),e}class Iw{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=TT(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,n){return null}Mu(e,n){return null}vu(e){return nY(this.persistence,new QX,e.initialUser,this.serializer)}Cu(e){return new KF(CA.mi,this.serializer)}Du(e){return new cY}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Iw.provider={build:()=>new Iw};class QY extends Iw{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,n){ji(this.persistence.referenceDelegate instanceof Ew,46915);const l=this.persistence.referenceDelegate.garbageCollector;return new BX(l,e.asyncQueue,n)}Cu(e){const n=this.cacheSizeBytes!==void 0?$a.withCacheSize(this.cacheSizeBytes):$a.DEFAULT;return new KF((l=>Ew.mi(l,n)),this.serializer)}}class w2{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=l=>GD(this.syncEngine,l,1),this.remoteStore.remoteSyncer.handleCredentialChange=XY.bind(null,this.syncEngine),await kY(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new MY})()}createDatastore(e){const n=TT(e.databaseInfo.databaseId),l=(function(f){return new pY(f)})(e.databaseInfo);return(function(f,x,s,C){return new yY(f,x,s,C)})(e.authCredentials,e.appCheckCredentials,l,n)}createRemoteStore(e){return(function(l,d,f,x,s){return new bY(l,d,f,x,s)})(this.localStore,this.datastore,e.asyncQueue,(n=>GD(this.syncEngine,n,0)),(function(){return BD.v()?new BD:new uY})())}createSyncEngine(e,n){return(function(d,f,x,s,C,P,L){const $=new NY(d,f,x,s,C,P);return L&&($.gu=!0),$})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){await(async function(n){const l=Xr(n);Qn(vp,"RemoteStore shutting down."),l.Ea.add(5),await ib(l),l.Aa.shutdown(),l.Ra.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}w2.provider={build:()=>new w2};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mB{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):wd("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,n){setTimeout((()=>{this.muted||e(n)}),0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eJ{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new $n(Yt.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;const n=await(async function(d,f){const x=Xr(d),s={documents:f.map(($=>Sw(x.serializer,$)))},C=await x.Ho("BatchGetDocuments",x.serializer.databaseId,bo.emptyPath(),s,f.length),P=new Map;C.forEach(($=>{const V=xX(x.serializer,$);P.set(V.key.toString(),V)}));const L=[];return f.forEach(($=>{const V=P.get($.toString());ji(!!V,55234,{key:$}),L.push(V)})),L})(this.datastore,e);return n.forEach((l=>this.recordVersion(l))),n}set(e,n){this.write(n.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,n){try{this.write(n.toMutation(e,this.preconditionForUpdate(e)))}catch(l){this.lastTransactionError=l}this.writtenDocs.add(e.toString())}delete(e){this.write(new xA(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;const e=this.readVersions;this.mutations.forEach((n=>{e.delete(n.key.toString())})),e.forEach(((n,l)=>{const d=xr.fromPath(l);this.mutations.push(new DF(d,this.precondition(d)))})),await(async function(l,d){const f=Xr(l),x={writes:d.map((s=>jF(f.serializer,s)))};await f.Go("Commit",f.serializer.databaseId,bo.emptyPath(),x)})(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let n;if(e.isFoundDocument())n=e.version;else{if(!e.isNoDocument())throw Ar(50498,{Gu:e.constructor.name});n=Ur.min()}const l=this.readVersions.get(e.key.toString());if(l){if(!n.isEqual(l))throw new $n(Yt.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),n)}precondition(e){const n=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&n?n.isEqual(Ur.min())?Pa.exists(!1):Pa.updateTime(n):Pa.none()}preconditionForUpdate(e){const n=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&n){if(n.isEqual(Ur.min()))throw new $n(Yt.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Pa.updateTime(n)}return Pa.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tJ{constructor(e,n,l,d,f){this.asyncQueue=e,this.datastore=n,this.options=l,this.updateFunction=d,this.deferred=f,this.zu=l.maxAttempts,this.M_=new PA(this.asyncQueue,"transaction_retry")}ju(){this.zu-=1,this.Ju()}Ju(){this.M_.p_((async()=>{const e=new eJ(this.datastore),n=this.Hu(e);n&&n.then((l=>{this.asyncQueue.enqueueAndForget((()=>e.commit().then((()=>{this.deferred.resolve(l)})).catch((d=>{this.Yu(d)}))))})).catch((l=>{this.Yu(l)}))}))}Hu(e){try{const n=this.updateFunction(e);return!eb(n)&&n.catch&&n.then?n:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(n){return this.deferred.reject(n),null}}Yu(e){this.zu>0&&this.Zu(e)?(this.zu-=1,this.asyncQueue.enqueueAndForget((()=>(this.Ju(),Promise.resolve())))):this.deferred.reject(e)}Zu(e){if(e?.name==="FirebaseError"){const n=e.code;return n==="aborted"||n==="failed-precondition"||n==="already-exists"||!LF(n)}return!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qh="FirestoreClient";class nJ{constructor(e,n,l,d,f){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=l,this.databaseInfo=d,this.user=ra.UNAUTHENTICATED,this.clientId=hA.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=f,this.authCredentials.start(l,(async x=>{Qn(Qh,"Received user=",x.uid),await this.authCredentialListener(x),this.user=x})),this.appCheckCredentials.start(l,(x=>(Qn(Qh,"Received new app check token=",x),this.appCheckCredentialListener(x,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new md;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const l=LA(n,"Failed to shutdown persistence");e.reject(l)}})),e.promise}}async function _C(t,e){t.asyncQueue.verifyOperationInProgress(),Qn(Qh,"Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let l=n.initialUser;t.setCredentialChangeListener((async d=>{l.isEqual(d)||(await ZF(e.localStore,d),l=d)})),e.persistence.setDatabaseDeletedListener((()=>t.terminate())),t._offlineComponents=e}async function WD(t,e){t.asyncQueue.verifyOperationInProgress();const n=await rJ(t);Qn(Qh,"Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener((l=>VD(e.remoteStore,l))),t.setAppCheckTokenChangeListener(((l,d)=>VD(e.remoteStore,d))),t._onlineComponents=e}async function rJ(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){Qn(Qh,"Using user provided OfflineComponentProvider");try{await _C(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!(function(d){return d.name==="FirebaseError"?d.code===Yt.FAILED_PRECONDITION||d.code===Yt.UNIMPLEMENTED:!(typeof DOMException<"u"&&d instanceof DOMException)||d.code===22||d.code===20||d.code===11})(n))throw n;Lg("Error using user provided cache. Falling back to memory cache: "+n),await _C(t,new Iw)}}else Qn(Qh,"Using default OfflineComponentProvider"),await _C(t,new QY(void 0));return t._offlineComponents}async function NA(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(Qn(Qh,"Using user provided OnlineComponentProvider"),await WD(t,t._uninitializedComponentsProvider._online)):(Qn(Qh,"Using default OnlineComponentProvider"),await WD(t,new w2))),t._onlineComponents}function iJ(t){return NA(t).then((e=>e.syncEngine))}function oJ(t){return NA(t).then((e=>e.datastore))}async function T2(t){const e=await NA(t),n=e.eventManager;return n.onListen=VY.bind(null,e.syncEngine),n.onUnlisten=jY.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=$Y.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=GY.bind(null,e.syncEngine),n}function sJ(t,e,n={}){const l=new md;return t.asyncQueue.enqueueAndForget((async()=>(function(f,x,s,C,P){const L=new mB({next:V=>{L.Nu(),x.enqueueAndForget((()=>oB(f,$))),V.fromCache&&C.source==="server"?P.reject(new $n(Yt.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):P.resolve(V)},error:V=>P.reject(V)}),$=new sB(s,L,{includeMetadataChanges:!0,qa:!0});return iB(f,$)})(await T2(t),t.asyncQueue,e,n,l))),l.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gB(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qD=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _B="firestore.googleapis.com",KD=!0;class ZD{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new $n(Yt.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=_B,this.ssl=KD}else this.host=e.host,this.ssl=e.ssl??KD;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=qF;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<zX)throw new $n(Yt.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}TZ("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=gB(e.experimentalLongPollingOptions??{}),(function(l){if(l.timeoutSeconds!==void 0){if(isNaN(l.timeoutSeconds))throw new $n(Yt.INVALID_ARGUMENT,`invalid long polling timeout: ${l.timeoutSeconds} (must not be NaN)`);if(l.timeoutSeconds<5)throw new $n(Yt.INVALID_ARGUMENT,`invalid long polling timeout: ${l.timeoutSeconds} (minimum allowed value is 5)`);if(l.timeoutSeconds>30)throw new $n(Yt.INVALID_ARGUMENT,`invalid long polling timeout: ${l.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(l,d){return l.timeoutSeconds===d.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class CT{constructor(e,n,l,d){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=l,this._app=d,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new ZD({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new $n(Yt.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new $n(Yt.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new ZD(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(l){if(!l)return new fZ;switch(l.type){case"firstParty":return new _Z(l.sessionIndex||"0",l.iamToken||null,l.authTokenFactory||null);case"provider":return l.client;default:throw new $n(Yt.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(n){const l=qD.get(n);l&&(Qn("ComponentProvider","Removing Datastore"),qD.delete(n),l.terminate())})(this),Promise.resolve()}}function aJ(t,e,n,l={}){t=au(t,CT);const d=Ad(e),f=t._getSettings(),x={...f,emulatorOptions:t._getEmulatorOptions()},s=`${e}:${n}`;d&&(lT(`https://${s}`),cT("Firestore",!0)),f.host!==_B&&f.host!==s&&Lg("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const C={...f,host:s,ssl:d,emulatorOptions:l};if(!Hh(C,x)&&(t._setSettings(C),l.mockUserToken)){let P,L;if(typeof l.mockUserToken=="string")P=l.mockUserToken,L=ra.MOCK_USER;else{P=Q6(l.mockUserToken,t._app?.options.projectId);const $=l.mockUserToken.sub||l.mockUserToken.user_id;if(!$)throw new $n(Yt.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");L=new ra($)}t._authCredentials=new pZ(new tF(P,L))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ap{constructor(e,n,l){this.converter=n,this._query=l,this.type="query",this.firestore=e}withConverter(e){return new Ap(this.firestore,e,this._query)}}class es{constructor(e,n,l){this.converter=n,this._key=l,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new $h(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new es(this.firestore,e,this._key)}toJSON(){return{type:es._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,n,l){if(Q0(n,es._jsonSchema))return new es(e,l||null,new xr(bo.fromString(n.referencePath)))}}es._jsonSchemaVersion="firestore/documentReference/1.0",es._jsonSchema={type:ls("string",es._jsonSchemaVersion),referencePath:ls("string")};class $h extends Ap{constructor(e,n,l){super(e,n,yA(l)),this._path=l,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new es(this.firestore,null,new xr(e))}withConverter(e){return new $h(this.firestore,e,this._path)}}function Aw(t,e,...n){if(t=zo(t),nF("collection","path",e),t instanceof CT){const l=bo.fromString(e,...n);return lD(l),new $h(t,null,l)}{if(!(t instanceof es||t instanceof $h))throw new $n(Yt.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const l=t._path.child(bo.fromString(e,...n));return lD(l),new $h(t.firestore,null,l)}}function kv(t,e,...n){if(t=zo(t),arguments.length===1&&(e=hA.newId()),nF("doc","path",e),t instanceof CT){const l=bo.fromString(e,...n);return aD(l),new es(t,null,new xr(l))}{if(!(t instanceof es||t instanceof $h))throw new $n(Yt.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const l=t._path.child(bo.fromString(e,...n));return aD(l),new es(t.firestore,t instanceof $h?t.converter:null,new xr(l))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XD="AsyncQueue";class YD{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new PA(this,"async_queue_retry"),this._c=()=>{const l=gC();l&&Qn(XD,"Visibility state changed to "+l.visibilityState),this.M_.w_()},this.ac=e;const n=gC();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const n=gC();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const n=new md;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise))).then((()=>n.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!t_(e))throw e;Qn(XD,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const n=this.ac.then((()=>(this.rc=!0,e().catch((l=>{throw this.nc=l,this.rc=!1,wd("INTERNAL UNHANDLED ERROR: ",JD(l)),l})).then((l=>(this.rc=!1,l))))));return this.ac=n,n}enqueueAfterDelay(e,n,l){this.uc(),this.oc.indexOf(e)>-1&&(n=0);const d=DA.createAndSchedule(this,e,n,l,(f=>this.hc(f)));return this.tc.push(d),d}uc(){this.nc&&Ar(47125,{Pc:JD(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(const n of this.tc)if(n.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((n,l)=>n.targetTimeMs-l.targetTimeMs));for(const n of this.tc)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const n=this.tc.indexOf(e);this.tc.splice(n,1)}}function JD(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QD(t){return(function(n,l){if(typeof n!="object"||n===null)return!1;const d=n;for(const f of l)if(f in d&&typeof d[f]=="function")return!0;return!1})(t,["next","error","complete"])}class bp extends CT{constructor(e,n,l,d){super(e,n,l,d),this.type="firestore",this._queue=new YD,this._persistenceKey=d?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new YD(e),this._firestoreClient=void 0,await e}}}function lJ(t,e){const n=typeof t=="object"?t:K0(),l=typeof t=="string"?t:vw,d=Sp(n,"firestore").getImmediate({identifier:l});if(!d._initialized){const f=YI("firestore");f&&aJ(d,...f)}return d}function IT(t){if(t._terminated)throw new $n(Yt.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||cJ(t),t._firestoreClient}function cJ(t){const e=t._freezeSettings(),n=(function(d,f,x,s){return new DZ(d,f,x,s.host,s.ssl,s.experimentalForceLongPolling,s.experimentalAutoDetectLongPolling,gB(s.experimentalLongPollingOptions),s.useFetchStreams,s.isUsingEmulator)})(t._databaseId,t._app?.options.appId||"",t._persistenceKey,e);t._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(t._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),t._firestoreClient=new nJ(t._authCredentials,t._appCheckCredentials,t._queue,n,t._componentsProvider&&(function(d){const f=d?._online.build();return{_offline:d?._offline.build(f),_online:f}})(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class al{constructor(e){this._byteString=e}static fromBase64String(e){try{return new al(Gs.fromBase64String(e))}catch(n){throw new $n(Yt.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new al(Gs.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:al._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Q0(e,al._jsonSchema))return al.fromBase64String(e.bytes)}}al._jsonSchemaVersion="firestore/bytes/1.0",al._jsonSchema={type:ls("string",al._jsonSchemaVersion),bytes:ls("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sb{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new $n(Yt.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Us(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class r_{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cu{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new $n(Yt.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new $n(Yt.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Li(this._lat,e._lat)||Li(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:cu._jsonSchemaVersion}}static fromJSON(e){if(Q0(e,cu._jsonSchema))return new cu(e.latitude,e.longitude)}}cu._jsonSchemaVersion="firestore/geoPoint/1.0",cu._jsonSchema={type:ls("string",cu._jsonSchemaVersion),latitude:ls("number"),longitude:ls("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uu{constructor(e){this._values=(e||[]).map((n=>n))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(l,d){if(l.length!==d.length)return!1;for(let f=0;f<l.length;++f)if(l[f]!==d[f])return!1;return!0})(this._values,e._values)}toJSON(){return{type:uu._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Q0(e,uu._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((n=>typeof n=="number")))return new uu(e.vectorValues);throw new $n(Yt.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}uu._jsonSchemaVersion="firestore/vectorValue/1.0",uu._jsonSchema={type:ls("string",uu._jsonSchemaVersion),vectorValues:ls("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uJ=/^__.*__$/;class dJ{constructor(e,n,l){this.data=e,this.fieldMask=n,this.fieldTransforms=l}toMutation(e,n){return this.fieldMask!==null?new lf(e,this.data,this.fieldMask,n,this.fieldTransforms):new nb(e,this.data,n,this.fieldTransforms)}}class yB{constructor(e,n,l){this.data=e,this.fieldMask=n,this.fieldTransforms=l}toMutation(e,n){return new lf(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function vB(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Ar(40011,{Ac:t})}}class AT{constructor(e,n,l,d,f,x){this.settings=e,this.databaseId=n,this.serializer=l,this.ignoreUndefinedProperties=d,f===void 0&&this.Rc(),this.fieldTransforms=f||[],this.fieldMask=x||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new AT({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){const n=this.path?.child(e),l=this.Vc({path:n,fc:!1});return l.gc(e),l}yc(e){const n=this.path?.child(e),l=this.Vc({path:n,fc:!1});return l.Rc(),l}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return Pw(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find((n=>e.isPrefixOf(n)))!==void 0||this.fieldTransforms.find((n=>e.isPrefixOf(n.field)))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(vB(this.Ac)&&uJ.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class hJ{constructor(e,n,l){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=l||TT(e)}Cc(e,n,l,d=!1){return new AT({Ac:e,methodName:n,Dc:l,path:Us.emptyPath(),fc:!1,bc:d},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function PT(t){const e=t._freezeSettings(),n=TT(t._databaseId);return new hJ(t._databaseId,!!e.ignoreUndefinedProperties,n)}function bB(t,e,n,l,d,f={}){const x=t.Cc(f.merge||f.mergeFields?2:0,e,n,d);jA("Data must be an object, but it was:",x,l);const s=TB(l,x);let C,P;if(f.merge)C=new cl(x.fieldMask),P=x.fieldTransforms;else if(f.mergeFields){const L=[];for(const $ of f.mergeFields){const V=S2(e,$,n);if(!x.contains(V))throw new $n(Yt.INVALID_ARGUMENT,`Field '${V}' is specified in your field mask but missing from your input data.`);EB(L,V)||L.push(V)}C=new cl(L),P=x.fieldTransforms.filter(($=>C.covers($.field)))}else C=null,P=x.fieldTransforms;return new dJ(new Aa(s),C,P)}class RT extends r_{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof RT}}function fJ(t,e,n){return new AT({Ac:3,Dc:e.settings.Dc,methodName:t._methodName,fc:n},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class VA extends r_{_toFieldTransform(e){return new bA(e.path,new n0)}isEqual(e){return e instanceof VA}}class $A extends r_{constructor(e,n){super(e),this.vc=n}_toFieldTransform(e){const n=fJ(this,e,!0),l=this.vc.map((f=>i_(f,n))),d=new Ng(l);return new bA(e.path,d)}isEqual(e){return e instanceof $A&&Hh(this.vc,e.vc)}}class UA extends r_{constructor(e,n){super(e),this.Fc=n}_toFieldTransform(e){const n=new i0(e.serializer,IF(e.serializer,this.Fc));return new bA(e.path,n)}isEqual(e){return e instanceof UA&&this.Fc===e.Fc}}function xB(t,e,n,l){const d=t.Cc(1,e,n);jA("Data must be an object, but it was:",d,l);const f=[],x=Aa.empty();af(l,((C,P)=>{const L=GA(e,C,n);P=zo(P);const $=d.yc(L);if(P instanceof RT)f.push(L);else{const V=i_(P,$);V!=null&&(f.push(L),x.set(L,V))}}));const s=new cl(f);return new yB(x,s,d.fieldTransforms)}function wB(t,e,n,l,d,f){const x=t.Cc(1,e,n),s=[S2(e,l,n)],C=[d];if(f.length%2!=0)throw new $n(Yt.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let V=0;V<f.length;V+=2)s.push(S2(e,f[V])),C.push(f[V+1]);const P=[],L=Aa.empty();for(let V=s.length-1;V>=0;--V)if(!EB(P,s[V])){const j=s[V];let ue=C[V];ue=zo(ue);const de=x.yc(j);if(ue instanceof RT)P.push(j);else{const Te=i_(ue,de);Te!=null&&(P.push(j),L.set(j,Te))}}const $=new cl(P);return new yB(L,$,x.fieldTransforms)}function pJ(t,e,n,l=!1){return i_(n,t.Cc(l?4:3,e))}function i_(t,e){if(SB(t=zo(t)))return jA("Unsupported field value:",e,t),TB(t,e);if(t instanceof r_)return(function(l,d){if(!vB(d.Ac))throw d.Sc(`${l._methodName}() can only be used with update() and set()`);if(!d.path)throw d.Sc(`${l._methodName}() is not currently supported inside arrays`);const f=l._toFieldTransform(d);f&&d.fieldTransforms.push(f)})(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return(function(l,d){const f=[];let x=0;for(const s of l){let C=i_(s,d.wc(x));C==null&&(C={nullValue:"NULL_VALUE"}),f.push(C),x++}return{arrayValue:{values:f}}})(t,e)}return(function(l,d){if((l=zo(l))===null)return{nullValue:"NULL_VALUE"};if(typeof l=="number")return IF(d.serializer,l);if(typeof l=="boolean")return{booleanValue:l};if(typeof l=="string")return{stringValue:l};if(l instanceof Date){const f=Lo.fromDate(l);return{timestampValue:Tw(d.serializer,f)}}if(l instanceof Lo){const f=new Lo(l.seconds,1e3*Math.floor(l.nanoseconds/1e3));return{timestampValue:Tw(d.serializer,f)}}if(l instanceof cu)return{geoPointValue:{latitude:l.latitude,longitude:l.longitude}};if(l instanceof al)return{bytesValue:NF(d.serializer,l._byteString)};if(l instanceof es){const f=d.databaseId,x=l.firestore._databaseId;if(!x.isEqual(f))throw d.Sc(`Document reference is for database ${x.projectId}/${x.database} but should be for database ${f.projectId}/${f.database}`);return{referenceValue:SA(l.firestore._databaseId||d.databaseId,l._key.path)}}if(l instanceof uu)return(function(x,s){return{mapValue:{fields:{[dF]:{stringValue:hF},[bw]:{arrayValue:{values:x.toArray().map((P=>{if(typeof P!="number")throw s.Sc("VectorValues must only contain numeric values.");return vA(s.serializer,P)}))}}}}}})(l,d);throw d.Sc(`Unsupported field value: ${mT(l)}`)})(t,e)}function TB(t,e){const n={};return oF(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):af(t,((l,d)=>{const f=i_(d,e.mc(l));f!=null&&(n[l]=f)})),{mapValue:{fields:n}}}function SB(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof Lo||t instanceof cu||t instanceof al||t instanceof es||t instanceof r_||t instanceof uu)}function jA(t,e,n){if(!SB(n)||!rF(n)){const l=mT(n);throw l==="an object"?e.Sc(t+" a custom object"):e.Sc(t+" "+l)}}function S2(t,e,n){if((e=zo(e))instanceof sb)return e._internalPath;if(typeof e=="string")return GA(t,e);throw Pw("Field path arguments must be of type string or ",t,!1,void 0,n)}const mJ=new RegExp("[~\\*/\\[\\]]");function GA(t,e,n){if(e.search(mJ)>=0)throw Pw(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new sb(...e.split("."))._internalPath}catch{throw Pw(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function Pw(t,e,n,l,d){const f=l&&!l.isEmpty(),x=d!==void 0;let s=`Function ${e}() called with invalid data`;n&&(s+=" (via `toFirestore()`)"),s+=". ";let C="";return(f||x)&&(C+=" (found",f&&(C+=` in field ${l}`),x&&(C+=` in document ${d}`),C+=")"),new $n(Yt.INVALID_ARGUMENT,s+t+C)}function EB(t,e){return t.some((n=>n.isEqual(e)))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rw{constructor(e,n,l,d,f){this._firestore=e,this._userDataWriter=n,this._key=l,this._document=d,this._converter=f}get id(){return this._key.path.lastSegment()}get ref(){return new es(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new gJ(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(HA("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class gJ extends Rw{data(){return super.data()}}function HA(t,e){return typeof e=="string"?GA(t,e):e instanceof sb?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function CB(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new $n(Yt.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class WA{}class _J extends WA{}function eL(t,e,...n){let l=[];e instanceof WA&&l.push(e),l=l.concat(n),(function(f){const x=f.filter((C=>C instanceof qA)).length,s=f.filter((C=>C instanceof kT)).length;if(x>1||x>0&&s>0)throw new $n(Yt.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(l);for(const d of l)t=d._apply(t);return t}class kT extends _J{constructor(e,n,l){super(),this._field=e,this._op=n,this._value=l,this.type="where"}static _create(e,n,l){return new kT(e,n,l)}_apply(e){const n=this._parse(e);return IB(e._query,n),new Ap(e.firestore,e.converter,f2(e._query,n))}_parse(e){const n=PT(e.firestore);return(function(f,x,s,C,P,L,$){let V;if(P.isKeyField()){if(L==="array-contains"||L==="array-contains-any")throw new $n(Yt.INVALID_ARGUMENT,`Invalid Query. You can't perform '${L}' queries on documentId().`);if(L==="in"||L==="not-in"){rL($,L);const ue=[];for(const de of $)ue.push(nL(C,f,de));V={arrayValue:{values:ue}}}else V=nL(C,f,$)}else L!=="in"&&L!=="not-in"&&L!=="array-contains-any"||rL($,L),V=pJ(s,x,$,L==="in"||L==="not-in");return as.create(P,L,V)})(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function tL(t,e,n){const l=e,d=HA("where",t);return kT._create(d,l,n)}class qA extends WA{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new qA(e,n)}_parse(e){const n=this._queryConstraints.map((l=>l._parse(e))).filter((l=>l.getFilters().length>0));return n.length===1?n[0]:yc.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:((function(d,f){let x=d;const s=f.getFlattenedFilters();for(const C of s)IB(x,C),x=f2(x,C)})(e._query,n),new Ap(e.firestore,e.converter,f2(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function nL(t,e,n){if(typeof(n=zo(n))=="string"){if(n==="")throw new $n(Yt.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!bF(e)&&n.indexOf("/")!==-1)throw new $n(Yt.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const l=e.path.child(bo.fromString(n));if(!xr.isDocumentKey(l))throw new $n(Yt.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${l}' is not because it has an odd number of segments (${l.length}).`);return gD(t,new xr(l))}if(n instanceof es)return gD(t,n._key);throw new $n(Yt.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${mT(n)}.`)}function rL(t,e){if(!Array.isArray(t)||t.length===0)throw new $n(Yt.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function IB(t,e){const n=(function(d,f){for(const x of d)for(const s of x.getFlattenedFilters())if(f.indexOf(s.op)>=0)return s.op;return null})(t.filters,(function(d){switch(d){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(n!==null)throw n===e.op?new $n(Yt.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new $n(Yt.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class AB{convertValue(e,n="none"){switch(Yh(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Qo(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(Xh(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw Ar(62114,{value:e})}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const l={};return af(e,((d,f)=>{l[d]=this.convertValue(f,n)})),l}convertVectorValue(e){const n=e.fields?.[bw].arrayValue?.values?.map((l=>Qo(l.doubleValue)));return new uu(n)}convertGeoPoint(e){return new cu(Qo(e.latitude),Qo(e.longitude))}convertArray(e,n){return(e.values||[]).map((l=>this.convertValue(l,n)))}convertServerTimestamp(e,n){switch(n){case"previous":const l=_T(e);return l==null?null:this.convertValue(l,n);case"estimate":return this.convertTimestamp(Qv(e));default:return null}}convertTimestamp(e){const n=Zh(e);return new Lo(n.seconds,n.nanos)}convertDocumentKey(e,n){const l=bo.fromString(e);ji(WF(l),9688,{name:e});const d=new e0(l.get(1),l.get(3)),f=new xr(l.popFirst(5));return d.isEqual(n)||wd(`Document ${f} contains a document reference within a different database (${d.projectId}/${d.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),f}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PB(t,e,n){let l;return l=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,l}class yJ extends AB{constructor(e){super(),this.firestore=e}convertBytes(e){return new al(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new es(this.firestore,null,n)}}class mg{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Uh extends Rw{constructor(e,n,l,d,f,x){super(e,n,l,d,x),this._firestore=e,this._firestoreImpl=e,this.metadata=f}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new qx(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const l=this._document.data.field(HA("DocumentSnapshot.get",e));if(l!==null)return this._userDataWriter.convertValue(l,n.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new $n(Yt.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,n={};return n.type=Uh._jsonSchemaVersion,n.bundle="",n.bundleSource="DocumentSnapshot",n.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?n:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),n.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),n)}}Uh._jsonSchemaVersion="firestore/documentSnapshot/1.0",Uh._jsonSchema={type:ls("string",Uh._jsonSchemaVersion),bundleSource:ls("string","DocumentSnapshot"),bundleName:ls("string"),bundle:ls("string")};class qx extends Uh{data(e={}){return super.data(e)}}class dp{constructor(e,n,l,d){this._firestore=e,this._userDataWriter=n,this._snapshot=d,this.metadata=new mg(d.hasPendingWrites,d.fromCache),this.query=l}get docs(){const e=[];return this.forEach((n=>e.push(n))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach((l=>{e.call(n,new qx(this._firestore,this._userDataWriter,l.key,l,new mg(this._snapshot.mutatedKeys.has(l.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new $n(Yt.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=(function(d,f){if(d._snapshot.oldDocs.isEmpty()){let x=0;return d._snapshot.docChanges.map((s=>{const C=new qx(d._firestore,d._userDataWriter,s.doc.key,s.doc,new mg(d._snapshot.mutatedKeys.has(s.doc.key),d._snapshot.fromCache),d.query.converter);return s.doc,{type:"added",doc:C,oldIndex:-1,newIndex:x++}}))}{let x=d._snapshot.oldDocs;return d._snapshot.docChanges.filter((s=>f||s.type!==3)).map((s=>{const C=new qx(d._firestore,d._userDataWriter,s.doc.key,s.doc,new mg(d._snapshot.mutatedKeys.has(s.doc.key),d._snapshot.fromCache),d.query.converter);let P=-1,L=-1;return s.type!==0&&(P=x.indexOf(s.doc.key),x=x.delete(s.doc.key)),s.type!==1&&(x=x.add(s.doc),L=x.indexOf(s.doc.key)),{type:vJ(s.type),doc:C,oldIndex:P,newIndex:L}}))}})(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new $n(Yt.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=dp._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=hA.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const n=[],l=[],d=[];return this.docs.forEach((f=>{f._document!==null&&(n.push(f._document),l.push(this._userDataWriter.convertObjectMap(f._document.data.value.mapValue.fields,"previous")),d.push(f.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function vJ(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Ar(61501,{type:t})}}dp._jsonSchemaVersion="firestore/querySnapshot/1.0",dp._jsonSchema={type:ls("string",dp._jsonSchemaVersion),bundleSource:ls("string","QuerySnapshot"),bundleName:ls("string"),bundle:ls("string")};class OT extends AB{constructor(e){super(),this.firestore=e}convertBytes(e){return new al(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new es(this.firestore,null,n)}}function iL(t){t=au(t,Ap);const e=au(t.firestore,bp),n=IT(e),l=new OT(e);return CB(t._query),sJ(n,t._query).then((d=>new dp(e,l,t,d)))}function bJ(t,e,n,...l){t=au(t,es);const d=au(t.firestore,bp),f=PT(d);let x;return x=typeof(e=zo(e))=="string"||e instanceof sb?wB(f,"updateDoc",t._key,e,n,l):xB(f,"updateDoc",t._key,e),RB(d,[x.toMutation(t._key,Pa.exists(!0))])}function xJ(t,e){const n=au(t.firestore,bp),l=kv(t),d=PB(t.converter,e);return RB(n,[bB(PT(t.firestore),"addDoc",l._key,d,t.converter!==null,{}).toMutation(l._key,Pa.exists(!1))]).then((()=>l))}function wJ(t,...e){t=zo(t);let n={includeMetadataChanges:!1,source:"default"},l=0;typeof e[l]!="object"||QD(e[l])||(n=e[l++]);const d={includeMetadataChanges:n.includeMetadataChanges,source:n.source};if(QD(e[l])){const C=e[l];e[l]=C.next?.bind(C),e[l+1]=C.error?.bind(C),e[l+2]=C.complete?.bind(C)}let f,x,s;if(t instanceof es)x=au(t.firestore,bp),s=yA(t._key.path),f={next:C=>{e[l]&&e[l](TJ(x,t,C))},error:e[l+1],complete:e[l+2]};else{const C=au(t,Ap);x=au(C.firestore,bp),s=C._query;const P=new OT(x);f={next:L=>{e[l]&&e[l](new dp(x,P,C,L))},error:e[l+1],complete:e[l+2]},CB(t._query)}return(function(P,L,$,V){const j=new mB(V),ue=new sB(L,j,$);return P.asyncQueue.enqueueAndForget((async()=>iB(await T2(P),ue))),()=>{j.Nu(),P.asyncQueue.enqueueAndForget((async()=>oB(await T2(P),ue)))}})(IT(x),s,d,f)}function RB(t,e){return(function(l,d){const f=new md;return l.asyncQueue.enqueueAndForget((async()=>HY(await iJ(l),d,f))),f.promise})(IT(t),e)}function TJ(t,e,n){const l=n.docs.get(e._key),d=new OT(t);return new Uh(t,d,e._key,l,new mg(n.hasPendingWrites,n.fromCache),e.converter)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SJ={maxAttempts:5};function dv(t,e){if((t=zo(t)).firestore!==e)throw new $n(Yt.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EJ{constructor(e,n){this._firestore=e,this._transaction=n,this._dataReader=PT(e)}get(e){const n=dv(e,this._firestore),l=new yJ(this._firestore);return this._transaction.lookup([n._key]).then((d=>{if(!d||d.length!==1)return Ar(24041);const f=d[0];if(f.isFoundDocument())return new Rw(this._firestore,l,f.key,f,n.converter);if(f.isNoDocument())return new Rw(this._firestore,l,n._key,null,n.converter);throw Ar(18433,{doc:f})}))}set(e,n,l){const d=dv(e,this._firestore),f=PB(d.converter,n,l),x=bB(this._dataReader,"Transaction.set",d._key,f,d.converter!==null,l);return this._transaction.set(d._key,x),this}update(e,n,l,...d){const f=dv(e,this._firestore);let x;return x=typeof(n=zo(n))=="string"||n instanceof sb?wB(this._dataReader,"Transaction.update",f._key,n,l,d):xB(this._dataReader,"Transaction.update",f._key,n),this._transaction.update(f._key,x),this}delete(e){const n=dv(e,this._firestore);return this._transaction.delete(n._key),this}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CJ extends EJ{constructor(e,n){super(e,n),this._firestore=e}get(e){const n=dv(e,this._firestore),l=new OT(this._firestore);return super.get(e).then((d=>new Uh(this._firestore,l,n._key,d._document,new mg(!1,!1),n.converter)))}}function IJ(t,e,n){t=au(t,bp);const l={...SJ,...n};return(function(f){if(f.maxAttempts<1)throw new $n(Yt.INVALID_ARGUMENT,"Max attempts must be at least 1")})(l),(function(f,x,s){const C=new md;return f.asyncQueue.enqueueAndForget((async()=>{const P=await oJ(f);new tJ(f.asyncQueue,P,s,x,C).ju()})),C.promise})(IT(t),(d=>e(new CJ(t,d))),l)}function oL(){return new VA("serverTimestamp")}function AJ(...t){return new $A("arrayUnion",t)}function PJ(t){return new UA("increment",t)}(function(e,n=!0){(function(d){Qg=d})(Pd),mu(new pu("firestore",((l,{instanceIdentifier:d,options:f})=>{const x=l.getProvider("app").getImmediate(),s=new bp(new mZ(l.getProvider("auth-internal")),new yZ(x,l.getProvider("app-check-internal")),(function(P,L){if(!Object.prototype.hasOwnProperty.apply(P.options,["projectId"]))throw new $n(Yt.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new e0(P.options.projectId,L)})(x,d),x);return f={useFetchStreams:n,...f},s._setSettings(f),s}),"PUBLIC").setMultipleInstances(!0)),la(rD,iD,e),la(rD,iD,"esm2020")})();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kB="firebasestorage.googleapis.com",RJ="storageBucket",kJ=120*1e3,OJ=600*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bu extends Vl{constructor(e,n,l=0){super(yC(e),`Firebase Storage: ${n} (${yC(e)})`),this.status_=l,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,bu.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return yC(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var _u;(function(t){t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(_u||(_u={}));function yC(t){return"storage/"+t}function MJ(){const t="An unknown error occurred, please check the error payload for server response.";return new bu(_u.UNKNOWN,t)}function DJ(){return new bu(_u.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function LJ(){return new bu(_u.CANCELED,"User canceled the upload/download.")}function zJ(t){return new bu(_u.INVALID_URL,"Invalid URL '"+t+"'.")}function FJ(t){return new bu(_u.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function sL(t){return new bu(_u.INVALID_ARGUMENT,t)}function OB(){return new bu(_u.APP_DELETED,"The Firebase app was deleted.")}function BJ(t){return new bu(_u.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dc{constructor(e,n){this.bucket=e,this.path_=n}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,n){let l;try{l=dc.makeFromUrl(e,n)}catch{return new dc(e,"")}if(l.path==="")return l;throw FJ(e)}static makeFromUrl(e,n){let l=null;const d="([A-Za-z0-9.\\-_]+)";function f(Ne){Ne.path.charAt(Ne.path.length-1)==="/"&&(Ne.path_=Ne.path_.slice(0,-1))}const x="(/(.*))?$",s=new RegExp("^gs://"+d+x,"i"),C={bucket:1,path:3};function P(Ne){Ne.path_=decodeURIComponent(Ne.path)}const L="v[A-Za-z0-9_]+",$=n.replace(/[.]/g,"\\."),V="(/([^?#]*).*)?$",j=new RegExp(`^https?://${$}/${L}/b/${d}/o${V}`,"i"),ue={bucket:1,path:3},de=n===kB?"(?:storage.googleapis.com|storage.cloud.google.com)":n,Te="([^?#]*)",Be=new RegExp(`^https?://${de}/${d}/${Te}`,"i"),Ye=[{regex:s,indices:C,postModify:f},{regex:j,indices:ue,postModify:P},{regex:Be,indices:{bucket:1,path:2},postModify:P}];for(let Ne=0;Ne<Ye.length;Ne++){const Mt=Ye[Ne],kt=Mt.regex.exec(e);if(kt){const Pe=kt[Mt.indices.bucket];let we=kt[Mt.indices.path];we||(we=""),l=new dc(Pe,we),Mt.postModify(l);break}}if(l==null)throw zJ(e);return l}}class NJ{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VJ(t,e,n){let l=1,d=null,f=null,x=!1,s=0;function C(){return s===2}let P=!1;function L(...Te){P||(P=!0,e.apply(null,Te))}function $(Te){d=setTimeout(()=>{d=null,t(j,C())},Te)}function V(){f&&clearTimeout(f)}function j(Te,...Be){if(P){V();return}if(Te){V(),L.call(null,Te,...Be);return}if(C()||x){V(),L.call(null,Te,...Be);return}l<64&&(l*=2);let Ye;s===1?(s=2,Ye=0):Ye=(l+Math.random())*1e3,$(Ye)}let ue=!1;function de(Te){ue||(ue=!0,V(),!P&&(d!==null?(Te||(s=2),clearTimeout(d),$(0)):Te||(s=1)))}return $(0),f=setTimeout(()=>{x=!0,de(!0)},n),de}function $J(t){t(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function UJ(t){return t!==void 0}function aL(t,e,n,l){if(l<e)throw sL(`Invalid value for '${t}'. Expected ${e} or greater.`);if(l>n)throw sL(`Invalid value for '${t}'. Expected ${n} or less.`)}function jJ(t){const e=encodeURIComponent;let n="?";for(const l in t)if(t.hasOwnProperty(l)){const d=e(l)+"="+e(t[l]);n=n+d+"&"}return n=n.slice(0,-1),n}var kw;(function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"})(kw||(kw={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GJ(t,e){const n=t>=500&&t<600,d=[408,429].indexOf(t)!==-1,f=e.indexOf(t)!==-1;return n||d||f}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HJ{constructor(e,n,l,d,f,x,s,C,P,L,$,V=!0,j=!1){this.url_=e,this.method_=n,this.headers_=l,this.body_=d,this.successCodes_=f,this.additionalRetryCodes_=x,this.callback_=s,this.errorCallback_=C,this.timeout_=P,this.progressCallback_=L,this.connectionFactory_=$,this.retry=V,this.isUsingEmulator=j,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((ue,de)=>{this.resolve_=ue,this.reject_=de,this.start_()})}start_(){const e=(l,d)=>{if(d){l(!1,new px(!1,null,!0));return}const f=this.connectionFactory_();this.pendingConnection_=f;const x=s=>{const C=s.loaded,P=s.lengthComputable?s.total:-1;this.progressCallback_!==null&&this.progressCallback_(C,P)};this.progressCallback_!==null&&f.addUploadProgressListener(x),f.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&f.removeUploadProgressListener(x),this.pendingConnection_=null;const s=f.getErrorCode()===kw.NO_ERROR,C=f.getStatus();if(!s||GJ(C,this.additionalRetryCodes_)&&this.retry){const L=f.getErrorCode()===kw.ABORT;l(!1,new px(!1,null,L));return}const P=this.successCodes_.indexOf(C)!==-1;l(!0,new px(P,f))})},n=(l,d)=>{const f=this.resolve_,x=this.reject_,s=d.connection;if(d.wasSuccessCode)try{const C=this.callback_(s,s.getResponse());UJ(C)?f(C):f()}catch(C){x(C)}else if(s!==null){const C=MJ();C.serverResponse=s.getErrorText(),this.errorCallback_?x(this.errorCallback_(s,C)):x(C)}else if(d.canceled){const C=this.appDelete_?OB():LJ();x(C)}else{const C=DJ();x(C)}};this.canceled_?n(!1,new px(!1,null,!0)):this.backoffId_=VJ(e,n,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&$J(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class px{constructor(e,n,l){this.wasSuccessCode=e,this.connection=n,this.canceled=!!l}}function WJ(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function qJ(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function KJ(t,e){e&&(t["X-Firebase-GMPID"]=e)}function ZJ(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function XJ(t,e,n,l,d,f,x=!0,s=!1){const C=jJ(t.urlParams),P=t.url+C,L=Object.assign({},t.headers);return KJ(L,e),WJ(L,n),qJ(L,f),ZJ(L,l),new HJ(P,t.method,L,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,d,x,s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function YJ(t){if(t.length===0)return null;const e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function JJ(t){const e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ow{constructor(e,n){this._service=e,n instanceof dc?this._location=n:this._location=dc.makeFromUrl(n,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,n){return new Ow(e,n)}get root(){const e=new dc(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return JJ(this._location.path)}get storage(){return this._service}get parent(){const e=YJ(this._location.path);if(e===null)return null;const n=new dc(this._location.bucket,e);return new Ow(this._service,n)}_throwIfRoot(e){if(this._location.path==="")throw BJ(e)}}function lL(t,e){const n=e?.[RJ];return n==null?null:dc.makeFromBucketSpec(n,t)}function QJ(t,e,n,l={}){t.host=`${e}:${n}`;const d=Ad(e);d&&(lT(`https://${t.host}/b`),cT("Storage",!0)),t._isUsingEmulator=!0,t._protocol=d?"https":"http";const{mockUserToken:f}=l;f&&(t._overrideAuthToken=typeof f=="string"?f:Q6(f,t.app.options.projectId))}class eQ{constructor(e,n,l,d,f,x=!1){this.app=e,this._authProvider=n,this._appCheckProvider=l,this._url=d,this._firebaseVersion=f,this._isUsingEmulator=x,this._bucket=null,this._host=kB,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=kJ,this._maxUploadRetryTime=OJ,this._requests=new Set,d!=null?this._bucket=dc.makeFromBucketSpec(d,this._host):this._bucket=lL(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=dc.makeFromBucketSpec(this._url,e):this._bucket=lL(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){aL("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){aL("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const n=await e.getToken();if(n!==null)return n.accessToken}return null}async _getAppCheckToken(){if(Ia(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Ow(this,e)}_makeRequest(e,n,l,d,f=!0){if(this._deleted)return new NJ(OB());{const x=XJ(e,this._appId,l,d,n,this._firebaseVersion,f,this._isUsingEmulator);return this._requests.add(x),x.getPromise().then(()=>this._requests.delete(x),()=>this._requests.delete(x)),x}}async makeRequestWithTokens(e,n){const[l,d]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,n,l,d).getPromise()}}const cL="@firebase/storage",uL="0.14.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MB="storage";function tQ(t=K0(),e){t=zo(t);const l=Sp(t,MB).getImmediate({identifier:e}),d=YI("storage");return d&&nQ(l,...d),l}function nQ(t,e,n,l={}){QJ(t,e,n,l)}function rQ(t,{instanceIdentifier:e}){const n=t.getProvider("app").getImmediate(),l=t.getProvider("auth-internal"),d=t.getProvider("app-check-internal");return new eQ(n,l,d,e,Pd)}function iQ(){mu(new pu(MB,rQ,"PUBLIC").setMultipleInstances(!0)),la(cL,uL,""),la(cL,uL,"esm2020")}iQ();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oQ="type.googleapis.com/google.protobuf.Int64Value",sQ="type.googleapis.com/google.protobuf.UInt64Value";function DB(t,e){const n={};for(const l in t)t.hasOwnProperty(l)&&(n[l]=e(t[l]));return n}function Mw(t){if(t==null)return null;if(t instanceof Number&&(t=t.valueOf()),typeof t=="number"&&isFinite(t)||t===!0||t===!1||Object.prototype.toString.call(t)==="[object String]")return t;if(t instanceof Date)return t.toISOString();if(Array.isArray(t))return t.map(e=>Mw(e));if(typeof t=="function"||typeof t=="object")return DB(t,e=>Mw(e));throw new Error("Data cannot be encoded in JSON: "+t)}function Ug(t){if(t==null)return t;if(t["@type"])switch(t["@type"]){case oQ:case sQ:{const e=Number(t.value);if(isNaN(e))throw new Error("Data cannot be decoded from JSON: "+t);return e}default:throw new Error("Data cannot be decoded from JSON: "+t)}return Array.isArray(t)?t.map(e=>Ug(e)):typeof t=="function"||typeof t=="object"?DB(t,e=>Ug(e)):t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KA="functions";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dL={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class ja extends Vl{constructor(e,n,l){super(`${KA}/${e}`,n||""),this.details=l,Object.setPrototypeOf(this,ja.prototype)}}function aQ(t){if(t>=200&&t<300)return"ok";switch(t){case 0:return"internal";case 400:return"invalid-argument";case 401:return"unauthenticated";case 403:return"permission-denied";case 404:return"not-found";case 409:return"aborted";case 429:return"resource-exhausted";case 499:return"cancelled";case 500:return"internal";case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline-exceeded"}return"unknown"}function Dw(t,e){let n=aQ(t),l=n,d;try{const f=e&&e.error;if(f){const x=f.status;if(typeof x=="string"){if(!dL[x])return new ja("internal","internal");n=dL[x],l=x}const s=f.message;typeof s=="string"&&(l=s),d=f.details,d!==void 0&&(d=Ug(d))}}catch{}return n==="ok"?null:new ja(n,l,d)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lQ{constructor(e,n,l,d){this.app=e,this.auth=null,this.messaging=null,this.appCheck=null,this.serverAppAppCheckToken=null,Ia(e)&&e.settings.appCheckToken&&(this.serverAppAppCheckToken=e.settings.appCheckToken),this.auth=n.getImmediate({optional:!0}),this.messaging=l.getImmediate({optional:!0}),this.auth||n.get().then(f=>this.auth=f,()=>{}),this.messaging||l.get().then(f=>this.messaging=f,()=>{}),this.appCheck||d?.get().then(f=>this.appCheck=f,()=>{})}async getAuthToken(){if(this.auth)try{return(await this.auth.getToken())?.accessToken}catch{return}}async getMessagingToken(){if(!(!this.messaging||!("Notification"in self)||Notification.permission!=="granted"))try{return await this.messaging.getToken()}catch{return}}async getAppCheckToken(e){if(this.serverAppAppCheckToken)return this.serverAppAppCheckToken;if(this.appCheck){const n=e?await this.appCheck.getLimitedUseToken():await this.appCheck.getToken();return n.error?null:n.token}return null}async getContext(e){const n=await this.getAuthToken(),l=await this.getMessagingToken(),d=await this.getAppCheckToken(e);return{authToken:n,messagingToken:l,appCheckToken:d}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const E2="us-central1",cQ=/^data: (.*?)(?:\n|$)/;function uQ(t){let e=null;return{promise:new Promise((n,l)=>{e=setTimeout(()=>{l(new ja("deadline-exceeded","deadline-exceeded"))},t)}),cancel:()=>{e&&clearTimeout(e)}}}class dQ{constructor(e,n,l,d,f=E2,x=(...s)=>fetch(...s)){this.app=e,this.fetchImpl=x,this.emulatorOrigin=null,this.contextProvider=new lQ(e,n,l,d),this.cancelAllRequests=new Promise(s=>{this.deleteService=()=>Promise.resolve(s())});try{const s=new URL(f);this.customDomain=s.origin+(s.pathname==="/"?"":s.pathname),this.region=E2}catch{this.customDomain=null,this.region=f}}_delete(){return this.deleteService()}_url(e){const n=this.app.options.projectId;return this.emulatorOrigin!==null?`${this.emulatorOrigin}/${n}/${this.region}/${e}`:this.customDomain!==null?`${this.customDomain}/${e}`:`https://${this.region}-${n}.cloudfunctions.net/${e}`}}function hQ(t,e,n){const l=Ad(e);t.emulatorOrigin=`http${l?"s":""}://${e}:${n}`,l&&(lT(t.emulatorOrigin+"/backends"),cT("Functions",!0))}function fQ(t,e,n){const l=d=>mQ(t,e,d,{});return l.stream=(d,f)=>_Q(t,e,d,f),l}function LB(t){return t.emulatorOrigin&&Ad(t.emulatorOrigin)?"include":void 0}async function pQ(t,e,n,l,d){n["Content-Type"]="application/json";let f;try{f=await l(t,{method:"POST",body:JSON.stringify(e),headers:n,credentials:LB(d)})}catch{return{status:0,json:null}}let x=null;try{x=await f.json()}catch{}return{status:f.status,json:x}}async function zB(t,e){const n={},l=await t.contextProvider.getContext(e.limitedUseAppCheckTokens);return l.authToken&&(n.Authorization="Bearer "+l.authToken),l.messagingToken&&(n["Firebase-Instance-ID-Token"]=l.messagingToken),l.appCheckToken!==null&&(n["X-Firebase-AppCheck"]=l.appCheckToken),n}function mQ(t,e,n,l){const d=t._url(e);return gQ(t,d,n,l)}async function gQ(t,e,n,l){n=Mw(n);const d={data:n},f=await zB(t,l),x=l.timeout||7e4,s=uQ(x),C=await Promise.race([pQ(e,d,f,t.fetchImpl,t),s.promise,t.cancelAllRequests]);if(s.cancel(),!C)throw new ja("cancelled","Firebase Functions instance was deleted.");const P=Dw(C.status,C.json);if(P)throw P;if(!C.json)throw new ja("internal","Response is not valid JSON object.");let L=C.json.data;if(typeof L>"u"&&(L=C.json.result),typeof L>"u")throw new ja("internal","Response is missing data field.");return{data:Ug(L)}}function _Q(t,e,n,l){const d=t._url(e);return yQ(t,d,n,l||{})}async function yQ(t,e,n,l){n=Mw(n);const d={data:n},f=await zB(t,l);f["Content-Type"]="application/json",f.Accept="text/event-stream";let x;try{x=await t.fetchImpl(e,{method:"POST",body:JSON.stringify(d),headers:f,signal:l?.signal,credentials:LB(t)})}catch(V){if(V instanceof Error&&V.name==="AbortError"){const ue=new ja("cancelled","Request was cancelled.");return{data:Promise.reject(ue),stream:{[Symbol.asyncIterator](){return{next(){return Promise.reject(ue)}}}}}}const j=Dw(0,null);return{data:Promise.reject(j),stream:{[Symbol.asyncIterator](){return{next(){return Promise.reject(j)}}}}}}let s,C;const P=new Promise((V,j)=>{s=V,C=j});l?.signal?.addEventListener("abort",()=>{const V=new ja("cancelled","Request was cancelled.");C(V)});const L=x.body.getReader(),$=vQ(L,s,C,l?.signal);return{stream:{[Symbol.asyncIterator](){const V=$.getReader();return{async next(){const{value:j,done:ue}=await V.read();return{value:j,done:ue}},async return(){return await V.cancel(),{done:!0,value:void 0}}}}},data:P}}function vQ(t,e,n,l){const d=(x,s)=>{const C=x.match(cQ);if(!C)return;const P=C[1];try{const L=JSON.parse(P);if("result"in L){e(Ug(L.result));return}if("message"in L){s.enqueue(Ug(L.message));return}if("error"in L){const $=Dw(0,L);s.error($),n($);return}}catch(L){if(L instanceof ja){s.error(L),n(L);return}}},f=new TextDecoder;return new ReadableStream({start(x){let s="";return C();async function C(){if(l?.aborted){const P=new ja("cancelled","Request was cancelled");return x.error(P),n(P),Promise.resolve()}try{const{value:P,done:L}=await t.read();if(L){s.trim()&&d(s.trim(),x),x.close();return}if(l?.aborted){const V=new ja("cancelled","Request was cancelled");x.error(V),n(V),await t.cancel();return}s+=f.decode(P,{stream:!0});const $=s.split(`
`);s=$.pop()||"";for(const V of $)V.trim()&&d(V.trim(),x);return C()}catch(P){const L=P instanceof ja?P:Dw(0,null);x.error(L),n(L)}}},cancel(){return t.cancel()}})}const hL="@firebase/functions",fL="0.13.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bQ="auth-internal",xQ="app-check-internal",wQ="messaging-internal";function TQ(t){const e=(n,{instanceIdentifier:l})=>{const d=n.getProvider("app").getImmediate(),f=n.getProvider(bQ),x=n.getProvider(wQ),s=n.getProvider(xQ);return new dQ(d,f,x,s,l)};mu(new pu(KA,e,"PUBLIC").setMultipleInstances(!0)),la(hL,fL,t),la(hL,fL,"esm2020")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function SQ(t=K0(),e=E2){const l=Sp(zo(t),KA).getImmediate({identifier:e}),d=YI("functions");return d&&EQ(l,...d),l}function EQ(t,e,n){hQ(zo(t),e,n)}function ZA(t,e,n){return fQ(zo(t),e)}TQ();const CQ={apiKey:"AIzaSyAa1P0h0MvSHPZAFhcRv9LByrEXyFX9thg",authDomain:"fit5032-assignment-b67ef.firebaseapp.com",projectId:"fit5032-assignment-b67ef",storageBucket:"fit5032-assignment-b67ef.firebasestorage.app",messagingSenderId:"854869049241",appId:"1:854869049241:web:c25054c5304a9a54579d08"},MT=dT(CQ),hp=lJ(MT);tQ(MT);const o_=dZ(MT),XA=SQ(MT),FB=bi(o_.currentUser),DT=bi(localStorage.getItem("role"));Fz(o_,t=>{FB.value=t,t||(DT.value=null,localStorage.removeItem("role"))});function IQ(t){DT.value=t,localStorage.setItem("role",t)}async function AQ(){await eK(o_),DT.value=null,localStorage.removeItem("role")}function ab(){return{user:FB,role:DT,setRole:IQ,logout:AQ}}const PQ={class:"border-bottom sticky-top",style:{background:"#FBF8EE"},role:"banner","aria-label":"Site header"},RQ={class:"navbar navbar-expand-lg py-3 fs-5",role:"navigation","aria-label":"Main navigation"},kQ={class:"container"},OQ={id:"mainNav",class:"collapse navbar-collapse"},MQ={class:"navbar-nav me-auto gap-lg-3",role:"menubar","aria-label":"Primary menu"},DQ={key:0,class:"nav-item",role:"none"},LQ={class:"navbar-nav ms-auto gap-3","aria-label":"User menu"},zQ={class:"nav-item"},FQ={class:"nav-item"},BQ=vu({__name:"NavBar",props:{navItems:{}},setup(t){const{user:e,role:n,logout:l}=ab(),d=sT();async function f(){await l(),d.push("/")}return(x,s)=>(Me(),ft("header",PQ,[Ze("nav",RQ,[Ze("div",kQ,[s[4]||(s[4]=Ze("button",{class:"navbar-toggler",type:"button","data-bs-toggle":"collapse","data-bs-target":"#mainNav","aria-controls":"mainNav","aria-expanded":"false","aria-label":"Toggle navigation"},[Ze("span",{class:"navbar-toggler-icon"})],-1)),Ze("div",OQ,[Ze("ul",MQ,[(Me(!0),ft(Tr,null,ms(x.navItems,C=>(Me(),ft("li",{key:C.to,class:"nav-item",role:"none"},[pr(Ai(ov),{class:"nav-link",to:C.to,role:"menuitem"},{default:zr(()=>[Ra(Fr(C.label),1)]),_:2},1032,["to"])]))),128)),Ai(n)==="admin"?(Me(),ft("li",DQ,[pr(Ai(ov),{class:"nav-link",to:"/admin",role:"menuitem"},{default:zr(()=>[...s[0]||(s[0]=[Ra("Admin",-1)])]),_:1})])):Pn("",!0)]),Ze("ul",LQ,[Ai(e)?(Me(),ft(Tr,{key:1},[s[3]||(s[3]=Ze("li",{class:"nav-item"},[Ze("span",{class:"navbar-text me-3","aria-live":"polite"})],-1)),Ze("li",{class:"nav-item"},[Ze("button",{class:"btn btn-outline-danger",onClick:f,"aria-label":"Log out of your account"}," Logout ")])],64)):(Me(),ft(Tr,{key:0},[Ze("li",zQ,[pr(Ai(ov),{class:"nav-link",to:"/login","aria-label":"Login page"},{default:zr(()=>[...s[1]||(s[1]=[Ra("Login",-1)])]),_:1})]),Ze("li",FQ,[pr(Ai(ov),{class:"btn btn-success px-3",to:"/signup","aria-label":"Sign up for an account"},{default:zr(()=>[...s[2]||(s[2]=[Ra("Sign up",-1)])]),_:1})])],64))])])])])]))}}),lb=(t,e)=>{const n=t.__vccOpts||t;for(const[l,d]of e)n[l]=d;return n},NQ={},VQ={class:"py-4 mt-auto",style:{background:"#FBF8EE"},role:"contentinfo","aria-label":"Website footer"};function $Q(t,e){return Me(),ft("footer",VQ,[...e[0]||(e[0]=[vj('<div class="container d-flex flex-column flex-md-row justify-content-between align-items-center" data-v-410adfe3><div class="mb-3 mb-md-0 text-center text-md-start" data-v-410adfe3><h2 class="fw-bold mb-1 fs-6" id="siteName" data-v-410adfe3>Food for Life</h2><p class="text-muted mb-0" data-v-410adfe3>Building better experiences together for tomorrow.</p></div><address class="text-center text-md-end" aria-labelledby="contactHeading" data-v-410adfe3><h2 id="contactHeading" class="visually-hidden" data-v-410adfe3>Contact information</h2><a href="mailto:nmot0010@student.monash.edu" class="d-block text-muted" data-v-410adfe3> nmot0010@student.monash.edu </a><a href="tel:+6112345678" class="d-block text-muted" data-v-410adfe3> +61 123 456 78 </a><span class="d-block text-muted" data-v-410adfe3>Clayton, VIC</span></address></div>',1)])])}const UQ=lb(NQ,[["render",$Q],["__scopeId","data-v-410adfe3"]]),jQ={id:"app",class:"d-flex flex-column min-vh-100"},GQ={class:"container py-4 flex-fill"},HQ=vu({__name:"App",setup(t){return(e,n)=>(Me(),ft("div",jQ,[pr(BQ,{"nav-items":[{label:"Programs",to:"/programs"},{label:"Resources",to:"/resources"},{label:"For Professionals",to:"/professionals"},{label:"Get involved",to:"/get-involved/volunteer"},{label:"About",to:"/about"}]}),Ze("main",GQ,[pr(Ai(q6))]),pr(UQ)]))}}),WQ="/assets/home-CssQS3y4.png",qQ={},KQ={class:"position-relative"};function ZQ(t,e){return Me(),ft("div",KQ,[...e[0]||(e[0]=[Ze("img",{src:WQ,alt:"","aria-hidden":"true",class:"bg-img"},null,-1)])])}const XQ=lb(qQ,[["render",ZQ],["__scopeId","data-v-5a9b5680"]]);var YQ=Object.defineProperty,pL=Object.getOwnPropertySymbols,JQ=Object.prototype.hasOwnProperty,QQ=Object.prototype.propertyIsEnumerable,mL=(t,e,n)=>e in t?YQ(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,eee=(t,e)=>{for(var n in e||(e={}))JQ.call(e,n)&&mL(t,n,e[n]);if(pL)for(var n of pL(e))QQ.call(e,n)&&mL(t,n,e[n]);return t};function Wa(t){return t==null||t===""||Array.isArray(t)&&t.length===0||!(t instanceof Date)&&typeof t=="object"&&Object.keys(t).length===0}function tee(t,e,n,l=1){let d=-1,f=Wa(t),x=Wa(e);return f&&x?d=0:f?d=l:x?d=-l:typeof t=="string"&&typeof e=="string"?d=n(t,e):d=t<e?-1:t>e?1:0,d}function C2(t,e,n=new WeakSet){if(t===e)return!0;if(!t||!e||typeof t!="object"||typeof e!="object"||n.has(t)||n.has(e))return!1;n.add(t).add(e);let l=Array.isArray(t),d=Array.isArray(e),f,x,s;if(l&&d){if(x=t.length,x!=e.length)return!1;for(f=x;f--!==0;)if(!C2(t[f],e[f],n))return!1;return!0}if(l!=d)return!1;let C=t instanceof Date,P=e instanceof Date;if(C!=P)return!1;if(C&&P)return t.getTime()==e.getTime();let L=t instanceof RegExp,$=e instanceof RegExp;if(L!=$)return!1;if(L&&$)return t.toString()==e.toString();let V=Object.keys(t);if(x=V.length,x!==Object.keys(e).length)return!1;for(f=x;f--!==0;)if(!Object.prototype.hasOwnProperty.call(e,V[f]))return!1;for(f=x;f--!==0;)if(s=V[f],!C2(t[s],e[s],n))return!1;return!0}function nee(t,e){return C2(t,e)}function LT(t){return typeof t=="function"&&"call"in t&&"apply"in t}function si(t){return!Wa(t)}function Di(t,e){if(!t||!e)return null;try{let n=t[e];if(si(n))return n}catch{}if(Object.keys(t).length){if(LT(e))return e(t);if(e.indexOf(".")===-1)return t[e];{let n=e.split("."),l=t;for(let d=0,f=n.length;d<f;++d){if(l==null)return null;l=l[n[d]]}return l}}return null}function Pp(t,e,n){return n?Di(t,n)===Di(e,n):nee(t,e)}function ree(t,e){if(t!=null&&e&&e.length){for(let n of e)if(Pp(t,n))return!0}return!1}function du(t,e=!0){return t instanceof Object&&t.constructor===Object&&(e||Object.keys(t).length!==0)}function BB(t={},e={}){let n=eee({},t);return Object.keys(e).forEach(l=>{let d=l;du(e[d])&&d in t&&du(t[d])?n[d]=BB(t[d],e[d]):n[d]=e[d]}),n}function iee(...t){return t.reduce((e,n,l)=>l===0?n:BB(e,n),{})}function vC(t,e){let n=-1;if(e){for(let l=0;l<e.length;l++)if(e[l]===t){n=l;break}}return n}function gL(t,e){let n=-1;if(si(t))try{n=t.findLastIndex(e)}catch{n=t.lastIndexOf([...t].reverse().find(e))}return n}function ul(t,...e){return LT(t)?t(...e):t}function Ha(t,e=!0){return typeof t=="string"&&(e||t!=="")}function tu(t){return Ha(t)?t.replace(/(-|_)/g,"").toLowerCase():t}function YA(t,e="",n={}){let l=tu(e).split("."),d=l.shift();if(d){if(du(t)){let f=Object.keys(t).find(x=>tu(x)===d)||"";return YA(ul(t[f],n),l.join("."),n)}return}return ul(t,n)}function NB(t,e=!0){return Array.isArray(t)&&(e||t.length!==0)}function oee(t){return si(t)&&!isNaN(t)}function see(t=""){return si(t)&&t.length===1&&!!t.match(/\S| /)}function _L(){return new Intl.Collator(void 0,{numeric:!0}).compare}function fp(t,e){if(e){let n=e.test(t);return e.lastIndex=0,n}return!1}function aee(...t){return iee(...t)}function Ov(t){return t&&t.replace(/\/\*(?:(?!\*\/)[\s\S])*\*\/|[\r\n\t]+/g,"").replace(/ {2,}/g," ").replace(/ ([{:}]) /g,"$1").replace(/([;,]) /g,"$1").replace(/ !/g,"!").replace(/: /g,":").trim()}function Ml(t){if(t&&/[\xC0-\xFF\u0100-\u017E]/.test(t)){let e={A:/[\xC0-\xC5\u0100\u0102\u0104]/g,AE:/[\xC6]/g,C:/[\xC7\u0106\u0108\u010A\u010C]/g,D:/[\xD0\u010E\u0110]/g,E:/[\xC8-\xCB\u0112\u0114\u0116\u0118\u011A]/g,G:/[\u011C\u011E\u0120\u0122]/g,H:/[\u0124\u0126]/g,I:/[\xCC-\xCF\u0128\u012A\u012C\u012E\u0130]/g,IJ:/[\u0132]/g,J:/[\u0134]/g,K:/[\u0136]/g,L:/[\u0139\u013B\u013D\u013F\u0141]/g,N:/[\xD1\u0143\u0145\u0147\u014A]/g,O:/[\xD2-\xD6\xD8\u014C\u014E\u0150]/g,OE:/[\u0152]/g,R:/[\u0154\u0156\u0158]/g,S:/[\u015A\u015C\u015E\u0160]/g,T:/[\u0162\u0164\u0166]/g,U:/[\xD9-\xDC\u0168\u016A\u016C\u016E\u0170\u0172]/g,W:/[\u0174]/g,Y:/[\xDD\u0176\u0178]/g,Z:/[\u0179\u017B\u017D]/g,a:/[\xE0-\xE5\u0101\u0103\u0105]/g,ae:/[\xE6]/g,c:/[\xE7\u0107\u0109\u010B\u010D]/g,d:/[\u010F\u0111]/g,e:/[\xE8-\xEB\u0113\u0115\u0117\u0119\u011B]/g,g:/[\u011D\u011F\u0121\u0123]/g,i:/[\xEC-\xEF\u0129\u012B\u012D\u012F\u0131]/g,ij:/[\u0133]/g,j:/[\u0135]/g,k:/[\u0137,\u0138]/g,l:/[\u013A\u013C\u013E\u0140\u0142]/g,n:/[\xF1\u0144\u0146\u0148\u014B]/g,p:/[\xFE]/g,o:/[\xF2-\xF6\xF8\u014D\u014F\u0151]/g,oe:/[\u0153]/g,r:/[\u0155\u0157\u0159]/g,s:/[\u015B\u015D\u015F\u0161]/g,t:/[\u0163\u0165\u0167]/g,u:/[\xF9-\xFC\u0169\u016B\u016D\u016F\u0171\u0173]/g,w:/[\u0175]/g,y:/[\xFD\xFF\u0177]/g,z:/[\u017A\u017C\u017E]/g};for(let n in e)t=t.replace(e[n],n)}return t}function yL(t,e,n){t&&e!==n&&(n>=t.length&&(n%=t.length,e%=t.length),t.splice(n,0,t.splice(e,1)[0]))}function vL(t,e,n=1,l,d=1){let f=tee(t,e,l,n),x=n;return(Wa(t)||Wa(e))&&(x=d===1?n:d),x*f}function lee(t){return Ha(t,!1)?t[0].toUpperCase()+t.slice(1):t}function VB(t){return Ha(t)?t.replace(/(_)/g,"-").replace(/[A-Z]/g,(e,n)=>n===0?e:"-"+e.toLowerCase()).toLowerCase():t}var lo={STARTS_WITH:"startsWith",CONTAINS:"contains",NOT_CONTAINS:"notContains",ENDS_WITH:"endsWith",EQUALS:"equals",NOT_EQUALS:"notEquals",LESS_THAN:"lt",LESS_THAN_OR_EQUAL_TO:"lte",GREATER_THAN:"gt",GREATER_THAN_OR_EQUAL_TO:"gte",DATE_IS:"dateIs",DATE_IS_NOT:"dateIsNot",DATE_BEFORE:"dateBefore",DATE_AFTER:"dateAfter"},Lw={AND:"and",OR:"or"};function bL(t,e){var n=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=cee(t))||e){n&&(t=n);var l=0,d=function(){};return{s:d,n:function(){return l>=t.length?{done:!0}:{done:!1,value:t[l++]}},e:function(P){throw P},f:d}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var f,x=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var P=n.next();return x=P.done,P},e:function(P){s=!0,f=P},f:function(){try{x||n.return==null||n.return()}finally{if(s)throw f}}}}function cee(t,e){if(t){if(typeof t=="string")return xL(t,e);var n={}.toString.call(t).slice(8,-1);return n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set"?Array.from(t):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?xL(t,e):void 0}}function xL(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,l=Array(e);n<e;n++)l[n]=t[n];return l}var I2={filter:function(e,n,l,d,f){var x=[];if(!e)return x;var s=bL(e),C;try{for(s.s();!(C=s.n()).done;){var P=C.value;if(typeof P=="string"){if(this.filters[d](P,l,f)){x.push(P);continue}}else{var L=bL(n),$;try{for(L.s();!($=L.n()).done;){var V=$.value,j=Di(P,V);if(this.filters[d](j,l,f)){x.push(P);break}}}catch(ue){L.e(ue)}finally{L.f()}}}}catch(ue){s.e(ue)}finally{s.f()}return x},filters:{startsWith:function(e,n,l){if(n==null||n==="")return!0;if(e==null)return!1;var d=Ml(n.toString()).toLocaleLowerCase(l),f=Ml(e.toString()).toLocaleLowerCase(l);return f.slice(0,d.length)===d},contains:function(e,n,l){if(n==null||n==="")return!0;if(e==null)return!1;var d=Ml(n.toString()).toLocaleLowerCase(l),f=Ml(e.toString()).toLocaleLowerCase(l);return f.indexOf(d)!==-1},notContains:function(e,n,l){if(n==null||n==="")return!0;if(e==null)return!1;var d=Ml(n.toString()).toLocaleLowerCase(l),f=Ml(e.toString()).toLocaleLowerCase(l);return f.indexOf(d)===-1},endsWith:function(e,n,l){if(n==null||n==="")return!0;if(e==null)return!1;var d=Ml(n.toString()).toLocaleLowerCase(l),f=Ml(e.toString()).toLocaleLowerCase(l);return f.indexOf(d,f.length-d.length)!==-1},equals:function(e,n,l){return n==null||n===""?!0:e==null?!1:e.getTime&&n.getTime?e.getTime()===n.getTime():Ml(e.toString()).toLocaleLowerCase(l)==Ml(n.toString()).toLocaleLowerCase(l)},notEquals:function(e,n,l){return n==null||n===""?!1:e==null?!0:e.getTime&&n.getTime?e.getTime()!==n.getTime():Ml(e.toString()).toLocaleLowerCase(l)!=Ml(n.toString()).toLocaleLowerCase(l)},in:function(e,n){if(n==null||n.length===0)return!0;for(var l=0;l<n.length;l++)if(Pp(e,n[l]))return!0;return!1},between:function(e,n){return n==null||n[0]==null||n[1]==null?!0:e==null?!1:e.getTime?n[0].getTime()<=e.getTime()&&e.getTime()<=n[1].getTime():n[0]<=e&&e<=n[1]},lt:function(e,n){return n==null?!0:e==null?!1:e.getTime&&n.getTime?e.getTime()<n.getTime():e<n},lte:function(e,n){return n==null?!0:e==null?!1:e.getTime&&n.getTime?e.getTime()<=n.getTime():e<=n},gt:function(e,n){return n==null?!0:e==null?!1:e.getTime&&n.getTime?e.getTime()>n.getTime():e>n},gte:function(e,n){return n==null?!0:e==null?!1:e.getTime&&n.getTime?e.getTime()>=n.getTime():e>=n},dateIs:function(e,n){return n==null?!0:e==null?!1:e.toDateString()===n.toDateString()},dateIsNot:function(e,n){return n==null?!0:e==null?!1:e.toDateString()!==n.toDateString()},dateBefore:function(e,n){return n==null?!0:e==null?!1:e.getTime()<n.getTime()},dateAfter:function(e,n){return n==null?!0:e==null?!1:e.getTime()>n.getTime()}},register:function(e,n){this.filters[e]=n}};function Rs(...t){if(t){let e=[];for(let n=0;n<t.length;n++){let l=t[n];if(!l)continue;let d=typeof l;if(d==="string"||d==="number")e.push(l);else if(d==="object"){let f=Array.isArray(l)?[Rs(...l)]:Object.entries(l).map(([x,s])=>s?x:void 0);e=f.length?e.concat(f.filter(x=>!!x)):e}}return e.join(" ").trim()}}function uee(t,e){return t?t.classList?t.classList.contains(e):new RegExp("(^| )"+e+"( |$)","gi").test(t.className):!1}function hv(t,e){if(t&&e){let n=l=>{uee(t,l)||(t.classList?t.classList.add(l):t.className+=" "+l)};[e].flat().filter(Boolean).forEach(l=>l.split(" ").forEach(n))}}function dee(t){if(t){let e=document.createElement("a");if(e.download!==void 0){let{name:n,src:l}=t;return e.setAttribute("href",l),e.setAttribute("download",n),e.style.display="none",document.body.appendChild(e),e.click(),document.body.removeChild(e),!0}}return!1}function hee(t,e){let n=new Blob([t],{type:"application/csv;charset=utf-8;"});window.navigator.msSaveOrOpenBlob?navigator.msSaveOrOpenBlob(n,e+".csv"):dee({name:e+".csv",src:URL.createObjectURL(n)})||(t="data:text/csv;charset=utf-8,"+t,window.open(encodeURI(t)))}function kh(t,e){if(t&&e){let n=l=>{t.classList?t.classList.remove(l):t.className=t.className.replace(new RegExp("(^|\\b)"+l.split(" ").join("|")+"(\\b|$)","gi")," ")};[e].flat().filter(Boolean).forEach(l=>l.split(" ").forEach(n))}}function A2(t){for(let e of document?.styleSheets)try{for(let n of e?.cssRules)for(let l of n?.style)if(t.test(l))return{name:l,value:n.style.getPropertyValue(l).trim()}}catch{}return null}function $B(t){let e={width:0,height:0};if(t){let[n,l]=[t.style.visibility,t.style.display];t.style.visibility="hidden",t.style.display="block",e.width=t.offsetWidth,e.height=t.offsetHeight,t.style.display=l,t.style.visibility=n}return e}function UB(){let t=window,e=document,n=e.documentElement,l=e.getElementsByTagName("body")[0],d=t.innerWidth||n.clientWidth||l.clientWidth,f=t.innerHeight||n.clientHeight||l.clientHeight;return{width:d,height:f}}function P2(t){return t?Math.abs(t.scrollLeft):0}function fee(){let t=document.documentElement;return(window.pageXOffset||P2(t))-(t.clientLeft||0)}function pee(){let t=document.documentElement;return(window.pageYOffset||t.scrollTop)-(t.clientTop||0)}function jB(t){return t?getComputedStyle(t).direction==="rtl":!1}function GB(t,e,n=!0){var l,d,f,x;if(t){let s=t.offsetParent?{width:t.offsetWidth,height:t.offsetHeight}:$B(t),C=s.height,P=s.width,L=e.offsetHeight,$=e.offsetWidth,V=e.getBoundingClientRect(),j=pee(),ue=fee(),de=UB(),Te,Be,Ge="top";V.top+L+C>de.height?(Te=V.top+j-C,Ge="bottom",Te<0&&(Te=j)):Te=L+V.top+j,V.left+P>de.width?Be=Math.max(0,V.left+ue+$-P):Be=V.left+ue,jB(t)?t.style.insetInlineEnd=Be+"px":t.style.insetInlineStart=Be+"px",t.style.top=Te+"px",t.style.transformOrigin=Ge,n&&(t.style.marginTop=Ge==="bottom"?`calc(${(d=(l=A2(/-anchor-gutter$/))==null?void 0:l.value)!=null?d:"2px"} * -1)`:(x=(f=A2(/-anchor-gutter$/))==null?void 0:f.value)!=null?x:"")}}function zw(t,e){t&&(typeof e=="string"?t.style.cssText=e:Object.entries(e||{}).forEach(([n,l])=>t.style[n]=l))}function Ga(t,e){return t instanceof HTMLElement?t.offsetWidth:0}function mee(t,e,n=!0,l=void 0){var d;if(t){let f=t.offsetParent?{width:t.offsetWidth,height:t.offsetHeight}:$B(t),x=e.offsetHeight,s=e.getBoundingClientRect(),C=UB(),P,L,$=l??"top";if(!l&&s.top+x+f.height>C.height?(P=-1*f.height,$="bottom",s.top+P<0&&(P=-1*s.top)):P=x,f.width>C.width?L=s.left*-1:s.left+f.width>C.width?L=(s.left+f.width-C.width)*-1:L=0,t.style.top=P+"px",t.style.insetInlineStart=L+"px",t.style.transformOrigin=$,n){let V=(d=A2(/-anchor-gutter$/))==null?void 0:d.value;t.style.marginTop=$==="bottom"?`calc(${V??"2px"} * -1)`:V??""}}}function JA(t){if(t){let e=t.parentNode;return e&&e instanceof ShadowRoot&&e.host&&(e=e.host),e}return null}function gee(t){return!!(t!==null&&typeof t<"u"&&t.nodeName&&JA(t))}function Rp(t){return typeof Element<"u"?t instanceof Element:t!==null&&typeof t=="object"&&t.nodeType===1&&typeof t.nodeName=="string"}function Kx(){if(window.getSelection){let t=window.getSelection()||{};t.empty?t.empty():t.removeAllRanges&&t.rangeCount>0&&t.getRangeAt(0).getClientRects().length>0&&t.removeAllRanges()}}function Fw(t,e={}){if(Rp(t)){let n=(l,d)=>{var f,x;let s=(f=t?.$attrs)!=null&&f[l]?[(x=t?.$attrs)==null?void 0:x[l]]:[];return[d].flat().reduce((C,P)=>{if(P!=null){let L=typeof P;if(L==="string"||L==="number")C.push(P);else if(L==="object"){let $=Array.isArray(P)?n(l,P):Object.entries(P).map(([V,j])=>l==="style"&&(j||j===0)?`${V.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}:${j}`:j?V:void 0);C=$.length?C.concat($.filter(V=>!!V)):C}}return C},s)};Object.entries(e).forEach(([l,d])=>{if(d!=null){let f=l.match(/^on(.+)/);f?t.addEventListener(f[1].toLowerCase(),d):l==="p-bind"||l==="pBind"?Fw(t,d):(d=l==="class"?[...new Set(n("class",d))].join(" ").trim():l==="style"?n("style",d).join(";").trim():d,(t.$attrs=t.$attrs||{})&&(t.$attrs[l]=d),t.setAttribute(l,d))}})}}function HB(t,e={},...n){{let l=document.createElement(t);return Fw(l,e),l.append(...n),l}}function lg(t,e){return Rp(t)?Array.from(t.querySelectorAll(e)):[]}function Lh(t,e){return Rp(t)?t.matches(e)?t:t.querySelector(e):null}function Ea(t,e){t&&document.activeElement!==t&&t.focus(e)}function Cs(t,e){if(Rp(t)){let n=t.getAttribute(e);return isNaN(n)?n==="true"||n==="false"?n==="true":n:+n}}function QA(t,e=""){let n=lg(t,`button:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${e},
            [href]:not([tabindex = "-1"]):not([style*="display:none"]):not([hidden])${e},
            input:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${e},
            select:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${e},
            textarea:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${e},
            [tabIndex]:not([tabIndex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${e},
            [contenteditable]:not([tabIndex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${e}`),l=[];for(let d of n)getComputedStyle(d).display!="none"&&getComputedStyle(d).visibility!="hidden"&&l.push(d);return l}function Oh(t,e){let n=QA(t,e);return n.length>0?n[0]:null}function op(t){if(t){let e=t.offsetHeight,n=getComputedStyle(t);return e-=parseFloat(n.paddingTop)+parseFloat(n.paddingBottom)+parseFloat(n.borderTopWidth)+parseFloat(n.borderBottomWidth),e}return 0}function _ee(t){if(t){let[e,n]=[t.style.visibility,t.style.display];t.style.visibility="hidden",t.style.display="block";let l=t.offsetHeight;return t.style.display=n,t.style.visibility=e,l}return 0}function yee(t){if(t){let[e,n]=[t.style.visibility,t.style.display];t.style.visibility="hidden",t.style.display="block";let l=t.offsetWidth;return t.style.display=n,t.style.visibility=e,l}return 0}function Zx(t){var e;if(t){let n=(e=JA(t))==null?void 0:e.childNodes,l=0;if(n)for(let d=0;d<n.length;d++){if(n[d]===t)return l;n[d].nodeType===1&&l++}}return-1}function WB(t,e){let n=QA(t,e);return n.length>0?n[n.length-1]:null}function zT(t,e){let n=t.nextElementSibling;for(;n;){if(n.matches(e))return n;n=n.nextElementSibling}return null}function cg(t){if(t){let e=t.getBoundingClientRect();return{top:e.top+(window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0),left:e.left+(window.pageXOffset||P2(document.documentElement)||P2(document.body)||0)}}return{top:"auto",left:"auto"}}function Bw(t,e){return t?t.offsetHeight:0}function qB(t,e=[]){let n=JA(t);return n===null?e:qB(n,e.concat([n]))}function FT(t,e){let n=t.previousElementSibling;for(;n;){if(n.matches(e))return n;n=n.previousElementSibling}return null}function vee(t){let e=[];if(t){let n=qB(t),l=/(auto|scroll)/,d=f=>{try{let x=window.getComputedStyle(f,null);return l.test(x.getPropertyValue("overflow"))||l.test(x.getPropertyValue("overflowX"))||l.test(x.getPropertyValue("overflowY"))}catch{return!1}};for(let f of n){let x=f.nodeType===1&&f.dataset.scrollselectors;if(x){let s=x.split(",");for(let C of s){let P=Lh(f,C);P&&d(P)&&e.push(P)}}f.nodeType!==9&&d(f)&&e.push(f)}}return e}function wL(){if(window.getSelection)return window.getSelection().toString();if(document.getSelection)return document.getSelection().toString()}function sp(t){if(t){let e=t.offsetWidth,n=getComputedStyle(t);return e-=parseFloat(n.paddingLeft)+parseFloat(n.paddingRight)+parseFloat(n.borderLeftWidth)+parseFloat(n.borderRightWidth),e}return 0}function TL(t,e,n){let l=t[e];typeof l=="function"&&l.apply(t,[])}function bee(){return/(android)/i.test(navigator.userAgent)}function bC(t){if(t){let e=t.nodeName,n=t.parentElement&&t.parentElement.nodeName;return e==="INPUT"||e==="TEXTAREA"||e==="BUTTON"||e==="A"||n==="INPUT"||n==="TEXTAREA"||n==="BUTTON"||n==="A"||!!t.closest(".p-button, .p-checkbox, .p-radiobutton")}return!1}function KB(){return!!(typeof window<"u"&&window.document&&window.document.createElement)}function SL(t,e=""){return Rp(t)?t.matches(`button:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${e},
            [href][clientHeight][clientWidth]:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${e},
            input:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${e},
            select:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${e},
            textarea:not([tabindex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${e},
            [tabIndex]:not([tabIndex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${e},
            [contenteditable]:not([tabIndex = "-1"]):not([disabled]):not([style*="display:none"]):not([hidden])${e}`):!1}function Nw(t){return!!(t&&t.offsetParent!=null)}function ZB(){return"ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0}function eP(t,e="",n){Rp(t)&&n!==null&&n!==void 0&&t.setAttribute(e,n)}function tP(){let t=new Map;return{on(e,n){let l=t.get(e);return l?l.push(n):l=[n],t.set(e,l),this},off(e,n){let l=t.get(e);return l&&l.splice(l.indexOf(n)>>>0,1),this},emit(e,n){let l=t.get(e);l&&l.forEach(d=>{d(n)})},clear(){t.clear()}}}var mx={};function xee(t="pui_id_"){return Object.hasOwn(mx,t)||(mx[t]=0),mx[t]++,`${t}${mx[t]}`}function wee(){let t=[],e=(x,s,C=999)=>{let P=d(x,s,C),L=P.value+(P.key===x?0:C)+1;return t.push({key:x,value:L}),L},n=x=>{t=t.filter(s=>s.value!==x)},l=(x,s)=>d(x).value,d=(x,s,C=0)=>[...t].reverse().find(P=>!0)||{key:x,value:C},f=x=>x&&parseInt(x.style.zIndex,10)||0;return{get:f,set:(x,s,C)=>{s&&(s.style.zIndex=String(e(x,!0,C)))},clear:x=>{x&&(n(f(x)),x.style.zIndex="")},getCurrent:x=>l(x)}}var Ag=wee(),Tee=Object.defineProperty,See=Object.defineProperties,Eee=Object.getOwnPropertyDescriptors,Vw=Object.getOwnPropertySymbols,XB=Object.prototype.hasOwnProperty,YB=Object.prototype.propertyIsEnumerable,EL=(t,e,n)=>e in t?Tee(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,cc=(t,e)=>{for(var n in e||(e={}))XB.call(e,n)&&EL(t,n,e[n]);if(Vw)for(var n of Vw(e))YB.call(e,n)&&EL(t,n,e[n]);return t},xC=(t,e)=>See(t,Eee(e)),sd=(t,e)=>{var n={};for(var l in t)XB.call(t,l)&&e.indexOf(l)<0&&(n[l]=t[l]);if(t!=null&&Vw)for(var l of Vw(t))e.indexOf(l)<0&&YB.call(t,l)&&(n[l]=t[l]);return n},Cee=tP(),Vs=Cee,o0=/{([^}]*)}/g,JB=/(\d+\s+[\+\-\*\/]\s+\d+)/g,QB=/var\([^)]+\)/g;function CL(t){return Ha(t)?t.replace(/[A-Z]/g,(e,n)=>n===0?e:"."+e.toLowerCase()).toLowerCase():t}function Iee(t){return du(t)&&t.hasOwnProperty("$value")&&t.hasOwnProperty("$type")?t.$value:t}function Aee(t){return t.replaceAll(/ /g,"").replace(/[^\w]/g,"-")}function R2(t="",e=""){return Aee(`${Ha(t,!1)&&Ha(e,!1)?`${t}-`:t}${e}`)}function eN(t="",e=""){return`--${R2(t,e)}`}function Pee(t=""){let e=(t.match(/{/g)||[]).length,n=(t.match(/}/g)||[]).length;return(e+n)%2!==0}function tN(t,e="",n="",l=[],d){if(Ha(t)){let f=t.trim();if(Pee(f))return;if(fp(f,o0)){let x=f.replaceAll(o0,s=>{let C=s.replace(/{|}/g,"").split(".").filter(P=>!l.some(L=>fp(P,L)));return`var(${eN(n,VB(C.join("-")))}${si(d)?`, ${d}`:""})`});return fp(x.replace(QB,"0"),JB)?`calc(${x})`:x}return f}else if(oee(t))return t}function Ree(t,e,n){Ha(e,!1)&&t.push(`${e}:${n};`)}function ug(t,e){return t?`${t}{${e}}`:""}function nN(t,e){if(t.indexOf("dt(")===-1)return t;function n(x,s){let C=[],P=0,L="",$=null,V=0;for(;P<=x.length;){let j=x[P];if((j==='"'||j==="'"||j==="`")&&x[P-1]!=="\\"&&($=$===j?null:j),!$&&(j==="("&&V++,j===")"&&V--,(j===","||P===x.length)&&V===0)){let ue=L.trim();ue.startsWith("dt(")?C.push(nN(ue,s)):C.push(l(ue)),L="",P++;continue}j!==void 0&&(L+=j),P++}return C}function l(x){let s=x[0];if((s==='"'||s==="'"||s==="`")&&x[x.length-1]===s)return x.slice(1,-1);let C=Number(x);return isNaN(C)?x:C}let d=[],f=[];for(let x=0;x<t.length;x++)if(t[x]==="d"&&t.slice(x,x+3)==="dt(")f.push(x),x+=2;else if(t[x]===")"&&f.length>0){let s=f.pop();f.length===0&&d.push([s,x])}if(!d.length)return t;for(let x=d.length-1;x>=0;x--){let[s,C]=d[x],P=t.slice(s+3,C),L=n(P,e),$=e(...L);t=t.slice(0,s)+$+t.slice(C+1)}return t}var pp=(...t)=>kee(vo.getTheme(),...t),kee=(t={},e,n,l)=>{if(e){let{variable:d,options:f}=vo.defaults||{},{prefix:x,transform:s}=t?.options||f||{},C=fp(e,o0)?e:`{${e}}`;return l==="value"||Wa(l)&&s==="strict"?vo.getTokenValue(e):tN(C,void 0,x,[d.excludedKeyRegex],n)}return""};function gx(t,...e){if(t instanceof Array){let n=t.reduce((l,d,f)=>{var x;return l+d+((x=ul(e[f],{dt:pp}))!=null?x:"")},"");return nN(n,pp)}return ul(t,{dt:pp})}function Oee(t,e={}){let n=vo.defaults.variable,{prefix:l=n.prefix,selector:d=n.selector,excludedKeyRegex:f=n.excludedKeyRegex}=e,x=[],s=[],C=[{node:t,path:l}];for(;C.length;){let{node:L,path:$}=C.pop();for(let V in L){let j=L[V],ue=Iee(j),de=fp(V,f)?R2($):R2($,VB(V));if(du(ue))C.push({node:ue,path:de});else{let Te=eN(de),Be=tN(ue,de,l,[f]);Ree(s,Te,Be);let Ge=de;l&&Ge.startsWith(l+"-")&&(Ge=Ge.slice(l.length+1)),x.push(Ge.replace(/-/g,"."))}}}let P=s.join("");return{value:s,tokens:x,declarations:P,css:ug(d,P)}}var lc={regex:{rules:{class:{pattern:/^\.([a-zA-Z][\w-]*)$/,resolve(t){return{type:"class",selector:t,matched:this.pattern.test(t.trim())}}},attr:{pattern:/^\[(.*)\]$/,resolve(t){return{type:"attr",selector:`:root${t},:host${t}`,matched:this.pattern.test(t.trim())}}},media:{pattern:/^@media (.*)$/,resolve(t){return{type:"media",selector:t,matched:this.pattern.test(t.trim())}}},system:{pattern:/^system$/,resolve(t){return{type:"system",selector:"@media (prefers-color-scheme: dark)",matched:this.pattern.test(t.trim())}}},custom:{resolve(t){return{type:"custom",selector:t,matched:!0}}}},resolve(t){let e=Object.keys(this.rules).filter(n=>n!=="custom").map(n=>this.rules[n]);return[t].flat().map(n=>{var l;return(l=e.map(d=>d.resolve(n)).find(d=>d.matched))!=null?l:this.rules.custom.resolve(n)})}},_toVariables(t,e){return Oee(t,{prefix:e?.prefix})},getCommon({name:t="",theme:e={},params:n,set:l,defaults:d}){var f,x,s,C,P,L,$;let{preset:V,options:j}=e,ue,de,Te,Be,Ge,Ye,Ne;if(si(V)&&j.transform!=="strict"){let{primitive:Mt,semantic:kt,extend:Pe}=V,we=kt||{},{colorScheme:Se}=we,je=sd(we,["colorScheme"]),Re=Pe||{},{colorScheme:Ve}=Re,ke=sd(Re,["colorScheme"]),Mn=Se||{},{dark:bn}=Mn,mn=sd(Mn,["dark"]),Sn=Ve||{},{dark:ar}=Sn,Br=sd(Sn,["dark"]),ei=si(Mt)?this._toVariables({primitive:Mt},j):{},or=si(je)?this._toVariables({semantic:je},j):{},vr=si(mn)?this._toVariables({light:mn},j):{},oi=si(bn)?this._toVariables({dark:bn},j):{},uo=si(ke)?this._toVariables({semantic:ke},j):{},Gi=si(Br)?this._toVariables({light:Br},j):{},ur=si(ar)?this._toVariables({dark:ar},j):{},[Ot,ln]=[(f=ei.declarations)!=null?f:"",ei.tokens],[yn,vn]=[(x=or.declarations)!=null?x:"",or.tokens||[]],[Nr,He]=[(s=vr.declarations)!=null?s:"",vr.tokens||[]],[Qe,dt]=[(C=oi.declarations)!=null?C:"",oi.tokens||[]],[Lt,qt]=[(P=uo.declarations)!=null?P:"",uo.tokens||[]],[jt,Rn]=[(L=Gi.declarations)!=null?L:"",Gi.tokens||[]],[fn,cn]=[($=ur.declarations)!=null?$:"",ur.tokens||[]];ue=this.transformCSS(t,Ot,"light","variable",j,l,d),de=ln;let Zt=this.transformCSS(t,`${yn}${Nr}`,"light","variable",j,l,d),Xn=this.transformCSS(t,`${Qe}`,"dark","variable",j,l,d);Te=`${Zt}${Xn}`,Be=[...new Set([...vn,...He,...dt])];let En=this.transformCSS(t,`${Lt}${jt}color-scheme:light`,"light","variable",j,l,d),jn=this.transformCSS(t,`${fn}color-scheme:dark`,"dark","variable",j,l,d);Ge=`${En}${jn}`,Ye=[...new Set([...qt,...Rn,...cn])],Ne=ul(V.css,{dt:pp})}return{primitive:{css:ue,tokens:de},semantic:{css:Te,tokens:Be},global:{css:Ge,tokens:Ye},style:Ne}},getPreset({name:t="",preset:e={},options:n,params:l,set:d,defaults:f,selector:x}){var s,C,P;let L,$,V;if(si(e)&&n.transform!=="strict"){let j=t.replace("-directive",""),ue=e,{colorScheme:de,extend:Te,css:Be}=ue,Ge=sd(ue,["colorScheme","extend","css"]),Ye=Te||{},{colorScheme:Ne}=Ye,Mt=sd(Ye,["colorScheme"]),kt=de||{},{dark:Pe}=kt,we=sd(kt,["dark"]),Se=Ne||{},{dark:je}=Se,Re=sd(Se,["dark"]),Ve=si(Ge)?this._toVariables({[j]:cc(cc({},Ge),Mt)},n):{},ke=si(we)?this._toVariables({[j]:cc(cc({},we),Re)},n):{},Mn=si(Pe)?this._toVariables({[j]:cc(cc({},Pe),je)},n):{},[bn,mn]=[(s=Ve.declarations)!=null?s:"",Ve.tokens||[]],[Sn,ar]=[(C=ke.declarations)!=null?C:"",ke.tokens||[]],[Br,ei]=[(P=Mn.declarations)!=null?P:"",Mn.tokens||[]],or=this.transformCSS(j,`${bn}${Sn}`,"light","variable",n,d,f,x),vr=this.transformCSS(j,Br,"dark","variable",n,d,f,x);L=`${or}${vr}`,$=[...new Set([...mn,...ar,...ei])],V=ul(Be,{dt:pp})}return{css:L,tokens:$,style:V}},getPresetC({name:t="",theme:e={},params:n,set:l,defaults:d}){var f;let{preset:x,options:s}=e,C=(f=x?.components)==null?void 0:f[t];return this.getPreset({name:t,preset:C,options:s,params:n,set:l,defaults:d})},getPresetD({name:t="",theme:e={},params:n,set:l,defaults:d}){var f,x;let s=t.replace("-directive",""),{preset:C,options:P}=e,L=((f=C?.components)==null?void 0:f[s])||((x=C?.directives)==null?void 0:x[s]);return this.getPreset({name:s,preset:L,options:P,params:n,set:l,defaults:d})},applyDarkColorScheme(t){return!(t.darkModeSelector==="none"||t.darkModeSelector===!1)},getColorSchemeOption(t,e){var n;return this.applyDarkColorScheme(t)?this.regex.resolve(t.darkModeSelector===!0?e.options.darkModeSelector:(n=t.darkModeSelector)!=null?n:e.options.darkModeSelector):[]},getLayerOrder(t,e={},n,l){let{cssLayer:d}=e;return d?`@layer ${ul(d.order||d.name||"primeui",n)}`:""},getCommonStyleSheet({name:t="",theme:e={},params:n,props:l={},set:d,defaults:f}){let x=this.getCommon({name:t,theme:e,params:n,set:d,defaults:f}),s=Object.entries(l).reduce((C,[P,L])=>C.push(`${P}="${L}"`)&&C,[]).join(" ");return Object.entries(x||{}).reduce((C,[P,L])=>{if(du(L)&&Object.hasOwn(L,"css")){let $=Ov(L.css),V=`${P}-variables`;C.push(`<style type="text/css" data-primevue-style-id="${V}" ${s}>${$}</style>`)}return C},[]).join("")},getStyleSheet({name:t="",theme:e={},params:n,props:l={},set:d,defaults:f}){var x;let s={name:t,theme:e,params:n,set:d,defaults:f},C=(x=t.includes("-directive")?this.getPresetD(s):this.getPresetC(s))==null?void 0:x.css,P=Object.entries(l).reduce((L,[$,V])=>L.push(`${$}="${V}"`)&&L,[]).join(" ");return C?`<style type="text/css" data-primevue-style-id="${t}-variables" ${P}>${Ov(C)}</style>`:""},createTokens(t={},e,n="",l="",d={}){let f=function(s,C={},P=[]){if(P.includes(this.path))return console.warn(`Circular reference detected at ${this.path}`),{colorScheme:s,path:this.path,paths:C,value:void 0};P.push(this.path),C.name=this.path,C.binding||(C.binding={});let L=this.value;if(typeof this.value=="string"&&o0.test(this.value)){let $=this.value.trim().replace(o0,V=>{var j;let ue=V.slice(1,-1),de=this.tokens[ue];if(!de)return console.warn(`Token not found for path: ${ue}`),"__UNRESOLVED__";let Te=de.computed(s,C,P);return Array.isArray(Te)&&Te.length===2?`light-dark(${Te[0].value},${Te[1].value})`:(j=Te?.value)!=null?j:"__UNRESOLVED__"});L=JB.test($.replace(QB,"0"))?`calc(${$})`:$}return Wa(C.binding)&&delete C.binding,P.pop(),{colorScheme:s,path:this.path,paths:C,value:L.includes("__UNRESOLVED__")?void 0:L}},x=(s,C,P)=>{Object.entries(s).forEach(([L,$])=>{let V=fp(L,e.variable.excludedKeyRegex)?C:C?`${C}.${CL(L)}`:CL(L),j=P?`${P}.${L}`:L;du($)?x($,V,j):(d[V]||(d[V]={paths:[],computed:(ue,de={},Te=[])=>{if(d[V].paths.length===1)return d[V].paths[0].computed(d[V].paths[0].scheme,de.binding,Te);if(ue&&ue!=="none")for(let Be=0;Be<d[V].paths.length;Be++){let Ge=d[V].paths[Be];if(Ge.scheme===ue)return Ge.computed(ue,de.binding,Te)}return d[V].paths.map(Be=>Be.computed(Be.scheme,de[Be.scheme],Te))}}),d[V].paths.push({path:j,value:$,scheme:j.includes("colorScheme.light")?"light":j.includes("colorScheme.dark")?"dark":"none",computed:f,tokens:d}))})};return x(t,n,l),d},getTokenValue(t,e,n){var l;let d=(s=>s.split(".").filter(C=>!fp(C.toLowerCase(),n.variable.excludedKeyRegex)).join("."))(e),f=e.includes("colorScheme.light")?"light":e.includes("colorScheme.dark")?"dark":void 0,x=[(l=t[d])==null?void 0:l.computed(f)].flat().filter(s=>s);return x.length===1?x[0].value:x.reduce((s={},C)=>{let P=C,{colorScheme:L}=P,$=sd(P,["colorScheme"]);return s[L]=$,s},void 0)},getSelectorRule(t,e,n,l){return n==="class"||n==="attr"?ug(si(e)?`${t}${e},${t} ${e}`:t,l):ug(t,ug(e??":root,:host",l))},transformCSS(t,e,n,l,d={},f,x,s){if(si(e)){let{cssLayer:C}=d;if(l!=="style"){let P=this.getColorSchemeOption(d,x);e=n==="dark"?P.reduce((L,{type:$,selector:V})=>(si(V)&&(L+=V.includes("[CSS]")?V.replace("[CSS]",e):this.getSelectorRule(V,s,$,e)),L),""):ug(s??":root,:host",e)}if(C){let P={name:"primeui"};du(C)&&(P.name=ul(C.name,{name:t,type:l})),si(P.name)&&(e=ug(`@layer ${P.name}`,e),f?.layerNames(P.name))}return e}return""}},vo={defaults:{variable:{prefix:"p",selector:":root,:host",excludedKeyRegex:/^(primitive|semantic|components|directives|variables|colorscheme|light|dark|common|root|states|extend|css)$/gi},options:{prefix:"p",darkModeSelector:"system",cssLayer:!1}},_theme:void 0,_layerNames:new Set,_loadedStyleNames:new Set,_loadingStyles:new Set,_tokens:{},update(t={}){let{theme:e}=t;e&&(this._theme=xC(cc({},e),{options:cc(cc({},this.defaults.options),e.options)}),this._tokens=lc.createTokens(this.preset,this.defaults),this.clearLoadedStyleNames())},get theme(){return this._theme},get preset(){var t;return((t=this.theme)==null?void 0:t.preset)||{}},get options(){var t;return((t=this.theme)==null?void 0:t.options)||{}},get tokens(){return this._tokens},getTheme(){return this.theme},setTheme(t){this.update({theme:t}),Vs.emit("theme:change",t)},getPreset(){return this.preset},setPreset(t){this._theme=xC(cc({},this.theme),{preset:t}),this._tokens=lc.createTokens(t,this.defaults),this.clearLoadedStyleNames(),Vs.emit("preset:change",t),Vs.emit("theme:change",this.theme)},getOptions(){return this.options},setOptions(t){this._theme=xC(cc({},this.theme),{options:t}),this.clearLoadedStyleNames(),Vs.emit("options:change",t),Vs.emit("theme:change",this.theme)},getLayerNames(){return[...this._layerNames]},setLayerNames(t){this._layerNames.add(t)},getLoadedStyleNames(){return this._loadedStyleNames},isStyleNameLoaded(t){return this._loadedStyleNames.has(t)},setLoadedStyleName(t){this._loadedStyleNames.add(t)},deleteLoadedStyleName(t){this._loadedStyleNames.delete(t)},clearLoadedStyleNames(){this._loadedStyleNames.clear()},getTokenValue(t){return lc.getTokenValue(this.tokens,t,this.defaults)},getCommon(t="",e){return lc.getCommon({name:t,theme:this.theme,params:e,defaults:this.defaults,set:{layerNames:this.setLayerNames.bind(this)}})},getComponent(t="",e){let n={name:t,theme:this.theme,params:e,defaults:this.defaults,set:{layerNames:this.setLayerNames.bind(this)}};return lc.getPresetC(n)},getDirective(t="",e){let n={name:t,theme:this.theme,params:e,defaults:this.defaults,set:{layerNames:this.setLayerNames.bind(this)}};return lc.getPresetD(n)},getCustomPreset(t="",e,n,l){let d={name:t,preset:e,options:this.options,selector:n,params:l,defaults:this.defaults,set:{layerNames:this.setLayerNames.bind(this)}};return lc.getPreset(d)},getLayerOrderCSS(t=""){return lc.getLayerOrder(t,this.options,{names:this.getLayerNames()},this.defaults)},transformCSS(t="",e,n="style",l){return lc.transformCSS(t,e,l,n,this.options,{layerNames:this.setLayerNames.bind(this)},this.defaults)},getCommonStyleSheet(t="",e,n={}){return lc.getCommonStyleSheet({name:t,theme:this.theme,params:e,props:n,defaults:this.defaults,set:{layerNames:this.setLayerNames.bind(this)}})},getStyleSheet(t,e,n={}){return lc.getStyleSheet({name:t,theme:this.theme,params:e,props:n,defaults:this.defaults,set:{layerNames:this.setLayerNames.bind(this)}})},onStyleMounted(t){this._loadingStyles.add(t)},onStyleUpdated(t){this._loadingStyles.add(t)},onStyleLoaded(t,{name:e}){this._loadingStyles.size&&(this._loadingStyles.delete(e),Vs.emit(`theme:${e}:load`,t),!this._loadingStyles.size&&Vs.emit("theme:load"))}},Mh={_loadedStyleNames:new Set,getLoadedStyleNames:function(){return this._loadedStyleNames},isStyleNameLoaded:function(e){return this._loadedStyleNames.has(e)},setLoadedStyleName:function(e){this._loadedStyleNames.add(e)},deleteLoadedStyleName:function(e){this._loadedStyleNames.delete(e)},clearLoadedStyleNames:function(){this._loadedStyleNames.clear()}},Mee=`
    *,
    ::before,
    ::after {
        box-sizing: border-box;
    }

    /* Non vue overlay animations */
    .p-connected-overlay {
        opacity: 0;
        transform: scaleY(0.8);
        transition:
            transform 0.12s cubic-bezier(0, 0, 0.2, 1),
            opacity 0.12s cubic-bezier(0, 0, 0.2, 1);
    }

    .p-connected-overlay-visible {
        opacity: 1;
        transform: scaleY(1);
    }

    .p-connected-overlay-hidden {
        opacity: 0;
        transform: scaleY(1);
        transition: opacity 0.1s linear;
    }

    /* Vue based overlay animations */
    .p-connected-overlay-enter-from {
        opacity: 0;
        transform: scaleY(0.8);
    }

    .p-connected-overlay-leave-to {
        opacity: 0;
    }

    .p-connected-overlay-enter-active {
        transition:
            transform 0.12s cubic-bezier(0, 0, 0.2, 1),
            opacity 0.12s cubic-bezier(0, 0, 0.2, 1);
    }

    .p-connected-overlay-leave-active {
        transition: opacity 0.1s linear;
    }

    /* Toggleable Content */
    .p-toggleable-content-enter-from,
    .p-toggleable-content-leave-to {
        max-height: 0;
    }

    .p-toggleable-content-enter-to,
    .p-toggleable-content-leave-from {
        max-height: 1000px;
    }

    .p-toggleable-content-leave-active {
        overflow: hidden;
        transition: max-height 0.45s cubic-bezier(0, 1, 0, 1);
    }

    .p-toggleable-content-enter-active {
        overflow: hidden;
        transition: max-height 1s ease-in-out;
    }

    .p-disabled,
    .p-disabled * {
        cursor: default;
        pointer-events: none;
        user-select: none;
    }

    .p-disabled,
    .p-component:disabled {
        opacity: dt('disabled.opacity');
    }

    .pi {
        font-size: dt('icon.size');
    }

    .p-icon {
        width: dt('icon.size');
        height: dt('icon.size');
    }

    .p-overlay-mask {
        background: dt('mask.background');
        color: dt('mask.color');
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
    }

    .p-overlay-mask-enter {
        animation: p-overlay-mask-enter-animation dt('mask.transition.duration') forwards;
    }

    .p-overlay-mask-leave {
        animation: p-overlay-mask-leave-animation dt('mask.transition.duration') forwards;
    }

    @keyframes p-overlay-mask-enter-animation {
        from {
            background: transparent;
        }
        to {
            background: dt('mask.background');
        }
    }
    @keyframes p-overlay-mask-leave-animation {
        from {
            background: dt('mask.background');
        }
        to {
            background: transparent;
        }
    }
`;function s0(t){"@babel/helpers - typeof";return s0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s0(t)}function IL(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);e&&(l=l.filter(function(d){return Object.getOwnPropertyDescriptor(t,d).enumerable})),n.push.apply(n,l)}return n}function AL(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?IL(Object(n),!0).forEach(function(l){Dee(t,l,n[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):IL(Object(n)).forEach(function(l){Object.defineProperty(t,l,Object.getOwnPropertyDescriptor(n,l))})}return t}function Dee(t,e,n){return(e=Lee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Lee(t){var e=zee(t,"string");return s0(e)=="symbol"?e:e+""}function zee(t,e){if(s0(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var l=n.call(t,e);if(s0(l)!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Fee(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;Uv()&&Uv().components?H0(t):e?t():G0(t)}var Bee=0;function Nee(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=bi(!1),l=bi(t),d=bi(null),f=KB()?window.document:void 0,x=e.document,s=x===void 0?f:x,C=e.immediate,P=C===void 0?!0:C,L=e.manual,$=L===void 0?!1:L,V=e.name,j=V===void 0?"style_".concat(++Bee):V,ue=e.id,de=ue===void 0?void 0:ue,Te=e.media,Be=Te===void 0?void 0:Te,Ge=e.nonce,Ye=Ge===void 0?void 0:Ge,Ne=e.first,Mt=Ne===void 0?!1:Ne,kt=e.onMounted,Pe=kt===void 0?void 0:kt,we=e.onUpdated,Se=we===void 0?void 0:we,je=e.onLoad,Re=je===void 0?void 0:je,Ve=e.props,ke=Ve===void 0?{}:Ve,Mn=function(){},bn=function(ar){var Br=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(s){var ei=AL(AL({},ke),Br),or=ei.name||j,vr=ei.id||de,oi=ei.nonce||Ye;d.value=s.querySelector('style[data-primevue-style-id="'.concat(or,'"]'))||s.getElementById(vr)||s.createElement("style"),d.value.isConnected||(l.value=ar||t,Fw(d.value,{type:"text/css",id:vr,media:Be,nonce:oi}),Mt?s.head.prepend(d.value):s.head.appendChild(d.value),eP(d.value,"data-primevue-style-id",or),Fw(d.value,ei),d.value.onload=function(uo){return Re?.(uo,{name:or})},Pe?.(or)),!n.value&&(Mn=ru(l,function(uo){d.value.textContent=uo,Se?.(or)},{immediate:!0}),n.value=!0)}},mn=function(){!s||!n.value||(Mn(),gee(d.value)&&s.head.removeChild(d.value),n.value=!1,d.value=null)};return P&&!$&&Fee(bn),{id:de,name:j,el:d,css:l,unload:mn,load:bn,isLoaded:zI(n)}}function a0(t){"@babel/helpers - typeof";return a0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a0(t)}var PL,RL,kL,OL;function ML(t,e){return jee(t)||Uee(t,e)||$ee(t,e)||Vee()}function Vee(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function $ee(t,e){if(t){if(typeof t=="string")return DL(t,e);var n={}.toString.call(t).slice(8,-1);return n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set"?Array.from(t):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?DL(t,e):void 0}}function DL(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,l=Array(e);n<e;n++)l[n]=t[n];return l}function Uee(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var l,d,f,x,s=[],C=!0,P=!1;try{if(f=(n=n.call(t)).next,e!==0)for(;!(C=(l=f.call(n)).done)&&(s.push(l.value),s.length!==e);C=!0);}catch(L){P=!0,d=L}finally{try{if(!C&&n.return!=null&&(x=n.return(),Object(x)!==x))return}finally{if(P)throw d}}return s}}function jee(t){if(Array.isArray(t))return t}function LL(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);e&&(l=l.filter(function(d){return Object.getOwnPropertyDescriptor(t,d).enumerable})),n.push.apply(n,l)}return n}function wC(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?LL(Object(n),!0).forEach(function(l){Gee(t,l,n[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):LL(Object(n)).forEach(function(l){Object.defineProperty(t,l,Object.getOwnPropertyDescriptor(n,l))})}return t}function Gee(t,e,n){return(e=Hee(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Hee(t){var e=Wee(t,"string");return a0(e)=="symbol"?e:e+""}function Wee(t,e){if(a0(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var l=n.call(t,e);if(a0(l)!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function _x(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}var qee=function(e){var n=e.dt;return`
.p-hidden-accessible {
    border: 0;
    clip: rect(0 0 0 0);
    height: 1px;
    margin: -1px;
    opacity: 0;
    overflow: hidden;
    padding: 0;
    pointer-events: none;
    position: absolute;
    white-space: nowrap;
    width: 1px;
}

.p-overflow-hidden {
    overflow: hidden;
    padding-right: `.concat(n("scrollbar.width"),`;
}
`)},Kee={},Zee={},xi={name:"base",css:qee,style:Mee,classes:Kee,inlineStyles:Zee,load:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:function(f){return f},d=l(gx(PL||(PL=_x(["",""])),e));return si(d)?Nee(Ov(d),wC({name:this.name},n)):{}},loadCSS:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.load(this.css,e)},loadStyle:function(){var e=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";return this.load(this.style,n,function(){var d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return vo.transformCSS(n.name||e.name,"".concat(d).concat(gx(RL||(RL=_x(["",""])),l)))})},getCommonTheme:function(e){return vo.getCommon(this.name,e)},getComponentTheme:function(e){return vo.getComponent(this.name,e)},getDirectiveTheme:function(e){return vo.getDirective(this.name,e)},getPresetTheme:function(e,n,l){return vo.getCustomPreset(this.name,e,n,l)},getLayerOrderThemeCSS:function(){return vo.getLayerOrderCSS(this.name)},getStyleSheet:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(this.css){var l=ul(this.css,{dt:pp})||"",d=Ov(gx(kL||(kL=_x(["","",""])),l,e)),f=Object.entries(n).reduce(function(x,s){var C=ML(s,2),P=C[0],L=C[1];return x.push("".concat(P,'="').concat(L,'"'))&&x},[]).join(" ");return si(d)?'<style type="text/css" data-primevue-style-id="'.concat(this.name,'" ').concat(f,">").concat(d,"</style>"):""}return""},getCommonThemeStyleSheet:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return vo.getCommonStyleSheet(this.name,e,n)},getThemeStyleSheet:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},l=[vo.getStyleSheet(this.name,e,n)];if(this.style){var d=this.name==="base"?"global-style":"".concat(this.name,"-style"),f=gx(OL||(OL=_x(["",""])),ul(this.style,{dt:pp})),x=Ov(vo.transformCSS(d,f)),s=Object.entries(n).reduce(function(C,P){var L=ML(P,2),$=L[0],V=L[1];return C.push("".concat($,'="').concat(V,'"'))&&C},[]).join(" ");si(x)&&l.push('<style type="text/css" data-primevue-style-id="'.concat(d,'" ').concat(s,">").concat(x,"</style>"))}return l.join("")},extend:function(e){return wC(wC({},this),{},{css:void 0,style:void 0},e)}};function Xee(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"pc",e=RU();return"".concat(t).concat(e.replace("v-","").replaceAll("-","_"))}var zL=xi.extend({name:"common"});function l0(t){"@babel/helpers - typeof";return l0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l0(t)}function Yee(t){return oN(t)||Jee(t)||iN(t)||rN()}function Jee(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function Jy(t,e){return oN(t)||Qee(t,e)||iN(t,e)||rN()}function rN(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function iN(t,e){if(t){if(typeof t=="string")return FL(t,e);var n={}.toString.call(t).slice(8,-1);return n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set"?Array.from(t):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?FL(t,e):void 0}}function FL(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,l=Array(e);n<e;n++)l[n]=t[n];return l}function Qee(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var l,d,f,x,s=[],C=!0,P=!1;try{if(f=(n=n.call(t)).next,e===0){if(Object(n)!==n)return;C=!1}else for(;!(C=(l=f.call(n)).done)&&(s.push(l.value),s.length!==e);C=!0);}catch(L){P=!0,d=L}finally{try{if(!C&&n.return!=null&&(x=n.return(),Object(x)!==x))return}finally{if(P)throw d}}return s}}function oN(t){if(Array.isArray(t))return t}function BL(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);e&&(l=l.filter(function(d){return Object.getOwnPropertyDescriptor(t,d).enumerable})),n.push.apply(n,l)}return n}function Mi(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?BL(Object(n),!0).forEach(function(l){fv(t,l,n[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):BL(Object(n)).forEach(function(l){Object.defineProperty(t,l,Object.getOwnPropertyDescriptor(n,l))})}return t}function fv(t,e,n){return(e=ete(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ete(t){var e=tte(t,"string");return l0(e)=="symbol"?e:e+""}function tte(t,e){if(l0(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var l=n.call(t,e);if(l0(l)!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Yi={name:"BaseComponent",props:{pt:{type:Object,default:void 0},ptOptions:{type:Object,default:void 0},unstyled:{type:Boolean,default:void 0},dt:{type:Object,default:void 0}},inject:{$parentInstance:{default:void 0}},watch:{isUnstyled:{immediate:!0,handler:function(e){Vs.off("theme:change",this._loadCoreStyles),e||(this._loadCoreStyles(),this._themeChangeListener(this._loadCoreStyles))}},dt:{immediate:!0,handler:function(e,n){var l=this;Vs.off("theme:change",this._themeScopedListener),e?(this._loadScopedThemeStyles(e),this._themeScopedListener=function(){return l._loadScopedThemeStyles(e)},this._themeChangeListener(this._themeScopedListener)):this._unloadScopedThemeStyles()}}},scopedStyleEl:void 0,rootEl:void 0,uid:void 0,$attrSelector:void 0,beforeCreate:function(){var e,n,l,d,f,x,s,C,P,L,$,V=(e=this.pt)===null||e===void 0?void 0:e._usept,j=V?(n=this.pt)===null||n===void 0||(n=n.originalValue)===null||n===void 0?void 0:n[this.$.type.name]:void 0,ue=V?(l=this.pt)===null||l===void 0||(l=l.value)===null||l===void 0?void 0:l[this.$.type.name]:this.pt;(d=ue||j)===null||d===void 0||(d=d.hooks)===null||d===void 0||(f=d.onBeforeCreate)===null||f===void 0||f.call(d);var de=(x=this.$primevueConfig)===null||x===void 0||(x=x.pt)===null||x===void 0?void 0:x._usept,Te=de?(s=this.$primevue)===null||s===void 0||(s=s.config)===null||s===void 0||(s=s.pt)===null||s===void 0?void 0:s.originalValue:void 0,Be=de?(C=this.$primevue)===null||C===void 0||(C=C.config)===null||C===void 0||(C=C.pt)===null||C===void 0?void 0:C.value:(P=this.$primevue)===null||P===void 0||(P=P.config)===null||P===void 0?void 0:P.pt;(L=Be||Te)===null||L===void 0||(L=L[this.$.type.name])===null||L===void 0||(L=L.hooks)===null||L===void 0||($=L.onBeforeCreate)===null||$===void 0||$.call(L),this.$attrSelector=Xee(),this.uid=this.$attrs.id||this.$attrSelector.replace("pc","pv_id_")},created:function(){this._hook("onCreated")},beforeMount:function(){var e;this.rootEl=Lh(Rp(this.$el)?this.$el:(e=this.$el)===null||e===void 0?void 0:e.parentElement,"[".concat(this.$attrSelector,"]")),this.rootEl&&(this.rootEl.$pc=Mi({name:this.$.type.name,attrSelector:this.$attrSelector},this.$params)),this._loadStyles(),this._hook("onBeforeMount")},mounted:function(){this._hook("onMounted")},beforeUpdate:function(){this._hook("onBeforeUpdate")},updated:function(){this._hook("onUpdated")},beforeUnmount:function(){this._hook("onBeforeUnmount")},unmounted:function(){this._removeThemeListeners(),this._unloadScopedThemeStyles(),this._hook("onUnmounted")},methods:{_hook:function(e){if(!this.$options.hostName){var n=this._usePT(this._getPT(this.pt,this.$.type.name),this._getOptionValue,"hooks.".concat(e)),l=this._useDefaultPT(this._getOptionValue,"hooks.".concat(e));n?.(),l?.()}},_mergeProps:function(e){for(var n=arguments.length,l=new Array(n>1?n-1:0),d=1;d<n;d++)l[d-1]=arguments[d];return LT(e)?e.apply(void 0,l):ot.apply(void 0,l)},_load:function(){Mh.isStyleNameLoaded("base")||(xi.loadCSS(this.$styleOptions),this._loadGlobalStyles(),Mh.setLoadedStyleName("base")),this._loadThemeStyles()},_loadStyles:function(){this._load(),this._themeChangeListener(this._load)},_loadCoreStyles:function(){var e,n;!Mh.isStyleNameLoaded((e=this.$style)===null||e===void 0?void 0:e.name)&&(n=this.$style)!==null&&n!==void 0&&n.name&&(zL.loadCSS(this.$styleOptions),this.$options.style&&this.$style.loadCSS(this.$styleOptions),Mh.setLoadedStyleName(this.$style.name))},_loadGlobalStyles:function(){var e=this._useGlobalPT(this._getOptionValue,"global.css",this.$params);si(e)&&xi.load(e,Mi({name:"global"},this.$styleOptions))},_loadThemeStyles:function(){var e,n;if(!(this.isUnstyled||this.$theme==="none")){if(!vo.isStyleNameLoaded("common")){var l,d,f=((l=this.$style)===null||l===void 0||(d=l.getCommonTheme)===null||d===void 0?void 0:d.call(l))||{},x=f.primitive,s=f.semantic,C=f.global,P=f.style;xi.load(x?.css,Mi({name:"primitive-variables"},this.$styleOptions)),xi.load(s?.css,Mi({name:"semantic-variables"},this.$styleOptions)),xi.load(C?.css,Mi({name:"global-variables"},this.$styleOptions)),xi.loadStyle(Mi({name:"global-style"},this.$styleOptions),P),vo.setLoadedStyleName("common")}if(!vo.isStyleNameLoaded((e=this.$style)===null||e===void 0?void 0:e.name)&&(n=this.$style)!==null&&n!==void 0&&n.name){var L,$,V,j,ue=((L=this.$style)===null||L===void 0||($=L.getComponentTheme)===null||$===void 0?void 0:$.call(L))||{},de=ue.css,Te=ue.style;(V=this.$style)===null||V===void 0||V.load(de,Mi({name:"".concat(this.$style.name,"-variables")},this.$styleOptions)),(j=this.$style)===null||j===void 0||j.loadStyle(Mi({name:"".concat(this.$style.name,"-style")},this.$styleOptions),Te),vo.setLoadedStyleName(this.$style.name)}if(!vo.isStyleNameLoaded("layer-order")){var Be,Ge,Ye=(Be=this.$style)===null||Be===void 0||(Ge=Be.getLayerOrderThemeCSS)===null||Ge===void 0?void 0:Ge.call(Be);xi.load(Ye,Mi({name:"layer-order",first:!0},this.$styleOptions)),vo.setLoadedStyleName("layer-order")}}},_loadScopedThemeStyles:function(e){var n,l,d,f=((n=this.$style)===null||n===void 0||(l=n.getPresetTheme)===null||l===void 0?void 0:l.call(n,e,"[".concat(this.$attrSelector,"]")))||{},x=f.css,s=(d=this.$style)===null||d===void 0?void 0:d.load(x,Mi({name:"".concat(this.$attrSelector,"-").concat(this.$style.name)},this.$styleOptions));this.scopedStyleEl=s.el},_unloadScopedThemeStyles:function(){var e;(e=this.scopedStyleEl)===null||e===void 0||(e=e.value)===null||e===void 0||e.remove()},_themeChangeListener:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:function(){};Mh.clearLoadedStyleNames(),Vs.on("theme:change",e)},_removeThemeListeners:function(){Vs.off("theme:change",this._loadCoreStyles),Vs.off("theme:change",this._load),Vs.off("theme:change",this._themeScopedListener)},_getHostInstance:function(e){return e?this.$options.hostName?e.$.type.name===this.$options.hostName?e:this._getHostInstance(e.$parentInstance):e.$parentInstance:void 0},_getPropValue:function(e){var n;return this[e]||((n=this._getHostInstance(this))===null||n===void 0?void 0:n[e])},_getOptionValue:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return YA(e,n,l)},_getPTValue:function(){var e,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},f=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0,x=/./g.test(l)&&!!d[l.split(".")[0]],s=this._getPropValue("ptOptions")||((e=this.$primevueConfig)===null||e===void 0?void 0:e.ptOptions)||{},C=s.mergeSections,P=C===void 0?!0:C,L=s.mergeProps,$=L===void 0?!1:L,V=f?x?this._useGlobalPT(this._getPTClassValue,l,d):this._useDefaultPT(this._getPTClassValue,l,d):void 0,j=x?void 0:this._getPTSelf(n,this._getPTClassValue,l,Mi(Mi({},d),{},{global:V||{}})),ue=this._getPTDatasets(l);return P||!P&&j?$?this._mergeProps($,V,j,ue):Mi(Mi(Mi({},V),j),ue):Mi(Mi({},j),ue)},_getPTSelf:function(){for(var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=arguments.length,l=new Array(n>1?n-1:0),d=1;d<n;d++)l[d-1]=arguments[d];return ot(this._usePT.apply(this,[this._getPT(e,this.$name)].concat(l)),this._usePT.apply(this,[this.$_attrsPT].concat(l)))},_getPTDatasets:function(){var e,n,l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",d="data-pc-",f=l==="root"&&si((e=this.pt)===null||e===void 0?void 0:e["data-pc-section"]);return l!=="transition"&&Mi(Mi({},l==="root"&&Mi(Mi(fv({},"".concat(d,"name"),tu(f?(n=this.pt)===null||n===void 0?void 0:n["data-pc-section"]:this.$.type.name)),f&&fv({},"".concat(d,"extend"),tu(this.$.type.name))),{},fv({},"".concat(this.$attrSelector),""))),{},fv({},"".concat(d,"section"),tu(l)))},_getPTClassValue:function(){var e=this._getOptionValue.apply(this,arguments);return Ha(e)||NB(e)?{class:e}:e},_getPT:function(e){var n=this,l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",d=arguments.length>2?arguments[2]:void 0,f=function(s){var C,P=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,L=d?d(s):s,$=tu(l),V=tu(n.$name);return(C=P?$!==V?L?.[$]:void 0:L?.[$])!==null&&C!==void 0?C:L};return e!=null&&e.hasOwnProperty("_usept")?{_usept:e._usept,originalValue:f(e.originalValue),value:f(e.value)}:f(e,!0)},_usePT:function(e,n,l,d){var f=function(de){return n(de,l,d)};if(e!=null&&e.hasOwnProperty("_usept")){var x,s=e._usept||((x=this.$primevueConfig)===null||x===void 0?void 0:x.ptOptions)||{},C=s.mergeSections,P=C===void 0?!0:C,L=s.mergeProps,$=L===void 0?!1:L,V=f(e.originalValue),j=f(e.value);return V===void 0&&j===void 0?void 0:Ha(j)?j:Ha(V)?V:P||!P&&j?$?this._mergeProps($,V,j):Mi(Mi({},V),j):j}return f(e)},_useGlobalPT:function(e,n,l){return this._usePT(this.globalPT,e,n,l)},_useDefaultPT:function(e,n,l){return this._usePT(this.defaultPT,e,n,l)},ptm:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._getPTValue(this.pt,e,Mi(Mi({},this.$params),n))},ptmi:function(){var e,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},d=ot(this.$_attrsWithoutPT,this.ptm(n,l));return d?.hasOwnProperty("id")&&((e=d.id)!==null&&e!==void 0||(d.id=this.$id)),d},ptmo:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this._getPTValue(e,n,Mi({instance:this},l),!1)},cx:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this.isUnstyled?void 0:this._getOptionValue(this.$style.classes,e,Mi(Mi({},this.$params),n))},sx:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(n){var d=this._getOptionValue(this.$style.inlineStyles,e,Mi(Mi({},this.$params),l)),f=this._getOptionValue(zL.inlineStyles,e,Mi(Mi({},this.$params),l));return[f,d]}}},computed:{globalPT:function(){var e,n=this;return this._getPT((e=this.$primevueConfig)===null||e===void 0?void 0:e.pt,void 0,function(l){return ul(l,{instance:n})})},defaultPT:function(){var e,n=this;return this._getPT((e=this.$primevueConfig)===null||e===void 0?void 0:e.pt,void 0,function(l){return n._getOptionValue(l,n.$name,Mi({},n.$params))||ul(l,Mi({},n.$params))})},isUnstyled:function(){var e;return this.unstyled!==void 0?this.unstyled:(e=this.$primevueConfig)===null||e===void 0?void 0:e.unstyled},$id:function(){return this.$attrs.id||this.uid},$inProps:function(){var e,n=Object.keys(((e=this.$.vnode)===null||e===void 0?void 0:e.props)||{});return Object.fromEntries(Object.entries(this.$props).filter(function(l){var d=Jy(l,1),f=d[0];return n?.includes(f)}))},$theme:function(){var e;return(e=this.$primevueConfig)===null||e===void 0?void 0:e.theme},$style:function(){return Mi(Mi({classes:void 0,inlineStyles:void 0,load:function(){},loadCSS:function(){},loadStyle:function(){}},(this._getHostInstance(this)||{}).$style),this.$options.style)},$styleOptions:function(){var e;return{nonce:(e=this.$primevueConfig)===null||e===void 0||(e=e.csp)===null||e===void 0?void 0:e.nonce}},$primevueConfig:function(){var e;return(e=this.$primevue)===null||e===void 0?void 0:e.config},$name:function(){return this.$options.hostName||this.$.type.name},$params:function(){var e=this._getHostInstance(this)||this.$parent;return{instance:this,props:this.$props,state:this.$data,attrs:this.$attrs,parent:{instance:e,props:e?.$props,state:e?.$data,attrs:e?.$attrs}}},$_attrsPT:function(){return Object.entries(this.$attrs||{}).filter(function(e){var n=Jy(e,1),l=n[0];return l?.startsWith("pt:")}).reduce(function(e,n){var l=Jy(n,2),d=l[0],f=l[1],x=d.split(":"),s=Yee(x),C=s.slice(1);return C?.reduce(function(P,L,$,V){return!P[L]&&(P[L]=$===V.length-1?f:{}),P[L]},e),e},{})},$_attrsWithoutPT:function(){return Object.entries(this.$attrs||{}).filter(function(e){var n=Jy(e,1),l=n[0];return!(l!=null&&l.startsWith("pt:"))}).reduce(function(e,n){var l=Jy(n,2),d=l[0],f=l[1];return e[d]=f,e},{})}}},nte=`
.p-icon {
    display: inline-block;
    vertical-align: baseline;
    flex-shrink: 0;
}

.p-icon-spin {
    -webkit-animation: p-icon-spin 2s infinite linear;
    animation: p-icon-spin 2s infinite linear;
}

@-webkit-keyframes p-icon-spin {
    0% {
        -webkit-transform: rotate(0deg);
        transform: rotate(0deg);
    }
    100% {
        -webkit-transform: rotate(359deg);
        transform: rotate(359deg);
    }
}

@keyframes p-icon-spin {
    0% {
        -webkit-transform: rotate(0deg);
        transform: rotate(0deg);
    }
    100% {
        -webkit-transform: rotate(359deg);
        transform: rotate(359deg);
    }
}
`,rte=xi.extend({name:"baseicon",css:nte});function c0(t){"@babel/helpers - typeof";return c0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c0(t)}function NL(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);e&&(l=l.filter(function(d){return Object.getOwnPropertyDescriptor(t,d).enumerable})),n.push.apply(n,l)}return n}function VL(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?NL(Object(n),!0).forEach(function(l){ite(t,l,n[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):NL(Object(n)).forEach(function(l){Object.defineProperty(t,l,Object.getOwnPropertyDescriptor(n,l))})}return t}function ite(t,e,n){return(e=ote(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ote(t){var e=ste(t,"string");return c0(e)=="symbol"?e:e+""}function ste(t,e){if(c0(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var l=n.call(t,e);if(c0(l)!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var go={name:"BaseIcon",extends:Yi,props:{label:{type:String,default:void 0},spin:{type:Boolean,default:!1}},style:rte,provide:function(){return{$pcIcon:this,$parentInstance:this}},methods:{pti:function(){var e=Wa(this.label);return VL(VL({},!this.isUnstyled&&{class:["p-icon",{"p-icon-spin":this.spin}]}),{},{role:e?void 0:"img","aria-label":e?void 0:this.label,"aria-hidden":e})}}},cb={name:"SpinnerIcon",extends:go};function ate(t){return dte(t)||ute(t)||cte(t)||lte()}function lte(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function cte(t,e){if(t){if(typeof t=="string")return k2(t,e);var n={}.toString.call(t).slice(8,-1);return n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set"?Array.from(t):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?k2(t,e):void 0}}function ute(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function dte(t){if(Array.isArray(t))return k2(t)}function k2(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,l=Array(e);n<e;n++)l[n]=t[n];return l}function hte(t,e,n,l,d,f){return Me(),ft("svg",ot({width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},t.pti()),ate(e[0]||(e[0]=[Ze("path",{d:"M6.99701 14C5.85441 13.999 4.72939 13.7186 3.72012 13.1832C2.71084 12.6478 1.84795 11.8737 1.20673 10.9284C0.565504 9.98305 0.165424 8.89526 0.041387 7.75989C-0.0826496 6.62453 0.073125 5.47607 0.495122 4.4147C0.917119 3.35333 1.59252 2.4113 2.46241 1.67077C3.33229 0.930247 4.37024 0.413729 5.4857 0.166275C6.60117 -0.0811796 7.76026 -0.0520535 8.86188 0.251112C9.9635 0.554278 10.9742 1.12227 11.8057 1.90555C11.915 2.01493 11.9764 2.16319 11.9764 2.31778C11.9764 2.47236 11.915 2.62062 11.8057 2.73C11.7521 2.78503 11.688 2.82877 11.6171 2.85864C11.5463 2.8885 11.4702 2.90389 11.3933 2.90389C11.3165 2.90389 11.2404 2.8885 11.1695 2.85864C11.0987 2.82877 11.0346 2.78503 10.9809 2.73C9.9998 1.81273 8.73246 1.26138 7.39226 1.16876C6.05206 1.07615 4.72086 1.44794 3.62279 2.22152C2.52471 2.99511 1.72683 4.12325 1.36345 5.41602C1.00008 6.70879 1.09342 8.08723 1.62775 9.31926C2.16209 10.5513 3.10478 11.5617 4.29713 12.1803C5.48947 12.7989 6.85865 12.988 8.17414 12.7157C9.48963 12.4435 10.6711 11.7264 11.5196 10.6854C12.3681 9.64432 12.8319 8.34282 12.8328 7C12.8328 6.84529 12.8943 6.69692 13.0038 6.58752C13.1132 6.47812 13.2616 6.41667 13.4164 6.41667C13.5712 6.41667 13.7196 6.47812 13.8291 6.58752C13.9385 6.69692 14 6.84529 14 7C14 8.85651 13.2622 10.637 11.9489 11.9497C10.6356 13.2625 8.85432 14 6.99701 14Z",fill:"currentColor"},null,-1)])),16)}cb.render=hte;var fte=`
    .p-badge {
        display: inline-flex;
        border-radius: dt('badge.border.radius');
        align-items: center;
        justify-content: center;
        padding: dt('badge.padding');
        background: dt('badge.primary.background');
        color: dt('badge.primary.color');
        font-size: dt('badge.font.size');
        font-weight: dt('badge.font.weight');
        min-width: dt('badge.min.width');
        height: dt('badge.height');
    }

    .p-badge-dot {
        width: dt('badge.dot.size');
        min-width: dt('badge.dot.size');
        height: dt('badge.dot.size');
        border-radius: 50%;
        padding: 0;
    }

    .p-badge-circle {
        padding: 0;
        border-radius: 50%;
    }

    .p-badge-secondary {
        background: dt('badge.secondary.background');
        color: dt('badge.secondary.color');
    }

    .p-badge-success {
        background: dt('badge.success.background');
        color: dt('badge.success.color');
    }

    .p-badge-info {
        background: dt('badge.info.background');
        color: dt('badge.info.color');
    }

    .p-badge-warn {
        background: dt('badge.warn.background');
        color: dt('badge.warn.color');
    }

    .p-badge-danger {
        background: dt('badge.danger.background');
        color: dt('badge.danger.color');
    }

    .p-badge-contrast {
        background: dt('badge.contrast.background');
        color: dt('badge.contrast.color');
    }

    .p-badge-sm {
        font-size: dt('badge.sm.font.size');
        min-width: dt('badge.sm.min.width');
        height: dt('badge.sm.height');
    }

    .p-badge-lg {
        font-size: dt('badge.lg.font.size');
        min-width: dt('badge.lg.min.width');
        height: dt('badge.lg.height');
    }

    .p-badge-xl {
        font-size: dt('badge.xl.font.size');
        min-width: dt('badge.xl.min.width');
        height: dt('badge.xl.height');
    }
`,pte={root:function(e){var n=e.props,l=e.instance;return["p-badge p-component",{"p-badge-circle":si(n.value)&&String(n.value).length===1,"p-badge-dot":Wa(n.value)&&!l.$slots.default,"p-badge-sm":n.size==="small","p-badge-lg":n.size==="large","p-badge-xl":n.size==="xlarge","p-badge-info":n.severity==="info","p-badge-success":n.severity==="success","p-badge-warn":n.severity==="warn","p-badge-danger":n.severity==="danger","p-badge-secondary":n.severity==="secondary","p-badge-contrast":n.severity==="contrast"}]}},mte=xi.extend({name:"badge",style:fte,classes:pte}),gte={name:"BaseBadge",extends:Yi,props:{value:{type:[String,Number],default:null},severity:{type:String,default:null},size:{type:String,default:null}},style:mte,provide:function(){return{$pcBadge:this,$parentInstance:this}}};function u0(t){"@babel/helpers - typeof";return u0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u0(t)}function $L(t,e,n){return(e=_te(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _te(t){var e=yte(t,"string");return u0(e)=="symbol"?e:e+""}function yte(t,e){if(u0(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var l=n.call(t,e);if(u0(l)!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var nP={name:"Badge",extends:gte,inheritAttrs:!1,computed:{dataP:function(){return Rs($L($L({circle:this.value!=null&&String(this.value).length===1,empty:this.value==null&&!this.$slots.default},this.severity,this.severity),this.size,this.size))}}},vte=["data-p"];function bte(t,e,n,l,d,f){return Me(),ft("span",ot({class:t.cx("root"),"data-p":f.dataP},t.ptmi("root")),[ir(t.$slots,"default",{},function(){return[Ra(Fr(t.value),1)]})],16,vte)}nP.render=bte;var zh=tP();function d0(t){"@babel/helpers - typeof";return d0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},d0(t)}function UL(t,e){return Ste(t)||Tte(t,e)||wte(t,e)||xte()}function xte(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function wte(t,e){if(t){if(typeof t=="string")return jL(t,e);var n={}.toString.call(t).slice(8,-1);return n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set"?Array.from(t):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?jL(t,e):void 0}}function jL(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,l=Array(e);n<e;n++)l[n]=t[n];return l}function Tte(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var l,d,f,x,s=[],C=!0,P=!1;try{if(f=(n=n.call(t)).next,e!==0)for(;!(C=(l=f.call(n)).done)&&(s.push(l.value),s.length!==e);C=!0);}catch(L){P=!0,d=L}finally{try{if(!C&&n.return!=null&&(x=n.return(),Object(x)!==x))return}finally{if(P)throw d}}return s}}function Ste(t){if(Array.isArray(t))return t}function GL(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);e&&(l=l.filter(function(d){return Object.getOwnPropertyDescriptor(t,d).enumerable})),n.push.apply(n,l)}return n}function Zi(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?GL(Object(n),!0).forEach(function(l){O2(t,l,n[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):GL(Object(n)).forEach(function(l){Object.defineProperty(t,l,Object.getOwnPropertyDescriptor(n,l))})}return t}function O2(t,e,n){return(e=Ete(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ete(t){var e=Cte(t,"string");return d0(e)=="symbol"?e:e+""}function Cte(t,e){if(d0(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var l=n.call(t,e);if(d0(l)!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var ui={_getMeta:function(){return[du(arguments.length<=0?void 0:arguments[0])||arguments.length<=0?void 0:arguments[0],ul(du(arguments.length<=0?void 0:arguments[0])?arguments.length<=0?void 0:arguments[0]:arguments.length<=1?void 0:arguments[1])]},_getConfig:function(e,n){var l,d,f;return(l=(e==null||(d=e.instance)===null||d===void 0?void 0:d.$primevue)||(n==null||(f=n.ctx)===null||f===void 0||(f=f.appContext)===null||f===void 0||(f=f.config)===null||f===void 0||(f=f.globalProperties)===null||f===void 0?void 0:f.$primevue))===null||l===void 0?void 0:l.config},_getOptionValue:YA,_getPTValue:function(){var e,n,l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},f=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"",x=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,C=function(){var Ge=ui._getOptionValue.apply(ui,arguments);return Ha(Ge)||NB(Ge)?{class:Ge}:Ge},P=((e=l.binding)===null||e===void 0||(e=e.value)===null||e===void 0?void 0:e.ptOptions)||((n=l.$primevueConfig)===null||n===void 0?void 0:n.ptOptions)||{},L=P.mergeSections,$=L===void 0?!0:L,V=P.mergeProps,j=V===void 0?!1:V,ue=s?ui._useDefaultPT(l,l.defaultPT(),C,f,x):void 0,de=ui._usePT(l,ui._getPT(d,l.$name),C,f,Zi(Zi({},x),{},{global:ue||{}})),Te=ui._getPTDatasets(l,f);return $||!$&&de?j?ui._mergeProps(l,j,ue,de,Te):Zi(Zi(Zi({},ue),de),Te):Zi(Zi({},de),Te)},_getPTDatasets:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",l="data-pc-";return Zi(Zi({},n==="root"&&O2({},"".concat(l,"name"),tu(e.$name))),{},O2({},"".concat(l,"section"),tu(n)))},_getPT:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",l=arguments.length>2?arguments[2]:void 0,d=function(x){var s,C=l?l(x):x,P=tu(n);return(s=C?.[P])!==null&&s!==void 0?s:C};return e&&Object.hasOwn(e,"_usept")?{_usept:e._usept,originalValue:d(e.originalValue),value:d(e.value)}:d(e)},_usePT:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0,l=arguments.length>2?arguments[2]:void 0,d=arguments.length>3?arguments[3]:void 0,f=arguments.length>4?arguments[4]:void 0,x=function(Te){return l(Te,d,f)};if(n&&Object.hasOwn(n,"_usept")){var s,C=n._usept||((s=e.$primevueConfig)===null||s===void 0?void 0:s.ptOptions)||{},P=C.mergeSections,L=P===void 0?!0:P,$=C.mergeProps,V=$===void 0?!1:$,j=x(n.originalValue),ue=x(n.value);return j===void 0&&ue===void 0?void 0:Ha(ue)?ue:Ha(j)?j:L||!L&&ue?V?ui._mergeProps(e,V,j,ue):Zi(Zi({},j),ue):ue}return x(n)},_useDefaultPT:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},l=arguments.length>2?arguments[2]:void 0,d=arguments.length>3?arguments[3]:void 0,f=arguments.length>4?arguments[4]:void 0;return ui._usePT(e,n,l,d,f)},_loadStyles:function(){var e,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},l=arguments.length>1?arguments[1]:void 0,d=arguments.length>2?arguments[2]:void 0,f=ui._getConfig(l,d),x={nonce:f==null||(e=f.csp)===null||e===void 0?void 0:e.nonce};ui._loadCoreStyles(n,x),ui._loadThemeStyles(n,x),ui._loadScopedThemeStyles(n,x),ui._removeThemeListeners(n),n.$loadStyles=function(){return ui._loadThemeStyles(n,x)},ui._themeChangeListener(n.$loadStyles)},_loadCoreStyles:function(){var e,n,l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},d=arguments.length>1?arguments[1]:void 0;if(!Mh.isStyleNameLoaded((e=l.$style)===null||e===void 0?void 0:e.name)&&(n=l.$style)!==null&&n!==void 0&&n.name){var f;xi.loadCSS(d),(f=l.$style)===null||f===void 0||f.loadCSS(d),Mh.setLoadedStyleName(l.$style.name)}},_loadThemeStyles:function(){var e,n,l,d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},f=arguments.length>1?arguments[1]:void 0;if(!(d!=null&&d.isUnstyled()||(d==null||(e=d.theme)===null||e===void 0?void 0:e.call(d))==="none")){if(!vo.isStyleNameLoaded("common")){var x,s,C=((x=d.$style)===null||x===void 0||(s=x.getCommonTheme)===null||s===void 0?void 0:s.call(x))||{},P=C.primitive,L=C.semantic,$=C.global,V=C.style;xi.load(P?.css,Zi({name:"primitive-variables"},f)),xi.load(L?.css,Zi({name:"semantic-variables"},f)),xi.load($?.css,Zi({name:"global-variables"},f)),xi.loadStyle(Zi({name:"global-style"},f),V),vo.setLoadedStyleName("common")}if(!vo.isStyleNameLoaded((n=d.$style)===null||n===void 0?void 0:n.name)&&(l=d.$style)!==null&&l!==void 0&&l.name){var j,ue,de,Te,Be=((j=d.$style)===null||j===void 0||(ue=j.getDirectiveTheme)===null||ue===void 0?void 0:ue.call(j))||{},Ge=Be.css,Ye=Be.style;(de=d.$style)===null||de===void 0||de.load(Ge,Zi({name:"".concat(d.$style.name,"-variables")},f)),(Te=d.$style)===null||Te===void 0||Te.loadStyle(Zi({name:"".concat(d.$style.name,"-style")},f),Ye),vo.setLoadedStyleName(d.$style.name)}if(!vo.isStyleNameLoaded("layer-order")){var Ne,Mt,kt=(Ne=d.$style)===null||Ne===void 0||(Mt=Ne.getLayerOrderThemeCSS)===null||Mt===void 0?void 0:Mt.call(Ne);xi.load(kt,Zi({name:"layer-order",first:!0},f)),vo.setLoadedStyleName("layer-order")}}},_loadScopedThemeStyles:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0,l=e.preset();if(l&&e.$attrSelector){var d,f,x,s=((d=e.$style)===null||d===void 0||(f=d.getPresetTheme)===null||f===void 0?void 0:f.call(d,l,"[".concat(e.$attrSelector,"]")))||{},C=s.css,P=(x=e.$style)===null||x===void 0?void 0:x.load(C,Zi({name:"".concat(e.$attrSelector,"-").concat(e.$style.name)},n));e.scopedStyleEl=P.el}},_themeChangeListener:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:function(){};Mh.clearLoadedStyleNames(),Vs.on("theme:change",e)},_removeThemeListeners:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Vs.off("theme:change",e.$loadStyles),e.$loadStyles=void 0},_hook:function(e,n,l,d,f,x){var s,C,P="on".concat(lee(n)),L=ui._getConfig(d,f),$=l?.$instance,V=ui._usePT($,ui._getPT(d==null||(s=d.value)===null||s===void 0?void 0:s.pt,e),ui._getOptionValue,"hooks.".concat(P)),j=ui._useDefaultPT($,L==null||(C=L.pt)===null||C===void 0||(C=C.directives)===null||C===void 0?void 0:C[e],ui._getOptionValue,"hooks.".concat(P)),ue={el:l,binding:d,vnode:f,prevVnode:x};V?.($,ue),j?.($,ue)},_mergeProps:function(){for(var e=arguments.length>1?arguments[1]:void 0,n=arguments.length,l=new Array(n>2?n-2:0),d=2;d<n;d++)l[d-2]=arguments[d];return LT(e)?e.apply(void 0,l):ot.apply(void 0,l)},_extend:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},l=function(s,C,P,L,$){var V,j,ue,de;C._$instances=C._$instances||{};var Te=ui._getConfig(P,L),Be=C._$instances[e]||{},Ge=Wa(Be)?Zi(Zi({},n),n?.methods):{};C._$instances[e]=Zi(Zi({},Be),{},{$name:e,$host:C,$binding:P,$modifiers:P?.modifiers,$value:P?.value,$el:Be.$el||C||void 0,$style:Zi({classes:void 0,inlineStyles:void 0,load:function(){},loadCSS:function(){},loadStyle:function(){}},n?.style),$primevueConfig:Te,$attrSelector:(V=C.$pd)===null||V===void 0||(V=V[e])===null||V===void 0?void 0:V.attrSelector,defaultPT:function(){return ui._getPT(Te?.pt,void 0,function(Ne){var Mt;return Ne==null||(Mt=Ne.directives)===null||Mt===void 0?void 0:Mt[e]})},isUnstyled:function(){var Ne,Mt;return((Ne=C._$instances[e])===null||Ne===void 0||(Ne=Ne.$binding)===null||Ne===void 0||(Ne=Ne.value)===null||Ne===void 0?void 0:Ne.unstyled)!==void 0?(Mt=C._$instances[e])===null||Mt===void 0||(Mt=Mt.$binding)===null||Mt===void 0||(Mt=Mt.value)===null||Mt===void 0?void 0:Mt.unstyled:Te?.unstyled},theme:function(){var Ne;return(Ne=C._$instances[e])===null||Ne===void 0||(Ne=Ne.$primevueConfig)===null||Ne===void 0?void 0:Ne.theme},preset:function(){var Ne;return(Ne=C._$instances[e])===null||Ne===void 0||(Ne=Ne.$binding)===null||Ne===void 0||(Ne=Ne.value)===null||Ne===void 0?void 0:Ne.dt},ptm:function(){var Ne,Mt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",kt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return ui._getPTValue(C._$instances[e],(Ne=C._$instances[e])===null||Ne===void 0||(Ne=Ne.$binding)===null||Ne===void 0||(Ne=Ne.value)===null||Ne===void 0?void 0:Ne.pt,Mt,Zi({},kt))},ptmo:function(){var Ne=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},Mt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",kt=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return ui._getPTValue(C._$instances[e],Ne,Mt,kt,!1)},cx:function(){var Ne,Mt,kt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",Pe=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return(Ne=C._$instances[e])!==null&&Ne!==void 0&&Ne.isUnstyled()?void 0:ui._getOptionValue((Mt=C._$instances[e])===null||Mt===void 0||(Mt=Mt.$style)===null||Mt===void 0?void 0:Mt.classes,kt,Zi({},Pe))},sx:function(){var Ne,Mt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",kt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,Pe=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return kt?ui._getOptionValue((Ne=C._$instances[e])===null||Ne===void 0||(Ne=Ne.$style)===null||Ne===void 0?void 0:Ne.inlineStyles,Mt,Zi({},Pe)):void 0}},Ge),C.$instance=C._$instances[e],(j=(ue=C.$instance)[s])===null||j===void 0||j.call(ue,C,P,L,$),C["$".concat(e)]=C.$instance,ui._hook(e,s,C,P,L,$),C.$pd||(C.$pd={}),C.$pd[e]=Zi(Zi({},(de=C.$pd)===null||de===void 0?void 0:de[e]),{},{name:e,instance:C._$instances[e]})},d=function(s){var C,P,L,$=s._$instances[e],V=$?.watch,j=function(Te){var Be,Ge=Te.newValue,Ye=Te.oldValue;return V==null||(Be=V.config)===null||Be===void 0?void 0:Be.call($,Ge,Ye)},ue=function(Te){var Be,Ge=Te.newValue,Ye=Te.oldValue;return V==null||(Be=V["config.ripple"])===null||Be===void 0?void 0:Be.call($,Ge,Ye)};$.$watchersCallback={config:j,"config.ripple":ue},V==null||(C=V.config)===null||C===void 0||C.call($,$?.$primevueConfig),zh.on("config:change",j),V==null||(P=V["config.ripple"])===null||P===void 0||P.call($,$==null||(L=$.$primevueConfig)===null||L===void 0?void 0:L.ripple),zh.on("config:ripple:change",ue)},f=function(s){var C=s._$instances[e].$watchersCallback;C&&(zh.off("config:change",C.config),zh.off("config:ripple:change",C["config.ripple"]),s._$instances[e].$watchersCallback=void 0)};return{created:function(s,C,P,L){s.$pd||(s.$pd={}),s.$pd[e]={name:e,attrSelector:xee("pd")},l("created",s,C,P,L)},beforeMount:function(s,C,P,L){var $;ui._loadStyles(($=s.$pd[e])===null||$===void 0?void 0:$.instance,C,P),l("beforeMount",s,C,P,L),d(s)},mounted:function(s,C,P,L){var $;ui._loadStyles(($=s.$pd[e])===null||$===void 0?void 0:$.instance,C,P),l("mounted",s,C,P,L)},beforeUpdate:function(s,C,P,L){l("beforeUpdate",s,C,P,L)},updated:function(s,C,P,L){var $;ui._loadStyles(($=s.$pd[e])===null||$===void 0?void 0:$.instance,C,P),l("updated",s,C,P,L)},beforeUnmount:function(s,C,P,L){var $;f(s),ui._removeThemeListeners(($=s.$pd[e])===null||$===void 0?void 0:$.instance),l("beforeUnmount",s,C,P,L)},unmounted:function(s,C,P,L){var $;($=s.$pd[e])===null||$===void 0||($=$.instance)===null||$===void 0||($=$.scopedStyleEl)===null||$===void 0||($=$.value)===null||$===void 0||$.remove(),l("unmounted",s,C,P,L)}}},extend:function(){var e=ui._getMeta.apply(ui,arguments),n=UL(e,2),l=n[0],d=n[1];return Zi({extend:function(){var x=ui._getMeta.apply(ui,arguments),s=UL(x,2),C=s[0],P=s[1];return ui.extend(C,Zi(Zi(Zi({},d),d?.methods),P))}},ui._extend(l,d))}},Ite=`
    .p-ink {
        display: block;
        position: absolute;
        background: dt('ripple.background');
        border-radius: 100%;
        transform: scale(0);
        pointer-events: none;
    }

    .p-ink-active {
        animation: ripple 0.4s linear;
    }

    @keyframes ripple {
        100% {
            opacity: 0;
            transform: scale(2.5);
        }
    }
`,Ate={root:"p-ink"},Pte=xi.extend({name:"ripple-directive",style:Ite,classes:Ate}),Rte=ui.extend({style:Pte});function h0(t){"@babel/helpers - typeof";return h0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},h0(t)}function kte(t){return Lte(t)||Dte(t)||Mte(t)||Ote()}function Ote(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Mte(t,e){if(t){if(typeof t=="string")return M2(t,e);var n={}.toString.call(t).slice(8,-1);return n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set"?Array.from(t):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?M2(t,e):void 0}}function Dte(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function Lte(t){if(Array.isArray(t))return M2(t)}function M2(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,l=Array(e);n<e;n++)l[n]=t[n];return l}function HL(t,e,n){return(e=zte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function zte(t){var e=Fte(t,"string");return h0(e)=="symbol"?e:e+""}function Fte(t,e){if(h0(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var l=n.call(t,e);if(h0(l)!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var cf=Rte.extend("ripple",{watch:{"config.ripple":function(e){e?(this.createRipple(this.$host),this.bindEvents(this.$host),this.$host.setAttribute("data-pd-ripple",!0),this.$host.style.overflow="hidden",this.$host.style.position="relative"):(this.remove(this.$host),this.$host.removeAttribute("data-pd-ripple"))}},unmounted:function(e){this.remove(e)},timeout:void 0,methods:{bindEvents:function(e){e.addEventListener("mousedown",this.onMouseDown.bind(this))},unbindEvents:function(e){e.removeEventListener("mousedown",this.onMouseDown.bind(this))},createRipple:function(e){var n=this.getInk(e);n||(n=HB("span",HL(HL({role:"presentation","aria-hidden":!0,"data-p-ink":!0,"data-p-ink-active":!1,class:!this.isUnstyled()&&this.cx("root"),onAnimationEnd:this.onAnimationEnd.bind(this)},this.$attrSelector,""),"p-bind",this.ptm("root"))),e.appendChild(n),this.$el=n)},remove:function(e){var n=this.getInk(e);n&&(this.$host.style.overflow="",this.$host.style.position="",this.unbindEvents(e),n.removeEventListener("animationend",this.onAnimationEnd),n.remove())},onMouseDown:function(e){var n=this,l=e.currentTarget,d=this.getInk(l);if(!(!d||getComputedStyle(d,null).display==="none")){if(!this.isUnstyled()&&kh(d,"p-ink-active"),d.setAttribute("data-p-ink-active","false"),!op(d)&&!sp(d)){var f=Math.max(Ga(l),Bw(l));d.style.height=f+"px",d.style.width=f+"px"}var x=cg(l),s=e.pageX-x.left+document.body.scrollTop-sp(d)/2,C=e.pageY-x.top+document.body.scrollLeft-op(d)/2;d.style.top=C+"px",d.style.left=s+"px",!this.isUnstyled()&&hv(d,"p-ink-active"),d.setAttribute("data-p-ink-active","true"),this.timeout=setTimeout(function(){d&&(!n.isUnstyled()&&kh(d,"p-ink-active"),d.setAttribute("data-p-ink-active","false"))},401)}},onAnimationEnd:function(e){this.timeout&&clearTimeout(this.timeout),!this.isUnstyled()&&kh(e.currentTarget,"p-ink-active"),e.currentTarget.setAttribute("data-p-ink-active","false")},getInk:function(e){return e&&e.children?kte(e.children).find(function(n){return Cs(n,"data-pc-name")==="ripple"}):void 0}}}),Bte=`
    .p-button {
        display: inline-flex;
        cursor: pointer;
        user-select: none;
        align-items: center;
        justify-content: center;
        overflow: hidden;
        position: relative;
        color: dt('button.primary.color');
        background: dt('button.primary.background');
        border: 1px solid dt('button.primary.border.color');
        padding: dt('button.padding.y') dt('button.padding.x');
        font-size: 1rem;
        font-family: inherit;
        font-feature-settings: inherit;
        transition:
            background dt('button.transition.duration'),
            color dt('button.transition.duration'),
            border-color dt('button.transition.duration'),
            outline-color dt('button.transition.duration'),
            box-shadow dt('button.transition.duration');
        border-radius: dt('button.border.radius');
        outline-color: transparent;
        gap: dt('button.gap');
    }

    .p-button:disabled {
        cursor: default;
    }

    .p-button-icon-right {
        order: 1;
    }

    .p-button-icon-right:dir(rtl) {
        order: -1;
    }

    .p-button:not(.p-button-vertical) .p-button-icon:not(.p-button-icon-right):dir(rtl) {
        order: 1;
    }

    .p-button-icon-bottom {
        order: 2;
    }

    .p-button-icon-only {
        width: dt('button.icon.only.width');
        padding-inline-start: 0;
        padding-inline-end: 0;
        gap: 0;
    }

    .p-button-icon-only.p-button-rounded {
        border-radius: 50%;
        height: dt('button.icon.only.width');
    }

    .p-button-icon-only .p-button-label {
        visibility: hidden;
        width: 0;
    }

    .p-button-icon-only::after {
        content: "\0A0";
        visibility: hidden;
        width: 0;
    }

    .p-button-sm {
        font-size: dt('button.sm.font.size');
        padding: dt('button.sm.padding.y') dt('button.sm.padding.x');
    }

    .p-button-sm .p-button-icon {
        font-size: dt('button.sm.font.size');
    }

    .p-button-sm.p-button-icon-only {
        width: dt('button.sm.icon.only.width');
    }

    .p-button-sm.p-button-icon-only.p-button-rounded {
        height: dt('button.sm.icon.only.width');
    }

    .p-button-lg {
        font-size: dt('button.lg.font.size');
        padding: dt('button.lg.padding.y') dt('button.lg.padding.x');
    }

    .p-button-lg .p-button-icon {
        font-size: dt('button.lg.font.size');
    }

    .p-button-lg.p-button-icon-only {
        width: dt('button.lg.icon.only.width');
    }

    .p-button-lg.p-button-icon-only.p-button-rounded {
        height: dt('button.lg.icon.only.width');
    }

    .p-button-vertical {
        flex-direction: column;
    }

    .p-button-label {
        font-weight: dt('button.label.font.weight');
    }

    .p-button-fluid {
        width: 100%;
    }

    .p-button-fluid.p-button-icon-only {
        width: dt('button.icon.only.width');
    }

    .p-button:not(:disabled):hover {
        background: dt('button.primary.hover.background');
        border: 1px solid dt('button.primary.hover.border.color');
        color: dt('button.primary.hover.color');
    }

    .p-button:not(:disabled):active {
        background: dt('button.primary.active.background');
        border: 1px solid dt('button.primary.active.border.color');
        color: dt('button.primary.active.color');
    }

    .p-button:focus-visible {
        box-shadow: dt('button.primary.focus.ring.shadow');
        outline: dt('button.focus.ring.width') dt('button.focus.ring.style') dt('button.primary.focus.ring.color');
        outline-offset: dt('button.focus.ring.offset');
    }

    .p-button .p-badge {
        min-width: dt('button.badge.size');
        height: dt('button.badge.size');
        line-height: dt('button.badge.size');
    }

    .p-button-raised {
        box-shadow: dt('button.raised.shadow');
    }

    .p-button-rounded {
        border-radius: dt('button.rounded.border.radius');
    }

    .p-button-secondary {
        background: dt('button.secondary.background');
        border: 1px solid dt('button.secondary.border.color');
        color: dt('button.secondary.color');
    }

    .p-button-secondary:not(:disabled):hover {
        background: dt('button.secondary.hover.background');
        border: 1px solid dt('button.secondary.hover.border.color');
        color: dt('button.secondary.hover.color');
    }

    .p-button-secondary:not(:disabled):active {
        background: dt('button.secondary.active.background');
        border: 1px solid dt('button.secondary.active.border.color');
        color: dt('button.secondary.active.color');
    }

    .p-button-secondary:focus-visible {
        outline-color: dt('button.secondary.focus.ring.color');
        box-shadow: dt('button.secondary.focus.ring.shadow');
    }

    .p-button-success {
        background: dt('button.success.background');
        border: 1px solid dt('button.success.border.color');
        color: dt('button.success.color');
    }

    .p-button-success:not(:disabled):hover {
        background: dt('button.success.hover.background');
        border: 1px solid dt('button.success.hover.border.color');
        color: dt('button.success.hover.color');
    }

    .p-button-success:not(:disabled):active {
        background: dt('button.success.active.background');
        border: 1px solid dt('button.success.active.border.color');
        color: dt('button.success.active.color');
    }

    .p-button-success:focus-visible {
        outline-color: dt('button.success.focus.ring.color');
        box-shadow: dt('button.success.focus.ring.shadow');
    }

    .p-button-info {
        background: dt('button.info.background');
        border: 1px solid dt('button.info.border.color');
        color: dt('button.info.color');
    }

    .p-button-info:not(:disabled):hover {
        background: dt('button.info.hover.background');
        border: 1px solid dt('button.info.hover.border.color');
        color: dt('button.info.hover.color');
    }

    .p-button-info:not(:disabled):active {
        background: dt('button.info.active.background');
        border: 1px solid dt('button.info.active.border.color');
        color: dt('button.info.active.color');
    }

    .p-button-info:focus-visible {
        outline-color: dt('button.info.focus.ring.color');
        box-shadow: dt('button.info.focus.ring.shadow');
    }

    .p-button-warn {
        background: dt('button.warn.background');
        border: 1px solid dt('button.warn.border.color');
        color: dt('button.warn.color');
    }

    .p-button-warn:not(:disabled):hover {
        background: dt('button.warn.hover.background');
        border: 1px solid dt('button.warn.hover.border.color');
        color: dt('button.warn.hover.color');
    }

    .p-button-warn:not(:disabled):active {
        background: dt('button.warn.active.background');
        border: 1px solid dt('button.warn.active.border.color');
        color: dt('button.warn.active.color');
    }

    .p-button-warn:focus-visible {
        outline-color: dt('button.warn.focus.ring.color');
        box-shadow: dt('button.warn.focus.ring.shadow');
    }

    .p-button-help {
        background: dt('button.help.background');
        border: 1px solid dt('button.help.border.color');
        color: dt('button.help.color');
    }

    .p-button-help:not(:disabled):hover {
        background: dt('button.help.hover.background');
        border: 1px solid dt('button.help.hover.border.color');
        color: dt('button.help.hover.color');
    }

    .p-button-help:not(:disabled):active {
        background: dt('button.help.active.background');
        border: 1px solid dt('button.help.active.border.color');
        color: dt('button.help.active.color');
    }

    .p-button-help:focus-visible {
        outline-color: dt('button.help.focus.ring.color');
        box-shadow: dt('button.help.focus.ring.shadow');
    }

    .p-button-danger {
        background: dt('button.danger.background');
        border: 1px solid dt('button.danger.border.color');
        color: dt('button.danger.color');
    }

    .p-button-danger:not(:disabled):hover {
        background: dt('button.danger.hover.background');
        border: 1px solid dt('button.danger.hover.border.color');
        color: dt('button.danger.hover.color');
    }

    .p-button-danger:not(:disabled):active {
        background: dt('button.danger.active.background');
        border: 1px solid dt('button.danger.active.border.color');
        color: dt('button.danger.active.color');
    }

    .p-button-danger:focus-visible {
        outline-color: dt('button.danger.focus.ring.color');
        box-shadow: dt('button.danger.focus.ring.shadow');
    }

    .p-button-contrast {
        background: dt('button.contrast.background');
        border: 1px solid dt('button.contrast.border.color');
        color: dt('button.contrast.color');
    }

    .p-button-contrast:not(:disabled):hover {
        background: dt('button.contrast.hover.background');
        border: 1px solid dt('button.contrast.hover.border.color');
        color: dt('button.contrast.hover.color');
    }

    .p-button-contrast:not(:disabled):active {
        background: dt('button.contrast.active.background');
        border: 1px solid dt('button.contrast.active.border.color');
        color: dt('button.contrast.active.color');
    }

    .p-button-contrast:focus-visible {
        outline-color: dt('button.contrast.focus.ring.color');
        box-shadow: dt('button.contrast.focus.ring.shadow');
    }

    .p-button-outlined {
        background: transparent;
        border-color: dt('button.outlined.primary.border.color');
        color: dt('button.outlined.primary.color');
    }

    .p-button-outlined:not(:disabled):hover {
        background: dt('button.outlined.primary.hover.background');
        border-color: dt('button.outlined.primary.border.color');
        color: dt('button.outlined.primary.color');
    }

    .p-button-outlined:not(:disabled):active {
        background: dt('button.outlined.primary.active.background');
        border-color: dt('button.outlined.primary.border.color');
        color: dt('button.outlined.primary.color');
    }

    .p-button-outlined.p-button-secondary {
        border-color: dt('button.outlined.secondary.border.color');
        color: dt('button.outlined.secondary.color');
    }

    .p-button-outlined.p-button-secondary:not(:disabled):hover {
        background: dt('button.outlined.secondary.hover.background');
        border-color: dt('button.outlined.secondary.border.color');
        color: dt('button.outlined.secondary.color');
    }

    .p-button-outlined.p-button-secondary:not(:disabled):active {
        background: dt('button.outlined.secondary.active.background');
        border-color: dt('button.outlined.secondary.border.color');
        color: dt('button.outlined.secondary.color');
    }

    .p-button-outlined.p-button-success {
        border-color: dt('button.outlined.success.border.color');
        color: dt('button.outlined.success.color');
    }

    .p-button-outlined.p-button-success:not(:disabled):hover {
        background: dt('button.outlined.success.hover.background');
        border-color: dt('button.outlined.success.border.color');
        color: dt('button.outlined.success.color');
    }

    .p-button-outlined.p-button-success:not(:disabled):active {
        background: dt('button.outlined.success.active.background');
        border-color: dt('button.outlined.success.border.color');
        color: dt('button.outlined.success.color');
    }

    .p-button-outlined.p-button-info {
        border-color: dt('button.outlined.info.border.color');
        color: dt('button.outlined.info.color');
    }

    .p-button-outlined.p-button-info:not(:disabled):hover {
        background: dt('button.outlined.info.hover.background');
        border-color: dt('button.outlined.info.border.color');
        color: dt('button.outlined.info.color');
    }

    .p-button-outlined.p-button-info:not(:disabled):active {
        background: dt('button.outlined.info.active.background');
        border-color: dt('button.outlined.info.border.color');
        color: dt('button.outlined.info.color');
    }

    .p-button-outlined.p-button-warn {
        border-color: dt('button.outlined.warn.border.color');
        color: dt('button.outlined.warn.color');
    }

    .p-button-outlined.p-button-warn:not(:disabled):hover {
        background: dt('button.outlined.warn.hover.background');
        border-color: dt('button.outlined.warn.border.color');
        color: dt('button.outlined.warn.color');
    }

    .p-button-outlined.p-button-warn:not(:disabled):active {
        background: dt('button.outlined.warn.active.background');
        border-color: dt('button.outlined.warn.border.color');
        color: dt('button.outlined.warn.color');
    }

    .p-button-outlined.p-button-help {
        border-color: dt('button.outlined.help.border.color');
        color: dt('button.outlined.help.color');
    }

    .p-button-outlined.p-button-help:not(:disabled):hover {
        background: dt('button.outlined.help.hover.background');
        border-color: dt('button.outlined.help.border.color');
        color: dt('button.outlined.help.color');
    }

    .p-button-outlined.p-button-help:not(:disabled):active {
        background: dt('button.outlined.help.active.background');
        border-color: dt('button.outlined.help.border.color');
        color: dt('button.outlined.help.color');
    }

    .p-button-outlined.p-button-danger {
        border-color: dt('button.outlined.danger.border.color');
        color: dt('button.outlined.danger.color');
    }

    .p-button-outlined.p-button-danger:not(:disabled):hover {
        background: dt('button.outlined.danger.hover.background');
        border-color: dt('button.outlined.danger.border.color');
        color: dt('button.outlined.danger.color');
    }

    .p-button-outlined.p-button-danger:not(:disabled):active {
        background: dt('button.outlined.danger.active.background');
        border-color: dt('button.outlined.danger.border.color');
        color: dt('button.outlined.danger.color');
    }

    .p-button-outlined.p-button-contrast {
        border-color: dt('button.outlined.contrast.border.color');
        color: dt('button.outlined.contrast.color');
    }

    .p-button-outlined.p-button-contrast:not(:disabled):hover {
        background: dt('button.outlined.contrast.hover.background');
        border-color: dt('button.outlined.contrast.border.color');
        color: dt('button.outlined.contrast.color');
    }

    .p-button-outlined.p-button-contrast:not(:disabled):active {
        background: dt('button.outlined.contrast.active.background');
        border-color: dt('button.outlined.contrast.border.color');
        color: dt('button.outlined.contrast.color');
    }

    .p-button-outlined.p-button-plain {
        border-color: dt('button.outlined.plain.border.color');
        color: dt('button.outlined.plain.color');
    }

    .p-button-outlined.p-button-plain:not(:disabled):hover {
        background: dt('button.outlined.plain.hover.background');
        border-color: dt('button.outlined.plain.border.color');
        color: dt('button.outlined.plain.color');
    }

    .p-button-outlined.p-button-plain:not(:disabled):active {
        background: dt('button.outlined.plain.active.background');
        border-color: dt('button.outlined.plain.border.color');
        color: dt('button.outlined.plain.color');
    }

    .p-button-text {
        background: transparent;
        border-color: transparent;
        color: dt('button.text.primary.color');
    }

    .p-button-text:not(:disabled):hover {
        background: dt('button.text.primary.hover.background');
        border-color: transparent;
        color: dt('button.text.primary.color');
    }

    .p-button-text:not(:disabled):active {
        background: dt('button.text.primary.active.background');
        border-color: transparent;
        color: dt('button.text.primary.color');
    }

    .p-button-text.p-button-secondary {
        background: transparent;
        border-color: transparent;
        color: dt('button.text.secondary.color');
    }

    .p-button-text.p-button-secondary:not(:disabled):hover {
        background: dt('button.text.secondary.hover.background');
        border-color: transparent;
        color: dt('button.text.secondary.color');
    }

    .p-button-text.p-button-secondary:not(:disabled):active {
        background: dt('button.text.secondary.active.background');
        border-color: transparent;
        color: dt('button.text.secondary.color');
    }

    .p-button-text.p-button-success {
        background: transparent;
        border-color: transparent;
        color: dt('button.text.success.color');
    }

    .p-button-text.p-button-success:not(:disabled):hover {
        background: dt('button.text.success.hover.background');
        border-color: transparent;
        color: dt('button.text.success.color');
    }

    .p-button-text.p-button-success:not(:disabled):active {
        background: dt('button.text.success.active.background');
        border-color: transparent;
        color: dt('button.text.success.color');
    }

    .p-button-text.p-button-info {
        background: transparent;
        border-color: transparent;
        color: dt('button.text.info.color');
    }

    .p-button-text.p-button-info:not(:disabled):hover {
        background: dt('button.text.info.hover.background');
        border-color: transparent;
        color: dt('button.text.info.color');
    }

    .p-button-text.p-button-info:not(:disabled):active {
        background: dt('button.text.info.active.background');
        border-color: transparent;
        color: dt('button.text.info.color');
    }

    .p-button-text.p-button-warn {
        background: transparent;
        border-color: transparent;
        color: dt('button.text.warn.color');
    }

    .p-button-text.p-button-warn:not(:disabled):hover {
        background: dt('button.text.warn.hover.background');
        border-color: transparent;
        color: dt('button.text.warn.color');
    }

    .p-button-text.p-button-warn:not(:disabled):active {
        background: dt('button.text.warn.active.background');
        border-color: transparent;
        color: dt('button.text.warn.color');
    }

    .p-button-text.p-button-help {
        background: transparent;
        border-color: transparent;
        color: dt('button.text.help.color');
    }

    .p-button-text.p-button-help:not(:disabled):hover {
        background: dt('button.text.help.hover.background');
        border-color: transparent;
        color: dt('button.text.help.color');
    }

    .p-button-text.p-button-help:not(:disabled):active {
        background: dt('button.text.help.active.background');
        border-color: transparent;
        color: dt('button.text.help.color');
    }

    .p-button-text.p-button-danger {
        background: transparent;
        border-color: transparent;
        color: dt('button.text.danger.color');
    }

    .p-button-text.p-button-danger:not(:disabled):hover {
        background: dt('button.text.danger.hover.background');
        border-color: transparent;
        color: dt('button.text.danger.color');
    }

    .p-button-text.p-button-danger:not(:disabled):active {
        background: dt('button.text.danger.active.background');
        border-color: transparent;
        color: dt('button.text.danger.color');
    }

    .p-button-text.p-button-contrast {
        background: transparent;
        border-color: transparent;
        color: dt('button.text.contrast.color');
    }

    .p-button-text.p-button-contrast:not(:disabled):hover {
        background: dt('button.text.contrast.hover.background');
        border-color: transparent;
        color: dt('button.text.contrast.color');
    }

    .p-button-text.p-button-contrast:not(:disabled):active {
        background: dt('button.text.contrast.active.background');
        border-color: transparent;
        color: dt('button.text.contrast.color');
    }

    .p-button-text.p-button-plain {
        background: transparent;
        border-color: transparent;
        color: dt('button.text.plain.color');
    }

    .p-button-text.p-button-plain:not(:disabled):hover {
        background: dt('button.text.plain.hover.background');
        border-color: transparent;
        color: dt('button.text.plain.color');
    }

    .p-button-text.p-button-plain:not(:disabled):active {
        background: dt('button.text.plain.active.background');
        border-color: transparent;
        color: dt('button.text.plain.color');
    }

    .p-button-link {
        background: transparent;
        border-color: transparent;
        color: dt('button.link.color');
    }

    .p-button-link:not(:disabled):hover {
        background: transparent;
        border-color: transparent;
        color: dt('button.link.hover.color');
    }

    .p-button-link:not(:disabled):hover .p-button-label {
        text-decoration: underline;
    }

    .p-button-link:not(:disabled):active {
        background: transparent;
        border-color: transparent;
        color: dt('button.link.active.color');
    }
`;function f0(t){"@babel/helpers - typeof";return f0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},f0(t)}function Yc(t,e,n){return(e=Nte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Nte(t){var e=Vte(t,"string");return f0(e)=="symbol"?e:e+""}function Vte(t,e){if(f0(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var l=n.call(t,e);if(f0(l)!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var $te={root:function(e){var n=e.instance,l=e.props;return["p-button p-component",Yc(Yc(Yc(Yc(Yc(Yc(Yc(Yc(Yc({"p-button-icon-only":n.hasIcon&&!l.label&&!l.badge,"p-button-vertical":(l.iconPos==="top"||l.iconPos==="bottom")&&l.label,"p-button-loading":l.loading,"p-button-link":l.link||l.variant==="link"},"p-button-".concat(l.severity),l.severity),"p-button-raised",l.raised),"p-button-rounded",l.rounded),"p-button-text",l.text||l.variant==="text"),"p-button-outlined",l.outlined||l.variant==="outlined"),"p-button-sm",l.size==="small"),"p-button-lg",l.size==="large"),"p-button-plain",l.plain),"p-button-fluid",n.hasFluid)]},loadingIcon:"p-button-loading-icon",icon:function(e){var n=e.props;return["p-button-icon",Yc({},"p-button-icon-".concat(n.iconPos),n.label)]},label:"p-button-label"},Ute=xi.extend({name:"button",style:Bte,classes:$te}),jte={name:"BaseButton",extends:Yi,props:{label:{type:String,default:null},icon:{type:String,default:null},iconPos:{type:String,default:"left"},iconClass:{type:[String,Object],default:null},badge:{type:String,default:null},badgeClass:{type:[String,Object],default:null},badgeSeverity:{type:String,default:"secondary"},loading:{type:Boolean,default:!1},loadingIcon:{type:String,default:void 0},as:{type:[String,Object],default:"BUTTON"},asChild:{type:Boolean,default:!1},link:{type:Boolean,default:!1},severity:{type:String,default:null},raised:{type:Boolean,default:!1},rounded:{type:Boolean,default:!1},text:{type:Boolean,default:!1},outlined:{type:Boolean,default:!1},size:{type:String,default:null},variant:{type:String,default:null},plain:{type:Boolean,default:!1},fluid:{type:Boolean,default:null}},style:Ute,provide:function(){return{$pcButton:this,$parentInstance:this}}};function p0(t){"@babel/helpers - typeof";return p0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},p0(t)}function Na(t,e,n){return(e=Gte(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Gte(t){var e=Hte(t,"string");return p0(e)=="symbol"?e:e+""}function Hte(t,e){if(p0(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var l=n.call(t,e);if(p0(l)!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Pg={name:"Button",extends:jte,inheritAttrs:!1,inject:{$pcFluid:{default:null}},methods:{getPTOptions:function(e){var n=e==="root"?this.ptmi:this.ptm;return n(e,{context:{disabled:this.disabled}})}},computed:{disabled:function(){return this.$attrs.disabled||this.$attrs.disabled===""||this.loading},defaultAriaLabel:function(){return this.label?this.label+(this.badge?" "+this.badge:""):this.$attrs.ariaLabel},hasIcon:function(){return this.icon||this.$slots.icon},attrs:function(){return ot(this.asAttrs,this.a11yAttrs,this.getPTOptions("root"))},asAttrs:function(){return this.as==="BUTTON"?{type:"button",disabled:this.disabled}:void 0},a11yAttrs:function(){return{"aria-label":this.defaultAriaLabel,"data-pc-name":"button","data-p-disabled":this.disabled,"data-p-severity":this.severity}},hasFluid:function(){return Wa(this.fluid)?!!this.$pcFluid:this.fluid},dataP:function(){return Rs(Na(Na(Na(Na(Na(Na(Na(Na(Na(Na({},this.size,this.size),"icon-only",this.hasIcon&&!this.label&&!this.badge),"loading",this.loading),"fluid",this.hasFluid),"rounded",this.rounded),"raised",this.raised),"outlined",this.outlined||this.variant==="outlined"),"text",this.text||this.variant==="text"),"link",this.link||this.variant==="link"),"vertical",(this.iconPos==="top"||this.iconPos==="bottom")&&this.label))},dataIconP:function(){return Rs(Na(Na({},this.iconPos,this.iconPos),this.size,this.size))},dataLabelP:function(){return Rs(Na(Na({},this.size,this.size),"icon-only",this.hasIcon&&!this.label&&!this.badge))}},components:{SpinnerIcon:cb,Badge:nP},directives:{ripple:cf}},Wte=["data-p"],qte=["data-p"];function Kte(t,e,n,l,d,f){var x=_r("SpinnerIcon"),s=_r("Badge"),C=Cd("ripple");return t.asChild?ir(t.$slots,"default",{key:1,class:wr(t.cx("root")),a11yAttrs:f.a11yAttrs}):Xi((Me(),rn(Hr(t.as),ot({key:0,class:t.cx("root"),"data-p":f.dataP},f.attrs),{default:zr(function(){return[ir(t.$slots,"default",{},function(){return[t.loading?ir(t.$slots,"loadingicon",ot({key:0,class:[t.cx("loadingIcon"),t.cx("icon")]},t.ptm("loadingIcon")),function(){return[t.loadingIcon?(Me(),ft("span",ot({key:0,class:[t.cx("loadingIcon"),t.cx("icon"),t.loadingIcon]},t.ptm("loadingIcon")),null,16)):(Me(),rn(x,ot({key:1,class:[t.cx("loadingIcon"),t.cx("icon")],spin:""},t.ptm("loadingIcon")),null,16,["class"]))]}):ir(t.$slots,"icon",ot({key:1,class:[t.cx("icon")]},t.ptm("icon")),function(){return[t.icon?(Me(),ft("span",ot({key:0,class:[t.cx("icon"),t.icon,t.iconClass],"data-p":f.dataIconP},t.ptm("icon")),null,16,Wte)):Pn("",!0)]}),t.label?(Me(),ft("span",ot({key:2,class:t.cx("label")},t.ptm("label"),{"data-p":f.dataLabelP}),Fr(t.label),17,qte)):Pn("",!0),t.badge?(Me(),rn(s,{key:3,value:t.badge,class:wr(t.badgeClass),severity:t.badgeSeverity,unstyled:t.unstyled,pt:t.ptm("pcBadge")},null,8,["value","class","severity","unstyled","pt"])):Pn("",!0)]})]}),_:3},16,["class","data-p"])),[[C]])}Pg.render=Kte;var Zte=`
    .p-tag {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        background: dt('tag.primary.background');
        color: dt('tag.primary.color');
        font-size: dt('tag.font.size');
        font-weight: dt('tag.font.weight');
        padding: dt('tag.padding');
        border-radius: dt('tag.border.radius');
        gap: dt('tag.gap');
    }

    .p-tag-icon {
        font-size: dt('tag.icon.size');
        width: dt('tag.icon.size');
        height: dt('tag.icon.size');
    }

    .p-tag-rounded {
        border-radius: dt('tag.rounded.border.radius');
    }

    .p-tag-success {
        background: dt('tag.success.background');
        color: dt('tag.success.color');
    }

    .p-tag-info {
        background: dt('tag.info.background');
        color: dt('tag.info.color');
    }

    .p-tag-warn {
        background: dt('tag.warn.background');
        color: dt('tag.warn.color');
    }

    .p-tag-danger {
        background: dt('tag.danger.background');
        color: dt('tag.danger.color');
    }

    .p-tag-secondary {
        background: dt('tag.secondary.background');
        color: dt('tag.secondary.color');
    }

    .p-tag-contrast {
        background: dt('tag.contrast.background');
        color: dt('tag.contrast.color');
    }
`,Xte={root:function(e){var n=e.props;return["p-tag p-component",{"p-tag-info":n.severity==="info","p-tag-success":n.severity==="success","p-tag-warn":n.severity==="warn","p-tag-danger":n.severity==="danger","p-tag-secondary":n.severity==="secondary","p-tag-contrast":n.severity==="contrast","p-tag-rounded":n.rounded}]},icon:"p-tag-icon",label:"p-tag-label"},Yte=xi.extend({name:"tag",style:Zte,classes:Xte}),Jte={name:"BaseTag",extends:Yi,props:{value:null,severity:null,rounded:Boolean,icon:String},style:Yte,provide:function(){return{$pcTag:this,$parentInstance:this}}};function m0(t){"@babel/helpers - typeof";return m0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},m0(t)}function Qte(t,e,n){return(e=ene(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ene(t){var e=tne(t,"string");return m0(e)=="symbol"?e:e+""}function tne(t,e){if(m0(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var l=n.call(t,e);if(m0(l)!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var sN={name:"Tag",extends:Jte,inheritAttrs:!1,computed:{dataP:function(){return Rs(Qte({rounded:this.rounded},this.severity,this.severity))}}},nne=["data-p"];function rne(t,e,n,l,d,f){return Me(),ft("span",ot({class:t.cx("root"),"data-p":f.dataP},t.ptmi("root")),[t.$slots.icon?(Me(),rn(Hr(t.$slots.icon),ot({key:0,class:t.cx("icon")},t.ptm("icon")),null,16,["class"])):t.icon?(Me(),ft("span",ot({key:1,class:[t.cx("icon"),t.icon]},t.ptm("icon")),null,16)):Pn("",!0),t.value!=null||t.$slots.default?ir(t.$slots,"default",{key:2},function(){return[Ze("span",ot({class:t.cx("label")},t.ptm("label")),Fr(t.value),17)]}):Pn("",!0)],16,nne)}sN.render=rne;var aN={name:"BanIcon",extends:go};function ine(t){return lne(t)||ane(t)||sne(t)||one()}function one(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function sne(t,e){if(t){if(typeof t=="string")return D2(t,e);var n={}.toString.call(t).slice(8,-1);return n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set"?Array.from(t):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?D2(t,e):void 0}}function ane(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function lne(t){if(Array.isArray(t))return D2(t)}function D2(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,l=Array(e);n<e;n++)l[n]=t[n];return l}function cne(t,e,n,l,d,f){return Me(),ft("svg",ot({width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},t.pti()),ine(e[0]||(e[0]=[Ze("path",{d:"M7 0C5.61553 0 4.26215 0.410543 3.11101 1.17971C1.95987 1.94888 1.06266 3.04213 0.532846 4.32122C0.00303296 5.6003 -0.13559 7.00776 0.134506 8.36563C0.404603 9.7235 1.07129 10.9708 2.05026 11.9497C3.02922 12.9287 4.2765 13.5954 5.63437 13.8655C6.99224 14.1356 8.3997 13.997 9.67879 13.4672C10.9579 12.9373 12.0511 12.0401 12.8203 10.889C13.5895 9.73785 14 8.38447 14 7C14 5.14348 13.2625 3.36301 11.9497 2.05025C10.637 0.737498 8.85652 0 7 0ZM1.16667 7C1.16549 5.65478 1.63303 4.35118 2.48889 3.31333L10.6867 11.5111C9.83309 12.2112 8.79816 12.6544 7.70243 12.789C6.60669 12.9236 5.49527 12.744 4.49764 12.2713C3.50001 11.7986 2.65724 11.0521 2.06751 10.1188C1.47778 9.18558 1.16537 8.10397 1.16667 7ZM11.5111 10.6867L3.31334 2.48889C4.43144 1.57388 5.84966 1.10701 7.29265 1.1789C8.73565 1.2508 10.1004 1.85633 11.1221 2.87795C12.1437 3.89956 12.7492 5.26435 12.8211 6.70735C12.893 8.15034 12.4261 9.56856 11.5111 10.6867Z",fill:"currentColor"},null,-1)])),16)}aN.render=cne;var lN={name:"StarIcon",extends:go};function une(t){return pne(t)||fne(t)||hne(t)||dne()}function dne(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function hne(t,e){if(t){if(typeof t=="string")return L2(t,e);var n={}.toString.call(t).slice(8,-1);return n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set"?Array.from(t):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?L2(t,e):void 0}}function fne(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function pne(t){if(Array.isArray(t))return L2(t)}function L2(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,l=Array(e);n<e;n++)l[n]=t[n];return l}function mne(t,e,n,l,d,f){return Me(),ft("svg",ot({width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},t.pti()),une(e[0]||(e[0]=[Ze("path",{d:"M10.9741 13.6721C10.8806 13.6719 10.7886 13.6483 10.7066 13.6033L7.00002 11.6545L3.29345 13.6033C3.19926 13.6539 3.09281 13.6771 2.98612 13.6703C2.87943 13.6636 2.77676 13.6271 2.6897 13.5651C2.60277 13.5014 2.53529 13.4147 2.4948 13.3148C2.45431 13.215 2.44241 13.1058 2.46042 12.9995L3.17881 8.87264L0.167699 5.95324C0.0922333 5.8777 0.039368 5.78258 0.0150625 5.67861C-0.00924303 5.57463 -0.00402231 5.46594 0.030136 5.36477C0.0621323 5.26323 0.122141 5.17278 0.203259 5.10383C0.284377 5.03488 0.383311 4.99023 0.488681 4.97501L4.63087 4.37126L6.48797 0.618832C6.54083 0.530159 6.61581 0.456732 6.70556 0.405741C6.79532 0.35475 6.89678 0.327942 7.00002 0.327942C7.10325 0.327942 7.20471 0.35475 7.29447 0.405741C7.38422 0.456732 7.4592 0.530159 7.51206 0.618832L9.36916 4.37126L13.5114 4.97501C13.6167 4.99023 13.7157 5.03488 13.7968 5.10383C13.8779 5.17278 13.9379 5.26323 13.9699 5.36477C14.0041 5.46594 14.0093 5.57463 13.985 5.67861C13.9607 5.78258 13.9078 5.8777 13.8323 5.95324L10.8212 8.87264L11.532 12.9995C11.55 13.1058 11.5381 13.215 11.4976 13.3148C11.4571 13.4147 11.3896 13.5014 11.3027 13.5651C11.2059 13.632 11.0917 13.6692 10.9741 13.6721ZM7.00002 10.4393C7.09251 10.4404 7.18371 10.4613 7.2675 10.5005L10.2098 12.029L9.65193 8.75036C9.6368 8.6584 9.64343 8.56418 9.6713 8.47526C9.69918 8.38633 9.74751 8.30518 9.81242 8.23832L12.1969 5.94559L8.90298 5.45648C8.81188 5.44198 8.72555 5.406 8.65113 5.35152C8.57671 5.29703 8.51633 5.2256 8.475 5.14314L7.00002 2.1626L5.52503 5.15078C5.4837 5.23324 5.42332 5.30467 5.3489 5.35916C5.27448 5.41365 5.18815 5.44963 5.09705 5.46412L1.80318 5.94559L4.18761 8.23832C4.25252 8.30518 4.30085 8.38633 4.32873 8.47526C4.3566 8.56418 4.36323 8.6584 4.3481 8.75036L3.7902 12.0519L6.73253 10.5234C6.81451 10.4762 6.9058 10.4475 7.00002 10.4393Z",fill:"currentColor"},null,-1)])),16)}lN.render=mne;var cN={name:"StarFillIcon",extends:go};function gne(t){return bne(t)||vne(t)||yne(t)||_ne()}function _ne(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function yne(t,e){if(t){if(typeof t=="string")return z2(t,e);var n={}.toString.call(t).slice(8,-1);return n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set"?Array.from(t):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?z2(t,e):void 0}}function vne(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function bne(t){if(Array.isArray(t))return z2(t)}function z2(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,l=Array(e);n<e;n++)l[n]=t[n];return l}function xne(t,e,n,l,d,f){return Me(),ft("svg",ot({width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},t.pti()),gne(e[0]||(e[0]=[Ze("path",{d:"M13.9718 5.36453C13.9398 5.26298 13.8798 5.17252 13.7986 5.10356C13.7175 5.0346 13.6186 4.98994 13.5132 4.97472L9.37043 4.37088L7.51307 0.617955C7.46021 0.529271 7.38522 0.455834 7.29545 0.404836C7.20568 0.353838 7.1042 0.327026 7.00096 0.327026C6.89771 0.327026 6.79624 0.353838 6.70647 0.404836C6.6167 0.455834 6.54171 0.529271 6.48885 0.617955L4.63149 4.37088L0.488746 4.97472C0.383363 4.98994 0.284416 5.0346 0.203286 5.10356C0.122157 5.17252 0.0621407 5.26298 0.03014 5.36453C-0.00402286 5.46571 -0.00924428 5.57442 0.0150645 5.67841C0.0393733 5.7824 0.0922457 5.87753 0.167722 5.95308L3.17924 8.87287L2.4684 13.0003C2.45038 13.1066 2.46229 13.2158 2.50278 13.3157C2.54328 13.4156 2.61077 13.5022 2.6977 13.5659C2.78477 13.628 2.88746 13.6644 2.99416 13.6712C3.10087 13.678 3.20733 13.6547 3.30153 13.6042L7.00096 11.6551L10.708 13.6042C10.79 13.6491 10.882 13.6728 10.9755 13.673C11.0958 13.6716 11.2129 13.6343 11.3119 13.5659C11.3988 13.5022 11.4663 13.4156 11.5068 13.3157C11.5473 13.2158 11.5592 13.1066 11.5412 13.0003L10.8227 8.87287L13.8266 5.95308C13.9033 5.87835 13.9577 5.7836 13.9833 5.67957C14.009 5.57554 14.005 5.4664 13.9718 5.36453Z",fill:"currentColor"},null,-1)])),16)}cN.render=xne;var uN={name:"BaseEditableHolder",extends:Yi,emits:["update:modelValue","value-change"],props:{modelValue:{type:null,default:void 0},defaultValue:{type:null,default:void 0},name:{type:String,default:void 0},invalid:{type:Boolean,default:void 0},disabled:{type:Boolean,default:!1},formControl:{type:Object,default:void 0}},inject:{$parentInstance:{default:void 0},$pcForm:{default:void 0},$pcFormField:{default:void 0}},data:function(){return{d_value:this.defaultValue!==void 0?this.defaultValue:this.modelValue}},watch:{modelValue:{deep:!0,handler:function(e){this.d_value=e}},defaultValue:function(e){this.d_value=e},$formName:{immediate:!0,handler:function(e){var n,l;this.formField=((n=this.$pcForm)===null||n===void 0||(l=n.register)===null||l===void 0?void 0:l.call(n,e,this.$formControl))||{}}},$formControl:{immediate:!0,handler:function(e){var n,l;this.formField=((n=this.$pcForm)===null||n===void 0||(l=n.register)===null||l===void 0?void 0:l.call(n,this.$formName,e))||{}}},$formDefaultValue:{immediate:!0,handler:function(e){this.d_value!==e&&(this.d_value=e)}},$formValue:{immediate:!1,handler:function(e){var n;(n=this.$pcForm)!==null&&n!==void 0&&n.getFieldState(this.$formName)&&e!==this.d_value&&(this.d_value=e)}}},formField:{},methods:{writeValue:function(e,n){var l,d;this.controlled&&(this.d_value=e,this.$emit("update:modelValue",e)),this.$emit("value-change",e),(l=(d=this.formField).onChange)===null||l===void 0||l.call(d,{originalEvent:n,value:e})},findNonEmpty:function(){for(var e=arguments.length,n=new Array(e),l=0;l<e;l++)n[l]=arguments[l];return n.find(si)}},computed:{$filled:function(){return si(this.d_value)},$invalid:function(){var e,n;return!this.$formNovalidate&&this.findNonEmpty(this.invalid,(e=this.$pcFormField)===null||e===void 0||(e=e.$field)===null||e===void 0?void 0:e.invalid,(n=this.$pcForm)===null||n===void 0||(n=n.getFieldState(this.$formName))===null||n===void 0?void 0:n.invalid)},$formName:function(){var e;return this.$formNovalidate?void 0:this.name||((e=this.$formControl)===null||e===void 0?void 0:e.name)},$formControl:function(){var e;return this.formControl||((e=this.$pcFormField)===null||e===void 0?void 0:e.formControl)},$formNovalidate:function(){var e;return(e=this.$formControl)===null||e===void 0?void 0:e.novalidate},$formDefaultValue:function(){var e,n;return this.findNonEmpty(this.d_value,(e=this.$pcFormField)===null||e===void 0?void 0:e.initialValue,(n=this.$pcForm)===null||n===void 0||(n=n.initialValues)===null||n===void 0?void 0:n[this.$formName])},$formValue:function(){var e,n;return this.findNonEmpty((e=this.$pcFormField)===null||e===void 0||(e=e.$field)===null||e===void 0?void 0:e.value,(n=this.$pcForm)===null||n===void 0||(n=n.getFieldState(this.$formName))===null||n===void 0?void 0:n.value)},controlled:function(){return this.$inProps.hasOwnProperty("modelValue")||!this.$inProps.hasOwnProperty("modelValue")&&!this.$inProps.hasOwnProperty("defaultValue")},filled:function(){return this.$filled}}},wne=`
    .p-rating {
        position: relative;
        display: inline-flex;
        align-items: center;
        gap: dt('rating.gap');
    }

    .p-rating-option {
        display: inline-flex;
        align-items: center;
        cursor: pointer;
        outline-color: transparent;
        border-radius: 50%;
        transition:
            background dt('rating.transition.duration'),
            color dt('rating.transition.duration'),
            border-color dt('rating.transition.duration'),
            outline-color dt('rating.transition.duration'),
            box-shadow dt('rating.transition.duration');
    }

    .p-rating-option.p-focus-visible {
        box-shadow: dt('rating.focus.ring.shadow');
        outline: dt('rating.focus.ring.width') dt('rating.focus.ring.style') dt('rating.focus.ring.color');
        outline-offset: dt('rating.focus.ring.offset');
    }

    .p-rating-icon {
        color: dt('rating.icon.color');
        transition:
            background dt('rating.transition.duration'),
            color dt('rating.transition.duration'),
            border-color dt('rating.transition.duration'),
            outline-color dt('rating.transition.duration'),
            box-shadow dt('rating.transition.duration');
        font-size: dt('rating.icon.size');
        width: dt('rating.icon.size');
        height: dt('rating.icon.size');
    }

    .p-rating:not(.p-disabled):not(.p-readonly) .p-rating-option:hover .p-rating-icon {
        color: dt('rating.icon.hover.color');
    }

    .p-rating-option-active .p-rating-icon {
        color: dt('rating.icon.active.color');
    }

    .p-rating-icon.p-invalid {
        /* @todo */
        stroke: dt('rating.invalid.icon.color');
    }

    .p-rating.p-readonly .p-rating-option {
        cursor: not-allowed;
    }
`,Tne={root:function(e){var n=e.props;return["p-rating",{"p-readonly":n.readonly,"p-disabled":n.disabled}]},option:function(e){var n=e.instance,l=e.value;return["p-rating-option",{"p-rating-option-active":l<=n.d_value,"p-focus-visible":l===n.focusedOptionIndex&&n.isFocusVisibleItem}]},onIcon:function(e){var n=e.instance;return["p-rating-icon p-rating-on-icon",{"p-invalid":n.$invalid}]},offIcon:function(e){var n=e.instance;return["p-rating-icon p-rating-off-icon",{"p-invalid":n.$invalid}]}},Sne=xi.extend({name:"rating",style:wne,classes:Tne}),Ene={name:"BaseRating",extends:uN,props:{readonly:{type:Boolean,default:!1},stars:{type:Number,default:5},onIcon:{type:String,default:void 0},offIcon:{type:String,default:void 0}},style:Sne,provide:function(){return{$pcRating:this,$parentInstance:this}}},F2={name:"Rating",extends:Ene,inheritAttrs:!1,emits:["change","focus","blur"],data:function(){return{focusedOptionIndex:-1,isFocusVisibleItem:!0}},methods:{getPTOptions:function(e,n){return this.ptm(e,{context:{active:n<=this.d_value,focused:n===this.focusedOptionIndex}})},onOptionClick:function(e,n){if(!this.readonly&&!this.disabled){this.onOptionSelect(e,n),this.isFocusVisibleItem=!1;var l=Oh(e.currentTarget);l&&Ea(l)}},onFocus:function(e,n){var l;this.focusedOptionIndex=n,this.isFocusVisibleItem=((l=e.sourceCapabilities)===null||l===void 0?void 0:l.firesTouchEvents)===!1,this.$emit("focus",e)},onBlur:function(e){var n,l;this.focusedOptionIndex=-1,this.$emit("blur",e),(n=(l=this.formField).onBlur)===null||n===void 0||n.call(l)},onChange:function(e,n){this.onOptionSelect(e,n),this.isFocusVisibleItem=!0},onOptionSelect:function(e,n){this.focusedOptionIndex===n||this.d_value===n?(this.focusedOptionIndex=-1,this.updateModel(e,null)):(this.focusedOptionIndex=n,this.updateModel(e,n||null))},updateModel:function(e,n){this.writeValue(n,e),this.$emit("change",{originalEvent:e,value:n})},starAriaLabel:function(e){return e===1?this.$primevue.config.locale.aria.star:this.$primevue.config.locale.aria.stars.replace(/{star}/g,e)},dataOption:function(e){return Rs({readonly:this.readonly,disabled:this.disabled,active:e<=this.d_value,"focus-visible":e===this.focusedOptionIndex&&this.isFocusVisibleItem})}},computed:{namex:function(){return this.name||"".concat(this.$attrSelector,"_name")},dataP:function(){return Rs({readonly:this.readonly,disabled:this.disabled})}},components:{StarFillIcon:cN,StarIcon:lN,BanIcon:aN}},Cne=["data-p"],Ine=["onClick","data-p-active","data-p-focused","data-p"],Ane=["value","name","checked","disabled","readonly","aria-label","onFocus","onChange"];function Pne(t,e,n,l,d,f){return Me(),ft("div",ot({class:t.cx("root")},t.ptmi("root"),{"data-p":f.dataP}),[(Me(!0),ft(Tr,null,ms(t.stars,function(x){return Me(),ft("div",ot({key:x,class:t.cx("option",{value:x}),onClick:function(C){return f.onOptionClick(C,x)}},{ref_for:!0},f.getPTOptions("option",x),{"data-p-active":x<=t.d_value,"data-p-focused":x===d.focusedOptionIndex,"data-p":f.dataOption(x)}),[Ze("span",ot({class:"p-hidden-accessible"},{ref_for:!0},t.ptm("hiddenOptionInputContainer"),{"data-p-hidden-accessible":!0}),[Ze("input",ot({type:"radio",value:x,name:f.namex,checked:t.d_value===x,disabled:t.disabled,readonly:t.readonly,"aria-label":f.starAriaLabel(x),onFocus:function(C){return f.onFocus(C,x)},onBlur:e[0]||(e[0]=function(){return f.onBlur&&f.onBlur.apply(f,arguments)}),onChange:function(C){return f.onChange(C,x)}},{ref_for:!0},t.ptm("hiddenOptionInput")),null,16,Ane)],16),x<=t.d_value?ir(t.$slots,"onicon",{key:0,value:x,toggleCallback:function(C){return f.onChange(C,x)},class:wr(t.cx("onIcon"))},function(){return[(Me(),rn(Hr(t.onIcon?"span":"StarFillIcon"),ot({class:[t.cx("onIcon"),t.onIcon]},{ref_for:!0},t.ptm("onIcon")),null,16,["class"]))]}):ir(t.$slots,"officon",{key:1,value:x,class:wr(t.cx("offIcon")),toggleCallback:function(C){return f.onChange(C,x)}},function(){return[(Me(),rn(Hr(t.offIcon?"span":"StarIcon"),ot({class:[t.cx("offIcon"),t.offIcon]},{ref_for:!0},t.ptm("offIcon")),null,16,["class"]))]})],16,Ine)}),128))],16,Cne)}F2.render=Pne;function g0(t){"@babel/helpers - typeof";return g0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},g0(t)}function Rne(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function kne(t,e){for(var n=0;n<e.length;n++){var l=e[n];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(t,Mne(l.key),l)}}function One(t,e,n){return e&&kne(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function Mne(t){var e=Dne(t,"string");return g0(e)=="symbol"?e:e+""}function Dne(t,e){if(g0(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var l=n.call(t,e);if(g0(l)!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var dN=(function(){function t(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:function(){};Rne(this,t),this.element=e,this.listener=n}return One(t,[{key:"bindScrollListener",value:function(){this.scrollableParents=vee(this.element);for(var n=0;n<this.scrollableParents.length;n++)this.scrollableParents[n].addEventListener("scroll",this.listener)}},{key:"unbindScrollListener",value:function(){if(this.scrollableParents)for(var n=0;n<this.scrollableParents.length;n++)this.scrollableParents[n].removeEventListener("scroll",this.listener)}},{key:"destroy",value:function(){this.unbindScrollListener(),this.element=null,this.listener=null,this.scrollableParents=null}}])})();function _0(t){"@babel/helpers - typeof";return _0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_0(t)}function Lne(t){return Nne(t)||Bne(t)||Fne(t)||zne()}function zne(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Fne(t,e){if(t){if(typeof t=="string")return B2(t,e);var n={}.toString.call(t).slice(8,-1);return n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set"?Array.from(t):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?B2(t,e):void 0}}function Bne(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function Nne(t){if(Array.isArray(t))return B2(t)}function B2(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,l=Array(e);n<e;n++)l[n]=t[n];return l}function Vne(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function $ne(t,e){for(var n=0;n<e.length;n++){var l=e[n];l.enumerable=l.enumerable||!1,l.configurable=!0,"value"in l&&(l.writable=!0),Object.defineProperty(t,hN(l.key),l)}}function Une(t,e,n){return e&&$ne(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function WL(t,e,n){return(e=hN(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function hN(t){var e=jne(t,"string");return _0(e)=="symbol"?e:e+""}function jne(t,e){if(_0(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var l=n.call(t,e);if(_0(l)!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var jg=(function(){function t(e){var n=e.init,l=e.type;Vne(this,t),WL(this,"helpers",void 0),WL(this,"type",void 0),this.helpers=new Set(n),this.type=l}return Une(t,[{key:"add",value:function(n){this.helpers.add(n)}},{key:"update",value:function(){}},{key:"delete",value:function(n){this.helpers.delete(n)}},{key:"clear",value:function(){this.helpers.clear()}},{key:"get",value:function(n,l){var d=this._get(n,l),f=d?this._recursive(Lne(this.helpers),d):null;return si(f)?f:null}},{key:"_isMatched",value:function(n,l){var d,f=n?.parent;return(f==null||(d=f.vnode)===null||d===void 0?void 0:d.key)===l||f&&this._isMatched(f,l)||!1}},{key:"_get",value:function(n,l){var d,f;return((d=l||n?.$slots)===null||d===void 0||(f=d.default)===null||f===void 0?void 0:f.call(d))||null}},{key:"_recursive",value:function(){var n=this,l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],f=[];return d.forEach(function(x){x.children instanceof Array?f=f.concat(n._recursive(l,x.children)):x.type.name===n.type?f.push(x):si(x.key)&&(f=f.concat(l.filter(function(s){return n._isMatched(s,x.key)}).map(function(s){return s.vnode})))}),f}}])})();function uf(t,e){if(t){var n=t.props;if(n){var l=e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),d=Object.prototype.hasOwnProperty.call(n,l)?l:e;return t.type.extends.props[e].type===Boolean&&n[d]===""?!0:n[d]}}return null}var fN={name:"ArrowDownIcon",extends:go};function Gne(t){return Kne(t)||qne(t)||Wne(t)||Hne()}function Hne(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Wne(t,e){if(t){if(typeof t=="string")return N2(t,e);var n={}.toString.call(t).slice(8,-1);return n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set"?Array.from(t):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?N2(t,e):void 0}}function qne(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function Kne(t){if(Array.isArray(t))return N2(t)}function N2(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,l=Array(e);n<e;n++)l[n]=t[n];return l}function Zne(t,e,n,l,d,f){return Me(),ft("svg",ot({width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},t.pti()),Gne(e[0]||(e[0]=[Ze("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M6.99994 14C6.91097 14.0004 6.82281 13.983 6.74064 13.9489C6.65843 13.9148 6.58387 13.8646 6.52133 13.8013L1.10198 8.38193C0.982318 8.25351 0.917175 8.08367 0.920272 7.90817C0.923368 7.73267 0.994462 7.56523 1.11858 7.44111C1.24269 7.317 1.41014 7.2459 1.58563 7.2428C1.76113 7.23971 1.93098 7.30485 2.0594 7.42451L6.32263 11.6877V0.677419C6.32263 0.497756 6.394 0.325452 6.52104 0.198411C6.64808 0.0713706 6.82039 0 7.00005 0C7.17971 0 7.35202 0.0713706 7.47906 0.198411C7.6061 0.325452 7.67747 0.497756 7.67747 0.677419V11.6877L11.9407 7.42451C12.0691 7.30485 12.2389 7.23971 12.4144 7.2428C12.5899 7.2459 12.7574 7.317 12.8815 7.44111C13.0056 7.56523 13.0767 7.73267 13.0798 7.90817C13.0829 8.08367 13.0178 8.25351 12.8981 8.38193L7.47875 13.8013C7.41621 13.8646 7.34164 13.9148 7.25944 13.9489C7.17727 13.983 7.08912 14.0004 7.00015 14C7.00012 14 7.00009 14 7.00005 14C7.00001 14 6.99998 14 6.99994 14Z",fill:"currentColor"},null,-1)])),16)}fN.render=Zne;var pN={name:"ArrowUpIcon",extends:go};function Xne(t){return ere(t)||Qne(t)||Jne(t)||Yne()}function Yne(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Jne(t,e){if(t){if(typeof t=="string")return V2(t,e);var n={}.toString.call(t).slice(8,-1);return n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set"?Array.from(t):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?V2(t,e):void 0}}function Qne(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function ere(t){if(Array.isArray(t))return V2(t)}function V2(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,l=Array(e);n<e;n++)l[n]=t[n];return l}function tre(t,e,n,l,d,f){return Me(),ft("svg",ot({width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},t.pti()),Xne(e[0]||(e[0]=[Ze("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M6.51551 13.799C6.64205 13.9255 6.813 13.9977 6.99193 14C7.17087 13.9977 7.34182 13.9255 7.46835 13.799C7.59489 13.6725 7.66701 13.5015 7.66935 13.3226V2.31233L11.9326 6.57554C11.9951 6.63887 12.0697 6.68907 12.1519 6.72319C12.2341 6.75731 12.3223 6.77467 12.4113 6.77425C12.5003 6.77467 12.5885 6.75731 12.6707 6.72319C12.7529 6.68907 12.8274 6.63887 12.89 6.57554C13.0168 6.44853 13.0881 6.27635 13.0881 6.09683C13.0881 5.91732 13.0168 5.74514 12.89 5.61812L7.48846 0.216594C7.48274 0.210436 7.4769 0.204374 7.47094 0.198411C7.3439 0.0713707 7.1716 0 6.99193 0C6.81227 0 6.63997 0.0713707 6.51293 0.198411C6.50704 0.204296 6.50128 0.210278 6.49563 0.216354L1.09386 5.61812C0.974201 5.74654 0.909057 5.91639 0.912154 6.09189C0.91525 6.26738 0.986345 6.43483 1.11046 6.55894C1.23457 6.68306 1.40202 6.75415 1.57752 6.75725C1.75302 6.76035 1.92286 6.6952 2.05128 6.57554L6.31451 2.31231V13.3226C6.31685 13.5015 6.38898 13.6725 6.51551 13.799Z",fill:"currentColor"},null,-1)])),16)}pN.render=tre;var nre=`
    .p-paginator {
        display: flex;
        align-items: center;
        justify-content: center;
        flex-wrap: wrap;
        background: dt('paginator.background');
        color: dt('paginator.color');
        padding: dt('paginator.padding');
        border-radius: dt('paginator.border.radius');
        gap: dt('paginator.gap');
    }

    .p-paginator-content {
        display: flex;
        align-items: center;
        justify-content: center;
        flex-wrap: wrap;
        gap: dt('paginator.gap');
    }

    .p-paginator-content-start {
        margin-inline-end: auto;
    }

    .p-paginator-content-end {
        margin-inline-start: auto;
    }

    .p-paginator-page,
    .p-paginator-next,
    .p-paginator-last,
    .p-paginator-first,
    .p-paginator-prev {
        cursor: pointer;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        line-height: 1;
        user-select: none;
        overflow: hidden;
        position: relative;
        background: dt('paginator.nav.button.background');
        border: 0 none;
        color: dt('paginator.nav.button.color');
        min-width: dt('paginator.nav.button.width');
        height: dt('paginator.nav.button.height');
        transition:
            background dt('paginator.transition.duration'),
            color dt('paginator.transition.duration'),
            outline-color dt('paginator.transition.duration'),
            box-shadow dt('paginator.transition.duration');
        border-radius: dt('paginator.nav.button.border.radius');
        padding: 0;
        margin: 0;
    }

    .p-paginator-page:focus-visible,
    .p-paginator-next:focus-visible,
    .p-paginator-last:focus-visible,
    .p-paginator-first:focus-visible,
    .p-paginator-prev:focus-visible {
        box-shadow: dt('paginator.nav.button.focus.ring.shadow');
        outline: dt('paginator.nav.button.focus.ring.width') dt('paginator.nav.button.focus.ring.style') dt('paginator.nav.button.focus.ring.color');
        outline-offset: dt('paginator.nav.button.focus.ring.offset');
    }

    .p-paginator-page:not(.p-disabled):not(.p-paginator-page-selected):hover,
    .p-paginator-first:not(.p-disabled):hover,
    .p-paginator-prev:not(.p-disabled):hover,
    .p-paginator-next:not(.p-disabled):hover,
    .p-paginator-last:not(.p-disabled):hover {
        background: dt('paginator.nav.button.hover.background');
        color: dt('paginator.nav.button.hover.color');
    }

    .p-paginator-page.p-paginator-page-selected {
        background: dt('paginator.nav.button.selected.background');
        color: dt('paginator.nav.button.selected.color');
    }

    .p-paginator-current {
        color: dt('paginator.current.page.report.color');
    }

    .p-paginator-pages {
        display: flex;
        align-items: center;
        gap: dt('paginator.gap');
    }

    .p-paginator-jtp-input .p-inputtext {
        max-width: dt('paginator.jump.to.page.input.max.width');
    }

    .p-paginator-first:dir(rtl),
    .p-paginator-prev:dir(rtl),
    .p-paginator-next:dir(rtl),
    .p-paginator-last:dir(rtl) {
        transform: rotate(180deg);
    }
`;function y0(t){"@babel/helpers - typeof";return y0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},y0(t)}function rre(t,e,n){return(e=ire(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ire(t){var e=ore(t,"string");return y0(e)=="symbol"?e:e+""}function ore(t,e){if(y0(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var l=n.call(t,e);if(y0(l)!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var sre={paginator:function(e){var n=e.instance,l=e.key;return["p-paginator p-component",rre({"p-paginator-default":!n.hasBreakpoints()},"p-paginator-".concat(l),n.hasBreakpoints())]},content:"p-paginator-content",contentStart:"p-paginator-content-start",contentEnd:"p-paginator-content-end",first:function(e){var n=e.instance;return["p-paginator-first",{"p-disabled":n.$attrs.disabled}]},firstIcon:"p-paginator-first-icon",prev:function(e){var n=e.instance;return["p-paginator-prev",{"p-disabled":n.$attrs.disabled}]},prevIcon:"p-paginator-prev-icon",next:function(e){var n=e.instance;return["p-paginator-next",{"p-disabled":n.$attrs.disabled}]},nextIcon:"p-paginator-next-icon",last:function(e){var n=e.instance;return["p-paginator-last",{"p-disabled":n.$attrs.disabled}]},lastIcon:"p-paginator-last-icon",pages:"p-paginator-pages",page:function(e){var n=e.props,l=e.pageLink;return["p-paginator-page",{"p-paginator-page-selected":l-1===n.page}]},current:"p-paginator-current",pcRowPerPageDropdown:"p-paginator-rpp-dropdown",pcJumpToPageDropdown:"p-paginator-jtp-dropdown",pcJumpToPageInputText:"p-paginator-jtp-input"},are=xi.extend({name:"paginator",style:nre,classes:sre}),mN={name:"AngleDoubleLeftIcon",extends:go};function lre(t){return hre(t)||dre(t)||ure(t)||cre()}function cre(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ure(t,e){if(t){if(typeof t=="string")return $2(t,e);var n={}.toString.call(t).slice(8,-1);return n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set"?Array.from(t):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?$2(t,e):void 0}}function dre(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function hre(t){if(Array.isArray(t))return $2(t)}function $2(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,l=Array(e);n<e;n++)l[n]=t[n];return l}function fre(t,e,n,l,d,f){return Me(),ft("svg",ot({width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},t.pti()),lre(e[0]||(e[0]=[Ze("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M5.71602 11.164C5.80782 11.2021 5.9063 11.2215 6.00569 11.221C6.20216 11.2301 6.39427 11.1612 6.54025 11.0294C6.68191 10.8875 6.76148 10.6953 6.76148 10.4948C6.76148 10.2943 6.68191 10.1021 6.54025 9.96024L3.51441 6.9344L6.54025 3.90855C6.624 3.76126 6.65587 3.59011 6.63076 3.42254C6.60564 3.25498 6.525 3.10069 6.40175 2.98442C6.2785 2.86815 6.11978 2.79662 5.95104 2.7813C5.78229 2.76598 5.61329 2.80776 5.47112 2.89994L1.97123 6.39983C1.82957 6.54167 1.75 6.73393 1.75 6.9344C1.75 7.13486 1.82957 7.32712 1.97123 7.46896L5.47112 10.9991C5.54096 11.0698 5.62422 11.1259 5.71602 11.164ZM11.0488 10.9689C11.1775 11.1156 11.3585 11.2061 11.5531 11.221C11.7477 11.2061 11.9288 11.1156 12.0574 10.9689C12.1815 10.8302 12.25 10.6506 12.25 10.4645C12.25 10.2785 12.1815 10.0989 12.0574 9.96024L9.03158 6.93439L12.0574 3.90855C12.1248 3.76739 12.1468 3.60881 12.1204 3.45463C12.0939 3.30045 12.0203 3.15826 11.9097 3.04765C11.7991 2.93703 11.6569 2.86343 11.5027 2.83698C11.3486 2.81053 11.19 2.83252 11.0488 2.89994L7.51865 6.36957C7.37699 6.51141 7.29742 6.70367 7.29742 6.90414C7.29742 7.1046 7.37699 7.29686 7.51865 7.4387L11.0488 10.9689Z",fill:"currentColor"},null,-1)])),16)}mN.render=fre;var gN={name:"BlankIcon",extends:go};function pre(t){return yre(t)||_re(t)||gre(t)||mre()}function mre(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function gre(t,e){if(t){if(typeof t=="string")return U2(t,e);var n={}.toString.call(t).slice(8,-1);return n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set"?Array.from(t):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?U2(t,e):void 0}}function _re(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function yre(t){if(Array.isArray(t))return U2(t)}function U2(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,l=Array(e);n<e;n++)l[n]=t[n];return l}function vre(t,e,n,l,d,f){return Me(),ft("svg",ot({width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},t.pti()),pre(e[0]||(e[0]=[Ze("rect",{width:"1",height:"1",fill:"currentColor","fill-opacity":"0"},null,-1)])),16)}gN.render=vre;var s_={name:"CheckIcon",extends:go};function bre(t){return Sre(t)||Tre(t)||wre(t)||xre()}function xre(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function wre(t,e){if(t){if(typeof t=="string")return j2(t,e);var n={}.toString.call(t).slice(8,-1);return n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set"?Array.from(t):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?j2(t,e):void 0}}function Tre(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function Sre(t){if(Array.isArray(t))return j2(t)}function j2(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,l=Array(e);n<e;n++)l[n]=t[n];return l}function Ere(t,e,n,l,d,f){return Me(),ft("svg",ot({width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},t.pti()),bre(e[0]||(e[0]=[Ze("path",{d:"M4.86199 11.5948C4.78717 11.5923 4.71366 11.5745 4.64596 11.5426C4.57826 11.5107 4.51779 11.4652 4.46827 11.4091L0.753985 7.69483C0.683167 7.64891 0.623706 7.58751 0.580092 7.51525C0.536478 7.44299 0.509851 7.36177 0.502221 7.27771C0.49459 7.19366 0.506156 7.10897 0.536046 7.03004C0.565935 6.95111 0.613367 6.88 0.674759 6.82208C0.736151 6.76416 0.8099 6.72095 0.890436 6.69571C0.970973 6.67046 1.05619 6.66385 1.13966 6.67635C1.22313 6.68886 1.30266 6.72017 1.37226 6.76792C1.44186 6.81567 1.4997 6.8786 1.54141 6.95197L4.86199 10.2503L12.6397 2.49483C12.7444 2.42694 12.8689 2.39617 12.9932 2.40745C13.1174 2.41873 13.2343 2.47141 13.3251 2.55705C13.4159 2.64268 13.4753 2.75632 13.4938 2.87973C13.5123 3.00315 13.4888 3.1292 13.4271 3.23768L5.2557 11.4091C5.20618 11.4652 5.14571 11.5107 5.07801 11.5426C5.01031 11.5745 4.9368 11.5923 4.86199 11.5948Z",fill:"currentColor"},null,-1)])),16)}s_.render=Ere;var BT={name:"ChevronDownIcon",extends:go};function Cre(t){return Rre(t)||Pre(t)||Are(t)||Ire()}function Ire(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Are(t,e){if(t){if(typeof t=="string")return G2(t,e);var n={}.toString.call(t).slice(8,-1);return n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set"?Array.from(t):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?G2(t,e):void 0}}function Pre(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function Rre(t){if(Array.isArray(t))return G2(t)}function G2(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,l=Array(e);n<e;n++)l[n]=t[n];return l}function kre(t,e,n,l,d,f){return Me(),ft("svg",ot({width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},t.pti()),Cre(e[0]||(e[0]=[Ze("path",{d:"M7.01744 10.398C6.91269 10.3985 6.8089 10.378 6.71215 10.3379C6.61541 10.2977 6.52766 10.2386 6.45405 10.1641L1.13907 4.84913C1.03306 4.69404 0.985221 4.5065 1.00399 4.31958C1.02276 4.13266 1.10693 3.95838 1.24166 3.82747C1.37639 3.69655 1.55301 3.61742 1.74039 3.60402C1.92777 3.59062 2.11386 3.64382 2.26584 3.75424L7.01744 8.47394L11.769 3.75424C11.9189 3.65709 12.097 3.61306 12.2748 3.62921C12.4527 3.64535 12.6199 3.72073 12.7498 3.84328C12.8797 3.96582 12.9647 4.12842 12.9912 4.30502C13.0177 4.48162 12.9841 4.662 12.8958 4.81724L7.58083 10.1322C7.50996 10.2125 7.42344 10.2775 7.32656 10.3232C7.22968 10.3689 7.12449 10.3944 7.01744 10.398Z",fill:"currentColor"},null,-1)])),16)}BT.render=kre;var _N={name:"SearchIcon",extends:go};function Ore(t){return zre(t)||Lre(t)||Dre(t)||Mre()}function Mre(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Dre(t,e){if(t){if(typeof t=="string")return H2(t,e);var n={}.toString.call(t).slice(8,-1);return n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set"?Array.from(t):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?H2(t,e):void 0}}function Lre(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function zre(t){if(Array.isArray(t))return H2(t)}function H2(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,l=Array(e);n<e;n++)l[n]=t[n];return l}function Fre(t,e,n,l,d,f){return Me(),ft("svg",ot({width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},t.pti()),Ore(e[0]||(e[0]=[Ze("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M2.67602 11.0265C3.6661 11.688 4.83011 12.0411 6.02086 12.0411C6.81149 12.0411 7.59438 11.8854 8.32483 11.5828C8.87005 11.357 9.37808 11.0526 9.83317 10.6803L12.9769 13.8241C13.0323 13.8801 13.0983 13.9245 13.171 13.9548C13.2438 13.985 13.3219 14.0003 13.4007 14C13.4795 14.0003 13.5575 13.985 13.6303 13.9548C13.7031 13.9245 13.7691 13.8801 13.8244 13.8241C13.9367 13.7116 13.9998 13.5592 13.9998 13.4003C13.9998 13.2414 13.9367 13.089 13.8244 12.9765L10.6807 9.8328C11.053 9.37773 11.3573 8.86972 11.5831 8.32452C11.8857 7.59408 12.0414 6.81119 12.0414 6.02056C12.0414 4.8298 11.6883 3.66579 11.0268 2.67572C10.3652 1.68564 9.42494 0.913972 8.32483 0.45829C7.22472 0.00260857 6.01418 -0.116618 4.84631 0.115686C3.67844 0.34799 2.60568 0.921393 1.76369 1.76338C0.921698 2.60537 0.348296 3.67813 0.115991 4.84601C-0.116313 6.01388 0.00291375 7.22441 0.458595 8.32452C0.914277 9.42464 1.68595 10.3649 2.67602 11.0265ZM3.35565 2.0158C4.14456 1.48867 5.07206 1.20731 6.02086 1.20731C7.29317 1.20731 8.51338 1.71274 9.41304 2.6124C10.3127 3.51206 10.8181 4.73226 10.8181 6.00457C10.8181 6.95337 10.5368 7.88088 10.0096 8.66978C9.48251 9.45868 8.73328 10.0736 7.85669 10.4367C6.98011 10.7997 6.01554 10.8947 5.08496 10.7096C4.15439 10.5245 3.2996 10.0676 2.62869 9.39674C1.95778 8.72583 1.50089 7.87104 1.31579 6.94046C1.13068 6.00989 1.22568 5.04532 1.58878 4.16874C1.95187 3.29215 2.56675 2.54292 3.35565 2.0158Z",fill:"currentColor"},null,-1)])),16)}_N.render=Fre;var NT={name:"TimesIcon",extends:go};function Bre(t){return Ure(t)||$re(t)||Vre(t)||Nre()}function Nre(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Vre(t,e){if(t){if(typeof t=="string")return W2(t,e);var n={}.toString.call(t).slice(8,-1);return n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set"?Array.from(t):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?W2(t,e):void 0}}function $re(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function Ure(t){if(Array.isArray(t))return W2(t)}function W2(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,l=Array(e);n<e;n++)l[n]=t[n];return l}function jre(t,e,n,l,d,f){return Me(),ft("svg",ot({width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},t.pti()),Bre(e[0]||(e[0]=[Ze("path",{d:"M8.01186 7.00933L12.27 2.75116C12.341 2.68501 12.398 2.60524 12.4375 2.51661C12.4769 2.42798 12.4982 2.3323 12.4999 2.23529C12.5016 2.13827 12.4838 2.0419 12.4474 1.95194C12.4111 1.86197 12.357 1.78024 12.2884 1.71163C12.2198 1.64302 12.138 1.58893 12.0481 1.55259C11.9581 1.51625 11.8617 1.4984 11.7647 1.50011C11.6677 1.50182 11.572 1.52306 11.4834 1.56255C11.3948 1.60204 11.315 1.65898 11.2488 1.72997L6.99067 5.98814L2.7325 1.72997C2.59553 1.60234 2.41437 1.53286 2.22718 1.53616C2.03999 1.53946 1.8614 1.61529 1.72901 1.74767C1.59663 1.88006 1.5208 2.05865 1.5175 2.24584C1.5142 2.43303 1.58368 2.61419 1.71131 2.75116L5.96948 7.00933L1.71131 11.2675C1.576 11.403 1.5 11.5866 1.5 11.7781C1.5 11.9696 1.576 12.1532 1.71131 12.2887C1.84679 12.424 2.03043 12.5 2.2219 12.5C2.41338 12.5 2.59702 12.424 2.7325 12.2887L6.99067 8.03052L11.2488 12.2887C11.3843 12.424 11.568 12.5 11.7594 12.5C11.9509 12.5 12.1346 12.424 12.27 12.2887C12.4053 12.1532 12.4813 11.9696 12.4813 11.7781C12.4813 11.5866 12.4053 11.403 12.27 11.2675L8.01186 7.00933Z",fill:"currentColor"},null,-1)])),16)}NT.render=jre;var Gre=`
    .p-iconfield {
        position: relative;
        display: block;
    }

    .p-inputicon {
        position: absolute;
        top: 50%;
        margin-top: calc(-1 * (dt('icon.size') / 2));
        color: dt('iconfield.icon.color');
        line-height: 1;
        z-index: 1;
    }

    .p-iconfield .p-inputicon:first-child {
        inset-inline-start: dt('form.field.padding.x');
    }

    .p-iconfield .p-inputicon:last-child {
        inset-inline-end: dt('form.field.padding.x');
    }

    .p-iconfield .p-inputtext:not(:first-child),
    .p-iconfield .p-inputwrapper:not(:first-child) .p-inputtext {
        padding-inline-start: calc((dt('form.field.padding.x') * 2) + dt('icon.size'));
    }

    .p-iconfield .p-inputtext:not(:last-child) {
        padding-inline-end: calc((dt('form.field.padding.x') * 2) + dt('icon.size'));
    }

    .p-iconfield:has(.p-inputfield-sm) .p-inputicon {
        font-size: dt('form.field.sm.font.size');
        width: dt('form.field.sm.font.size');
        height: dt('form.field.sm.font.size');
        margin-top: calc(-1 * (dt('form.field.sm.font.size') / 2));
    }

    .p-iconfield:has(.p-inputfield-lg) .p-inputicon {
        font-size: dt('form.field.lg.font.size');
        width: dt('form.field.lg.font.size');
        height: dt('form.field.lg.font.size');
        margin-top: calc(-1 * (dt('form.field.lg.font.size') / 2));
    }
`,Hre={root:"p-iconfield"},Wre=xi.extend({name:"iconfield",style:Gre,classes:Hre}),qre={name:"BaseIconField",extends:Yi,style:Wre,provide:function(){return{$pcIconField:this,$parentInstance:this}}},yN={name:"IconField",extends:qre,inheritAttrs:!1};function Kre(t,e,n,l,d,f){return Me(),ft("div",ot({class:t.cx("root")},t.ptmi("root")),[ir(t.$slots,"default")],16)}yN.render=Kre;var Zre={root:"p-inputicon"},Xre=xi.extend({name:"inputicon",classes:Zre}),Yre={name:"BaseInputIcon",extends:Yi,style:Xre,props:{class:null},provide:function(){return{$pcInputIcon:this,$parentInstance:this}}},vN={name:"InputIcon",extends:Yre,inheritAttrs:!1,computed:{containerClass:function(){return[this.cx("root"),this.class]}}};function Jre(t,e,n,l,d,f){return Me(),ft("span",ot({class:f.containerClass},t.ptmi("root"),{"aria-hidden":"true"}),[ir(t.$slots,"default")],16)}vN.render=Jre;var ub={name:"BaseInput",extends:uN,props:{size:{type:String,default:null},fluid:{type:Boolean,default:null},variant:{type:String,default:null}},inject:{$parentInstance:{default:void 0},$pcFluid:{default:void 0}},computed:{$variant:function(){var e;return(e=this.variant)!==null&&e!==void 0?e:this.$primevue.config.inputStyle||this.$primevue.config.inputVariant},$fluid:function(){var e;return(e=this.fluid)!==null&&e!==void 0?e:!!this.$pcFluid},hasFluid:function(){return this.$fluid}}},Qre=`
    .p-inputtext {
        font-family: inherit;
        font-feature-settings: inherit;
        font-size: 1rem;
        color: dt('inputtext.color');
        background: dt('inputtext.background');
        padding-block: dt('inputtext.padding.y');
        padding-inline: dt('inputtext.padding.x');
        border: 1px solid dt('inputtext.border.color');
        transition:
            background dt('inputtext.transition.duration'),
            color dt('inputtext.transition.duration'),
            border-color dt('inputtext.transition.duration'),
            outline-color dt('inputtext.transition.duration'),
            box-shadow dt('inputtext.transition.duration');
        appearance: none;
        border-radius: dt('inputtext.border.radius');
        outline-color: transparent;
        box-shadow: dt('inputtext.shadow');
    }

    .p-inputtext:enabled:hover {
        border-color: dt('inputtext.hover.border.color');
    }

    .p-inputtext:enabled:focus {
        border-color: dt('inputtext.focus.border.color');
        box-shadow: dt('inputtext.focus.ring.shadow');
        outline: dt('inputtext.focus.ring.width') dt('inputtext.focus.ring.style') dt('inputtext.focus.ring.color');
        outline-offset: dt('inputtext.focus.ring.offset');
    }

    .p-inputtext.p-invalid {
        border-color: dt('inputtext.invalid.border.color');
    }

    .p-inputtext.p-variant-filled {
        background: dt('inputtext.filled.background');
    }

    .p-inputtext.p-variant-filled:enabled:hover {
        background: dt('inputtext.filled.hover.background');
    }

    .p-inputtext.p-variant-filled:enabled:focus {
        background: dt('inputtext.filled.focus.background');
    }

    .p-inputtext:disabled {
        opacity: 1;
        background: dt('inputtext.disabled.background');
        color: dt('inputtext.disabled.color');
    }

    .p-inputtext::placeholder {
        color: dt('inputtext.placeholder.color');
    }

    .p-inputtext.p-invalid::placeholder {
        color: dt('inputtext.invalid.placeholder.color');
    }

    .p-inputtext-sm {
        font-size: dt('inputtext.sm.font.size');
        padding-block: dt('inputtext.sm.padding.y');
        padding-inline: dt('inputtext.sm.padding.x');
    }

    .p-inputtext-lg {
        font-size: dt('inputtext.lg.font.size');
        padding-block: dt('inputtext.lg.padding.y');
        padding-inline: dt('inputtext.lg.padding.x');
    }

    .p-inputtext-fluid {
        width: 100%;
    }
`,eie={root:function(e){var n=e.instance,l=e.props;return["p-inputtext p-component",{"p-filled":n.$filled,"p-inputtext-sm p-inputfield-sm":l.size==="small","p-inputtext-lg p-inputfield-lg":l.size==="large","p-invalid":n.$invalid,"p-variant-filled":n.$variant==="filled","p-inputtext-fluid":n.$fluid}]}},tie=xi.extend({name:"inputtext",style:Qre,classes:eie}),nie={name:"BaseInputText",extends:ub,style:tie,provide:function(){return{$pcInputText:this,$parentInstance:this}}};function v0(t){"@babel/helpers - typeof";return v0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},v0(t)}function rie(t,e,n){return(e=iie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function iie(t){var e=oie(t,"string");return v0(e)=="symbol"?e:e+""}function oie(t,e){if(v0(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var l=n.call(t,e);if(v0(l)!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var rP={name:"InputText",extends:nie,inheritAttrs:!1,methods:{onInput:function(e){this.writeValue(e.target.value,e)}},computed:{attrs:function(){return ot(this.ptmi("root",{context:{filled:this.$filled,disabled:this.disabled}}),this.formField)},dataP:function(){return Rs(rie({invalid:this.$invalid,fluid:this.$fluid,filled:this.$variant==="filled"},this.size,this.size))}}},sie=["value","name","disabled","aria-invalid","data-p"];function aie(t,e,n,l,d,f){return Me(),ft("input",ot({type:"text",class:t.cx("root"),value:t.d_value,name:t.name,disabled:t.disabled,"aria-invalid":t.$invalid||void 0,"data-p":f.dataP,onInput:e[0]||(e[0]=function(){return f.onInput&&f.onInput.apply(f,arguments)})},f.attrs),null,16,sie)}rP.render=aie;var Fh=tP(),iP={name:"Portal",props:{appendTo:{type:[String,Object],default:"body"},disabled:{type:Boolean,default:!1}},data:function(){return{mounted:!1}},mounted:function(){this.mounted=KB()},computed:{inline:function(){return this.disabled||this.appendTo==="self"}}};function lie(t,e,n,l,d,f){return f.inline?ir(t.$slots,"default",{key:0}):d.mounted?(Me(),rn(CU,{key:1,to:n.appendTo},[ir(t.$slots,"default")],8,["to"])):Pn("",!0)}iP.render=lie;var cie=`
    .p-virtualscroller-loader {
        background: dt('virtualscroller.loader.mask.background');
        color: dt('virtualscroller.loader.mask.color');
    }

    .p-virtualscroller-loading-icon {
        font-size: dt('virtualscroller.loader.icon.size');
        width: dt('virtualscroller.loader.icon.size');
        height: dt('virtualscroller.loader.icon.size');
    }
`,uie=`
.p-virtualscroller {
    position: relative;
    overflow: auto;
    contain: strict;
    transform: translateZ(0);
    will-change: scroll-position;
    outline: 0 none;
}

.p-virtualscroller-content {
    position: absolute;
    top: 0;
    left: 0;
    min-height: 100%;
    min-width: 100%;
    will-change: transform;
}

.p-virtualscroller-spacer {
    position: absolute;
    top: 0;
    left: 0;
    height: 1px;
    width: 1px;
    transform-origin: 0 0;
    pointer-events: none;
}

.p-virtualscroller-loader {
    position: sticky;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
}

.p-virtualscroller-loader-mask {
    display: flex;
    align-items: center;
    justify-content: center;
}

.p-virtualscroller-horizontal > .p-virtualscroller-content {
    display: flex;
}

.p-virtualscroller-inline .p-virtualscroller-content {
    position: static;
}

.p-virtualscroller .p-virtualscroller-loading {
    transform: none !important;
    min-height: 0;
    position: sticky;
    inset-block-start: 0;
    inset-inline-start: 0;
}
`,qL=xi.extend({name:"virtualscroller",css:uie,style:cie}),die={name:"BaseVirtualScroller",extends:Yi,props:{id:{type:String,default:null},style:null,class:null,items:{type:Array,default:null},itemSize:{type:[Number,Array],default:0},scrollHeight:null,scrollWidth:null,orientation:{type:String,default:"vertical"},numToleratedItems:{type:Number,default:null},delay:{type:Number,default:0},resizeDelay:{type:Number,default:10},lazy:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},loaderDisabled:{type:Boolean,default:!1},columns:{type:Array,default:null},loading:{type:Boolean,default:!1},showSpacer:{type:Boolean,default:!0},showLoader:{type:Boolean,default:!1},tabindex:{type:Number,default:0},inline:{type:Boolean,default:!1},step:{type:Number,default:0},appendOnly:{type:Boolean,default:!1},autoSize:{type:Boolean,default:!1}},style:qL,provide:function(){return{$pcVirtualScroller:this,$parentInstance:this}},beforeMount:function(){var e;qL.loadCSS({nonce:(e=this.$primevueConfig)===null||e===void 0||(e=e.csp)===null||e===void 0?void 0:e.nonce})}};function b0(t){"@babel/helpers - typeof";return b0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},b0(t)}function KL(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);e&&(l=l.filter(function(d){return Object.getOwnPropertyDescriptor(t,d).enumerable})),n.push.apply(n,l)}return n}function Qy(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?KL(Object(n),!0).forEach(function(l){bN(t,l,n[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):KL(Object(n)).forEach(function(l){Object.defineProperty(t,l,Object.getOwnPropertyDescriptor(n,l))})}return t}function bN(t,e,n){return(e=hie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function hie(t){var e=fie(t,"string");return b0(e)=="symbol"?e:e+""}function fie(t,e){if(b0(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var l=n.call(t,e);if(b0(l)!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var oP={name:"VirtualScroller",extends:die,inheritAttrs:!1,emits:["update:numToleratedItems","scroll","scroll-index-change","lazy-load"],data:function(){var e=this.isBoth();return{first:e?{rows:0,cols:0}:0,last:e?{rows:0,cols:0}:0,page:e?{rows:0,cols:0}:0,numItemsInViewport:e?{rows:0,cols:0}:0,lastScrollPos:e?{top:0,left:0}:0,d_numToleratedItems:this.numToleratedItems,d_loading:this.loading,loaderArr:[],spacerStyle:{},contentStyle:{}}},element:null,content:null,lastScrollPos:null,scrollTimeout:null,resizeTimeout:null,defaultWidth:0,defaultHeight:0,defaultContentWidth:0,defaultContentHeight:0,isRangeChanged:!1,lazyLoadState:{},resizeListener:null,resizeObserver:null,initialized:!1,watch:{numToleratedItems:function(e){this.d_numToleratedItems=e},loading:function(e,n){this.lazy&&e!==n&&e!==this.d_loading&&(this.d_loading=e)},items:{handler:function(e,n){(!n||n.length!==(e||[]).length)&&(this.init(),this.calculateAutoSize())},deep:!0},itemSize:function(){this.init(),this.calculateAutoSize()},orientation:function(){this.lastScrollPos=this.isBoth()?{top:0,left:0}:0},scrollHeight:function(){this.init(),this.calculateAutoSize()},scrollWidth:function(){this.init(),this.calculateAutoSize()}},mounted:function(){this.viewInit(),this.lastScrollPos=this.isBoth()?{top:0,left:0}:0,this.lazyLoadState=this.lazyLoadState||{}},updated:function(){!this.initialized&&this.viewInit()},unmounted:function(){this.unbindResizeListener(),this.initialized=!1},methods:{viewInit:function(){Nw(this.element)&&(this.setContentEl(this.content),this.init(),this.calculateAutoSize(),this.defaultWidth=sp(this.element),this.defaultHeight=op(this.element),this.defaultContentWidth=sp(this.content),this.defaultContentHeight=op(this.content),this.initialized=!0),this.element&&this.bindResizeListener()},init:function(){this.disabled||(this.setSize(),this.calculateOptions(),this.setSpacerSize())},isVertical:function(){return this.orientation==="vertical"},isHorizontal:function(){return this.orientation==="horizontal"},isBoth:function(){return this.orientation==="both"},scrollTo:function(e){this.element&&this.element.scrollTo(e)},scrollToIndex:function(e){var n=this,l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"auto",d=this.isBoth(),f=this.isHorizontal(),x=d?e.every(function(Pe){return Pe>-1}):e>-1;if(x){var s=this.first,C=this.element,P=C.scrollTop,L=P===void 0?0:P,$=C.scrollLeft,V=$===void 0?0:$,j=this.calculateNumItems(),ue=j.numToleratedItems,de=this.getContentPosition(),Te=this.itemSize,Be=function(){var we=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,Se=arguments.length>1?arguments[1]:void 0;return we<=Se?0:we},Ge=function(we,Se,je){return we*Se+je},Ye=function(){var we=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,Se=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return n.scrollTo({left:we,top:Se,behavior:l})},Ne=d?{rows:0,cols:0}:0,Mt=!1,kt=!1;d?(Ne={rows:Be(e[0],ue[0]),cols:Be(e[1],ue[1])},Ye(Ge(Ne.cols,Te[1],de.left),Ge(Ne.rows,Te[0],de.top)),kt=this.lastScrollPos.top!==L||this.lastScrollPos.left!==V,Mt=Ne.rows!==s.rows||Ne.cols!==s.cols):(Ne=Be(e,ue),f?Ye(Ge(Ne,Te,de.left),L):Ye(V,Ge(Ne,Te,de.top)),kt=this.lastScrollPos!==(f?V:L),Mt=Ne!==s),this.isRangeChanged=Mt,kt&&(this.first=Ne)}},scrollInView:function(e,n){var l=this,d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"auto";if(n){var f=this.isBoth(),x=this.isHorizontal(),s=f?e.every(function(Te){return Te>-1}):e>-1;if(s){var C=this.getRenderedRange(),P=C.first,L=C.viewport,$=function(){var Be=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,Ge=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return l.scrollTo({left:Be,top:Ge,behavior:d})},V=n==="to-start",j=n==="to-end";if(V){if(f)L.first.rows-P.rows>e[0]?$(L.first.cols*this.itemSize[1],(L.first.rows-1)*this.itemSize[0]):L.first.cols-P.cols>e[1]&&$((L.first.cols-1)*this.itemSize[1],L.first.rows*this.itemSize[0]);else if(L.first-P>e){var ue=(L.first-1)*this.itemSize;x?$(ue,0):$(0,ue)}}else if(j){if(f)L.last.rows-P.rows<=e[0]+1?$(L.first.cols*this.itemSize[1],(L.first.rows+1)*this.itemSize[0]):L.last.cols-P.cols<=e[1]+1&&$((L.first.cols+1)*this.itemSize[1],L.first.rows*this.itemSize[0]);else if(L.last-P<=e+1){var de=(L.first+1)*this.itemSize;x?$(de,0):$(0,de)}}}}else this.scrollToIndex(e,d)},getRenderedRange:function(){var e=function($,V){return Math.floor($/(V||$))},n=this.first,l=0;if(this.element){var d=this.isBoth(),f=this.isHorizontal(),x=this.element,s=x.scrollTop,C=x.scrollLeft;if(d)n={rows:e(s,this.itemSize[0]),cols:e(C,this.itemSize[1])},l={rows:n.rows+this.numItemsInViewport.rows,cols:n.cols+this.numItemsInViewport.cols};else{var P=f?C:s;n=e(P,this.itemSize),l=n+this.numItemsInViewport}}return{first:this.first,last:this.last,viewport:{first:n,last:l}}},calculateNumItems:function(){var e=this.isBoth(),n=this.isHorizontal(),l=this.itemSize,d=this.getContentPosition(),f=this.element?this.element.offsetWidth-d.left:0,x=this.element?this.element.offsetHeight-d.top:0,s=function(V,j){return Math.ceil(V/(j||V))},C=function(V){return Math.ceil(V/2)},P=e?{rows:s(x,l[0]),cols:s(f,l[1])}:s(n?f:x,l),L=this.d_numToleratedItems||(e?[C(P.rows),C(P.cols)]:C(P));return{numItemsInViewport:P,numToleratedItems:L}},calculateOptions:function(){var e=this,n=this.isBoth(),l=this.first,d=this.calculateNumItems(),f=d.numItemsInViewport,x=d.numToleratedItems,s=function(L,$,V){var j=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;return e.getLast(L+$+(L<V?2:3)*V,j)},C=n?{rows:s(l.rows,f.rows,x[0]),cols:s(l.cols,f.cols,x[1],!0)}:s(l,f,x);this.last=C,this.numItemsInViewport=f,this.d_numToleratedItems=x,this.$emit("update:numToleratedItems",this.d_numToleratedItems),this.showLoader&&(this.loaderArr=n?Array.from({length:f.rows}).map(function(){return Array.from({length:f.cols})}):Array.from({length:f})),this.lazy&&Promise.resolve().then(function(){var P;e.lazyLoadState={first:e.step?n?{rows:0,cols:l.cols}:0:l,last:Math.min(e.step?e.step:C,((P=e.items)===null||P===void 0?void 0:P.length)||0)},e.$emit("lazy-load",e.lazyLoadState)})},calculateAutoSize:function(){var e=this;this.autoSize&&!this.d_loading&&Promise.resolve().then(function(){if(e.content){var n=e.isBoth(),l=e.isHorizontal(),d=e.isVertical();e.content.style.minHeight=e.content.style.minWidth="auto",e.content.style.position="relative",e.element.style.contain="none";var f=[sp(e.element),op(e.element)],x=f[0],s=f[1];(n||l)&&(e.element.style.width=x<e.defaultWidth?x+"px":e.scrollWidth||e.defaultWidth+"px"),(n||d)&&(e.element.style.height=s<e.defaultHeight?s+"px":e.scrollHeight||e.defaultHeight+"px"),e.content.style.minHeight=e.content.style.minWidth="",e.content.style.position="",e.element.style.contain=""}})},getLast:function(){var e,n,l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,d=arguments.length>1?arguments[1]:void 0;return this.items?Math.min(d?((e=this.columns||this.items[0])===null||e===void 0?void 0:e.length)||0:((n=this.items)===null||n===void 0?void 0:n.length)||0,l):0},getContentPosition:function(){if(this.content){var e=getComputedStyle(this.content),n=parseFloat(e.paddingLeft)+Math.max(parseFloat(e.left)||0,0),l=parseFloat(e.paddingRight)+Math.max(parseFloat(e.right)||0,0),d=parseFloat(e.paddingTop)+Math.max(parseFloat(e.top)||0,0),f=parseFloat(e.paddingBottom)+Math.max(parseFloat(e.bottom)||0,0);return{left:n,right:l,top:d,bottom:f,x:n+l,y:d+f}}return{left:0,right:0,top:0,bottom:0,x:0,y:0}},setSize:function(){var e=this;if(this.element){var n=this.isBoth(),l=this.isHorizontal(),d=this.element.parentElement,f=this.scrollWidth||"".concat(this.element.offsetWidth||d.offsetWidth,"px"),x=this.scrollHeight||"".concat(this.element.offsetHeight||d.offsetHeight,"px"),s=function(P,L){return e.element.style[P]=L};n||l?(s("height",x),s("width",f)):s("height",x)}},setSpacerSize:function(){var e=this,n=this.items;if(n){var l=this.isBoth(),d=this.isHorizontal(),f=this.getContentPosition(),x=function(C,P,L){var $=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;return e.spacerStyle=Qy(Qy({},e.spacerStyle),bN({},"".concat(C),(P||[]).length*L+$+"px"))};l?(x("height",n,this.itemSize[0],f.y),x("width",this.columns||n[1],this.itemSize[1],f.x)):d?x("width",this.columns||n,this.itemSize,f.x):x("height",n,this.itemSize,f.y)}},setContentPosition:function(e){var n=this;if(this.content&&!this.appendOnly){var l=this.isBoth(),d=this.isHorizontal(),f=e?e.first:this.first,x=function(L,$){return L*$},s=function(){var L=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,$=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return n.contentStyle=Qy(Qy({},n.contentStyle),{transform:"translate3d(".concat(L,"px, ").concat($,"px, 0)")})};if(l)s(x(f.cols,this.itemSize[1]),x(f.rows,this.itemSize[0]));else{var C=x(f,this.itemSize);d?s(C,0):s(0,C)}}},onScrollPositionChange:function(e){var n=this,l=e.target,d=this.isBoth(),f=this.isHorizontal(),x=this.getContentPosition(),s=function(Re,Ve){return Re?Re>Ve?Re-Ve:Re:0},C=function(Re,Ve){return Math.floor(Re/(Ve||Re))},P=function(Re,Ve,ke,Mn,bn,mn){return Re<=bn?bn:mn?ke-Mn-bn:Ve+bn-1},L=function(Re,Ve,ke,Mn,bn,mn,Sn,ar){if(Re<=mn)return 0;var Br=Math.max(0,Sn?Re<Ve?ke:Re-mn:Re>Ve?ke:Re-2*mn),ei=n.getLast(Br,ar);return Br>ei?ei-bn:Br},$=function(Re,Ve,ke,Mn,bn,mn){var Sn=Ve+Mn+2*bn;return Re>=bn&&(Sn+=bn+1),n.getLast(Sn,mn)},V=s(l.scrollTop,x.top),j=s(l.scrollLeft,x.left),ue=d?{rows:0,cols:0}:0,de=this.last,Te=!1,Be=this.lastScrollPos;if(d){var Ge=this.lastScrollPos.top<=V,Ye=this.lastScrollPos.left<=j;if(!this.appendOnly||this.appendOnly&&(Ge||Ye)){var Ne={rows:C(V,this.itemSize[0]),cols:C(j,this.itemSize[1])},Mt={rows:P(Ne.rows,this.first.rows,this.last.rows,this.numItemsInViewport.rows,this.d_numToleratedItems[0],Ge),cols:P(Ne.cols,this.first.cols,this.last.cols,this.numItemsInViewport.cols,this.d_numToleratedItems[1],Ye)};ue={rows:L(Ne.rows,Mt.rows,this.first.rows,this.last.rows,this.numItemsInViewport.rows,this.d_numToleratedItems[0],Ge),cols:L(Ne.cols,Mt.cols,this.first.cols,this.last.cols,this.numItemsInViewport.cols,this.d_numToleratedItems[1],Ye,!0)},de={rows:$(Ne.rows,ue.rows,this.last.rows,this.numItemsInViewport.rows,this.d_numToleratedItems[0]),cols:$(Ne.cols,ue.cols,this.last.cols,this.numItemsInViewport.cols,this.d_numToleratedItems[1],!0)},Te=ue.rows!==this.first.rows||de.rows!==this.last.rows||ue.cols!==this.first.cols||de.cols!==this.last.cols||this.isRangeChanged,Be={top:V,left:j}}}else{var kt=f?j:V,Pe=this.lastScrollPos<=kt;if(!this.appendOnly||this.appendOnly&&Pe){var we=C(kt,this.itemSize),Se=P(we,this.first,this.last,this.numItemsInViewport,this.d_numToleratedItems,Pe);ue=L(we,Se,this.first,this.last,this.numItemsInViewport,this.d_numToleratedItems,Pe),de=$(we,ue,this.last,this.numItemsInViewport,this.d_numToleratedItems),Te=ue!==this.first||de!==this.last||this.isRangeChanged,Be=kt}}return{first:ue,last:de,isRangeChanged:Te,scrollPos:Be}},onScrollChange:function(e){var n=this.onScrollPositionChange(e),l=n.first,d=n.last,f=n.isRangeChanged,x=n.scrollPos;if(f){var s={first:l,last:d};if(this.setContentPosition(s),this.first=l,this.last=d,this.lastScrollPos=x,this.$emit("scroll-index-change",s),this.lazy&&this.isPageChanged(l)){var C,P,L={first:this.step?Math.min(this.getPageByFirst(l)*this.step,(((C=this.items)===null||C===void 0?void 0:C.length)||0)-this.step):l,last:Math.min(this.step?(this.getPageByFirst(l)+1)*this.step:d,((P=this.items)===null||P===void 0?void 0:P.length)||0)},$=this.lazyLoadState.first!==L.first||this.lazyLoadState.last!==L.last;$&&this.$emit("lazy-load",L),this.lazyLoadState=L}}},onScroll:function(e){var n=this;if(this.$emit("scroll",e),this.delay){if(this.scrollTimeout&&clearTimeout(this.scrollTimeout),this.isPageChanged()){if(!this.d_loading&&this.showLoader){var l=this.onScrollPositionChange(e),d=l.isRangeChanged,f=d||(this.step?this.isPageChanged():!1);f&&(this.d_loading=!0)}this.scrollTimeout=setTimeout(function(){n.onScrollChange(e),n.d_loading&&n.showLoader&&(!n.lazy||n.loading===void 0)&&(n.d_loading=!1,n.page=n.getPageByFirst())},this.delay)}}else this.onScrollChange(e)},onResize:function(){var e=this;this.resizeTimeout&&clearTimeout(this.resizeTimeout),this.resizeTimeout=setTimeout(function(){if(Nw(e.element)){var n=e.isBoth(),l=e.isVertical(),d=e.isHorizontal(),f=[sp(e.element),op(e.element)],x=f[0],s=f[1],C=x!==e.defaultWidth,P=s!==e.defaultHeight,L=n?C||P:d?C:l?P:!1;L&&(e.d_numToleratedItems=e.numToleratedItems,e.defaultWidth=x,e.defaultHeight=s,e.defaultContentWidth=sp(e.content),e.defaultContentHeight=op(e.content),e.init())}},this.resizeDelay)},bindResizeListener:function(){var e=this;this.resizeListener||(this.resizeListener=this.onResize.bind(this),window.addEventListener("resize",this.resizeListener),window.addEventListener("orientationchange",this.resizeListener),this.resizeObserver=new ResizeObserver(function(){e.onResize()}),this.resizeObserver.observe(this.element))},unbindResizeListener:function(){this.resizeListener&&(window.removeEventListener("resize",this.resizeListener),window.removeEventListener("orientationchange",this.resizeListener),this.resizeListener=null),this.resizeObserver&&(this.resizeObserver.disconnect(),this.resizeObserver=null)},getOptions:function(e){var n=(this.items||[]).length,l=this.isBoth()?this.first.rows+e:this.first+e;return{index:l,count:n,first:l===0,last:l===n-1,even:l%2===0,odd:l%2!==0}},getLoaderOptions:function(e,n){var l=this.loaderArr.length;return Qy({index:e,count:l,first:e===0,last:e===l-1,even:e%2===0,odd:e%2!==0},n)},getPageByFirst:function(e){return Math.floor(((e??this.first)+this.d_numToleratedItems*4)/(this.step||1))},isPageChanged:function(e){return this.step&&!this.lazy?this.page!==this.getPageByFirst(e??this.first):!0},setContentEl:function(e){this.content=e||this.content||Lh(this.element,'[data-pc-section="content"]')},elementRef:function(e){this.element=e},contentRef:function(e){this.content=e}},computed:{containerClass:function(){return["p-virtualscroller",this.class,{"p-virtualscroller-inline":this.inline,"p-virtualscroller-both p-both-scroll":this.isBoth(),"p-virtualscroller-horizontal p-horizontal-scroll":this.isHorizontal()}]},contentClass:function(){return["p-virtualscroller-content",{"p-virtualscroller-loading":this.d_loading}]},loaderClass:function(){return["p-virtualscroller-loader",{"p-virtualscroller-loader-mask":!this.$slots.loader}]},loadedItems:function(){var e=this;return this.items&&!this.d_loading?this.isBoth()?this.items.slice(this.appendOnly?0:this.first.rows,this.last.rows).map(function(n){return e.columns?n:n.slice(e.appendOnly?0:e.first.cols,e.last.cols)}):this.isHorizontal()&&this.columns?this.items:this.items.slice(this.appendOnly?0:this.first,this.last):[]},loadedRows:function(){return this.d_loading?this.loaderDisabled?this.loaderArr:[]:this.loadedItems},loadedColumns:function(){if(this.columns){var e=this.isBoth(),n=this.isHorizontal();if(e||n)return this.d_loading&&this.loaderDisabled?e?this.loaderArr[0]:this.loaderArr:this.columns.slice(e?this.first.cols:this.first,e?this.last.cols:this.last)}return this.columns}},components:{SpinnerIcon:cb}},pie=["tabindex"];function mie(t,e,n,l,d,f){var x=_r("SpinnerIcon");return t.disabled?(Me(),ft(Tr,{key:1},[ir(t.$slots,"default"),ir(t.$slots,"content",{items:t.items,rows:t.items,columns:f.loadedColumns})],64)):(Me(),ft("div",ot({key:0,ref:f.elementRef,class:f.containerClass,tabindex:t.tabindex,style:t.style,onScroll:e[0]||(e[0]=function(){return f.onScroll&&f.onScroll.apply(f,arguments)})},t.ptmi("root")),[ir(t.$slots,"content",{styleClass:f.contentClass,items:f.loadedItems,getItemOptions:f.getOptions,loading:d.d_loading,getLoaderOptions:f.getLoaderOptions,itemSize:t.itemSize,rows:f.loadedRows,columns:f.loadedColumns,contentRef:f.contentRef,spacerStyle:d.spacerStyle,contentStyle:d.contentStyle,vertical:f.isVertical(),horizontal:f.isHorizontal(),both:f.isBoth()},function(){return[Ze("div",ot({ref:f.contentRef,class:f.contentClass,style:d.contentStyle},t.ptm("content")),[(Me(!0),ft(Tr,null,ms(f.loadedItems,function(s,C){return ir(t.$slots,"item",{key:C,item:s,options:f.getOptions(C)})}),128))],16)]}),t.showSpacer?(Me(),ft("div",ot({key:0,class:"p-virtualscroller-spacer",style:d.spacerStyle},t.ptm("spacer")),null,16)):Pn("",!0),!t.loaderDisabled&&t.showLoader&&d.d_loading?(Me(),ft("div",ot({key:1,class:f.loaderClass},t.ptm("loader")),[t.$slots&&t.$slots.loader?(Me(!0),ft(Tr,{key:0},ms(d.loaderArr,function(s,C){return ir(t.$slots,"loader",{key:C,options:f.getLoaderOptions(C,f.isBoth()&&{numCols:t.d_numItemsInViewport.cols})})}),128)):Pn("",!0),ir(t.$slots,"loadingicon",{},function(){return[pr(x,ot({spin:"",class:"p-virtualscroller-loading-icon"},t.ptm("loadingIcon")),null,16)]})],16)):Pn("",!0)],16,pie))}oP.render=mie;var gie=`
    .p-select {
        display: inline-flex;
        cursor: pointer;
        position: relative;
        user-select: none;
        background: dt('select.background');
        border: 1px solid dt('select.border.color');
        transition:
            background dt('select.transition.duration'),
            color dt('select.transition.duration'),
            border-color dt('select.transition.duration'),
            outline-color dt('select.transition.duration'),
            box-shadow dt('select.transition.duration');
        border-radius: dt('select.border.radius');
        outline-color: transparent;
        box-shadow: dt('select.shadow');
    }

    .p-select:not(.p-disabled):hover {
        border-color: dt('select.hover.border.color');
    }

    .p-select:not(.p-disabled).p-focus {
        border-color: dt('select.focus.border.color');
        box-shadow: dt('select.focus.ring.shadow');
        outline: dt('select.focus.ring.width') dt('select.focus.ring.style') dt('select.focus.ring.color');
        outline-offset: dt('select.focus.ring.offset');
    }

    .p-select.p-variant-filled {
        background: dt('select.filled.background');
    }

    .p-select.p-variant-filled:not(.p-disabled):hover {
        background: dt('select.filled.hover.background');
    }

    .p-select.p-variant-filled:not(.p-disabled).p-focus {
        background: dt('select.filled.focus.background');
    }

    .p-select.p-invalid {
        border-color: dt('select.invalid.border.color');
    }

    .p-select.p-disabled {
        opacity: 1;
        background: dt('select.disabled.background');
    }

    .p-select-clear-icon {
        align-self: center;
        color: dt('select.clear.icon.color');
        inset-inline-end: dt('select.dropdown.width');
    }

    .p-select-dropdown {
        display: flex;
        align-items: center;
        justify-content: center;
        flex-shrink: 0;
        background: transparent;
        color: dt('select.dropdown.color');
        width: dt('select.dropdown.width');
        border-start-end-radius: dt('select.border.radius');
        border-end-end-radius: dt('select.border.radius');
    }

    .p-select-label {
        display: block;
        white-space: nowrap;
        overflow: hidden;
        flex: 1 1 auto;
        width: 1%;
        padding: dt('select.padding.y') dt('select.padding.x');
        text-overflow: ellipsis;
        cursor: pointer;
        color: dt('select.color');
        background: transparent;
        border: 0 none;
        outline: 0 none;
        font-size: 1rem;
    }

    .p-select-label.p-placeholder {
        color: dt('select.placeholder.color');
    }

    .p-select.p-invalid .p-select-label.p-placeholder {
        color: dt('select.invalid.placeholder.color');
    }

    .p-select.p-disabled .p-select-label {
        color: dt('select.disabled.color');
    }

    .p-select-label-empty {
        overflow: hidden;
        opacity: 0;
    }

    input.p-select-label {
        cursor: default;
    }

    .p-select-overlay {
        position: absolute;
        top: 0;
        left: 0;
        background: dt('select.overlay.background');
        color: dt('select.overlay.color');
        border: 1px solid dt('select.overlay.border.color');
        border-radius: dt('select.overlay.border.radius');
        box-shadow: dt('select.overlay.shadow');
        min-width: 100%;
    }

    .p-select-header {
        padding: dt('select.list.header.padding');
    }

    .p-select-filter {
        width: 100%;
    }

    .p-select-list-container {
        overflow: auto;
    }

    .p-select-option-group {
        cursor: auto;
        margin: 0;
        padding: dt('select.option.group.padding');
        background: dt('select.option.group.background');
        color: dt('select.option.group.color');
        font-weight: dt('select.option.group.font.weight');
    }

    .p-select-list {
        margin: 0;
        padding: 0;
        list-style-type: none;
        padding: dt('select.list.padding');
        gap: dt('select.list.gap');
        display: flex;
        flex-direction: column;
    }

    .p-select-option {
        cursor: pointer;
        font-weight: normal;
        white-space: nowrap;
        position: relative;
        overflow: hidden;
        display: flex;
        align-items: center;
        padding: dt('select.option.padding');
        border: 0 none;
        color: dt('select.option.color');
        background: transparent;
        transition:
            background dt('select.transition.duration'),
            color dt('select.transition.duration'),
            border-color dt('select.transition.duration'),
            box-shadow dt('select.transition.duration'),
            outline-color dt('select.transition.duration');
        border-radius: dt('select.option.border.radius');
    }

    .p-select-option:not(.p-select-option-selected):not(.p-disabled).p-focus {
        background: dt('select.option.focus.background');
        color: dt('select.option.focus.color');
    }

    .p-select-option.p-select-option-selected {
        background: dt('select.option.selected.background');
        color: dt('select.option.selected.color');
    }

    .p-select-option.p-select-option-selected.p-focus {
        background: dt('select.option.selected.focus.background');
        color: dt('select.option.selected.focus.color');
    }

    .p-select-option-blank-icon {
        flex-shrink: 0;
    }

    .p-select-option-check-icon {
        position: relative;
        flex-shrink: 0;
        margin-inline-start: dt('select.checkmark.gutter.start');
        margin-inline-end: dt('select.checkmark.gutter.end');
        color: dt('select.checkmark.color');
    }

    .p-select-empty-message {
        padding: dt('select.empty.message.padding');
    }

    .p-select-fluid {
        display: flex;
        width: 100%;
    }

    .p-select-sm .p-select-label {
        font-size: dt('select.sm.font.size');
        padding-block: dt('select.sm.padding.y');
        padding-inline: dt('select.sm.padding.x');
    }

    .p-select-sm .p-select-dropdown .p-icon {
        font-size: dt('select.sm.font.size');
        width: dt('select.sm.font.size');
        height: dt('select.sm.font.size');
    }

    .p-select-lg .p-select-label {
        font-size: dt('select.lg.font.size');
        padding-block: dt('select.lg.padding.y');
        padding-inline: dt('select.lg.padding.x');
    }

    .p-select-lg .p-select-dropdown .p-icon {
        font-size: dt('select.lg.font.size');
        width: dt('select.lg.font.size');
        height: dt('select.lg.font.size');
    }

    .p-floatlabel-in .p-select-filter {
        padding-block-start: dt('select.padding.y');
        padding-block-end: dt('select.padding.y');
    }
`,_ie={root:function(e){var n=e.instance,l=e.props,d=e.state;return["p-select p-component p-inputwrapper",{"p-disabled":l.disabled,"p-invalid":n.$invalid,"p-variant-filled":n.$variant==="filled","p-focus":d.focused,"p-inputwrapper-filled":n.$filled,"p-inputwrapper-focus":d.focused||d.overlayVisible,"p-select-open":d.overlayVisible,"p-select-fluid":n.$fluid,"p-select-sm p-inputfield-sm":l.size==="small","p-select-lg p-inputfield-lg":l.size==="large"}]},label:function(e){var n=e.instance,l=e.props;return["p-select-label",{"p-placeholder":!l.editable&&n.label===l.placeholder,"p-select-label-empty":!l.editable&&!n.$slots.value&&(n.label==="p-emptylabel"||n.label.length===0)}]},clearIcon:"p-select-clear-icon",dropdown:"p-select-dropdown",loadingicon:"p-select-loading-icon",dropdownIcon:"p-select-dropdown-icon",overlay:"p-select-overlay p-component",header:"p-select-header",pcFilter:"p-select-filter",listContainer:"p-select-list-container",list:"p-select-list",optionGroup:"p-select-option-group",optionGroupLabel:"p-select-option-group-label",option:function(e){var n=e.instance,l=e.props,d=e.state,f=e.option,x=e.focusedOption;return["p-select-option",{"p-select-option-selected":n.isSelected(f)&&l.highlightOnSelect,"p-focus":d.focusedOptionIndex===x,"p-disabled":n.isOptionDisabled(f)}]},optionLabel:"p-select-option-label",optionCheckIcon:"p-select-option-check-icon",optionBlankIcon:"p-select-option-blank-icon",emptyMessage:"p-select-empty-message"},yie=xi.extend({name:"select",style:gie,classes:_ie}),vie={name:"BaseSelect",extends:ub,props:{options:Array,optionLabel:[String,Function],optionValue:[String,Function],optionDisabled:[String,Function],optionGroupLabel:[String,Function],optionGroupChildren:[String,Function],scrollHeight:{type:String,default:"14rem"},filter:Boolean,filterPlaceholder:String,filterLocale:String,filterMatchMode:{type:String,default:"contains"},filterFields:{type:Array,default:null},editable:Boolean,placeholder:{type:String,default:null},dataKey:null,showClear:{type:Boolean,default:!1},inputId:{type:String,default:null},inputClass:{type:[String,Object],default:null},inputStyle:{type:Object,default:null},labelId:{type:String,default:null},labelClass:{type:[String,Object],default:null},labelStyle:{type:Object,default:null},panelClass:{type:[String,Object],default:null},overlayStyle:{type:Object,default:null},overlayClass:{type:[String,Object],default:null},panelStyle:{type:Object,default:null},appendTo:{type:[String,Object],default:"body"},loading:{type:Boolean,default:!1},clearIcon:{type:String,default:void 0},dropdownIcon:{type:String,default:void 0},filterIcon:{type:String,default:void 0},loadingIcon:{type:String,default:void 0},resetFilterOnHide:{type:Boolean,default:!1},resetFilterOnClear:{type:Boolean,default:!1},virtualScrollerOptions:{type:Object,default:null},autoOptionFocus:{type:Boolean,default:!1},autoFilterFocus:{type:Boolean,default:!1},selectOnFocus:{type:Boolean,default:!1},focusOnHover:{type:Boolean,default:!0},highlightOnSelect:{type:Boolean,default:!0},checkmark:{type:Boolean,default:!1},filterMessage:{type:String,default:null},selectionMessage:{type:String,default:null},emptySelectionMessage:{type:String,default:null},emptyFilterMessage:{type:String,default:null},emptyMessage:{type:String,default:null},tabindex:{type:Number,default:0},ariaLabel:{type:String,default:null},ariaLabelledby:{type:String,default:null}},style:yie,provide:function(){return{$pcSelect:this,$parentInstance:this}}};function x0(t){"@babel/helpers - typeof";return x0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},x0(t)}function bie(t){return Sie(t)||Tie(t)||wie(t)||xie()}function xie(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function wie(t,e){if(t){if(typeof t=="string")return q2(t,e);var n={}.toString.call(t).slice(8,-1);return n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set"?Array.from(t):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?q2(t,e):void 0}}function Tie(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function Sie(t){if(Array.isArray(t))return q2(t)}function q2(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,l=Array(e);n<e;n++)l[n]=t[n];return l}function ZL(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);e&&(l=l.filter(function(d){return Object.getOwnPropertyDescriptor(t,d).enumerable})),n.push.apply(n,l)}return n}function XL(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?ZL(Object(n),!0).forEach(function(l){rp(t,l,n[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ZL(Object(n)).forEach(function(l){Object.defineProperty(t,l,Object.getOwnPropertyDescriptor(n,l))})}return t}function rp(t,e,n){return(e=Eie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Eie(t){var e=Cie(t,"string");return x0(e)=="symbol"?e:e+""}function Cie(t,e){if(x0(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var l=n.call(t,e);if(x0(l)!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var VT={name:"Select",extends:vie,inheritAttrs:!1,emits:["change","focus","blur","before-show","before-hide","show","hide","filter"],outsideClickListener:null,scrollHandler:null,resizeListener:null,labelClickListener:null,matchMediaOrientationListener:null,overlay:null,list:null,virtualScroller:null,searchTimeout:null,searchValue:null,isModelValueChanged:!1,data:function(){return{clicked:!1,focused:!1,focusedOptionIndex:-1,filterValue:null,overlayVisible:!1,queryOrientation:null}},watch:{modelValue:function(){this.isModelValueChanged=!0},options:function(){this.autoUpdateModel()}},mounted:function(){this.autoUpdateModel(),this.bindLabelClickListener(),this.bindMatchMediaOrientationListener()},updated:function(){this.overlayVisible&&this.isModelValueChanged&&this.scrollInView(this.findSelectedOptionIndex()),this.isModelValueChanged=!1},beforeUnmount:function(){this.unbindOutsideClickListener(),this.unbindResizeListener(),this.unbindLabelClickListener(),this.unbindMatchMediaOrientationListener(),this.scrollHandler&&(this.scrollHandler.destroy(),this.scrollHandler=null),this.overlay&&(Ag.clear(this.overlay),this.overlay=null)},methods:{getOptionIndex:function(e,n){return this.virtualScrollerDisabled?e:n&&n(e).index},getOptionLabel:function(e){return this.optionLabel?Di(e,this.optionLabel):e},getOptionValue:function(e){return this.optionValue?Di(e,this.optionValue):e},getOptionRenderKey:function(e,n){return(this.dataKey?Di(e,this.dataKey):this.getOptionLabel(e))+"_"+n},getPTItemOptions:function(e,n,l,d){return this.ptm(d,{context:{option:e,index:l,selected:this.isSelected(e),focused:this.focusedOptionIndex===this.getOptionIndex(l,n),disabled:this.isOptionDisabled(e)}})},isOptionDisabled:function(e){return this.optionDisabled?Di(e,this.optionDisabled):!1},isOptionGroup:function(e){return this.optionGroupLabel&&e.optionGroup&&e.group},getOptionGroupLabel:function(e){return Di(e,this.optionGroupLabel)},getOptionGroupChildren:function(e){return Di(e,this.optionGroupChildren)},getAriaPosInset:function(e){var n=this;return(this.optionGroupLabel?e-this.visibleOptions.slice(0,e).filter(function(l){return n.isOptionGroup(l)}).length:e)+1},show:function(e){this.$emit("before-show"),this.overlayVisible=!0,this.focusedOptionIndex=this.focusedOptionIndex!==-1?this.focusedOptionIndex:this.autoOptionFocus?this.findFirstFocusedOptionIndex():this.editable?-1:this.findSelectedOptionIndex(),e&&Ea(this.$refs.focusInput)},hide:function(e){var n=this,l=function(){n.$emit("before-hide"),n.overlayVisible=!1,n.clicked=!1,n.focusedOptionIndex=-1,n.searchValue="",n.resetFilterOnHide&&(n.filterValue=null),e&&Ea(n.$refs.focusInput)};setTimeout(function(){l()},0)},onFocus:function(e){this.disabled||(this.focused=!0,this.overlayVisible&&(this.focusedOptionIndex=this.focusedOptionIndex!==-1?this.focusedOptionIndex:this.autoOptionFocus?this.findFirstFocusedOptionIndex():this.editable?-1:this.findSelectedOptionIndex(),this.scrollInView(this.focusedOptionIndex)),this.$emit("focus",e))},onBlur:function(e){var n=this;setTimeout(function(){var l,d;n.focused=!1,n.focusedOptionIndex=-1,n.searchValue="",n.$emit("blur",e),(l=(d=n.formField).onBlur)===null||l===void 0||l.call(d,e)},100)},onKeyDown:function(e){if(this.disabled){e.preventDefault();return}if(bee())switch(e.code){case"Backspace":this.onBackspaceKey(e,this.editable);break;case"Enter":case"NumpadDecimal":this.onEnterKey(e);break;default:e.preventDefault();return}var n=e.metaKey||e.ctrlKey;switch(e.code){case"ArrowDown":this.onArrowDownKey(e);break;case"ArrowUp":this.onArrowUpKey(e,this.editable);break;case"ArrowLeft":case"ArrowRight":this.onArrowLeftKey(e,this.editable);break;case"Home":this.onHomeKey(e,this.editable);break;case"End":this.onEndKey(e,this.editable);break;case"PageDown":this.onPageDownKey(e);break;case"PageUp":this.onPageUpKey(e);break;case"Space":this.onSpaceKey(e,this.editable);break;case"Enter":case"NumpadEnter":this.onEnterKey(e);break;case"Escape":this.onEscapeKey(e);break;case"Tab":this.onTabKey(e);break;case"Backspace":this.onBackspaceKey(e,this.editable);break;case"ShiftLeft":case"ShiftRight":break;default:!n&&see(e.key)&&(!this.overlayVisible&&this.show(),!this.editable&&this.searchOptions(e,e.key),this.filter&&(this.filterValue=e.key));break}this.clicked=!1},onEditableInput:function(e){var n=e.target.value;this.searchValue="";var l=this.searchOptions(e,n);!l&&(this.focusedOptionIndex=-1),this.updateModel(e,n),!this.overlayVisible&&si(n)&&this.show()},onContainerClick:function(e){this.disabled||this.loading||e.target.tagName==="INPUT"||e.target.getAttribute("data-pc-section")==="clearicon"||e.target.closest('[data-pc-section="clearicon"]')||((!this.overlay||!this.overlay.contains(e.target))&&(this.overlayVisible?this.hide(!0):this.show(!0)),this.clicked=!0)},onClearClick:function(e){this.updateModel(e,null),this.resetFilterOnClear&&(this.filterValue=null)},onFirstHiddenFocus:function(e){var n=e.relatedTarget===this.$refs.focusInput?Oh(this.overlay,':not([data-p-hidden-focusable="true"])'):this.$refs.focusInput;Ea(n)},onLastHiddenFocus:function(e){var n=e.relatedTarget===this.$refs.focusInput?WB(this.overlay,':not([data-p-hidden-focusable="true"])'):this.$refs.focusInput;Ea(n)},onOptionSelect:function(e,n){var l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,d=this.getOptionValue(n);this.updateModel(e,d),l&&this.hide(!0)},onOptionMouseMove:function(e,n){this.focusOnHover&&this.changeFocusedOptionIndex(e,n)},onFilterChange:function(e){var n=e.target.value;this.filterValue=n,this.focusedOptionIndex=-1,this.$emit("filter",{originalEvent:e,value:n}),!this.virtualScrollerDisabled&&this.virtualScroller.scrollToIndex(0)},onFilterKeyDown:function(e){if(!e.isComposing)switch(e.code){case"ArrowDown":this.onArrowDownKey(e);break;case"ArrowUp":this.onArrowUpKey(e,!0);break;case"ArrowLeft":case"ArrowRight":this.onArrowLeftKey(e,!0);break;case"Home":this.onHomeKey(e,!0);break;case"End":this.onEndKey(e,!0);break;case"Enter":case"NumpadEnter":this.onEnterKey(e);break;case"Escape":this.onEscapeKey(e);break;case"Tab":this.onTabKey(e);break}},onFilterBlur:function(){this.focusedOptionIndex=-1},onFilterUpdated:function(){this.overlayVisible&&this.alignOverlay()},onOverlayClick:function(e){Fh.emit("overlay-click",{originalEvent:e,target:this.$el})},onOverlayKeyDown:function(e){switch(e.code){case"Escape":this.onEscapeKey(e);break}},onArrowDownKey:function(e){if(!this.overlayVisible)this.show(),this.editable&&this.changeFocusedOptionIndex(e,this.findSelectedOptionIndex());else{var n=this.focusedOptionIndex!==-1?this.findNextOptionIndex(this.focusedOptionIndex):this.clicked?this.findFirstOptionIndex():this.findFirstFocusedOptionIndex();this.changeFocusedOptionIndex(e,n)}e.preventDefault()},onArrowUpKey:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(e.altKey&&!n)this.focusedOptionIndex!==-1&&this.onOptionSelect(e,this.visibleOptions[this.focusedOptionIndex]),this.overlayVisible&&this.hide(),e.preventDefault();else{var l=this.focusedOptionIndex!==-1?this.findPrevOptionIndex(this.focusedOptionIndex):this.clicked?this.findLastOptionIndex():this.findLastFocusedOptionIndex();this.changeFocusedOptionIndex(e,l),!this.overlayVisible&&this.show(),e.preventDefault()}},onArrowLeftKey:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;n&&(this.focusedOptionIndex=-1)},onHomeKey:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(n){var l=e.currentTarget;e.shiftKey?l.setSelectionRange(0,e.target.selectionStart):(l.setSelectionRange(0,0),this.focusedOptionIndex=-1)}else this.changeFocusedOptionIndex(e,this.findFirstOptionIndex()),!this.overlayVisible&&this.show();e.preventDefault()},onEndKey:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(n){var l=e.currentTarget;if(e.shiftKey)l.setSelectionRange(e.target.selectionStart,l.value.length);else{var d=l.value.length;l.setSelectionRange(d,d),this.focusedOptionIndex=-1}}else this.changeFocusedOptionIndex(e,this.findLastOptionIndex()),!this.overlayVisible&&this.show();e.preventDefault()},onPageUpKey:function(e){this.scrollInView(0),e.preventDefault()},onPageDownKey:function(e){this.scrollInView(this.visibleOptions.length-1),e.preventDefault()},onEnterKey:function(e){this.overlayVisible?(this.focusedOptionIndex!==-1&&this.onOptionSelect(e,this.visibleOptions[this.focusedOptionIndex]),this.hide(!0)):(this.focusedOptionIndex=-1,this.onArrowDownKey(e)),e.preventDefault()},onSpaceKey:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;!n&&this.onEnterKey(e)},onEscapeKey:function(e){this.overlayVisible&&this.hide(!0),e.preventDefault(),e.stopPropagation()},onTabKey:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;n||(this.overlayVisible&&this.hasFocusableElements()?(Ea(this.$refs.firstHiddenFocusableElementOnOverlay),e.preventDefault()):(this.focusedOptionIndex!==-1&&this.onOptionSelect(e,this.visibleOptions[this.focusedOptionIndex]),this.overlayVisible&&this.hide(this.filter)))},onBackspaceKey:function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;n&&!this.overlayVisible&&this.show()},onOverlayEnter:function(e){var n=this;Ag.set("overlay",e,this.$primevue.config.zIndex.overlay),zw(e,{position:"absolute",top:"0"}),this.alignOverlay(),this.scrollInView(),this.$attrSelector&&e.setAttribute(this.$attrSelector,""),setTimeout(function(){n.autoFilterFocus&&n.filter&&Ea(n.$refs.filterInput.$el),n.autoUpdateModel()},1)},onOverlayAfterEnter:function(){this.bindOutsideClickListener(),this.bindScrollListener(),this.bindResizeListener(),this.$emit("show")},onOverlayLeave:function(){var e=this;this.unbindOutsideClickListener(),this.unbindScrollListener(),this.unbindResizeListener(),this.autoFilterFocus&&this.filter&&!this.editable&&this.$nextTick(function(){e.$refs.filterInput&&Ea(e.$refs.filterInput.$el)}),this.$emit("hide"),this.overlay=null},onOverlayAfterLeave:function(e){Ag.clear(e)},alignOverlay:function(){this.appendTo==="self"?mee(this.overlay,this.$el):this.overlay&&(this.overlay.style.minWidth=Ga(this.$el)+"px",GB(this.overlay,this.$el))},bindOutsideClickListener:function(){var e=this;this.outsideClickListener||(this.outsideClickListener=function(n){var l=n.composedPath();e.overlayVisible&&e.overlay&&!l.includes(e.$el)&&!l.includes(e.overlay)&&e.hide()},document.addEventListener("click",this.outsideClickListener,!0))},unbindOutsideClickListener:function(){this.outsideClickListener&&(document.removeEventListener("click",this.outsideClickListener,!0),this.outsideClickListener=null)},bindScrollListener:function(){var e=this;this.scrollHandler||(this.scrollHandler=new dN(this.$refs.container,function(){e.overlayVisible&&e.hide()})),this.scrollHandler.bindScrollListener()},unbindScrollListener:function(){this.scrollHandler&&this.scrollHandler.unbindScrollListener()},bindResizeListener:function(){var e=this;this.resizeListener||(this.resizeListener=function(){e.overlayVisible&&!ZB()&&e.hide()},window.addEventListener("resize",this.resizeListener))},unbindResizeListener:function(){this.resizeListener&&(window.removeEventListener("resize",this.resizeListener),this.resizeListener=null)},bindLabelClickListener:function(){var e=this;if(!this.editable&&!this.labelClickListener){var n=document.querySelector('label[for="'.concat(this.labelId,'"]'));n&&Nw(n)&&(this.labelClickListener=function(){Ea(e.$refs.focusInput)},n.addEventListener("click",this.labelClickListener))}},unbindLabelClickListener:function(){if(this.labelClickListener){var e=document.querySelector('label[for="'.concat(this.labelId,'"]'));e&&Nw(e)&&e.removeEventListener("click",this.labelClickListener)}},bindMatchMediaOrientationListener:function(){var e=this;if(!this.matchMediaOrientationListener){var n=matchMedia("(orientation: portrait)");this.queryOrientation=n,this.matchMediaOrientationListener=function(){e.alignOverlay()},this.queryOrientation.addEventListener("change",this.matchMediaOrientationListener)}},unbindMatchMediaOrientationListener:function(){this.matchMediaOrientationListener&&(this.queryOrientation.removeEventListener("change",this.matchMediaOrientationListener),this.queryOrientation=null,this.matchMediaOrientationListener=null)},hasFocusableElements:function(){return QA(this.overlay,':not([data-p-hidden-focusable="true"])').length>0},isOptionExactMatched:function(e){var n;return this.isValidOption(e)&&typeof this.getOptionLabel(e)=="string"&&((n=this.getOptionLabel(e))===null||n===void 0?void 0:n.toLocaleLowerCase(this.filterLocale))==this.searchValue.toLocaleLowerCase(this.filterLocale)},isOptionStartsWith:function(e){var n;return this.isValidOption(e)&&typeof this.getOptionLabel(e)=="string"&&((n=this.getOptionLabel(e))===null||n===void 0?void 0:n.toLocaleLowerCase(this.filterLocale).startsWith(this.searchValue.toLocaleLowerCase(this.filterLocale)))},isValidOption:function(e){return si(e)&&!(this.isOptionDisabled(e)||this.isOptionGroup(e))},isValidSelectedOption:function(e){return this.isValidOption(e)&&this.isSelected(e)},isSelected:function(e){return Pp(this.d_value,this.getOptionValue(e),this.equalityKey)},findFirstOptionIndex:function(){var e=this;return this.visibleOptions.findIndex(function(n){return e.isValidOption(n)})},findLastOptionIndex:function(){var e=this;return gL(this.visibleOptions,function(n){return e.isValidOption(n)})},findNextOptionIndex:function(e){var n=this,l=e<this.visibleOptions.length-1?this.visibleOptions.slice(e+1).findIndex(function(d){return n.isValidOption(d)}):-1;return l>-1?l+e+1:e},findPrevOptionIndex:function(e){var n=this,l=e>0?gL(this.visibleOptions.slice(0,e),function(d){return n.isValidOption(d)}):-1;return l>-1?l:e},findSelectedOptionIndex:function(){var e=this;return this.visibleOptions.findIndex(function(n){return e.isValidSelectedOption(n)})},findFirstFocusedOptionIndex:function(){var e=this.findSelectedOptionIndex();return e<0?this.findFirstOptionIndex():e},findLastFocusedOptionIndex:function(){var e=this.findSelectedOptionIndex();return e<0?this.findLastOptionIndex():e},searchOptions:function(e,n){var l=this;this.searchValue=(this.searchValue||"")+n;var d=-1,f=!1;return si(this.searchValue)&&(d=this.visibleOptions.findIndex(function(x){return l.isOptionExactMatched(x)}),d===-1&&(d=this.visibleOptions.findIndex(function(x){return l.isOptionStartsWith(x)})),d!==-1&&(f=!0),d===-1&&this.focusedOptionIndex===-1&&(d=this.findFirstFocusedOptionIndex()),d!==-1&&this.changeFocusedOptionIndex(e,d)),this.searchTimeout&&clearTimeout(this.searchTimeout),this.searchTimeout=setTimeout(function(){l.searchValue="",l.searchTimeout=null},500),f},changeFocusedOptionIndex:function(e,n){this.focusedOptionIndex!==n&&(this.focusedOptionIndex=n,this.scrollInView(),this.selectOnFocus&&this.onOptionSelect(e,this.visibleOptions[n],!1))},scrollInView:function(){var e=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:-1;this.$nextTick(function(){var l=n!==-1?"".concat(e.$id,"_").concat(n):e.focusedOptionId,d=Lh(e.list,'li[id="'.concat(l,'"]'));d?d.scrollIntoView&&d.scrollIntoView({block:"nearest",inline:"nearest"}):e.virtualScrollerDisabled||e.virtualScroller&&e.virtualScroller.scrollToIndex(n!==-1?n:e.focusedOptionIndex)})},autoUpdateModel:function(){this.autoOptionFocus&&(this.focusedOptionIndex=this.findFirstFocusedOptionIndex()),this.selectOnFocus&&this.autoOptionFocus&&!this.$filled&&this.onOptionSelect(null,this.visibleOptions[this.focusedOptionIndex],!1)},updateModel:function(e,n){this.writeValue(n,e),this.$emit("change",{originalEvent:e,value:n})},flatOptions:function(e){var n=this;return(e||[]).reduce(function(l,d,f){l.push({optionGroup:d,group:!0,index:f});var x=n.getOptionGroupChildren(d);return x&&x.forEach(function(s){return l.push(s)}),l},[])},overlayRef:function(e){this.overlay=e},listRef:function(e,n){this.list=e,n&&n(e)},virtualScrollerRef:function(e){this.virtualScroller=e}},computed:{visibleOptions:function(){var e=this,n=this.optionGroupLabel?this.flatOptions(this.options):this.options||[];if(this.filterValue){var l=I2.filter(n,this.searchFields,this.filterValue,this.filterMatchMode,this.filterLocale);if(this.optionGroupLabel){var d=this.options||[],f=[];return d.forEach(function(x){var s=e.getOptionGroupChildren(x),C=s.filter(function(P){return l.includes(P)});C.length>0&&f.push(XL(XL({},x),{},rp({},typeof e.optionGroupChildren=="string"?e.optionGroupChildren:"items",bie(C))))}),this.flatOptions(f)}return l}return n},hasSelectedOption:function(){return this.$filled},label:function(){var e=this.findSelectedOptionIndex();return e!==-1?this.getOptionLabel(this.visibleOptions[e]):this.placeholder||"p-emptylabel"},editableInputValue:function(){var e=this.findSelectedOptionIndex();return e!==-1?this.getOptionLabel(this.visibleOptions[e]):this.d_value||""},equalityKey:function(){return this.optionValue?null:this.dataKey},searchFields:function(){return this.filterFields||[this.optionLabel]},filterResultMessageText:function(){return si(this.visibleOptions)?this.filterMessageText.replaceAll("{0}",this.visibleOptions.length):this.emptyFilterMessageText},filterMessageText:function(){return this.filterMessage||this.$primevue.config.locale.searchMessage||""},emptyFilterMessageText:function(){return this.emptyFilterMessage||this.$primevue.config.locale.emptySearchMessage||this.$primevue.config.locale.emptyFilterMessage||""},emptyMessageText:function(){return this.emptyMessage||this.$primevue.config.locale.emptyMessage||""},selectionMessageText:function(){return this.selectionMessage||this.$primevue.config.locale.selectionMessage||""},emptySelectionMessageText:function(){return this.emptySelectionMessage||this.$primevue.config.locale.emptySelectionMessage||""},selectedMessageText:function(){return this.$filled?this.selectionMessageText.replaceAll("{0}","1"):this.emptySelectionMessageText},focusedOptionId:function(){return this.focusedOptionIndex!==-1?"".concat(this.$id,"_").concat(this.focusedOptionIndex):null},ariaSetSize:function(){var e=this;return this.visibleOptions.filter(function(n){return!e.isOptionGroup(n)}).length},isClearIconVisible:function(){return this.showClear&&this.d_value!=null&&!this.disabled&&!this.loading},virtualScrollerDisabled:function(){return!this.virtualScrollerOptions},containerDataP:function(){return Rs(rp({invalid:this.$invalid,disabled:this.disabled,focus:this.focused,fluid:this.$fluid,filled:this.$variant==="filled"},this.size,this.size))},labelDataP:function(){return Rs(rp(rp({placeholder:!this.editable&&this.label===this.placeholder,clearable:this.showClear,disabled:this.disabled,editable:this.editable},this.size,this.size),"empty",!this.editable&&!this.$slots.value&&(this.label==="p-emptylabel"||this.label.length===0)))},dropdownIconDataP:function(){return Rs(rp({},this.size,this.size))},overlayDataP:function(){return Rs(rp({},"portal-"+this.appendTo,"portal-"+this.appendTo))}},directives:{ripple:cf},components:{InputText:rP,VirtualScroller:oP,Portal:iP,InputIcon:vN,IconField:yN,TimesIcon:NT,ChevronDownIcon:BT,SpinnerIcon:cb,SearchIcon:_N,CheckIcon:s_,BlankIcon:gN}},Iie=["id","data-p"],Aie=["name","id","value","placeholder","tabindex","disabled","aria-label","aria-labelledby","aria-expanded","aria-controls","aria-activedescendant","aria-invalid","data-p"],Pie=["name","id","tabindex","aria-label","aria-labelledby","aria-expanded","aria-controls","aria-activedescendant","aria-invalid","aria-disabled","data-p"],Rie=["data-p"],kie=["id"],Oie=["id"],Mie=["id","aria-label","aria-selected","aria-disabled","aria-setsize","aria-posinset","onMousedown","onMousemove","data-p-selected","data-p-focused","data-p-disabled"];function Die(t,e,n,l,d,f){var x=_r("SpinnerIcon"),s=_r("InputText"),C=_r("SearchIcon"),P=_r("InputIcon"),L=_r("IconField"),$=_r("CheckIcon"),V=_r("BlankIcon"),j=_r("VirtualScroller"),ue=_r("Portal"),de=Cd("ripple");return Me(),ft("div",ot({ref:"container",id:t.$id,class:t.cx("root"),onClick:e[12]||(e[12]=function(){return f.onContainerClick&&f.onContainerClick.apply(f,arguments)}),"data-p":f.containerDataP},t.ptmi("root")),[t.editable?(Me(),ft("input",ot({key:0,ref:"focusInput",name:t.name,id:t.labelId||t.inputId,type:"text",class:[t.cx("label"),t.inputClass,t.labelClass],style:[t.inputStyle,t.labelStyle],value:f.editableInputValue,placeholder:t.placeholder,tabindex:t.disabled?-1:t.tabindex,disabled:t.disabled,autocomplete:"off",role:"combobox","aria-label":t.ariaLabel,"aria-labelledby":t.ariaLabelledby,"aria-haspopup":"listbox","aria-expanded":d.overlayVisible,"aria-controls":d.overlayVisible?t.$id+"_list":void 0,"aria-activedescendant":d.focused?f.focusedOptionId:void 0,"aria-invalid":t.invalid||void 0,onFocus:e[0]||(e[0]=function(){return f.onFocus&&f.onFocus.apply(f,arguments)}),onBlur:e[1]||(e[1]=function(){return f.onBlur&&f.onBlur.apply(f,arguments)}),onKeydown:e[2]||(e[2]=function(){return f.onKeyDown&&f.onKeyDown.apply(f,arguments)}),onInput:e[3]||(e[3]=function(){return f.onEditableInput&&f.onEditableInput.apply(f,arguments)}),"data-p":f.labelDataP},t.ptm("label")),null,16,Aie)):(Me(),ft("span",ot({key:1,ref:"focusInput",name:t.name,id:t.labelId||t.inputId,class:[t.cx("label"),t.inputClass,t.labelClass],style:[t.inputStyle,t.labelStyle],tabindex:t.disabled?-1:t.tabindex,role:"combobox","aria-label":t.ariaLabel||(f.label==="p-emptylabel"?void 0:f.label),"aria-labelledby":t.ariaLabelledby,"aria-haspopup":"listbox","aria-expanded":d.overlayVisible,"aria-controls":t.$id+"_list","aria-activedescendant":d.focused?f.focusedOptionId:void 0,"aria-invalid":t.invalid||void 0,"aria-disabled":t.disabled,onFocus:e[4]||(e[4]=function(){return f.onFocus&&f.onFocus.apply(f,arguments)}),onBlur:e[5]||(e[5]=function(){return f.onBlur&&f.onBlur.apply(f,arguments)}),onKeydown:e[6]||(e[6]=function(){return f.onKeyDown&&f.onKeyDown.apply(f,arguments)}),"data-p":f.labelDataP},t.ptm("label")),[ir(t.$slots,"value",{value:t.d_value,placeholder:t.placeholder},function(){var Te;return[Ra(Fr(f.label==="p-emptylabel"?"":(Te=f.label)!==null&&Te!==void 0?Te:"empty"),1)]})],16,Pie)),f.isClearIconVisible?ir(t.$slots,"clearicon",{key:2,class:wr(t.cx("clearIcon")),clearCallback:f.onClearClick},function(){return[(Me(),rn(Hr(t.clearIcon?"i":"TimesIcon"),ot({ref:"clearIcon",class:[t.cx("clearIcon"),t.clearIcon],onClick:f.onClearClick},t.ptm("clearIcon"),{"data-pc-section":"clearicon"}),null,16,["class","onClick"]))]}):Pn("",!0),Ze("div",ot({class:t.cx("dropdown")},t.ptm("dropdown")),[t.loading?ir(t.$slots,"loadingicon",{key:0,class:wr(t.cx("loadingIcon"))},function(){return[t.loadingIcon?(Me(),ft("span",ot({key:0,class:[t.cx("loadingIcon"),"pi-spin",t.loadingIcon],"aria-hidden":"true"},t.ptm("loadingIcon")),null,16)):(Me(),rn(x,ot({key:1,class:t.cx("loadingIcon"),spin:"","aria-hidden":"true"},t.ptm("loadingIcon")),null,16,["class"]))]}):ir(t.$slots,"dropdownicon",{key:1,class:wr(t.cx("dropdownIcon"))},function(){return[(Me(),rn(Hr(t.dropdownIcon?"span":"ChevronDownIcon"),ot({class:[t.cx("dropdownIcon"),t.dropdownIcon],"aria-hidden":"true","data-p":f.dropdownIconDataP},t.ptm("dropdownIcon")),null,16,["class","data-p"]))]})],16),pr(ue,{appendTo:t.appendTo},{default:zr(function(){return[pr(O6,ot({name:"p-connected-overlay",onEnter:f.onOverlayEnter,onAfterEnter:f.onOverlayAfterEnter,onLeave:f.onOverlayLeave,onAfterLeave:f.onOverlayAfterLeave},t.ptm("transition")),{default:zr(function(){return[d.overlayVisible?(Me(),ft("div",ot({key:0,ref:f.overlayRef,class:[t.cx("overlay"),t.panelClass,t.overlayClass],style:[t.panelStyle,t.overlayStyle],onClick:e[10]||(e[10]=function(){return f.onOverlayClick&&f.onOverlayClick.apply(f,arguments)}),onKeydown:e[11]||(e[11]=function(){return f.onOverlayKeyDown&&f.onOverlayKeyDown.apply(f,arguments)}),"data-p":f.overlayDataP},t.ptm("overlay")),[Ze("span",ot({ref:"firstHiddenFocusableElementOnOverlay",role:"presentation","aria-hidden":"true",class:"p-hidden-accessible p-hidden-focusable",tabindex:0,onFocus:e[7]||(e[7]=function(){return f.onFirstHiddenFocus&&f.onFirstHiddenFocus.apply(f,arguments)})},t.ptm("hiddenFirstFocusableEl"),{"data-p-hidden-accessible":!0,"data-p-hidden-focusable":!0}),null,16),ir(t.$slots,"header",{value:t.d_value,options:f.visibleOptions}),t.filter?(Me(),ft("div",ot({key:0,class:t.cx("header")},t.ptm("header")),[pr(L,{unstyled:t.unstyled,pt:t.ptm("pcFilterContainer")},{default:zr(function(){return[pr(s,{ref:"filterInput",type:"text",value:d.filterValue,onVnodeMounted:f.onFilterUpdated,onVnodeUpdated:f.onFilterUpdated,class:wr(t.cx("pcFilter")),placeholder:t.filterPlaceholder,variant:t.variant,unstyled:t.unstyled,role:"searchbox",autocomplete:"off","aria-owns":t.$id+"_list","aria-activedescendant":f.focusedOptionId,onKeydown:f.onFilterKeyDown,onBlur:f.onFilterBlur,onInput:f.onFilterChange,pt:t.ptm("pcFilter"),formControl:{novalidate:!0}},null,8,["value","onVnodeMounted","onVnodeUpdated","class","placeholder","variant","unstyled","aria-owns","aria-activedescendant","onKeydown","onBlur","onInput","pt"]),pr(P,{unstyled:t.unstyled,pt:t.ptm("pcFilterIconContainer")},{default:zr(function(){return[ir(t.$slots,"filtericon",{},function(){return[t.filterIcon?(Me(),ft("span",ot({key:0,class:t.filterIcon},t.ptm("filterIcon")),null,16)):(Me(),rn(C,Xw(ot({key:1},t.ptm("filterIcon"))),null,16))]})]}),_:3},8,["unstyled","pt"])]}),_:3},8,["unstyled","pt"]),Ze("span",ot({role:"status","aria-live":"polite",class:"p-hidden-accessible"},t.ptm("hiddenFilterResult"),{"data-p-hidden-accessible":!0}),Fr(f.filterResultMessageText),17)],16)):Pn("",!0),Ze("div",ot({class:t.cx("listContainer"),style:{"max-height":f.virtualScrollerDisabled?t.scrollHeight:""}},t.ptm("listContainer")),[pr(j,ot({ref:f.virtualScrollerRef},t.virtualScrollerOptions,{items:f.visibleOptions,style:{height:t.scrollHeight},tabindex:-1,disabled:f.virtualScrollerDisabled,pt:t.ptm("virtualScroller")}),Nv({content:zr(function(Te){var Be=Te.styleClass,Ge=Te.contentRef,Ye=Te.items,Ne=Te.getItemOptions,Mt=Te.contentStyle,kt=Te.itemSize;return[Ze("ul",ot({ref:function(we){return f.listRef(we,Ge)},id:t.$id+"_list",class:[t.cx("list"),Be],style:Mt,role:"listbox"},t.ptm("list")),[(Me(!0),ft(Tr,null,ms(Ye,function(Pe,we){return Me(),ft(Tr,{key:f.getOptionRenderKey(Pe,f.getOptionIndex(we,Ne))},[f.isOptionGroup(Pe)?(Me(),ft("li",ot({key:0,id:t.$id+"_"+f.getOptionIndex(we,Ne),style:{height:kt?kt+"px":void 0},class:t.cx("optionGroup"),role:"option"},{ref_for:!0},t.ptm("optionGroup")),[ir(t.$slots,"optiongroup",{option:Pe.optionGroup,index:f.getOptionIndex(we,Ne)},function(){return[Ze("span",ot({class:t.cx("optionGroupLabel")},{ref_for:!0},t.ptm("optionGroupLabel")),Fr(f.getOptionGroupLabel(Pe.optionGroup)),17)]})],16,Oie)):Xi((Me(),ft("li",ot({key:1,id:t.$id+"_"+f.getOptionIndex(we,Ne),class:t.cx("option",{option:Pe,focusedOption:f.getOptionIndex(we,Ne)}),style:{height:kt?kt+"px":void 0},role:"option","aria-label":f.getOptionLabel(Pe),"aria-selected":f.isSelected(Pe),"aria-disabled":f.isOptionDisabled(Pe),"aria-setsize":f.ariaSetSize,"aria-posinset":f.getAriaPosInset(f.getOptionIndex(we,Ne)),onMousedown:function(je){return f.onOptionSelect(je,Pe)},onMousemove:function(je){return f.onOptionMouseMove(je,f.getOptionIndex(we,Ne))},onClick:e[8]||(e[8]=Id(function(){},["stop"])),"data-p-selected":!t.checkmark&&f.isSelected(Pe),"data-p-focused":d.focusedOptionIndex===f.getOptionIndex(we,Ne),"data-p-disabled":f.isOptionDisabled(Pe)},{ref_for:!0},f.getPTItemOptions(Pe,Ne,we,"option")),[t.checkmark?(Me(),ft(Tr,{key:0},[f.isSelected(Pe)?(Me(),rn($,ot({key:0,class:t.cx("optionCheckIcon")},{ref_for:!0},t.ptm("optionCheckIcon")),null,16,["class"])):(Me(),rn(V,ot({key:1,class:t.cx("optionBlankIcon")},{ref_for:!0},t.ptm("optionBlankIcon")),null,16,["class"]))],64)):Pn("",!0),ir(t.$slots,"option",{option:Pe,selected:f.isSelected(Pe),index:f.getOptionIndex(we,Ne)},function(){return[Ze("span",ot({class:t.cx("optionLabel")},{ref_for:!0},t.ptm("optionLabel")),Fr(f.getOptionLabel(Pe)),17)]})],16,Mie)),[[de]])],64)}),128)),d.filterValue&&(!Ye||Ye&&Ye.length===0)?(Me(),ft("li",ot({key:0,class:t.cx("emptyMessage"),role:"option"},t.ptm("emptyMessage"),{"data-p-hidden-accessible":!0}),[ir(t.$slots,"emptyfilter",{},function(){return[Ra(Fr(f.emptyFilterMessageText),1)]})],16)):!t.options||t.options&&t.options.length===0?(Me(),ft("li",ot({key:1,class:t.cx("emptyMessage"),role:"option"},t.ptm("emptyMessage"),{"data-p-hidden-accessible":!0}),[ir(t.$slots,"empty",{},function(){return[Ra(Fr(f.emptyMessageText),1)]})],16)):Pn("",!0)],16,kie)]}),_:2},[t.$slots.loader?{name:"loader",fn:zr(function(Te){var Be=Te.options;return[ir(t.$slots,"loader",{options:Be})]}),key:"0"}:void 0]),1040,["items","style","disabled","pt"])],16),ir(t.$slots,"footer",{value:t.d_value,options:f.visibleOptions}),!t.options||t.options&&t.options.length===0?(Me(),ft("span",ot({key:1,role:"status","aria-live":"polite",class:"p-hidden-accessible"},t.ptm("hiddenEmptyMessage"),{"data-p-hidden-accessible":!0}),Fr(f.emptyMessageText),17)):Pn("",!0),Ze("span",ot({role:"status","aria-live":"polite",class:"p-hidden-accessible"},t.ptm("hiddenSelectedMessage"),{"data-p-hidden-accessible":!0}),Fr(f.selectedMessageText),17),Ze("span",ot({ref:"lastHiddenFocusableElementOnOverlay",role:"presentation","aria-hidden":"true",class:"p-hidden-accessible p-hidden-focusable",tabindex:0,onFocus:e[9]||(e[9]=function(){return f.onLastHiddenFocus&&f.onLastHiddenFocus.apply(f,arguments)})},t.ptm("hiddenLastFocusableEl"),{"data-p-hidden-accessible":!0,"data-p-hidden-focusable":!0}),null,16)],16,Rie)):Pn("",!0)]}),_:3},16,["onEnter","onAfterEnter","onLeave","onAfterLeave"])]}),_:3},8,["appendTo"])],16,Iie)}VT.render=Die;var xN={name:"AngleDownIcon",extends:go};function Lie(t){return Nie(t)||Bie(t)||Fie(t)||zie()}function zie(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Fie(t,e){if(t){if(typeof t=="string")return K2(t,e);var n={}.toString.call(t).slice(8,-1);return n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set"?Array.from(t):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?K2(t,e):void 0}}function Bie(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function Nie(t){if(Array.isArray(t))return K2(t)}function K2(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,l=Array(e);n<e;n++)l[n]=t[n];return l}function Vie(t,e,n,l,d,f){return Me(),ft("svg",ot({width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},t.pti()),Lie(e[0]||(e[0]=[Ze("path",{d:"M3.58659 4.5007C3.68513 4.50023 3.78277 4.51945 3.87379 4.55723C3.9648 4.59501 4.04735 4.65058 4.11659 4.7207L7.11659 7.7207L10.1166 4.7207C10.2619 4.65055 10.4259 4.62911 10.5843 4.65956C10.7427 4.69002 10.8871 4.77074 10.996 4.88976C11.1049 5.00877 11.1726 5.15973 11.1889 5.32022C11.2052 5.48072 11.1693 5.6422 11.0866 5.7807L7.58659 9.2807C7.44597 9.42115 7.25534 9.50004 7.05659 9.50004C6.85784 9.50004 6.66722 9.42115 6.52659 9.2807L3.02659 5.7807C2.88614 5.64007 2.80725 5.44945 2.80725 5.2507C2.80725 5.05195 2.88614 4.86132 3.02659 4.7207C3.09932 4.64685 3.18675 4.58911 3.28322 4.55121C3.37969 4.51331 3.48305 4.4961 3.58659 4.5007Z",fill:"currentColor"},null,-1)])),16)}xN.render=Vie;var wN={name:"AngleUpIcon",extends:go};function $ie(t){return Hie(t)||Gie(t)||jie(t)||Uie()}function Uie(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function jie(t,e){if(t){if(typeof t=="string")return Z2(t,e);var n={}.toString.call(t).slice(8,-1);return n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set"?Array.from(t):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Z2(t,e):void 0}}function Gie(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function Hie(t){if(Array.isArray(t))return Z2(t)}function Z2(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,l=Array(e);n<e;n++)l[n]=t[n];return l}function Wie(t,e,n,l,d,f){return Me(),ft("svg",ot({width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},t.pti()),$ie(e[0]||(e[0]=[Ze("path",{d:"M10.4134 9.49931C10.3148 9.49977 10.2172 9.48055 10.1262 9.44278C10.0352 9.405 9.95263 9.34942 9.88338 9.27931L6.88338 6.27931L3.88338 9.27931C3.73811 9.34946 3.57409 9.3709 3.41567 9.34044C3.25724 9.30999 3.11286 9.22926 3.00395 9.11025C2.89504 8.99124 2.82741 8.84028 2.8111 8.67978C2.79478 8.51928 2.83065 8.35781 2.91338 8.21931L6.41338 4.71931C6.55401 4.57886 6.74463 4.49997 6.94338 4.49997C7.14213 4.49997 7.33276 4.57886 7.47338 4.71931L10.9734 8.21931C11.1138 8.35994 11.1927 8.55056 11.1927 8.74931C11.1927 8.94806 11.1138 9.13868 10.9734 9.27931C10.9007 9.35315 10.8132 9.41089 10.7168 9.44879C10.6203 9.48669 10.5169 9.5039 10.4134 9.49931Z",fill:"currentColor"},null,-1)])),16)}wN.render=Wie;var qie=`
    .p-inputnumber {
        display: inline-flex;
        position: relative;
    }

    .p-inputnumber-button {
        display: flex;
        align-items: center;
        justify-content: center;
        flex: 0 0 auto;
        cursor: pointer;
        background: dt('inputnumber.button.background');
        color: dt('inputnumber.button.color');
        width: dt('inputnumber.button.width');
        transition:
            background dt('inputnumber.transition.duration'),
            color dt('inputnumber.transition.duration'),
            border-color dt('inputnumber.transition.duration'),
            outline-color dt('inputnumber.transition.duration');
    }

    .p-inputnumber-button:disabled {
        cursor: auto;
    }

    .p-inputnumber-button:not(:disabled):hover {
        background: dt('inputnumber.button.hover.background');
        color: dt('inputnumber.button.hover.color');
    }

    .p-inputnumber-button:not(:disabled):active {
        background: dt('inputnumber.button.active.background');
        color: dt('inputnumber.button.active.color');
    }

    .p-inputnumber-stacked .p-inputnumber-button {
        position: relative;
        flex: 1 1 auto;
        border: 0 none;
    }

    .p-inputnumber-stacked .p-inputnumber-button-group {
        display: flex;
        flex-direction: column;
        position: absolute;
        inset-block-start: 1px;
        inset-inline-end: 1px;
        height: calc(100% - 2px);
        z-index: 1;
    }

    .p-inputnumber-stacked .p-inputnumber-increment-button {
        padding: 0;
        border-start-end-radius: calc(dt('inputnumber.button.border.radius') - 1px);
    }

    .p-inputnumber-stacked .p-inputnumber-decrement-button {
        padding: 0;
        border-end-end-radius: calc(dt('inputnumber.button.border.radius') - 1px);
    }

    .p-inputnumber-stacked .p-inputnumber-input {
        padding-inline-end: calc(dt('inputnumber.button.width') + dt('form.field.padding.x'));
    }

    .p-inputnumber-horizontal .p-inputnumber-button {
        border: 1px solid dt('inputnumber.button.border.color');
    }

    .p-inputnumber-horizontal .p-inputnumber-button:hover {
        border-color: dt('inputnumber.button.hover.border.color');
    }

    .p-inputnumber-horizontal .p-inputnumber-button:active {
        border-color: dt('inputnumber.button.active.border.color');
    }

    .p-inputnumber-horizontal .p-inputnumber-increment-button {
        order: 3;
        border-start-end-radius: dt('inputnumber.button.border.radius');
        border-end-end-radius: dt('inputnumber.button.border.radius');
        border-inline-start: 0 none;
    }

    .p-inputnumber-horizontal .p-inputnumber-input {
        order: 2;
        border-radius: 0;
    }

    .p-inputnumber-horizontal .p-inputnumber-decrement-button {
        order: 1;
        border-start-start-radius: dt('inputnumber.button.border.radius');
        border-end-start-radius: dt('inputnumber.button.border.radius');
        border-inline-end: 0 none;
    }

    .p-floatlabel:has(.p-inputnumber-horizontal) label {
        margin-inline-start: dt('inputnumber.button.width');
    }

    .p-inputnumber-vertical {
        flex-direction: column;
    }

    .p-inputnumber-vertical .p-inputnumber-button {
        border: 1px solid dt('inputnumber.button.border.color');
        padding: dt('inputnumber.button.vertical.padding');
    }

    .p-inputnumber-vertical .p-inputnumber-button:hover {
        border-color: dt('inputnumber.button.hover.border.color');
    }

    .p-inputnumber-vertical .p-inputnumber-button:active {
        border-color: dt('inputnumber.button.active.border.color');
    }

    .p-inputnumber-vertical .p-inputnumber-increment-button {
        order: 1;
        border-start-start-radius: dt('inputnumber.button.border.radius');
        border-start-end-radius: dt('inputnumber.button.border.radius');
        width: 100%;
        border-block-end: 0 none;
    }

    .p-inputnumber-vertical .p-inputnumber-input {
        order: 2;
        border-radius: 0;
        text-align: center;
    }

    .p-inputnumber-vertical .p-inputnumber-decrement-button {
        order: 3;
        border-end-start-radius: dt('inputnumber.button.border.radius');
        border-end-end-radius: dt('inputnumber.button.border.radius');
        width: 100%;
        border-block-start: 0 none;
    }

    .p-inputnumber-input {
        flex: 1 1 auto;
    }

    .p-inputnumber-fluid {
        width: 100%;
    }

    .p-inputnumber-fluid .p-inputnumber-input {
        width: 1%;
    }

    .p-inputnumber-fluid.p-inputnumber-vertical .p-inputnumber-input {
        width: 100%;
    }

    .p-inputnumber:has(.p-inputtext-sm) .p-inputnumber-button .p-icon {
        font-size: dt('form.field.sm.font.size');
        width: dt('form.field.sm.font.size');
        height: dt('form.field.sm.font.size');
    }

    .p-inputnumber:has(.p-inputtext-lg) .p-inputnumber-button .p-icon {
        font-size: dt('form.field.lg.font.size');
        width: dt('form.field.lg.font.size');
        height: dt('form.field.lg.font.size');
    }

    .p-inputnumber-clear-icon {
        position: absolute;
        top: 50%;
        margin-top: -0.5rem;
        cursor: pointer;
        inset-inline-end: dt('form.field.padding.x');
        color: dt('form.field.icon.color');
    }

    .p-inputnumber:has(.p-inputnumber-clear-icon) .p-inputnumber-input {
        padding-inline-end: calc((dt('form.field.padding.x') * 2) + dt('icon.size'));
    }

    .p-inputnumber-stacked .p-inputnumber-clear-icon {
        inset-inline-end: calc(dt('inputnumber.button.width') + dt('form.field.padding.x'));
    }

    .p-inputnumber-stacked:has(.p-inputnumber-clear-icon) .p-inputnumber-input {
        padding-inline-end: calc(dt('inputnumber.button.width') + (dt('form.field.padding.x') * 2) + dt('icon.size'));
    }

    .p-inputnumber-horizontal .p-inputnumber-clear-icon {
        inset-inline-end: calc(dt('inputnumber.button.width') + dt('form.field.padding.x'));
    }
`,Kie={root:function(e){var n=e.instance,l=e.props;return["p-inputnumber p-component p-inputwrapper",{"p-invalid":n.$invalid,"p-inputwrapper-filled":n.$filled||l.allowEmpty===!1,"p-inputwrapper-focus":n.focused,"p-inputnumber-stacked":l.showButtons&&l.buttonLayout==="stacked","p-inputnumber-horizontal":l.showButtons&&l.buttonLayout==="horizontal","p-inputnumber-vertical":l.showButtons&&l.buttonLayout==="vertical","p-inputnumber-fluid":n.$fluid}]},pcInputText:"p-inputnumber-input",clearIcon:"p-inputnumber-clear-icon",buttonGroup:"p-inputnumber-button-group",incrementButton:function(e){var n=e.instance,l=e.props;return["p-inputnumber-button p-inputnumber-increment-button",{"p-disabled":l.showButtons&&l.max!==null&&n.maxBoundry()}]},decrementButton:function(e){var n=e.instance,l=e.props;return["p-inputnumber-button p-inputnumber-decrement-button",{"p-disabled":l.showButtons&&l.min!==null&&n.minBoundry()}]}},Zie=xi.extend({name:"inputnumber",style:qie,classes:Kie}),Xie={name:"BaseInputNumber",extends:ub,props:{format:{type:Boolean,default:!0},showButtons:{type:Boolean,default:!1},buttonLayout:{type:String,default:"stacked"},incrementButtonClass:{type:String,default:null},decrementButtonClass:{type:String,default:null},incrementButtonIcon:{type:String,default:void 0},incrementIcon:{type:String,default:void 0},decrementButtonIcon:{type:String,default:void 0},decrementIcon:{type:String,default:void 0},locale:{type:String,default:void 0},localeMatcher:{type:String,default:void 0},mode:{type:String,default:"decimal"},prefix:{type:String,default:null},suffix:{type:String,default:null},currency:{type:String,default:void 0},currencyDisplay:{type:String,default:void 0},useGrouping:{type:Boolean,default:!0},minFractionDigits:{type:Number,default:void 0},maxFractionDigits:{type:Number,default:void 0},roundingMode:{type:String,default:"halfExpand",validator:function(e){return["ceil","floor","expand","trunc","halfCeil","halfFloor","halfExpand","halfTrunc","halfEven"].includes(e)}},min:{type:Number,default:null},max:{type:Number,default:null},step:{type:Number,default:1},allowEmpty:{type:Boolean,default:!0},highlightOnFocus:{type:Boolean,default:!1},showClear:{type:Boolean,default:!1},readonly:{type:Boolean,default:!1},placeholder:{type:String,default:null},inputId:{type:String,default:null},inputClass:{type:[String,Object],default:null},inputStyle:{type:Object,default:null},ariaLabelledby:{type:String,default:null},ariaLabel:{type:String,default:null},required:{type:Boolean,default:!1}},style:Zie,provide:function(){return{$pcInputNumber:this,$parentInstance:this}}};function w0(t){"@babel/helpers - typeof";return w0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},w0(t)}function YL(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);e&&(l=l.filter(function(d){return Object.getOwnPropertyDescriptor(t,d).enumerable})),n.push.apply(n,l)}return n}function JL(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?YL(Object(n),!0).forEach(function(l){X2(t,l,n[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):YL(Object(n)).forEach(function(l){Object.defineProperty(t,l,Object.getOwnPropertyDescriptor(n,l))})}return t}function X2(t,e,n){return(e=Yie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Yie(t){var e=Jie(t,"string");return w0(e)=="symbol"?e:e+""}function Jie(t,e){if(w0(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var l=n.call(t,e);if(w0(l)!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Qie(t){return roe(t)||noe(t)||toe(t)||eoe()}function eoe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function toe(t,e){if(t){if(typeof t=="string")return Y2(t,e);var n={}.toString.call(t).slice(8,-1);return n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set"?Array.from(t):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Y2(t,e):void 0}}function noe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function roe(t){if(Array.isArray(t))return Y2(t)}function Y2(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,l=Array(e);n<e;n++)l[n]=t[n];return l}var TN={name:"InputNumber",extends:Xie,inheritAttrs:!1,emits:["input","focus","blur"],inject:{$pcFluid:{default:null}},numberFormat:null,_numeral:null,_decimal:null,_group:null,_minusSign:null,_currency:null,_suffix:null,_prefix:null,_index:null,groupChar:"",isSpecialChar:null,prefixChar:null,suffixChar:null,timer:null,data:function(){return{d_modelValue:this.d_value,focused:!1}},watch:{d_value:{immediate:!0,handler:function(e){var n;this.d_modelValue=e,(n=this.$refs.clearIcon)!==null&&n!==void 0&&(n=n.$el)!==null&&n!==void 0&&n.style&&(this.$refs.clearIcon.$el.style.display=Wa(e)?"none":"block")}},locale:function(e,n){this.updateConstructParser(e,n)},localeMatcher:function(e,n){this.updateConstructParser(e,n)},mode:function(e,n){this.updateConstructParser(e,n)},currency:function(e,n){this.updateConstructParser(e,n)},currencyDisplay:function(e,n){this.updateConstructParser(e,n)},useGrouping:function(e,n){this.updateConstructParser(e,n)},minFractionDigits:function(e,n){this.updateConstructParser(e,n)},maxFractionDigits:function(e,n){this.updateConstructParser(e,n)},suffix:function(e,n){this.updateConstructParser(e,n)},prefix:function(e,n){this.updateConstructParser(e,n)}},created:function(){this.constructParser()},mounted:function(){var e;(e=this.$refs.clearIcon)!==null&&e!==void 0&&(e=e.$el)!==null&&e!==void 0&&e.style&&(this.$refs.clearIcon.$el.style.display=this.$filled?"block":"none")},methods:{getOptions:function(){return{localeMatcher:this.localeMatcher,style:this.mode,currency:this.currency,currencyDisplay:this.currencyDisplay,useGrouping:this.useGrouping,minimumFractionDigits:this.minFractionDigits,maximumFractionDigits:this.maxFractionDigits,roundingMode:this.roundingMode}},constructParser:function(){this.numberFormat=new Intl.NumberFormat(this.locale,this.getOptions());var e=Qie(new Intl.NumberFormat(this.locale,{useGrouping:!1}).format(9876543210)).reverse(),n=new Map(e.map(function(l,d){return[l,d]}));this._numeral=new RegExp("[".concat(e.join(""),"]"),"g"),this._group=this.getGroupingExpression(),this._minusSign=this.getMinusSignExpression(),this._currency=this.getCurrencyExpression(),this._decimal=this.getDecimalExpression(),this._suffix=this.getSuffixExpression(),this._prefix=this.getPrefixExpression(),this._index=function(l){return n.get(l)}},updateConstructParser:function(e,n){e!==n&&this.constructParser()},escapeRegExp:function(e){return e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")},getDecimalExpression:function(){var e=new Intl.NumberFormat(this.locale,JL(JL({},this.getOptions()),{},{useGrouping:!1}));return new RegExp("[".concat(e.format(1.1).replace(this._currency,"").trim().replace(this._numeral,""),"]"),"g")},getGroupingExpression:function(){var e=new Intl.NumberFormat(this.locale,{useGrouping:!0});return this.groupChar=e.format(1e6).trim().replace(this._numeral,"").charAt(0),new RegExp("[".concat(this.groupChar,"]"),"g")},getMinusSignExpression:function(){var e=new Intl.NumberFormat(this.locale,{useGrouping:!1});return new RegExp("[".concat(e.format(-1).trim().replace(this._numeral,""),"]"),"g")},getCurrencyExpression:function(){if(this.currency){var e=new Intl.NumberFormat(this.locale,{style:"currency",currency:this.currency,currencyDisplay:this.currencyDisplay,minimumFractionDigits:0,maximumFractionDigits:0,roundingMode:this.roundingMode});return new RegExp("[".concat(e.format(1).replace(/\s/g,"").replace(this._numeral,"").replace(this._group,""),"]"),"g")}return new RegExp("[]","g")},getPrefixExpression:function(){if(this.prefix)this.prefixChar=this.prefix;else{var e=new Intl.NumberFormat(this.locale,{style:this.mode,currency:this.currency,currencyDisplay:this.currencyDisplay});this.prefixChar=e.format(1).split("1")[0]}return new RegExp("".concat(this.escapeRegExp(this.prefixChar||"")),"g")},getSuffixExpression:function(){if(this.suffix)this.suffixChar=this.suffix;else{var e=new Intl.NumberFormat(this.locale,{style:this.mode,currency:this.currency,currencyDisplay:this.currencyDisplay,minimumFractionDigits:0,maximumFractionDigits:0,roundingMode:this.roundingMode});this.suffixChar=e.format(1).split("1")[1]}return new RegExp("".concat(this.escapeRegExp(this.suffixChar||"")),"g")},formatValue:function(e){if(e!=null){if(e==="-")return e;if(this.format){var n=new Intl.NumberFormat(this.locale,this.getOptions()),l=n.format(e);return this.prefix&&(l=this.prefix+l),this.suffix&&(l=l+this.suffix),l}return e.toString()}return""},parseValue:function(e){var n=e.replace(this._suffix,"").replace(this._prefix,"").trim().replace(/\s/g,"").replace(this._currency,"").replace(this._group,"").replace(this._minusSign,"-").replace(this._decimal,".").replace(this._numeral,this._index);if(n){if(n==="-")return n;var l=+n;return isNaN(l)?null:l}return null},repeat:function(e,n,l){var d=this;if(!this.readonly){var f=n||500;this.clearTimer(),this.timer=setTimeout(function(){d.repeat(e,40,l)},f),this.spin(e,l)}},addWithPrecision:function(e,n){var l=e.toString(),d=n.toString(),f=l.includes(".")?l.split(".")[1].length:0,x=d.includes(".")?d.split(".")[1].length:0,s=Math.max(f,x),C=Math.pow(10,s);return Math.round((e+n)*C)/C},spin:function(e,n){if(this.$refs.input){var l=this.step*n,d=this.parseValue(this.$refs.input.$el.value)||0,f=this.validateValue(this.addWithPrecision(d,l));this.updateInput(f,null,"spin"),this.updateModel(e,f),this.handleOnInput(e,d,f)}},onUpButtonMouseDown:function(e){this.disabled||(this.$refs.input.$el.focus(),this.repeat(e,null,1),e.preventDefault())},onUpButtonMouseUp:function(){this.disabled||this.clearTimer()},onUpButtonMouseLeave:function(){this.disabled||this.clearTimer()},onUpButtonKeyUp:function(){this.disabled||this.clearTimer()},onUpButtonKeyDown:function(e){(e.code==="Space"||e.code==="Enter"||e.code==="NumpadEnter")&&this.repeat(e,null,1)},onDownButtonMouseDown:function(e){this.disabled||(this.$refs.input.$el.focus(),this.repeat(e,null,-1),e.preventDefault())},onDownButtonMouseUp:function(){this.disabled||this.clearTimer()},onDownButtonMouseLeave:function(){this.disabled||this.clearTimer()},onDownButtonKeyUp:function(){this.disabled||this.clearTimer()},onDownButtonKeyDown:function(e){(e.code==="Space"||e.code==="Enter"||e.code==="NumpadEnter")&&this.repeat(e,null,-1)},onUserInput:function(){this.isSpecialChar&&(this.$refs.input.$el.value=this.lastValue),this.isSpecialChar=!1},onInputKeyDown:function(e){if(!this.readonly&&!e.isComposing){if(e.altKey||e.ctrlKey||e.metaKey){this.isSpecialChar=!0,this.lastValue=this.$refs.input.$el.value;return}this.lastValue=e.target.value;var n=e.target.selectionStart,l=e.target.selectionEnd,d=l-n,f=e.target.value,x=null,s=e.code||e.key;switch(s){case"ArrowUp":this.spin(e,1),e.preventDefault();break;case"ArrowDown":this.spin(e,-1),e.preventDefault();break;case"ArrowLeft":if(d>1){var C=this.isNumeralChar(f.charAt(n))?n+1:n+2;this.$refs.input.$el.setSelectionRange(C,C)}else this.isNumeralChar(f.charAt(n-1))||e.preventDefault();break;case"ArrowRight":if(d>1){var P=l-1;this.$refs.input.$el.setSelectionRange(P,P)}else this.isNumeralChar(f.charAt(n))||e.preventDefault();break;case"Tab":case"Enter":case"NumpadEnter":x=this.validateValue(this.parseValue(f)),this.$refs.input.$el.value=this.formatValue(x),this.$refs.input.$el.setAttribute("aria-valuenow",x),this.updateModel(e,x);break;case"Backspace":{if(e.preventDefault(),n===l){n>=f.length&&this.suffixChar!==null&&(n=f.length-this.suffixChar.length,this.$refs.input.$el.setSelectionRange(n,n));var L=f.charAt(n-1),$=this.getDecimalCharIndexes(f),V=$.decimalCharIndex,j=$.decimalCharIndexWithoutPrefix;if(this.isNumeralChar(L)){var ue=this.getDecimalLength(f);if(this._group.test(L))this._group.lastIndex=0,x=f.slice(0,n-2)+f.slice(n-1);else if(this._decimal.test(L))this._decimal.lastIndex=0,ue?this.$refs.input.$el.setSelectionRange(n-1,n-1):x=f.slice(0,n-1)+f.slice(n);else if(V>0&&n>V){var de=this.isDecimalMode()&&(this.minFractionDigits||0)<ue?"":"0";x=f.slice(0,n-1)+de+f.slice(n)}else j===1?(x=f.slice(0,n-1)+"0"+f.slice(n),x=this.parseValue(x)>0?x:""):x=f.slice(0,n-1)+f.slice(n)}this.updateValue(e,x,null,"delete-single")}else x=this.deleteRange(f,n,l),this.updateValue(e,x,null,"delete-range");break}case"Delete":if(e.preventDefault(),n===l){var Te=f.charAt(n),Be=this.getDecimalCharIndexes(f),Ge=Be.decimalCharIndex,Ye=Be.decimalCharIndexWithoutPrefix;if(this.isNumeralChar(Te)){var Ne=this.getDecimalLength(f);if(this._group.test(Te))this._group.lastIndex=0,x=f.slice(0,n)+f.slice(n+2);else if(this._decimal.test(Te))this._decimal.lastIndex=0,Ne?this.$refs.input.$el.setSelectionRange(n+1,n+1):x=f.slice(0,n)+f.slice(n+1);else if(Ge>0&&n>Ge){var Mt=this.isDecimalMode()&&(this.minFractionDigits||0)<Ne?"":"0";x=f.slice(0,n)+Mt+f.slice(n+1)}else Ye===1?(x=f.slice(0,n)+"0"+f.slice(n+1),x=this.parseValue(x)>0?x:""):x=f.slice(0,n)+f.slice(n+1)}this.updateValue(e,x,null,"delete-back-single")}else x=this.deleteRange(f,n,l),this.updateValue(e,x,null,"delete-range");break;case"Home":e.preventDefault(),si(this.min)&&this.updateModel(e,this.min);break;case"End":e.preventDefault(),si(this.max)&&this.updateModel(e,this.max);break}}},onInputKeyPress:function(e){if(!this.readonly){var n=e.key,l=this.isDecimalSign(n),d=this.isMinusSign(n);e.code!=="Enter"&&e.preventDefault(),(Number(n)>=0&&Number(n)<=9||d||l)&&this.insert(e,n,{isDecimalSign:l,isMinusSign:d})}},onPaste:function(e){if(!this.readonly){e.preventDefault();var n=(e.clipboardData||window.clipboardData).getData("Text");if(!(this.inputId==="integeronly"&&/[^\d-]/.test(n))&&n){var l=this.parseValue(n);l!=null&&this.insert(e,l.toString())}}},onClearClick:function(e){this.updateModel(e,null),this.$refs.input.$el.focus()},allowMinusSign:function(){return this.min===null||this.min<0},isMinusSign:function(e){return this._minusSign.test(e)||e==="-"?(this._minusSign.lastIndex=0,!0):!1},isDecimalSign:function(e){var n;return(n=this.locale)!==null&&n!==void 0&&n.includes("fr")&&[".",","].includes(e)||this._decimal.test(e)?(this._decimal.lastIndex=0,!0):!1},isDecimalMode:function(){return this.mode==="decimal"},getDecimalCharIndexes:function(e){var n=e.search(this._decimal);this._decimal.lastIndex=0;var l=e.replace(this._prefix,"").trim().replace(/\s/g,"").replace(this._currency,""),d=l.search(this._decimal);return this._decimal.lastIndex=0,{decimalCharIndex:n,decimalCharIndexWithoutPrefix:d}},getCharIndexes:function(e){var n=e.search(this._decimal);this._decimal.lastIndex=0;var l=e.search(this._minusSign);this._minusSign.lastIndex=0;var d=e.search(this._suffix);this._suffix.lastIndex=0;var f=e.search(this._currency);return this._currency.lastIndex=0,{decimalCharIndex:n,minusCharIndex:l,suffixCharIndex:d,currencyCharIndex:f}},insert:function(e,n){var l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{isDecimalSign:!1,isMinusSign:!1},d=n.search(this._minusSign);if(this._minusSign.lastIndex=0,!(!this.allowMinusSign()&&d!==-1)){var f=this.$refs.input.$el.selectionStart,x=this.$refs.input.$el.selectionEnd,s=this.$refs.input.$el.value.trim(),C=this.getCharIndexes(s),P=C.decimalCharIndex,L=C.minusCharIndex,$=C.suffixCharIndex,V=C.currencyCharIndex,j;if(l.isMinusSign){var ue=L===-1;(f===0||f===V+1)&&(j=s,(ue||x!==0)&&(j=this.insertText(s,n,0,x)),this.updateValue(e,j,n,"insert"))}else if(l.isDecimalSign)P>0&&f===P?this.updateValue(e,s,n,"insert"):P>f&&P<x?(j=this.insertText(s,n,f,x),this.updateValue(e,j,n,"insert")):P===-1&&this.maxFractionDigits&&(j=this.insertText(s,n,f,x),this.updateValue(e,j,n,"insert"));else{var de=this.numberFormat.resolvedOptions().maximumFractionDigits,Te=f!==x?"range-insert":"insert";if(P>0&&f>P){if(f+n.length-(P+1)<=de){var Be=V>=f?V-1:$>=f?$:s.length;j=s.slice(0,f)+n+s.slice(f+n.length,Be)+s.slice(Be),this.updateValue(e,j,n,Te)}}else j=this.insertText(s,n,f,x),this.updateValue(e,j,n,Te)}}},insertText:function(e,n,l,d){var f=n==="."?n:n.split(".");if(f.length===2){var x=e.slice(l,d).search(this._decimal);return this._decimal.lastIndex=0,x>0?e.slice(0,l)+this.formatValue(n)+e.slice(d):this.formatValue(n)||e}else return d-l===e.length?this.formatValue(n):l===0?n+e.slice(d):d===e.length?e.slice(0,l)+n:e.slice(0,l)+n+e.slice(d)},deleteRange:function(e,n,l){var d;return l-n===e.length?d="":n===0?d=e.slice(l):l===e.length?d=e.slice(0,n):d=e.slice(0,n)+e.slice(l),d},initCursor:function(){var e=this.$refs.input.$el.selectionStart,n=this.$refs.input.$el.value,l=n.length,d=null,f=(this.prefixChar||"").length;n=n.replace(this._prefix,""),e=e-f;var x=n.charAt(e);if(this.isNumeralChar(x))return e+f;for(var s=e-1;s>=0;)if(x=n.charAt(s),this.isNumeralChar(x)){d=s+f;break}else s--;if(d!==null)this.$refs.input.$el.setSelectionRange(d+1,d+1);else{for(s=e;s<l;)if(x=n.charAt(s),this.isNumeralChar(x)){d=s+f;break}else s++;d!==null&&this.$refs.input.$el.setSelectionRange(d,d)}return d||0},onInputClick:function(){var e=this.$refs.input.$el.value;!this.readonly&&e!==wL()&&this.initCursor()},isNumeralChar:function(e){return e.length===1&&(this._numeral.test(e)||this._decimal.test(e)||this._group.test(e)||this._minusSign.test(e))?(this.resetRegex(),!0):!1},resetRegex:function(){this._numeral.lastIndex=0,this._decimal.lastIndex=0,this._group.lastIndex=0,this._minusSign.lastIndex=0},updateValue:function(e,n,l,d){var f=this.$refs.input.$el.value,x=null;n!=null&&(x=this.parseValue(n),x=!x&&!this.allowEmpty?0:x,this.updateInput(x,l,d,n),this.handleOnInput(e,f,x))},handleOnInput:function(e,n,l){if(this.isValueChanged(n,l)){var d,f;this.$emit("input",{originalEvent:e,value:l,formattedValue:n}),(d=(f=this.formField).onInput)===null||d===void 0||d.call(f,{originalEvent:e,value:l})}},isValueChanged:function(e,n){if(n===null&&e!==null)return!0;if(n!=null){var l=typeof e=="string"?this.parseValue(e):e;return n!==l}return!1},validateValue:function(e){return e==="-"||e==null?null:this.min!=null&&e<this.min?this.min:this.max!=null&&e>this.max?this.max:e},updateInput:function(e,n,l,d){var f;n=n||"";var x=this.$refs.input.$el.value,s=this.formatValue(e),C=x.length;if(s!==d&&(s=this.concatValues(s,d)),C===0){this.$refs.input.$el.value=s,this.$refs.input.$el.setSelectionRange(0,0);var P=this.initCursor(),L=P+n.length;this.$refs.input.$el.setSelectionRange(L,L)}else{var $=this.$refs.input.$el.selectionStart,V=this.$refs.input.$el.selectionEnd;this.$refs.input.$el.value=s;var j=s.length;if(l==="range-insert"){var ue=this.parseValue((x||"").slice(0,$)),de=ue!==null?ue.toString():"",Te=de.split("").join("(".concat(this.groupChar,")?")),Be=new RegExp(Te,"g");Be.test(s);var Ge=n.split("").join("(".concat(this.groupChar,")?")),Ye=new RegExp(Ge,"g");Ye.test(s.slice(Be.lastIndex)),V=Be.lastIndex+Ye.lastIndex,this.$refs.input.$el.setSelectionRange(V,V)}else if(j===C)l==="insert"||l==="delete-back-single"?this.$refs.input.$el.setSelectionRange(V+1,V+1):l==="delete-single"?this.$refs.input.$el.setSelectionRange(V-1,V-1):(l==="delete-range"||l==="spin")&&this.$refs.input.$el.setSelectionRange(V,V);else if(l==="delete-back-single"){var Ne=x.charAt(V-1),Mt=x.charAt(V),kt=C-j,Pe=this._group.test(Mt);Pe&&kt===1?V+=1:!Pe&&this.isNumeralChar(Ne)&&(V+=-1*kt+1),this._group.lastIndex=0,this.$refs.input.$el.setSelectionRange(V,V)}else if(x==="-"&&l==="insert"){this.$refs.input.$el.setSelectionRange(0,0);var we=this.initCursor(),Se=we+n.length+1;this.$refs.input.$el.setSelectionRange(Se,Se)}else V=V+(j-C),this.$refs.input.$el.setSelectionRange(V,V)}this.$refs.input.$el.setAttribute("aria-valuenow",e),(f=this.$refs.clearIcon)!==null&&f!==void 0&&(f=f.$el)!==null&&f!==void 0&&f.style&&(this.$refs.clearIcon.$el.style.display=Wa(s)?"none":"block")},concatValues:function(e,n){if(e&&n){var l=n.search(this._decimal);return this._decimal.lastIndex=0,this.suffixChar?l!==-1?e.replace(this.suffixChar,"").split(this._decimal)[0]+n.replace(this.suffixChar,"").slice(l)+this.suffixChar:e:l!==-1?e.split(this._decimal)[0]+n.slice(l):e}return e},getDecimalLength:function(e){if(e){var n=e.split(this._decimal);if(n.length===2)return n[1].replace(this._suffix,"").trim().replace(/\s/g,"").replace(this._currency,"").length}return 0},updateModel:function(e,n){this.writeValue(n,e)},onInputFocus:function(e){this.focused=!0,!this.disabled&&!this.readonly&&this.$refs.input.$el.value!==wL()&&this.highlightOnFocus&&e.target.select(),this.$emit("focus",e)},onInputBlur:function(e){var n,l;this.focused=!1;var d=e.target,f=this.validateValue(this.parseValue(d.value));this.$emit("blur",{originalEvent:e,value:d.value}),(n=(l=this.formField).onBlur)===null||n===void 0||n.call(l,e),d.value=this.formatValue(f),d.setAttribute("aria-valuenow",f),this.updateModel(e,f),!this.disabled&&!this.readonly&&this.highlightOnFocus&&Kx()},clearTimer:function(){this.timer&&clearTimeout(this.timer)},maxBoundry:function(){return this.d_value>=this.max},minBoundry:function(){return this.d_value<=this.min}},computed:{upButtonListeners:function(){var e=this;return{mousedown:function(l){return e.onUpButtonMouseDown(l)},mouseup:function(l){return e.onUpButtonMouseUp(l)},mouseleave:function(l){return e.onUpButtonMouseLeave(l)},keydown:function(l){return e.onUpButtonKeyDown(l)},keyup:function(l){return e.onUpButtonKeyUp(l)}}},downButtonListeners:function(){var e=this;return{mousedown:function(l){return e.onDownButtonMouseDown(l)},mouseup:function(l){return e.onDownButtonMouseUp(l)},mouseleave:function(l){return e.onDownButtonMouseLeave(l)},keydown:function(l){return e.onDownButtonKeyDown(l)},keyup:function(l){return e.onDownButtonKeyUp(l)}}},formattedValue:function(){var e=!this.d_value&&!this.allowEmpty?0:this.d_value;return this.formatValue(e)},getFormatter:function(){return this.numberFormat},dataP:function(){return Rs(X2(X2({invalid:this.$invalid,fluid:this.$fluid,filled:this.$variant==="filled"},this.size,this.size),this.buttonLayout,this.showButtons&&this.buttonLayout))}},components:{InputText:rP,AngleUpIcon:wN,AngleDownIcon:xN,TimesIcon:NT}},ioe=["data-p"],ooe=["data-p"],soe=["disabled","data-p"],aoe=["disabled","data-p"],loe=["disabled","data-p"],coe=["disabled","data-p"];function uoe(t,e,n,l,d,f){var x=_r("InputText"),s=_r("TimesIcon");return Me(),ft("span",ot({class:t.cx("root")},t.ptmi("root"),{"data-p":f.dataP}),[pr(x,{ref:"input",id:t.inputId,name:t.$formName,role:"spinbutton",class:wr([t.cx("pcInputText"),t.inputClass]),style:$0(t.inputStyle),defaultValue:f.formattedValue,"aria-valuemin":t.min,"aria-valuemax":t.max,"aria-valuenow":t.d_value,inputmode:t.mode==="decimal"&&!t.minFractionDigits?"numeric":"decimal",disabled:t.disabled,readonly:t.readonly,placeholder:t.placeholder,"aria-labelledby":t.ariaLabelledby,"aria-label":t.ariaLabel,required:t.required,size:t.size,invalid:t.invalid,variant:t.variant,onInput:f.onUserInput,onKeydown:f.onInputKeyDown,onKeypress:f.onInputKeyPress,onPaste:f.onPaste,onClick:f.onInputClick,onFocus:f.onInputFocus,onBlur:f.onInputBlur,pt:t.ptm("pcInputText"),unstyled:t.unstyled,"data-p":f.dataP},null,8,["id","name","class","style","defaultValue","aria-valuemin","aria-valuemax","aria-valuenow","inputmode","disabled","readonly","placeholder","aria-labelledby","aria-label","required","size","invalid","variant","onInput","onKeydown","onKeypress","onPaste","onClick","onFocus","onBlur","pt","unstyled","data-p"]),t.showClear&&t.buttonLayout!=="vertical"?ir(t.$slots,"clearicon",{key:0,class:wr(t.cx("clearIcon")),clearCallback:f.onClearClick},function(){return[pr(s,ot({ref:"clearIcon",class:[t.cx("clearIcon")],onClick:f.onClearClick},t.ptm("clearIcon")),null,16,["class","onClick"])]}):Pn("",!0),t.showButtons&&t.buttonLayout==="stacked"?(Me(),ft("span",ot({key:1,class:t.cx("buttonGroup")},t.ptm("buttonGroup"),{"data-p":f.dataP}),[ir(t.$slots,"incrementbutton",{listeners:f.upButtonListeners},function(){return[Ze("button",ot({class:[t.cx("incrementButton"),t.incrementButtonClass]},ax(f.upButtonListeners),{disabled:t.disabled,tabindex:-1,"aria-hidden":"true",type:"button"},t.ptm("incrementButton"),{"data-p":f.dataP}),[ir(t.$slots,t.$slots.incrementicon?"incrementicon":"incrementbuttonicon",{},function(){return[(Me(),rn(Hr(t.incrementIcon||t.incrementButtonIcon?"span":"AngleUpIcon"),ot({class:[t.incrementIcon,t.incrementButtonIcon]},t.ptm("incrementIcon"),{"data-pc-section":"incrementicon"}),null,16,["class"]))]})],16,soe)]}),ir(t.$slots,"decrementbutton",{listeners:f.downButtonListeners},function(){return[Ze("button",ot({class:[t.cx("decrementButton"),t.decrementButtonClass]},ax(f.downButtonListeners),{disabled:t.disabled,tabindex:-1,"aria-hidden":"true",type:"button"},t.ptm("decrementButton"),{"data-p":f.dataP}),[ir(t.$slots,t.$slots.decrementicon?"decrementicon":"decrementbuttonicon",{},function(){return[(Me(),rn(Hr(t.decrementIcon||t.decrementButtonIcon?"span":"AngleDownIcon"),ot({class:[t.decrementIcon,t.decrementButtonIcon]},t.ptm("decrementIcon"),{"data-pc-section":"decrementicon"}),null,16,["class"]))]})],16,aoe)]})],16,ooe)):Pn("",!0),ir(t.$slots,"incrementbutton",{listeners:f.upButtonListeners},function(){return[t.showButtons&&t.buttonLayout!=="stacked"?(Me(),ft("button",ot({key:0,class:[t.cx("incrementButton"),t.incrementButtonClass]},ax(f.upButtonListeners),{disabled:t.disabled,tabindex:-1,"aria-hidden":"true",type:"button"},t.ptm("incrementButton"),{"data-p":f.dataP}),[ir(t.$slots,t.$slots.incrementicon?"incrementicon":"incrementbuttonicon",{},function(){return[(Me(),rn(Hr(t.incrementIcon||t.incrementButtonIcon?"span":"AngleUpIcon"),ot({class:[t.incrementIcon,t.incrementButtonIcon]},t.ptm("incrementIcon"),{"data-pc-section":"incrementicon"}),null,16,["class"]))]})],16,loe)):Pn("",!0)]}),ir(t.$slots,"decrementbutton",{listeners:f.downButtonListeners},function(){return[t.showButtons&&t.buttonLayout!=="stacked"?(Me(),ft("button",ot({key:0,class:[t.cx("decrementButton"),t.decrementButtonClass]},ax(f.downButtonListeners),{disabled:t.disabled,tabindex:-1,"aria-hidden":"true",type:"button"},t.ptm("decrementButton"),{"data-p":f.dataP}),[ir(t.$slots,t.$slots.decrementicon?"decrementicon":"decrementbuttonicon",{},function(){return[(Me(),rn(Hr(t.decrementIcon||t.decrementButtonIcon?"span":"AngleDownIcon"),ot({class:[t.decrementIcon,t.decrementButtonIcon]},t.ptm("decrementIcon"),{"data-pc-section":"decrementicon"}),null,16,["class"]))]})],16,coe)):Pn("",!0)]})],16,ioe)}TN.render=uoe;var SN={name:"AngleDoubleRightIcon",extends:go};function doe(t){return moe(t)||poe(t)||foe(t)||hoe()}function hoe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function foe(t,e){if(t){if(typeof t=="string")return J2(t,e);var n={}.toString.call(t).slice(8,-1);return n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set"?Array.from(t):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?J2(t,e):void 0}}function poe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function moe(t){if(Array.isArray(t))return J2(t)}function J2(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,l=Array(e);n<e;n++)l[n]=t[n];return l}function goe(t,e,n,l,d,f){return Me(),ft("svg",ot({width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},t.pti()),doe(e[0]||(e[0]=[Ze("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M7.68757 11.1451C7.7791 11.1831 7.8773 11.2024 7.9764 11.2019C8.07769 11.1985 8.17721 11.1745 8.26886 11.1312C8.36052 11.088 8.44238 11.0265 8.50943 10.9505L12.0294 7.49085C12.1707 7.34942 12.25 7.15771 12.25 6.95782C12.25 6.75794 12.1707 6.56622 12.0294 6.42479L8.50943 2.90479C8.37014 2.82159 8.20774 2.78551 8.04633 2.80192C7.88491 2.81833 7.73309 2.88635 7.6134 2.99588C7.4937 3.10541 7.41252 3.25061 7.38189 3.40994C7.35126 3.56927 7.37282 3.73423 7.44337 3.88033L10.4605 6.89748L7.44337 9.91463C7.30212 10.0561 7.22278 10.2478 7.22278 10.4477C7.22278 10.6475 7.30212 10.8393 7.44337 10.9807C7.51301 11.0512 7.59603 11.1071 7.68757 11.1451ZM1.94207 10.9505C2.07037 11.0968 2.25089 11.1871 2.44493 11.2019C2.63898 11.1871 2.81949 11.0968 2.94779 10.9505L6.46779 7.49085C6.60905 7.34942 6.68839 7.15771 6.68839 6.95782C6.68839 6.75793 6.60905 6.56622 6.46779 6.42479L2.94779 2.90479C2.80704 2.83757 2.6489 2.81563 2.49517 2.84201C2.34143 2.86839 2.19965 2.94178 2.08936 3.05207C1.97906 3.16237 1.90567 3.30415 1.8793 3.45788C1.85292 3.61162 1.87485 3.76975 1.94207 3.9105L4.95922 6.92765L1.94207 9.9448C1.81838 10.0831 1.75 10.2621 1.75 10.4477C1.75 10.6332 1.81838 10.8122 1.94207 10.9505Z",fill:"currentColor"},null,-1)])),16)}SN.render=goe;var EN={name:"AngleRightIcon",extends:go};function _oe(t){return xoe(t)||boe(t)||voe(t)||yoe()}function yoe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function voe(t,e){if(t){if(typeof t=="string")return Q2(t,e);var n={}.toString.call(t).slice(8,-1);return n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set"?Array.from(t):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Q2(t,e):void 0}}function boe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function xoe(t){if(Array.isArray(t))return Q2(t)}function Q2(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,l=Array(e);n<e;n++)l[n]=t[n];return l}function woe(t,e,n,l,d,f){return Me(),ft("svg",ot({width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},t.pti()),_oe(e[0]||(e[0]=[Ze("path",{d:"M5.25 11.1728C5.14929 11.1694 5.05033 11.1455 4.9592 11.1025C4.86806 11.0595 4.78666 10.9984 4.72 10.9228C4.57955 10.7822 4.50066 10.5916 4.50066 10.3928C4.50066 10.1941 4.57955 10.0035 4.72 9.86283L7.72 6.86283L4.72 3.86283C4.66067 3.71882 4.64765 3.55991 4.68275 3.40816C4.71785 3.25642 4.79932 3.11936 4.91585 3.01602C5.03238 2.91268 5.17819 2.84819 5.33305 2.83149C5.4879 2.81479 5.64411 2.84671 5.78 2.92283L9.28 6.42283C9.42045 6.56346 9.49934 6.75408 9.49934 6.95283C9.49934 7.15158 9.42045 7.34221 9.28 7.48283L5.78 10.9228C5.71333 10.9984 5.63193 11.0595 5.5408 11.1025C5.44966 11.1455 5.35071 11.1694 5.25 11.1728Z",fill:"currentColor"},null,-1)])),16)}EN.render=woe;var CN={name:"AngleLeftIcon",extends:go};function Toe(t){return Ioe(t)||Coe(t)||Eoe(t)||Soe()}function Soe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Eoe(t,e){if(t){if(typeof t=="string")return eI(t,e);var n={}.toString.call(t).slice(8,-1);return n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set"?Array.from(t):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?eI(t,e):void 0}}function Coe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function Ioe(t){if(Array.isArray(t))return eI(t)}function eI(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,l=Array(e);n<e;n++)l[n]=t[n];return l}function Aoe(t,e,n,l,d,f){return Me(),ft("svg",ot({width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},t.pti()),Toe(e[0]||(e[0]=[Ze("path",{d:"M8.75 11.185C8.65146 11.1854 8.55381 11.1662 8.4628 11.1284C8.37179 11.0906 8.28924 11.0351 8.22 10.965L4.72 7.46496C4.57955 7.32433 4.50066 7.13371 4.50066 6.93496C4.50066 6.73621 4.57955 6.54558 4.72 6.40496L8.22 2.93496C8.36095 2.84357 8.52851 2.80215 8.69582 2.81733C8.86312 2.83252 9.02048 2.90344 9.14268 3.01872C9.26487 3.134 9.34483 3.28696 9.36973 3.4531C9.39463 3.61924 9.36303 3.78892 9.28 3.93496L6.28 6.93496L9.28 9.93496C9.42045 10.0756 9.49934 10.2662 9.49934 10.465C9.49934 10.6637 9.42045 10.8543 9.28 10.995C9.13526 11.1257 8.9448 11.1939 8.75 11.185Z",fill:"currentColor"},null,-1)])),16)}CN.render=Aoe;var Poe={name:"BasePaginator",extends:Yi,props:{totalRecords:{type:Number,default:0},rows:{type:Number,default:0},first:{type:Number,default:0},pageLinkSize:{type:Number,default:5},rowsPerPageOptions:{type:Array,default:null},template:{type:[Object,String],default:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink RowsPerPageDropdown"},currentPageReportTemplate:{type:null,default:"({currentPage} of {totalPages})"},alwaysShow:{type:Boolean,default:!0}},style:are,provide:function(){return{$pcPaginator:this,$parentInstance:this}}},IN={name:"CurrentPageReport",hostName:"Paginator",extends:Yi,props:{pageCount:{type:Number,default:0},currentPage:{type:Number,default:0},page:{type:Number,default:0},first:{type:Number,default:0},rows:{type:Number,default:0},totalRecords:{type:Number,default:0},template:{type:String,default:"({currentPage} of {totalPages})"}},computed:{text:function(){var e=this.template.replace("{currentPage}",this.currentPage).replace("{totalPages}",this.pageCount).replace("{first}",this.pageCount>0?this.first+1:0).replace("{last}",Math.min(this.first+this.rows,this.totalRecords)).replace("{rows}",this.rows).replace("{totalRecords}",this.totalRecords);return e}}};function Roe(t,e,n,l,d,f){return Me(),ft("span",ot({class:t.cx("current")},t.ptm("current")),Fr(f.text),17)}IN.render=Roe;var AN={name:"FirstPageLink",hostName:"Paginator",extends:Yi,props:{template:{type:Function,default:null}},methods:{getPTOptions:function(e){return this.ptm(e,{context:{disabled:this.$attrs.disabled}})}},components:{AngleDoubleLeftIcon:mN},directives:{ripple:cf}};function koe(t,e,n,l,d,f){var x=Cd("ripple");return Xi((Me(),ft("button",ot({class:t.cx("first"),type:"button"},f.getPTOptions("first"),{"data-pc-group-section":"pagebutton"}),[(Me(),rn(Hr(n.template||"AngleDoubleLeftIcon"),ot({class:t.cx("firstIcon")},f.getPTOptions("firstIcon")),null,16,["class"]))],16)),[[x]])}AN.render=koe;var PN={name:"JumpToPageDropdown",hostName:"Paginator",extends:Yi,emits:["page-change"],props:{page:Number,pageCount:Number,disabled:Boolean,templates:null},methods:{onChange:function(e){this.$emit("page-change",e)}},computed:{pageOptions:function(){for(var e=[],n=0;n<this.pageCount;n++)e.push({label:String(n+1),value:n});return e}},components:{JTPSelect:VT}};function Ooe(t,e,n,l,d,f){var x=_r("JTPSelect");return Me(),rn(x,{modelValue:n.page,options:f.pageOptions,optionLabel:"label",optionValue:"value","onUpdate:modelValue":e[0]||(e[0]=function(s){return f.onChange(s)}),class:wr(t.cx("pcJumpToPageDropdown")),disabled:n.disabled,unstyled:t.unstyled,pt:t.ptm("pcJumpToPageDropdown"),"data-pc-group-section":"pagedropdown"},Nv({_:2},[n.templates.jumptopagedropdownicon?{name:"dropdownicon",fn:zr(function(s){return[(Me(),rn(Hr(n.templates.jumptopagedropdownicon),{class:wr(s.class)},null,8,["class"]))]}),key:"0"}:void 0]),1032,["modelValue","options","class","disabled","unstyled","pt"])}PN.render=Ooe;var RN={name:"JumpToPageInput",hostName:"Paginator",extends:Yi,inheritAttrs:!1,emits:["page-change"],props:{page:Number,pageCount:Number,disabled:Boolean},data:function(){return{d_page:this.page}},watch:{page:function(e){this.d_page=e}},methods:{onChange:function(e){e!==this.page&&(this.d_page=e,this.$emit("page-change",e-1))}},computed:{inputArialabel:function(){return this.$primevue.config.locale.aria?this.$primevue.config.locale.aria.jumpToPageInputLabel:void 0}},components:{JTPInput:TN}};function Moe(t,e,n,l,d,f){var x=_r("JTPInput");return Me(),rn(x,{ref:"jtpInput",modelValue:d.d_page,class:wr(t.cx("pcJumpToPageInputText")),"aria-label":f.inputArialabel,disabled:n.disabled,"onUpdate:modelValue":f.onChange,unstyled:t.unstyled,pt:t.ptm("pcJumpToPageInputText")},null,8,["modelValue","class","aria-label","disabled","onUpdate:modelValue","unstyled","pt"])}RN.render=Moe;var kN={name:"LastPageLink",hostName:"Paginator",extends:Yi,props:{template:{type:Function,default:null}},methods:{getPTOptions:function(e){return this.ptm(e,{context:{disabled:this.$attrs.disabled}})}},components:{AngleDoubleRightIcon:SN},directives:{ripple:cf}};function Doe(t,e,n,l,d,f){var x=Cd("ripple");return Xi((Me(),ft("button",ot({class:t.cx("last"),type:"button"},f.getPTOptions("last"),{"data-pc-group-section":"pagebutton"}),[(Me(),rn(Hr(n.template||"AngleDoubleRightIcon"),ot({class:t.cx("lastIcon")},f.getPTOptions("lastIcon")),null,16,["class"]))],16)),[[x]])}kN.render=Doe;var ON={name:"NextPageLink",hostName:"Paginator",extends:Yi,props:{template:{type:Function,default:null}},methods:{getPTOptions:function(e){return this.ptm(e,{context:{disabled:this.$attrs.disabled}})}},components:{AngleRightIcon:EN},directives:{ripple:cf}};function Loe(t,e,n,l,d,f){var x=Cd("ripple");return Xi((Me(),ft("button",ot({class:t.cx("next"),type:"button"},f.getPTOptions("next"),{"data-pc-group-section":"pagebutton"}),[(Me(),rn(Hr(n.template||"AngleRightIcon"),ot({class:t.cx("nextIcon")},f.getPTOptions("nextIcon")),null,16,["class"]))],16)),[[x]])}ON.render=Loe;var MN={name:"PageLinks",hostName:"Paginator",extends:Yi,inheritAttrs:!1,emits:["click"],props:{value:Array,page:Number},methods:{getPTOptions:function(e,n){return this.ptm(n,{context:{active:e===this.page}})},onPageLinkClick:function(e,n){this.$emit("click",{originalEvent:e,value:n})},ariaPageLabel:function(e){return this.$primevue.config.locale.aria?this.$primevue.config.locale.aria.pageLabel.replace(/{page}/g,e):void 0}},directives:{ripple:cf}},zoe=["aria-label","aria-current","onClick","data-p-active"];function Foe(t,e,n,l,d,f){var x=Cd("ripple");return Me(),ft("span",ot({class:t.cx("pages")},t.ptm("pages")),[(Me(!0),ft(Tr,null,ms(n.value,function(s){return Xi((Me(),ft("button",ot({key:s,class:t.cx("page",{pageLink:s}),type:"button","aria-label":f.ariaPageLabel(s),"aria-current":s-1===n.page?"page":void 0,onClick:function(P){return f.onPageLinkClick(P,s)}},{ref_for:!0},f.getPTOptions(s-1,"page"),{"data-p-active":s-1===n.page}),[Ra(Fr(s),1)],16,zoe)),[[x]])}),128))],16)}MN.render=Foe;var DN={name:"PrevPageLink",hostName:"Paginator",extends:Yi,props:{template:{type:Function,default:null}},methods:{getPTOptions:function(e){return this.ptm(e,{context:{disabled:this.$attrs.disabled}})}},components:{AngleLeftIcon:CN},directives:{ripple:cf}};function Boe(t,e,n,l,d,f){var x=Cd("ripple");return Xi((Me(),ft("button",ot({class:t.cx("prev"),type:"button"},f.getPTOptions("prev"),{"data-pc-group-section":"pagebutton"}),[(Me(),rn(Hr(n.template||"AngleLeftIcon"),ot({class:t.cx("prevIcon")},f.getPTOptions("prevIcon")),null,16,["class"]))],16)),[[x]])}DN.render=Boe;var LN={name:"RowsPerPageDropdown",hostName:"Paginator",extends:Yi,emits:["rows-change"],props:{options:Array,rows:Number,disabled:Boolean,templates:null},methods:{onChange:function(e){this.$emit("rows-change",e)}},computed:{rowsOptions:function(){var e=[];if(this.options)for(var n=0;n<this.options.length;n++)e.push({label:String(this.options[n]),value:this.options[n]});return e}},components:{RPPSelect:VT}};function Noe(t,e,n,l,d,f){var x=_r("RPPSelect");return Me(),rn(x,{modelValue:n.rows,options:f.rowsOptions,optionLabel:"label",optionValue:"value","onUpdate:modelValue":e[0]||(e[0]=function(s){return f.onChange(s)}),class:wr(t.cx("pcRowPerPageDropdown")),disabled:n.disabled,unstyled:t.unstyled,pt:t.ptm("pcRowPerPageDropdown"),"data-pc-group-section":"pagedropdown"},Nv({_:2},[n.templates.rowsperpagedropdownicon?{name:"dropdownicon",fn:zr(function(s){return[(Me(),rn(Hr(n.templates.rowsperpagedropdownicon),{class:wr(s.class)},null,8,["class"]))]}),key:"0"}:void 0]),1032,["modelValue","options","class","disabled","unstyled","pt"])}LN.render=Noe;function tI(t){"@babel/helpers - typeof";return tI=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},tI(t)}function QL(t,e){return joe(t)||Uoe(t,e)||$oe(t,e)||Voe()}function Voe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function $oe(t,e){if(t){if(typeof t=="string")return e5(t,e);var n={}.toString.call(t).slice(8,-1);return n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set"?Array.from(t):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?e5(t,e):void 0}}function e5(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,l=Array(e);n<e;n++)l[n]=t[n];return l}function Uoe(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var l,d,f,x,s=[],C=!0,P=!1;try{if(f=(n=n.call(t)).next,e===0){if(Object(n)!==n)return;C=!1}else for(;!(C=(l=f.call(n)).done)&&(s.push(l.value),s.length!==e);C=!0);}catch(L){P=!0,d=L}finally{try{if(!C&&n.return!=null&&(x=n.return(),Object(x)!==x))return}finally{if(P)throw d}}return s}}function joe(t){if(Array.isArray(t))return t}var zN={name:"Paginator",extends:Poe,inheritAttrs:!1,emits:["update:first","update:rows","page"],data:function(){return{d_first:this.first,d_rows:this.rows}},watch:{first:function(e){this.d_first=e},rows:function(e){this.d_rows=e},totalRecords:function(e){this.page>0&&e&&this.d_first>=e&&this.changePage(this.pageCount-1)}},mounted:function(){this.createStyle()},methods:{changePage:function(e){var n=this.pageCount;if(e>=0&&e<n){this.d_first=this.d_rows*e;var l={page:e,first:this.d_first,rows:this.d_rows,pageCount:n};this.$emit("update:first",this.d_first),this.$emit("update:rows",this.d_rows),this.$emit("page",l)}},changePageToFirst:function(e){this.isFirstPage||this.changePage(0),e.preventDefault()},changePageToPrev:function(e){this.changePage(this.page-1),e.preventDefault()},changePageLink:function(e){this.changePage(e.value-1),e.originalEvent.preventDefault()},changePageToNext:function(e){this.changePage(this.page+1),e.preventDefault()},changePageToLast:function(e){this.isLastPage||this.changePage(this.pageCount-1),e.preventDefault()},onRowChange:function(e){this.d_rows=e,this.changePage(this.page)},createStyle:function(){var e=this;if(this.hasBreakpoints()&&!this.isUnstyled){var n;this.styleElement=document.createElement("style"),this.styleElement.type="text/css",eP(this.styleElement,"nonce",(n=this.$primevue)===null||n===void 0||(n=n.config)===null||n===void 0||(n=n.csp)===null||n===void 0?void 0:n.nonce),document.body.appendChild(this.styleElement);var l="",d=Object.keys(this.template),f={};d.sort(function(ue,de){return parseInt(ue)-parseInt(de)}).forEach(function(ue){f[ue]=e.template[ue]});for(var x=0,s=Object.entries(Object.entries(f));x<s.length;x++){var C=QL(s[x],2),P=C[0],L=QL(C[1],1),$=L[0],V=void 0,j=void 0;$!=="default"&&typeof Object.keys(f)[P-1]=="string"?j=Number(Object.keys(f)[P-1].slice(0,-2))+1+"px":j=Object.keys(f)[P-1],V=Object.entries(f)[P-1]?"and (min-width:".concat(j,")"):"",$==="default"?l+=`
                            @media screen `.concat(V,` {
                                .p-paginator[`).concat(this.$attrSelector,`],
                                    display: flex;
                                }
                            }
                        `):l+=`
.p-paginator-`.concat($,` {
    display: none;
}
@media screen `).concat(V," and (max-width: ").concat($,`) {
    .p-paginator-`).concat($,` {
        display: flex;
    }

    .p-paginator-default{
        display: none;
    }
}
                    `)}this.styleElement.innerHTML=l}},hasBreakpoints:function(){return tI(this.template)==="object"},getAriaLabel:function(e){return this.$primevue.config.locale.aria?this.$primevue.config.locale.aria[e]:void 0}},computed:{templateItems:function(){var e={};if(this.hasBreakpoints()){e=this.template,e.default||(e.default="FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink RowsPerPageDropdown");for(var n in e)e[n]=this.template[n].split(" ").map(function(l){return l.trim()});return e}return e.default=this.template.split(" ").map(function(l){return l.trim()}),e},page:function(){return Math.floor(this.d_first/this.d_rows)},pageCount:function(){return Math.ceil(this.totalRecords/this.d_rows)},isFirstPage:function(){return this.page===0},isLastPage:function(){return this.page===this.pageCount-1},calculatePageLinkBoundaries:function(){var e=this.pageCount,n=Math.min(this.pageLinkSize,e),l=Math.max(0,Math.ceil(this.page-n/2)),d=Math.min(e-1,l+n-1),f=this.pageLinkSize-(d-l+1);return l=Math.max(0,l-f),[l,d]},pageLinks:function(){for(var e=[],n=this.calculatePageLinkBoundaries,l=n[0],d=n[1],f=l;f<=d;f++)e.push(f+1);return e},currentState:function(){return{page:this.page,first:this.d_first,rows:this.d_rows}},empty:function(){return this.pageCount===0},currentPage:function(){return this.pageCount>0?this.page+1:0},last:function(){return Math.min(this.d_first+this.rows,this.totalRecords)}},components:{CurrentPageReport:IN,FirstPageLink:AN,LastPageLink:kN,NextPageLink:ON,PageLinks:MN,PrevPageLink:DN,RowsPerPageDropdown:LN,JumpToPageDropdown:PN,JumpToPageInput:RN}};function Goe(t,e,n,l,d,f){var x=_r("FirstPageLink"),s=_r("PrevPageLink"),C=_r("NextPageLink"),P=_r("LastPageLink"),L=_r("PageLinks"),$=_r("CurrentPageReport"),V=_r("RowsPerPageDropdown"),j=_r("JumpToPageDropdown"),ue=_r("JumpToPageInput");return t.alwaysShow||f.pageLinks&&f.pageLinks.length>1?(Me(),ft("nav",Xw(ot({key:0},t.ptmi("paginatorContainer"))),[(Me(!0),ft(Tr,null,ms(f.templateItems,function(de,Te){return Me(),ft("div",ot({key:Te,ref_for:!0,ref:"paginator",class:t.cx("paginator",{key:Te})},{ref_for:!0},t.ptm("root")),[t.$slots.container?ir(t.$slots,"container",{key:0,first:d.d_first+1,last:f.last,rows:d.d_rows,page:f.page,pageCount:f.pageCount,pageLinks:f.pageLinks,totalRecords:t.totalRecords,firstPageCallback:f.changePageToFirst,lastPageCallback:f.changePageToLast,prevPageCallback:f.changePageToPrev,nextPageCallback:f.changePageToNext,rowChangeCallback:f.onRowChange,changePageCallback:f.changePage}):(Me(),ft(Tr,{key:1},[t.$slots.start?(Me(),ft("div",ot({key:0,class:t.cx("contentStart")},{ref_for:!0},t.ptm("contentStart")),[ir(t.$slots,"start",{state:f.currentState})],16)):Pn("",!0),Ze("div",ot({class:t.cx("content")},{ref_for:!0},t.ptm("content")),[(Me(!0),ft(Tr,null,ms(de,function(Be){return Me(),ft(Tr,{key:Be},[Be==="FirstPageLink"?(Me(),rn(x,{key:0,"aria-label":f.getAriaLabel("firstPageLabel"),template:t.$slots.firsticon||t.$slots.firstpagelinkicon,onClick:e[0]||(e[0]=function(Ge){return f.changePageToFirst(Ge)}),disabled:f.isFirstPage||f.empty,unstyled:t.unstyled,pt:t.pt},null,8,["aria-label","template","disabled","unstyled","pt"])):Be==="PrevPageLink"?(Me(),rn(s,{key:1,"aria-label":f.getAriaLabel("prevPageLabel"),template:t.$slots.previcon||t.$slots.prevpagelinkicon,onClick:e[1]||(e[1]=function(Ge){return f.changePageToPrev(Ge)}),disabled:f.isFirstPage||f.empty,unstyled:t.unstyled,pt:t.pt},null,8,["aria-label","template","disabled","unstyled","pt"])):Be==="NextPageLink"?(Me(),rn(C,{key:2,"aria-label":f.getAriaLabel("nextPageLabel"),template:t.$slots.nexticon||t.$slots.nextpagelinkicon,onClick:e[2]||(e[2]=function(Ge){return f.changePageToNext(Ge)}),disabled:f.isLastPage||f.empty,unstyled:t.unstyled,pt:t.pt},null,8,["aria-label","template","disabled","unstyled","pt"])):Be==="LastPageLink"?(Me(),rn(P,{key:3,"aria-label":f.getAriaLabel("lastPageLabel"),template:t.$slots.lasticon||t.$slots.lastpagelinkicon,onClick:e[3]||(e[3]=function(Ge){return f.changePageToLast(Ge)}),disabled:f.isLastPage||f.empty,unstyled:t.unstyled,pt:t.pt},null,8,["aria-label","template","disabled","unstyled","pt"])):Be==="PageLinks"?(Me(),rn(L,{key:4,"aria-label":f.getAriaLabel("pageLabel"),value:f.pageLinks,page:f.page,onClick:e[4]||(e[4]=function(Ge){return f.changePageLink(Ge)}),unstyled:t.unstyled,pt:t.pt},null,8,["aria-label","value","page","unstyled","pt"])):Be==="CurrentPageReport"?(Me(),rn($,{key:5,"aria-live":"polite",template:t.currentPageReportTemplate,currentPage:f.currentPage,page:f.page,pageCount:f.pageCount,first:d.d_first,rows:d.d_rows,totalRecords:t.totalRecords,unstyled:t.unstyled,pt:t.pt},null,8,["template","currentPage","page","pageCount","first","rows","totalRecords","unstyled","pt"])):Be==="RowsPerPageDropdown"&&t.rowsPerPageOptions?(Me(),rn(V,{key:6,"aria-label":f.getAriaLabel("rowsPerPageLabel"),rows:d.d_rows,options:t.rowsPerPageOptions,onRowsChange:e[5]||(e[5]=function(Ge){return f.onRowChange(Ge)}),disabled:f.empty,templates:t.$slots,unstyled:t.unstyled,pt:t.pt},null,8,["aria-label","rows","options","disabled","templates","unstyled","pt"])):Be==="JumpToPageDropdown"?(Me(),rn(j,{key:7,"aria-label":f.getAriaLabel("jumpToPageDropdownLabel"),page:f.page,pageCount:f.pageCount,onPageChange:e[6]||(e[6]=function(Ge){return f.changePage(Ge)}),disabled:f.empty,templates:t.$slots,unstyled:t.unstyled,pt:t.pt},null,8,["aria-label","page","pageCount","disabled","templates","unstyled","pt"])):Be==="JumpToPageInput"?(Me(),rn(ue,{key:8,page:f.currentPage,onPageChange:e[7]||(e[7]=function(Ge){return f.changePage(Ge)}),disabled:f.empty,unstyled:t.unstyled,pt:t.pt},null,8,["page","disabled","unstyled","pt"])):Pn("",!0)],64)}),128))],16),t.$slots.end?(Me(),ft("div",ot({key:1,class:t.cx("contentEnd")},{ref_for:!0},t.ptm("contentEnd")),[ir(t.$slots,"end",{state:f.currentState})],16)):Pn("",!0)],64))],16)}),128))],16)):Pn("",!0)}zN.render=Goe;var Hoe=`
    .p-datatable {
        position: relative;
        display: block;
    }

    .p-datatable-table {
        border-spacing: 0;
        border-collapse: separate;
        width: 100%;
    }

    .p-datatable-scrollable > .p-datatable-table-container {
        position: relative;
    }

    .p-datatable-scrollable-table > .p-datatable-thead {
        inset-block-start: 0;
        z-index: 1;
    }

    .p-datatable-scrollable-table > .p-datatable-frozen-tbody {
        position: sticky;
        z-index: 1;
    }

    .p-datatable-scrollable-table > .p-datatable-tfoot {
        inset-block-end: 0;
        z-index: 1;
    }

    .p-datatable-scrollable .p-datatable-frozen-column {
        position: sticky;
    }

    .p-datatable-scrollable th.p-datatable-frozen-column {
        z-index: 1;
    }

    .p-datatable-scrollable td.p-datatable-frozen-column {
        background: inherit;
    }

    .p-datatable-scrollable > .p-datatable-table-container > .p-datatable-table > .p-datatable-thead,
    .p-datatable-scrollable > .p-datatable-table-container > .p-virtualscroller > .p-datatable-table > .p-datatable-thead {
        background: dt('datatable.header.cell.background');
    }

    .p-datatable-scrollable > .p-datatable-table-container > .p-datatable-table > .p-datatable-tfoot,
    .p-datatable-scrollable > .p-datatable-table-container > .p-virtualscroller > .p-datatable-table > .p-datatable-tfoot {
        background: dt('datatable.footer.cell.background');
    }

    .p-datatable-flex-scrollable {
        display: flex;
        flex-direction: column;
        height: 100%;
    }

    .p-datatable-flex-scrollable > .p-datatable-table-container {
        display: flex;
        flex-direction: column;
        flex: 1;
        height: 100%;
    }

    .p-datatable-scrollable-table > .p-datatable-tbody > .p-datatable-row-group-header {
        position: sticky;
        z-index: 1;
    }

    .p-datatable-resizable-table > .p-datatable-thead > tr > th,
    .p-datatable-resizable-table > .p-datatable-tfoot > tr > td,
    .p-datatable-resizable-table > .p-datatable-tbody > tr > td {
        overflow: hidden;
        white-space: nowrap;
    }

    .p-datatable-resizable-table > .p-datatable-thead > tr > th.p-datatable-resizable-column:not(.p-datatable-frozen-column) {
        background-clip: padding-box;
        position: relative;
    }

    .p-datatable-resizable-table-fit > .p-datatable-thead > tr > th.p-datatable-resizable-column:last-child .p-datatable-column-resizer {
        display: none;
    }

    .p-datatable-column-resizer {
        display: block;
        position: absolute;
        inset-block-start: 0;
        inset-inline-end: 0;
        margin: 0;
        width: dt('datatable.column.resizer.width');
        height: 100%;
        padding: 0;
        cursor: col-resize;
        border: 1px solid transparent;
    }

    .p-datatable-column-header-content {
        display: flex;
        align-items: center;
        gap: dt('datatable.header.cell.gap');
    }

    .p-datatable-column-resize-indicator {
        width: dt('datatable.resize.indicator.width');
        position: absolute;
        z-index: 10;
        display: none;
        background: dt('datatable.resize.indicator.color');
    }

    .p-datatable-row-reorder-indicator-up,
    .p-datatable-row-reorder-indicator-down {
        position: absolute;
        display: none;
    }

    .p-datatable-reorderable-column,
    .p-datatable-reorderable-row-handle {
        cursor: move;
    }

    .p-datatable-mask {
        position: absolute;
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 2;
    }

    .p-datatable-inline-filter {
        display: flex;
        align-items: center;
        width: 100%;
        gap: dt('datatable.filter.inline.gap');
    }

    .p-datatable-inline-filter .p-datatable-filter-element-container {
        flex: 1 1 auto;
        width: 1%;
    }

    .p-datatable-filter-overlay {
        background: dt('datatable.filter.overlay.select.background');
        color: dt('datatable.filter.overlay.select.color');
        border: 1px solid dt('datatable.filter.overlay.select.border.color');
        border-radius: dt('datatable.filter.overlay.select.border.radius');
        box-shadow: dt('datatable.filter.overlay.select.shadow');
        min-width: 12.5rem;
    }

    .p-datatable-filter-constraint-list {
        margin: 0;
        list-style: none;
        display: flex;
        flex-direction: column;
        padding: dt('datatable.filter.constraint.list.padding');
        gap: dt('datatable.filter.constraint.list.gap');
    }

    .p-datatable-filter-constraint {
        padding: dt('datatable.filter.constraint.padding');
        color: dt('datatable.filter.constraint.color');
        border-radius: dt('datatable.filter.constraint.border.radius');
        cursor: pointer;
        transition:
            background dt('datatable.transition.duration'),
            color dt('datatable.transition.duration'),
            border-color dt('datatable.transition.duration'),
            box-shadow dt('datatable.transition.duration');
    }

    .p-datatable-filter-constraint-selected {
        background: dt('datatable.filter.constraint.selected.background');
        color: dt('datatable.filter.constraint.selected.color');
    }

    .p-datatable-filter-constraint:not(.p-datatable-filter-constraint-selected):not(.p-disabled):hover {
        background: dt('datatable.filter.constraint.focus.background');
        color: dt('datatable.filter.constraint.focus.color');
    }

    .p-datatable-filter-constraint:focus-visible {
        outline: 0 none;
        background: dt('datatable.filter.constraint.focus.background');
        color: dt('datatable.filter.constraint.focus.color');
    }

    .p-datatable-filter-constraint-selected:focus-visible {
        outline: 0 none;
        background: dt('datatable.filter.constraint.selected.focus.background');
        color: dt('datatable.filter.constraint.selected.focus.color');
    }

    .p-datatable-filter-constraint-separator {
        border-block-start: 1px solid dt('datatable.filter.constraint.separator.border.color');
    }

    .p-datatable-popover-filter {
        display: inline-flex;
        margin-inline-start: auto;
    }

    .p-datatable-filter-overlay-popover {
        background: dt('datatable.filter.overlay.popover.background');
        color: dt('datatable.filter.overlay.popover.color');
        border: 1px solid dt('datatable.filter.overlay.popover.border.color');
        border-radius: dt('datatable.filter.overlay.popover.border.radius');
        box-shadow: dt('datatable.filter.overlay.popover.shadow');
        min-width: 12.5rem;
        padding: dt('datatable.filter.overlay.popover.padding');
        display: flex;
        flex-direction: column;
        gap: dt('datatable.filter.overlay.popover.gap');
    }

    .p-datatable-filter-operator-dropdown {
        width: 100%;
    }

    .p-datatable-filter-rule-list,
    .p-datatable-filter-rule {
        display: flex;
        flex-direction: column;
        gap: dt('datatable.filter.overlay.popover.gap');
    }

    .p-datatable-filter-rule {
        border-block-end: 1px solid dt('datatable.filter.rule.border.color');
        padding-bottom: dt('datatable.filter.overlay.popover.gap');
    }

    .p-datatable-filter-rule:last-child {
        border-block-end: 0 none;
        padding-bottom: 0;
    }

    .p-datatable-filter-add-rule-button {
        width: 100%;
    }

    .p-datatable-filter-remove-rule-button {
        width: 100%;
    }

    .p-datatable-filter-buttonbar {
        padding: 0;
        display: flex;
        align-items: center;
        justify-content: space-between;
    }

    .p-datatable-virtualscroller-spacer {
        display: flex;
    }

    .p-datatable .p-virtualscroller .p-virtualscroller-loading {
        transform: none !important;
        min-height: 0;
        position: sticky;
        inset-block-start: 0;
        inset-inline-start: 0;
    }

    .p-datatable-paginator-top {
        border-color: dt('datatable.paginator.top.border.color');
        border-style: solid;
        border-width: dt('datatable.paginator.top.border.width');
    }

    .p-datatable-paginator-bottom {
        border-color: dt('datatable.paginator.bottom.border.color');
        border-style: solid;
        border-width: dt('datatable.paginator.bottom.border.width');
    }

    .p-datatable-header {
        background: dt('datatable.header.background');
        color: dt('datatable.header.color');
        border-color: dt('datatable.header.border.color');
        border-style: solid;
        border-width: dt('datatable.header.border.width');
        padding: dt('datatable.header.padding');
    }

    .p-datatable-footer {
        background: dt('datatable.footer.background');
        color: dt('datatable.footer.color');
        border-color: dt('datatable.footer.border.color');
        border-style: solid;
        border-width: dt('datatable.footer.border.width');
        padding: dt('datatable.footer.padding');
    }

    .p-datatable-header-cell {
        padding: dt('datatable.header.cell.padding');
        background: dt('datatable.header.cell.background');
        border-color: dt('datatable.header.cell.border.color');
        border-style: solid;
        border-width: 0 0 1px 0;
        color: dt('datatable.header.cell.color');
        font-weight: normal;
        text-align: start;
        transition:
            background dt('datatable.transition.duration'),
            color dt('datatable.transition.duration'),
            border-color dt('datatable.transition.duration'),
            outline-color dt('datatable.transition.duration'),
            box-shadow dt('datatable.transition.duration');
    }

    .p-datatable-column-title {
        font-weight: dt('datatable.column.title.font.weight');
    }

    .p-datatable-tbody > tr {
        outline-color: transparent;
        background: dt('datatable.row.background');
        color: dt('datatable.row.color');
        transition:
            background dt('datatable.transition.duration'),
            color dt('datatable.transition.duration'),
            border-color dt('datatable.transition.duration'),
            outline-color dt('datatable.transition.duration'),
            box-shadow dt('datatable.transition.duration');
    }

    .p-datatable-tbody > tr > td {
        text-align: start;
        border-color: dt('datatable.body.cell.border.color');
        border-style: solid;
        border-width: 0 0 1px 0;
        padding: dt('datatable.body.cell.padding');
    }

    .p-datatable-hoverable .p-datatable-tbody > tr:not(.p-datatable-row-selected):hover {
        background: dt('datatable.row.hover.background');
        color: dt('datatable.row.hover.color');
    }

    .p-datatable-tbody > tr.p-datatable-row-selected {
        background: dt('datatable.row.selected.background');
        color: dt('datatable.row.selected.color');
    }

    .p-datatable-tbody > tr:has(+ .p-datatable-row-selected) > td {
        border-block-end-color: dt('datatable.body.cell.selected.border.color');
    }

    .p-datatable-tbody > tr.p-datatable-row-selected > td {
        border-block-end-color: dt('datatable.body.cell.selected.border.color');
    }

    .p-datatable-tbody > tr:focus-visible,
    .p-datatable-tbody > tr.p-datatable-contextmenu-row-selected {
        box-shadow: dt('datatable.row.focus.ring.shadow');
        outline: dt('datatable.row.focus.ring.width') dt('datatable.row.focus.ring.style') dt('datatable.row.focus.ring.color');
        outline-offset: dt('datatable.row.focus.ring.offset');
    }

    .p-datatable-tfoot > tr > td {
        text-align: start;
        padding: dt('datatable.footer.cell.padding');
        border-color: dt('datatable.footer.cell.border.color');
        border-style: solid;
        border-width: 0 0 1px 0;
        color: dt('datatable.footer.cell.color');
        background: dt('datatable.footer.cell.background');
    }

    .p-datatable-column-footer {
        font-weight: dt('datatable.column.footer.font.weight');
    }

    .p-datatable-sortable-column {
        cursor: pointer;
        user-select: none;
        outline-color: transparent;
    }

    .p-datatable-column-title,
    .p-datatable-sort-icon,
    .p-datatable-sort-badge {
        vertical-align: middle;
    }

    .p-datatable-sort-icon {
        color: dt('datatable.sort.icon.color');
        font-size: dt('datatable.sort.icon.size');
        width: dt('datatable.sort.icon.size');
        height: dt('datatable.sort.icon.size');
        transition: color dt('datatable.transition.duration');
    }

    .p-datatable-sortable-column:not(.p-datatable-column-sorted):hover {
        background: dt('datatable.header.cell.hover.background');
        color: dt('datatable.header.cell.hover.color');
    }

    .p-datatable-sortable-column:not(.p-datatable-column-sorted):hover .p-datatable-sort-icon {
        color: dt('datatable.sort.icon.hover.color');
    }

    .p-datatable-column-sorted {
        background: dt('datatable.header.cell.selected.background');
        color: dt('datatable.header.cell.selected.color');
    }

    .p-datatable-column-sorted .p-datatable-sort-icon {
        color: dt('datatable.header.cell.selected.color');
    }

    .p-datatable-sortable-column:focus-visible {
        box-shadow: dt('datatable.header.cell.focus.ring.shadow');
        outline: dt('datatable.header.cell.focus.ring.width') dt('datatable.header.cell.focus.ring.style') dt('datatable.header.cell.focus.ring.color');
        outline-offset: dt('datatable.header.cell.focus.ring.offset');
    }

    .p-datatable-hoverable .p-datatable-selectable-row {
        cursor: pointer;
    }

    .p-datatable-tbody > tr.p-datatable-dragpoint-top > td {
        box-shadow: inset 0 2px 0 0 dt('datatable.drop.point.color');
    }

    .p-datatable-tbody > tr.p-datatable-dragpoint-bottom > td {
        box-shadow: inset 0 -2px 0 0 dt('datatable.drop.point.color');
    }

    .p-datatable-loading-icon {
        font-size: dt('datatable.loading.icon.size');
        width: dt('datatable.loading.icon.size');
        height: dt('datatable.loading.icon.size');
    }

    .p-datatable-gridlines .p-datatable-header {
        border-width: 1px 1px 0 1px;
    }

    .p-datatable-gridlines .p-datatable-footer {
        border-width: 0 1px 1px 1px;
    }

    .p-datatable-gridlines .p-datatable-paginator-top {
        border-width: 1px 1px 0 1px;
    }

    .p-datatable-gridlines .p-datatable-paginator-bottom {
        border-width: 0 1px 1px 1px;
    }

    .p-datatable-gridlines .p-datatable-thead > tr > th {
        border-width: 1px 0 1px 1px;
    }

    .p-datatable-gridlines .p-datatable-thead > tr > th:last-child {
        border-width: 1px;
    }

    .p-datatable-gridlines .p-datatable-tbody > tr > td {
        border-width: 1px 0 0 1px;
    }

    .p-datatable-gridlines .p-datatable-tbody > tr > td:last-child {
        border-width: 1px 1px 0 1px;
    }

    .p-datatable-gridlines .p-datatable-tbody > tr:last-child > td {
        border-width: 1px 0 1px 1px;
    }

    .p-datatable-gridlines .p-datatable-tbody > tr:last-child > td:last-child {
        border-width: 1px;
    }

    .p-datatable-gridlines .p-datatable-tfoot > tr > td {
        border-width: 1px 0 1px 1px;
    }

    .p-datatable-gridlines .p-datatable-tfoot > tr > td:last-child {
        border-width: 1px 1px 1px 1px;
    }

    .p-datatable.p-datatable-gridlines .p-datatable-thead + .p-datatable-tfoot > tr > td {
        border-width: 0 0 1px 1px;
    }

    .p-datatable.p-datatable-gridlines .p-datatable-thead + .p-datatable-tfoot > tr > td:last-child {
        border-width: 0 1px 1px 1px;
    }

    .p-datatable.p-datatable-gridlines:has(.p-datatable-thead):has(.p-datatable-tbody) .p-datatable-tbody > tr > td {
        border-width: 0 0 1px 1px;
    }

    .p-datatable.p-datatable-gridlines:has(.p-datatable-thead):has(.p-datatable-tbody) .p-datatable-tbody > tr > td:last-child {
        border-width: 0 1px 1px 1px;
    }

    .p-datatable.p-datatable-gridlines:has(.p-datatable-tbody):has(.p-datatable-tfoot) .p-datatable-tbody > tr:last-child > td {
        border-width: 0 0 0 1px;
    }

    .p-datatable.p-datatable-gridlines:has(.p-datatable-tbody):has(.p-datatable-tfoot) .p-datatable-tbody > tr:last-child > td:last-child {
        border-width: 0 1px 0 1px;
    }

    .p-datatable.p-datatable-striped .p-datatable-tbody > tr.p-row-odd {
        background: dt('datatable.row.striped.background');
    }

    .p-datatable.p-datatable-striped .p-datatable-tbody > tr.p-row-odd.p-datatable-row-selected {
        background: dt('datatable.row.selected.background');
        color: dt('datatable.row.selected.color');
    }

    .p-datatable-striped.p-datatable-hoverable .p-datatable-tbody > tr:not(.p-datatable-row-selected):hover {
        background: dt('datatable.row.hover.background');
        color: dt('datatable.row.hover.color');
    }

    .p-datatable.p-datatable-sm .p-datatable-header {
        padding: dt('datatable.header.sm.padding');
    }

    .p-datatable.p-datatable-sm .p-datatable-thead > tr > th {
        padding: dt('datatable.header.cell.sm.padding');
    }

    .p-datatable.p-datatable-sm .p-datatable-tbody > tr > td {
        padding: dt('datatable.body.cell.sm.padding');
    }

    .p-datatable.p-datatable-sm .p-datatable-tfoot > tr > td {
        padding: dt('datatable.footer.cell.sm.padding');
    }

    .p-datatable.p-datatable-sm .p-datatable-footer {
        padding: dt('datatable.footer.sm.padding');
    }

    .p-datatable.p-datatable-lg .p-datatable-header {
        padding: dt('datatable.header.lg.padding');
    }

    .p-datatable.p-datatable-lg .p-datatable-thead > tr > th {
        padding: dt('datatable.header.cell.lg.padding');
    }

    .p-datatable.p-datatable-lg .p-datatable-tbody > tr > td {
        padding: dt('datatable.body.cell.lg.padding');
    }

    .p-datatable.p-datatable-lg .p-datatable-tfoot > tr > td {
        padding: dt('datatable.footer.cell.lg.padding');
    }

    .p-datatable.p-datatable-lg .p-datatable-footer {
        padding: dt('datatable.footer.lg.padding');
    }

    .p-datatable-row-toggle-button {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        overflow: hidden;
        position: relative;
        width: dt('datatable.row.toggle.button.size');
        height: dt('datatable.row.toggle.button.size');
        color: dt('datatable.row.toggle.button.color');
        border: 0 none;
        background: transparent;
        cursor: pointer;
        border-radius: dt('datatable.row.toggle.button.border.radius');
        transition:
            background dt('datatable.transition.duration'),
            color dt('datatable.transition.duration'),
            border-color dt('datatable.transition.duration'),
            outline-color dt('datatable.transition.duration'),
            box-shadow dt('datatable.transition.duration');
        outline-color: transparent;
        user-select: none;
    }

    .p-datatable-row-toggle-button:enabled:hover {
        color: dt('datatable.row.toggle.button.hover.color');
        background: dt('datatable.row.toggle.button.hover.background');
    }

    .p-datatable-tbody > tr.p-datatable-row-selected .p-datatable-row-toggle-button:hover {
        background: dt('datatable.row.toggle.button.selected.hover.background');
        color: dt('datatable.row.toggle.button.selected.hover.color');
    }

    .p-datatable-row-toggle-button:focus-visible {
        box-shadow: dt('datatable.row.toggle.button.focus.ring.shadow');
        outline: dt('datatable.row.toggle.button.focus.ring.width') dt('datatable.row.toggle.button.focus.ring.style') dt('datatable.row.toggle.button.focus.ring.color');
        outline-offset: dt('datatable.row.toggle.button.focus.ring.offset');
    }

    .p-datatable-row-toggle-icon:dir(rtl) {
        transform: rotate(180deg);
    }
`,Woe={root:function(e){var n=e.props;return["p-datatable p-component",{"p-datatable-hoverable":n.rowHover||n.selectionMode,"p-datatable-resizable":n.resizableColumns,"p-datatable-resizable-fit":n.resizableColumns&&n.columnResizeMode==="fit","p-datatable-scrollable":n.scrollable,"p-datatable-flex-scrollable":n.scrollable&&n.scrollHeight==="flex","p-datatable-striped":n.stripedRows,"p-datatable-gridlines":n.showGridlines,"p-datatable-sm":n.size==="small","p-datatable-lg":n.size==="large"}]},mask:"p-datatable-mask p-overlay-mask",loadingIcon:"p-datatable-loading-icon",header:"p-datatable-header",pcPaginator:function(e){var n=e.position;return"p-datatable-paginator-"+n},tableContainer:"p-datatable-table-container",table:function(e){var n=e.props;return["p-datatable-table",{"p-datatable-scrollable-table":n.scrollable,"p-datatable-resizable-table":n.resizableColumns,"p-datatable-resizable-table-fit":n.resizableColumns&&n.columnResizeMode==="fit"}]},thead:"p-datatable-thead",headerCell:function(e){var n=e.instance,l=e.props,d=e.column;return d&&!n.columnProp("hidden")&&(l.rowGroupMode!=="subheader"||l.groupRowsBy!==n.columnProp(d,"field"))?["p-datatable-header-cell",{"p-datatable-frozen-column":n.columnProp("frozen")}]:["p-datatable-header-cell",{"p-datatable-sortable-column":n.columnProp("sortable"),"p-datatable-resizable-column":n.resizableColumns,"p-datatable-column-sorted":n.isColumnSorted(),"p-datatable-frozen-column":n.columnProp("frozen"),"p-datatable-reorderable-column":l.reorderableColumns}]},columnResizer:"p-datatable-column-resizer",columnHeaderContent:"p-datatable-column-header-content",columnTitle:"p-datatable-column-title",columnFooter:"p-datatable-column-footer",sortIcon:"p-datatable-sort-icon",pcSortBadge:"p-datatable-sort-badge",filter:function(e){var n=e.props;return["p-datatable-filter",{"p-datatable-inline-filter":n.display==="row","p-datatable-popover-filter":n.display==="menu"}]},filterElementContainer:"p-datatable-filter-element-container",pcColumnFilterButton:"p-datatable-column-filter-button",pcColumnFilterClearButton:"p-datatable-column-filter-clear-button",filterOverlay:function(e){var n=e.props;return["p-datatable-filter-overlay p-component",{"p-datatable-filter-overlay-popover":n.display==="menu"}]},filterConstraintList:"p-datatable-filter-constraint-list",filterConstraint:function(e){var n=e.instance,l=e.matchMode;return["p-datatable-filter-constraint",{"p-datatable-filter-constraint-selected":l&&n.isRowMatchModeSelected(l.value)}]},filterConstraintSeparator:"p-datatable-filter-constraint-separator",filterOperator:"p-datatable-filter-operator",pcFilterOperatorDropdown:"p-datatable-filter-operator-dropdown",filterRuleList:"p-datatable-filter-rule-list",filterRule:"p-datatable-filter-rule",pcFilterConstraintDropdown:"p-datatable-filter-constraint-dropdown",pcFilterRemoveRuleButton:"p-datatable-filter-remove-rule-button",pcFilterAddRuleButton:"p-datatable-filter-add-rule-button",filterButtonbar:"p-datatable-filter-buttonbar",pcFilterClearButton:"p-datatable-filter-clear-button",pcFilterApplyButton:"p-datatable-filter-apply-button",tbody:function(e){var n=e.props;return n.frozenRow?"p-datatable-tbody p-datatable-frozen-tbody":"p-datatable-tbody"},rowGroupHeader:"p-datatable-row-group-header",rowToggleButton:"p-datatable-row-toggle-button",rowToggleIcon:"p-datatable-row-toggle-icon",row:function(e){var n=e.instance,l=e.props,d=e.index,f=e.columnSelectionMode,x=[];return l.selectionMode&&x.push("p-datatable-selectable-row"),l.selection&&x.push({"p-datatable-row-selected":f?n.isSelected&&n.$parentInstance.$parentInstance.highlightOnSelect:n.isSelected}),l.contextMenuSelection&&x.push({"p-datatable-contextmenu-row-selected":n.isSelectedWithContextMenu}),x.push(d%2===0?"p-row-even":"p-row-odd"),x},rowExpansion:"p-datatable-row-expansion",rowGroupFooter:"p-datatable-row-group-footer",emptyMessage:"p-datatable-empty-message",bodyCell:function(e){var n=e.instance;return[{"p-datatable-frozen-column":n.columnProp("frozen")}]},reorderableRowHandle:"p-datatable-reorderable-row-handle",pcRowEditorInit:"p-datatable-row-editor-init",pcRowEditorSave:"p-datatable-row-editor-save",pcRowEditorCancel:"p-datatable-row-editor-cancel",tfoot:"p-datatable-tfoot",footerCell:function(e){var n=e.instance;return[{"p-datatable-frozen-column":n.columnProp("frozen")}]},virtualScrollerSpacer:"p-datatable-virtualscroller-spacer",footer:"p-datatable-footer",columnResizeIndicator:"p-datatable-column-resize-indicator",rowReorderIndicatorUp:"p-datatable-row-reorder-indicator-up",rowReorderIndicatorDown:"p-datatable-row-reorder-indicator-down"},qoe={tableContainer:{overflow:"auto"},thead:{position:"sticky"},tfoot:{position:"sticky"}},Koe=xi.extend({name:"datatable",style:Hoe,classes:Woe,inlineStyles:qoe}),sP={name:"ChevronRightIcon",extends:go};function Zoe(t){return Qoe(t)||Joe(t)||Yoe(t)||Xoe()}function Xoe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Yoe(t,e){if(t){if(typeof t=="string")return nI(t,e);var n={}.toString.call(t).slice(8,-1);return n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set"?Array.from(t):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?nI(t,e):void 0}}function Joe(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function Qoe(t){if(Array.isArray(t))return nI(t)}function nI(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,l=Array(e);n<e;n++)l[n]=t[n];return l}function ese(t,e,n,l,d,f){return Me(),ft("svg",ot({width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},t.pti()),Zoe(e[0]||(e[0]=[Ze("path",{d:"M4.38708 13C4.28408 13.0005 4.18203 12.9804 4.08691 12.9409C3.99178 12.9014 3.9055 12.8433 3.83313 12.7701C3.68634 12.6231 3.60388 12.4238 3.60388 12.2161C3.60388 12.0084 3.68634 11.8091 3.83313 11.6622L8.50507 6.99022L3.83313 2.31827C3.69467 2.16968 3.61928 1.97313 3.62287 1.77005C3.62645 1.56698 3.70872 1.37322 3.85234 1.22959C3.99596 1.08597 4.18972 1.00371 4.3928 1.00012C4.59588 0.996539 4.79242 1.07192 4.94102 1.21039L10.1669 6.43628C10.3137 6.58325 10.3962 6.78249 10.3962 6.99022C10.3962 7.19795 10.3137 7.39718 10.1669 7.54416L4.94102 12.7701C4.86865 12.8433 4.78237 12.9014 4.68724 12.9409C4.59212 12.9804 4.49007 13.0005 4.38708 13Z",fill:"currentColor"},null,-1)])),16)}sP.render=ese;var FN={name:"BarsIcon",extends:go};function tse(t){return ose(t)||ise(t)||rse(t)||nse()}function nse(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function rse(t,e){if(t){if(typeof t=="string")return rI(t,e);var n={}.toString.call(t).slice(8,-1);return n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set"?Array.from(t):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?rI(t,e):void 0}}function ise(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function ose(t){if(Array.isArray(t))return rI(t)}function rI(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,l=Array(e);n<e;n++)l[n]=t[n];return l}function sse(t,e,n,l,d,f){return Me(),ft("svg",ot({width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},t.pti()),tse(e[0]||(e[0]=[Ze("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M13.3226 3.6129H0.677419C0.497757 3.6129 0.325452 3.54152 0.198411 3.41448C0.0713707 3.28744 0 3.11514 0 2.93548C0 2.75581 0.0713707 2.58351 0.198411 2.45647C0.325452 2.32943 0.497757 2.25806 0.677419 2.25806H13.3226C13.5022 2.25806 13.6745 2.32943 13.8016 2.45647C13.9286 2.58351 14 2.75581 14 2.93548C14 3.11514 13.9286 3.28744 13.8016 3.41448C13.6745 3.54152 13.5022 3.6129 13.3226 3.6129ZM13.3226 7.67741H0.677419C0.497757 7.67741 0.325452 7.60604 0.198411 7.479C0.0713707 7.35196 0 7.17965 0 6.99999C0 6.82033 0.0713707 6.64802 0.198411 6.52098C0.325452 6.39394 0.497757 6.32257 0.677419 6.32257H13.3226C13.5022 6.32257 13.6745 6.39394 13.8016 6.52098C13.9286 6.64802 14 6.82033 14 6.99999C14 7.17965 13.9286 7.35196 13.8016 7.479C13.6745 7.60604 13.5022 7.67741 13.3226 7.67741ZM0.677419 11.7419H13.3226C13.5022 11.7419 13.6745 11.6706 13.8016 11.5435C13.9286 11.4165 14 11.2442 14 11.0645C14 10.8848 13.9286 10.7125 13.8016 10.5855C13.6745 10.4585 13.5022 10.3871 13.3226 10.3871H0.677419C0.497757 10.3871 0.325452 10.4585 0.198411 10.5855C0.0713707 10.7125 0 10.8848 0 11.0645C0 11.2442 0.0713707 11.4165 0.198411 11.5435C0.325452 11.6706 0.497757 11.7419 0.677419 11.7419Z",fill:"currentColor"},null,-1)])),16)}FN.render=sse;var BN={name:"PencilIcon",extends:go};function ase(t){return dse(t)||use(t)||cse(t)||lse()}function lse(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function cse(t,e){if(t){if(typeof t=="string")return iI(t,e);var n={}.toString.call(t).slice(8,-1);return n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set"?Array.from(t):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?iI(t,e):void 0}}function use(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function dse(t){if(Array.isArray(t))return iI(t)}function iI(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,l=Array(e);n<e;n++)l[n]=t[n];return l}function hse(t,e,n,l,d,f){return Me(),ft("svg",ot({width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},t.pti()),ase(e[0]||(e[0]=[Ze("path",{d:"M0.609628 13.959C0.530658 13.9599 0.452305 13.9451 0.379077 13.9156C0.305849 13.8861 0.239191 13.8424 0.18294 13.787C0.118447 13.7234 0.0688234 13.6464 0.0376166 13.5614C0.00640987 13.4765 -0.00560954 13.3857 0.00241768 13.2956L0.25679 10.1501C0.267698 10.0041 0.331934 9.86709 0.437312 9.76516L9.51265 0.705715C10.0183 0.233014 10.6911 -0.0203041 11.3835 0.00127367C12.0714 0.00660201 12.7315 0.27311 13.2298 0.746671C13.7076 1.23651 13.9824 1.88848 13.9992 2.57201C14.0159 3.25554 13.7733 3.92015 13.32 4.4327L4.23648 13.5331C4.13482 13.6342 4.0017 13.6978 3.85903 13.7133L0.667067 14L0.609628 13.959ZM1.43018 10.4696L1.25787 12.714L3.50619 12.5092L12.4502 3.56444C12.6246 3.35841 12.7361 3.10674 12.7714 2.83933C12.8067 2.57193 12.7644 2.30002 12.6495 2.05591C12.5346 1.8118 12.3519 1.60575 12.1231 1.46224C11.8943 1.31873 11.6291 1.2438 11.3589 1.24633C11.1813 1.23508 11.0033 1.25975 10.8355 1.31887C10.6677 1.37798 10.5136 1.47033 10.3824 1.59036L1.43018 10.4696Z",fill:"currentColor"},null,-1)])),16)}BN.render=hse;var NN={name:"MinusIcon",extends:go};function fse(t){return _se(t)||gse(t)||mse(t)||pse()}function pse(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function mse(t,e){if(t){if(typeof t=="string")return oI(t,e);var n={}.toString.call(t).slice(8,-1);return n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set"?Array.from(t):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?oI(t,e):void 0}}function gse(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function _se(t){if(Array.isArray(t))return oI(t)}function oI(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,l=Array(e);n<e;n++)l[n]=t[n];return l}function yse(t,e,n,l,d,f){return Me(),ft("svg",ot({width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},t.pti()),fse(e[0]||(e[0]=[Ze("path",{d:"M13.2222 7.77778H0.777778C0.571498 7.77778 0.373667 7.69584 0.227806 7.54998C0.0819442 7.40412 0 7.20629 0 7.00001C0 6.79373 0.0819442 6.5959 0.227806 6.45003C0.373667 6.30417 0.571498 6.22223 0.777778 6.22223H13.2222C13.4285 6.22223 13.6263 6.30417 13.7722 6.45003C13.9181 6.5959 14 6.79373 14 7.00001C14 7.20629 13.9181 7.40412 13.7722 7.54998C13.6263 7.69584 13.4285 7.77778 13.2222 7.77778Z",fill:"currentColor"},null,-1)])),16)}NN.render=yse;var vse=`
    .p-checkbox {
        position: relative;
        display: inline-flex;
        user-select: none;
        vertical-align: bottom;
        width: dt('checkbox.width');
        height: dt('checkbox.height');
    }

    .p-checkbox-input {
        cursor: pointer;
        appearance: none;
        position: absolute;
        inset-block-start: 0;
        inset-inline-start: 0;
        width: 100%;
        height: 100%;
        padding: 0;
        margin: 0;
        opacity: 0;
        z-index: 1;
        outline: 0 none;
        border: 1px solid transparent;
        border-radius: dt('checkbox.border.radius');
    }

    .p-checkbox-box {
        display: flex;
        justify-content: center;
        align-items: center;
        border-radius: dt('checkbox.border.radius');
        border: 1px solid dt('checkbox.border.color');
        background: dt('checkbox.background');
        width: dt('checkbox.width');
        height: dt('checkbox.height');
        transition:
            background dt('checkbox.transition.duration'),
            color dt('checkbox.transition.duration'),
            border-color dt('checkbox.transition.duration'),
            box-shadow dt('checkbox.transition.duration'),
            outline-color dt('checkbox.transition.duration');
        outline-color: transparent;
        box-shadow: dt('checkbox.shadow');
    }

    .p-checkbox-icon {
        transition-duration: dt('checkbox.transition.duration');
        color: dt('checkbox.icon.color');
        font-size: dt('checkbox.icon.size');
        width: dt('checkbox.icon.size');
        height: dt('checkbox.icon.size');
    }

    .p-checkbox:not(.p-disabled):has(.p-checkbox-input:hover) .p-checkbox-box {
        border-color: dt('checkbox.hover.border.color');
    }

    .p-checkbox-checked .p-checkbox-box {
        border-color: dt('checkbox.checked.border.color');
        background: dt('checkbox.checked.background');
    }

    .p-checkbox-checked .p-checkbox-icon {
        color: dt('checkbox.icon.checked.color');
    }

    .p-checkbox-checked:not(.p-disabled):has(.p-checkbox-input:hover) .p-checkbox-box {
        background: dt('checkbox.checked.hover.background');
        border-color: dt('checkbox.checked.hover.border.color');
    }

    .p-checkbox-checked:not(.p-disabled):has(.p-checkbox-input:hover) .p-checkbox-icon {
        color: dt('checkbox.icon.checked.hover.color');
    }

    .p-checkbox:not(.p-disabled):has(.p-checkbox-input:focus-visible) .p-checkbox-box {
        border-color: dt('checkbox.focus.border.color');
        box-shadow: dt('checkbox.focus.ring.shadow');
        outline: dt('checkbox.focus.ring.width') dt('checkbox.focus.ring.style') dt('checkbox.focus.ring.color');
        outline-offset: dt('checkbox.focus.ring.offset');
    }

    .p-checkbox-checked:not(.p-disabled):has(.p-checkbox-input:focus-visible) .p-checkbox-box {
        border-color: dt('checkbox.checked.focus.border.color');
    }

    .p-checkbox.p-invalid > .p-checkbox-box {
        border-color: dt('checkbox.invalid.border.color');
    }

    .p-checkbox.p-variant-filled .p-checkbox-box {
        background: dt('checkbox.filled.background');
    }

    .p-checkbox-checked.p-variant-filled .p-checkbox-box {
        background: dt('checkbox.checked.background');
    }

    .p-checkbox-checked.p-variant-filled:not(.p-disabled):has(.p-checkbox-input:hover) .p-checkbox-box {
        background: dt('checkbox.checked.hover.background');
    }

    .p-checkbox.p-disabled {
        opacity: 1;
    }

    .p-checkbox.p-disabled .p-checkbox-box {
        background: dt('checkbox.disabled.background');
        border-color: dt('checkbox.checked.disabled.border.color');
    }

    .p-checkbox.p-disabled .p-checkbox-box .p-checkbox-icon {
        color: dt('checkbox.icon.disabled.color');
    }

    .p-checkbox-sm,
    .p-checkbox-sm .p-checkbox-box {
        width: dt('checkbox.sm.width');
        height: dt('checkbox.sm.height');
    }

    .p-checkbox-sm .p-checkbox-icon {
        font-size: dt('checkbox.icon.sm.size');
        width: dt('checkbox.icon.sm.size');
        height: dt('checkbox.icon.sm.size');
    }

    .p-checkbox-lg,
    .p-checkbox-lg .p-checkbox-box {
        width: dt('checkbox.lg.width');
        height: dt('checkbox.lg.height');
    }

    .p-checkbox-lg .p-checkbox-icon {
        font-size: dt('checkbox.icon.lg.size');
        width: dt('checkbox.icon.lg.size');
        height: dt('checkbox.icon.lg.size');
    }
`,bse={root:function(e){var n=e.instance,l=e.props;return["p-checkbox p-component",{"p-checkbox-checked":n.checked,"p-disabled":l.disabled,"p-invalid":n.$pcCheckboxGroup?n.$pcCheckboxGroup.$invalid:n.$invalid,"p-variant-filled":n.$variant==="filled","p-checkbox-sm p-inputfield-sm":l.size==="small","p-checkbox-lg p-inputfield-lg":l.size==="large"}]},box:"p-checkbox-box",input:"p-checkbox-input",icon:"p-checkbox-icon"},xse=xi.extend({name:"checkbox",style:vse,classes:bse}),wse={name:"BaseCheckbox",extends:ub,props:{value:null,binary:Boolean,indeterminate:{type:Boolean,default:!1},trueValue:{type:null,default:!0},falseValue:{type:null,default:!1},readonly:{type:Boolean,default:!1},required:{type:Boolean,default:!1},tabindex:{type:Number,default:null},inputId:{type:String,default:null},inputClass:{type:[String,Object],default:null},inputStyle:{type:Object,default:null},ariaLabelledby:{type:String,default:null},ariaLabel:{type:String,default:null}},style:xse,provide:function(){return{$pcCheckbox:this,$parentInstance:this}}};function T0(t){"@babel/helpers - typeof";return T0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},T0(t)}function Tse(t,e,n){return(e=Sse(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Sse(t){var e=Ese(t,"string");return T0(e)=="symbol"?e:e+""}function Ese(t,e){if(T0(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var l=n.call(t,e);if(T0(l)!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Cse(t){return Rse(t)||Pse(t)||Ase(t)||Ise()}function Ise(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ase(t,e){if(t){if(typeof t=="string")return sI(t,e);var n={}.toString.call(t).slice(8,-1);return n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set"?Array.from(t):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?sI(t,e):void 0}}function Pse(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function Rse(t){if(Array.isArray(t))return sI(t)}function sI(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,l=Array(e);n<e;n++)l[n]=t[n];return l}var aP={name:"Checkbox",extends:wse,inheritAttrs:!1,emits:["change","focus","blur","update:indeterminate"],inject:{$pcCheckboxGroup:{default:void 0}},data:function(){return{d_indeterminate:this.indeterminate}},watch:{indeterminate:function(e){this.d_indeterminate=e,this.updateIndeterminate()}},mounted:function(){this.updateIndeterminate()},updated:function(){this.updateIndeterminate()},methods:{getPTOptions:function(e){var n=e==="root"?this.ptmi:this.ptm;return n(e,{context:{checked:this.checked,indeterminate:this.d_indeterminate,disabled:this.disabled}})},onChange:function(e){var n=this;if(!this.disabled&&!this.readonly){var l=this.$pcCheckboxGroup?this.$pcCheckboxGroup.d_value:this.d_value,d;this.binary?d=this.d_indeterminate?this.trueValue:this.checked?this.falseValue:this.trueValue:this.checked||this.d_indeterminate?d=l.filter(function(f){return!Pp(f,n.value)}):d=l?[].concat(Cse(l),[this.value]):[this.value],this.d_indeterminate&&(this.d_indeterminate=!1,this.$emit("update:indeterminate",this.d_indeterminate)),this.$pcCheckboxGroup?this.$pcCheckboxGroup.writeValue(d,e):this.writeValue(d,e),this.$emit("change",e)}},onFocus:function(e){this.$emit("focus",e)},onBlur:function(e){var n,l;this.$emit("blur",e),(n=(l=this.formField).onBlur)===null||n===void 0||n.call(l,e)},updateIndeterminate:function(){this.$refs.input&&(this.$refs.input.indeterminate=this.d_indeterminate)}},computed:{groupName:function(){return this.$pcCheckboxGroup?this.$pcCheckboxGroup.groupName:this.$formName},checked:function(){var e=this.$pcCheckboxGroup?this.$pcCheckboxGroup.d_value:this.d_value;return this.d_indeterminate?!1:this.binary?e===this.trueValue:ree(this.value,e)},dataP:function(){return Rs(Tse({invalid:this.$invalid,checked:this.checked,disabled:this.disabled,filled:this.$variant==="filled"},this.size,this.size))}},components:{CheckIcon:s_,MinusIcon:NN}},kse=["data-p-checked","data-p-indeterminate","data-p-disabled","data-p"],Ose=["id","value","name","checked","tabindex","disabled","readonly","required","aria-labelledby","aria-label","aria-invalid"],Mse=["data-p"];function Dse(t,e,n,l,d,f){var x=_r("CheckIcon"),s=_r("MinusIcon");return Me(),ft("div",ot({class:t.cx("root")},f.getPTOptions("root"),{"data-p-checked":f.checked,"data-p-indeterminate":d.d_indeterminate||void 0,"data-p-disabled":t.disabled,"data-p":f.dataP}),[Ze("input",ot({ref:"input",id:t.inputId,type:"checkbox",class:[t.cx("input"),t.inputClass],style:t.inputStyle,value:t.value,name:f.groupName,checked:f.checked,tabindex:t.tabindex,disabled:t.disabled,readonly:t.readonly,required:t.required,"aria-labelledby":t.ariaLabelledby,"aria-label":t.ariaLabel,"aria-invalid":t.invalid||void 0,onFocus:e[0]||(e[0]=function(){return f.onFocus&&f.onFocus.apply(f,arguments)}),onBlur:e[1]||(e[1]=function(){return f.onBlur&&f.onBlur.apply(f,arguments)}),onChange:e[2]||(e[2]=function(){return f.onChange&&f.onChange.apply(f,arguments)})},f.getPTOptions("input")),null,16,Ose),Ze("div",ot({class:t.cx("box")},f.getPTOptions("box"),{"data-p":f.dataP}),[ir(t.$slots,"icon",{checked:f.checked,indeterminate:d.d_indeterminate,class:wr(t.cx("icon")),dataP:f.dataP},function(){return[f.checked?(Me(),rn(x,ot({key:0,class:t.cx("icon")},f.getPTOptions("icon"),{"data-p":f.dataP}),null,16,["class","data-p"])):d.d_indeterminate?(Me(),rn(s,ot({key:1,class:t.cx("icon")},f.getPTOptions("icon"),{"data-p":f.dataP}),null,16,["class","data-p"])):Pn("",!0)]})],16,Mse)],16,kse)}aP.render=Dse;var Lse=`
    .p-radiobutton {
        position: relative;
        display: inline-flex;
        user-select: none;
        vertical-align: bottom;
        width: dt('radiobutton.width');
        height: dt('radiobutton.height');
    }

    .p-radiobutton-input {
        cursor: pointer;
        appearance: none;
        position: absolute;
        top: 0;
        inset-inline-start: 0;
        width: 100%;
        height: 100%;
        padding: 0;
        margin: 0;
        opacity: 0;
        z-index: 1;
        outline: 0 none;
        border: 1px solid transparent;
        border-radius: 50%;
    }

    .p-radiobutton-box {
        display: flex;
        justify-content: center;
        align-items: center;
        border-radius: 50%;
        border: 1px solid dt('radiobutton.border.color');
        background: dt('radiobutton.background');
        width: dt('radiobutton.width');
        height: dt('radiobutton.height');
        transition:
            background dt('radiobutton.transition.duration'),
            color dt('radiobutton.transition.duration'),
            border-color dt('radiobutton.transition.duration'),
            box-shadow dt('radiobutton.transition.duration'),
            outline-color dt('radiobutton.transition.duration');
        outline-color: transparent;
        box-shadow: dt('radiobutton.shadow');
    }

    .p-radiobutton-icon {
        transition-duration: dt('radiobutton.transition.duration');
        background: transparent;
        font-size: dt('radiobutton.icon.size');
        width: dt('radiobutton.icon.size');
        height: dt('radiobutton.icon.size');
        border-radius: 50%;
        backface-visibility: hidden;
        transform: translateZ(0) scale(0.1);
    }

    .p-radiobutton:not(.p-disabled):has(.p-radiobutton-input:hover) .p-radiobutton-box {
        border-color: dt('radiobutton.hover.border.color');
    }

    .p-radiobutton-checked .p-radiobutton-box {
        border-color: dt('radiobutton.checked.border.color');
        background: dt('radiobutton.checked.background');
    }

    .p-radiobutton-checked .p-radiobutton-box .p-radiobutton-icon {
        background: dt('radiobutton.icon.checked.color');
        transform: translateZ(0) scale(1, 1);
        visibility: visible;
    }

    .p-radiobutton-checked:not(.p-disabled):has(.p-radiobutton-input:hover) .p-radiobutton-box {
        border-color: dt('radiobutton.checked.hover.border.color');
        background: dt('radiobutton.checked.hover.background');
    }

    .p-radiobutton:not(.p-disabled):has(.p-radiobutton-input:hover).p-radiobutton-checked .p-radiobutton-box .p-radiobutton-icon {
        background: dt('radiobutton.icon.checked.hover.color');
    }

    .p-radiobutton:not(.p-disabled):has(.p-radiobutton-input:focus-visible) .p-radiobutton-box {
        border-color: dt('radiobutton.focus.border.color');
        box-shadow: dt('radiobutton.focus.ring.shadow');
        outline: dt('radiobutton.focus.ring.width') dt('radiobutton.focus.ring.style') dt('radiobutton.focus.ring.color');
        outline-offset: dt('radiobutton.focus.ring.offset');
    }

    .p-radiobutton-checked:not(.p-disabled):has(.p-radiobutton-input:focus-visible) .p-radiobutton-box {
        border-color: dt('radiobutton.checked.focus.border.color');
    }

    .p-radiobutton.p-invalid > .p-radiobutton-box {
        border-color: dt('radiobutton.invalid.border.color');
    }

    .p-radiobutton.p-variant-filled .p-radiobutton-box {
        background: dt('radiobutton.filled.background');
    }

    .p-radiobutton.p-variant-filled.p-radiobutton-checked .p-radiobutton-box {
        background: dt('radiobutton.checked.background');
    }

    .p-radiobutton.p-variant-filled:not(.p-disabled):has(.p-radiobutton-input:hover).p-radiobutton-checked .p-radiobutton-box {
        background: dt('radiobutton.checked.hover.background');
    }

    .p-radiobutton.p-disabled {
        opacity: 1;
    }

    .p-radiobutton.p-disabled .p-radiobutton-box {
        background: dt('radiobutton.disabled.background');
        border-color: dt('radiobutton.checked.disabled.border.color');
    }

    .p-radiobutton-checked.p-disabled .p-radiobutton-box .p-radiobutton-icon {
        background: dt('radiobutton.icon.disabled.color');
    }

    .p-radiobutton-sm,
    .p-radiobutton-sm .p-radiobutton-box {
        width: dt('radiobutton.sm.width');
        height: dt('radiobutton.sm.height');
    }

    .p-radiobutton-sm .p-radiobutton-icon {
        font-size: dt('radiobutton.icon.sm.size');
        width: dt('radiobutton.icon.sm.size');
        height: dt('radiobutton.icon.sm.size');
    }

    .p-radiobutton-lg,
    .p-radiobutton-lg .p-radiobutton-box {
        width: dt('radiobutton.lg.width');
        height: dt('radiobutton.lg.height');
    }

    .p-radiobutton-lg .p-radiobutton-icon {
        font-size: dt('radiobutton.icon.lg.size');
        width: dt('radiobutton.icon.lg.size');
        height: dt('radiobutton.icon.lg.size');
    }
`,zse={root:function(e){var n=e.instance,l=e.props;return["p-radiobutton p-component",{"p-radiobutton-checked":n.checked,"p-disabled":l.disabled,"p-invalid":n.$pcRadioButtonGroup?n.$pcRadioButtonGroup.$invalid:n.$invalid,"p-variant-filled":n.$variant==="filled","p-radiobutton-sm p-inputfield-sm":l.size==="small","p-radiobutton-lg p-inputfield-lg":l.size==="large"}]},box:"p-radiobutton-box",input:"p-radiobutton-input",icon:"p-radiobutton-icon"},Fse=xi.extend({name:"radiobutton",style:Lse,classes:zse}),Bse={name:"BaseRadioButton",extends:ub,props:{value:null,binary:Boolean,readonly:{type:Boolean,default:!1},tabindex:{type:Number,default:null},inputId:{type:String,default:null},inputClass:{type:[String,Object],default:null},inputStyle:{type:Object,default:null},ariaLabelledby:{type:String,default:null},ariaLabel:{type:String,default:null}},style:Fse,provide:function(){return{$pcRadioButton:this,$parentInstance:this}}};function S0(t){"@babel/helpers - typeof";return S0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},S0(t)}function Nse(t,e,n){return(e=Vse(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Vse(t){var e=$se(t,"string");return S0(e)=="symbol"?e:e+""}function $se(t,e){if(S0(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var l=n.call(t,e);if(S0(l)!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var VN={name:"RadioButton",extends:Bse,inheritAttrs:!1,emits:["change","focus","blur"],inject:{$pcRadioButtonGroup:{default:void 0}},methods:{getPTOptions:function(e){var n=e==="root"?this.ptmi:this.ptm;return n(e,{context:{checked:this.checked,disabled:this.disabled}})},onChange:function(e){if(!this.disabled&&!this.readonly){var n=this.binary?!this.checked:this.value;this.$pcRadioButtonGroup?this.$pcRadioButtonGroup.writeValue(n,e):this.writeValue(n,e),this.$emit("change",e)}},onFocus:function(e){this.$emit("focus",e)},onBlur:function(e){var n,l;this.$emit("blur",e),(n=(l=this.formField).onBlur)===null||n===void 0||n.call(l,e)}},computed:{groupName:function(){return this.$pcRadioButtonGroup?this.$pcRadioButtonGroup.groupName:this.$formName},checked:function(){var e=this.$pcRadioButtonGroup?this.$pcRadioButtonGroup.d_value:this.d_value;return e!=null&&(this.binary?!!e:Pp(e,this.value))},dataP:function(){return Rs(Nse({invalid:this.$invalid,checked:this.checked,disabled:this.disabled,filled:this.$variant==="filled"},this.size,this.size))}}},Use=["data-p-checked","data-p-disabled","data-p"],jse=["id","value","name","checked","tabindex","disabled","readonly","aria-labelledby","aria-label","aria-invalid"],Gse=["data-p"],Hse=["data-p"];function Wse(t,e,n,l,d,f){return Me(),ft("div",ot({class:t.cx("root")},f.getPTOptions("root"),{"data-p-checked":f.checked,"data-p-disabled":t.disabled,"data-p":f.dataP}),[Ze("input",ot({id:t.inputId,type:"radio",class:[t.cx("input"),t.inputClass],style:t.inputStyle,value:t.value,name:f.groupName,checked:f.checked,tabindex:t.tabindex,disabled:t.disabled,readonly:t.readonly,"aria-labelledby":t.ariaLabelledby,"aria-label":t.ariaLabel,"aria-invalid":t.invalid||void 0,onFocus:e[0]||(e[0]=function(){return f.onFocus&&f.onFocus.apply(f,arguments)}),onBlur:e[1]||(e[1]=function(){return f.onBlur&&f.onBlur.apply(f,arguments)}),onChange:e[2]||(e[2]=function(){return f.onChange&&f.onChange.apply(f,arguments)})},f.getPTOptions("input")),null,16,jse),Ze("div",ot({class:t.cx("box")},f.getPTOptions("box"),{"data-p":f.dataP}),[Ze("div",ot({class:t.cx("icon")},f.getPTOptions("icon"),{"data-p":f.dataP}),null,16,Hse)],16,Gse)],16,Use)}VN.render=Wse;var $N={name:"FilterIcon",extends:go};function qse(t){return Yse(t)||Xse(t)||Zse(t)||Kse()}function Kse(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Zse(t,e){if(t){if(typeof t=="string")return aI(t,e);var n={}.toString.call(t).slice(8,-1);return n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set"?Array.from(t):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?aI(t,e):void 0}}function Xse(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function Yse(t){if(Array.isArray(t))return aI(t)}function aI(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,l=Array(e);n<e;n++)l[n]=t[n];return l}function Jse(t,e,n,l,d,f){return Me(),ft("svg",ot({width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},t.pti()),qse(e[0]||(e[0]=[Ze("path",{d:"M8.64708 14H5.35296C5.18981 13.9979 5.03395 13.9321 4.91858 13.8167C4.8032 13.7014 4.73745 13.5455 4.73531 13.3824V7L0.329431 0.98C0.259794 0.889466 0.217389 0.780968 0.20718 0.667208C0.19697 0.553448 0.219379 0.439133 0.271783 0.337647C0.324282 0.236453 0.403423 0.151519 0.500663 0.0920138C0.597903 0.0325088 0.709548 0.000692754 0.823548 0H13.1765C13.2905 0.000692754 13.4021 0.0325088 13.4994 0.0920138C13.5966 0.151519 13.6758 0.236453 13.7283 0.337647C13.7807 0.439133 13.8031 0.553448 13.7929 0.667208C13.7826 0.780968 13.7402 0.889466 13.6706 0.98L9.26472 7V13.3824C9.26259 13.5455 9.19683 13.7014 9.08146 13.8167C8.96609 13.9321 8.81022 13.9979 8.64708 14ZM5.97061 12.7647H8.02943V6.79412C8.02878 6.66289 8.07229 6.53527 8.15296 6.43177L11.9412 1.23529H2.05884L5.86355 6.43177C5.94422 6.53527 5.98773 6.66289 5.98708 6.79412L5.97061 12.7647Z",fill:"currentColor"},null,-1)])),16)}$N.render=Jse;var UN={name:"FilterFillIcon",extends:go};function Qse(t){return rae(t)||nae(t)||tae(t)||eae()}function eae(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function tae(t,e){if(t){if(typeof t=="string")return lI(t,e);var n={}.toString.call(t).slice(8,-1);return n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set"?Array.from(t):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?lI(t,e):void 0}}function nae(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function rae(t){if(Array.isArray(t))return lI(t)}function lI(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,l=Array(e);n<e;n++)l[n]=t[n];return l}function iae(t,e,n,l,d,f){return Me(),ft("svg",ot({width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},t.pti()),Qse(e[0]||(e[0]=[Ze("path",{d:"M13.7274 0.33847C13.6228 0.130941 13.4095 0 13.1764 0H0.82351C0.590451 0 0.377157 0.130941 0.272568 0.33847C0.167157 0.545999 0.187746 0.795529 0.325275 0.98247L4.73527 6.99588V13.3824C4.73527 13.7233 5.01198 14 5.35292 14H8.64704C8.98798 14 9.26469 13.7233 9.26469 13.3824V6.99588L13.6747 0.98247C13.8122 0.795529 13.8328 0.545999 13.7274 0.33847Z",fill:"currentColor"},null,-1)])),16)}UN.render=iae;var jN={name:"FilterSlashIcon",extends:go};function oae(t){return cae(t)||lae(t)||aae(t)||sae()}function sae(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function aae(t,e){if(t){if(typeof t=="string")return cI(t,e);var n={}.toString.call(t).slice(8,-1);return n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set"?Array.from(t):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?cI(t,e):void 0}}function lae(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function cae(t){if(Array.isArray(t))return cI(t)}function cI(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,l=Array(e);n<e;n++)l[n]=t[n];return l}function uae(t,e,n,l,d,f){return Me(),ft("svg",ot({width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},t.pti()),oae(e[0]||(e[0]=[Ze("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M13.4994 0.0920138C13.5967 0.151519 13.6758 0.236453 13.7283 0.337647C13.7807 0.439133 13.8031 0.553448 13.7929 0.667208C13.7827 0.780968 13.7403 0.889466 13.6707 0.98L11.406 4.06823C11.3099 4.19928 11.1656 4.28679 11.005 4.3115C10.8444 4.33621 10.6805 4.2961 10.5495 4.2C10.4184 4.1039 10.3309 3.95967 10.3062 3.79905C10.2815 3.63843 10.3216 3.47458 10.4177 3.34353L11.9412 1.23529H7.41184C7.24803 1.23529 7.09093 1.17022 6.97509 1.05439C6.85926 0.938558 6.79419 0.781457 6.79419 0.617647C6.79419 0.453837 6.85926 0.296736 6.97509 0.180905C7.09093 0.0650733 7.24803 0 7.41184 0H13.1765C13.2905 0.000692754 13.4022 0.0325088 13.4994 0.0920138ZM4.20008 0.181168H4.24126L13.2013 9.03411C13.3169 9.14992 13.3819 9.3069 13.3819 9.47058C13.3819 9.63426 13.3169 9.79124 13.2013 9.90705C13.1445 9.96517 13.0766 10.0112 13.0016 10.0423C12.9266 10.0735 12.846 10.0891 12.7648 10.0882C12.6836 10.0886 12.6032 10.0728 12.5283 10.0417C12.4533 10.0106 12.3853 9.96479 12.3283 9.90705L9.3142 6.92587L9.26479 6.99999V13.3823C9.26265 13.5455 9.19689 13.7014 9.08152 13.8167C8.96615 13.9321 8.81029 13.9979 8.64714 14H5.35302C5.18987 13.9979 5.03401 13.9321 4.91864 13.8167C4.80327 13.7014 4.73751 13.5455 4.73537 13.3823V6.99999L0.329492 1.02117C0.259855 0.930634 0.21745 0.822137 0.207241 0.708376C0.197031 0.594616 0.21944 0.480301 0.271844 0.378815C0.324343 0.277621 0.403484 0.192687 0.500724 0.133182C0.597964 0.073677 0.709609 0.041861 0.823609 0.0411682H3.86243C3.92448 0.0461551 3.9855 0.060022 4.04361 0.0823446C4.10037 0.10735 4.15311 0.140655 4.20008 0.181168ZM8.02949 6.79411C8.02884 6.66289 8.07235 6.53526 8.15302 6.43176L8.42478 6.05293L3.55773 1.23529H2.0589L5.84714 6.43176C5.92781 6.53526 5.97132 6.66289 5.97067 6.79411V12.7647H8.02949V6.79411Z",fill:"currentColor"},null,-1)])),16)}jN.render=uae;var GN={name:"PlusIcon",extends:go};function dae(t){return mae(t)||pae(t)||fae(t)||hae()}function hae(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function fae(t,e){if(t){if(typeof t=="string")return uI(t,e);var n={}.toString.call(t).slice(8,-1);return n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set"?Array.from(t):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?uI(t,e):void 0}}function pae(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function mae(t){if(Array.isArray(t))return uI(t)}function uI(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,l=Array(e);n<e;n++)l[n]=t[n];return l}function gae(t,e,n,l,d,f){return Me(),ft("svg",ot({width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},t.pti()),dae(e[0]||(e[0]=[Ze("path",{d:"M7.67742 6.32258V0.677419C7.67742 0.497757 7.60605 0.325452 7.47901 0.198411C7.35197 0.0713707 7.17966 0 7 0C6.82034 0 6.64803 0.0713707 6.52099 0.198411C6.39395 0.325452 6.32258 0.497757 6.32258 0.677419V6.32258H0.677419C0.497757 6.32258 0.325452 6.39395 0.198411 6.52099C0.0713707 6.64803 0 6.82034 0 7C0 7.17966 0.0713707 7.35197 0.198411 7.47901C0.325452 7.60605 0.497757 7.67742 0.677419 7.67742H6.32258V13.3226C6.32492 13.5015 6.39704 13.6725 6.52358 13.799C6.65012 13.9255 6.82106 13.9977 7 14C7.17966 14 7.35197 13.9286 7.47901 13.8016C7.60605 13.6745 7.67742 13.5022 7.67742 13.3226V7.67742H13.3226C13.5022 7.67742 13.6745 7.60605 13.8016 7.47901C13.9286 7.35197 14 7.17966 14 7C13.9977 6.82106 13.9255 6.65012 13.799 6.52358C13.6725 6.39704 13.5015 6.32492 13.3226 6.32258H7.67742Z",fill:"currentColor"},null,-1)])),16)}GN.render=gae;var HN={name:"TrashIcon",extends:go};function _ae(t){return xae(t)||bae(t)||vae(t)||yae()}function yae(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function vae(t,e){if(t){if(typeof t=="string")return dI(t,e);var n={}.toString.call(t).slice(8,-1);return n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set"?Array.from(t):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?dI(t,e):void 0}}function bae(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function xae(t){if(Array.isArray(t))return dI(t)}function dI(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,l=Array(e);n<e;n++)l[n]=t[n];return l}function wae(t,e,n,l,d,f){return Me(),ft("svg",ot({width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},t.pti()),_ae(e[0]||(e[0]=[Ze("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M3.44802 13.9955H10.552C10.8056 14.0129 11.06 13.9797 11.3006 13.898C11.5412 13.8163 11.7632 13.6877 11.9537 13.5196C12.1442 13.3515 12.2995 13.1473 12.4104 12.9188C12.5213 12.6903 12.5858 12.442 12.6 12.1884V4.36041H13.4C13.5591 4.36041 13.7117 4.29722 13.8243 4.18476C13.9368 4.07229 14 3.91976 14 3.76071C14 3.60166 13.9368 3.44912 13.8243 3.33666C13.7117 3.22419 13.5591 3.16101 13.4 3.16101H12.0537C12.0203 3.1557 11.9863 3.15299 11.952 3.15299C11.9178 3.15299 11.8838 3.1557 11.8503 3.16101H11.2285C11.2421 3.10893 11.2487 3.05513 11.248 3.00106V1.80966C11.2171 1.30262 10.9871 0.828306 10.608 0.48989C10.229 0.151475 9.73159 -0.0236625 9.22402 0.00257442H4.77602C4.27251 -0.0171866 3.78126 0.160868 3.40746 0.498617C3.03365 0.836366 2.807 1.30697 2.77602 1.80966V3.00106C2.77602 3.0556 2.78346 3.10936 2.79776 3.16101H0.6C0.521207 3.16101 0.443185 3.17652 0.37039 3.20666C0.297595 3.2368 0.231451 3.28097 0.175736 3.33666C0.120021 3.39235 0.0758251 3.45846 0.0456722 3.53121C0.0155194 3.60397 0 3.68196 0 3.76071C0 3.83946 0.0155194 3.91744 0.0456722 3.9902C0.0758251 4.06296 0.120021 4.12907 0.175736 4.18476C0.231451 4.24045 0.297595 4.28462 0.37039 4.31476C0.443185 4.3449 0.521207 4.36041 0.6 4.36041H1.40002V12.1884C1.41426 12.442 1.47871 12.6903 1.58965 12.9188C1.7006 13.1473 1.85582 13.3515 2.04633 13.5196C2.23683 13.6877 2.45882 13.8163 2.69944 13.898C2.94005 13.9797 3.1945 14.0129 3.44802 13.9955ZM2.60002 4.36041H11.304V12.1884C11.304 12.5163 10.952 12.7961 10.504 12.7961H3.40002C2.97602 12.7961 2.60002 12.5163 2.60002 12.1884V4.36041ZM3.95429 3.16101C3.96859 3.10936 3.97602 3.0556 3.97602 3.00106V1.80966C3.97602 1.48183 4.33602 1.20197 4.77602 1.20197H9.24802C9.66403 1.20197 10.048 1.48183 10.048 1.80966V3.00106C10.0473 3.05515 10.054 3.10896 10.0678 3.16101H3.95429ZM5.57571 10.997C5.41731 10.995 5.26597 10.9311 5.15395 10.8191C5.04193 10.7071 4.97808 10.5558 4.97601 10.3973V6.77517C4.97601 6.61612 5.0392 6.46359 5.15166 6.35112C5.26413 6.23866 5.41666 6.17548 5.57571 6.17548C5.73476 6.17548 5.8873 6.23866 5.99976 6.35112C6.11223 6.46359 6.17541 6.61612 6.17541 6.77517V10.3894C6.17647 10.4688 6.16174 10.5476 6.13208 10.6213C6.10241 10.695 6.05841 10.762 6.00261 10.8186C5.94682 10.8751 5.88035 10.92 5.80707 10.9506C5.73378 10.9813 5.65514 10.9971 5.57571 10.997ZM7.99968 10.8214C8.11215 10.9339 8.26468 10.997 8.42373 10.997C8.58351 10.9949 8.73604 10.93 8.84828 10.8163C8.96052 10.7025 9.02345 10.5491 9.02343 10.3894V6.77517C9.02343 6.61612 8.96025 6.46359 8.84778 6.35112C8.73532 6.23866 8.58278 6.17548 8.42373 6.17548C8.26468 6.17548 8.11215 6.23866 7.99968 6.35112C7.88722 6.46359 7.82404 6.61612 7.82404 6.77517V10.3973C7.82404 10.5564 7.88722 10.7089 7.99968 10.8214Z",fill:"currentColor"},null,-1)])),16)}HN.render=wae;var Tae=xi.extend({name:"focustrap-directive"}),Sae=ui.extend({style:Tae});function E0(t){"@babel/helpers - typeof";return E0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},E0(t)}function t5(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);e&&(l=l.filter(function(d){return Object.getOwnPropertyDescriptor(t,d).enumerable})),n.push.apply(n,l)}return n}function n5(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?t5(Object(n),!0).forEach(function(l){Eae(t,l,n[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):t5(Object(n)).forEach(function(l){Object.defineProperty(t,l,Object.getOwnPropertyDescriptor(n,l))})}return t}function Eae(t,e,n){return(e=Cae(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Cae(t){var e=Iae(t,"string");return E0(e)=="symbol"?e:e+""}function Iae(t,e){if(E0(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var l=n.call(t,e);if(E0(l)!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Aae=Sae.extend("focustrap",{mounted:function(e,n){var l=n.value||{},d=l.disabled;d||(this.createHiddenFocusableElements(e,n),this.bind(e,n),this.autoElementFocus(e,n)),e.setAttribute("data-pd-focustrap",!0),this.$el=e},updated:function(e,n){var l=n.value||{},d=l.disabled;d&&this.unbind(e)},unmounted:function(e){this.unbind(e)},methods:{getComputedSelector:function(e){return':not(.p-hidden-focusable):not([data-p-hidden-focusable="true"])'.concat(e??"")},bind:function(e,n){var l=this,d=n.value||{},f=d.onFocusIn,x=d.onFocusOut;e.$_pfocustrap_mutationobserver=new MutationObserver(function(s){s.forEach(function(C){if(C.type==="childList"&&!e.contains(document.activeElement)){var P=function($){var V=SL($)?SL($,l.getComputedSelector(e.$_pfocustrap_focusableselector))?$:Oh(e,l.getComputedSelector(e.$_pfocustrap_focusableselector)):Oh($);return si(V)?V:$.nextSibling&&P($.nextSibling)};Ea(P(C.nextSibling))}})}),e.$_pfocustrap_mutationobserver.disconnect(),e.$_pfocustrap_mutationobserver.observe(e,{childList:!0}),e.$_pfocustrap_focusinlistener=function(s){return f&&f(s)},e.$_pfocustrap_focusoutlistener=function(s){return x&&x(s)},e.addEventListener("focusin",e.$_pfocustrap_focusinlistener),e.addEventListener("focusout",e.$_pfocustrap_focusoutlistener)},unbind:function(e){e.$_pfocustrap_mutationobserver&&e.$_pfocustrap_mutationobserver.disconnect(),e.$_pfocustrap_focusinlistener&&e.removeEventListener("focusin",e.$_pfocustrap_focusinlistener)&&(e.$_pfocustrap_focusinlistener=null),e.$_pfocustrap_focusoutlistener&&e.removeEventListener("focusout",e.$_pfocustrap_focusoutlistener)&&(e.$_pfocustrap_focusoutlistener=null)},autoFocus:function(e){this.autoElementFocus(this.$el,{value:n5(n5({},e),{},{autoFocus:!0})})},autoElementFocus:function(e,n){var l=n.value||{},d=l.autoFocusSelector,f=d===void 0?"":d,x=l.firstFocusableSelector,s=x===void 0?"":x,C=l.autoFocus,P=C===void 0?!1:C,L=Oh(e,"[autofocus]".concat(this.getComputedSelector(f)));P&&!L&&(L=Oh(e,this.getComputedSelector(s))),Ea(L)},onFirstHiddenElementFocus:function(e){var n,l=e.currentTarget,d=e.relatedTarget,f=d===l.$_pfocustrap_lasthiddenfocusableelement||!((n=this.$el)!==null&&n!==void 0&&n.contains(d))?Oh(l.parentElement,this.getComputedSelector(l.$_pfocustrap_focusableselector)):l.$_pfocustrap_lasthiddenfocusableelement;Ea(f)},onLastHiddenElementFocus:function(e){var n,l=e.currentTarget,d=e.relatedTarget,f=d===l.$_pfocustrap_firsthiddenfocusableelement||!((n=this.$el)!==null&&n!==void 0&&n.contains(d))?WB(l.parentElement,this.getComputedSelector(l.$_pfocustrap_focusableselector)):l.$_pfocustrap_firsthiddenfocusableelement;Ea(f)},createHiddenFocusableElements:function(e,n){var l=this,d=n.value||{},f=d.tabIndex,x=f===void 0?0:f,s=d.firstFocusableSelector,C=s===void 0?"":s,P=d.lastFocusableSelector,L=P===void 0?"":P,$=function(de){return HB("span",{class:"p-hidden-accessible p-hidden-focusable",tabIndex:x,role:"presentation","aria-hidden":!0,"data-p-hidden-accessible":!0,"data-p-hidden-focusable":!0,onFocus:de?.bind(l)})},V=$(this.onFirstHiddenElementFocus),j=$(this.onLastHiddenElementFocus);V.$_pfocustrap_lasthiddenfocusableelement=j,V.$_pfocustrap_focusableselector=C,V.setAttribute("data-pc-section","firstfocusableelement"),j.$_pfocustrap_firsthiddenfocusableelement=V,j.$_pfocustrap_focusableselector=L,j.setAttribute("data-pc-section","lastfocusableelement"),e.prepend(V),e.append(j)}}}),hI={name:"SortAltIcon",extends:go};function Pae(t){return Mae(t)||Oae(t)||kae(t)||Rae()}function Rae(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function kae(t,e){if(t){if(typeof t=="string")return fI(t,e);var n={}.toString.call(t).slice(8,-1);return n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set"?Array.from(t):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?fI(t,e):void 0}}function Oae(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function Mae(t){if(Array.isArray(t))return fI(t)}function fI(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,l=Array(e);n<e;n++)l[n]=t[n];return l}function Dae(t,e,n,l,d,f){return Me(),ft("svg",ot({width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},t.pti()),Pae(e[0]||(e[0]=[Ze("path",{d:"M5.64515 3.61291C5.47353 3.61291 5.30192 3.54968 5.16644 3.4142L3.38708 1.63484L1.60773 3.4142C1.34579 3.67613 0.912244 3.67613 0.650309 3.4142C0.388374 3.15226 0.388374 2.71871 0.650309 2.45678L2.90837 0.198712C3.17031 -0.0632236 3.60386 -0.0632236 3.86579 0.198712L6.12386 2.45678C6.38579 2.71871 6.38579 3.15226 6.12386 3.4142C5.98837 3.54968 5.81676 3.61291 5.64515 3.61291Z",fill:"currentColor"},null,-1),Ze("path",{d:"M3.38714 14C3.01681 14 2.70972 13.6929 2.70972 13.3226V0.677419C2.70972 0.307097 3.01681 0 3.38714 0C3.75746 0 4.06456 0.307097 4.06456 0.677419V13.3226C4.06456 13.6929 3.75746 14 3.38714 14Z",fill:"currentColor"},null,-1),Ze("path",{d:"M10.6129 14C10.4413 14 10.2697 13.9368 10.1342 13.8013L7.87611 11.5432C7.61418 11.2813 7.61418 10.8477 7.87611 10.5858C8.13805 10.3239 8.5716 10.3239 8.83353 10.5858L10.6129 12.3652L12.3922 10.5858C12.6542 10.3239 13.0877 10.3239 13.3497 10.5858C13.6116 10.8477 13.6116 11.2813 13.3497 11.5432L11.0916 13.8013C10.9561 13.9368 10.7845 14 10.6129 14Z",fill:"currentColor"},null,-1),Ze("path",{d:"M10.6129 14C10.2426 14 9.93552 13.6929 9.93552 13.3226V0.677419C9.93552 0.307097 10.2426 0 10.6129 0C10.9833 0 11.2904 0.307097 11.2904 0.677419V13.3226C11.2904 13.6929 10.9832 14 10.6129 14Z",fill:"currentColor"},null,-1)])),16)}hI.render=Dae;var pI={name:"SortAmountDownIcon",extends:go};function Lae(t){return Nae(t)||Bae(t)||Fae(t)||zae()}function zae(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Fae(t,e){if(t){if(typeof t=="string")return mI(t,e);var n={}.toString.call(t).slice(8,-1);return n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set"?Array.from(t):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?mI(t,e):void 0}}function Bae(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function Nae(t){if(Array.isArray(t))return mI(t)}function mI(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,l=Array(e);n<e;n++)l[n]=t[n];return l}function Vae(t,e,n,l,d,f){return Me(),ft("svg",ot({width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},t.pti()),Lae(e[0]||(e[0]=[Ze("path",{d:"M4.93953 10.5858L3.83759 11.6877V0.677419C3.83759 0.307097 3.53049 0 3.16017 0C2.78985 0 2.48275 0.307097 2.48275 0.677419V11.6877L1.38082 10.5858C1.11888 10.3239 0.685331 10.3239 0.423396 10.5858C0.16146 10.8477 0.16146 11.2813 0.423396 11.5432L2.68146 13.8013C2.74469 13.8645 2.81694 13.9097 2.89823 13.9458C2.97952 13.9819 3.06985 14 3.16017 14C3.25049 14 3.33178 13.9819 3.42211 13.9458C3.5034 13.9097 3.57565 13.8645 3.63888 13.8013L5.89694 11.5432C6.15888 11.2813 6.15888 10.8477 5.89694 10.5858C5.63501 10.3239 5.20146 10.3239 4.93953 10.5858ZM13.0957 0H7.22468C6.85436 0 6.54726 0.307097 6.54726 0.677419C6.54726 1.04774 6.85436 1.35484 7.22468 1.35484H13.0957C13.466 1.35484 13.7731 1.04774 13.7731 0.677419C13.7731 0.307097 13.466 0 13.0957 0ZM7.22468 5.41935H9.48275C9.85307 5.41935 10.1602 5.72645 10.1602 6.09677C10.1602 6.4671 9.85307 6.77419 9.48275 6.77419H7.22468C6.85436 6.77419 6.54726 6.4671 6.54726 6.09677C6.54726 5.72645 6.85436 5.41935 7.22468 5.41935ZM7.6763 8.12903H7.22468C6.85436 8.12903 6.54726 8.43613 6.54726 8.80645C6.54726 9.17677 6.85436 9.48387 7.22468 9.48387H7.6763C8.04662 9.48387 8.35372 9.17677 8.35372 8.80645C8.35372 8.43613 8.04662 8.12903 7.6763 8.12903ZM7.22468 2.70968H11.2892C11.6595 2.70968 11.9666 3.01677 11.9666 3.3871C11.9666 3.75742 11.6595 4.06452 11.2892 4.06452H7.22468C6.85436 4.06452 6.54726 3.75742 6.54726 3.3871C6.54726 3.01677 6.85436 2.70968 7.22468 2.70968Z",fill:"currentColor"},null,-1)])),16)}pI.render=Vae;var gI={name:"SortAmountUpAltIcon",extends:go};function $ae(t){return Hae(t)||Gae(t)||jae(t)||Uae()}function Uae(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function jae(t,e){if(t){if(typeof t=="string")return _I(t,e);var n={}.toString.call(t).slice(8,-1);return n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set"?Array.from(t):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_I(t,e):void 0}}function Gae(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function Hae(t){if(Array.isArray(t))return _I(t)}function _I(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,l=Array(e);n<e;n++)l[n]=t[n];return l}function Wae(t,e,n,l,d,f){return Me(),ft("svg",ot({width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},t.pti()),$ae(e[0]||(e[0]=[Ze("path",{d:"M3.63435 0.19871C3.57113 0.135484 3.49887 0.0903226 3.41758 0.0541935C3.255 -0.0180645 3.06532 -0.0180645 2.90274 0.0541935C2.82145 0.0903226 2.74919 0.135484 2.68597 0.19871L0.427901 2.45677C0.165965 2.71871 0.165965 3.15226 0.427901 3.41419C0.689836 3.67613 1.12338 3.67613 1.38532 3.41419L2.48726 2.31226V13.3226C2.48726 13.6929 2.79435 14 3.16467 14C3.535 14 3.84209 13.6929 3.84209 13.3226V2.31226L4.94403 3.41419C5.07951 3.54968 5.25113 3.6129 5.42274 3.6129C5.59435 3.6129 5.76597 3.54968 5.90145 3.41419C6.16338 3.15226 6.16338 2.71871 5.90145 2.45677L3.64338 0.19871H3.63435ZM13.7685 13.3226C13.7685 12.9523 13.4615 12.6452 13.0911 12.6452H7.22016C6.84984 12.6452 6.54274 12.9523 6.54274 13.3226C6.54274 13.6929 6.84984 14 7.22016 14H13.0911C13.4615 14 13.7685 13.6929 13.7685 13.3226ZM7.22016 8.58064C6.84984 8.58064 6.54274 8.27355 6.54274 7.90323C6.54274 7.5329 6.84984 7.22581 7.22016 7.22581H9.47823C9.84855 7.22581 10.1556 7.5329 10.1556 7.90323C10.1556 8.27355 9.84855 8.58064 9.47823 8.58064H7.22016ZM7.22016 5.87097H7.67177C8.0421 5.87097 8.34919 5.56387 8.34919 5.19355C8.34919 4.82323 8.0421 4.51613 7.67177 4.51613H7.22016C6.84984 4.51613 6.54274 4.82323 6.54274 5.19355C6.54274 5.56387 6.84984 5.87097 7.22016 5.87097ZM11.2847 11.2903H7.22016C6.84984 11.2903 6.54274 10.9832 6.54274 10.6129C6.54274 10.2426 6.84984 9.93548 7.22016 9.93548H11.2847C11.655 9.93548 11.9621 10.2426 11.9621 10.6129C11.9621 10.9832 11.655 11.2903 11.2847 11.2903Z",fill:"currentColor"},null,-1)])),16)}gI.render=Wae;var qae={name:"BaseDataTable",extends:Yi,props:{value:{type:Array,default:null},dataKey:{type:[String,Function],default:null},rows:{type:Number,default:0},first:{type:Number,default:0},totalRecords:{type:Number,default:0},paginator:{type:Boolean,default:!1},paginatorPosition:{type:String,default:"bottom"},alwaysShowPaginator:{type:Boolean,default:!0},paginatorTemplate:{type:[Object,String],default:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink RowsPerPageDropdown"},pageLinkSize:{type:Number,default:5},rowsPerPageOptions:{type:Array,default:null},currentPageReportTemplate:{type:String,default:"({currentPage} of {totalPages})"},lazy:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},loadingIcon:{type:String,default:void 0},sortField:{type:[String,Function],default:null},sortOrder:{type:Number,default:null},defaultSortOrder:{type:Number,default:1},nullSortOrder:{type:Number,default:1},multiSortMeta:{type:Array,default:null},sortMode:{type:String,default:"single"},removableSort:{type:Boolean,default:!1},filters:{type:Object,default:null},filterDisplay:{type:String,default:null},globalFilterFields:{type:Array,default:null},filterLocale:{type:String,default:void 0},selection:{type:[Array,Object],default:null},selectionMode:{type:String,default:null},compareSelectionBy:{type:String,default:"deepEquals"},metaKeySelection:{type:Boolean,default:!1},contextMenu:{type:Boolean,default:!1},contextMenuSelection:{type:Object,default:null},selectAll:{type:Boolean,default:null},rowHover:{type:Boolean,default:!1},csvSeparator:{type:String,default:","},exportFilename:{type:String,default:"download"},exportFunction:{type:Function,default:null},resizableColumns:{type:Boolean,default:!1},columnResizeMode:{type:String,default:"fit"},reorderableColumns:{type:Boolean,default:!1},expandedRows:{type:[Array,Object],default:null},expandedRowIcon:{type:String,default:void 0},collapsedRowIcon:{type:String,default:void 0},rowGroupMode:{type:String,default:null},groupRowsBy:{type:[Array,String,Function],default:null},expandableRowGroups:{type:Boolean,default:!1},expandedRowGroups:{type:Array,default:null},stateStorage:{type:String,default:"session"},stateKey:{type:String,default:null},editMode:{type:String,default:null},editingRows:{type:Array,default:null},rowClass:{type:Function,default:null},rowStyle:{type:Function,default:null},scrollable:{type:Boolean,default:!1},virtualScrollerOptions:{type:Object,default:null},scrollHeight:{type:String,default:null},frozenValue:{type:Array,default:null},breakpoint:{type:String,default:"960px"},showHeaders:{type:Boolean,default:!0},showGridlines:{type:Boolean,default:!1},stripedRows:{type:Boolean,default:!1},highlightOnSelect:{type:Boolean,default:!1},size:{type:String,default:null},tableStyle:{type:null,default:null},tableClass:{type:[String,Object],default:null},tableProps:{type:Object,default:null},filterInputProps:{type:null,default:null},filterButtonProps:{type:Object,default:function(){return{filter:{severity:"secondary",text:!0,rounded:!0},inline:{clear:{severity:"secondary",text:!0,rounded:!0}},popover:{addRule:{severity:"info",text:!0,size:"small"},removeRule:{severity:"danger",text:!0,size:"small"},apply:{size:"small"},clear:{outlined:!0,size:"small"}}}}},editButtonProps:{type:Object,default:function(){return{init:{severity:"secondary",text:!0,rounded:!0},save:{severity:"secondary",text:!0,rounded:!0},cancel:{severity:"secondary",text:!0,rounded:!0}}}}},style:Koe,provide:function(){return{$pcDataTable:this,$parentInstance:this}}},WN={name:"RowCheckbox",hostName:"DataTable",extends:Yi,emits:["change"],props:{value:null,checked:null,column:null,rowCheckboxIconTemplate:{type:Function,default:null},index:{type:Number,default:null}},methods:{getColumnPT:function(e){var n={props:this.column.props,parent:{instance:this,props:this.$props,state:this.$data},context:{index:this.index,checked:this.checked,disabled:this.$attrs.disabled}};return ot(this.ptm("column.".concat(e),{column:n}),this.ptm("column.".concat(e),n),this.ptmo(this.getColumnProp(),e,n))},getColumnProp:function(){return this.column.props&&this.column.props.pt?this.column.props.pt:void 0},onChange:function(e){this.$attrs.disabled||this.$emit("change",{originalEvent:e,data:this.value})}},computed:{checkboxAriaLabel:function(){return this.$primevue.config.locale.aria?this.checked?this.$primevue.config.locale.aria.selectRow:this.$primevue.config.locale.aria.unselectRow:void 0}},components:{CheckIcon:s_,Checkbox:aP}};function Kae(t,e,n,l,d,f){var x=_r("CheckIcon"),s=_r("Checkbox");return Me(),rn(s,{modelValue:n.checked,binary:!0,disabled:t.$attrs.disabled,"aria-label":f.checkboxAriaLabel,onChange:f.onChange,unstyled:t.unstyled,pt:f.getColumnPT("pcRowCheckbox")},{icon:zr(function(C){return[n.rowCheckboxIconTemplate?(Me(),rn(Hr(n.rowCheckboxIconTemplate),{key:0,checked:C.checked,class:wr(C.class)},null,8,["checked","class"])):!n.rowCheckboxIconTemplate&&C.checked?(Me(),rn(x,ot({key:1,class:C.class},f.getColumnPT("pcRowCheckbox.icon")),null,16,["class"])):Pn("",!0)]}),_:1},8,["modelValue","disabled","aria-label","onChange","unstyled","pt"])}WN.render=Kae;var qN={name:"RowRadioButton",hostName:"DataTable",extends:Yi,emits:["change"],props:{value:null,checked:null,name:null,column:null,index:{type:Number,default:null}},methods:{getColumnPT:function(e){var n={props:this.column.props,parent:{instance:this,props:this.$props,state:this.$data},context:{index:this.index,checked:this.checked,disabled:this.$attrs.disabled}};return ot(this.ptm("column.".concat(e),{column:n}),this.ptm("column.".concat(e),n),this.ptmo(this.getColumnProp(),e,n))},getColumnProp:function(){return this.column.props&&this.column.props.pt?this.column.props.pt:void 0},onChange:function(e){this.$attrs.disabled||this.$emit("change",{originalEvent:e,data:this.value})}},components:{RadioButton:VN}};function Zae(t,e,n,l,d,f){var x=_r("RadioButton");return Me(),rn(x,{modelValue:n.checked,binary:!0,disabled:t.$attrs.disabled,name:n.name,onChange:f.onChange,unstyled:t.unstyled,pt:f.getColumnPT("pcRowRadiobutton")},null,8,["modelValue","disabled","name","onChange","unstyled","pt"])}qN.render=Zae;function pv(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */var t,e,n=typeof Symbol=="function"?Symbol:{},l=n.iterator||"@@iterator",d=n.toStringTag||"@@toStringTag";function f(j,ue,de,Te){var Be=ue&&ue.prototype instanceof s?ue:s,Ge=Object.create(Be.prototype);return sl(Ge,"_invoke",(function(Ye,Ne,Mt){var kt,Pe,we,Se=0,je=Mt||[],Re=!1,Ve={p:0,n:0,v:t,a:ke,f:ke.bind(t,4),d:function(bn,mn){return kt=bn,Pe=0,we=t,Ve.n=mn,x}};function ke(Mn,bn){for(Pe=Mn,we=bn,e=0;!Re&&Se&&!mn&&e<je.length;e++){var mn,Sn=je[e],ar=Ve.p,Br=Sn[2];Mn>3?(mn=Br===bn)&&(we=Sn[(Pe=Sn[4])?5:(Pe=3,3)],Sn[4]=Sn[5]=t):Sn[0]<=ar&&((mn=Mn<2&&ar<Sn[1])?(Pe=0,Ve.v=bn,Ve.n=Sn[1]):ar<Br&&(mn=Mn<3||Sn[0]>bn||bn>Br)&&(Sn[4]=Mn,Sn[5]=bn,Ve.n=Br,Pe=0))}if(mn||Mn>1)return x;throw Re=!0,bn}return function(Mn,bn,mn){if(Se>1)throw TypeError("Generator is already running");for(Re&&bn===1&&ke(bn,mn),Pe=bn,we=mn;(e=Pe<2?t:we)||!Re;){kt||(Pe?Pe<3?(Pe>1&&(Ve.n=-1),ke(Pe,we)):Ve.n=we:Ve.v=we);try{if(Se=2,kt){if(Pe||(Mn="next"),e=kt[Mn]){if(!(e=e.call(kt,we)))throw TypeError("iterator result is not an object");if(!e.done)return e;we=e.value,Pe<2&&(Pe=0)}else Pe===1&&(e=kt.return)&&e.call(kt),Pe<2&&(we=TypeError("The iterator does not provide a '"+Mn+"' method"),Pe=1);kt=t}else if((e=(Re=Ve.n<0)?we:Ye.call(Ne,Ve))!==x)break}catch(Sn){kt=t,Pe=1,we=Sn}finally{Se=1}}return{value:e,done:Re}}})(j,de,Te),!0),Ge}var x={};function s(){}function C(){}function P(){}e=Object.getPrototypeOf;var L=[][l]?e(e([][l]())):(sl(e={},l,function(){return this}),e),$=P.prototype=s.prototype=Object.create(L);function V(j){return Object.setPrototypeOf?Object.setPrototypeOf(j,P):(j.__proto__=P,sl(j,d,"GeneratorFunction")),j.prototype=Object.create($),j}return C.prototype=P,sl($,"constructor",P),sl(P,"constructor",C),C.displayName="GeneratorFunction",sl(P,d,"GeneratorFunction"),sl($),sl($,d,"Generator"),sl($,l,function(){return this}),sl($,"toString",function(){return"[object Generator]"}),(pv=function(){return{w:f,m:V}})()}function sl(t,e,n,l){var d=Object.defineProperty;try{d({},"",{})}catch{d=0}sl=function(x,s,C,P){function L($,V){sl(x,$,function(j){return this._invoke($,V,j)})}s?d?d(x,s,{value:C,enumerable:!P,configurable:!P,writable:!P}):x[s]=C:(L("next",0),L("throw",1),L("return",2))},sl(t,e,n,l)}function r5(t,e,n,l,d,f,x){try{var s=t[f](x),C=s.value}catch(P){return void n(P)}s.done?e(C):Promise.resolve(C).then(l,d)}function i5(t){return function(){var e=this,n=arguments;return new Promise(function(l,d){var f=t.apply(e,n);function x(C){r5(f,l,d,x,s,"next",C)}function s(C){r5(f,l,d,x,s,"throw",C)}x(void 0)})}}var KN={name:"BodyCell",hostName:"DataTable",extends:Yi,emits:["cell-edit-init","cell-edit-complete","cell-edit-cancel","row-edit-init","row-edit-save","row-edit-cancel","row-toggle","radio-change","checkbox-change","editing-meta-change"],props:{rowData:{type:Object,default:null},column:{type:Object,default:null},frozenRow:{type:Boolean,default:!1},rowIndex:{type:Number,default:null},index:{type:Number,default:null},isRowExpanded:{type:Boolean,default:!1},selected:{type:Boolean,default:!1},editing:{type:Boolean,default:!1},editingMeta:{type:Object,default:null},editMode:{type:String,default:null},virtualScrollerContentProps:{type:Object,default:null},ariaControls:{type:String,default:null},name:{type:String,default:null},expandedRowIcon:{type:String,default:null},collapsedRowIcon:{type:String,default:null},editButtonProps:{type:Object,default:null}},documentEditListener:null,selfClick:!1,overlayEventListener:null,editCompleteTimeout:null,data:function(){return{d_editing:this.editing,styleObject:{}}},watch:{editing:function(e){this.d_editing=e},"$data.d_editing":function(e){this.$emit("editing-meta-change",{data:this.rowData,field:this.field||"field_".concat(this.index),index:this.rowIndex,editing:e})}},mounted:function(){this.columnProp("frozen")&&this.updateStickyPosition()},updated:function(){var e=this;this.columnProp("frozen")&&this.updateStickyPosition(),this.d_editing&&(this.editMode==="cell"||this.editMode==="row"&&this.columnProp("rowEditor"))&&setTimeout(function(){var n=Oh(e.$el);n&&n.focus()},1)},beforeUnmount:function(){this.overlayEventListener&&(Fh.off("overlay-click",this.overlayEventListener),this.overlayEventListener=null)},methods:{columnProp:function(e){return uf(this.column,e)},getColumnPT:function(e){var n,l,d={props:this.column.props,parent:{instance:this,props:this.$props,state:this.$data},context:{index:this.index,size:(n=this.$parentInstance)===null||n===void 0||(n=n.$parentInstance)===null||n===void 0?void 0:n.size,showGridlines:(l=this.$parentInstance)===null||l===void 0||(l=l.$parentInstance)===null||l===void 0?void 0:l.showGridlines}};return ot(this.ptm("column.".concat(e),{column:d}),this.ptm("column.".concat(e),d),this.ptmo(this.getColumnProp(),e,d))},getColumnProp:function(){return this.column.props&&this.column.props.pt?this.column.props.pt:void 0},resolveFieldData:function(){return Di(this.rowData,this.field)},toggleRow:function(e){this.$emit("row-toggle",{originalEvent:e,data:this.rowData})},toggleRowWithRadio:function(e,n){this.$emit("radio-change",{originalEvent:e.originalEvent,index:n,data:e.data})},toggleRowWithCheckbox:function(e,n){this.$emit("checkbox-change",{originalEvent:e.originalEvent,index:n,data:e.data})},isEditable:function(){return this.column.children&&this.column.children.editor!=null},bindDocumentEditListener:function(){var e=this;this.documentEditListener||(this.documentEditListener=function(n){e.selfClick=e.$el&&e.$el.contains(n.target),e.editCompleteTimeout&&clearTimeout(e.editCompleteTimeout),e.selfClick||(e.editCompleteTimeout=setTimeout(function(){e.completeEdit(n,"outside")},1))},document.addEventListener("mousedown",this.documentEditListener))},unbindDocumentEditListener:function(){this.documentEditListener&&(document.removeEventListener("mousedown",this.documentEditListener),this.documentEditListener=null,this.selfClick=!1,this.editCompleteTimeout&&(clearTimeout(this.editCompleteTimeout),this.editCompleteTimeout=null))},switchCellToViewMode:function(){this.d_editing=!1,this.unbindDocumentEditListener(),Fh.off("overlay-click",this.overlayEventListener),this.overlayEventListener=null},onClick:function(e){var n=this;this.editMode==="cell"&&this.isEditable()&&(this.d_editing||(this.d_editing=!0,this.bindDocumentEditListener(),this.$emit("cell-edit-init",{originalEvent:e,data:this.rowData,field:this.field,index:this.rowIndex}),this.overlayEventListener=function(l){n.selfClick=n.$el&&n.$el.contains(l.target)},Fh.on("overlay-click",this.overlayEventListener)))},completeEdit:function(e,n){var l={originalEvent:e,data:this.rowData,newData:this.editingRowData,value:this.rowData[this.field],newValue:this.editingRowData[this.field],field:this.field,index:this.rowIndex,type:n,defaultPrevented:!1,preventDefault:function(){this.defaultPrevented=!0}};this.$emit("cell-edit-complete",l),l.defaultPrevented||this.switchCellToViewMode()},onKeyDown:function(e){if(this.editMode==="cell")switch(e.code){case"Enter":case"NumpadEnter":this.completeEdit(e,"enter");break;case"Escape":this.switchCellToViewMode(),this.$emit("cell-edit-cancel",{originalEvent:e,data:this.rowData,field:this.field,index:this.rowIndex});break;case"Tab":this.completeEdit(e,"tab"),e.shiftKey?this.moveToPreviousCell(e):this.moveToNextCell(e);break}},moveToPreviousCell:function(e){var n=this;return i5(pv().m(function l(){var d,f;return pv().w(function(x){for(;;)switch(x.n){case 0:if(d=n.findCell(e.target),f=n.findPreviousEditableColumn(d),!f){x.n=2;break}return x.n=1,n.$nextTick();case 1:TL(f,"click"),e.preventDefault();case 2:return x.a(2)}},l)}))()},moveToNextCell:function(e){var n=this;return i5(pv().m(function l(){var d,f;return pv().w(function(x){for(;;)switch(x.n){case 0:if(d=n.findCell(e.target),f=n.findNextEditableColumn(d),!f){x.n=2;break}return x.n=1,n.$nextTick();case 1:TL(f,"click"),e.preventDefault();case 2:return x.a(2)}},l)}))()},findCell:function(e){if(e){for(var n=e;n&&!Cs(n,"data-p-cell-editing");)n=n.parentElement;return n}else return null},findPreviousEditableColumn:function(e){var n=e.previousElementSibling;if(!n){var l=e.parentElement.previousElementSibling;l&&(n=l.lastElementChild)}return n?Cs(n,"data-p-editable-column")?n:this.findPreviousEditableColumn(n):null},findNextEditableColumn:function(e){var n=e.nextElementSibling;if(!n){var l=e.parentElement.nextElementSibling;l&&(n=l.firstElementChild)}return n?Cs(n,"data-p-editable-column")?n:this.findNextEditableColumn(n):null},onRowEditInit:function(e){this.$emit("row-edit-init",{originalEvent:e,data:this.rowData,newData:this.editingRowData,field:this.field,index:this.rowIndex})},onRowEditSave:function(e){this.$emit("row-edit-save",{originalEvent:e,data:this.rowData,newData:this.editingRowData,field:this.field,index:this.rowIndex})},onRowEditCancel:function(e){this.$emit("row-edit-cancel",{originalEvent:e,data:this.rowData,newData:this.editingRowData,field:this.field,index:this.rowIndex})},editorInitCallback:function(e){this.$emit("row-edit-init",{originalEvent:e,data:this.rowData,newData:this.editingRowData,field:this.field,index:this.rowIndex})},editorSaveCallback:function(e){this.editMode==="row"?this.$emit("row-edit-save",{originalEvent:e,data:this.rowData,newData:this.editingRowData,field:this.field,index:this.rowIndex}):this.completeEdit(e,"enter")},editorCancelCallback:function(e){this.editMode==="row"?this.$emit("row-edit-cancel",{originalEvent:e,data:this.rowData,newData:this.editingRowData,field:this.field,index:this.rowIndex}):(this.switchCellToViewMode(),this.$emit("cell-edit-cancel",{originalEvent:e,data:this.rowData,field:this.field,index:this.rowIndex}))},updateStickyPosition:function(){if(this.columnProp("frozen")){var e=this.columnProp("alignFrozen");if(e==="right"){var n=0,l=zT(this.$el,'[data-p-frozen-column="true"]');l&&(n=Ga(l)+parseFloat(l.style["inset-inline-end"]||0)),this.styleObject.insetInlineEnd=n+"px"}else{var d=0,f=FT(this.$el,'[data-p-frozen-column="true"]');f&&(d=Ga(f)+parseFloat(f.style["inset-inline-start"]||0)),this.styleObject.insetInlineStart=d+"px"}}},getVirtualScrollerProp:function(e){return this.virtualScrollerContentProps?this.virtualScrollerContentProps[e]:null}},computed:{editingRowData:function(){return this.editingMeta[this.rowIndex]?this.editingMeta[this.rowIndex].data:this.rowData},field:function(){return this.columnProp("field")},containerClass:function(){return[this.columnProp("bodyClass"),this.columnProp("class"),this.cx("bodyCell")]},containerStyle:function(){var e=this.columnProp("bodyStyle"),n=this.columnProp("style");return this.columnProp("frozen")?[n,e,this.styleObject]:[n,e]},loading:function(){return this.getVirtualScrollerProp("loading")},loadingOptions:function(){var e=this.getVirtualScrollerProp("getLoaderOptions");return e&&e(this.rowIndex,{cellIndex:this.index,cellFirst:this.index===0,cellLast:this.index===this.getVirtualScrollerProp("columns").length-1,cellEven:this.index%2===0,cellOdd:this.index%2!==0,column:this.column,field:this.field})},expandButtonAriaLabel:function(){return this.$primevue.config.locale.aria?this.isRowExpanded?this.$primevue.config.locale.aria.expandRow:this.$primevue.config.locale.aria.collapseRow:void 0},initButtonAriaLabel:function(){return this.$primevue.config.locale.aria?this.$primevue.config.locale.aria.editRow:void 0},saveButtonAriaLabel:function(){return this.$primevue.config.locale.aria?this.$primevue.config.locale.aria.saveEdit:void 0},cancelButtonAriaLabel:function(){return this.$primevue.config.locale.aria?this.$primevue.config.locale.aria.cancelEdit:void 0}},components:{DTRadioButton:qN,DTCheckbox:WN,Button:Pg,ChevronDownIcon:BT,ChevronRightIcon:sP,BarsIcon:FN,PencilIcon:BN,CheckIcon:s_,TimesIcon:NT},directives:{ripple:cf}};function C0(t){"@babel/helpers - typeof";return C0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},C0(t)}function o5(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);e&&(l=l.filter(function(d){return Object.getOwnPropertyDescriptor(t,d).enumerable})),n.push.apply(n,l)}return n}function yx(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?o5(Object(n),!0).forEach(function(l){Xae(t,l,n[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):o5(Object(n)).forEach(function(l){Object.defineProperty(t,l,Object.getOwnPropertyDescriptor(n,l))})}return t}function Xae(t,e,n){return(e=Yae(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Yae(t){var e=Jae(t,"string");return C0(e)=="symbol"?e:e+""}function Jae(t,e){if(C0(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var l=n.call(t,e);if(C0(l)!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Qae=["colspan","rowspan","data-p-selection-column","data-p-editable-column","data-p-cell-editing","data-p-frozen-column"],ele=["aria-expanded","aria-controls","aria-label"];function tle(t,e,n,l,d,f){var x=_r("DTRadioButton"),s=_r("DTCheckbox"),C=_r("BarsIcon"),P=_r("ChevronDownIcon"),L=_r("ChevronRightIcon"),$=_r("Button"),V=Cd("ripple");return f.loading?(Me(),ft("td",ot({key:0,style:f.containerStyle,class:f.containerClass,role:"cell"},yx(yx({},f.getColumnPT("root")),f.getColumnPT("bodyCell"))),[(Me(),rn(Hr(n.column.children.loading),{data:n.rowData,column:n.column,field:f.field,index:n.rowIndex,frozenRow:n.frozenRow,loadingOptions:f.loadingOptions},null,8,["data","column","field","index","frozenRow","loadingOptions"]))],16)):(Me(),ft("td",ot({key:1,style:f.containerStyle,class:f.containerClass,colspan:f.columnProp("colspan"),rowspan:f.columnProp("rowspan"),onClick:e[3]||(e[3]=function(){return f.onClick&&f.onClick.apply(f,arguments)}),onKeydown:e[4]||(e[4]=function(){return f.onKeyDown&&f.onKeyDown.apply(f,arguments)}),role:"cell"},yx(yx({},f.getColumnPT("root")),f.getColumnPT("bodyCell")),{"data-p-selection-column":f.columnProp("selectionMode")!=null,"data-p-editable-column":f.isEditable(),"data-p-cell-editing":d.d_editing,"data-p-frozen-column":f.columnProp("frozen")}),[n.column.children&&n.column.children.body&&!d.d_editing?(Me(),rn(Hr(n.column.children.body),{key:0,data:n.rowData,column:n.column,field:f.field,index:n.rowIndex,frozenRow:n.frozenRow,editorInitCallback:f.editorInitCallback,rowTogglerCallback:f.toggleRow},null,8,["data","column","field","index","frozenRow","editorInitCallback","rowTogglerCallback"])):n.column.children&&n.column.children.editor&&d.d_editing?(Me(),rn(Hr(n.column.children.editor),{key:1,data:f.editingRowData,column:n.column,field:f.field,index:n.rowIndex,frozenRow:n.frozenRow,editorSaveCallback:f.editorSaveCallback,editorCancelCallback:f.editorCancelCallback},null,8,["data","column","field","index","frozenRow","editorSaveCallback","editorCancelCallback"])):n.column.children&&n.column.children.body&&!n.column.children.editor&&d.d_editing?(Me(),rn(Hr(n.column.children.body),{key:2,data:f.editingRowData,column:n.column,field:f.field,index:n.rowIndex,frozenRow:n.frozenRow},null,8,["data","column","field","index","frozenRow"])):f.columnProp("selectionMode")?(Me(),ft(Tr,{key:3},[f.columnProp("selectionMode")==="single"?(Me(),rn(x,{key:0,value:n.rowData,name:n.name,checked:n.selected,onChange:e[0]||(e[0]=function(j){return f.toggleRowWithRadio(j,n.rowIndex)}),column:n.column,index:n.index,unstyled:t.unstyled,pt:t.pt},null,8,["value","name","checked","column","index","unstyled","pt"])):f.columnProp("selectionMode")==="multiple"?(Me(),rn(s,{key:1,value:n.rowData,checked:n.selected,rowCheckboxIconTemplate:n.column.children&&n.column.children.rowcheckboxicon,"aria-selected":n.selected?!0:void 0,onChange:e[1]||(e[1]=function(j){return f.toggleRowWithCheckbox(j,n.rowIndex)}),column:n.column,index:n.index,unstyled:t.unstyled,pt:t.pt},null,8,["value","checked","rowCheckboxIconTemplate","aria-selected","column","index","unstyled","pt"])):Pn("",!0)],64)):f.columnProp("rowReorder")?(Me(),ft(Tr,{key:4},[n.column.children&&n.column.children.rowreordericon?(Me(),rn(Hr(n.column.children.rowreordericon),ot({key:0,class:t.cx("reorderableRowHandle")},f.getColumnPT("reorderableRowHandle")),null,16,["class"])):f.columnProp("rowReorderIcon")?(Me(),ft("i",ot({key:1,class:[t.cx("reorderableRowHandle"),f.columnProp("rowReorderIcon")]},f.getColumnPT("reorderableRowHandle")),null,16)):(Me(),rn(C,ot({key:2,class:t.cx("reorderableRowHandle")},f.getColumnPT("reorderableRowHandle")),null,16,["class"]))],64)):f.columnProp("expander")?Xi((Me(),ft("button",ot({key:5,class:t.cx("rowToggleButton"),type:"button","aria-expanded":n.isRowExpanded,"aria-controls":n.ariaControls,"aria-label":f.expandButtonAriaLabel,onClick:e[2]||(e[2]=Id(function(){return f.toggleRow&&f.toggleRow.apply(f,arguments)},["stop"])),"data-p-selected":"selected"},f.getColumnPT("rowToggleButton"),{"data-pc-group-section":"rowactionbutton"}),[n.column.children&&n.column.children.rowtoggleicon?(Me(),rn(Hr(n.column.children.rowtoggleicon),{key:0,class:wr(t.cx("rowToggleIcon")),rowExpanded:n.isRowExpanded},null,8,["class","rowExpanded"])):n.column.children&&n.column.children.rowtogglericon?(Me(),rn(Hr(n.column.children.rowtogglericon),{key:1,class:wr(t.cx("rowToggleIcon")),rowExpanded:n.isRowExpanded},null,8,["class","rowExpanded"])):(Me(),ft(Tr,{key:2},[n.isRowExpanded&&n.expandedRowIcon?(Me(),ft("span",{key:0,class:wr([t.cx("rowToggleIcon"),n.expandedRowIcon])},null,2)):n.isRowExpanded&&!n.expandedRowIcon?(Me(),rn(P,ot({key:1,class:t.cx("rowToggleIcon")},f.getColumnPT("rowToggleIcon")),null,16,["class"])):!n.isRowExpanded&&n.collapsedRowIcon?(Me(),ft("span",{key:2,class:wr([t.cx("rowToggleIcon"),n.collapsedRowIcon])},null,2)):!n.isRowExpanded&&!n.collapsedRowIcon?(Me(),rn(L,ot({key:3,class:t.cx("rowToggleIcon")},f.getColumnPT("rowToggleIcon")),null,16,["class"])):Pn("",!0)],64))],16,ele)),[[V]]):n.editMode==="row"&&f.columnProp("rowEditor")?(Me(),ft(Tr,{key:6},[d.d_editing?Pn("",!0):(Me(),rn($,ot({key:0,class:t.cx("pcRowEditorInit"),"aria-label":f.initButtonAriaLabel,unstyled:t.unstyled,onClick:f.onRowEditInit},n.editButtonProps.init,{pt:f.getColumnPT("pcRowEditorInit"),"data-pc-group-section":"rowactionbutton"}),{icon:zr(function(j){return[(Me(),rn(Hr(n.column.children&&n.column.children.roweditoriniticon||"PencilIcon"),ot({class:j.class},f.getColumnPT("pcRowEditorInit").icon),null,16,["class"]))]}),_:1},16,["class","aria-label","unstyled","onClick","pt"])),d.d_editing?(Me(),rn($,ot({key:1,class:t.cx("pcRowEditorSave"),"aria-label":f.saveButtonAriaLabel,unstyled:t.unstyled,onClick:f.onRowEditSave},n.editButtonProps.save,{pt:f.getColumnPT("pcRowEditorSave"),"data-pc-group-section":"rowactionbutton"}),{icon:zr(function(j){return[(Me(),rn(Hr(n.column.children&&n.column.children.roweditorsaveicon||"CheckIcon"),ot({class:j.class},f.getColumnPT("pcRowEditorSave").icon),null,16,["class"]))]}),_:1},16,["class","aria-label","unstyled","onClick","pt"])):Pn("",!0),d.d_editing?(Me(),rn($,ot({key:2,class:t.cx("pcRowEditorCancel"),"aria-label":f.cancelButtonAriaLabel,unstyled:t.unstyled,onClick:f.onRowEditCancel},n.editButtonProps.cancel,{pt:f.getColumnPT("pcRowEditorCancel"),"data-pc-group-section":"rowactionbutton"}),{icon:zr(function(j){return[(Me(),rn(Hr(n.column.children&&n.column.children.roweditorcancelicon||"TimesIcon"),ot({class:j.class},f.getColumnPT("pcRowEditorCancel").icon),null,16,["class"]))]}),_:1},16,["class","aria-label","unstyled","onClick","pt"])):Pn("",!0)],64)):(Me(),ft(Tr,{key:7},[Ra(Fr(f.resolveFieldData()),1)],64))],16,Qae))}KN.render=tle;function I0(t){"@babel/helpers - typeof";return I0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},I0(t)}function nle(t,e){var n=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=rle(t))||e){n&&(t=n);var l=0,d=function(){};return{s:d,n:function(){return l>=t.length?{done:!0}:{done:!1,value:t[l++]}},e:function(P){throw P},f:d}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var f,x=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var P=n.next();return x=P.done,P},e:function(P){s=!0,f=P},f:function(){try{x||n.return==null||n.return()}finally{if(s)throw f}}}}function rle(t,e){if(t){if(typeof t=="string")return s5(t,e);var n={}.toString.call(t).slice(8,-1);return n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set"?Array.from(t):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?s5(t,e):void 0}}function s5(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,l=Array(e);n<e;n++)l[n]=t[n];return l}function a5(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);e&&(l=l.filter(function(d){return Object.getOwnPropertyDescriptor(t,d).enumerable})),n.push.apply(n,l)}return n}function l5(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?a5(Object(n),!0).forEach(function(l){ile(t,l,n[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):a5(Object(n)).forEach(function(l){Object.defineProperty(t,l,Object.getOwnPropertyDescriptor(n,l))})}return t}function ile(t,e,n){return(e=ole(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ole(t){var e=sle(t,"string");return I0(e)=="symbol"?e:e+""}function sle(t,e){if(I0(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var l=n.call(t,e);if(I0(l)!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var ZN={name:"BodyRow",hostName:"DataTable",extends:Yi,emits:["rowgroup-toggle","row-click","row-dblclick","row-rightclick","row-touchend","row-keydown","row-mousedown","row-dragstart","row-dragover","row-dragleave","row-dragend","row-drop","row-toggle","radio-change","checkbox-change","cell-edit-init","cell-edit-complete","cell-edit-cancel","row-edit-init","row-edit-save","row-edit-cancel","editing-meta-change"],props:{rowData:{type:Object,default:null},index:{type:Number,default:0},value:{type:Array,default:null},columns:{type:null,default:null},frozenRow:{type:Boolean,default:!1},empty:{type:Boolean,default:!1},rowGroupMode:{type:String,default:null},groupRowsBy:{type:[Array,String,Function],default:null},expandableRowGroups:{type:Boolean,default:!1},expandedRowGroups:{type:Array,default:null},first:{type:Number,default:0},dataKey:{type:[String,Function],default:null},expandedRowIcon:{type:String,default:null},collapsedRowIcon:{type:String,default:null},expandedRows:{type:[Array,Object],default:null},selection:{type:[Array,Object],default:null},selectionKeys:{type:null,default:null},selectionMode:{type:String,default:null},contextMenu:{type:Boolean,default:!1},contextMenuSelection:{type:Object,default:null},rowClass:{type:null,default:null},rowStyle:{type:null,default:null},rowGroupHeaderStyle:{type:null,default:null},editMode:{type:String,default:null},compareSelectionBy:{type:String,default:"deepEquals"},editingRows:{type:Array,default:null},editingRowKeys:{type:null,default:null},editingMeta:{type:Object,default:null},templates:{type:null,default:null},scrollable:{type:Boolean,default:!1},editButtonProps:{type:Object,default:null},virtualScrollerContentProps:{type:Object,default:null},isVirtualScrollerDisabled:{type:Boolean,default:!1},expandedRowId:{type:String,default:null},nameAttributeSelector:{type:String,default:null}},data:function(){return{d_rowExpanded:!1}},watch:{expandedRows:{deep:!0,immediate:!0,handler:function(e){var n=this;this.d_rowExpanded=this.dataKey?e?.[Di(this.rowData,this.dataKey)]!==void 0:e?.some(function(l){return n.equals(n.rowData,l)})}}},methods:{columnProp:function(e,n){return uf(e,n)},getColumnPT:function(e){var n={parent:{instance:this,props:this.$props,state:this.$data}};return ot(this.ptm("column.".concat(e),{column:n}),this.ptm("column.".concat(e),n),this.ptmo(this.columnProp({},"pt"),e,n))},getBodyRowPTOptions:function(e){var n,l=(n=this.$parentInstance)===null||n===void 0?void 0:n.$parentInstance;return this.ptm(e,{context:{index:this.rowIndex,selectable:l?.rowHover||l?.selectionMode,selected:this.isSelected,stripedRows:l?.stripedRows||!1}})},shouldRenderBodyCell:function(e){var n=this.columnProp(e,"hidden");if(this.rowGroupMode&&!n){var l=this.columnProp(e,"field");if(this.rowGroupMode==="subheader")return this.groupRowsBy!==l;if(this.rowGroupMode==="rowspan")if(this.isGrouped(e)){var d=this.value[this.rowIndex-1];if(d){var f=Di(this.value[this.rowIndex],l),x=Di(d,l);return f!==x}else return!0}else return!0}else return!n},calculateRowGroupSize:function(e){if(this.isGrouped(e)){var n=this.rowIndex,l=this.columnProp(e,"field"),d=Di(this.value[n],l),f=d,x=0;for(this.d_rowExpanded&&x++;d===f;){x++;var s=this.value[++n];if(s)f=Di(s,l);else break}return x===1?null:x}else return null},isGrouped:function(e){var n=this.columnProp(e,"field");return this.groupRowsBy&&n?Array.isArray(this.groupRowsBy)?this.groupRowsBy.indexOf(n)>-1:this.groupRowsBy===n:!1},findIndexInSelection:function(e){return this.findIndex(e,this.selection)},findIndex:function(e,n){var l=-1;if(n&&n.length){for(var d=0;d<n.length;d++)if(this.equals(e,n[d])){l=d;break}}return l},equals:function(e,n){return this.compareSelectionBy==="equals"?e===n:Pp(e,n,this.dataKey)},onRowGroupToggle:function(e){this.$emit("rowgroup-toggle",{originalEvent:e,data:this.rowData})},onRowClick:function(e){this.$emit("row-click",{originalEvent:e,data:this.rowData,index:this.rowIndex})},onRowDblClick:function(e){this.$emit("row-dblclick",{originalEvent:e,data:this.rowData,index:this.rowIndex})},onRowRightClick:function(e){this.$emit("row-rightclick",{originalEvent:e,data:this.rowData,index:this.rowIndex})},onRowTouchEnd:function(e){this.$emit("row-touchend",e)},onRowKeyDown:function(e){this.$emit("row-keydown",{originalEvent:e,data:this.rowData,index:this.rowIndex})},onRowMouseDown:function(e){this.$emit("row-mousedown",e)},onRowDragStart:function(e){this.$emit("row-dragstart",{originalEvent:e,index:this.rowIndex})},onRowDragOver:function(e){this.$emit("row-dragover",{originalEvent:e,index:this.rowIndex})},onRowDragLeave:function(e){this.$emit("row-dragleave",e)},onRowDragEnd:function(e){this.$emit("row-dragend",e)},onRowDrop:function(e){this.$emit("row-drop",e)},onRowToggle:function(e){this.d_rowExpanded=!this.d_rowExpanded,this.$emit("row-toggle",l5(l5({},e),{},{expanded:this.d_rowExpanded}))},onRadioChange:function(e){this.$emit("radio-change",e)},onCheckboxChange:function(e){this.$emit("checkbox-change",e)},onCellEditInit:function(e){this.$emit("cell-edit-init",e)},onCellEditComplete:function(e){this.$emit("cell-edit-complete",e)},onCellEditCancel:function(e){this.$emit("cell-edit-cancel",e)},onRowEditInit:function(e){this.$emit("row-edit-init",e)},onRowEditSave:function(e){this.$emit("row-edit-save",e)},onRowEditCancel:function(e){this.$emit("row-edit-cancel",e)},onEditingMetaChange:function(e){this.$emit("editing-meta-change",e)},getVirtualScrollerProp:function(e,n){return n=n||this.virtualScrollerContentProps,n?n[e]:null}},computed:{rowIndex:function(){var e=this.getVirtualScrollerProp("getItemOptions");return e?e(this.index).index:this.index},rowStyles:function(){var e;return(e=this.rowStyle)===null||e===void 0?void 0:e.call(this,this.rowData)},rowClasses:function(){var e=[],n=null;if(this.rowClass){var l=this.rowClass(this.rowData);l&&e.push(l)}if(this.columns){var d=nle(this.columns),f;try{for(d.s();!(f=d.n()).done;){var x=f.value,s=this.columnProp(x,"selectionMode");if(si(s)){n=s;break}}}catch(C){d.e(C)}finally{d.f()}}return[this.cx("row",{rowData:this.rowData,index:this.rowIndex,columnSelectionMode:n}),e]},rowTabindex:function(){return this.selection===null&&(this.selectionMode==="single"||this.selectionMode==="multiple")&&this.rowIndex===0?0:-1},isRowEditing:function(){return this.rowData&&this.editingRows?this.dataKey?this.editingRowKeys?this.editingRowKeys[Di(this.rowData,this.dataKey)]!==void 0:!1:this.findIndex(this.rowData,this.editingRows)>-1:!1},isRowGroupExpanded:function(){if(this.expandableRowGroups&&this.expandedRowGroups){var e=Di(this.rowData,this.groupRowsBy);return this.expandedRowGroups.indexOf(e)>-1}return!1},isSelected:function(){return this.rowData&&this.selection?this.dataKey?this.selectionKeys?this.selectionKeys[Di(this.rowData,this.dataKey)]!==void 0:!1:this.selection instanceof Array?this.findIndexInSelection(this.rowData)>-1:this.equals(this.rowData,this.selection):!1},isSelectedWithContextMenu:function(){return this.rowData&&this.contextMenuSelection?this.equals(this.rowData,this.contextMenuSelection,this.dataKey):!1},shouldRenderRowGroupHeader:function(){var e=Di(this.rowData,this.groupRowsBy),n=this.value[this.rowIndex-1];if(n){var l=Di(n,this.groupRowsBy);return e!==l}else return!0},shouldRenderRowGroupFooter:function(){if(this.expandableRowGroups&&!this.isRowGroupExpanded)return!1;var e=Di(this.rowData,this.groupRowsBy),n=this.value[this.rowIndex+1];if(n){var l=Di(n,this.groupRowsBy);return e!==l}else return!0},columnsLength:function(){var e=this;if(this.columns){var n=0;return this.columns.forEach(function(l){e.columnProp(l,"hidden")&&n++}),this.columns.length-n}return 0}},components:{DTBodyCell:KN,ChevronDownIcon:BT,ChevronRightIcon:sP}};function A0(t){"@babel/helpers - typeof";return A0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},A0(t)}function c5(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);e&&(l=l.filter(function(d){return Object.getOwnPropertyDescriptor(t,d).enumerable})),n.push.apply(n,l)}return n}function xh(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?c5(Object(n),!0).forEach(function(l){ale(t,l,n[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):c5(Object(n)).forEach(function(l){Object.defineProperty(t,l,Object.getOwnPropertyDescriptor(n,l))})}return t}function ale(t,e,n){return(e=lle(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function lle(t){var e=cle(t,"string");return A0(e)=="symbol"?e:e+""}function cle(t,e){if(A0(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var l=n.call(t,e);if(A0(l)!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var ule=["colspan"],dle=["tabindex","aria-selected","data-p-index","data-p-selectable-row","data-p-selected","data-p-selected-contextmenu"],hle=["id"],fle=["colspan"],ple=["colspan"],mle=["colspan"];function gle(t,e,n,l,d,f){var x=_r("ChevronDownIcon"),s=_r("ChevronRightIcon"),C=_r("DTBodyCell");return n.empty?(Me(),ft("tr",ot({key:1,class:t.cx("emptyMessage"),role:"row"},t.ptm("emptyMessage")),[Ze("td",ot({colspan:f.columnsLength},xh(xh({},f.getColumnPT("bodycell")),t.ptm("emptyMessageCell"))),[n.templates.empty?(Me(),rn(Hr(n.templates.empty),{key:0})):Pn("",!0)],16,mle)],16)):(Me(),ft(Tr,{key:0},[n.templates.groupheader&&n.rowGroupMode==="subheader"&&f.shouldRenderRowGroupHeader?(Me(),ft("tr",ot({key:0,class:t.cx("rowGroupHeader"),style:n.rowGroupHeaderStyle,role:"row"},t.ptm("rowGroupHeader")),[Ze("td",ot({colspan:f.columnsLength-1},xh(xh({},f.getColumnPT("bodycell")),t.ptm("rowGroupHeaderCell"))),[n.expandableRowGroups?(Me(),ft("button",ot({key:0,class:t.cx("rowToggleButton"),onClick:e[0]||(e[0]=function(){return f.onRowGroupToggle&&f.onRowGroupToggle.apply(f,arguments)}),type:"button"},t.ptm("rowToggleButton")),[n.templates.rowtoggleicon||n.templates.rowgrouptogglericon?(Me(),rn(Hr(n.templates.rowtoggleicon||n.templates.rowgrouptogglericon),{key:0,expanded:f.isRowGroupExpanded},null,8,["expanded"])):(Me(),ft(Tr,{key:1},[f.isRowGroupExpanded&&n.expandedRowIcon?(Me(),ft("span",ot({key:0,class:[t.cx("rowToggleIcon"),n.expandedRowIcon]},t.ptm("rowToggleIcon")),null,16)):f.isRowGroupExpanded&&!n.expandedRowIcon?(Me(),rn(x,ot({key:1,class:t.cx("rowToggleIcon")},t.ptm("rowToggleIcon")),null,16,["class"])):!f.isRowGroupExpanded&&n.collapsedRowIcon?(Me(),ft("span",ot({key:2,class:[t.cx("rowToggleIcon"),n.collapsedRowIcon]},t.ptm("rowToggleIcon")),null,16)):!f.isRowGroupExpanded&&!n.collapsedRowIcon?(Me(),rn(s,ot({key:3,class:t.cx("rowToggleIcon")},t.ptm("rowToggleIcon")),null,16,["class"])):Pn("",!0)],64))],16)):Pn("",!0),(Me(),rn(Hr(n.templates.groupheader),{data:n.rowData,index:f.rowIndex},null,8,["data","index"]))],16,ule)],16)):Pn("",!0),!n.expandableRowGroups||f.isRowGroupExpanded?(Me(),ft("tr",ot({key:1,class:f.rowClasses,style:f.rowStyles,tabindex:f.rowTabindex,role:"row","aria-selected":n.selectionMode?f.isSelected:null,onClick:e[1]||(e[1]=function(){return f.onRowClick&&f.onRowClick.apply(f,arguments)}),onDblclick:e[2]||(e[2]=function(){return f.onRowDblClick&&f.onRowDblClick.apply(f,arguments)}),onContextmenu:e[3]||(e[3]=function(){return f.onRowRightClick&&f.onRowRightClick.apply(f,arguments)}),onTouchend:e[4]||(e[4]=function(){return f.onRowTouchEnd&&f.onRowTouchEnd.apply(f,arguments)}),onKeydown:e[5]||(e[5]=Id(function(){return f.onRowKeyDown&&f.onRowKeyDown.apply(f,arguments)},["self"])),onMousedown:e[6]||(e[6]=function(){return f.onRowMouseDown&&f.onRowMouseDown.apply(f,arguments)}),onDragstart:e[7]||(e[7]=function(){return f.onRowDragStart&&f.onRowDragStart.apply(f,arguments)}),onDragover:e[8]||(e[8]=function(){return f.onRowDragOver&&f.onRowDragOver.apply(f,arguments)}),onDragleave:e[9]||(e[9]=function(){return f.onRowDragLeave&&f.onRowDragLeave.apply(f,arguments)}),onDragend:e[10]||(e[10]=function(){return f.onRowDragEnd&&f.onRowDragEnd.apply(f,arguments)}),onDrop:e[11]||(e[11]=function(){return f.onRowDrop&&f.onRowDrop.apply(f,arguments)})},f.getBodyRowPTOptions("bodyRow"),{"data-p-index":f.rowIndex,"data-p-selectable-row":!!n.selectionMode,"data-p-selected":n.selection&&f.isSelected,"data-p-selected-contextmenu":n.contextMenuSelection&&f.isSelectedWithContextMenu}),[(Me(!0),ft(Tr,null,ms(n.columns,function(P,L){return Me(),ft(Tr,null,[f.shouldRenderBodyCell(P)?(Me(),rn(C,{key:f.columnProp(P,"columnKey")||f.columnProp(P,"field")||L,rowData:n.rowData,column:P,rowIndex:f.rowIndex,index:L,selected:f.isSelected,frozenRow:n.frozenRow,rowspan:n.rowGroupMode==="rowspan"?f.calculateRowGroupSize(P):null,editMode:n.editMode,editing:n.editMode==="row"&&f.isRowEditing,editingMeta:n.editingMeta,virtualScrollerContentProps:n.virtualScrollerContentProps,ariaControls:n.expandedRowId+"_"+f.rowIndex+"_expansion",name:n.nameAttributeSelector,isRowExpanded:d.d_rowExpanded,expandedRowIcon:n.expandedRowIcon,collapsedRowIcon:n.collapsedRowIcon,editButtonProps:n.editButtonProps,onRadioChange:f.onRadioChange,onCheckboxChange:f.onCheckboxChange,onRowToggle:f.onRowToggle,onCellEditInit:f.onCellEditInit,onCellEditComplete:f.onCellEditComplete,onCellEditCancel:f.onCellEditCancel,onRowEditInit:f.onRowEditInit,onRowEditSave:f.onRowEditSave,onRowEditCancel:f.onRowEditCancel,onEditingMetaChange:f.onEditingMetaChange,unstyled:t.unstyled,pt:t.pt},null,8,["rowData","column","rowIndex","index","selected","frozenRow","rowspan","editMode","editing","editingMeta","virtualScrollerContentProps","ariaControls","name","isRowExpanded","expandedRowIcon","collapsedRowIcon","editButtonProps","onRadioChange","onCheckboxChange","onRowToggle","onCellEditInit","onCellEditComplete","onCellEditCancel","onRowEditInit","onRowEditSave","onRowEditCancel","onEditingMetaChange","unstyled","pt"])):Pn("",!0)],64)}),256))],16,dle)):Pn("",!0),n.templates.expansion&&n.expandedRows&&d.d_rowExpanded?(Me(),ft("tr",ot({key:2,id:n.expandedRowId+"_"+f.rowIndex+"_expansion",class:t.cx("rowExpansion"),role:"row"},t.ptm("rowExpansion")),[Ze("td",ot({colspan:f.columnsLength},xh(xh({},f.getColumnPT("bodycell")),t.ptm("rowExpansionCell"))),[(Me(),rn(Hr(n.templates.expansion),{data:n.rowData,index:f.rowIndex},null,8,["data","index"]))],16,fle)],16,hle)):Pn("",!0),n.templates.groupfooter&&n.rowGroupMode==="subheader"&&f.shouldRenderRowGroupFooter?(Me(),ft("tr",ot({key:3,class:t.cx("rowGroupFooter"),role:"row"},t.ptm("rowGroupFooter")),[Ze("td",ot({colspan:f.columnsLength-1},xh(xh({},f.getColumnPT("bodycell")),t.ptm("rowGroupFooterCell"))),[(Me(),rn(Hr(n.templates.groupfooter),{data:n.rowData,index:f.rowIndex},null,8,["data","index"]))],16,ple)],16)):Pn("",!0)],64))}ZN.render=gle;var XN={name:"TableBody",hostName:"DataTable",extends:Yi,emits:["rowgroup-toggle","row-click","row-dblclick","row-rightclick","row-touchend","row-keydown","row-mousedown","row-dragstart","row-dragover","row-dragleave","row-dragend","row-drop","row-toggle","radio-change","checkbox-change","cell-edit-init","cell-edit-complete","cell-edit-cancel","row-edit-init","row-edit-save","row-edit-cancel","editing-meta-change"],props:{value:{type:Array,default:null},columns:{type:null,default:null},frozenRow:{type:Boolean,default:!1},empty:{type:Boolean,default:!1},rowGroupMode:{type:String,default:null},groupRowsBy:{type:[Array,String,Function],default:null},expandableRowGroups:{type:Boolean,default:!1},expandedRowGroups:{type:Array,default:null},first:{type:Number,default:0},dataKey:{type:[String,Function],default:null},expandedRowIcon:{type:String,default:null},collapsedRowIcon:{type:String,default:null},expandedRows:{type:[Array,Object],default:null},selection:{type:[Array,Object],default:null},selectionKeys:{type:null,default:null},selectionMode:{type:String,default:null},rowHover:{type:Boolean,default:!1},contextMenu:{type:Boolean,default:!1},contextMenuSelection:{type:Object,default:null},rowClass:{type:null,default:null},rowStyle:{type:null,default:null},editMode:{type:String,default:null},compareSelectionBy:{type:String,default:"deepEquals"},editingRows:{type:Array,default:null},editingRowKeys:{type:null,default:null},editingMeta:{type:Object,default:null},templates:{type:null,default:null},scrollable:{type:Boolean,default:!1},editButtonProps:{type:Object,default:null},virtualScrollerContentProps:{type:Object,default:null},isVirtualScrollerDisabled:{type:Boolean,default:!1}},data:function(){return{rowGroupHeaderStyleObject:{}}},mounted:function(){this.frozenRow&&this.updateFrozenRowStickyPosition(),this.scrollable&&this.rowGroupMode==="subheader"&&this.updateFrozenRowGroupHeaderStickyPosition()},updated:function(){this.frozenRow&&this.updateFrozenRowStickyPosition(),this.scrollable&&this.rowGroupMode==="subheader"&&this.updateFrozenRowGroupHeaderStickyPosition()},methods:{getRowKey:function(e,n){return this.dataKey?Di(e,this.dataKey):n},updateFrozenRowStickyPosition:function(){this.$el.style.top=Bw(this.$el.previousElementSibling)+"px"},updateFrozenRowGroupHeaderStickyPosition:function(){var e=Bw(this.$el.previousElementSibling);this.rowGroupHeaderStyleObject.top=e+"px"},getVirtualScrollerProp:function(e,n){return n=n||this.virtualScrollerContentProps,n?n[e]:null},bodyRef:function(e){var n=this.getVirtualScrollerProp("contentRef");n&&n(e)}},computed:{rowGroupHeaderStyle:function(){return this.scrollable?{top:this.rowGroupHeaderStyleObject.top}:null},bodyContentStyle:function(){return this.getVirtualScrollerProp("contentStyle")},ptmTBodyOptions:function(){var e;return{context:{scrollable:(e=this.$parentInstance)===null||e===void 0||(e=e.$parentInstance)===null||e===void 0?void 0:e.scrollable}}},dataP:function(){return Rs({hoverable:this.rowHover||this.selectionMode,frozen:this.frozenRow})}},components:{DTBodyRow:ZN}},_le=["data-p"];function yle(t,e,n,l,d,f){var x=_r("DTBodyRow");return Me(),ft("tbody",ot({ref:f.bodyRef,class:t.cx("tbody"),role:"rowgroup",style:f.bodyContentStyle,"data-p":f.dataP},t.ptm("tbody",f.ptmTBodyOptions)),[n.empty?(Me(),rn(x,{key:1,empty:n.empty,columns:n.columns,templates:n.templates,unstyled:t.unstyled,pt:t.pt},null,8,["empty","columns","templates","unstyled","pt"])):(Me(!0),ft(Tr,{key:0},ms(n.value,function(s,C){return Me(),rn(x,{key:f.getRowKey(s,C),rowData:s,index:C,value:n.value,columns:n.columns,frozenRow:n.frozenRow,empty:n.empty,first:n.first,dataKey:n.dataKey,selection:n.selection,selectionKeys:n.selectionKeys,selectionMode:n.selectionMode,contextMenu:n.contextMenu,contextMenuSelection:n.contextMenuSelection,rowGroupMode:n.rowGroupMode,groupRowsBy:n.groupRowsBy,expandableRowGroups:n.expandableRowGroups,rowClass:n.rowClass,rowStyle:n.rowStyle,editMode:n.editMode,compareSelectionBy:n.compareSelectionBy,scrollable:n.scrollable,expandedRowIcon:n.expandedRowIcon,collapsedRowIcon:n.collapsedRowIcon,expandedRows:n.expandedRows,expandedRowGroups:n.expandedRowGroups,editingRows:n.editingRows,editingRowKeys:n.editingRowKeys,templates:n.templates,editButtonProps:n.editButtonProps,virtualScrollerContentProps:n.virtualScrollerContentProps,isVirtualScrollerDisabled:n.isVirtualScrollerDisabled,editingMeta:n.editingMeta,rowGroupHeaderStyle:f.rowGroupHeaderStyle,expandedRowId:t.$id,nameAttributeSelector:t.$attrSelector,onRowgroupToggle:e[0]||(e[0]=function(P){return t.$emit("rowgroup-toggle",P)}),onRowClick:e[1]||(e[1]=function(P){return t.$emit("row-click",P)}),onRowDblclick:e[2]||(e[2]=function(P){return t.$emit("row-dblclick",P)}),onRowRightclick:e[3]||(e[3]=function(P){return t.$emit("row-rightclick",P)}),onRowTouchend:e[4]||(e[4]=function(P){return t.$emit("row-touchend",P)}),onRowKeydown:e[5]||(e[5]=function(P){return t.$emit("row-keydown",P)}),onRowMousedown:e[6]||(e[6]=function(P){return t.$emit("row-mousedown",P)}),onRowDragstart:e[7]||(e[7]=function(P){return t.$emit("row-dragstart",P)}),onRowDragover:e[8]||(e[8]=function(P){return t.$emit("row-dragover",P)}),onRowDragleave:e[9]||(e[9]=function(P){return t.$emit("row-dragleave",P)}),onRowDragend:e[10]||(e[10]=function(P){return t.$emit("row-dragend",P)}),onRowDrop:e[11]||(e[11]=function(P){return t.$emit("row-drop",P)}),onRowToggle:e[12]||(e[12]=function(P){return t.$emit("row-toggle",P)}),onRadioChange:e[13]||(e[13]=function(P){return t.$emit("radio-change",P)}),onCheckboxChange:e[14]||(e[14]=function(P){return t.$emit("checkbox-change",P)}),onCellEditInit:e[15]||(e[15]=function(P){return t.$emit("cell-edit-init",P)}),onCellEditComplete:e[16]||(e[16]=function(P){return t.$emit("cell-edit-complete",P)}),onCellEditCancel:e[17]||(e[17]=function(P){return t.$emit("cell-edit-cancel",P)}),onRowEditInit:e[18]||(e[18]=function(P){return t.$emit("row-edit-init",P)}),onRowEditSave:e[19]||(e[19]=function(P){return t.$emit("row-edit-save",P)}),onRowEditCancel:e[20]||(e[20]=function(P){return t.$emit("row-edit-cancel",P)}),onEditingMetaChange:e[21]||(e[21]=function(P){return t.$emit("editing-meta-change",P)}),unstyled:t.unstyled,pt:t.pt},null,8,["rowData","index","value","columns","frozenRow","empty","first","dataKey","selection","selectionKeys","selectionMode","contextMenu","contextMenuSelection","rowGroupMode","groupRowsBy","expandableRowGroups","rowClass","rowStyle","editMode","compareSelectionBy","scrollable","expandedRowIcon","collapsedRowIcon","expandedRows","expandedRowGroups","editingRows","editingRowKeys","templates","editButtonProps","virtualScrollerContentProps","isVirtualScrollerDisabled","editingMeta","rowGroupHeaderStyle","expandedRowId","nameAttributeSelector","unstyled","pt"])}),128))],16,_le)}XN.render=yle;var YN={name:"FooterCell",hostName:"DataTable",extends:Yi,props:{column:{type:Object,default:null},index:{type:Number,default:null}},data:function(){return{styleObject:{}}},mounted:function(){this.columnProp("frozen")&&this.updateStickyPosition()},updated:function(){this.columnProp("frozen")&&this.updateStickyPosition()},methods:{columnProp:function(e){return uf(this.column,e)},getColumnPT:function(e){var n,l,d={props:this.column.props,parent:{instance:this,props:this.$props,state:this.$data},context:{index:this.index,size:(n=this.$parentInstance)===null||n===void 0||(n=n.$parentInstance)===null||n===void 0?void 0:n.size,showGridlines:((l=this.$parentInstance)===null||l===void 0||(l=l.$parentInstance)===null||l===void 0?void 0:l.showGridlines)||!1}};return ot(this.ptm("column.".concat(e),{column:d}),this.ptm("column.".concat(e),d),this.ptmo(this.getColumnProp(),e,d))},getColumnProp:function(){return this.column.props&&this.column.props.pt?this.column.props.pt:void 0},updateStickyPosition:function(){if(this.columnProp("frozen")){var e=this.columnProp("alignFrozen");if(e==="right"){var n=0,l=zT(this.$el,'[data-p-frozen-column="true"]');l&&(n=Ga(l)+parseFloat(l.style["inset-inline-end"]||0)),this.styleObject.insetInlineEnd=n+"px"}else{var d=0,f=FT(this.$el,'[data-p-frozen-column="true"]');f&&(d=Ga(f)+parseFloat(f.style["inset-inline-start"]||0)),this.styleObject.insetInlineStart=d+"px"}}}},computed:{containerClass:function(){return[this.columnProp("footerClass"),this.columnProp("class"),this.cx("footerCell")]},containerStyle:function(){var e=this.columnProp("footerStyle"),n=this.columnProp("style");return this.columnProp("frozen")?[n,e,this.styleObject]:[n,e]}}};function P0(t){"@babel/helpers - typeof";return P0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},P0(t)}function u5(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);e&&(l=l.filter(function(d){return Object.getOwnPropertyDescriptor(t,d).enumerable})),n.push.apply(n,l)}return n}function d5(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?u5(Object(n),!0).forEach(function(l){vle(t,l,n[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):u5(Object(n)).forEach(function(l){Object.defineProperty(t,l,Object.getOwnPropertyDescriptor(n,l))})}return t}function vle(t,e,n){return(e=ble(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ble(t){var e=xle(t,"string");return P0(e)=="symbol"?e:e+""}function xle(t,e){if(P0(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var l=n.call(t,e);if(P0(l)!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var wle=["colspan","rowspan","data-p-frozen-column"];function Tle(t,e,n,l,d,f){return Me(),ft("td",ot({style:f.containerStyle,class:f.containerClass,role:"cell",colspan:f.columnProp("colspan"),rowspan:f.columnProp("rowspan")},d5(d5({},f.getColumnPT("root")),f.getColumnPT("footerCell")),{"data-p-frozen-column":f.columnProp("frozen")}),[n.column.children&&n.column.children.footer?(Me(),rn(Hr(n.column.children.footer),{key:0,column:n.column},null,8,["column"])):Pn("",!0),f.columnProp("footer")?(Me(),ft("span",ot({key:1,class:t.cx("columnFooter")},f.getColumnPT("columnFooter")),Fr(f.columnProp("footer")),17)):Pn("",!0)],16,wle)}YN.render=Tle;function Sle(t,e){var n=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=Ele(t))||e){n&&(t=n);var l=0,d=function(){};return{s:d,n:function(){return l>=t.length?{done:!0}:{done:!1,value:t[l++]}},e:function(P){throw P},f:d}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var f,x=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var P=n.next();return x=P.done,P},e:function(P){s=!0,f=P},f:function(){try{x||n.return==null||n.return()}finally{if(s)throw f}}}}function Ele(t,e){if(t){if(typeof t=="string")return h5(t,e);var n={}.toString.call(t).slice(8,-1);return n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set"?Array.from(t):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?h5(t,e):void 0}}function h5(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,l=Array(e);n<e;n++)l[n]=t[n];return l}var JN={name:"TableFooter",hostName:"DataTable",extends:Yi,props:{columnGroup:{type:null,default:null},columns:{type:Object,default:null}},provide:function(){return{$rows:this.d_footerRows,$columns:this.d_footerColumns}},data:function(){return{d_footerRows:new jg({type:"Row"}),d_footerColumns:new jg({type:"Column"})}},beforeUnmount:function(){this.d_footerRows.clear(),this.d_footerColumns.clear()},methods:{columnProp:function(e,n){return uf(e,n)},getColumnGroupPT:function(e){var n={props:this.getColumnGroupProps(),parent:{instance:this,props:this.$props,state:this.$data},context:{type:"footer",scrollable:this.ptmTFootOptions.context.scrollable}};return ot(this.ptm("columnGroup.".concat(e),{columnGroup:n}),this.ptm("columnGroup.".concat(e),n),this.ptmo(this.getColumnGroupProps(),e,n))},getColumnGroupProps:function(){return this.columnGroup&&this.columnGroup.props&&this.columnGroup.props.pt?this.columnGroup.props.pt:void 0},getRowPT:function(e,n,l){var d={props:e.props,parent:{instance:this,props:this.$props,state:this.$data},context:{index:l}};return ot(this.ptm("row.".concat(n),{row:d}),this.ptm("row.".concat(n),d),this.ptmo(this.getRowProp(e),n,d))},getRowProp:function(e){return e.props&&e.props.pt?e.props.pt:void 0},getFooterRows:function(){var e;return(e=this.d_footerRows)===null||e===void 0?void 0:e.get(this.columnGroup,this.columnGroup.children)},getFooterColumns:function(e){var n;return(n=this.d_footerColumns)===null||n===void 0?void 0:n.get(e,e.children)}},computed:{hasFooter:function(){var e=!1;if(this.columnGroup)e=!0;else if(this.columns){var n=Sle(this.columns),l;try{for(n.s();!(l=n.n()).done;){var d=l.value;if(this.columnProp(d,"footer")||d.children&&d.children.footer){e=!0;break}}}catch(f){n.e(f)}finally{n.f()}}return e},ptmTFootOptions:function(){var e;return{context:{scrollable:(e=this.$parentInstance)===null||e===void 0||(e=e.$parentInstance)===null||e===void 0?void 0:e.scrollable}}}},components:{DTFooterCell:YN}};function R0(t){"@babel/helpers - typeof";return R0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},R0(t)}function f5(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);e&&(l=l.filter(function(d){return Object.getOwnPropertyDescriptor(t,d).enumerable})),n.push.apply(n,l)}return n}function vx(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?f5(Object(n),!0).forEach(function(l){Cle(t,l,n[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):f5(Object(n)).forEach(function(l){Object.defineProperty(t,l,Object.getOwnPropertyDescriptor(n,l))})}return t}function Cle(t,e,n){return(e=Ile(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ile(t){var e=Ale(t,"string");return R0(e)=="symbol"?e:e+""}function Ale(t,e){if(R0(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var l=n.call(t,e);if(R0(l)!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Ple=["data-p-scrollable"];function Rle(t,e,n,l,d,f){var x,s=_r("DTFooterCell");return f.hasFooter?(Me(),ft("tfoot",ot({key:0,class:t.cx("tfoot"),style:t.sx("tfoot"),role:"rowgroup"},n.columnGroup?vx(vx({},t.ptm("tfoot",f.ptmTFootOptions)),f.getColumnGroupPT("root")):t.ptm("tfoot",f.ptmTFootOptions),{"data-p-scrollable":(x=t.$parentInstance)===null||x===void 0||(x=x.$parentInstance)===null||x===void 0?void 0:x.scrollable,"data-pc-section":"tfoot"}),[n.columnGroup?(Me(!0),ft(Tr,{key:1},ms(f.getFooterRows(),function(C,P){return Me(),ft("tr",ot({key:P,role:"row"},{ref_for:!0},vx(vx({},t.ptm("footerRow")),f.getRowPT(C,"root",P))),[(Me(!0),ft(Tr,null,ms(f.getFooterColumns(C),function(L,$){return Me(),ft(Tr,{key:f.columnProp(L,"columnKey")||f.columnProp(L,"field")||$},[f.columnProp(L,"hidden")?Pn("",!0):(Me(),rn(s,{key:0,column:L,index:P,pt:t.pt},null,8,["column","index","pt"]))],64)}),128))],16)}),128)):(Me(),ft("tr",ot({key:0,role:"row"},t.ptm("footerRow")),[(Me(!0),ft(Tr,null,ms(n.columns,function(C,P){return Me(),ft(Tr,{key:f.columnProp(C,"columnKey")||f.columnProp(C,"field")||P},[f.columnProp(C,"hidden")?Pn("",!0):(Me(),rn(s,{key:0,column:C,pt:t.pt},null,8,["column","pt"]))],64)}),128))],16))],16,Ple)):Pn("",!0)}JN.render=Rle;function k0(t){"@babel/helpers - typeof";return k0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},k0(t)}function p5(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);e&&(l=l.filter(function(d){return Object.getOwnPropertyDescriptor(t,d).enumerable})),n.push.apply(n,l)}return n}function ep(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?p5(Object(n),!0).forEach(function(l){kle(t,l,n[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):p5(Object(n)).forEach(function(l){Object.defineProperty(t,l,Object.getOwnPropertyDescriptor(n,l))})}return t}function kle(t,e,n){return(e=Ole(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ole(t){var e=Mle(t,"string");return k0(e)=="symbol"?e:e+""}function Mle(t,e){if(k0(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var l=n.call(t,e);if(k0(l)!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var lP={name:"ColumnFilter",hostName:"DataTable",extends:Yi,emits:["filter-change","filter-apply","operator-change","matchmode-change","constraint-add","constraint-remove","filter-clear","apply-click"],props:{field:{type:String,default:null},type:{type:String,default:"text"},display:{type:String,default:null},showMenu:{type:Boolean,default:!0},matchMode:{type:String,default:null},showOperator:{type:Boolean,default:!0},showClearButton:{type:Boolean,default:!0},showApplyButton:{type:Boolean,default:!0},showMatchModes:{type:Boolean,default:!0},showAddButton:{type:Boolean,default:!0},matchModeOptions:{type:Array,default:null},maxConstraints:{type:Number,default:2},filterElement:{type:Function,default:null},filterHeaderTemplate:{type:Function,default:null},filterFooterTemplate:{type:Function,default:null},filterClearTemplate:{type:Function,default:null},filterApplyTemplate:{type:Function,default:null},filterIconTemplate:{type:Function,default:null},filterAddIconTemplate:{type:Function,default:null},filterRemoveIconTemplate:{type:Function,default:null},filterClearIconTemplate:{type:Function,default:null},filters:{type:Object,default:null},filtersStore:{type:Object,default:null},filterMenuClass:{type:String,default:null},filterMenuStyle:{type:null,default:null},filterInputProps:{type:null,default:null},filterButtonProps:{type:null,default:null},column:null},data:function(){return{overlayVisible:!1,defaultMatchMode:null,defaultOperator:null}},overlay:null,selfClick:!1,overlayEventListener:null,beforeUnmount:function(){this.overlayEventListener&&(Fh.off("overlay-click",this.overlayEventListener),this.overlayEventListener=null),this.overlay&&(Ag.clear(this.overlay),this.onOverlayHide())},mounted:function(){if(this.filters&&this.filters[this.field]){var e=this.filters[this.field];e.operator?(this.defaultMatchMode=e.constraints[0].matchMode,this.defaultOperator=e.operator):this.defaultMatchMode=this.filters[this.field].matchMode}},methods:{getColumnPT:function(e,n){var l=ep({props:this.column.props,parent:{instance:this,props:this.$props,state:this.$data}},n);return ot(this.ptm("column.".concat(e),{column:l}),this.ptm("column.".concat(e),l),this.ptmo(this.getColumnProp(),e,l))},getColumnProp:function(){return this.column.props&&this.column.props.pt?this.column.props.pt:void 0},ptmFilterConstraintOptions:function(e){return{context:{highlighted:e&&this.isRowMatchModeSelected(e.value)}}},clearFilter:function(){var e=ep({},this.filters);e[this.field].operator?(e[this.field].constraints.splice(1),e[this.field].operator=this.defaultOperator,e[this.field].constraints[0]={value:null,matchMode:this.defaultMatchMode}):(e[this.field].value=null,e[this.field].matchMode=this.defaultMatchMode),this.$emit("filter-clear"),this.$emit("filter-change",e),this.$emit("filter-apply"),this.hide()},applyFilter:function(){this.$emit("apply-click",{field:this.field,constraints:this.filters[this.field]}),this.$emit("filter-apply"),this.hide()},hasFilter:function(){if(this.filtersStore){var e=this.filtersStore[this.field];if(e)return e.operator?!this.isFilterBlank(e.constraints[0].value):!this.isFilterBlank(e.value)}return!1},hasRowFilter:function(){return this.filters[this.field]&&!this.isFilterBlank(this.filters[this.field].value)},isFilterBlank:function(e){return e!=null?typeof e=="string"&&e.trim().length==0||e instanceof Array&&e.length==0:!0},toggleMenu:function(e){this.overlayVisible=!this.overlayVisible,e.preventDefault()},onToggleButtonKeyDown:function(e){switch(e.code){case"Enter":case"NumpadEnter":case"Space":this.toggleMenu(e);break;case"Escape":this.overlayVisible=!1;break}},onRowMatchModeChange:function(e){var n=ep({},this.filters);n[this.field].matchMode=e,this.$emit("matchmode-change",{field:this.field,matchMode:e}),this.$emit("filter-change",n),this.$emit("filter-apply"),this.hide()},onRowMatchModeKeyDown:function(e){var n=e.target;switch(e.code){case"ArrowDown":var l=this.findNextItem(n);l&&(n.removeAttribute("tabindex"),l.tabIndex="0",l.focus()),e.preventDefault();break;case"ArrowUp":var d=this.findPrevItem(n);d&&(n.removeAttribute("tabindex"),d.tabIndex="0",d.focus()),e.preventDefault();break}},isRowMatchModeSelected:function(e){return this.filters[this.field].matchMode===e},onOperatorChange:function(e){var n=ep({},this.filters);n[this.field].operator=e,this.$emit("filter-change",n),this.$emit("operator-change",{field:this.field,operator:e}),this.showApplyButton||this.$emit("filter-apply")},onMenuMatchModeChange:function(e,n){var l=ep({},this.filters);l[this.field].constraints[n].matchMode=e,this.$emit("matchmode-change",{field:this.field,matchMode:e,index:n}),this.showApplyButton||this.$emit("filter-apply")},addConstraint:function(){var e=ep({},this.filters),n={value:null,matchMode:this.defaultMatchMode};e[this.field].constraints.push(n),this.$emit("constraint-add",{field:this.field,constraint:n}),this.$emit("filter-change",e),this.showApplyButton||this.$emit("filter-apply")},removeConstraint:function(e){var n=ep({},this.filters),l=n[this.field].constraints.splice(e,1);this.$emit("constraint-remove",{field:this.field,constraint:l}),this.$emit("filter-change",n),this.showApplyButton||this.$emit("filter-apply")},filterCallback:function(){this.$emit("filter-apply")},findNextItem:function(e){var n=e.nextElementSibling;return n?Cs(n,"data-pc-section")==="filterconstraintseparator"?this.findNextItem(n):n:e.parentElement.firstElementChild},findPrevItem:function(e){var n=e.previousElementSibling;return n?Cs(n,"data-pc-section")==="filterconstraintseparator"?this.findPrevItem(n):n:e.parentElement.lastElementChild},hide:function(){this.overlayVisible=!1,this.showMenuButton&&Ea(this.$refs.icon.$el)},onContentClick:function(e){this.selfClick=!0,Fh.emit("overlay-click",{originalEvent:e,target:this.overlay})},onContentMouseDown:function(){this.selfClick=!0},onOverlayEnter:function(e){var n=this;this.filterMenuStyle&&zw(this.overlay,this.filterMenuStyle),Ag.set("overlay",e,this.$primevue.config.zIndex.overlay),zw(e,{position:"absolute",top:"0"}),GB(this.overlay,this.$refs.icon.$el),this.bindOutsideClickListener(),this.bindScrollListener(),this.bindResizeListener(),this.overlayEventListener=function(l){n.isOutsideClicked(l.target)||(n.selfClick=!0)},Fh.on("overlay-click",this.overlayEventListener)},onOverlayAfterEnter:function(){var e;(e=this.overlay)===null||e===void 0||(e=e.$focustrap)===null||e===void 0||e.autoFocus()},onOverlayLeave:function(){this.onOverlayHide()},onOverlayAfterLeave:function(e){Ag.clear(e)},onOverlayHide:function(){this.unbindOutsideClickListener(),this.unbindResizeListener(),this.unbindScrollListener(),this.overlay=null,Fh.off("overlay-click",this.overlayEventListener),this.overlayEventListener=null},overlayRef:function(e){this.overlay=e},isOutsideClicked:function(e){return!this.isTargetClicked(e)&&this.overlay&&!(this.overlay.isSameNode(e)||this.overlay.contains(e))},isTargetClicked:function(e){return this.$refs.icon&&(this.$refs.icon.$el.isSameNode(e)||this.$refs.icon.$el.contains(e))},bindOutsideClickListener:function(){var e=this;this.outsideClickListener||(this.outsideClickListener=function(n){e.overlayVisible&&!e.selfClick&&e.isOutsideClicked(n.target)&&(e.overlayVisible=!1),e.selfClick=!1},document.addEventListener("click",this.outsideClickListener,!0))},unbindOutsideClickListener:function(){this.outsideClickListener&&(document.removeEventListener("click",this.outsideClickListener,!0),this.outsideClickListener=null,this.selfClick=!1)},bindScrollListener:function(){var e=this;this.scrollHandler||(this.scrollHandler=new dN(this.$refs.icon.$el,function(){e.overlayVisible&&e.hide()})),this.scrollHandler.bindScrollListener()},unbindScrollListener:function(){this.scrollHandler&&this.scrollHandler.unbindScrollListener()},bindResizeListener:function(){var e=this;this.resizeListener||(this.resizeListener=function(){e.overlayVisible&&!ZB()&&e.hide()},window.addEventListener("resize",this.resizeListener))},unbindResizeListener:function(){this.resizeListener&&(window.removeEventListener("resize",this.resizeListener),this.resizeListener=null)}},computed:{showMenuButton:function(){return this.showMenu&&(this.display==="row"?this.type!=="boolean":!0)},overlayId:function(){return this.$id+"_overlay"},matchModes:function(){var e=this;return this.matchModeOptions||this.$primevue.config.filterMatchModeOptions[this.type].map(function(n){return{label:e.$primevue.config.locale[n],value:n}})},isShowMatchModes:function(){return this.type!=="boolean"&&this.showMatchModes&&this.matchModes},operatorOptions:function(){return[{label:this.$primevue.config.locale.matchAll,value:Lw.AND},{label:this.$primevue.config.locale.matchAny,value:Lw.OR}]},noFilterLabel:function(){return this.$primevue.config.locale?this.$primevue.config.locale.noFilter:void 0},isShowOperator:function(){return this.showOperator&&this.filters[this.field].operator},operator:function(){return this.filters[this.field].operator},fieldConstraints:function(){return this.filters[this.field].constraints||[this.filters[this.field]]},showRemoveIcon:function(){return this.fieldConstraints.length>1},removeRuleButtonLabel:function(){return this.$primevue.config.locale?this.$primevue.config.locale.removeRule:void 0},addRuleButtonLabel:function(){return this.$primevue.config.locale?this.$primevue.config.locale.addRule:void 0},isShowAddConstraint:function(){return this.showAddButton&&this.filters[this.field].operator&&this.fieldConstraints&&this.fieldConstraints.length<this.maxConstraints},clearButtonLabel:function(){return this.$primevue.config.locale?this.$primevue.config.locale.clear:void 0},applyButtonLabel:function(){return this.$primevue.config.locale?this.$primevue.config.locale.apply:void 0},columnFilterButtonAriaLabel:function(){var e;return(e=this.$primevue.config.locale)!==null&&e!==void 0&&e.aria?this.overlayVisible?this.$primevue.config.locale.aria.hideFilterMenu:this.$primevue.config.locale.aria.showFilterMenu:void 0},filterOperatorAriaLabel:function(){return this.$primevue.config.locale?this.$primevue.config.locale.filterOperator:void 0},filterRuleAriaLabel:function(){return this.$primevue.config.locale?this.$primevue.config.locale.filterConstraint:void 0},ptmHeaderFilterClearParams:function(){return{context:{hidden:this.hasRowFilter()}}},ptmFilterMenuParams:function(){return{context:{overlayVisible:this.overlayVisible,active:this.hasFilter()}}}},components:{Select:VT,Button:Pg,Portal:iP,FilterSlashIcon:jN,FilterFillIcon:UN,FilterIcon:$N,TrashIcon:HN,PlusIcon:GN},directives:{focustrap:Aae}};function O0(t){"@babel/helpers - typeof";return O0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},O0(t)}function m5(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);e&&(l=l.filter(function(d){return Object.getOwnPropertyDescriptor(t,d).enumerable})),n.push.apply(n,l)}return n}function bx(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?m5(Object(n),!0).forEach(function(l){Dle(t,l,n[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):m5(Object(n)).forEach(function(l){Object.defineProperty(t,l,Object.getOwnPropertyDescriptor(n,l))})}return t}function Dle(t,e,n){return(e=Lle(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Lle(t){var e=zle(t,"string");return O0(e)=="symbol"?e:e+""}function zle(t,e){if(O0(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var l=n.call(t,e);if(O0(l)!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Fle=["id","aria-modal"],Ble=["onClick","onKeydown","tabindex"];function Nle(t,e,n,l,d,f){var x=_r("Button"),s=_r("Select"),C=_r("Portal"),P=Cd("focustrap");return Me(),ft("div",ot({class:t.cx("filter")},f.getColumnPT("filter")),[n.display==="row"?(Me(),ft("div",ot({key:0,class:t.cx("filterElementContainer")},bx(bx({},n.filterInputProps),f.getColumnPT("filterElementContainer"))),[(Me(),rn(Hr(n.filterElement),{field:n.field,filterModel:n.filters[n.field],filterCallback:f.filterCallback},null,8,["field","filterModel","filterCallback"]))],16)):Pn("",!0),f.showMenuButton?(Me(),rn(x,ot({key:1,ref:"icon","aria-label":f.columnFilterButtonAriaLabel,"aria-haspopup":"true","aria-expanded":d.overlayVisible,"aria-controls":d.overlayVisible?f.overlayId:void 0,class:t.cx("pcColumnFilterButton"),unstyled:t.unstyled,onClick:e[0]||(e[0]=function(L){return f.toggleMenu(L)}),onKeydown:e[1]||(e[1]=function(L){return f.onToggleButtonKeyDown(L)})},bx(bx({},f.getColumnPT("pcColumnFilterButton",f.ptmFilterMenuParams)),n.filterButtonProps.filter)),{icon:zr(function(L){return[(Me(),rn(Hr(n.filterIconTemplate||(f.hasFilter()?"FilterFillIcon":"FilterIcon")),ot({class:L.class},f.getColumnPT("filterMenuIcon")),null,16,["class"]))]}),_:1},16,["aria-label","aria-expanded","aria-controls","class","unstyled"])):Pn("",!0),pr(C,null,{default:zr(function(){return[pr(O6,ot({name:"p-connected-overlay",onEnter:f.onOverlayEnter,onAfterEnter:f.onOverlayAfterEnter,onLeave:f.onOverlayLeave,onAfterLeave:f.onOverlayAfterLeave},f.getColumnPT("transition")),{default:zr(function(){return[d.overlayVisible?Xi((Me(),ft("div",ot({key:0,ref:f.overlayRef,id:f.overlayId,"aria-modal":d.overlayVisible,role:"dialog",class:[t.cx("filterOverlay"),n.filterMenuClass],onKeydown:e[10]||(e[10]=rC(function(){return f.hide&&f.hide.apply(f,arguments)},["escape"])),onClick:e[11]||(e[11]=function(){return f.onContentClick&&f.onContentClick.apply(f,arguments)}),onMousedown:e[12]||(e[12]=function(){return f.onContentMouseDown&&f.onContentMouseDown.apply(f,arguments)})},f.getColumnPT("filterOverlay")),[(Me(),rn(Hr(n.filterHeaderTemplate),{field:n.field,filterModel:n.filters[n.field],filterCallback:f.filterCallback},null,8,["field","filterModel","filterCallback"])),n.display==="row"?(Me(),ft("ul",ot({key:0,class:t.cx("filterConstraintList")},f.getColumnPT("filterConstraintList")),[(Me(!0),ft(Tr,null,ms(f.matchModes,function(L,$){return Me(),ft("li",ot({key:L.label,class:t.cx("filterConstraint",{matchMode:L}),onClick:function(j){return f.onRowMatchModeChange(L.value)},onKeydown:[e[2]||(e[2]=function(V){return f.onRowMatchModeKeyDown(V)}),rC(Id(function(V){return f.onRowMatchModeChange(L.value)},["prevent"]),["enter"])],tabindex:$===0?"0":null},{ref_for:!0},f.getColumnPT("filterConstraint",f.ptmFilterConstraintOptions(L))),Fr(L.label),17,Ble)}),128)),Ze("li",ot({class:t.cx("filterConstraintSeparator")},f.getColumnPT("filterConstraintSeparator")),null,16),Ze("li",ot({class:t.cx("filterConstraint"),onClick:e[3]||(e[3]=function(L){return f.clearFilter()}),onKeydown:[e[4]||(e[4]=function(L){return f.onRowMatchModeKeyDown(L)}),e[5]||(e[5]=rC(function(L){return t.onRowClearItemClick()},["enter"]))]},f.getColumnPT("filterConstraint")),Fr(f.noFilterLabel),17)],16)):(Me(),ft(Tr,{key:1},[f.isShowOperator?(Me(),ft("div",ot({key:0,class:t.cx("filterOperator")},f.getColumnPT("filterOperator")),[pr(s,{options:f.operatorOptions,modelValue:f.operator,"aria-label":f.filterOperatorAriaLabel,class:wr(t.cx("pcFilterOperatorDropdown")),optionLabel:"label",optionValue:"value","onUpdate:modelValue":e[6]||(e[6]=function(L){return f.onOperatorChange(L)}),unstyled:t.unstyled,pt:f.getColumnPT("pcFilterOperatorDropdown")},null,8,["options","modelValue","aria-label","class","unstyled","pt"])],16)):Pn("",!0),Ze("div",ot({class:t.cx("filterRuleList")},f.getColumnPT("filterRuleList")),[(Me(!0),ft(Tr,null,ms(f.fieldConstraints,function(L,$){return Me(),ft("div",ot({key:$,class:t.cx("filterRule")},{ref_for:!0},f.getColumnPT("filterRule")),[f.isShowMatchModes?(Me(),rn(s,{key:0,options:f.matchModes,modelValue:L.matchMode,class:wr(t.cx("pcFilterConstraintDropdown")),optionLabel:"label",optionValue:"value","aria-label":f.filterRuleAriaLabel,"onUpdate:modelValue":function(j){return f.onMenuMatchModeChange(j,$)},unstyled:t.unstyled,pt:f.getColumnPT("pcFilterConstraintDropdown")},null,8,["options","modelValue","class","aria-label","onUpdate:modelValue","unstyled","pt"])):Pn("",!0),n.display==="menu"?(Me(),rn(Hr(n.filterElement),{key:1,field:n.field,filterModel:L,filterCallback:f.filterCallback,applyFilter:f.applyFilter},null,8,["field","filterModel","filterCallback","applyFilter"])):Pn("",!0),f.showRemoveIcon?(Me(),ft("div",ot({key:2,ref_for:!0},f.getColumnPT("filterRemove")),[pr(x,ot({type:"button",class:t.cx("pcFilterRemoveRuleButton"),onClick:function(j){return f.removeConstraint($)},label:f.removeRuleButtonLabel,unstyled:t.unstyled},{ref_for:!0},n.filterButtonProps.popover.removeRule,{pt:f.getColumnPT("pcFilterRemoveRuleButton")}),{icon:zr(function(V){return[(Me(),rn(Hr(n.filterRemoveIconTemplate||"TrashIcon"),ot({class:V.class},{ref_for:!0},f.getColumnPT("pcFilterRemoveRuleButton").icon),null,16,["class"]))]}),_:1},16,["class","onClick","label","unstyled","pt"])],16)):Pn("",!0)],16)}),128))],16),f.isShowAddConstraint?(Me(),ft("div",Xw(ot({key:1},f.getColumnPT("filterAddButtonContainer"))),[pr(x,ot({type:"button",label:f.addRuleButtonLabel,iconPos:"left",class:t.cx("pcFilterAddRuleButton"),onClick:e[7]||(e[7]=function(L){return f.addConstraint()}),unstyled:t.unstyled},n.filterButtonProps.popover.addRule,{pt:f.getColumnPT("pcFilterAddRuleButton")}),{icon:zr(function(L){return[(Me(),rn(Hr(n.filterAddIconTemplate||"PlusIcon"),ot({class:L.class},f.getColumnPT("pcFilterAddRuleButton").icon),null,16,["class"]))]}),_:1},16,["label","class","unstyled","pt"])],16)):Pn("",!0),Ze("div",ot({class:t.cx("filterButtonbar")},f.getColumnPT("filterButtonbar")),[!n.filterClearTemplate&&n.showClearButton?(Me(),rn(x,ot({key:0,type:"button",class:t.cx("pcFilterClearButton"),label:f.clearButtonLabel,onClick:e[8]||(e[8]=function(L){return f.clearFilter()}),unstyled:t.unstyled},n.filterButtonProps.popover.clear,{pt:f.getColumnPT("pcFilterClearButton")}),null,16,["class","label","unstyled","pt"])):(Me(),rn(Hr(n.filterClearTemplate),{key:1,field:n.field,filterModel:n.filters[n.field],filterCallback:f.clearFilter},null,8,["field","filterModel","filterCallback"])),n.showApplyButton?(Me(),ft(Tr,{key:2},[n.filterApplyTemplate?(Me(),rn(Hr(n.filterApplyTemplate),{key:1,field:n.field,filterModel:n.filters[n.field],filterCallback:f.applyFilter},null,8,["field","filterModel","filterCallback"])):(Me(),rn(x,ot({key:0,type:"button",class:t.cx("pcFilterApplyButton"),label:f.applyButtonLabel,onClick:e[9]||(e[9]=function(L){return f.applyFilter()}),unstyled:t.unstyled},n.filterButtonProps.popover.apply,{pt:f.getColumnPT("pcFilterApplyButton")}),null,16,["class","label","unstyled","pt"]))],64)):Pn("",!0)],16)],64)),(Me(),rn(Hr(n.filterFooterTemplate),{field:n.field,filterModel:n.filters[n.field],filterCallback:f.filterCallback},null,8,["field","filterModel","filterCallback"]))],16,Fle)),[[P]]):Pn("",!0)]}),_:1},16,["onEnter","onAfterEnter","onLeave","onAfterLeave"])]}),_:1})],16)}lP.render=Nle;var cP={name:"HeaderCheckbox",hostName:"DataTable",extends:Yi,emits:["change"],props:{checked:null,disabled:null,column:null,headerCheckboxIconTemplate:{type:Function,default:null}},methods:{getColumnPT:function(e){var n={props:this.column.props,parent:{instance:this,props:this.$props,state:this.$data},context:{checked:this.checked,disabled:this.disabled}};return ot(this.ptm("column.".concat(e),{column:n}),this.ptm("column.".concat(e),n),this.ptmo(this.getColumnProp(),e,n))},getColumnProp:function(){return this.column.props&&this.column.props.pt?this.column.props.pt:void 0},onChange:function(e){this.$emit("change",{originalEvent:e,checked:!this.checked})}},computed:{headerCheckboxAriaLabel:function(){return this.$primevue.config.locale.aria?this.checked?this.$primevue.config.locale.aria.selectAll:this.$primevue.config.locale.aria.unselectAll:void 0}},components:{CheckIcon:s_,Checkbox:aP}};function Vle(t,e,n,l,d,f){var x=_r("Checkbox");return Me(),rn(x,{modelValue:n.checked,binary:!0,disabled:n.disabled,"aria-label":f.headerCheckboxAriaLabel,onChange:f.onChange,unstyled:t.unstyled,pt:f.getColumnPT("pcHeaderCheckbox")},{icon:zr(function(s){return[n.headerCheckboxIconTemplate?(Me(),rn(Hr(n.headerCheckboxIconTemplate),{key:0,checked:s.checked,class:wr(s.class)},null,8,["checked","class"])):Pn("",!0)]}),_:1},8,["modelValue","disabled","aria-label","onChange","unstyled","pt"])}cP.render=Vle;var QN={name:"FilterHeaderCell",hostName:"DataTable",extends:Yi,emits:["checkbox-change","filter-change","filter-apply","operator-change","matchmode-change","constraint-add","constraint-remove","apply-click"],props:{column:{type:Object,default:null},index:{type:Number,default:null},allRowsSelected:{type:Boolean,default:!1},empty:{type:Boolean,default:!1},display:{type:String,default:"row"},filters:{type:Object,default:null},filtersStore:{type:Object,default:null},rowGroupMode:{type:String,default:null},groupRowsBy:{type:[Array,String,Function],default:null},filterInputProps:{type:null,default:null},filterButtonProps:{type:null,default:null}},data:function(){return{styleObject:{}}},mounted:function(){this.columnProp("frozen")&&this.updateStickyPosition()},updated:function(){this.columnProp("frozen")&&this.updateStickyPosition()},methods:{columnProp:function(e){return uf(this.column,e)},getColumnPT:function(e){if(!this.column)return null;var n={props:this.column.props,parent:{instance:this,props:this.$props,state:this.$data},context:{index:this.index}};return ot(this.ptm("column.".concat(e),{column:n}),this.ptm("column.".concat(e),n),this.ptmo(this.getColumnProp(),e,n))},getColumnProp:function(){return this.column.props&&this.column.props.pt?this.column.props.pt:void 0},updateStickyPosition:function(){if(this.columnProp("frozen")){var e=this.columnProp("alignFrozen");if(e==="right"){var n=0,l=zT(this.$el,'[data-p-frozen-column="true"]');l&&(n=Ga(l)+parseFloat(l.style["inset-inline-end"]||0)),this.styleObject.insetInlineEnd=n+"px"}else{var d=0,f=FT(this.$el,'[data-p-frozen-column="true"]');f&&(d=Ga(f)+parseFloat(f.style["inset-inline-start"]||0)),this.styleObject.insetInlineStart=d+"px"}}}},computed:{getFilterColumnHeaderClass:function(){return[this.cx("headerCell",{column:this.column}),this.columnProp("filterHeaderClass"),this.columnProp("class")]},getFilterColumnHeaderStyle:function(){return this.columnProp("frozen")?[this.columnProp("filterHeaderStyle"),this.columnProp("style"),this.styleObject]:[this.columnProp("filterHeaderStyle"),this.columnProp("style")]}},components:{DTHeaderCheckbox:cP,DTColumnFilter:lP}};function M0(t){"@babel/helpers - typeof";return M0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},M0(t)}function g5(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);e&&(l=l.filter(function(d){return Object.getOwnPropertyDescriptor(t,d).enumerable})),n.push.apply(n,l)}return n}function _5(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?g5(Object(n),!0).forEach(function(l){$le(t,l,n[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):g5(Object(n)).forEach(function(l){Object.defineProperty(t,l,Object.getOwnPropertyDescriptor(n,l))})}return t}function $le(t,e,n){return(e=Ule(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ule(t){var e=jle(t,"string");return M0(e)=="symbol"?e:e+""}function jle(t,e){if(M0(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var l=n.call(t,e);if(M0(l)!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Gle=["data-p-frozen-column"];function Hle(t,e,n,l,d,f){var x=_r("DTHeaderCheckbox"),s=_r("DTColumnFilter");return!f.columnProp("hidden")&&(n.rowGroupMode!=="subheader"||n.groupRowsBy!==f.columnProp("field"))?(Me(),ft("th",ot({key:0,style:f.getFilterColumnHeaderStyle,class:f.getFilterColumnHeaderClass},_5(_5({},f.getColumnPT("root")),f.getColumnPT("headerCell")),{"data-p-frozen-column":f.columnProp("frozen")}),[f.columnProp("selectionMode")==="multiple"?(Me(),rn(x,{key:0,checked:n.allRowsSelected,disabled:n.empty,onChange:e[0]||(e[0]=function(C){return t.$emit("checkbox-change",C)}),column:n.column,unstyled:t.unstyled,pt:t.pt},null,8,["checked","disabled","column","unstyled","pt"])):Pn("",!0),n.column.children&&n.column.children.filter?(Me(),rn(s,{key:1,field:f.columnProp("filterField")||f.columnProp("field"),type:f.columnProp("dataType"),display:"row",showMenu:f.columnProp("showFilterMenu"),filterElement:n.column.children&&n.column.children.filter,filterHeaderTemplate:n.column.children&&n.column.children.filterheader,filterFooterTemplate:n.column.children&&n.column.children.filterfooter,filterClearTemplate:n.column.children&&n.column.children.filterclear,filterApplyTemplate:n.column.children&&n.column.children.filterapply,filterIconTemplate:n.column.children&&n.column.children.filtericon,filterAddIconTemplate:n.column.children&&n.column.children.filteraddicon,filterRemoveIconTemplate:n.column.children&&n.column.children.filterremoveicon,filterClearIconTemplate:n.column.children&&n.column.children.filterclearicon,filters:n.filters,filtersStore:n.filtersStore,filterInputProps:n.filterInputProps,filterButtonProps:n.filterButtonProps,onFilterChange:e[1]||(e[1]=function(C){return t.$emit("filter-change",C)}),onFilterApply:e[2]||(e[2]=function(C){return t.$emit("filter-apply")}),filterMenuStyle:f.columnProp("filterMenuStyle"),filterMenuClass:f.columnProp("filterMenuClass"),showOperator:f.columnProp("showFilterOperator"),showClearButton:f.columnProp("showClearButton"),showApplyButton:f.columnProp("showApplyButton"),showMatchModes:f.columnProp("showFilterMatchModes"),showAddButton:f.columnProp("showAddButton"),matchModeOptions:f.columnProp("filterMatchModeOptions"),maxConstraints:f.columnProp("maxConstraints"),onOperatorChange:e[3]||(e[3]=function(C){return t.$emit("operator-change",C)}),onMatchmodeChange:e[4]||(e[4]=function(C){return t.$emit("matchmode-change",C)}),onConstraintAdd:e[5]||(e[5]=function(C){return t.$emit("constraint-add",C)}),onConstraintRemove:e[6]||(e[6]=function(C){return t.$emit("constraint-remove",C)}),onApplyClick:e[7]||(e[7]=function(C){return t.$emit("apply-click",C)}),column:n.column,unstyled:t.unstyled,pt:t.pt},null,8,["field","type","showMenu","filterElement","filterHeaderTemplate","filterFooterTemplate","filterClearTemplate","filterApplyTemplate","filterIconTemplate","filterAddIconTemplate","filterRemoveIconTemplate","filterClearIconTemplate","filters","filtersStore","filterInputProps","filterButtonProps","filterMenuStyle","filterMenuClass","showOperator","showClearButton","showApplyButton","showMatchModes","showAddButton","matchModeOptions","maxConstraints","column","unstyled","pt"])):Pn("",!0)],16,Gle)):Pn("",!0)}QN.render=Hle;var eV={name:"HeaderCell",hostName:"DataTable",extends:Yi,emits:["column-click","column-mousedown","column-dragstart","column-dragover","column-dragleave","column-drop","column-resizestart","checkbox-change","filter-change","filter-apply","operator-change","matchmode-change","constraint-add","constraint-remove","filter-clear","apply-click"],props:{column:{type:Object,default:null},index:{type:Number,default:null},resizableColumns:{type:Boolean,default:!1},groupRowsBy:{type:[Array,String,Function],default:null},sortMode:{type:String,default:"single"},groupRowSortField:{type:[String,Function],default:null},sortField:{type:[String,Function],default:null},sortOrder:{type:Number,default:null},multiSortMeta:{type:Array,default:null},allRowsSelected:{type:Boolean,default:!1},empty:{type:Boolean,default:!1},filterDisplay:{type:String,default:null},filters:{type:Object,default:null},filtersStore:{type:Object,default:null},filterColumn:{type:Boolean,default:!1},reorderableColumns:{type:Boolean,default:!1},filterInputProps:{type:null,default:null},filterButtonProps:{type:null,default:null}},data:function(){return{styleObject:{}}},mounted:function(){this.columnProp("frozen")&&this.updateStickyPosition()},updated:function(){this.columnProp("frozen")&&this.updateStickyPosition()},methods:{columnProp:function(e){return uf(this.column,e)},getColumnPT:function(e){var n,l,d={props:this.column.props,parent:{instance:this,props:this.$props,state:this.$data},context:{index:this.index,sortable:this.columnProp("sortable")===""||this.columnProp("sortable"),sorted:this.isColumnSorted(),resizable:this.resizableColumns,size:(n=this.$parentInstance)===null||n===void 0||(n=n.$parentInstance)===null||n===void 0?void 0:n.size,showGridlines:((l=this.$parentInstance)===null||l===void 0||(l=l.$parentInstance)===null||l===void 0?void 0:l.showGridlines)||!1}};return ot(this.ptm("column.".concat(e),{column:d}),this.ptm("column.".concat(e),d),this.ptmo(this.getColumnProp(),e,d))},getColumnProp:function(){return this.column.props&&this.column.props.pt?this.column.props.pt:void 0},onClick:function(e){this.$emit("column-click",{originalEvent:e,column:this.column})},onKeyDown:function(e){(e.code==="Enter"||e.code==="NumpadEnter"||e.code==="Space")&&e.currentTarget.nodeName==="TH"&&Cs(e.currentTarget,"data-p-sortable-column")&&(this.$emit("column-click",{originalEvent:e,column:this.column}),e.preventDefault())},onMouseDown:function(e){this.$emit("column-mousedown",{originalEvent:e,column:this.column})},onDragStart:function(e){this.$emit("column-dragstart",{originalEvent:e,column:this.column})},onDragOver:function(e){this.$emit("column-dragover",{originalEvent:e,column:this.column})},onDragLeave:function(e){this.$emit("column-dragleave",{originalEvent:e,column:this.column})},onDrop:function(e){this.$emit("column-drop",{originalEvent:e,column:this.column})},onResizeStart:function(e){this.$emit("column-resizestart",e)},getMultiSortMetaIndex:function(){var e=this;return this.multiSortMeta.findIndex(function(n){return n.field===e.columnProp("field")||n.field===e.columnProp("sortField")})},getBadgeValue:function(){var e=this.getMultiSortMetaIndex();return this.groupRowsBy&&this.groupRowsBy===this.groupRowSortField&&e>-1?e:e+1},isMultiSorted:function(){return this.sortMode==="multiple"&&this.columnProp("sortable")&&this.getMultiSortMetaIndex()>-1},isColumnSorted:function(){return this.sortMode==="single"?this.sortField&&(this.sortField===this.columnProp("field")||this.sortField===this.columnProp("sortField")):this.isMultiSorted()},updateStickyPosition:function(){if(this.columnProp("frozen")){var e=this.columnProp("alignFrozen");if(e==="right"){var n=0,l=zT(this.$el,'[data-p-frozen-column="true"]');l&&(n=Ga(l)+parseFloat(l.style["inset-inline-end"]||0)),this.styleObject.insetInlineEnd=n+"px"}else{var d=0,f=FT(this.$el,'[data-p-frozen-column="true"]');f&&(d=Ga(f)+parseFloat(f.style["inset-inline-start"]||0)),this.styleObject.insetInlineStart=d+"px"}var x=this.$el.parentElement.nextElementSibling;if(x){var s=Zx(this.$el);x.children[s]&&(x.children[s].style["inset-inline-start"]=this.styleObject["inset-inline-start"],x.children[s].style["inset-inline-end"]=this.styleObject["inset-inline-end"])}}},onHeaderCheckboxChange:function(e){this.$emit("checkbox-change",e)}},computed:{containerClass:function(){return[this.cx("headerCell"),this.filterColumn?this.columnProp("filterHeaderClass"):this.columnProp("headerClass"),this.columnProp("class")]},containerStyle:function(){var e=this.filterColumn?this.columnProp("filterHeaderStyle"):this.columnProp("headerStyle"),n=this.columnProp("style");return this.columnProp("frozen")?[n,e,this.styleObject]:[n,e]},sortState:function(){var e=!1,n=null;if(this.sortMode==="single")e=this.sortField&&(this.sortField===this.columnProp("field")||this.sortField===this.columnProp("sortField")),n=e?this.sortOrder:0;else if(this.sortMode==="multiple"){var l=this.getMultiSortMetaIndex();l>-1&&(e=!0,n=this.multiSortMeta[l].order)}return{sorted:e,sortOrder:n}},sortableColumnIcon:function(){var e=this.sortState,n=e.sorted,l=e.sortOrder;if(n){if(n&&l>0)return gI;if(n&&l<0)return pI}else return hI;return null},ariaSort:function(){if(this.columnProp("sortable")){var e=this.sortState,n=e.sorted,l=e.sortOrder;return n&&l<0?"descending":n&&l>0?"ascending":"none"}else return null}},components:{Badge:nP,DTHeaderCheckbox:cP,DTColumnFilter:lP,SortAltIcon:hI,SortAmountUpAltIcon:gI,SortAmountDownIcon:pI}};function D0(t){"@babel/helpers - typeof";return D0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},D0(t)}function y5(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);e&&(l=l.filter(function(d){return Object.getOwnPropertyDescriptor(t,d).enumerable})),n.push.apply(n,l)}return n}function v5(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?y5(Object(n),!0).forEach(function(l){Wle(t,l,n[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):y5(Object(n)).forEach(function(l){Object.defineProperty(t,l,Object.getOwnPropertyDescriptor(n,l))})}return t}function Wle(t,e,n){return(e=qle(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function qle(t){var e=Kle(t,"string");return D0(e)=="symbol"?e:e+""}function Kle(t,e){if(D0(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var l=n.call(t,e);if(D0(l)!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Zle=["tabindex","colspan","rowspan","aria-sort","data-p-sortable-column","data-p-resizable-column","data-p-sorted","data-p-filter-column","data-p-frozen-column","data-p-reorderable-column"];function Xle(t,e,n,l,d,f){var x=_r("Badge"),s=_r("DTHeaderCheckbox"),C=_r("DTColumnFilter");return Me(),ft("th",ot({style:f.containerStyle,class:f.containerClass,tabindex:f.columnProp("sortable")?"0":null,role:"columnheader",colspan:f.columnProp("colspan"),rowspan:f.columnProp("rowspan"),"aria-sort":f.ariaSort,onClick:e[8]||(e[8]=function(){return f.onClick&&f.onClick.apply(f,arguments)}),onKeydown:e[9]||(e[9]=function(){return f.onKeyDown&&f.onKeyDown.apply(f,arguments)}),onMousedown:e[10]||(e[10]=function(){return f.onMouseDown&&f.onMouseDown.apply(f,arguments)}),onDragstart:e[11]||(e[11]=function(){return f.onDragStart&&f.onDragStart.apply(f,arguments)}),onDragover:e[12]||(e[12]=function(){return f.onDragOver&&f.onDragOver.apply(f,arguments)}),onDragleave:e[13]||(e[13]=function(){return f.onDragLeave&&f.onDragLeave.apply(f,arguments)}),onDrop:e[14]||(e[14]=function(){return f.onDrop&&f.onDrop.apply(f,arguments)})},v5(v5({},f.getColumnPT("root")),f.getColumnPT("headerCell")),{"data-p-sortable-column":f.columnProp("sortable"),"data-p-resizable-column":n.resizableColumns,"data-p-sorted":f.isColumnSorted(),"data-p-filter-column":n.filterColumn,"data-p-frozen-column":f.columnProp("frozen"),"data-p-reorderable-column":n.reorderableColumns}),[n.resizableColumns&&!f.columnProp("frozen")?(Me(),ft("span",ot({key:0,class:t.cx("columnResizer"),onMousedown:e[0]||(e[0]=function(){return f.onResizeStart&&f.onResizeStart.apply(f,arguments)})},f.getColumnPT("columnResizer")),null,16)):Pn("",!0),Ze("div",ot({class:t.cx("columnHeaderContent")},f.getColumnPT("columnHeaderContent")),[n.column.children&&n.column.children.header?(Me(),rn(Hr(n.column.children.header),{key:0,column:n.column},null,8,["column"])):Pn("",!0),f.columnProp("header")?(Me(),ft("span",ot({key:1,class:t.cx("columnTitle")},f.getColumnPT("columnTitle")),Fr(f.columnProp("header")),17)):Pn("",!0),f.columnProp("sortable")?(Me(),ft("span",Xw(ot({key:2},f.getColumnPT("sort"))),[(Me(),rn(Hr(n.column.children&&n.column.children.sorticon||f.sortableColumnIcon),ot({sorted:f.sortState.sorted,sortOrder:f.sortState.sortOrder,class:t.cx("sortIcon")},f.getColumnPT("sorticon")),null,16,["sorted","sortOrder","class"]))],16)):Pn("",!0),f.isMultiSorted()?(Me(),rn(x,{key:3,class:wr(t.cx("pcSortBadge")),pt:f.getColumnPT("pcSortBadge"),value:f.getBadgeValue(),size:"small"},null,8,["class","pt","value"])):Pn("",!0),f.columnProp("selectionMode")==="multiple"&&n.filterDisplay!=="row"?(Me(),rn(s,{key:4,checked:n.allRowsSelected,onChange:f.onHeaderCheckboxChange,disabled:n.empty,headerCheckboxIconTemplate:n.column.children&&n.column.children.headercheckboxicon,column:n.column,unstyled:t.unstyled,pt:t.pt},null,8,["checked","onChange","disabled","headerCheckboxIconTemplate","column","unstyled","pt"])):Pn("",!0),n.filterDisplay==="menu"&&n.column.children&&n.column.children.filter?(Me(),rn(C,{key:5,field:f.columnProp("filterField")||f.columnProp("field"),type:f.columnProp("dataType"),display:"menu",showMenu:f.columnProp("showFilterMenu"),filterElement:n.column.children&&n.column.children.filter,filterHeaderTemplate:n.column.children&&n.column.children.filterheader,filterFooterTemplate:n.column.children&&n.column.children.filterfooter,filterClearTemplate:n.column.children&&n.column.children.filterclear,filterApplyTemplate:n.column.children&&n.column.children.filterapply,filterIconTemplate:n.column.children&&n.column.children.filtericon,filterAddIconTemplate:n.column.children&&n.column.children.filteraddicon,filterRemoveIconTemplate:n.column.children&&n.column.children.filterremoveicon,filterClearIconTemplate:n.column.children&&n.column.children.filterclearicon,filters:n.filters,filtersStore:n.filtersStore,filterInputProps:n.filterInputProps,filterButtonProps:n.filterButtonProps,onFilterChange:e[1]||(e[1]=function(P){return t.$emit("filter-change",P)}),onFilterApply:e[2]||(e[2]=function(P){return t.$emit("filter-apply")}),filterMenuStyle:f.columnProp("filterMenuStyle"),filterMenuClass:f.columnProp("filterMenuClass"),showOperator:f.columnProp("showFilterOperator"),showClearButton:f.columnProp("showClearButton"),showApplyButton:f.columnProp("showApplyButton"),showMatchModes:f.columnProp("showFilterMatchModes"),showAddButton:f.columnProp("showAddButton"),matchModeOptions:f.columnProp("filterMatchModeOptions"),maxConstraints:f.columnProp("maxConstraints"),onOperatorChange:e[3]||(e[3]=function(P){return t.$emit("operator-change",P)}),onMatchmodeChange:e[4]||(e[4]=function(P){return t.$emit("matchmode-change",P)}),onConstraintAdd:e[5]||(e[5]=function(P){return t.$emit("constraint-add",P)}),onConstraintRemove:e[6]||(e[6]=function(P){return t.$emit("constraint-remove",P)}),onApplyClick:e[7]||(e[7]=function(P){return t.$emit("apply-click",P)}),column:n.column,unstyled:t.unstyled,pt:t.pt},null,8,["field","type","showMenu","filterElement","filterHeaderTemplate","filterFooterTemplate","filterClearTemplate","filterApplyTemplate","filterIconTemplate","filterAddIconTemplate","filterRemoveIconTemplate","filterClearIconTemplate","filters","filtersStore","filterInputProps","filterButtonProps","filterMenuStyle","filterMenuClass","showOperator","showClearButton","showApplyButton","showMatchModes","showAddButton","matchModeOptions","maxConstraints","column","unstyled","pt"])):Pn("",!0)],16)],16,Zle)}eV.render=Xle;var tV={name:"TableHeader",hostName:"DataTable",extends:Yi,emits:["column-click","column-mousedown","column-dragstart","column-dragover","column-dragleave","column-drop","column-resizestart","checkbox-change","filter-change","filter-apply","operator-change","matchmode-change","constraint-add","constraint-remove","filter-clear","apply-click"],props:{columnGroup:{type:null,default:null},columns:{type:null,default:null},rowGroupMode:{type:String,default:null},groupRowsBy:{type:[Array,String,Function],default:null},resizableColumns:{type:Boolean,default:!1},allRowsSelected:{type:Boolean,default:!1},empty:{type:Boolean,default:!1},sortMode:{type:String,default:"single"},groupRowSortField:{type:[String,Function],default:null},sortField:{type:[String,Function],default:null},sortOrder:{type:Number,default:null},multiSortMeta:{type:Array,default:null},filterDisplay:{type:String,default:null},filters:{type:Object,default:null},filtersStore:{type:Object,default:null},reorderableColumns:{type:Boolean,default:!1},first:{type:Number,default:0},filterInputProps:{type:null,default:null},filterButtonProps:{type:null,default:null}},provide:function(){return{$rows:this.d_headerRows,$columns:this.d_headerColumns}},data:function(){return{d_headerRows:new jg({type:"Row"}),d_headerColumns:new jg({type:"Column"})}},beforeUnmount:function(){this.d_headerRows.clear(),this.d_headerColumns.clear()},methods:{columnProp:function(e,n){return uf(e,n)},getColumnGroupPT:function(e){var n,l={props:this.getColumnGroupProps(),parent:{instance:this,props:this.$props,state:this.$data},context:{type:"header",scrollable:(n=this.$parentInstance)===null||n===void 0||(n=n.$parentInstance)===null||n===void 0?void 0:n.scrollable}};return ot(this.ptm("columnGroup.".concat(e),{columnGroup:l}),this.ptm("columnGroup.".concat(e),l),this.ptmo(this.getColumnGroupProps(),e,l))},getColumnGroupProps:function(){return this.columnGroup&&this.columnGroup.props&&this.columnGroup.props.pt?this.columnGroup.props.pt:void 0},getRowPT:function(e,n,l){var d={props:e.props,parent:{instance:this,props:this.$props,state:this.$data},context:{index:l}};return ot(this.ptm("row.".concat(n),{row:d}),this.ptm("row.".concat(n),d),this.ptmo(this.getRowProp(e),n,d))},getRowProp:function(e){return e.props&&e.props.pt?e.props.pt:void 0},getColumnPT:function(e,n,l){var d={props:e.props,parent:{instance:this,props:this.$props,state:this.$data},context:{index:l}};return ot(this.ptm("column.".concat(n),{column:d}),this.ptm("column.".concat(n),d),this.ptmo(this.getColumnProp(e),n,d))},getColumnProp:function(e){return e.props&&e.props.pt?e.props.pt:void 0},getFilterColumnHeaderClass:function(e){return[this.cx("headerCell",{column:e}),this.columnProp(e,"filterHeaderClass"),this.columnProp(e,"class")]},getFilterColumnHeaderStyle:function(e){return[this.columnProp(e,"filterHeaderStyle"),this.columnProp(e,"style")]},getHeaderRows:function(){var e;return(e=this.d_headerRows)===null||e===void 0?void 0:e.get(this.columnGroup,this.columnGroup.children)},getHeaderColumns:function(e){var n;return(n=this.d_headerColumns)===null||n===void 0?void 0:n.get(e,e.children)}},computed:{ptmTHeadOptions:function(){var e;return{context:{scrollable:(e=this.$parentInstance)===null||e===void 0||(e=e.$parentInstance)===null||e===void 0?void 0:e.scrollable}}}},components:{DTHeaderCell:eV,DTFilterHeaderCell:QN}};function L0(t){"@babel/helpers - typeof";return L0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},L0(t)}function b5(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);e&&(l=l.filter(function(d){return Object.getOwnPropertyDescriptor(t,d).enumerable})),n.push.apply(n,l)}return n}function xx(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?b5(Object(n),!0).forEach(function(l){Yle(t,l,n[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):b5(Object(n)).forEach(function(l){Object.defineProperty(t,l,Object.getOwnPropertyDescriptor(n,l))})}return t}function Yle(t,e,n){return(e=Jle(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Jle(t){var e=Qle(t,"string");return L0(e)=="symbol"?e:e+""}function Qle(t,e){if(L0(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var l=n.call(t,e);if(L0(l)!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var ece=["data-p-scrollable"];function tce(t,e,n,l,d,f){var x,s=_r("DTHeaderCell"),C=_r("DTFilterHeaderCell");return Me(),ft("thead",ot({class:t.cx("thead"),style:t.sx("thead"),role:"rowgroup"},n.columnGroup?xx(xx({},t.ptm("thead",f.ptmTHeadOptions)),f.getColumnGroupPT("root")):t.ptm("thead",f.ptmTHeadOptions),{"data-p-scrollable":(x=t.$parentInstance)===null||x===void 0||(x=x.$parentInstance)===null||x===void 0?void 0:x.scrollable,"data-pc-section":"thead"}),[n.columnGroup?(Me(!0),ft(Tr,{key:1},ms(f.getHeaderRows(),function(P,L){return Me(),ft("tr",ot({key:L,role:"row"},{ref_for:!0},xx(xx({},t.ptm("headerRow")),f.getRowPT(P,"root",L))),[(Me(!0),ft(Tr,null,ms(f.getHeaderColumns(P),function($,V){return Me(),ft(Tr,{key:f.columnProp($,"columnKey")||f.columnProp($,"field")||V},[!f.columnProp($,"hidden")&&(n.rowGroupMode!=="subheader"||n.groupRowsBy!==f.columnProp($,"field"))&&typeof $.children!="string"?(Me(),rn(s,{key:0,column:$,onColumnClick:e[15]||(e[15]=function(j){return t.$emit("column-click",j)}),onColumnMousedown:e[16]||(e[16]=function(j){return t.$emit("column-mousedown",j)}),groupRowsBy:n.groupRowsBy,groupRowSortField:n.groupRowSortField,sortMode:n.sortMode,sortField:n.sortField,sortOrder:n.sortOrder,multiSortMeta:n.multiSortMeta,allRowsSelected:n.allRowsSelected,empty:n.empty,onCheckboxChange:e[17]||(e[17]=function(j){return t.$emit("checkbox-change",j)}),filters:n.filters,filterDisplay:n.filterDisplay,filtersStore:n.filtersStore,filterInputProps:n.filterInputProps,filterButtonProps:n.filterButtonProps,onFilterChange:e[18]||(e[18]=function(j){return t.$emit("filter-change",j)}),onFilterApply:e[19]||(e[19]=function(j){return t.$emit("filter-apply")}),onOperatorChange:e[20]||(e[20]=function(j){return t.$emit("operator-change",j)}),onMatchmodeChange:e[21]||(e[21]=function(j){return t.$emit("matchmode-change",j)}),onConstraintAdd:e[22]||(e[22]=function(j){return t.$emit("constraint-add",j)}),onConstraintRemove:e[23]||(e[23]=function(j){return t.$emit("constraint-remove",j)}),onApplyClick:e[24]||(e[24]=function(j){return t.$emit("apply-click",j)}),unstyled:t.unstyled,pt:t.pt},null,8,["column","groupRowsBy","groupRowSortField","sortMode","sortField","sortOrder","multiSortMeta","allRowsSelected","empty","filters","filterDisplay","filtersStore","filterInputProps","filterButtonProps","unstyled","pt"])):Pn("",!0)],64)}),128))],16)}),128)):(Me(),ft("tr",ot({key:0,role:"row"},t.ptm("headerRow")),[(Me(!0),ft(Tr,null,ms(n.columns,function(P,L){return Me(),ft(Tr,{key:f.columnProp(P,"columnKey")||f.columnProp(P,"field")||L},[!f.columnProp(P,"hidden")&&(n.rowGroupMode!=="subheader"||n.groupRowsBy!==f.columnProp(P,"field"))?(Me(),rn(s,{key:0,column:P,index:L,onColumnClick:e[0]||(e[0]=function($){return t.$emit("column-click",$)}),onColumnMousedown:e[1]||(e[1]=function($){return t.$emit("column-mousedown",$)}),onColumnDragstart:e[2]||(e[2]=function($){return t.$emit("column-dragstart",$)}),onColumnDragover:e[3]||(e[3]=function($){return t.$emit("column-dragover",$)}),onColumnDragleave:e[4]||(e[4]=function($){return t.$emit("column-dragleave",$)}),onColumnDrop:e[5]||(e[5]=function($){return t.$emit("column-drop",$)}),groupRowsBy:n.groupRowsBy,groupRowSortField:n.groupRowSortField,reorderableColumns:n.reorderableColumns,resizableColumns:n.resizableColumns,onColumnResizestart:e[6]||(e[6]=function($){return t.$emit("column-resizestart",$)}),sortMode:n.sortMode,sortField:n.sortField,sortOrder:n.sortOrder,multiSortMeta:n.multiSortMeta,allRowsSelected:n.allRowsSelected,empty:n.empty,onCheckboxChange:e[7]||(e[7]=function($){return t.$emit("checkbox-change",$)}),filters:n.filters,filterDisplay:n.filterDisplay,filtersStore:n.filtersStore,filterInputProps:n.filterInputProps,filterButtonProps:n.filterButtonProps,first:n.first,onFilterChange:e[8]||(e[8]=function($){return t.$emit("filter-change",$)}),onFilterApply:e[9]||(e[9]=function($){return t.$emit("filter-apply")}),onOperatorChange:e[10]||(e[10]=function($){return t.$emit("operator-change",$)}),onMatchmodeChange:e[11]||(e[11]=function($){return t.$emit("matchmode-change",$)}),onConstraintAdd:e[12]||(e[12]=function($){return t.$emit("constraint-add",$)}),onConstraintRemove:e[13]||(e[13]=function($){return t.$emit("constraint-remove",$)}),onApplyClick:e[14]||(e[14]=function($){return t.$emit("apply-click",$)}),unstyled:t.unstyled,pt:t.pt},null,8,["column","index","groupRowsBy","groupRowSortField","reorderableColumns","resizableColumns","sortMode","sortField","sortOrder","multiSortMeta","allRowsSelected","empty","filters","filterDisplay","filtersStore","filterInputProps","filterButtonProps","first","unstyled","pt"])):Pn("",!0)],64)}),128))],16)),n.filterDisplay==="row"?(Me(),ft("tr",ot({key:2,role:"row"},t.ptm("headerRow")),[(Me(!0),ft(Tr,null,ms(n.columns,function(P,L){return Me(),ft(Tr,{key:f.columnProp(P,"columnKey")||f.columnProp(P,"field")||L},[!f.columnProp(P,"hidden")&&(n.rowGroupMode!=="subheader"||n.groupRowsBy!==f.columnProp(P,"field"))?(Me(),rn(C,{key:0,column:P,index:L,allRowsSelected:n.allRowsSelected,empty:n.empty,display:"row",filters:n.filters,filtersStore:n.filtersStore,filterInputProps:n.filterInputProps,filterButtonProps:n.filterButtonProps,onFilterChange:e[25]||(e[25]=function($){return t.$emit("filter-change",$)}),onFilterApply:e[26]||(e[26]=function($){return t.$emit("filter-apply")}),onOperatorChange:e[27]||(e[27]=function($){return t.$emit("operator-change",$)}),onMatchmodeChange:e[28]||(e[28]=function($){return t.$emit("matchmode-change",$)}),onConstraintAdd:e[29]||(e[29]=function($){return t.$emit("constraint-add",$)}),onConstraintRemove:e[30]||(e[30]=function($){return t.$emit("constraint-remove",$)}),onApplyClick:e[31]||(e[31]=function($){return t.$emit("apply-click",$)}),onCheckboxChange:e[32]||(e[32]=function($){return t.$emit("checkbox-change",$)}),unstyled:t.unstyled,pt:t.pt},null,8,["column","index","allRowsSelected","empty","filters","filtersStore","filterInputProps","filterButtonProps","unstyled","pt"])):Pn("",!0)],64)}),128))],16)):Pn("",!0)],16,ece)}tV.render=tce;var nce=["expanded"];function nu(t){"@babel/helpers - typeof";return nu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},nu(t)}function rce(t,e){if(t==null)return{};var n,l,d=ice(t,e);if(Object.getOwnPropertySymbols){var f=Object.getOwnPropertySymbols(t);for(l=0;l<f.length;l++)n=f[l],e.indexOf(n)===-1&&{}.propertyIsEnumerable.call(t,n)&&(d[n]=t[n])}return d}function ice(t,e){if(t==null)return{};var n={};for(var l in t)if({}.hasOwnProperty.call(t,l)){if(e.indexOf(l)!==-1)continue;n[l]=t[l]}return n}function x5(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);e&&(l=l.filter(function(d){return Object.getOwnPropertyDescriptor(t,d).enumerable})),n.push.apply(n,l)}return n}function ol(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?x5(Object(n),!0).forEach(function(l){Xx(t,l,n[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):x5(Object(n)).forEach(function(l){Object.defineProperty(t,l,Object.getOwnPropertyDescriptor(n,l))})}return t}function Xx(t,e,n){return(e=oce(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function oce(t){var e=sce(t,"string");return nu(e)=="symbol"?e:e+""}function sce(t,e){if(nu(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var l=n.call(t,e);if(nu(l)!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function w5(t,e){return cce(t)||lce(t,e)||uP(t,e)||ace()}function ace(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function lce(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var l,d,f,x,s=[],C=!0,P=!1;try{if(f=(n=n.call(t)).next,e!==0)for(;!(C=(l=f.call(n)).done)&&(s.push(l.value),s.length!==e);C=!0);}catch(L){P=!0,d=L}finally{try{if(!C&&n.return!=null&&(x=n.return(),Object(x)!==x))return}finally{if(P)throw d}}return s}}function cce(t){if(Array.isArray(t))return t}function ev(t,e){var n=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=uP(t))||e){n&&(t=n);var l=0,d=function(){};return{s:d,n:function(){return l>=t.length?{done:!0}:{done:!1,value:t[l++]}},e:function(P){throw P},f:d}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var f,x=!0,s=!1;return{s:function(){n=n.call(t)},n:function(){var P=n.next();return x=P.done,P},e:function(P){s=!0,f=P},f:function(){try{x||n.return==null||n.return()}finally{if(s)throw f}}}}function jo(t){return hce(t)||dce(t)||uP(t)||uce()}function uce(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function uP(t,e){if(t){if(typeof t=="string")return yI(t,e);var n={}.toString.call(t).slice(8,-1);return n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set"?Array.from(t):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?yI(t,e):void 0}}function dce(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function hce(t){if(Array.isArray(t))return yI(t)}function yI(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,l=Array(e);n<e;n++)l[n]=t[n];return l}var $w={name:"DataTable",extends:qae,inheritAttrs:!1,emits:["value-change","update:first","update:rows","page","update:sortField","update:sortOrder","update:multiSortMeta","sort","filter","row-click","row-dblclick","update:selection","row-select","row-unselect","update:contextMenuSelection","row-contextmenu","row-unselect-all","row-select-all","select-all-change","column-resize-end","column-reorder","row-reorder","update:expandedRows","row-collapse","row-expand","update:expandedRowGroups","rowgroup-collapse","rowgroup-expand","update:filters","state-restore","state-save","cell-edit-init","cell-edit-complete","cell-edit-cancel","update:editingRows","row-edit-init","row-edit-save","row-edit-cancel"],provide:function(){return{$columns:this.d_columns,$columnGroups:this.d_columnGroups}},data:function(){return{d_first:this.first,d_rows:this.rows,d_sortField:this.sortField,d_sortOrder:this.sortOrder,d_nullSortOrder:this.nullSortOrder,d_multiSortMeta:this.multiSortMeta?jo(this.multiSortMeta):[],d_groupRowsSortMeta:null,d_selectionKeys:null,d_columnOrder:null,d_editingRowKeys:null,d_editingMeta:{},d_filters:this.cloneFilters(this.filters),d_columns:new jg({type:"Column"}),d_columnGroups:new jg({type:"ColumnGroup"})}},rowTouched:!1,anchorRowIndex:null,rangeRowIndex:null,documentColumnResizeListener:null,documentColumnResizeEndListener:null,lastResizeHelperX:null,resizeColumnElement:null,columnResizing:!1,colReorderIconWidth:null,colReorderIconHeight:null,draggedColumn:null,draggedColumnElement:null,draggedRowIndex:null,droppedRowIndex:null,rowDragging:null,columnWidthsState:null,tableWidthState:null,columnWidthsRestored:!1,watch:{first:function(e){this.d_first=e},rows:function(e){this.d_rows=e},sortField:function(e){this.d_sortField=e},sortOrder:function(e){this.d_sortOrder=e},nullSortOrder:function(e){this.d_nullSortOrder=e},multiSortMeta:function(e){this.d_multiSortMeta=e},selection:{immediate:!0,handler:function(e){this.dataKey&&this.updateSelectionKeys(e)}},editingRows:{immediate:!0,handler:function(e){this.dataKey&&this.updateEditingRowKeys(e)}},filters:{deep:!0,handler:function(e){this.d_filters=this.cloneFilters(e)}}},mounted:function(){this.isStateful()&&(this.restoreState(),this.resizableColumns&&this.restoreColumnWidths()),this.editMode==="row"&&this.dataKey&&!this.d_editingRowKeys&&this.updateEditingRowKeys(this.editingRows)},beforeUnmount:function(){this.unbindColumnResizeEvents(),this.destroyStyleElement(),this.d_columns.clear(),this.d_columnGroups.clear()},updated:function(){this.isStateful()&&this.saveState(),this.editMode==="row"&&this.dataKey&&!this.d_editingRowKeys&&this.updateEditingRowKeys(this.editingRows)},methods:{columnProp:function(e,n){return uf(e,n)},onPage:function(e){var n=this;this.clearEditingMetaData(),this.d_first=e.first,this.d_rows=e.rows;var l=this.createLazyLoadEvent(e);l.pageCount=e.pageCount,l.page=e.page,this.$emit("update:first",this.d_first),this.$emit("update:rows",this.d_rows),this.$emit("page",l),this.$nextTick(function(){n.$emit("value-change",n.processedData)})},onColumnHeaderClick:function(e){var n=this,l=e.originalEvent,d=e.column;if(this.columnProp(d,"sortable")){var f=l.target,x=this.columnProp(d,"sortField")||this.columnProp(d,"field");if(Cs(f,"data-p-sortable-column")===!0||Cs(f,"data-pc-section")==="columntitle"||Cs(f,"data-pc-section")==="columnheadercontent"||Cs(f,"data-pc-section")==="sorticon"||Cs(f.parentElement,"data-pc-section")==="sorticon"||Cs(f.parentElement.parentElement,"data-pc-section")==="sorticon"||f.closest('[data-p-sortable-column="true"]')&&!f.closest('[data-pc-section="columnfilterbutton"]')&&!bC(l.target)){if(Kx(),this.sortMode==="single")this.d_sortField===x?this.removableSort&&this.d_sortOrder*-1===this.defaultSortOrder?(this.d_sortOrder=null,this.d_sortField=null):this.d_sortOrder=this.d_sortOrder*-1:(this.d_sortOrder=this.defaultSortOrder,this.d_sortField=x),this.$emit("update:sortField",this.d_sortField),this.$emit("update:sortOrder",this.d_sortOrder),this.resetPage();else if(this.sortMode==="multiple"){var s=l.metaKey||l.ctrlKey;s||(this.d_multiSortMeta=this.d_multiSortMeta.filter(function(C){return C.field===x})),this.addMultiSortField(x),this.$emit("update:multiSortMeta",this.d_multiSortMeta)}this.$emit("sort",this.createLazyLoadEvent(l)),this.$nextTick(function(){n.$emit("value-change",n.processedData)})}}},sortSingle:function(e){var n=this;if(this.clearEditingMetaData(),this.groupRowsBy&&this.groupRowsBy===this.sortField)return this.d_multiSortMeta=[{field:this.sortField,order:this.sortOrder||this.defaultSortOrder},{field:this.d_sortField,order:this.d_sortOrder}],this.sortMultiple(e);var l=jo(e),d=new Map,f=ev(l),x;try{for(f.s();!(x=f.n()).done;){var s=x.value;d.set(s,Di(s,this.d_sortField))}}catch(P){f.e(P)}finally{f.f()}var C=_L();return l.sort(function(P,L){var $=d.get(P),V=d.get(L);return vL($,V,n.d_sortOrder,C,n.d_nullSortOrder)}),l},sortMultiple:function(e){var n=this;if(this.clearEditingMetaData(),this.groupRowsBy&&(this.d_groupRowsSortMeta||this.d_multiSortMeta.length&&this.groupRowsBy===this.d_multiSortMeta[0].field)){var l=this.d_multiSortMeta[0];!this.d_groupRowsSortMeta&&(this.d_groupRowsSortMeta=l),l.field!==this.d_groupRowsSortMeta.field&&(this.d_multiSortMeta=[this.d_groupRowsSortMeta].concat(jo(this.d_multiSortMeta)))}var d=jo(e);return d.sort(function(f,x){return n.multisortField(f,x,0)}),d},multisortField:function(e,n,l){var d=Di(e,this.d_multiSortMeta[l].field),f=Di(n,this.d_multiSortMeta[l].field),x=_L();return d===f?this.d_multiSortMeta.length-1>l?this.multisortField(e,n,l+1):0:vL(d,f,this.d_multiSortMeta[l].order,x,this.d_nullSortOrder)},addMultiSortField:function(e){var n=this.d_multiSortMeta.findIndex(function(l){return l.field===e});n>=0?this.removableSort&&this.d_multiSortMeta[n].order*-1===this.defaultSortOrder?this.d_multiSortMeta.splice(n,1):this.d_multiSortMeta[n]={field:e,order:this.d_multiSortMeta[n].order*-1}:this.d_multiSortMeta.push({field:e,order:this.defaultSortOrder}),this.d_multiSortMeta=jo(this.d_multiSortMeta)},getActiveFilters:function(e){var n=function(x){var s=w5(x,2),C=s[0],P=s[1];if(P.constraints){var L=P.constraints.filter(function($){return $.value!==null});if(L.length>0)return[C,ol(ol({},P),{},{constraints:L})]}else if(P.value!==null)return[C,P]},l=function(x){return x!==void 0},d=Object.entries(e).map(n).filter(l);return Object.fromEntries(d)},filter:function(e){var n=this;if(e){this.clearEditingMetaData();var l=this.getActiveFilters(this.filters),d;l.global&&(d=this.globalFilterFields||this.columns.map(function(Ne){return n.columnProp(Ne,"filterField")||n.columnProp(Ne,"field")}));for(var f=[],x=0;x<e.length;x++){var s=!0,C=!1,P=!1;for(var L in l)if(Object.prototype.hasOwnProperty.call(l,L)&&L!=="global"){P=!0;var $=L,V=l[$];if(V.operator){var j=ev(V.constraints),ue;try{for(j.s();!(ue=j.n()).done;){var de=ue.value;if(s=this.executeLocalFilter($,e[x],de),V.operator===Lw.OR&&s||V.operator===Lw.AND&&!s)break}}catch(Ne){j.e(Ne)}finally{j.f()}}else s=this.executeLocalFilter($,e[x],V);if(!s)break}if(s&&l.global&&!C&&d)for(var Te=0;Te<d.length;Te++){var Be=d[Te];if(C=I2.filters[l.global.matchMode||lo.CONTAINS](Di(e[x],Be),l.global.value,this.filterLocale),C)break}var Ge=void 0;l.global?Ge=P?P&&s&&C:C:Ge=P&&s,Ge&&f.push(e[x])}(f.length===this.value.length||Object.keys(l).length==0)&&(f=e);var Ye=this.createLazyLoadEvent();return Ye.filteredValue=f,this.$emit("filter",Ye),this.$emit("value-change",f),f}},executeLocalFilter:function(e,n,l){var d=l.value,f=l.matchMode||lo.STARTS_WITH,x=Di(n,e),s=I2.filters[f];return s(x,d,this.filterLocale)},onRowClick:function(e){var n=e.originalEvent,l=this.$refs.bodyRef&&this.$refs.bodyRef.$el,d=Lh(l,'tr[data-p-selectable-row="true"][tabindex="0"]');if(!bC(n.target)){if(this.$emit("row-click",e),this.selectionMode){var f=e.data,x=this.d_first+e.index;if(this.isMultipleSelectionMode()&&n.shiftKey&&this.anchorRowIndex!=null)Kx(),this.rangeRowIndex=x,this.selectRange(n);else{var s=this.isSelected(f),C=this.rowTouched?!1:this.metaKeySelection;if(this.anchorRowIndex=x,this.rangeRowIndex=x,C){var P=n.metaKey||n.ctrlKey;if(s&&P){if(this.isSingleSelectionMode())this.$emit("update:selection",null);else{var L=this.findIndexInSelection(f),$=this.selection.filter(function(Ye,Ne){return Ne!=L});this.$emit("update:selection",$)}this.$emit("row-unselect",{originalEvent:n,data:f,index:x,type:"row"})}else{if(this.isSingleSelectionMode())this.$emit("update:selection",f);else if(this.isMultipleSelectionMode()){var V=P?this.selection||[]:[];V=[].concat(jo(V),[f]),this.$emit("update:selection",V)}this.$emit("row-select",{originalEvent:n,data:f,index:x,type:"row"})}}else if(this.selectionMode==="single")s?(this.$emit("update:selection",null),this.$emit("row-unselect",{originalEvent:n,data:f,index:x,type:"row"})):(this.$emit("update:selection",f),this.$emit("row-select",{originalEvent:n,data:f,index:x,type:"row"}));else if(this.selectionMode==="multiple")if(s){var j=this.findIndexInSelection(f),ue=this.selection.filter(function(Ye,Ne){return Ne!=j});this.$emit("update:selection",ue),this.$emit("row-unselect",{originalEvent:n,data:f,index:x,type:"row"})}else{var de=this.selection?[].concat(jo(this.selection),[f]):[f];this.$emit("update:selection",de),this.$emit("row-select",{originalEvent:n,data:f,index:x,type:"row"})}}}if(this.rowTouched=!1,d){var Te,Be;if(((Te=n.target)===null||Te===void 0?void 0:Te.getAttribute("data-pc-section"))==="rowtoggleicon")return;var Ge=(Be=n.currentTarget)===null||Be===void 0?void 0:Be.closest('tr[data-p-selectable-row="true"]');d.tabIndex="-1",Ge&&(Ge.tabIndex="0")}}},onRowDblClick:function(e){var n=e.originalEvent;bC(n.target)||this.$emit("row-dblclick",e)},onRowRightClick:function(e){this.contextMenu&&(Kx(),e.originalEvent.target.focus()),this.$emit("update:contextMenuSelection",e.data),this.$emit("row-contextmenu",e)},onRowTouchEnd:function(){this.rowTouched=!0},onRowKeyDown:function(e,n){var l=e.originalEvent,d=e.data,f=e.index,x=l.metaKey||l.ctrlKey;if(this.selectionMode){var s=l.target;switch(l.code){case"ArrowDown":this.onArrowDownKey(l,s,f,n);break;case"ArrowUp":this.onArrowUpKey(l,s,f,n);break;case"Home":this.onHomeKey(l,s,f,n);break;case"End":this.onEndKey(l,s,f,n);break;case"Enter":case"NumpadEnter":this.onEnterKey(l,d,f);break;case"Space":this.onSpaceKey(l,d,f,n);break;case"Tab":this.onTabKey(l,f);break;default:if(l.code==="KeyA"&&x&&this.isMultipleSelectionMode()){var C=this.dataToRender(n.rows);this.$emit("update:selection",C)}var P=l.code==="KeyC"&&x;P||l.preventDefault();break}}},onArrowDownKey:function(e,n,l,d){var f=this.findNextSelectableRow(n);if(f&&this.focusRowChange(n,f),e.shiftKey){var x=this.dataToRender(d.rows),s=l+1>=x.length?x.length-1:l+1;this.onRowClick({originalEvent:e,data:x[s],index:s})}e.preventDefault()},onArrowUpKey:function(e,n,l,d){var f=this.findPrevSelectableRow(n);if(f&&this.focusRowChange(n,f),e.shiftKey){var x=this.dataToRender(d.rows),s=l-1<=0?0:l-1;this.onRowClick({originalEvent:e,data:x[s],index:s})}e.preventDefault()},onHomeKey:function(e,n,l,d){var f=this.findFirstSelectableRow();if(f&&this.focusRowChange(n,f),e.ctrlKey&&e.shiftKey){var x=this.dataToRender(d.rows);this.$emit("update:selection",x.slice(0,l+1))}e.preventDefault()},onEndKey:function(e,n,l,d){var f=this.findLastSelectableRow();if(f&&this.focusRowChange(n,f),e.ctrlKey&&e.shiftKey){var x=this.dataToRender(d.rows);this.$emit("update:selection",x.slice(l,x.length))}e.preventDefault()},onEnterKey:function(e,n,l){this.onRowClick({originalEvent:e,data:n,index:l}),e.preventDefault()},onSpaceKey:function(e,n,l,d){if(this.onEnterKey(e,n,l),e.shiftKey&&this.selection!==null){var f=this.dataToRender(d.rows),x;if(this.selection.length>0){var s,C;s=vC(this.selection[0],f),C=vC(this.selection[this.selection.length-1],f),x=l<=s?C:s}else x=vC(this.selection,f);var P=x!==l?f.slice(Math.min(x,l),Math.max(x,l)+1):n;this.$emit("update:selection",P)}},onTabKey:function(e,n){var l=this.$refs.bodyRef&&this.$refs.bodyRef.$el,d=lg(l,'tr[data-p-selectable-row="true"]');if(e.code==="Tab"&&d&&d.length>0){var f=Lh(l,'tr[data-p-selected="true"]'),x=Lh(l,'tr[data-p-selectable-row="true"][tabindex="0"]');f?(f.tabIndex="0",x&&x!==f&&(x.tabIndex="-1")):(d[0].tabIndex="0",x!==d[0]&&d[n]&&(d[n].tabIndex="-1"))}},findNextSelectableRow:function(e){var n=e.nextElementSibling;return n?Cs(n,"data-p-selectable-row")===!0?n:this.findNextSelectableRow(n):null},findPrevSelectableRow:function(e){var n=e.previousElementSibling;return n?Cs(n,"data-p-selectable-row")===!0?n:this.findPrevSelectableRow(n):null},findFirstSelectableRow:function(){var e=Lh(this.$refs.table,'tr[data-p-selectable-row="true"]');return e},findLastSelectableRow:function(){var e=lg(this.$refs.table,'tr[data-p-selectable-row="true"]');return e?e[e.length-1]:null},focusRowChange:function(e,n){e.tabIndex="-1",n.tabIndex="0",Ea(n)},toggleRowWithRadio:function(e){var n=e.data;this.isSelected(n)?(this.$emit("update:selection",null),this.$emit("row-unselect",{originalEvent:e.originalEvent,data:n,index:e.index,type:"radiobutton"})):(this.$emit("update:selection",n),this.$emit("row-select",{originalEvent:e.originalEvent,data:n,index:e.index,type:"radiobutton"}))},toggleRowWithCheckbox:function(e){var n=e.data;if(this.isSelected(n)){var l=this.findIndexInSelection(n),d=this.selection.filter(function(x,s){return s!=l});this.$emit("update:selection",d),this.$emit("row-unselect",{originalEvent:e.originalEvent,data:n,index:e.index,type:"checkbox"})}else{var f=this.selection?jo(this.selection):[];f=[].concat(jo(f),[n]),this.$emit("update:selection",f),this.$emit("row-select",{originalEvent:e.originalEvent,data:n,index:e.index,type:"checkbox"})}},toggleRowsWithCheckbox:function(e){if(this.selectAll!==null)this.$emit("select-all-change",e);else{var n=e.originalEvent,l=e.checked,d=[];l?(d=this.frozenValue?[].concat(jo(this.frozenValue),jo(this.processedData)):this.processedData,this.$emit("row-select-all",{originalEvent:n,data:d})):this.$emit("row-unselect-all",{originalEvent:n}),this.$emit("update:selection",d)}},isSingleSelectionMode:function(){return this.selectionMode==="single"},isMultipleSelectionMode:function(){return this.selectionMode==="multiple"},isSelected:function(e){return e&&this.selection?this.dataKey?this.d_selectionKeys?this.d_selectionKeys[Di(e,this.dataKey)]!==void 0:!1:this.selection instanceof Array?this.findIndexInSelection(e)>-1:this.equals(e,this.selection):!1},findIndexInSelection:function(e){return this.findIndex(e,this.selection)},findIndex:function(e,n){var l=-1;if(n&&n.length){for(var d=0;d<n.length;d++)if(this.equals(e,n[d])){l=d;break}}return l},updateSelectionKeys:function(e){if(this.d_selectionKeys={},Array.isArray(e)){var n=ev(e),l;try{for(n.s();!(l=n.n()).done;){var d=l.value;this.d_selectionKeys[String(Di(d,this.dataKey))]=1}}catch(f){n.e(f)}finally{n.f()}}else this.d_selectionKeys[String(Di(e,this.dataKey))]=1},updateEditingRowKeys:function(e){if(e&&e.length){this.d_editingRowKeys={};var n=ev(e),l;try{for(n.s();!(l=n.n()).done;){var d=l.value;this.d_editingRowKeys[String(Di(d,this.dataKey))]=1}}catch(f){n.e(f)}finally{n.f()}}else this.d_editingRowKeys=null},equals:function(e,n){return this.compareSelectionBy==="equals"?e===n:Pp(e,n,this.dataKey)},selectRange:function(e){var n,l;this.rangeRowIndex>this.anchorRowIndex?(n=this.anchorRowIndex,l=this.rangeRowIndex):this.rangeRowIndex<this.anchorRowIndex?(n=this.rangeRowIndex,l=this.anchorRowIndex):(n=this.rangeRowIndex,l=this.rangeRowIndex),this.lazy&&this.paginator&&(n-=this.d_first,l-=this.d_first);for(var d=this.processedData,f=[],x=n;x<=l;x++){var s=d[x];f.push(s),this.$emit("row-select",{originalEvent:e,data:s,type:"row"})}this.$emit("update:selection",f)},generateCSV:function(e,n){var l=this,d="\uFEFF";n||(n=this.processedData,e&&e.selectionOnly?n=this.selection||[]:this.frozenValue&&(n=n?[].concat(jo(this.frozenValue),jo(n)):this.frozenValue));for(var f=!1,x=0;x<this.columns.length;x++){var s=this.columns[x];this.columnProp(s,"exportable")!==!1&&this.columnProp(s,"field")&&(f?d+=this.csvSeparator:f=!0,d+='"'+(this.columnProp(s,"exportHeader")||this.columnProp(s,"header")||this.columnProp(s,"field"))+'"')}n&&n.forEach(function($){d+=`
`;for(var V=!1,j=0;j<l.columns.length;j++){var ue=l.columns[j];if(l.columnProp(ue,"exportable")!==!1&&l.columnProp(ue,"field")){V?d+=l.csvSeparator:V=!0;var de=Di($,l.columnProp(ue,"field"));de!=null?l.exportFunction?de=l.exportFunction({data:de,field:l.columnProp(ue,"field")}):de=String(de).replace(/"/g,'""'):de="",d+='"'+de+'"'}}});for(var C=!1,P=0;P<this.columns.length;P++){var L=this.columns[P];P===0&&(d+=`
`),this.columnProp(L,"exportable")!==!1&&this.columnProp(L,"exportFooter")&&(C?d+=this.csvSeparator:C=!0,d+='"'+(this.columnProp(L,"exportFooter")||this.columnProp(L,"footer")||this.columnProp(L,"field"))+'"')}return d},exportCSV:function(e,n){var l=this.generateCSV(e,n);hee(l,this.exportFilename)},resetPage:function(){this.d_first=0,this.$emit("update:first",this.d_first)},onColumnResizeStart:function(e){var n=cg(this.$el).left;this.resizeColumnElement=e.target.parentElement,this.columnResizing=!0,this.lastResizeHelperX=e.pageX-n+this.$el.scrollLeft,this.bindColumnResizeEvents()},onColumnResize:function(e){var n=cg(this.$el).left;this.$el.setAttribute("data-p-unselectable-text","true"),!this.isUnstyled&&zw(this.$el,{"user-select":"none"}),this.$refs.resizeHelper.style.height=this.$el.offsetHeight+"px",this.$refs.resizeHelper.style.top="0px",this.$refs.resizeHelper.style.left=e.pageX-n+this.$el.scrollLeft+"px",this.$refs.resizeHelper.style.display="block"},onColumnResizeEnd:function(){var e=jB(this.$el)?this.lastResizeHelperX-this.$refs.resizeHelper.offsetLeft:this.$refs.resizeHelper.offsetLeft-this.lastResizeHelperX,n=this.resizeColumnElement.offsetWidth,l=n+e,d=this.resizeColumnElement.style.minWidth||15;if(n+e>parseInt(d,10)){if(this.columnResizeMode==="fit"){var f=this.resizeColumnElement.nextElementSibling,x=f.offsetWidth-e;l>15&&x>15&&this.resizeTableCells(l,x)}else if(this.columnResizeMode==="expand"){var s=this.$refs.table.offsetWidth+e+"px",C=function(V){V&&(V.style.width=V.style.minWidth=s)};if(this.resizeTableCells(l),C(this.$refs.table),!this.virtualScrollerDisabled){var P=this.$refs.bodyRef&&this.$refs.bodyRef.$el,L=this.$refs.frozenBodyRef&&this.$refs.frozenBodyRef.$el;C(P),C(L)}}this.$emit("column-resize-end",{element:this.resizeColumnElement,delta:e})}this.$refs.resizeHelper.style.display="none",this.resizeColumn=null,this.$el.removeAttribute("data-p-unselectable-text"),!this.isUnstyled&&(this.$el.style["user-select"]=""),this.unbindColumnResizeEvents(),this.isStateful()&&this.saveState()},resizeTableCells:function(e,n){var l=Zx(this.resizeColumnElement),d=[],f=lg(this.$refs.table,'thead[data-pc-section="thead"] > tr > th');f.forEach(function(C){return d.push(Ga(C))}),this.destroyStyleElement(),this.createStyleElement();var x="",s='[data-pc-name="datatable"]['.concat(this.$attrSelector,'] > [data-pc-section="tablecontainer"] ').concat(this.virtualScrollerDisabled?"":'> [data-pc-name="virtualscroller"]',' > table[data-pc-section="table"]');d.forEach(function(C,P){var L=P===l?e:n&&P===l+1?n:C,$="width: ".concat(L,"px !important; max-width: ").concat(L,"px !important");x+=`
                    `.concat(s,' > thead[data-pc-section="thead"] > tr > th:nth-child(').concat(P+1,`),
                    `).concat(s,' > tbody[data-pc-section="tbody"] > tr > td:nth-child(').concat(P+1,`),
                    `).concat(s,' > tfoot[data-pc-section="tfoot"] > tr > td:nth-child(').concat(P+1,`) {
                        `).concat($,`
                    }
                `)}),this.styleElement.innerHTML=x},bindColumnResizeEvents:function(){var e=this;this.documentColumnResizeListener||(this.documentColumnResizeListener=function(n){e.columnResizing&&e.onColumnResize(n)},document.addEventListener("mousemove",this.documentColumnResizeListener)),this.documentColumnResizeEndListener||(this.documentColumnResizeEndListener=function(){e.columnResizing&&(e.columnResizing=!1,e.onColumnResizeEnd())},document.addEventListener("mouseup",this.documentColumnResizeEndListener))},unbindColumnResizeEvents:function(){this.documentColumnResizeListener&&(document.removeEventListener("document",this.documentColumnResizeListener),this.documentColumnResizeListener=null),this.documentColumnResizeEndListener&&(document.removeEventListener("document",this.documentColumnResizeEndListener),this.documentColumnResizeEndListener=null)},onColumnHeaderMouseDown:function(e){var n=e.originalEvent,l=e.column;this.reorderableColumns&&this.columnProp(l,"reorderableColumn")!==!1&&(n.target.nodeName==="INPUT"||n.target.nodeName==="TEXTAREA"||Cs(n.target,'[data-pc-section="columnresizer"]')?n.currentTarget.draggable=!1:n.currentTarget.draggable=!0)},onColumnHeaderDragStart:function(e){var n=e.originalEvent,l=e.column;if(this.columnResizing){n.preventDefault();return}this.colReorderIconWidth=yee(this.$refs.reorderIndicatorUp),this.colReorderIconHeight=_ee(this.$refs.reorderIndicatorUp),this.draggedColumn=l,this.draggedColumnElement=this.findParentHeader(n.target),n.dataTransfer.setData("text","b")},onColumnHeaderDragOver:function(e){var n=e.originalEvent,l=e.column,d=this.findParentHeader(n.target);if(this.reorderableColumns&&this.draggedColumnElement&&d&&!this.columnProp(l,"frozen")){n.preventDefault();var f=cg(this.$el),x=cg(d);if(this.draggedColumnElement!==d){var s=x.left-f.left,C=x.left+d.offsetWidth/2;this.$refs.reorderIndicatorUp.style.top=x.top-f.top-(this.colReorderIconHeight-1)+"px",this.$refs.reorderIndicatorDown.style.top=x.top-f.top+d.offsetHeight+"px",n.pageX>C?(this.$refs.reorderIndicatorUp.style.left=s+d.offsetWidth-Math.ceil(this.colReorderIconWidth/2)+"px",this.$refs.reorderIndicatorDown.style.left=s+d.offsetWidth-Math.ceil(this.colReorderIconWidth/2)+"px",this.dropPosition=1):(this.$refs.reorderIndicatorUp.style.left=s-Math.ceil(this.colReorderIconWidth/2)+"px",this.$refs.reorderIndicatorDown.style.left=s-Math.ceil(this.colReorderIconWidth/2)+"px",this.dropPosition=-1),this.$refs.reorderIndicatorUp.style.display="block",this.$refs.reorderIndicatorDown.style.display="block"}}},onColumnHeaderDragLeave:function(e){var n=e.originalEvent;this.reorderableColumns&&this.draggedColumnElement&&(n.preventDefault(),this.$refs.reorderIndicatorUp.style.display="none",this.$refs.reorderIndicatorDown.style.display="none")},onColumnHeaderDrop:function(e){var n=this,l=e.originalEvent,d=e.column;if(l.preventDefault(),this.draggedColumnElement){var f=Zx(this.draggedColumnElement),x=Zx(this.findParentHeader(l.target)),s=f!==x;if(s&&(x-f===1&&this.dropPosition===-1||x-f===-1&&this.dropPosition===1)&&(s=!1),s){var C=function(Be,Ge){return n.columnProp(Be,"columnKey")||n.columnProp(Ge,"columnKey")?n.columnProp(Be,"columnKey")===n.columnProp(Ge,"columnKey"):n.columnProp(Be,"field")===n.columnProp(Ge,"field")},P=this.columns.findIndex(function(Te){return C(Te,n.draggedColumn)}),L=this.columns.findIndex(function(Te){return C(Te,d)}),$=[],V=lg(this.$el,'thead[data-pc-section="thead"] > tr > th');V.forEach(function(Te){return $.push(Ga(Te))});var j=$.find(function(Te,Be){return Be===P}),ue=$.filter(function(Te,Be){return Be!==P}),de=[].concat(jo(ue.slice(0,L)),[j],jo(ue.slice(L)));this.addColumnWidthStyles(de),L<P&&this.dropPosition===1&&L++,L>P&&this.dropPosition===-1&&L--,yL(this.columns,P,L),this.updateReorderableColumns(),this.$emit("column-reorder",{originalEvent:l,dragIndex:P,dropIndex:L})}this.$refs.reorderIndicatorUp.style.display="none",this.$refs.reorderIndicatorDown.style.display="none",this.draggedColumnElement.draggable=!1,this.draggedColumnElement=null,this.draggedColumn=null,this.dropPosition=null}},findParentHeader:function(e){if(e.nodeName==="TH")return e;for(var n=e.parentElement;n.nodeName!=="TH"&&(n=n.parentElement,!!n););return n},findColumnByKey:function(e,n){if(e&&e.length)for(var l=0;l<e.length;l++){var d=e[l];if(this.columnProp(d,"columnKey")===n||this.columnProp(d,"field")===n)return d}return null},onRowMouseDown:function(e){Cs(e.target,"data-pc-section")==="reorderablerowhandle"||Cs(e.target.parentElement,"data-pc-section")==="reorderablerowhandle"?e.currentTarget.draggable=!0:e.currentTarget.draggable=!1},onRowDragStart:function(e){var n=e.originalEvent,l=e.index;this.rowDragging=!0,this.draggedRowIndex=l,n.dataTransfer.setData("text","b")},onRowDragOver:function(e){var n=e.originalEvent,l=e.index;if(this.rowDragging&&this.draggedRowIndex!==l){var d=n.currentTarget,f=cg(d).top,x=n.pageY,s=f+Bw(d)/2,C=d.previousElementSibling;x<s?(d.setAttribute("data-p-datatable-dragpoint-bottom","false"),!this.isUnstyled&&kh(d,"p-datatable-dragpoint-bottom"),this.droppedRowIndex=l,C?(C.setAttribute("data-p-datatable-dragpoint-bottom","true"),!this.isUnstyled&&hv(C,"p-datatable-dragpoint-bottom")):(d.setAttribute("data-p-datatable-dragpoint-top","true"),!this.isUnstyled&&hv(d,"p-datatable-dragpoint-top"))):(C?(C.setAttribute("data-p-datatable-dragpoint-bottom","false"),!this.isUnstyled&&kh(C,"p-datatable-dragpoint-bottom")):(d.setAttribute("data-p-datatable-dragpoint-top","true"),!this.isUnstyled&&hv(d,"p-datatable-dragpoint-top")),this.droppedRowIndex=l+1,d.setAttribute("data-p-datatable-dragpoint-bottom","true"),!this.isUnstyled&&hv(d,"p-datatable-dragpoint-bottom")),n.preventDefault()}},onRowDragLeave:function(e){var n=e.currentTarget,l=n.previousElementSibling;l&&(l.setAttribute("data-p-datatable-dragpoint-bottom","false"),!this.isUnstyled&&kh(l,"p-datatable-dragpoint-bottom")),n.setAttribute("data-p-datatable-dragpoint-bottom","false"),!this.isUnstyled&&kh(n,"p-datatable-dragpoint-bottom"),n.setAttribute("data-p-datatable-dragpoint-top","false"),!this.isUnstyled&&kh(n,"p-datatable-dragpoint-top")},onRowDragEnd:function(e){this.rowDragging=!1,this.draggedRowIndex=null,this.droppedRowIndex=null,e.currentTarget.draggable=!1},onRowDrop:function(e){if(this.droppedRowIndex!=null){var n=this.draggedRowIndex>this.droppedRowIndex?this.droppedRowIndex:this.droppedRowIndex===0?0:this.droppedRowIndex-1,l=jo(this.processedData);yL(l,this.draggedRowIndex+this.d_first,n+this.d_first),this.$emit("row-reorder",{originalEvent:e,dragIndex:this.draggedRowIndex,dropIndex:n,value:l})}this.onRowDragLeave(e),this.onRowDragEnd(e),e.preventDefault()},toggleRow:function(e){var n=this,l=e.expanded,d=rce(e,nce),f=e.data,x;if(this.dataKey){var s=Di(f,this.dataKey);x=this.expandedRows?ol({},this.expandedRows):{},l?x[s]=!0:delete x[s]}else x=this.expandedRows?jo(this.expandedRows):[],l?x.push(f):x=x.filter(function(C){return!n.equals(f,C)});this.$emit("update:expandedRows",x),l?this.$emit("row-expand",d):this.$emit("row-collapse",d)},toggleRowGroup:function(e){var n=e.originalEvent,l=e.data,d=Di(l,this.groupRowsBy),f=this.expandedRowGroups?jo(this.expandedRowGroups):[];this.isRowGroupExpanded(l)?(f=f.filter(function(x){return x!==d}),this.$emit("update:expandedRowGroups",f),this.$emit("rowgroup-collapse",{originalEvent:n,data:d})):(f.push(d),this.$emit("update:expandedRowGroups",f),this.$emit("rowgroup-expand",{originalEvent:n,data:d}))},isRowGroupExpanded:function(e){if(this.expandableRowGroups&&this.expandedRowGroups){var n=Di(e,this.groupRowsBy);return this.expandedRowGroups.indexOf(n)>-1}return!1},isStateful:function(){return this.stateKey!=null},getStorage:function(){switch(this.stateStorage){case"local":return window.localStorage;case"session":return window.sessionStorage;default:throw new Error(this.stateStorage+' is not a valid value for the state storage, supported values are "local" and "session".')}},saveState:function(){var e=this.getStorage(),n={};this.paginator&&(n.first=this.d_first,n.rows=this.d_rows),this.d_sortField&&(typeof this.d_sortField!="function"&&(n.sortField=this.d_sortField),n.sortOrder=this.d_sortOrder),this.d_multiSortMeta&&(n.multiSortMeta=this.d_multiSortMeta),this.hasFilters&&(n.filters=this.filters),this.resizableColumns&&this.saveColumnWidths(n),this.reorderableColumns&&(n.columnOrder=this.d_columnOrder),this.expandedRows&&(n.expandedRows=this.expandedRows),this.expandedRowGroups&&(n.expandedRowGroups=this.expandedRowGroups),this.selection&&(n.selection=this.selection,n.selectionKeys=this.d_selectionKeys),Object.keys(n).length&&e.setItem(this.stateKey,JSON.stringify(n)),this.$emit("state-save",n)},restoreState:function(){var e=this.getStorage(),n=e.getItem(this.stateKey),l=/\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}.\d{3}Z/,d=function(C,P){return typeof P=="string"&&l.test(P)?new Date(P):P},f;try{f=JSON.parse(n,d)}catch{}if(!f||nu(f)!=="object"){e.removeItem(this.stateKey);return}var x={};this.paginator&&(typeof f.first=="number"&&(this.d_first=f.first,this.$emit("update:first",this.d_first),x.first=this.d_first),typeof f.rows=="number"&&(this.d_rows=f.rows,this.$emit("update:rows",this.d_rows),x.rows=this.d_rows)),typeof f.sortField=="string"&&(this.d_sortField=f.sortField,this.$emit("update:sortField",this.d_sortField),x.sortField=this.d_sortField),typeof f.sortOrder=="number"&&(this.d_sortOrder=f.sortOrder,this.$emit("update:sortOrder",this.d_sortOrder),x.sortOrder=this.d_sortOrder),Array.isArray(f.multiSortMeta)&&(this.d_multiSortMeta=f.multiSortMeta,this.$emit("update:multiSortMeta",this.d_multiSortMeta),x.multiSortMeta=this.d_multiSortMeta),this.hasFilters&&nu(f.filters)==="object"&&f.filters!==null&&(this.d_filters=this.cloneFilters(f.filters),this.$emit("update:filters",this.d_filters),x.filters=this.d_filters),this.resizableColumns&&(typeof f.columnWidths=="string"&&(this.columnWidthsState=f.columnWidths,x.columnWidths=this.columnWidthsState),typeof f.tableWidth=="string"&&(this.tableWidthState=f.tableWidth,x.tableWidth=this.tableWidthState)),this.reorderableColumns&&Array.isArray(f.columnOrder)&&(this.d_columnOrder=f.columnOrder,x.columnOrder=this.d_columnOrder),nu(f.expandedRows)==="object"&&f.expandedRows!==null&&(this.$emit("update:expandedRows",f.expandedRows),x.expandedRows=f.expandedRows),Array.isArray(f.expandedRowGroups)&&(this.$emit("update:expandedRowGroups",f.expandedRowGroups),x.expandedRowGroups=f.expandedRowGroups),nu(f.selection)==="object"&&f.selection!==null&&(nu(f.selectionKeys)==="object"&&f.selectionKeys!==null&&(this.d_selectionKeys=f.selectionKeys,x.selectionKeys=this.d_selectionKeys),this.$emit("update:selection",f.selection),x.selection=f.selection),this.$emit("state-restore",x)},saveColumnWidths:function(e){var n=[],l=lg(this.$el,'thead[data-pc-section="thead"] > tr > th');l.forEach(function(d){return n.push(Ga(d))}),e.columnWidths=n.join(","),this.columnResizeMode==="expand"&&(e.tableWidth=Ga(this.$refs.table)+"px")},addColumnWidthStyles:function(e){this.createStyleElement();var n="",l='[data-pc-name="datatable"]['.concat(this.$attrSelector,'] > [data-pc-section="tablecontainer"] ').concat(this.virtualScrollerDisabled?"":'> [data-pc-name="virtualscroller"]',' > table[data-pc-section="table"]');e.forEach(function(d,f){var x="width: ".concat(d,"px !important; max-width: ").concat(d,"px !important");n+=`
        `.concat(l,' > thead[data-pc-section="thead"] > tr > th:nth-child(').concat(f+1,`),
        `).concat(l,' > tbody[data-pc-section="tbody"] > tr > td:nth-child(').concat(f+1,`),
        `).concat(l,' > tfoot[data-pc-section="tfoot"] > tr > td:nth-child(').concat(f+1,`) {
            `).concat(x,`
        }
    `)}),this.styleElement.innerHTML=n},restoreColumnWidths:function(){if(this.columnWidthsState){var e=this.columnWidthsState.split(",");this.columnResizeMode==="expand"&&this.tableWidthState&&(this.$refs.table.style.width=this.tableWidthState,this.$refs.table.style.minWidth=this.tableWidthState),si(e)&&this.addColumnWidthStyles(e)}},onCellEditInit:function(e){this.$emit("cell-edit-init",e)},onCellEditComplete:function(e){this.$emit("cell-edit-complete",e)},onCellEditCancel:function(e){this.$emit("cell-edit-cancel",e)},onRowEditInit:function(e){var n=this.editingRows?jo(this.editingRows):[];n.push(e.data),this.$emit("update:editingRows",n),this.$emit("row-edit-init",e)},onRowEditSave:function(e){var n=jo(this.editingRows);n.splice(this.findIndex(e.data,n),1),this.$emit("update:editingRows",n),this.$emit("row-edit-save",e)},onRowEditCancel:function(e){var n=jo(this.editingRows);n.splice(this.findIndex(e.data,n),1),this.$emit("update:editingRows",n),this.$emit("row-edit-cancel",e)},onEditingMetaChange:function(e){var n=e.data,l=e.field,d=e.index,f=e.editing,x=ol({},this.d_editingMeta),s=x[d];if(f)!s&&(s=x[d]={data:ol({},n),fields:[]}),s.fields.push(l);else if(s){var C=s.fields.filter(function(P){return P!==l});C.length?s.fields=C:delete x[d]}this.d_editingMeta=x},clearEditingMetaData:function(){this.editMode&&(this.d_editingMeta={})},createLazyLoadEvent:function(e){return{originalEvent:e,first:this.d_first,rows:this.d_rows,sortField:this.d_sortField,sortOrder:this.d_sortOrder,multiSortMeta:this.d_multiSortMeta,filters:this.d_filters}},hasGlobalFilter:function(){return this.filters&&Object.prototype.hasOwnProperty.call(this.filters,"global")},onFilterChange:function(e){this.d_filters=e},onFilterApply:function(){this.d_first=0,this.$emit("update:first",this.d_first),this.$emit("update:filters",this.d_filters),this.lazy&&this.$emit("filter",this.createLazyLoadEvent())},cloneFilters:function(e){var n={};return e&&Object.entries(e).forEach(function(l){var d=w5(l,2),f=d[0],x=d[1];n[f]=x.operator?{operator:x.operator,constraints:x.constraints.map(function(s){return ol({},s)})}:ol({},x)}),n},updateReorderableColumns:function(){var e=this,n=[];this.columns.forEach(function(l){return n.push(e.columnProp(l,"columnKey")||e.columnProp(l,"field"))}),this.d_columnOrder=n},createStyleElement:function(){var e;this.styleElement=document.createElement("style"),this.styleElement.type="text/css",eP(this.styleElement,"nonce",(e=this.$primevue)===null||e===void 0||(e=e.config)===null||e===void 0||(e=e.csp)===null||e===void 0?void 0:e.nonce),document.head.appendChild(this.styleElement)},destroyStyleElement:function(){this.styleElement&&(document.head.removeChild(this.styleElement),this.styleElement=null)},dataToRender:function(e){var n=e||this.processedData;if(n&&this.paginator){var l=this.lazy?0:this.d_first;return n.slice(l,l+this.d_rows)}return n},getVirtualScrollerRef:function(){return this.$refs.virtualScroller},hasSpacerStyle:function(e){return si(e)}},computed:{columns:function(){var e=this.d_columns.get(this);if(e&&this.reorderableColumns&&this.d_columnOrder){var n=[],l=ev(this.d_columnOrder),d;try{for(l.s();!(d=l.n()).done;){var f=d.value,x=this.findColumnByKey(e,f);x&&!this.columnProp(x,"hidden")&&n.push(x)}}catch(s){l.e(s)}finally{l.f()}return[].concat(n,jo(e.filter(function(s){return n.indexOf(s)<0})))}return e},columnGroups:function(){return this.d_columnGroups.get(this)},headerColumnGroup:function(){var e,n=this;return(e=this.columnGroups)===null||e===void 0?void 0:e.find(function(l){return n.columnProp(l,"type")==="header"})},footerColumnGroup:function(){var e,n=this;return(e=this.columnGroups)===null||e===void 0?void 0:e.find(function(l){return n.columnProp(l,"type")==="footer"})},hasFilters:function(){return this.filters&&Object.keys(this.filters).length>0&&this.filters.constructor===Object},processedData:function(){var e,n=this.value||[];return!this.lazy&&!((e=this.virtualScrollerOptions)!==null&&e!==void 0&&e.lazy)&&n&&n.length&&(this.hasFilters&&(n=this.filter(n)),this.sorted&&(this.sortMode==="single"?n=this.sortSingle(n):this.sortMode==="multiple"&&(n=this.sortMultiple(n)))),n},totalRecordsLength:function(){if(this.lazy)return this.totalRecords;var e=this.processedData;return e?e.length:0},empty:function(){var e=this.processedData;return!e||e.length===0},paginatorTop:function(){return this.paginator&&(this.paginatorPosition!=="bottom"||this.paginatorPosition==="both")},paginatorBottom:function(){return this.paginator&&(this.paginatorPosition!=="top"||this.paginatorPosition==="both")},sorted:function(){return this.d_sortField||this.d_multiSortMeta&&this.d_multiSortMeta.length>0},allRowsSelected:function(){var e=this;if(this.selectAll!==null)return this.selectAll;var n=this.frozenValue?[].concat(jo(this.frozenValue),jo(this.processedData)):this.processedData;return si(n)&&this.selection&&Array.isArray(this.selection)&&n.every(function(l){return e.selection.some(function(d){return e.equals(d,l)})})},groupRowSortField:function(){return this.sortMode==="single"?this.sortField:this.d_groupRowsSortMeta?this.d_groupRowsSortMeta.field:null},headerFilterButtonProps:function(){return ol(ol({filter:{severity:"secondary",text:!0,rounded:!0}},this.filterButtonProps),{},{inline:ol({clear:{severity:"secondary",text:!0,rounded:!0}},this.filterButtonProps.inline),popover:ol({addRule:{severity:"info",text:!0,size:"small"},removeRule:{severity:"danger",text:!0,size:"small"},apply:{size:"small"},clear:{outlined:!0,size:"small"}},this.filterButtonProps.popover)})},rowEditButtonProps:function(){return ol(ol({},{init:{severity:"secondary",text:!0,rounded:!0},save:{severity:"secondary",text:!0,rounded:!0},cancel:{severity:"secondary",text:!0,rounded:!0}}),this.editButtonProps)},virtualScrollerDisabled:function(){return Wa(this.virtualScrollerOptions)||!this.scrollable},dataP:function(){return Rs(Xx(Xx(Xx({scrollable:this.scrollable,"flex-scrollable":this.scrollable&&this.scrollHeight==="flex"},this.size,this.size),"loading",this.loading),"empty",this.empty))}},components:{DTPaginator:zN,DTTableHeader:tV,DTTableBody:XN,DTTableFooter:JN,DTVirtualScroller:oP,ArrowDownIcon:fN,ArrowUpIcon:pN,SpinnerIcon:cb}};function z0(t){"@babel/helpers - typeof";return z0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},z0(t)}function T5(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);e&&(l=l.filter(function(d){return Object.getOwnPropertyDescriptor(t,d).enumerable})),n.push.apply(n,l)}return n}function S5(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?T5(Object(n),!0).forEach(function(l){fce(t,l,n[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):T5(Object(n)).forEach(function(l){Object.defineProperty(t,l,Object.getOwnPropertyDescriptor(n,l))})}return t}function fce(t,e,n){return(e=pce(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function pce(t){var e=mce(t,"string");return z0(e)=="symbol"?e:e+""}function mce(t,e){if(z0(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var l=n.call(t,e);if(z0(l)!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var gce=["data-p"],_ce=["data-p"];function yce(t,e,n,l,d,f){var x=_r("SpinnerIcon"),s=_r("DTPaginator"),C=_r("DTTableHeader"),P=_r("DTTableBody"),L=_r("DTTableFooter"),$=_r("DTVirtualScroller");return Me(),ft("div",ot({class:t.cx("root"),"data-scrollselectors":".p-datatable-wrapper","data-p":f.dataP},t.ptmi("root")),[ir(t.$slots,"default"),t.loading?(Me(),ft("div",ot({key:0,class:t.cx("mask")},t.ptm("mask")),[t.$slots.loading?ir(t.$slots,"loading",{key:0}):(Me(),ft(Tr,{key:1},[t.$slots.loadingicon?(Me(),rn(Hr(t.$slots.loadingicon),{key:0,class:wr(t.cx("loadingIcon"))},null,8,["class"])):t.loadingIcon?(Me(),ft("i",ot({key:1,class:[t.cx("loadingIcon"),"pi-spin",t.loadingIcon]},t.ptm("loadingIcon")),null,16)):(Me(),rn(x,ot({key:2,spin:"",class:t.cx("loadingIcon")},t.ptm("loadingIcon")),null,16,["class"]))],64))],16)):Pn("",!0),t.$slots.header?(Me(),ft("div",ot({key:1,class:t.cx("header")},t.ptm("header")),[ir(t.$slots,"header")],16)):Pn("",!0),f.paginatorTop?(Me(),rn(s,{key:2,rows:d.d_rows,first:d.d_first,totalRecords:f.totalRecordsLength,pageLinkSize:t.pageLinkSize,template:t.paginatorTemplate,rowsPerPageOptions:t.rowsPerPageOptions,currentPageReportTemplate:t.currentPageReportTemplate,class:wr(t.cx("pcPaginator",{position:"top"})),onPage:e[0]||(e[0]=function(V){return f.onPage(V)}),alwaysShow:t.alwaysShowPaginator,unstyled:t.unstyled,"data-p-top":!0,pt:t.ptm("pcPaginator")},Nv({_:2},[t.$slots.paginatorcontainer?{name:"container",fn:zr(function(V){return[ir(t.$slots,"paginatorcontainer",{first:V.first,last:V.last,rows:V.rows,page:V.page,pageCount:V.pageCount,pageLinks:V.pageLinks,totalRecords:V.totalRecords,firstPageCallback:V.firstPageCallback,lastPageCallback:V.lastPageCallback,prevPageCallback:V.prevPageCallback,nextPageCallback:V.nextPageCallback,rowChangeCallback:V.rowChangeCallback,changePageCallback:V.changePageCallback})]}),key:"0"}:void 0,t.$slots.paginatorstart?{name:"start",fn:zr(function(){return[ir(t.$slots,"paginatorstart")]}),key:"1"}:void 0,t.$slots.paginatorend?{name:"end",fn:zr(function(){return[ir(t.$slots,"paginatorend")]}),key:"2"}:void 0,t.$slots.paginatorfirstpagelinkicon?{name:"firstpagelinkicon",fn:zr(function(V){return[ir(t.$slots,"paginatorfirstpagelinkicon",{class:wr(V.class)})]}),key:"3"}:void 0,t.$slots.paginatorprevpagelinkicon?{name:"prevpagelinkicon",fn:zr(function(V){return[ir(t.$slots,"paginatorprevpagelinkicon",{class:wr(V.class)})]}),key:"4"}:void 0,t.$slots.paginatornextpagelinkicon?{name:"nextpagelinkicon",fn:zr(function(V){return[ir(t.$slots,"paginatornextpagelinkicon",{class:wr(V.class)})]}),key:"5"}:void 0,t.$slots.paginatorlastpagelinkicon?{name:"lastpagelinkicon",fn:zr(function(V){return[ir(t.$slots,"paginatorlastpagelinkicon",{class:wr(V.class)})]}),key:"6"}:void 0,t.$slots.paginatorjumptopagedropdownicon?{name:"jumptopagedropdownicon",fn:zr(function(V){return[ir(t.$slots,"paginatorjumptopagedropdownicon",{class:wr(V.class)})]}),key:"7"}:void 0,t.$slots.paginatorrowsperpagedropdownicon?{name:"rowsperpagedropdownicon",fn:zr(function(V){return[ir(t.$slots,"paginatorrowsperpagedropdownicon",{class:wr(V.class)})]}),key:"8"}:void 0]),1032,["rows","first","totalRecords","pageLinkSize","template","rowsPerPageOptions","currentPageReportTemplate","class","alwaysShow","unstyled","pt"])):Pn("",!0),Ze("div",ot({class:t.cx("tableContainer"),style:[t.sx("tableContainer"),{maxHeight:f.virtualScrollerDisabled?t.scrollHeight:""}],"data-p":f.dataP},t.ptm("tableContainer")),[pr($,ot({ref:"virtualScroller"},t.virtualScrollerOptions,{items:f.processedData,columns:f.columns,style:t.scrollHeight!=="flex"?{height:t.scrollHeight}:void 0,scrollHeight:t.scrollHeight!=="flex"?void 0:"100%",disabled:f.virtualScrollerDisabled,loaderDisabled:"",inline:"",autoSize:"",showSpacer:!1,pt:t.ptm("virtualScroller")}),{content:zr(function(V){return[Ze("table",ot({ref:"table",role:"table",class:[t.cx("table"),t.tableClass],style:[t.tableStyle,V.spacerStyle]},S5(S5({},t.tableProps),t.ptm("table"))),[t.showHeaders?(Me(),rn(C,{key:0,columnGroup:f.headerColumnGroup,columns:V.columns,rowGroupMode:t.rowGroupMode,groupRowsBy:t.groupRowsBy,groupRowSortField:f.groupRowSortField,reorderableColumns:t.reorderableColumns,resizableColumns:t.resizableColumns,allRowsSelected:f.allRowsSelected,empty:f.empty,sortMode:t.sortMode,sortField:d.d_sortField,sortOrder:d.d_sortOrder,multiSortMeta:d.d_multiSortMeta,filters:d.d_filters,filtersStore:t.filters,filterDisplay:t.filterDisplay,filterButtonProps:f.headerFilterButtonProps,filterInputProps:t.filterInputProps,first:d.d_first,onColumnClick:e[1]||(e[1]=function(j){return f.onColumnHeaderClick(j)}),onColumnMousedown:e[2]||(e[2]=function(j){return f.onColumnHeaderMouseDown(j)}),onFilterChange:f.onFilterChange,onFilterApply:f.onFilterApply,onColumnDragstart:e[3]||(e[3]=function(j){return f.onColumnHeaderDragStart(j)}),onColumnDragover:e[4]||(e[4]=function(j){return f.onColumnHeaderDragOver(j)}),onColumnDragleave:e[5]||(e[5]=function(j){return f.onColumnHeaderDragLeave(j)}),onColumnDrop:e[6]||(e[6]=function(j){return f.onColumnHeaderDrop(j)}),onColumnResizestart:e[7]||(e[7]=function(j){return f.onColumnResizeStart(j)}),onCheckboxChange:e[8]||(e[8]=function(j){return f.toggleRowsWithCheckbox(j)}),unstyled:t.unstyled,pt:t.pt},null,8,["columnGroup","columns","rowGroupMode","groupRowsBy","groupRowSortField","reorderableColumns","resizableColumns","allRowsSelected","empty","sortMode","sortField","sortOrder","multiSortMeta","filters","filtersStore","filterDisplay","filterButtonProps","filterInputProps","first","onFilterChange","onFilterApply","unstyled","pt"])):Pn("",!0),t.frozenValue?(Me(),rn(P,{key:1,ref:"frozenBodyRef",value:t.frozenValue,frozenRow:!0,columns:V.columns,first:d.d_first,dataKey:t.dataKey,selection:t.selection,selectionKeys:d.d_selectionKeys,selectionMode:t.selectionMode,rowHover:t.rowHover,contextMenu:t.contextMenu,contextMenuSelection:t.contextMenuSelection,rowGroupMode:t.rowGroupMode,groupRowsBy:t.groupRowsBy,expandableRowGroups:t.expandableRowGroups,rowClass:t.rowClass,rowStyle:t.rowStyle,editMode:t.editMode,compareSelectionBy:t.compareSelectionBy,scrollable:t.scrollable,expandedRowIcon:t.expandedRowIcon,collapsedRowIcon:t.collapsedRowIcon,expandedRows:t.expandedRows,expandedRowGroups:t.expandedRowGroups,editingRows:t.editingRows,editingRowKeys:d.d_editingRowKeys,templates:t.$slots,editButtonProps:f.rowEditButtonProps,isVirtualScrollerDisabled:!0,onRowgroupToggle:f.toggleRowGroup,onRowClick:e[9]||(e[9]=function(j){return f.onRowClick(j)}),onRowDblclick:e[10]||(e[10]=function(j){return f.onRowDblClick(j)}),onRowRightclick:e[11]||(e[11]=function(j){return f.onRowRightClick(j)}),onRowTouchend:f.onRowTouchEnd,onRowKeydown:f.onRowKeyDown,onRowMousedown:f.onRowMouseDown,onRowDragstart:e[12]||(e[12]=function(j){return f.onRowDragStart(j)}),onRowDragover:e[13]||(e[13]=function(j){return f.onRowDragOver(j)}),onRowDragleave:e[14]||(e[14]=function(j){return f.onRowDragLeave(j)}),onRowDragend:e[15]||(e[15]=function(j){return f.onRowDragEnd(j)}),onRowDrop:e[16]||(e[16]=function(j){return f.onRowDrop(j)}),onRowToggle:e[17]||(e[17]=function(j){return f.toggleRow(j)}),onRadioChange:e[18]||(e[18]=function(j){return f.toggleRowWithRadio(j)}),onCheckboxChange:e[19]||(e[19]=function(j){return f.toggleRowWithCheckbox(j)}),onCellEditInit:e[20]||(e[20]=function(j){return f.onCellEditInit(j)}),onCellEditComplete:e[21]||(e[21]=function(j){return f.onCellEditComplete(j)}),onCellEditCancel:e[22]||(e[22]=function(j){return f.onCellEditCancel(j)}),onRowEditInit:e[23]||(e[23]=function(j){return f.onRowEditInit(j)}),onRowEditSave:e[24]||(e[24]=function(j){return f.onRowEditSave(j)}),onRowEditCancel:e[25]||(e[25]=function(j){return f.onRowEditCancel(j)}),editingMeta:d.d_editingMeta,onEditingMetaChange:f.onEditingMetaChange,unstyled:t.unstyled,pt:t.pt},null,8,["value","columns","first","dataKey","selection","selectionKeys","selectionMode","rowHover","contextMenu","contextMenuSelection","rowGroupMode","groupRowsBy","expandableRowGroups","rowClass","rowStyle","editMode","compareSelectionBy","scrollable","expandedRowIcon","collapsedRowIcon","expandedRows","expandedRowGroups","editingRows","editingRowKeys","templates","editButtonProps","onRowgroupToggle","onRowTouchend","onRowKeydown","onRowMousedown","editingMeta","onEditingMetaChange","unstyled","pt"])):Pn("",!0),pr(P,{ref:"bodyRef",value:f.dataToRender(V.rows),class:wr(V.styleClass),columns:V.columns,empty:f.empty,first:d.d_first,dataKey:t.dataKey,selection:t.selection,selectionKeys:d.d_selectionKeys,selectionMode:t.selectionMode,rowHover:t.rowHover,contextMenu:t.contextMenu,contextMenuSelection:t.contextMenuSelection,rowGroupMode:t.rowGroupMode,groupRowsBy:t.groupRowsBy,expandableRowGroups:t.expandableRowGroups,rowClass:t.rowClass,rowStyle:t.rowStyle,editMode:t.editMode,compareSelectionBy:t.compareSelectionBy,scrollable:t.scrollable,expandedRowIcon:t.expandedRowIcon,collapsedRowIcon:t.collapsedRowIcon,expandedRows:t.expandedRows,expandedRowGroups:t.expandedRowGroups,editingRows:t.editingRows,editingRowKeys:d.d_editingRowKeys,templates:t.$slots,editButtonProps:f.rowEditButtonProps,virtualScrollerContentProps:V,isVirtualScrollerDisabled:f.virtualScrollerDisabled,onRowgroupToggle:f.toggleRowGroup,onRowClick:e[26]||(e[26]=function(j){return f.onRowClick(j)}),onRowDblclick:e[27]||(e[27]=function(j){return f.onRowDblClick(j)}),onRowRightclick:e[28]||(e[28]=function(j){return f.onRowRightClick(j)}),onRowTouchend:f.onRowTouchEnd,onRowKeydown:function(ue){return f.onRowKeyDown(ue,V)},onRowMousedown:f.onRowMouseDown,onRowDragstart:e[29]||(e[29]=function(j){return f.onRowDragStart(j)}),onRowDragover:e[30]||(e[30]=function(j){return f.onRowDragOver(j)}),onRowDragleave:e[31]||(e[31]=function(j){return f.onRowDragLeave(j)}),onRowDragend:e[32]||(e[32]=function(j){return f.onRowDragEnd(j)}),onRowDrop:e[33]||(e[33]=function(j){return f.onRowDrop(j)}),onRowToggle:e[34]||(e[34]=function(j){return f.toggleRow(j)}),onRadioChange:e[35]||(e[35]=function(j){return f.toggleRowWithRadio(j)}),onCheckboxChange:e[36]||(e[36]=function(j){return f.toggleRowWithCheckbox(j)}),onCellEditInit:e[37]||(e[37]=function(j){return f.onCellEditInit(j)}),onCellEditComplete:e[38]||(e[38]=function(j){return f.onCellEditComplete(j)}),onCellEditCancel:e[39]||(e[39]=function(j){return f.onCellEditCancel(j)}),onRowEditInit:e[40]||(e[40]=function(j){return f.onRowEditInit(j)}),onRowEditSave:e[41]||(e[41]=function(j){return f.onRowEditSave(j)}),onRowEditCancel:e[42]||(e[42]=function(j){return f.onRowEditCancel(j)}),editingMeta:d.d_editingMeta,onEditingMetaChange:f.onEditingMetaChange,unstyled:t.unstyled,pt:t.pt},null,8,["value","class","columns","empty","first","dataKey","selection","selectionKeys","selectionMode","rowHover","contextMenu","contextMenuSelection","rowGroupMode","groupRowsBy","expandableRowGroups","rowClass","rowStyle","editMode","compareSelectionBy","scrollable","expandedRowIcon","collapsedRowIcon","expandedRows","expandedRowGroups","editingRows","editingRowKeys","templates","editButtonProps","virtualScrollerContentProps","isVirtualScrollerDisabled","onRowgroupToggle","onRowTouchend","onRowKeydown","onRowMousedown","editingMeta","onEditingMetaChange","unstyled","pt"]),f.hasSpacerStyle(V.spacerStyle)?(Me(),ft("tbody",ot({key:2,class:t.cx("virtualScrollerSpacer"),style:{height:"calc(".concat(V.spacerStyle.height," - ").concat(V.rows.length*V.itemSize,"px)")}},t.ptm("virtualScrollerSpacer")),null,16)):Pn("",!0),pr(L,{columnGroup:f.footerColumnGroup,columns:V.columns,pt:t.pt},null,8,["columnGroup","columns","pt"])],16)]}),_:1},16,["items","columns","style","scrollHeight","disabled","pt"])],16,_ce),f.paginatorBottom?(Me(),rn(s,{key:3,rows:d.d_rows,first:d.d_first,totalRecords:f.totalRecordsLength,pageLinkSize:t.pageLinkSize,template:t.paginatorTemplate,rowsPerPageOptions:t.rowsPerPageOptions,currentPageReportTemplate:t.currentPageReportTemplate,class:wr(t.cx("pcPaginator",{position:"bottom"})),onPage:e[43]||(e[43]=function(V){return f.onPage(V)}),alwaysShow:t.alwaysShowPaginator,unstyled:t.unstyled,"data-p-bottom":!0,pt:t.ptm("pcPaginator")},Nv({_:2},[t.$slots.paginatorcontainer?{name:"container",fn:zr(function(V){return[ir(t.$slots,"paginatorcontainer",{first:V.first,last:V.last,rows:V.rows,page:V.page,pageCount:V.pageCount,pageLinks:V.pageLinks,totalRecords:V.totalRecords,firstPageCallback:V.firstPageCallback,lastPageCallback:V.lastPageCallback,prevPageCallback:V.prevPageCallback,nextPageCallback:V.nextPageCallback,rowChangeCallback:V.rowChangeCallback,changePageCallback:V.changePageCallback})]}),key:"0"}:void 0,t.$slots.paginatorstart?{name:"start",fn:zr(function(){return[ir(t.$slots,"paginatorstart")]}),key:"1"}:void 0,t.$slots.paginatorend?{name:"end",fn:zr(function(){return[ir(t.$slots,"paginatorend")]}),key:"2"}:void 0,t.$slots.paginatorfirstpagelinkicon?{name:"firstpagelinkicon",fn:zr(function(V){return[ir(t.$slots,"paginatorfirstpagelinkicon",{class:wr(V.class)})]}),key:"3"}:void 0,t.$slots.paginatorprevpagelinkicon?{name:"prevpagelinkicon",fn:zr(function(V){return[ir(t.$slots,"paginatorprevpagelinkicon",{class:wr(V.class)})]}),key:"4"}:void 0,t.$slots.paginatornextpagelinkicon?{name:"nextpagelinkicon",fn:zr(function(V){return[ir(t.$slots,"paginatornextpagelinkicon",{class:wr(V.class)})]}),key:"5"}:void 0,t.$slots.paginatorlastpagelinkicon?{name:"lastpagelinkicon",fn:zr(function(V){return[ir(t.$slots,"paginatorlastpagelinkicon",{class:wr(V.class)})]}),key:"6"}:void 0,t.$slots.paginatorjumptopagedropdownicon?{name:"jumptopagedropdownicon",fn:zr(function(V){return[ir(t.$slots,"paginatorjumptopagedropdownicon",{class:wr(V.class)})]}),key:"7"}:void 0,t.$slots.paginatorrowsperpagedropdownicon?{name:"rowsperpagedropdownicon",fn:zr(function(V){return[ir(t.$slots,"paginatorrowsperpagedropdownicon",{class:wr(V.class)})]}),key:"8"}:void 0]),1032,["rows","first","totalRecords","pageLinkSize","template","rowsPerPageOptions","currentPageReportTemplate","class","alwaysShow","unstyled","pt"])):Pn("",!0),t.$slots.footer?(Me(),ft("div",ot({key:4,class:t.cx("footer")},t.ptm("footer")),[ir(t.$slots,"footer")],16)):Pn("",!0),Ze("div",ot({ref:"resizeHelper",class:t.cx("columnResizeIndicator"),style:{display:"none"}},t.ptm("columnResizeIndicator")),null,16),t.reorderableColumns?(Me(),ft("span",ot({key:5,ref:"reorderIndicatorUp",class:t.cx("rowReorderIndicatorUp"),style:{position:"absolute",display:"none"}},t.ptm("rowReorderIndicatorUp")),[(Me(),rn(Hr(t.$slots.rowreorderindicatorupicon||t.$slots.reorderindicatorupicon||"ArrowDownIcon")))],16)):Pn("",!0),t.reorderableColumns?(Me(),ft("span",ot({key:6,ref:"reorderIndicatorDown",class:t.cx("rowReorderIndicatorDown"),style:{position:"absolute",display:"none"}},t.ptm("rowReorderIndicatorDown")),[(Me(),rn(Hr(t.$slots.rowreorderindicatordownicon||t.$slots.reorderindicatordownicon||"ArrowUpIcon")))],16)):Pn("",!0)],16,gce)}$w.render=yce;var vce=xi.extend({name:"column"}),bce={name:"BaseColumn",extends:Yi,props:{columnKey:{type:null,default:null},field:{type:[String,Function],default:null},sortField:{type:[String,Function],default:null},filterField:{type:[String,Function],default:null},dataType:{type:String,default:"text"},sortable:{type:Boolean,default:!1},header:{type:null,default:null},footer:{type:null,default:null},style:{type:null,default:null},class:{type:String,default:null},headerStyle:{type:null,default:null},headerClass:{type:String,default:null},bodyStyle:{type:null,default:null},bodyClass:{type:String,default:null},footerStyle:{type:null,default:null},footerClass:{type:String,default:null},showFilterMenu:{type:Boolean,default:!0},showFilterOperator:{type:Boolean,default:!0},showClearButton:{type:Boolean,default:!1},showApplyButton:{type:Boolean,default:!0},showFilterMatchModes:{type:Boolean,default:!0},showAddButton:{type:Boolean,default:!0},filterMatchModeOptions:{type:Array,default:null},maxConstraints:{type:Number,default:2},excludeGlobalFilter:{type:Boolean,default:!1},filterHeaderClass:{type:String,default:null},filterHeaderStyle:{type:null,default:null},filterMenuClass:{type:String,default:null},filterMenuStyle:{type:null,default:null},selectionMode:{type:String,default:null},expander:{type:Boolean,default:!1},colspan:{type:Number,default:null},rowspan:{type:Number,default:null},rowReorder:{type:Boolean,default:!1},rowReorderIcon:{type:String,default:void 0},reorderableColumn:{type:Boolean,default:!0},rowEditor:{type:Boolean,default:!1},frozen:{type:Boolean,default:!1},alignFrozen:{type:String,default:"left"},exportable:{type:Boolean,default:!0},exportHeader:{type:String,default:null},exportFooter:{type:String,default:null},filterMatchMode:{type:String,default:null},hidden:{type:Boolean,default:!1}},style:vce,provide:function(){return{$pcColumn:this,$parentInstance:this}}},na={name:"Column",extends:bce,inheritAttrs:!1,inject:["$columns"],mounted:function(){var e;(e=this.$columns)===null||e===void 0||e.add(this.$)},unmounted:function(){var e;(e=this.$columns)===null||e===void 0||e.delete(this.$)},render:function(){return null}};const xce={id:"main",role:"main"},wce={class:"p-4 space-y-8"},Tce={class:"text-end pb-4"},Sce={class:"flex justify-end items-center"},Ece={class:"text-end pb-4"},Cce={class:"inline-flex items-center justify-end"},Ice={class:"ml-2 text-sm text-muted-foreground"},Ace={class:"inline-flex items-center justify-end"},Pce=vu({__name:"Programs",setup(t){const e=sT(),n=bi(null),l=bi(null),d=bi({}),f=bi([]),x=bi([]);function s(){n.value?.exportCSV()}function C(){l.value?.exportCSV()}const P=bi({global:{value:null,matchMode:lo.CONTAINS},title:{value:null,matchMode:lo.CONTAINS},level:{value:null,matchMode:lo.EQUALS},audience:{value:null,matchMode:lo.CONTAINS},nextStartDate:{value:null,matchMode:lo.CONTAINS},registerOpen:{value:null,matchMode:lo.EQUALS}}),L=bi({global:{value:null,matchMode:lo.CONTAINS},title:{value:null,matchMode:lo.CONTAINS},level:{value:null,matchMode:lo.EQUALS},audience:{value:null,matchMode:lo.CONTAINS},completedDate:{value:null,matchMode:lo.CONTAINS},ratings:{value:null,matchMode:lo.CONTAINS}});H0(async()=>{const Te=eL(Aw(hp,"programs"),tL("status","==","active")),Be=await iL(Te);f.value=Be.docs.map(Ne=>({id:Ne.id,...Ne.data()}));const Ge=eL(Aw(hp,"programs"),tL("status","==","completed")),Ye=await iL(Ge);x.value=Ye.docs.map(Ne=>({id:Ne.id,...Ne.data()}))});function $(Te){return!Te||Te.length===0?0:Te.reduce((Be,Ge)=>Be+Ge,0)/Te.length}function V(Te){return Math.round(Te*2)/2}function j(Te){return Te===0?"":Te.toFixed(1)}async function ue(Te,Be){await bJ(kv(hp,"programs",Te.id),{ratings:AJ(Be)}),Te.ratings||(Te.ratings=[]),Te.ratings.push(Be)}function de(Te){e.push({name:"program-register",params:{id:Te.id}})}return(Te,Be)=>(Me(),ft("main",xce,[Ze("section",wce,[Ze("div",null,[Be[2]||(Be[2]=Ze("h1",{id:"activeHeading",class:"h3 mb-3"},"Active Programs",-1)),Xi(Ze("input",{id:"activeSearch",type:"text","onUpdate:modelValue":Be[0]||(Be[0]=Ge=>P.value.global.value=Ge),placeholder:"Search all coulmns...",class:"mb-3 p-2 border rounder w-full","aria-labelledby":"activeHeading","aria-label":"Search active programs"},null,512),[[Ps,P.value.global.value]]),pr(Ai($w),{value:f.value,filters:P.value,filterDisplay:"row",globalFilterFields:["title","summary","level","audience","nextStartDate"],paginator:"",rows:10,sortMode:"single",stripedRows:"",ref_key:"dtActive",ref:n,"aria-labelledby":"activeHeading"},{header:zr(()=>[Ze("div",Tce,[pr(Ai(Pg),{icon:"pi pi-external-link",label:"Export",onClick:s})])]),default:zr(()=>[pr(Ai(na),{field:"title",header:"Title",sortable:"",filter:"",filterPlaceholder:"Search title"}),pr(Ai(na),{field:"summary",header:"Summary",filter:"",filterPlaceholder:"Search summary"}),pr(Ai(na),{field:"durationWeeks",header:"Weeks",sortable:"",filter:"",filterPlaceholder:"Weeks"}),pr(Ai(na),{field:"level",header:"Level",sortable:"",filter:"",filterPlaceholder:"Level"}),pr(Ai(na),{field:"audience",header:"Audience",filter:"",filterPlaceholder:"Audience"}),pr(Ai(na),{field:"nextStartDate",header:"Next Start Date",sortable:"",filter:"",filterPlaceholder:"YYYY-MM-DD"}),pr(Ai(na),{header:"Open?",exportable:!1},{body:zr(({data:Ge})=>[Ze("div",Sce,[Ge.registerOpen?(Me(),rn(Ai(Pg),{key:0,label:"Register",size:"small",onClick:Ye=>de(Ge),"aria-label":"Register for program"},null,8,["onClick"])):(Me(),rn(Ai(sN),{key:1,value:"Closed",severity:"danger","aria-label":"Registration closed"}))])]),_:1})]),_:1},8,["value","filters"])]),Ze("div",null,[Be[4]||(Be[4]=Ze("h2",{id:"completedHeading",class:"h3 mb-3 mt-8"},"Completed Programs",-1)),Xi(Ze("input",{id:"completedSearch",type:"text","onUpdate:modelValue":Be[1]||(Be[1]=Ge=>L.value.global.value=Ge),placeholder:"Search completed programs",class:"mb-3 p-2 border rounder w-full","aria-labelledby":"completedHeading","aria-label":"Search completed programs"},null,512),[[Ps,L.value.global.value]]),pr(Ai($w),{value:x.value,filters:L.value,filterDisplay:"row",globalFilterFields:["title","summary","level","audience","completedDate"],paginator:"",rows:10,sortMode:"single",stripedRows:"",ref_key:"dtCompleted",ref:l,"aria-labelledby":"completedHeading"},{header:zr(()=>[Ze("div",Ece,[pr(Ai(Pg),{icon:"pi pi-external-link",label:"Export",onClick:C})])]),default:zr(()=>[pr(Ai(na),{field:"title",header:"Title",sortable:"",filter:"",filterPlaceholder:"Search title"}),pr(Ai(na),{field:"summary",header:"Summary",filter:"",filterPlaceholder:"Search summary"}),pr(Ai(na),{field:"durationWeeks",header:"Weeks",sortable:"",filter:"",filterPlaceholder:"Weeks"}),pr(Ai(na),{field:"level",header:"Level",sortable:"",filter:"",filterPlaceholder:"Level"}),pr(Ai(na),{field:"audience",header:"Audience",filter:"",filterPlaceholder:"Audience"}),pr(Ai(na),{field:"completedDate",header:"Completed Date",sortable:"",filter:"",filterPlaceholder:"YYYY-MM-DD"}),pr(Ai(na),{header:"Avg Rating",sortable:!1,headerClass:"text-right w-40",bodyClass:"text-right"},{body:zr(({data:Ge})=>[Ze("div",Cce,[pr(Ai(F2),{modelValue:V($(Ge.ratings)),readonly:!0,cancel:!1,stars:5,"aria-label":"Average rating"},null,8,["modelValue"]),Ze("span",Ice,Fr(j($(Ge.ratings))),1)])]),_:1}),pr(Ai(na),{header:"Your Rating",sortable:!1,exportable:!1,headerClass:"text-right w-40",bodyClass:"text-right"},{body:zr(({data:Ge})=>[Ze("div",Ace,[pr(Ai(F2),{modelValue:d.value[Ge.id],"onUpdate:modelValue":[Ye=>d.value[Ge.id]=Ye,Ye=>ue(Ge,Ye)],cancel:!1,stars:5,"aria-label":"Rate this program"},null,8,["modelValue","onUpdate:modelValue"]),Be[3]||(Be[3]=Ze("span",{class:"ml-2 text-xs text-muted-foreground"},"Rate",-1))])]),_:1})]),_:1},8,["value","filters"])])])]))}}),Rce=lb(Pce,[["__scopeId","data-v-9973f082"]]);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kce{constructor(e,n){this._delegate=e,this.firebase=n,Kv(e,new pu("app-compat",()=>this,"PUBLIC")),this.container=e.container}get automaticDataCollectionEnabled(){return this._delegate.automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this._delegate.automaticDataCollectionEnabled=e}get name(){return this._delegate.name}get options(){return this._delegate.options}delete(){return new Promise(e=>{this._delegate.checkDestroyed(),e()}).then(()=>(this.firebase.INTERNAL.removeApp(this.name),nA(this._delegate)))}_getService(e,n=Wh){this._delegate.checkDestroyed();const l=this._delegate.container.getProvider(e);return!l.isInitialized()&&l.getComponent()?.instantiationMode==="EXPLICIT"&&l.initialize(),l.getImmediate({identifier:n})}_removeServiceInstance(e,n=Wh){this._delegate.container.getProvider(e).clearInstance(n)}_addComponent(e){Kv(this._delegate,e)}_addOrOverwriteComponent(e){sz(this._delegate,e)}toJSON(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Oce={"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance."},E5=new Tp("app-compat","Firebase",Oce);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mce(t){const e={},n={__esModule:!0,initializeApp:f,app:d,registerVersion:la,setLogLevel:uz,onLog:cz,apps:null,SDK_VERSION:Pd,INTERNAL:{registerComponent:s,removeApp:l,useAsService:C,modularAPIs:XW}};n.default=n,Object.defineProperty(n,"apps",{get:x});function l(P){delete e[P]}function d(P){if(P=P||Wh,!AM(e,P))throw E5.create("no-app",{appName:P});return e[P]}d.App=t;function f(P,L={}){const $=dT(P,L);if(AM(e,$.name))return e[$.name];const V=new t($,n);return e[$.name]=V,V}function x(){return Object.keys(e).map(P=>e[P])}function s(P){const L=P.name,$=L.replace("-compat","");if(mu(P)&&P.type==="PUBLIC"){const V=(j=d())=>{if(typeof j[$]!="function")throw E5.create("invalid-app-argument",{appName:L});return j[$]()};P.serviceProps!==void 0&&uw(V,P.serviceProps),n[$]=V,t.prototype[$]=function(...j){return this._getService.bind(this,L).apply(this,P.multipleInstances?j:[])}}return P.type==="PUBLIC"?n[$]:null}function C(P,L){return L==="serverAuth"?null:L}return n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nV(){const t=Mce(kce);t.INTERNAL={...t.INTERNAL,createFirebaseNamespace:nV,extendNamespace:e,createSubscribe:tz,ErrorFactory:Tp,deepExtend:uw};function e(n){uw(t,n)}return t}const Dce=nV();/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const C5=new uT("@firebase/app-compat"),Lce="@firebase/app-compat",zce="0.5.2";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fce(t){la(Lce,zce,t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */try{const t=X6();if(t.firebase!==void 0){C5.warn(`
      Warning: Firebase is already defined in the global scope. Please make sure
      Firebase library is only loaded once.
    `);const e=t.firebase.SDK_VERSION;e&&e.indexOf("LITE")>=0&&C5.warn(`
        Warning: You are trying to load Firebase while using Firebase Performance standalone script.
        You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.
        `)}}catch{}const Bce=Dce;Fce();var Nce="firebase",Vce="12.2.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Bce.registerVersion(Nce,Vce,"app-compat");const $ce={class:"mx-auto",style:{"max-width":"680px"}},Uce={class:"mb-3"},jce=["aria-invalid"],Gce={id:"name-help",class:"invalid-feedback"},Hce={class:"mb-3"},Wce=["aria-invalid"],qce={id:"email-help",class:"invalid-feedback"},Kce={class:"mb-3"},Zce=["aria-invalid"],Xce={id:"availability-help",class:"invalid-feedback"},Yce={class:"mb-3"},Jce=["aria-invalid"],Qce={id:"hours-help",class:"invalid-feedback"},eue={class:"mb-3 form-check"},tue=["aria-invalid"],nue={id:"consent-help",class:"invalid-feedback"},rue=["disabled","aria-disabled"],iue={key:0,class:"alert alert-success mt-4",role:"status","aria-live":"polite"},oue=vu({__name:"Volunteer",setup(t){const e=Fl({name:"",email:"",availability:"",hours:null,consent:!1}),n=Fl({name:!1,email:!1,availability:!1,hours:!1,consent:!1}),l=/^[^\s@]+@[^\s@]+\.[^\s@]+$/,d=ps(()=>({name:e.name?e.name.trim().length<2?"Name must be at least 2 characters.":"":"Name is required.",email:e.email?l.test(e.email)?"":"Please enter a valid email address.":"Email is required.",availability:e.availability?"":"Please choose your availability.",hours:e.hours==null?"Please enter your weekly hours.":e.hours<1||e.hours>20?"Hours must be between 1 and 20.":"",consent:e.consent?"":"You must agree to be contacted."})),f=ps(()=>!d.value.name&&!d.value.email&&!d.value.availability&&!d.value.hours&&!d.value.consent);function x($,V){return{"is-invalid":$&&!!V,"is-valid":$&&!V}}const s=bi(!1),C=bi(""),P=bi("");async function L(){if(Object.keys(n).forEach(ue=>n[ue]=!0),!f.value)return;const $=e.email.trim().toLowerCase(),V=e.name.trim();await ZA(XA,"sendVolunteerEmail")({email:$,name:V}),s.value=!0,C.value=V,P.value=$,e.name="",e.email="",e.availability="",e.hours=null,e.consent=!1,Object.keys(n).forEach(ue=>n[ue]=!1)}return($,V)=>(Me(),ft("section",$ce,[V[17]||(V[17]=Ze("h1",{class:"h3 mb-1"},"Volunteer with us",-1)),V[18]||(V[18]=Ze("p",{class:"text-muted mb-4"},"Fill out this form and well get in touch.",-1)),Ze("form",{onSubmit:Id(L,["prevent"]),novalidate:""},[Ze("div",Uce,[V[10]||(V[10]=Ze("label",{for:"name",class:"form-label"},"Full name",-1)),Xi(Ze("input",{id:"name","onUpdate:modelValue":V[0]||(V[0]=j=>e.name=j),onBlur:V[1]||(V[1]=j=>n.name=!0),type:"text",class:wr(["form-control",x(n.name,d.value.name)]),placeholder:"Jane Doe",maxlength:"80",autocomplete:"name","aria-invalid":!!(n.name&&d.value.name),"aria-describedby":"name-help"},null,42,jce),[[Ps,e.name,void 0,{trim:!0}]]),Ze("div",Gce,Fr(d.value.name),1)]),Ze("div",Hce,[V[11]||(V[11]=Ze("label",{for:"email",class:"form-label"},"Email address",-1)),Xi(Ze("input",{id:"email","onUpdate:modelValue":V[2]||(V[2]=j=>e.email=j),onBlur:V[3]||(V[3]=j=>n.email=!0),type:"email",class:wr(["form-control",x(n.email,d.value.email)]),placeholder:"jane@example.com",inputmode:"email",maxlength:"100",autocomplete:"email","aria-invalid":!!(n.email&&d.value.email),"aria-describedby":"email-help"},null,42,Wce),[[Ps,e.email,void 0,{trim:!0}]]),Ze("div",qce,Fr(d.value.email),1)]),Ze("div",Kce,[V[13]||(V[13]=Ze("label",{for:"availability",class:"form-label"},"Availability",-1)),Xi(Ze("select",{id:"availability","onUpdate:modelValue":V[4]||(V[4]=j=>e.availability=j),onBlur:V[5]||(V[5]=j=>n.availability=!0),class:wr(["form-select",x(n.availability,d.value.availability)]),"aria-invalid":!!(n.availability&&d.value.availability),"aria-describedby":"availability-help"},[...V[12]||(V[12]=[Ze("option",{value:"",disabled:""},"Select one",-1),Ze("option",null,"Weekdays",-1),Ze("option",null,"Weeknights",-1),Ze("option",null,"Weekends",-1)])],42,Zce),[[Fx,e.availability]]),Ze("div",Xce,Fr(d.value.availability),1)]),Ze("div",Yce,[V[14]||(V[14]=Ze("label",{for:"hours",class:"form-label"},"Hours per week",-1)),Xi(Ze("input",{id:"hours","onUpdate:modelValue":V[6]||(V[6]=j=>e.hours=j),onBlur:V[7]||(V[7]=j=>n.hours=!0),type:"number",min:"1",max:"20",step:"1",class:wr(["form-control",x(n.hours,d.value.hours)]),placeholder:"e.g. 4",inputmode:"numeric","aria-invalid":!!(n.hours&&d.value.hours),"aria-describedby":"hours-help hours-guidance"},null,42,Jce),[[Ps,e.hours,void 0,{number:!0}]]),Ze("div",Qce,Fr(d.value.hours),1),V[15]||(V[15]=Ze("div",{class:"form-text"},"You can volunteer between 1 and 20 hours each week.",-1))]),Ze("div",eue,[Xi(Ze("input",{id:"consent","onUpdate:modelValue":V[8]||(V[8]=j=>e.consent=j),onBlur:V[9]||(V[9]=j=>n.consent=!0),type:"checkbox",class:wr(["form-check-input",{"is-invalid":n.consent&&!!d.value.consent}]),required:"","aria-invalid":!!(n.consent&&d.value.consent),"aria-describedby":"consent-help"},null,42,tue),[[tG,e.consent]]),V[16]||(V[16]=Ze("label",{class:"form-check-label",for:"consent"}," I agree to be contacted about volunteering opportunities. ",-1)),Ze("div",nue,Fr(d.value.consent),1)]),Ze("button",{class:"btn btn-primary",type:"submit",disabled:!f.value,"aria-disabled":!f.value},"Submit",8,rue)],32),s.value?(Me(),ft("div",iue," Thanks "+Fr(C.value)+"! Well contact you at "+Fr(P.value)+". ",1)):Pn("",!0)]))}}),sue={class:"mx-auto",style:{"max-width":"420px"}},aue={class:"mb-3"},lue=["aria-invalid"],cue={class:"invalid-feedback"},uue={class:"mb-3"},due=["aria-invalid"],hue={class:"invalid-feedback"},fue=["disabled","aria-disabled"],pue={key:0,class:"alert alert-success mt-4",role:"status","aria-live":"polite"},mue={key:1,class:"alert alert-danger mt-4",role:"alert","aria-live":"assertive"},gue=vu({__name:"Login",setup(t){const{setRole:e}=ab(),n=sT(),l=Fl({email:"",password:""}),d=Fl({email:!1,password:!1}),f=/^[^\s@]+@[^\s@]+\.[^\s@]+$/,x=ps(()=>({email:l.email?f.test(l.email)?"":"Please enter a valid email address.":"Email is required.",password:l.password?l.password.length<6?"Password must be at least 6 characters.":"":"Password is required."})),s=ps(()=>!x.value.email&&!x.value.password);function C(j,ue){return{"is-invalid":j&&!!ue,"is-valid":j&&!ue}}const P=bi(!1),L=bi(""),$=bi("");async function V(){if(Object.keys(d).forEach(j=>d[j]=!0),!!s.value){$.value="";try{const j=l.email.trim().toLowerCase(),ue=l.password.trim(),de=await Yq(o_,j,ue);console.log("Logged in:",de.user),e(j==="admin@example.com"?"admin":"user"),P.value=!0,L.value=j,n.push("/")}catch(j){console.error("Login failed:",j.message),$.value="Invalid email or password"}}}return(j,ue)=>(Me(),ft("section",sue,[ue[6]||(ue[6]=Ze("h1",{class:"h3 mb-3"},"Login",-1)),Ze("form",{onSubmit:Id(V,["prevent"]),novalidate:""},[Ze("div",aue,[ue[4]||(ue[4]=Ze("label",{for:"email",class:"form-label"},"Email address",-1)),Xi(Ze("input",{id:"email","onUpdate:modelValue":ue[0]||(ue[0]=de=>l.email=de),onBlur:ue[1]||(ue[1]=de=>d.email=!0),type:"email",class:wr(["form-control",C(d.email,x.value.email)]),placeholder:"jane@example.com",maxlength:"100",inputmode:"email",autocomplete:"username","aria-invalid":!!(d.email&&x.value.email),"aria-describedby":"emailError"},null,42,lue),[[Ps,l.email,void 0,{trim:!0}]]),Ze("div",cue,Fr(x.value.email),1)]),Ze("div",uue,[ue[5]||(ue[5]=Ze("label",{for:"password",class:"form-label"},"Password",-1)),Xi(Ze("input",{id:"password","onUpdate:modelValue":ue[2]||(ue[2]=de=>l.password=de),onBlur:ue[3]||(ue[3]=de=>d.password=!0),type:"password",class:wr(["form-control",C(d.password,x.value.password)]),placeholder:"******",minlength:"6",maxlength:"128",autocomplete:"current-password","aria-invalid":!!(d.password&&x.value.password),"aria-describedby":"passwordError"},null,42,due),[[Ps,l.password,void 0,{trim:!0}]]),Ze("div",hue,Fr(x.value.password),1)]),Ze("button",{class:"btn btn-success w-100",type:"submit",disabled:!s.value,"aria-disabled":!s.value}," Login ",8,fue)],32),P.value?(Me(),ft("div",pue," Welcome back, "+Fr(L.value)+"! ",1)):Pn("",!0),$.value?(Me(),ft("div",mue,Fr($.value),1)):Pn("",!0)]))}}),_ue={class:"mx-auto",style:{"max-width":"420px"}},yue={class:"mb-3"},vue=["aria-invalid"],bue={id:"emailError",class:"invalid-feedback",role:"alert"},xue={class:"mb-3"},wue=["aria-invalid"],Tue={id:"passwordError",class:"invalid-feedback",role:"alert"},Sue={class:"mb-3"},Eue=["aria-invalid"],Cue={id:"confirmError",class:"invalid-feedback",role:"alert"},Iue=["disabled","aria-disabled"],Aue={key:0,class:"alert alert-success mt-4",role:"status","aria-live":"polite"},Pue={key:1,class:"alert alert-danger mt-4",role:"alert","aria-live":"assertive"},Rue=vu({__name:"Signup",setup(t){const e=sT(),{setRole:n}=ab(),l=Fl({email:"",password:"",confirm:""}),d=Fl({email:!1,password:!1,confirm:!1}),f=bi(""),x=bi(""),s=/^[^\s@]+@[^\s@]+\.[^\s@]+$/,C=ps(()=>({email:l.email?s.test(l.email)?"":"Please enter a valid email address.":"Email is required.",password:l.password?l.password.length<6?"Password must be at least 6 characters.":"":"Password is required.",confirm:l.confirm?l.confirm!==l.password?"Passwords do not match.":"":"Please confirm your password."})),P=ps(()=>!C.value.email&&!C.value.password&&!C.value.confirm);function L(ue,de){return{"is-invalid":ue&&!!de,"is-valid":ue&&!de}}const $=bi(!1),V=bi("");async function j(){if(Object.keys(d).forEach(ue=>d[ue]=!0),!!P.value)try{const ue=l.email.trim().toLowerCase(),de=l.password.trim(),Te=await Xq(o_,ue,de);console.log("User created:",Te.user),n(ue==="admin@example.com"?"admin":"user"),$.value=!0,V.value=ue,f.value=`Account created successfully for ${ue}`,x.value="",e.push("/")}catch(ue){console.error("Signup failed:",ue.message),x.value=ue.message,$.value=!1,f.value=""}}return(ue,de)=>(Me(),ft("section",_ue,[de[9]||(de[9]=Ze("h1",{class:"h3 mb-3"},"Sign up",-1)),Ze("form",{onSubmit:Id(j,["prevent"]),novalidate:""},[Ze("div",yue,[de[6]||(de[6]=Ze("label",{for:"email",class:"form-label"},"Email address",-1)),Xi(Ze("input",{id:"email","onUpdate:modelValue":de[0]||(de[0]=Te=>l.email=Te),onBlur:de[1]||(de[1]=Te=>d.email=!0),type:"email",class:wr(["form-control",L(d.email,C.value.email)]),placeholder:"sam@email.com",maxlength:"100",inputmode:"email",autocomplete:"username","aria-invalid":!!(d.email&&C.value.email),"aria-describedby":"emailError"},null,42,vue),[[Ps,l.email,void 0,{trim:!0}]]),Ze("div",bue,Fr(C.value.email),1)]),Ze("div",xue,[de[7]||(de[7]=Ze("label",{for:"password",class:"form-label"},"Password",-1)),Xi(Ze("input",{id:"password","onUpdate:modelValue":de[2]||(de[2]=Te=>l.password=Te),onBlur:de[3]||(de[3]=Te=>d.password=!0),type:"password",class:wr(["form-control",L(d.password,C.value.password)]),placeholder:"******",minlength:"6",maxlength:"128",autocomplete:"new-password","aria-invalid":!!(d.password&&C.value.password),"aria-describedby":"passwordError"},null,42,wue),[[Ps,l.password,void 0,{trim:!0}]]),Ze("div",Tue,Fr(C.value.password),1)]),Ze("div",Sue,[de[8]||(de[8]=Ze("label",{for:"confirm",class:"form-label"},"Confirm password",-1)),Xi(Ze("input",{id:"confirm","onUpdate:modelValue":de[4]||(de[4]=Te=>l.confirm=Te),onBlur:de[5]||(de[5]=Te=>d.confirm=!0),type:"password",class:wr(["form-control",L(d.confirm,C.value.confirm)]),placeholder:"******",minlength:"6",maxlength:"128",autocomplete:"new-password","aria-invalid":!!(d.confirm&&C.value.confirm),"aria-describedby":"confirmError"},null,42,Eue),[[Ps,l.confirm,void 0,{trim:!0}]]),Ze("div",Cue,Fr(C.value.confirm),1)]),Ze("button",{class:"btn btn-success w-100",type:"submit",disabled:!P.value,"aria-disabled":!P.value}," Create account ",8,Iue)],32),f.value?(Me(),ft("div",Aue,Fr(f.value),1)):Pn("",!0),x.value?(Me(),ft("div",Pue,Fr(x.value),1)):Pn("",!0)]))}}),kue="modulepreload",Oue=function(t){return"/"+t},I5={},Mue=function(e,n,l){let d=Promise.resolve();if(n&&n.length>0){let P=function(L){return Promise.all(L.map($=>Promise.resolve($).then(V=>({status:"fulfilled",value:V}),V=>({status:"rejected",reason:V}))))};var x=P;document.getElementsByTagName("link");const s=document.querySelector("meta[property=csp-nonce]"),C=s?.nonce||s?.getAttribute("nonce");d=P(n.map(L=>{if(L=Oue(L),L in I5)return;I5[L]=!0;const $=L.endsWith(".css"),V=$?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${L}"]${V}`))return;const j=document.createElement("link");if(j.rel=$?"stylesheet":kue,$||(j.as="script"),j.crossOrigin="",j.href=L,C&&j.setAttribute("nonce",C),document.head.appendChild(j),$)return new Promise((ue,de)=>{j.addEventListener("load",ue),j.addEventListener("error",()=>de(new Error(`Unable to preload CSS for ${L}`)))})}))}function f(s){const C=new Event("vite:preloadError",{cancelable:!0});if(C.payload=s,window.dispatchEvent(C),!C.defaultPrevented)throw s}return d.then(s=>{for(const C of s||[])C.status==="rejected"&&f(C.reason);return e().catch(f)})};var Due={root:{position:"relative"}},Lue={root:"p-chart"},zue=xi.extend({name:"chart",classes:Lue,inlineStyles:Due}),Fue={name:"BaseChart",extends:Yi,props:{type:String,data:null,options:null,plugins:null,width:{type:Number,default:300},height:{type:Number,default:150},canvasProps:{type:null,default:null}},style:zue,provide:function(){return{$pcChart:this,$parentInstance:this}}},dP={name:"Chart",extends:Fue,inheritAttrs:!1,emits:["select","loaded"],chart:null,watch:{data:{handler:function(){this.reinit()},deep:!0},type:function(){this.reinit()},options:function(){this.reinit()}},mounted:function(){this.initChart()},beforeUnmount:function(){this.chart&&(this.chart.destroy(),this.chart=null)},methods:{initChart:function(){var e=this;Mue(()=>import("./auto-C_bQRYrM.js"),[]).then(function(n){e.chart&&(e.chart.destroy(),e.chart=null),n&&n.default&&(e.chart=new n.default(e.$refs.canvas,{type:e.type,data:e.data,options:e.options,plugins:e.plugins})),e.$emit("loaded",e.chart)})},getCanvas:function(){return this.$canvas},getChart:function(){return this.chart},getBase64Image:function(){return this.chart.toBase64Image()},refresh:function(){this.chart&&this.chart.update()},reinit:function(){this.initChart()},onCanvasClick:function(e){if(this.chart){var n=this.chart.getElementsAtEventForMode(e,"nearest",{intersect:!0},!1),l=this.chart.getElementsAtEventForMode(e,"dataset",{intersect:!0},!1);n&&n[0]&&l&&this.$emit("select",{originalEvent:e,element:n[0],dataset:l})}},generateLegend:function(){if(this.chart)return this.chart.generateLegend()}}};function F0(t){"@babel/helpers - typeof";return F0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},F0(t)}function A5(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);e&&(l=l.filter(function(d){return Object.getOwnPropertyDescriptor(t,d).enumerable})),n.push.apply(n,l)}return n}function P5(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?A5(Object(n),!0).forEach(function(l){Bue(t,l,n[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):A5(Object(n)).forEach(function(l){Object.defineProperty(t,l,Object.getOwnPropertyDescriptor(n,l))})}return t}function Bue(t,e,n){return(e=Nue(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Nue(t){var e=Vue(t,"string");return F0(e)=="symbol"?e:e+""}function Vue(t,e){if(F0(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var l=n.call(t,e);if(F0(l)!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var $ue=["width","height"];function Uue(t,e,n,l,d,f){return Me(),ft("div",ot({class:t.cx("root"),style:t.sx("root")},t.ptmi("root")),[Ze("canvas",ot({ref:"canvas",width:t.width,height:t.height,onClick:e[0]||(e[0]=function(x){return f.onCanvasClick(x)})},P5(P5({},t.canvasProps),t.ptm("canvas"))),null,16,$ue)],16)}dP.render=Uue;const jue={class:"container py-4",style:{"max-width":"720px"},"aria-labelledby":"admin-dashboard-heading"},Gue={class:"card shadow-sm mb-4","aria-labelledby":"add-program-heading"},Hue={class:"card-body"},Wue={class:"mb-3"},que={class:"mb-3"},Kue={class:"mb-3"},Zue={class:"mb-3"},Xue={class:"mb-3"},Yue={class:"mb-3"},Jue={class:"mb-3"},Que={class:"mb-3"},ede={key:0,class:"text-success mt-3 mb-0",role:"status","aria-live":"polite"},tde={class:"my-5","aria-labelledby":"metrics-heading"},nde={class:"row text-center mb-4"},rde={class:"col-md-4 mb-3"},ide={class:"card shadow-sm p-3"},ode={class:"col-md-4 mb-3"},sde={class:"card shadow-sm p-3"},ade={class:"card shadow-sm p-3"},lde=vu({__name:"Admin",setup(t){const e=bi({title:"",summary:"",durationWeeks:1,level:"Beginner",audience:"",nextStartDate:"",registerOpen:!0,status:"active"}),n=bi(!1),l=bi(null),d=bi(null),f=bi(null),x=bi(null),s=bi(),C=bi({plugins:{legend:{position:"bottom"}},scales:{y:{beginAtZero:!0}}});async function P(){try{console.log("Program to add:",e.value),await xJ(Aw(hp,"programs"),{title:e.value.title,summary:e.value.summary,durationWeeks:e.value.durationWeeks,level:e.value.level,audience:e.value.audience,nextStartDate:e.value.nextStartDate,registerOpen:e.value.registerOpen,status:e.value.status}),n.value=!0,e.value={title:"",summary:"",durationWeeks:1,level:"Beginner",audience:"Community",nextStartDate:"",registerOpen:!0,status:"active"}}catch($){console.error("Error adding program:",$),alert("Failed to add program. Please try again.")}}async function L(){const{data:$}=await ZA(XA,"getSiteOverview")(),V=$;l.value=V.totalUsers,d.value=V.usersSignedUpToday,f.value=V.activePrograms,x.value=V.completedPrograms,s.value={labels:["Active","Completed"],datasets:[{label:"Programs",data:[f.value,x.value]}]}}return H0(L),($,V)=>(Me(),ft("main",jue,[V[29]||(V[29]=Ze("h1",{id:"admin-dashboard-heading",class:"h3 mb-3"}," Admin Dashboard ",-1)),V[30]||(V[30]=Ze("section",{class:"alert alert-info",role:"status","aria-live":"polite"}," You are signed in as admin. Only admins can view this page. ",-1)),Ze("section",Gue,[V[24]||(V[24]=Ze("div",{class:"card-header",id:"add-program-heading"},[Ze("h2",{class:"h5 mb-0"},"Add New Program")],-1)),Ze("div",Hue,[Ze("form",{onSubmit:Id(P,["prevent"]),"aria-describedby":"add-program-desc"},[Ze("div",Wue,[V[12]||(V[12]=Ze("label",{for:"title",class:"form-label"},"Title",-1)),Xi(Ze("input",{id:"title","onUpdate:modelValue":V[0]||(V[0]=j=>e.value.title=j),onInput:V[1]||(V[1]=j=>n.value=!1),class:"form-control",placeholder:"Program title",required:"","aria-required":"true"},null,544),[[Ps,e.value.title]])]),Ze("div",que,[V[13]||(V[13]=Ze("label",{for:"summary",class:"form-label"},"Summary",-1)),Xi(Ze("textarea",{id:"summary","onUpdate:modelValue":V[2]||(V[2]=j=>e.value.summary=j),class:"form-control",placeholder:"Brief description of the program",required:"","aria-required":"true"},null,512),[[Ps,e.value.summary]])]),Ze("div",Kue,[V[14]||(V[14]=Ze("label",{for:"durationWeeks",class:"form-label"}," Duration (weeks) ",-1)),Xi(Ze("input",{id:"durationWeeks","onUpdate:modelValue":V[3]||(V[3]=j=>e.value.durationWeeks=j),onInput:V[4]||(V[4]=j=>n.value=!1),type:"number",class:"form-control",min:"1",required:"","aria-required":"true"},null,544),[[Ps,e.value.durationWeeks,void 0,{number:!0}]])]),Ze("div",Zue,[V[16]||(V[16]=Ze("label",{for:"level",class:"form-label"},"Level",-1)),Xi(Ze("select",{id:"level","onUpdate:modelValue":V[5]||(V[5]=j=>e.value.level=j),class:"form-select",required:"","aria-required":"true"},[...V[15]||(V[15]=[Ze("option",null,"Beginner",-1),Ze("option",null,"Intermediate",-1),Ze("option",null,"Advanced",-1)])],512),[[Fx,e.value.level]])]),Ze("div",Xue,[V[17]||(V[17]=Ze("label",{for:"audience",class:"form-label"},"Audience",-1)),Xi(Ze("input",{id:"audience","onUpdate:modelValue":V[6]||(V[6]=j=>e.value.audience=j),class:"form-control",onInput:V[7]||(V[7]=j=>n.value=!1),placeholder:"e.g., Community or Professionals",required:"","aria-required":"true"},null,544),[[Ps,e.value.audience]])]),Ze("div",Yue,[V[18]||(V[18]=Ze("label",{for:"nextStartDate",class:"form-label"}," Next Start Date ",-1)),Xi(Ze("input",{id:"nextStartDate","onUpdate:modelValue":V[8]||(V[8]=j=>e.value.nextStartDate=j),onInput:V[9]||(V[9]=j=>n.value=!1),type:"date",class:"form-control",required:"","aria-required":"true"},null,544),[[Ps,e.value.nextStartDate]])]),Ze("div",Jue,[V[20]||(V[20]=Ze("label",{for:"registerOpen",class:"form-label"},"Register Open?",-1)),Xi(Ze("select",{id:"registerOpen","onUpdate:modelValue":V[10]||(V[10]=j=>e.value.registerOpen=j),class:"form-select",required:"","aria-required":"true"},[...V[19]||(V[19]=[Ze("option",{value:!0},"Yes",-1),Ze("option",{value:!1},"No",-1)])],512),[[Fx,e.value.registerOpen]])]),Ze("div",Que,[V[22]||(V[22]=Ze("label",{for:"status",class:"form-label"},"Status",-1)),Xi(Ze("select",{id:"status","onUpdate:modelValue":V[11]||(V[11]=j=>e.value.status=j),class:"form-select",required:"","aria-required":"true"},[...V[21]||(V[21]=[Ze("option",null,"active",-1),Ze("option",null,"completed",-1)])],512),[[Fx,e.value.status]])]),V[23]||(V[23]=Ze("button",{class:"btn btn-primary w-100",type:"submit","aria-label":"Add program"}," Add Program ",-1)),n.value?(Me(),ft("p",ede," Program added successfully! ")):Pn("",!0)],32)])]),Ze("section",tde,[V[28]||(V[28]=Ze("h2",{id:"metrics-heading",class:"h5 mb-3"},"Website Overview",-1)),Ze("div",nde,[Ze("div",rde,[Ze("div",ide,[V[25]||(V[25]=Ze("h6",{class:"text-muted mb-1"},"Total Users",-1)),Ze("h3",null,Fr(l.value??""),1)])]),Ze("div",ode,[Ze("div",sde,[V[26]||(V[26]=Ze("h6",{class:"text-muted mb-1"},"Users Signed Up Today",-1)),Ze("h3",null,Fr(d.value??""),1)])])]),Ze("div",ade,[V[27]||(V[27]=Ze("h6",{class:"text-muted mb-3"},"Programs: Active vs Completed",-1)),pr(Ai(dP),{type:"bar",data:s.value,options:C.value,style:{height:"300px"}},null,8,["data","options"])])])]))}}),cde={};function ude(t,e){return Me(),ft("div",null,[...e[0]||(e[0]=[Ze("main",{id:"main",role:"main","aria-labelledby":"pageTitle"},[Ze("h1",{id:"pageTitle"},"Page not found"),Ze("p",null,"The page youre looking for doesnt exist or has been moved.")],-1)])])}const dde=lb(cde,[["render",ude]]);function hde(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Yx={exports:{}},fde=Yx.exports,R5;function pde(){return R5||(R5=1,(function(t,e){(function(n,l){t.exports=l()})(fde,(function(){var n,l,d;function f(s,C){if(!n)n=C;else if(!l)l=C;else{var P="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+n+")(sharedChunk); ("+l+")(sharedChunk); self.onerror = null;",L={};n(L),d=C(L),typeof window<"u"&&window&&window.URL&&window.URL.createObjectURL&&(d.workerUrl=window.URL.createObjectURL(new Blob([P],{type:"text/javascript"})))}}f(["exports"],(function(s){var C=1e-6,P=typeof Float32Array<"u"?Float32Array:Array;function L(a,r){var o=r[0],u=r[1],h=r[2],g=r[3],_=o*g-h*u;return _?(a[0]=g*(_=1/_),a[1]=-u*_,a[2]=-h*_,a[3]=o*_,a):null}function $(){var a=new P(9);return P!=Float32Array&&(a[1]=0,a[2]=0,a[3]=0,a[5]=0,a[6]=0,a[7]=0),a[0]=1,a[4]=1,a[8]=1,a}function V(a,r){var o=r[0],u=r[1],h=r[2],g=r[3],_=r[4],b=r[5],T=r[6],E=r[7],A=r[8];return a[0]=_*A-b*E,a[1]=h*E-u*A,a[2]=u*b-h*_,a[3]=b*T-g*A,a[4]=o*A-h*T,a[5]=h*g-o*b,a[6]=g*E-_*T,a[7]=u*T-o*E,a[8]=o*_-u*g,a}function j(a,r,o){var u=r[0],h=r[1],g=r[2],_=r[3],b=r[4],T=r[5],E=r[6],A=r[7],R=r[8],M=o[0],F=o[1],B=o[2],W=o[3],q=o[4],K=o[5],ne=o[6],re=o[7],oe=o[8];return a[0]=M*u+F*_+B*E,a[1]=M*h+F*b+B*A,a[2]=M*g+F*T+B*R,a[3]=W*u+q*_+K*E,a[4]=W*h+q*b+K*A,a[5]=W*g+q*T+K*R,a[6]=ne*u+re*_+oe*E,a[7]=ne*h+re*b+oe*A,a[8]=ne*g+re*T+oe*R,a}function ue(){var a=new P(16);return P!=Float32Array&&(a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[11]=0,a[12]=0,a[13]=0,a[14]=0),a[0]=1,a[5]=1,a[10]=1,a[15]=1,a}function de(a){return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=1,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a}function Te(a,r){var o=r[0],u=r[1],h=r[2],g=r[3],_=r[4],b=r[5],T=r[6],E=r[7],A=r[8],R=r[9],M=r[10],F=r[11],B=r[12],W=r[13],q=r[14],K=r[15],ne=o*b-u*_,re=o*T-h*_,oe=o*E-g*_,ye=u*T-h*b,ve=u*E-g*b,Ce=h*E-g*T,Oe=A*W-R*B,De=A*q-M*B,ut=A*K-F*B,Ue=R*q-M*W,ht=R*K-F*W,wt=M*K-F*q,mt=ne*wt-re*ht+oe*Ue+ye*ut-ve*De+Ce*Oe;return mt?(a[0]=(b*wt-T*ht+E*Ue)*(mt=1/mt),a[1]=(h*ht-u*wt-g*Ue)*mt,a[2]=(W*Ce-q*ve+K*ye)*mt,a[3]=(M*ve-R*Ce-F*ye)*mt,a[4]=(T*ut-_*wt-E*De)*mt,a[5]=(o*wt-h*ut+g*De)*mt,a[6]=(q*oe-B*Ce-K*re)*mt,a[7]=(A*Ce-M*oe+F*re)*mt,a[8]=(_*ht-b*ut+E*Oe)*mt,a[9]=(u*ut-o*ht-g*Oe)*mt,a[10]=(B*ve-W*oe+K*ne)*mt,a[11]=(R*oe-A*ve-F*ne)*mt,a[12]=(b*De-_*Ue-T*Oe)*mt,a[13]=(o*Ue-u*De+h*Oe)*mt,a[14]=(W*re-B*ye-q*ne)*mt,a[15]=(A*ye-R*re+M*ne)*mt,a):null}function Be(a,r,o){var u=r[0],h=r[1],g=r[2],_=r[3],b=r[4],T=r[5],E=r[6],A=r[7],R=r[8],M=r[9],F=r[10],B=r[11],W=r[12],q=r[13],K=r[14],ne=r[15],re=o[0],oe=o[1],ye=o[2],ve=o[3];return a[0]=re*u+oe*b+ye*R+ve*W,a[1]=re*h+oe*T+ye*M+ve*q,a[2]=re*g+oe*E+ye*F+ve*K,a[3]=re*_+oe*A+ye*B+ve*ne,a[4]=(re=o[4])*u+(oe=o[5])*b+(ye=o[6])*R+(ve=o[7])*W,a[5]=re*h+oe*T+ye*M+ve*q,a[6]=re*g+oe*E+ye*F+ve*K,a[7]=re*_+oe*A+ye*B+ve*ne,a[8]=(re=o[8])*u+(oe=o[9])*b+(ye=o[10])*R+(ve=o[11])*W,a[9]=re*h+oe*T+ye*M+ve*q,a[10]=re*g+oe*E+ye*F+ve*K,a[11]=re*_+oe*A+ye*B+ve*ne,a[12]=(re=o[12])*u+(oe=o[13])*b+(ye=o[14])*R+(ve=o[15])*W,a[13]=re*h+oe*T+ye*M+ve*q,a[14]=re*g+oe*E+ye*F+ve*K,a[15]=re*_+oe*A+ye*B+ve*ne,a}function Ge(a,r,o){var u,h,g,_,b,T,E,A,R,M,F,B,W=o[0],q=o[1],K=o[2];return r===a?(a[12]=r[0]*W+r[4]*q+r[8]*K+r[12],a[13]=r[1]*W+r[5]*q+r[9]*K+r[13],a[14]=r[2]*W+r[6]*q+r[10]*K+r[14],a[15]=r[3]*W+r[7]*q+r[11]*K+r[15]):(h=r[1],g=r[2],_=r[3],b=r[4],T=r[5],E=r[6],A=r[7],R=r[8],M=r[9],F=r[10],B=r[11],a[0]=u=r[0],a[1]=h,a[2]=g,a[3]=_,a[4]=b,a[5]=T,a[6]=E,a[7]=A,a[8]=R,a[9]=M,a[10]=F,a[11]=B,a[12]=u*W+b*q+R*K+r[12],a[13]=h*W+T*q+M*K+r[13],a[14]=g*W+E*q+F*K+r[14],a[15]=_*W+A*q+B*K+r[15]),a}function Ye(a,r,o){var u=o[0],h=o[1],g=o[2];return a[0]=r[0]*u,a[1]=r[1]*u,a[2]=r[2]*u,a[3]=r[3]*u,a[4]=r[4]*h,a[5]=r[5]*h,a[6]=r[6]*h,a[7]=r[7]*h,a[8]=r[8]*g,a[9]=r[9]*g,a[10]=r[10]*g,a[11]=r[11]*g,a[12]=r[12],a[13]=r[13],a[14]=r[14],a[15]=r[15],a}function Ne(a,r,o){var u=Math.sin(o),h=Math.cos(o),g=r[4],_=r[5],b=r[6],T=r[7],E=r[8],A=r[9],R=r[10],M=r[11];return r!==a&&(a[0]=r[0],a[1]=r[1],a[2]=r[2],a[3]=r[3],a[12]=r[12],a[13]=r[13],a[14]=r[14],a[15]=r[15]),a[4]=g*h+E*u,a[5]=_*h+A*u,a[6]=b*h+R*u,a[7]=T*h+M*u,a[8]=E*h-g*u,a[9]=A*h-_*u,a[10]=R*h-b*u,a[11]=M*h-T*u,a}function Mt(a,r,o){var u=Math.sin(o),h=Math.cos(o),g=r[0],_=r[1],b=r[2],T=r[3],E=r[8],A=r[9],R=r[10],M=r[11];return r!==a&&(a[4]=r[4],a[5]=r[5],a[6]=r[6],a[7]=r[7],a[12]=r[12],a[13]=r[13],a[14]=r[14],a[15]=r[15]),a[0]=g*h-E*u,a[1]=_*h-A*u,a[2]=b*h-R*u,a[3]=T*h-M*u,a[8]=g*u+E*h,a[9]=_*u+A*h,a[10]=b*u+R*h,a[11]=T*u+M*h,a}function kt(a,r,o){var u=Math.sin(o),h=Math.cos(o),g=r[0],_=r[1],b=r[2],T=r[3],E=r[4],A=r[5],R=r[6],M=r[7];return r!==a&&(a[8]=r[8],a[9]=r[9],a[10]=r[10],a[11]=r[11],a[12]=r[12],a[13]=r[13],a[14]=r[14],a[15]=r[15]),a[0]=g*h+E*u,a[1]=_*h+A*u,a[2]=b*h+R*u,a[3]=T*h+M*u,a[4]=E*h-g*u,a[5]=A*h-_*u,a[6]=R*h-b*u,a[7]=M*h-T*u,a}function Pe(a,r){return a[0]=r[0],a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=r[1],a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=r[2],a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a}function we(a,r,o){var u,h,g,_=o[0],b=o[1],T=o[2],E=Math.sqrt(_*_+b*b+T*T);return E<C?null:(_*=E=1/E,b*=E,T*=E,u=Math.sin(r),h=Math.cos(r),a[0]=_*_*(g=1-h)+h,a[1]=b*_*g+T*u,a[2]=T*_*g-b*u,a[3]=0,a[4]=_*b*g-T*u,a[5]=b*b*g+h,a[6]=T*b*g+_*u,a[7]=0,a[8]=_*T*g+b*u,a[9]=b*T*g-_*u,a[10]=T*T*g+h,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a)}function Se(a,r){var o=r[0],u=r[1],h=r[2],g=r[3],_=o+o,b=u+u,T=h+h,E=o*_,A=u*_,R=u*b,M=h*_,F=h*b,B=h*T,W=g*_,q=g*b,K=g*T;return a[0]=1-R-B,a[1]=A+K,a[2]=M-q,a[3]=0,a[4]=A-K,a[5]=1-E-B,a[6]=F+W,a[7]=0,a[8]=M+q,a[9]=F-W,a[10]=1-E-R,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a}var je=Be;function Re(){var a=new P(3);return P!=Float32Array&&(a[0]=0,a[1]=0,a[2]=0),a}function Ve(a){var r=new P(3);return r[0]=a[0],r[1]=a[1],r[2]=a[2],r}function ke(a){var r=a[0],o=a[1],u=a[2];return Math.sqrt(r*r+o*o+u*u)}function Mn(a,r,o){var u=new P(3);return u[0]=a,u[1]=r,u[2]=o,u}function bn(a,r,o,u){return a[0]=r,a[1]=o,a[2]=u,a}function mn(a,r,o){return a[0]=r[0]+o[0],a[1]=r[1]+o[1],a[2]=r[2]+o[2],a}function Sn(a,r,o){return a[0]=r[0]-o[0],a[1]=r[1]-o[1],a[2]=r[2]-o[2],a}function ar(a,r,o){return a[0]=r[0]*o[0],a[1]=r[1]*o[1],a[2]=r[2]*o[2],a}function Br(a,r,o){return a[0]=Math.min(r[0],o[0]),a[1]=Math.min(r[1],o[1]),a[2]=Math.min(r[2],o[2]),a}function ei(a,r,o){return a[0]=Math.max(r[0],o[0]),a[1]=Math.max(r[1],o[1]),a[2]=Math.max(r[2],o[2]),a}function or(a,r,o){return a[0]=r[0]*o,a[1]=r[1]*o,a[2]=r[2]*o,a}function vr(a,r,o,u){return a[0]=r[0]+o[0]*u,a[1]=r[1]+o[1]*u,a[2]=r[2]+o[2]*u,a}function oi(a,r){var o=r[0]-a[0],u=r[1]-a[1],h=r[2]-a[2];return o*o+u*u+h*h}function uo(a){var r=a[0],o=a[1],u=a[2];return r*r+o*o+u*u}function Gi(a,r){return a[0]=-r[0],a[1]=-r[1],a[2]=-r[2],a}function ur(a,r){var o=r[0],u=r[1],h=r[2],g=o*o+u*u+h*h;return g>0&&(g=1/Math.sqrt(g)),a[0]=r[0]*g,a[1]=r[1]*g,a[2]=r[2]*g,a}function Ot(a,r){return a[0]*r[0]+a[1]*r[1]+a[2]*r[2]}function ln(a,r,o){var u=r[0],h=r[1],g=r[2],_=o[0],b=o[1],T=o[2];return a[0]=h*T-g*b,a[1]=g*_-u*T,a[2]=u*b-h*_,a}function yn(a,r,o,u){var h=r[0],g=r[1],_=r[2];return a[0]=h+u*(o[0]-h),a[1]=g+u*(o[1]-g),a[2]=_+u*(o[2]-_),a}function vn(a,r,o){var u=r[0],h=r[1],g=r[2],_=o[3]*u+o[7]*h+o[11]*g+o[15];return a[0]=(o[0]*u+o[4]*h+o[8]*g+o[12])/(_=_||1),a[1]=(o[1]*u+o[5]*h+o[9]*g+o[13])/_,a[2]=(o[2]*u+o[6]*h+o[10]*g+o[14])/_,a}function Nr(a,r,o){var u=r[0],h=r[1],g=r[2];return a[0]=u*o[0]+h*o[3]+g*o[6],a[1]=u*o[1]+h*o[4]+g*o[7],a[2]=u*o[2]+h*o[5]+g*o[8],a}function He(a,r,o){var u=o[0],h=o[1],g=o[2],_=o[3],b=r[0],T=r[1],E=r[2],A=h*E-g*T,R=g*b-u*E,M=u*T-h*b;return a[0]=b+_*(A+=A)+h*(M+=M)-g*(R+=R),a[1]=T+_*R+g*A-u*M,a[2]=E+_*M+u*R-h*A,a}function Qe(a){return a[0]=0,a[1]=0,a[2]=0,a}function dt(a,r){return a[0]===r[0]&&a[1]===r[1]&&a[2]===r[2]}var Lt=Sn,qt=ar,jt=ke;function Rn(){var a=new P(4);return P!=Float32Array&&(a[0]=0,a[1]=0,a[2]=0,a[3]=0),a}function fn(a,r,o){return a[0]=r[0]*o,a[1]=r[1]*o,a[2]=r[2]*o,a[3]=r[3]*o,a}function cn(a,r){var o=r[0],u=r[1],h=r[2],g=r[3],_=o*o+u*u+h*h+g*g;return _>0&&(_=1/Math.sqrt(_)),a[0]=o*_,a[1]=u*_,a[2]=h*_,a[3]=g*_,a}function Zt(a,r,o){var u=r[0],h=r[1],g=r[2],_=r[3];return a[0]=o[0]*u+o[4]*h+o[8]*g+o[12]*_,a[1]=o[1]*u+o[5]*h+o[9]*g+o[13]*_,a[2]=o[2]*u+o[6]*h+o[10]*g+o[14]*_,a[3]=o[3]*u+o[7]*h+o[11]*g+o[15]*_,a}function Xn(){var a=new P(4);return P!=Float32Array&&(a[0]=0,a[1]=0,a[2]=0),a[3]=1,a}function En(a){return a[0]=0,a[1]=0,a[2]=0,a[3]=1,a}function jn(a,r,o){o*=.5;var u=r[0],h=r[1],g=r[2],_=r[3],b=Math.sin(o),T=Math.cos(o);return a[0]=u*T+_*b,a[1]=h*T+g*b,a[2]=g*T-h*b,a[3]=_*T-u*b,a}function dr(a,r,o){o*=.5;var u=r[0],h=r[1],g=r[2],_=r[3],b=Math.sin(o),T=Math.cos(o);return a[0]=u*T-g*b,a[1]=h*T+_*b,a[2]=g*T+u*b,a[3]=_*T-h*b,a}Re(),Rn();var Gn,hr,Yr,ho=cn,So=(Gn=Re(),hr=Mn(1,0,0),Yr=Mn(0,1,0),function(a,r,o){var u=Ot(r,o);return u<-.999999?(ln(Gn,hr,r),jt(Gn)<1e-6&&ln(Gn,Yr,r),ur(Gn,Gn),(function(h,g,_){_*=.5;var b=Math.sin(_);h[0]=b*g[0],h[1]=b*g[1],h[2]=b*g[2],h[3]=Math.cos(_)})(a,Gn,Math.PI),a):u>.999999?(a[0]=0,a[1]=0,a[2]=0,a[3]=1,a):(ln(Gn,r,o),a[0]=Gn[0],a[1]=Gn[1],a[2]=Gn[2],a[3]=1+u,ho(a,a))});function Vi(){var a=new P(2);return P!=Float32Array&&(a[0]=0,a[1]=0),a}function oo(a,r){var o=new P(2);return o[0]=a,o[1]=r,o}function Hs(a,r,o){return a[0]=r,a[1]=o,a}function Ws(a,r,o){return a[0]=r[0]+o[0],a[1]=r[1]+o[1],a}function so(a,r,o){return a[0]=r[0]-o[0],a[1]=r[1]-o[1],a}function Fo(a,r,o){return a[0]=r[0]*o,a[1]=r[1]*o,a}function Ma(a){var r=a[0],o=a[1];return Math.sqrt(r*r+o*o)}function ai(a,r){var o=r[0],u=r[1],h=o*o+u*u;return h>0&&(h=1/Math.sqrt(h)),a[0]=r[0]*h,a[1]=r[1]*h,a}function ko(a,r){return a[0]*r[0]+a[1]*r[1]}Xn(),Xn(),$();var bc,ua,Os=so;function Ul(a){return a&&a.__esModule&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a}Vi();var da=(function(){if(ua)return bc;function a(r,o,u,h){this.cx=3*r,this.bx=3*(u-r)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*o,this.by=3*(h-o)-this.cy,this.ay=1-this.cy-this.by,this.p1x=r,this.p1y=o,this.p2x=u,this.p2y=h}return ua=1,bc=a,a.prototype={sampleCurveX:function(r){return((this.ax*r+this.bx)*r+this.cx)*r},sampleCurveY:function(r){return((this.ay*r+this.by)*r+this.cy)*r},sampleCurveDerivativeX:function(r){return(3*this.ax*r+2*this.bx)*r+this.cx},solveCurveX:function(r,o){if(o===void 0&&(o=1e-6),r<0)return 0;if(r>1)return 1;for(var u=r,h=0;h<8;h++){var g=this.sampleCurveX(u)-r;if(Math.abs(g)<o)return u;var _=this.sampleCurveDerivativeX(u);if(Math.abs(_)<1e-6)break;u-=g/_}var b=0,T=1;for(u=r,h=0;h<20&&(g=this.sampleCurveX(u),!(Math.abs(g-r)<o));h++)r>g?b=u:T=u,u=.5*(T-b)+b;return u},solve:function(r,o){return this.sampleCurveY(this.solveCurveX(r,o))}},bc})(),xu=Ul(da);function xt(a,r){this.x=a,this.y=r}function Da(a,r){if(Array.isArray(a)){if(!Array.isArray(r)||a.length!==r.length)return!1;for(let o=0;o<a.length;o++)if(!Da(a[o],r[o]))return!1;return!0}if(typeof a=="object"&&a!==null&&r!==null){if(typeof r!="object"||Object.keys(a).length!==Object.keys(r).length)return!1;for(const o in a)if(!Da(a[o],r[o]))return!1;return!0}return a===r}xt.prototype={clone(){return new xt(this.x,this.y)},add(a){return this.clone()._add(a)},sub(a){return this.clone()._sub(a)},multByPoint(a){return this.clone()._multByPoint(a)},divByPoint(a){return this.clone()._divByPoint(a)},mult(a){return this.clone()._mult(a)},div(a){return this.clone()._div(a)},rotate(a){return this.clone()._rotate(a)},rotateAround(a,r){return this.clone()._rotateAround(a,r)},matMult(a){return this.clone()._matMult(a)},unit(){return this.clone()._unit()},perp(){return this.clone()._perp()},round(){return this.clone()._round()},mag(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals(a){return this.x===a.x&&this.y===a.y},dist(a){return Math.sqrt(this.distSqr(a))},distSqr(a){const r=a.x-this.x,o=a.y-this.y;return r*r+o*o},angle(){return Math.atan2(this.y,this.x)},angleTo(a){return Math.atan2(this.y-a.y,this.x-a.x)},angleWith(a){return this.angleWithSep(a.x,a.y)},angleWithSep(a,r){return Math.atan2(this.x*r-this.y*a,this.x*a+this.y*r)},_matMult(a){const r=a[2]*this.x+a[3]*this.y;return this.x=a[0]*this.x+a[1]*this.y,this.y=r,this},_add(a){return this.x+=a.x,this.y+=a.y,this},_sub(a){return this.x-=a.x,this.y-=a.y,this},_mult(a){return this.x*=a,this.y*=a,this},_div(a){return this.x/=a,this.y/=a,this},_multByPoint(a){return this.x*=a.x,this.y*=a.y,this},_divByPoint(a){return this.x/=a.x,this.y/=a.y,this},_unit(){return this._div(this.mag()),this},_perp(){const a=this.y;return this.y=this.x,this.x=-a,this},_rotate(a){const r=Math.cos(a),o=Math.sin(a),u=o*this.x+r*this.y;return this.x=r*this.x-o*this.y,this.y=u,this},_rotateAround(a,r){const o=Math.cos(a),u=Math.sin(a),h=r.y+u*(this.x-r.x)+o*(this.y-r.y);return this.x=r.x+o*(this.x-r.x)-u*(this.y-r.y),this.y=h,this},_round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},constructor:xt},xt.convert=function(a){if(a instanceof xt)return a;if(Array.isArray(a))return new xt(+a[0],+a[1]);if(a.x!==void 0&&a.y!==void 0)return new xt(+a.x,+a.y);throw new Error("Expected [x, y] or {x, y} point format")};const jl=Math.PI/180,Gl=180/Math.PI;function Fe(a){return a*jl}function Y(a){return a*Gl}const Q=[[0,0],[1,0],[1,1],[0,1]];function ce(a){if(a<=0)return 0;if(a>=1)return 1;const r=a*a,o=r*a;return 4*(a<.5?o:3*(a-r)+o-.75)}function Ie(a,r,o,u){const h=new xu(a,r,o,u);return function(g){return h.solve(g)}}const xe=Ie(.25,.1,.25,1);function be(a,r,o){return Math.min(o,Math.max(r,a))}function tt(a,r,o){return(o=be((o-a)/(r-a),0,1))*o*(3-2*o)}function ze(a,r,o){const u=o-r,h=((a-r)%u+u)%u+r;return h===r?o:h}function nt(a,r,o){if(!a.length)return o(null,[]);let u=a.length;const h=new Array(a.length);let g=null;a.forEach(((_,b)=>{r(_,((T,E)=>{T&&(g=T),h[b]=E,--u==0&&o(g,h)}))}))}let Rt=1;function gt(){return Rt++}function on(a){return a<=1?1:Math.pow(2,Math.ceil(Math.log2(a)))}function xn(a,r){a.forEach((o=>{r[o]&&(r[o]=r[o].bind(r))}))}function zn(a,r,o){const u={};for(const h in a)u[h]=r.call(this,a[h],h,a);return u}function lr(a,r,o){const u={};for(const h in a)r.call(this,a[h],h,a)&&(u[h]=a[h]);return u}function Yn(a){return Array.isArray(a)?a.map(Yn):typeof a=="object"&&a?zn(a,Yn):a}function fr(a,r){for(let o=0;o<a.length;o++)if(r.indexOf(a[o])>=0)return!0;return!1}const ti={};function cr(a){ti[a]||(typeof console<"u"&&console.warn(a),ti[a]=!0)}function Hi(a,r,o){return(o.y-a.y)*(r.x-a.x)>(r.y-a.y)*(o.x-a.x)}function to(a){let r=0;for(let o,u,h=0,g=a.length,_=g-1;h<g;_=h++)o=a[h],u=a[_],r+=(u.x-o.x)*(o.y+u.y);return r}function fo([a,r,o]){const u=Fe(r+90),h=Fe(o);return{x:a*Math.cos(u)*Math.sin(h),y:a*Math.sin(u)*Math.sin(h),z:a*Math.cos(h),azimuthal:r,polar:o}}function Zr(a){return(typeof self<"u"||a!==void 0)&&typeof WorkerGlobalScope<"u"&&(a!==void 0?a:self)instanceof WorkerGlobalScope}function Sr(a){const r={};if(a.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,((o,u,h,g)=>{const _=h||g;return r[u]=!_||_.toLowerCase(),""})),r["max-age"]){const o=parseInt(r["max-age"],10);isNaN(o)?delete r["max-age"]:r["max-age"]=o}return r}let di=null;function Ri(a,r){return[a[4*r],a[4*r+1],a[4*r+2],a[4*r+3]]}function hi(a,r,o,u){for(;r<o;){const h=r+o>>1;a[h]<u?r=h+1:o=h}return r}function Bo(a,r,o,u){for(;r<o;){const h=r+o>>1;a[h]<=u?r=h+1:o=h}return r}function Xo(a){return a>0?1/(1.001-a):1+a}function _s(a){return a>0?1-1/(1.001-a):-a}function ha(a,r,o){return(a-r.min)*(o.max-o.min)/(r.max-r.min)+o.min}const Ho={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){if(!Ho.API_URL)return null;try{const a=new URL(Ho.API_URL);return a.hostname==="api.mapbox.cn"?"https://events.mapbox.cn/events/v2":a.hostname==="api.mapbox.com"?"https://events.mapbox.com/events/v2":null}catch{return null}},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",RASTERARRAYS_URL_PREFIX:"rasterarrays/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,DEFAULT_STYLE:"mapbox://styles/mapbox/standard",MAX_PARALLEL_IMAGE_REQUESTS:16,DRACO_URL:"https://api.mapbox.com/mapbox-gl-js/draco_decoder_gltf_v1.5.6.wasm",MESHOPT_URL:"https://api.mapbox.com/mapbox-gl-js/meshopt_base_v0.20.wasm",MESHOPT_SIMD_URL:"https://api.mapbox.com/mapbox-gl-js/meshopt_simd_v0.20.wasm",BUILDING_GEN_URL:"https://api.mapbox.com/mapbox-gl-js/building-gen/building_gen_v1.2.3.wasm",GLYPHS_URL:"mapbox://fonts/mapbox/{fontstack}/{range}.pbf",TILES3D_URL_PREFIX:"3dtiles/v1"};function Hl(a){return Ho.API_URL_REGEX.test(a)}function pf(a){return Ho.API_SPRITE_REGEX.test(a)}let gl,xc,wc,Tc,_l,fa;function pa(){return gl==null&&(gl=self.OffscreenCanvas&&new OffscreenCanvas(1,1).getContext("2d")&&typeof self.createImageBitmap=="function"),gl}const Ms={now:()=>Tc!==void 0?Tc:performance.now(),setNow(a){Tc=a},restoreNow(){Tc=void 0},frame(a){const r=requestAnimationFrame(a);return{cancel:()=>cancelAnimationFrame(r)}},getImageData(a,r=0){const{width:o,height:u}=a;_l||(_l=document.createElement("canvas"));const h=_l.getContext("2d",{willReadFrequently:!0});if(!h)throw new Error("failed to create canvas 2d context");return(o>_l.width||u>_l.height)&&(_l.width=o,_l.height=u),h.clearRect(-r,-r,o+2*r,u+2*r),h.drawImage(a,0,0,o,u),h.getImageData(-r,-r,o+2*r,u+2*r)},resolveURL:a=>(xc||(xc=document.createElement("a")),xc.href=a,xc.href),get devicePixelRatio(){return window.devicePixelRatio},get prefersReducedMotion(){return!!window.matchMedia&&(wc==null&&(wc=window.matchMedia("(prefers-reduced-motion: reduce)")),wc.matches)},hasCanvasFingerprintNoise(){if(fa!==void 0)return fa;if(!pa())return fa=!1,!1;const a=new OffscreenCanvas(85,1),r=a.getContext("2d",{willReadFrequently:!0});let o=0;for(let h=0;h<a.width;++h)r.fillStyle=`rgba(${o++},${o++},${o++}, 255)`,r.fillRect(h,0,1,1);const u=r.getImageData(0,0,a.width,a.height);o=0;for(let h=0;h<u.data.length;++h)if(h%4!=3&&o++!==u.data[h])return fa=!0,!0;return fa=!1,!1}};function Sc(a,r){const o=a.indexOf("?");if(o<0)return`${a}?${new URLSearchParams(r).toString()}`;const u=new URLSearchParams(a.slice(o));for(const h in r)u.set(h,r[h]);return`${a.slice(0,o)}?${u.toString()}`}function wu(a,r={persistentParams:[]}){const o=a.indexOf("?");if(o<0)return a;const u=new URLSearchParams,h=new URLSearchParams(a.slice(o));for(const _ of r.persistentParams){const b=h.get(_);b&&u.set(_,b)}const g=u.toString();return`${a.slice(0,o)}${g.length>0?`?${g}`:""}`}const li="mapbox-tiles";let ys=500,Ds=50;const cs=["language","worldview","jobid"];let ts,yl;function mf(){try{return caches}catch{}}function Tu(){const a=mf();a&&ts==null&&(ts=a.open(li))}let vl=1/0;const Su={supported:!1,testSupport:function(a){!vs&&Ls&&(kd?ma(a):qa=a)}};let qa,Ls,vs=!1,kd=!1;const Eu=typeof self<"u"?self:{};function ma(a){const r=a.createTexture();a.bindTexture(a.TEXTURE_2D,r);try{if(a.texImage2D(a.TEXTURE_2D,0,a.RGBA,a.RGBA,a.UNSIGNED_BYTE,Ls),a.isContextLost())return;Su.supported=!0}catch{}a.deleteTexture(r),vs=!0}Eu.document&&(Ls=Eu.document.createElement("img"),Ls.onload=function(){qa&&ma(qa),qa=null,kd=!0},Ls.onerror=function(){vs=!0,qa=null},Ls.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const Od={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Iconset:"Iconset",Image:"Image",Model:"Model"};typeof Object.freeze=="function"&&Object.freeze(Od);class gf extends Error{constructor(r,o,u){o===401&&Hl(u)&&(r+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),super(r),this.status=o,this.url=u}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const Md=Zr()?()=>self.worker.referrer:()=>(location.protocol==="blob:"?parent:self).location.href,sr=function(a,r){if(!(/^file:/.test(o=a.url)||/^file:/.test(Md())&&!/^\w+:/.test(o))){if(self.fetch&&self.Request&&self.AbortController&&Request.prototype.hasOwnProperty("signal"))return(function(u,h){const g=new AbortController,_=new Request(u.url,{method:u.method||"GET",body:u.body,credentials:u.credentials,headers:u.headers,referrer:Md(),referrerPolicy:u.referrerPolicy,signal:g.signal});let b=!1,T=!1;const E=(A=_.url).indexOf("sku=")>0&&Hl(A);var A;u.type==="json"&&_.headers.set("Accept","application/json");const R=(F,B,W)=>{if(T)return;if(F&&F.message!=="SecurityError"&&cr(F.toString()),B&&W)return M(B);const q=Date.now();fetch(_).then((K=>{if(K.ok){const ne=E?K.clone():null;return M(K,ne,q)}return h(new gf(K.statusText,K.status,u.url))})).catch((K=>{K.name!=="AbortError"&&h(new Error(`${K.message} ${u.url}`))}))},M=(F,B,W)=>{(u.type==="arrayBuffer"?F.arrayBuffer():u.type==="json"?F.json():F.text()).then((q=>{T||(B&&W&&(function(K,ne,re){if(Tu(),ts==null)return;const oe=Sr(ne.headers.get("Cache-Control")||"");if(oe["no-store"])return;const ye={status:ne.status,statusText:ne.statusText,headers:new Headers};ne.headers.forEach(((Oe,De)=>ye.headers.set(De,Oe))),oe["max-age"]&&ye.headers.set("Expires",new Date(re+1e3*oe["max-age"]).toUTCString());const ve=ye.headers.get("Expires");if(!ve||new Date(ve).getTime()-re<42e4)return;let Ce=wu(K.url,{persistentParams:cs});if(ne.status===206){const Oe=K.headers.get("Range");if(!Oe)return;ye.status=200,Ce=Sc(Ce,{range:Oe})}(function(Oe,De){if(yl===void 0)try{new Response(new ReadableStream),yl=!0}catch{yl=!1}yl?De(Oe.body):Oe.blob().then(De).catch((ut=>cr(ut.message)))})(ne,(Oe=>{const De=new Response((ut=ne.status)!==200&&ut!==404&&[101,103,204,205,304].includes(ut)?null:Oe,ye);var ut;Tu(),ts?.then((Ue=>Ue.put(Ce,De))).catch((Ue=>cr(Ue.message)))}))})(_,B,W),b=!0,h(null,q,F.headers.get("Cache-Control"),F.headers.get("Expires")))})).catch((q=>{T||h(new Error(q.message))}))};return E?(function(F,B){if(Tu(),ts==null)return B(null);ts.then((W=>{let q=wu(F.url,{persistentParams:cs});const K=F.headers.get("Range");K&&(q=Sc(q,{range:K})),W.match(q).then((ne=>{const re=(function(oe){if(!oe)return!1;const ye=new Date(oe.headers.get("Expires")||0),ve=Sr(oe.headers.get("Cache-Control")||"");return Number(ye)>Date.now()&&!ve["no-cache"]})(ne);W.delete(q).catch(B),re&&W.put(q,ne.clone()).catch(B),B(null,ne,re)})).catch(B)})).catch(B)})(_,R):R(null,null),{cancel:()=>{T=!0,b||g.abort()}}})(a,r);if(Zr(self)&&self.worker.actor)return self.worker.actor.send("getResource",a,r,void 0,!0)}var o;return(function(u,h){const g=new XMLHttpRequest;g.open(u.method||"GET",u.url,!0),u.type==="arrayBuffer"&&(g.responseType="arraybuffer");for(const _ in u.headers)g.setRequestHeader(_,u.headers[_]);return u.type==="json"&&(g.responseType="text",g.setRequestHeader("Accept","application/json")),g.withCredentials=u.credentials==="include",g.onerror=()=>{h(new Error(g.statusText))},g.onload=()=>{if((g.status>=200&&g.status<300||g.status===0)&&g.response!==null){let _=g.response;if(u.type==="json")try{_=JSON.parse(g.response)}catch(b){return h(b)}h(null,_,g.getResponseHeader("Cache-Control"),g.getResponseHeader("Expires"))}else h(new gf(g.statusText,g.status,u.url))},g.send(u.body),{cancel:()=>g.abort()}})(a,r)},Ec=function(a,r){return sr(Object.assign(a,{type:"arrayBuffer"}),r)};function Dp(a){const r=document.createElement("a");return r.href=a,r.protocol===location.protocol&&r.host===location.host}const Cu="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let Wl,Ka;Wl=[],Ka=0;const La=function(a,r){if(Su.supported&&(a.headers||(a.headers={}),a.headers.accept="image/webp,*/*"),Ka>=Ho.MAX_PARALLEL_IMAGE_REQUESTS){const g={requestParameters:a,callback:r,cancelled:!1,cancel(){this.cancelled=!0}};return Wl.push(g),g}Ka++;let o=!1;const u=()=>{if(!o)for(o=!0,Ka--;Wl.length&&Ka<Ho.MAX_PARALLEL_IMAGE_REQUESTS;){const g=Wl.shift(),{requestParameters:_,callback:b,cancelled:T}=g;T||(g.cancel=La(_,b).cancel)}},h=Ec(a,((g,_,b,T)=>{u(),g?r(g):_&&(self.createImageBitmap?(function(E,A){const R=new Blob([new Uint8Array(E)],{type:"image/png"});createImageBitmap(R).then((M=>{A(null,M)})).catch((M=>{A(new Error(`Could not load image because of ${M.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))}))})(_,((E,A)=>r(E,A,b,T))):(function(E,A){const R=new Image;R.onload=()=>{A(null,R),URL.revokeObjectURL(R.src),R.onload=null,requestAnimationFrame((()=>{R.src=Cu}))},R.onerror=()=>A(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const M=new Blob([new Uint8Array(E)],{type:"image/png"});R.src=E.byteLength?URL.createObjectURL(M):Cu})(_,((E,A)=>r(E,A,b,T))))}));return{cancel:()=>{h.cancel(),u()}}};var Za,Iu,Dd,Ji={exports:{}},Lp={exports:{}},_f={exports:{}},ql=(function(){if(Dd)return Ji.exports;Dd=1;var a=(Za||(Za=1,Lp.exports=function(o,u){var h,g,_,b,T,E,A,R;for(g=o.length-(h=3&o.length),_=u,T=3432918353,E=461845907,R=0;R<g;)A=255&o.charCodeAt(R)|(255&o.charCodeAt(++R))<<8|(255&o.charCodeAt(++R))<<16|(255&o.charCodeAt(++R))<<24,++R,_=27492+(65535&(b=5*(65535&(_=(_^=A=(65535&(A=(A=(65535&A)*T+(((A>>>16)*T&65535)<<16)&4294967295)<<15|A>>>17))*E+(((A>>>16)*E&65535)<<16)&4294967295)<<13|_>>>19))+((5*(_>>>16)&65535)<<16)&4294967295))+((58964+(b>>>16)&65535)<<16);switch(A=0,h){case 3:A^=(255&o.charCodeAt(R+2))<<16;case 2:A^=(255&o.charCodeAt(R+1))<<8;case 1:_^=A=(65535&(A=(A=(65535&(A^=255&o.charCodeAt(R)))*T+(((A>>>16)*T&65535)<<16)&4294967295)<<15|A>>>17))*E+(((A>>>16)*E&65535)<<16)&4294967295}return _^=o.length,_=2246822507*(65535&(_^=_>>>16))+((2246822507*(_>>>16)&65535)<<16)&4294967295,_=3266489909*(65535&(_^=_>>>13))+((3266489909*(_>>>16)&65535)<<16)&4294967295,(_^=_>>>16)>>>0}),Lp.exports),r=(Iu||(Iu=1,_f.exports=function(o,u){for(var h,g=o.length,_=u^g,b=0;g>=4;)h=1540483477*(65535&(h=255&o.charCodeAt(b)|(255&o.charCodeAt(++b))<<8|(255&o.charCodeAt(++b))<<16|(255&o.charCodeAt(++b))<<24))+((1540483477*(h>>>16)&65535)<<16),_=1540483477*(65535&_)+((1540483477*(_>>>16)&65535)<<16)^(h=1540483477*(65535&(h^=h>>>24))+((1540483477*(h>>>16)&65535)<<16)),g-=4,++b;switch(g){case 3:_^=(255&o.charCodeAt(b+2))<<16;case 2:_^=(255&o.charCodeAt(b+1))<<8;case 1:_=1540483477*(65535&(_^=255&o.charCodeAt(b)))+((1540483477*(_>>>16)&65535)<<16)}return _=1540483477*(65535&(_^=_>>>13))+((1540483477*(_>>>16)&65535)<<16),(_^=_>>>15)>>>0}),_f.exports);return Ji.exports=a,Ji.exports.murmur3=a,Ji.exports.murmur2=r,Ji.exports})(),Au=Ul(ql);class qs{constructor(r,...o){Object.assign(this,o[0]||{}),this.type=r}}class bl extends qs{constructor(r,o={}){super("error",Object.assign({error:r},o))}}function Pu(a,r,o){o[a]&&o[a].indexOf(r)!==-1||(o[a]=o[a]||[],o[a].push(r))}function Oo(a,r,o){if(o&&o[a]){const u=o[a].indexOf(r);u!==-1&&o[a].splice(u,1)}}class xl{on(r,o){return this._listeners=this._listeners||{},Pu(r,o,this._listeners),this}off(r,o){return Oo(r,o,this._listeners),Oo(r,o,this._oneTimeListeners),this}once(r,o){return o?(this._oneTimeListeners=this._oneTimeListeners||{},Pu(r,o,this._oneTimeListeners),this):new Promise((u=>{this.once(r,u)}))}fire(r,o){const u=typeof r=="string"?new qs(r,o):r,h=u.type;if(this.listens(h)){u.target=this;const g=this._listeners&&this._listeners[h]?this._listeners[h].slice():[];for(const T of g)T.call(this,u);const _=this._oneTimeListeners&&this._oneTimeListeners[h]?this._oneTimeListeners[h].slice():[];for(const T of _)Oo(h,T,this._oneTimeListeners),T.call(this,u);const b=this._eventedParent;if(b){const T=typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData;Object.assign(u,T),b.fire(u)}}else u instanceof bl&&console.error(u.error);return this}listens(r){return!!(this._listeners&&this._listeners[r]&&this._listeners[r].length>0||this._oneTimeListeners&&this._oneTimeListeners[r]&&this._oneTimeListeners[r].length>0||this._eventedParent&&this._eventedParent.listens(r))}setEventedParent(r,o){return this._eventedParent=r,this._eventedParentData=o,this}}class zs{constructor(r){typeof r=="string"?this.name=r:(this.name=r.name,this.iconsetId=r.iconsetId)}static from(r){return new zs(r)}static toString(r){return r.iconsetId?`${r.name}${r.iconsetId}`:r.name}static parse(r){const[o,u]=r.split("");return new zs({name:o,iconsetId:u})}static isEqual(r,o){return r.name===o.name&&r.iconsetId===o.iconsetId}toString(){return zs.toString(this)}serialize(){return{name:this.name,iconsetId:this.iconsetId}}}var Kl,Ru={},ku=(function(){if(Kl)return Ru;Kl=1;var a={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function r(g){return(g=Math.round(g))<0?0:g>255?255:g}function o(g){return r(g[g.length-1]==="%"?parseFloat(g)/100*255:parseInt(g))}function u(g){return(_=g[g.length-1]==="%"?parseFloat(g)/100:parseFloat(g))<0?0:_>1?1:_;var _}function h(g,_,b){return b<0?b+=1:b>1&&(b-=1),6*b<1?g+(_-g)*b*6:2*b<1?_:3*b<2?g+(_-g)*(2/3-b)*6:g}try{Ru.parseCSSColor=function(g){var _,b=g.replace(/ /g,"").toLowerCase();if(b in a)return a[b].slice();if(b[0]==="#")return b.length===4?(_=parseInt(b.substr(1),16))>=0&&_<=4095?[(3840&_)>>4|(3840&_)>>8,240&_|(240&_)>>4,15&_|(15&_)<<4,1]:null:b.length===7&&(_=parseInt(b.substr(1),16))>=0&&_<=16777215?[(16711680&_)>>16,(65280&_)>>8,255&_,1]:null;var T=b.indexOf("("),E=b.indexOf(")");if(T!==-1&&E+1===b.length){var A=b.substr(0,T),R=b.substr(T+1,E-(T+1)).split(","),M=1;switch(A){case"rgba":if(R.length!==4)return null;M=u(R.pop());case"rgb":return R.length!==3?null:[o(R[0]),o(R[1]),o(R[2]),M];case"hsla":if(R.length!==4)return null;M=u(R.pop());case"hsl":if(R.length!==3)return null;var F=(parseFloat(R[0])%360+360)%360/360,B=u(R[1]),W=u(R[2]),q=W<=.5?W*(B+1):W+B-W*B,K=2*W-q;return[r(255*h(K,q,F+1/3)),r(255*h(K,q,F)),r(255*h(K,q,F-1/3)),M];default:return null}}return null}}catch{}return Ru})();class Pr{constructor(r,o,u,h=1){this.r=r,this.g=o,this.b=u,this.a=h}static parse(r){if(!r)return;if(r instanceof Pr)return r;if(typeof r!="string")return;const o=ku.parseCSSColor(r);return o?new Pr(o[0]/255,o[1]/255,o[2]/255,o[3]):void 0}toString(){const[r,o,u,h]=[this.r,this.g,this.b,this.a];return`rgba(${Math.round(255*r)},${Math.round(255*o)},${Math.round(255*u)},${h})`}toNonPremultipliedRenderColor(r){const{r:o,g:u,b:h,a:g}=this;return new Ou(r,o,u,h,g)}toPremultipliedRenderColor(r){const{r:o,g:u,b:h,a:g}=this;return new zd(r,o*g,u*g,h*g,g)}clone(){return new Pr(this.r,this.g,this.b,this.a)}}class Ld{constructor(r,o,u,h,g,_=!1){if(this.premultiplied=!1,this.premultiplied=_,r){const b=r.image.height,T=b*b;this.premultiplied?(o=g===0?0:o/g*(b-1),u=g===0?0:u/g*(b-1),h=g===0?0:h/g*(b-1)):(o*=b-1,u*=b-1,h*=b-1);const E=Math.floor(o),A=Math.floor(u),R=Math.floor(h),M=Math.ceil(o),F=Math.ceil(u),B=Math.ceil(h),W=o-E,q=u-A,K=h-R,ne=r.image.data,re=4*(E+A*T+R*b),oe=4*(E+A*T+B*b),ye=4*(E+F*T+R*b),ve=4*(E+F*T+B*b),Ce=4*(M+A*T+R*b),Oe=4*(M+A*T+B*b),De=4*(M+F*T+R*b),ut=4*(M+F*T+B*b);if(re<0||ut>=ne.length)throw new Error("out of range");this.r=wn(wn(wn(ne[re],ne[oe],K),wn(ne[ye],ne[ve],K),q),wn(wn(ne[Ce],ne[Oe],K),wn(ne[De],ne[ut],K),q),W)/255*(this.premultiplied?g:1),this.g=wn(wn(wn(ne[re+1],ne[oe+1],K),wn(ne[ye+1],ne[ve+1],K),q),wn(wn(ne[Ce+1],ne[Oe+1],K),wn(ne[De+1],ne[ut+1],K),q),W)/255*(this.premultiplied?g:1),this.b=wn(wn(wn(ne[re+2],ne[oe+2],K),wn(ne[ye+2],ne[ve+2],K),q),wn(wn(ne[Ce+2],ne[Oe+2],K),wn(ne[De+2],ne[ut+2],K),q),W)/255*(this.premultiplied?g:1),this.a=g}else this.r=o,this.g=u,this.b=h,this.a=g}toArray(){const{r,g:o,b:u,a:h}=this;return[255*r,255*o,255*u,h]}toHslaArray(){let{r,g:o,b:u,a:h}=this;if(this.premultiplied){if(h===0)return[0,0,0,0];const B=1/h;r*=B,o*=B,u*=B}const g=Math.min(Math.max(r,0),1),_=Math.min(Math.max(o,0),1),b=Math.min(Math.max(u,0),1),T=Math.min(g,_,b),E=Math.max(g,_,b),A=E-T,R=.5*(T+E);if(A===0)return[0,0,100*R,h];const M=R>.5?A/(2-E-T):A/(E+T);let F;switch(E){case g:F=60*((_-b)/A+(_<b?6:0));break;case _:F=60*((b-g)/A+2);break;default:F=60*((g-_)/A+4)}return[F,100*M,100*R,h]}toArray01(){const{r,g:o,b:u,a:h}=this;return[r,o,u,h]}toArray01Scaled(r){const{r:o,g:u,b:h}=this;return[o*r,u*r,h*r]}toArray01Linear(){const{r,g:o,b:u,a:h}=this;return[Math.pow(r,2.2),Math.pow(o,2.2),Math.pow(u,2.2),h]}}class Ou extends Ld{constructor(r,o,u,h,g){super(r,o,u,h,g,!1)}}class zd extends Ld{constructor(r,o,u,h,g){super(r,o,u,h,g,!0)}}function wn(a,r,o){return a*(1-o)+r*o}function Zl(a,r,o){return a.map(((u,h)=>wn(u,r[h],o)))}Pr.black=new Pr(0,0,0,1),Pr.white=new Pr(1,1,1,1),Pr.transparent=new Pr(0,0,0,0),Pr.red=new Pr(1,0,0,1),Pr.blue=new Pr(0,0,1,1);var bs=Object.freeze({__proto__:null,array:Zl,color:function(a,r,o){return new Pr(wn(a.r,r.r,o),wn(a.g,r.g,o),wn(a.b,r.b,o),wn(a.a,r.a,o))},number:wn});class Ks extends Error{constructor(r,o){super(o),this.message=o,this.key=r}}class Cc{constructor(r,o=[]){this.parent=r,this.bindings={};for(const[u,h]of o)this.bindings[u]=h}concat(r){return new Cc(this,r)}get(r){if(this.bindings[r])return this.bindings[r];if(this.parent)return this.parent.get(r);throw new Error(`${r} not found in scope.`)}has(r){return!!this.bindings[r]||!!this.parent&&this.parent.has(r)}}const Zs={kind:"null"},sn={kind:"number"},Rr={kind:"string"},Vr={kind:"boolean"},us={kind:"color"},Fs={kind:"object"},kr={kind:"value"},Mu={kind:"collator"},Xa={kind:"formatted"},Ic={kind:"resolvedImage"};function No(a,r){return{kind:"array",itemType:a,N:r}}function fi(a){if(a.kind==="array"){const r=fi(a.itemType);return typeof a.N=="number"?`array<${r}, ${a.N}>`:a.itemType.kind==="value"?"array":`array<${r}>`}return a.kind}const zp=[Zs,sn,Rr,Vr,us,Xa,Fs,No(kr),Ic];function Ac(a,r){if(r.kind==="error")return null;if(a.kind==="array"){if(r.kind==="array"&&(r.N===0&&r.itemType.kind==="value"||!Ac(a.itemType,r.itemType))&&(typeof a.N!="number"||a.N===r.N))return null}else{if(a.kind===r.kind)return null;if(a.kind==="value"){for(const o of zp)if(!Ac(o,r))return null}}return`Expected ${fi(a)} but found ${fi(r)} instead.`}function wl(a,r){return r.some((o=>o.kind===a.kind))}function k(a,r){return r.some((o=>o==="null"?a===null:o==="array"?Array.isArray(a):o==="object"?a&&!Array.isArray(a)&&typeof a=="object":o===typeof a))}function X(a,r){return a.kind==="array"&&r.kind==="array"?a.N===r.N&&X(a.itemType,r.itemType):a.kind===r.kind}class te{constructor(r,o,u){this.sensitivity=r?o?"variant":"case":o?"accent":"base",this.locale=u,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(r,o){return this.collator.compare(r,o)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Ee{constructor(r,o,u,h,g){this.text=r.normalize?r.normalize():r,this.image=o,this.scale=u,this.fontStack=h,this.textColor=g}}class pt{constructor(r){this.sections=r}static fromString(r){return new pt([new Ee(r,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some((r=>r.text.length!==0||!!r.image&&r.image.hasPrimary()))}static factory(r){return r instanceof pt?r:pt.fromString(r)}toString(){return this.sections.length===0?"":this.sections.map((r=>r.text)).join("")}serialize(){const r=["format"];for(const o of this.sections){if(o.image){const h=o.image.getPrimary().id.toString();r.push(["image",h]);continue}r.push(o.text);const u={};o.fontStack&&(u["text-font"]=["literal",o.fontStack.split(",")]),o.scale&&(u["font-scale"]=o.scale),o.textColor&&(u["text-color"]=["rgba"].concat(o.textColor.toNonPremultipliedRenderColor(null).toArray())),r.push(u)}return r}}class Ft{constructor(r,o={}){if(this.id=zs.from(r),this.options=Object.assign({},o),o.transform){const{a:u,b:h,c:g,d:_,e:b,f:T}=o.transform;this.options.transform=new DOMMatrix([u,h,g,_,b,T])}else this.options.transform=new DOMMatrix([1,0,0,1,0,0])}toString(){const{a:r,b:o,c:u,d:h,e:g,f:_}=this.options.transform;return JSON.stringify({name:this.id.name,iconsetId:this.id.iconsetId,params:this.options.params,transform:{a:r,b:o,c:u,d:h,e:g,f:_}})}static parse(r){let o,u,h,g;try{({name:o,iconsetId:u,params:h,transform:g}=JSON.parse(r)||{})}catch{return null}if(!o)return null;const{a:_,b,c:T,d:E,e:A,f:R}=g||{};return new Ft({name:o,iconsetId:u},{params:h,transform:new DOMMatrix([_,b,T,E,A,R])})}scaleSelf(r,o){return this.options.transform.scaleSelf(r,o),this}}class gn{constructor(r,o,u,h,g=!1){this.primaryId=zs.from(r),this.primaryOptions=o,u&&(this.secondaryId=zs.from(u)),this.secondaryOptions=h,this.available=g}toString(){return this.primaryId&&this.secondaryId?`[${this.primaryId.name},${this.secondaryId.name}]`:this.primaryId.name}hasPrimary(){return!!this.primaryId}getPrimary(){return new Ft(this.primaryId,this.primaryOptions)}hasSecondary(){return!!this.secondaryId}getSecondary(){return this.secondaryId?new Ft(this.secondaryId,this.secondaryOptions):null}static from(r){return typeof r=="string"?gn.build({name:r}):r}static build(r,o,u,h){return!r||typeof r=="object"&&!("name"in r)?null:new gn(r,u,o,h)}}function Qi(a,r,o,u){return typeof a=="number"&&a>=0&&a<=255&&typeof r=="number"&&r>=0&&r<=255&&typeof o=="number"&&o>=0&&o<=255?u===void 0||typeof u=="number"&&u>=0&&u<=1?null:`Invalid rgba value [${[a,r,o,u].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof u=="number"?[a,r,o,u]:[a,r,o]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Eo(a){if(a===null||typeof a=="string"||typeof a=="boolean"||typeof a=="number"||a instanceof Pr||a instanceof te||a instanceof pt||a instanceof gn)return!0;if(Array.isArray(a)){for(const r of a)if(!Eo(r))return!1;return!0}if(typeof a=="object"){for(const r in a)if(!Eo(a[r]))return!1;return!0}return!1}function yr(a){if(a===null)return Zs;if(typeof a=="string")return Rr;if(typeof a=="boolean")return Vr;if(typeof a=="number")return sn;if(a instanceof Pr)return us;if(a instanceof te)return Mu;if(a instanceof pt)return Xa;if(a instanceof gn)return Ic;if(Array.isArray(a)){const r=a.length;let o;for(const u of a){const h=yr(u);if(o){if(o===h)continue;o=kr;break}o=h}return No(o||kr,r)}return Fs}function $i(a){const r=typeof a;return a===null?"":r==="string"||r==="number"||r==="boolean"?String(a):a instanceof pt||a instanceof gn||a instanceof Pr?a.toString():JSON.stringify(a)}class In{constructor(r,o){this.type=r,this.value=o}static parse(r,o){if(r.length!==2)return o.error(`'literal' expression requires exactly one argument, but found ${r.length-1} instead.`);if(!Eo(r[1]))return o.error("invalid value");const u=r[1];let h=yr(u);const g=o.expectedType;return h.kind!=="array"||h.N!==0||!g||g.kind!=="array"||typeof g.N=="number"&&g.N!==0||(h=g),new In(h,u)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof Pr?["rgba"].concat(this.value.toNonPremultipliedRenderColor(null).toArray()):this.value instanceof pt?this.value.serialize():this.value}}class Gt{constructor(r){this.name="ExpressionEvaluationError",this.message=r}toJSON(){return this.message}}const ds={string:Rr,number:sn,boolean:Vr,object:Fs};class Tn{constructor(r,o){this.type=r,this.args=o}static parse(r,o){if(r.length<2)return o.error("Expected at least one argument.");let u,h=1;const g=r[0];if(g==="array"){let b,T;if(r.length>2){const E=r[1];if(typeof E!="string"||!(E in ds)||E==="object")return o.error('The item type argument of "array" must be one of string, number, boolean',1);b=ds[E],h++}else b=kr;if(r.length>3){if(r[2]!==null&&(typeof r[2]!="number"||r[2]<0||r[2]!==Math.floor(r[2])))return o.error('The length argument to "array" must be a positive integer literal',2);T=r[2],h++}u=No(b,T)}else u=ds[g];const _=[];for(;h<r.length;h++){const b=o.parse(r[h],h,kr);if(!b)return null;_.push(b)}return new Tn(u,_)}evaluate(r){for(let o=0;o<this.args.length;o++){const u=this.args[o].evaluate(r);if(!Ac(this.type,yr(u)))return u;if(o===this.args.length-1)throw new Gt(`The expression ${JSON.stringify(this.args[o].serialize())} evaluated to ${fi(yr(u))} but was expected to be of type ${fi(this.type)}.`)}return null}eachChild(r){this.args.forEach(r)}outputDefined(){return this.args.every((r=>r.outputDefined()))}serialize(){const r=this.type,o=[r.kind];if(r.kind==="array"){const u=r.itemType;if(u.kind==="string"||u.kind==="number"||u.kind==="boolean"){o.push(u.kind);const h=r.N;(typeof h=="number"||this.args.length>1)&&o.push(h)}}return o.concat(this.args.map((u=>u.serialize())))}}class Ya{constructor(r){this.type=Xa,this.sections=r}static parse(r,o){if(r.length<2)return o.error("Expected at least one argument.");const u=r[1];if(!Array.isArray(u)&&typeof u=="object")return o.error("First argument must be an image or text section.");const h=[];let g=!1;for(let _=1;_<=r.length-1;++_){const b=r[_];if(g&&typeof b=="object"&&!Array.isArray(b)){g=!1;let T=null;if(b["font-scale"]&&(T=o.parseObjectValue(b["font-scale"],_,"font-scale",sn),!T))return null;let E=null;if(b["text-font"]&&(E=o.parseObjectValue(b["text-font"],_,"text-font",No(Rr)),!E))return null;let A=null;if(b["text-color"]&&(A=o.parseObjectValue(b["text-color"],_,"text-color",us),!A))return null;const R=h[h.length-1];R.scale=T,R.font=E,R.textColor=A}else{const T=o.parse(r[_],_,kr);if(!T)return null;const E=T.type.kind;if(E!=="string"&&E!=="value"&&E!=="null"&&E!=="resolvedImage")return o.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");g=!0,h.push({content:T,scale:null,font:null,textColor:null})}}return new Ya(h)}evaluate(r){return new pt(this.sections.map((o=>{const u=o.content.evaluate(r);return X(yr(u),Ic)?new Ee("",u,null,null,null):new Ee($i(u),null,o.scale?o.scale.evaluate(r):null,o.font?o.font.evaluate(r).join(","):null,o.textColor?o.textColor.evaluate(r):null)})))}eachChild(r){for(const o of this.sections)r(o.content),o.scale&&r(o.scale),o.font&&r(o.font),o.textColor&&r(o.textColor)}outputDefined(){return!1}serialize(){const r=["format"];for(const o of this.sections){r.push(o.content.serialize());const u={};o.scale&&(u["font-scale"]=o.scale.serialize()),o.font&&(u["text-font"]=o.font.serialize()),o.textColor&&(u["text-color"]=o.textColor.serialize()),r.push(u)}return r}}class Fd{constructor(r,o,u,h){this._imageWarnHistory={},this.type=Ic,this.namePrimary=r,this.nameSecondary=o,u&&(this.paramsPrimary=u.params,this.iconsetIdPrimary=u.iconset?u.iconset.id:void 0),h&&(this.paramsSecondary=h.params,this.iconsetIdSecondary=h.iconset?h.iconset.id:void 0)}static parse(r,o){if(r.length<2)return o.error("Expected two or more arguments.");let u=1;const h=[];function g(){if(u<r.length){const b=o.parse(r[u],u++,Rr);return b?(h.push({image:b,options:{}}),!0):(o.error(h.length?"Secondary image variant is not a string.":"No image name provided."),!1)}return!0}function _(){if(u<r.length){const T=r[u];if((b=T)===null||typeof b!="object"||Array.isArray(b))return!0;const E=T.params,A=T.iconset,R=o.concat(u);if(!E&&!A)return u++,!0;if(E){if(typeof E!="object"||E.constructor!==Object)return R.error('Image options "params" should be an object'),!1;const M={},F=R.concat(void 0,"params");for(const B in E){if(!B)return F.error("Image parameter name should be non-empty"),!1;const W=F.concat(void 0,B).parse(E[B],void 0,us,void 0,{typeAnnotation:"coerce"});if(!W)return!1;M[B]=W}h[h.length-1].options.params=M}if(A){if(typeof A!="object"||A.constructor!==Object)return R.error('Image options "iconset" should be an object'),!1;if(!A.id)return R.error('Image options "iconset" should have an "id" property'),!1;h[h.length-1].options.iconset=A}return u++,!0}var b;return!0}for(let b=0;b<2;b++)if(!g()||!_())return;return new Fd(h[0].image,h[1]?h[1].image:void 0,h[0].options,h[1]?h[1].options:void 0)}evaluateParams(r,o){const u={};if(o){for(const h in o)if(o[h])try{u[h]=o[h].evaluate(r)}catch{continue}if(Object.keys(u).length!==0)return{params:u}}}evaluate(r){const o={name:this.namePrimary.evaluate(r),iconsetId:this.iconsetIdPrimary},u=this.nameSecondary?{name:this.nameSecondary.evaluate(r),iconsetId:this.iconsetIdSecondary}:void 0,h=gn.build(o,u,this.paramsPrimary?this.evaluateParams(r,this.paramsPrimary):void 0,this.paramsSecondary?this.evaluateParams(r,this.paramsSecondary):void 0);if(h&&r.availableImages){const g=h.getPrimary().id;if(h.available=r.availableImages.some((_=>zs.isEqual(_,g))),h.available){const _=h.getSecondary()?h.getSecondary().id:null;_&&(h.available=r.availableImages.some((b=>zs.isEqual(b,_))))}}return h}eachChild(r){if(r(this.namePrimary),this.paramsPrimary)for(const o in this.paramsPrimary)this.paramsPrimary[o]&&r(this.paramsPrimary[o]);if(this.nameSecondary&&(r(this.nameSecondary),this.paramsSecondary))for(const o in this.paramsSecondary)this.paramsSecondary[o]&&r(this.paramsSecondary[o])}outputDefined(){return!1}serializeOptions(r,o){const u={};if(o&&(u.iconset={id:o}),r){u.params={};for(const h in r)r[h]&&(u.params[h]=r[h].serialize())}return Object.keys(u).length>0?u:void 0}serialize(){const r=["image",this.namePrimary.serialize()];if(this.paramsPrimary||this.iconsetIdPrimary){const o=this.serializeOptions(this.paramsPrimary,this.iconsetIdPrimary);o&&r.push(o)}if(this.nameSecondary&&(r.push(this.nameSecondary.serialize()),this.paramsSecondary||this.iconsetIdSecondary)){const o=this.serializeOptions(this.paramsSecondary,this.iconsetIdSecondary);o&&r.push(o)}return r}}function Dn(a){return yf(a)?"string":vf(a)?"number":h_(a)?"boolean":Array.isArray(a)?"array":a===null?"null":d_(a)?"object":typeof a}function d_(a){return a!=null&&!Array.isArray(a)&&typeof a!="function"&&!(a instanceof String||a instanceof Number||a instanceof Boolean)&&typeof a=="object"}function yf(a){return typeof a=="string"||a instanceof String}function vf(a){return typeof a=="number"||a instanceof Number}function h_(a){return typeof a=="boolean"||a instanceof Boolean}const Fp={"to-boolean":Vr,"to-color":us,"to-number":sn,"to-string":Rr};class _o{constructor(r,o){this.type=r,this.args=o}static parse(r,o){if(r.length<2)return o.error("Expected at least one argument.");const u=r[0],h=[];let g=Zs;if(u==="to-array"){if(!Array.isArray(r[1]))return null;const _=r[1].length;if(o.expectedType){if(o.expectedType.kind!=="array")return o.error(`Expected ${o.expectedType.kind} but found array.`);g=No(o.expectedType.itemType,_)}else{if(!(_>0&&Eo(r[1][0])))return null;g=No(yr(r[1][0]),_)}for(let b=0;b<_;b++){const T=r[1][b];let E;if(Array.isArray(T))E=o.parse(T,void 0,g.itemType);else{const A=Dn(T);if(A!==g.itemType.kind)return o.error(`Expected ${g.itemType.kind} but found ${A}.`);E=o.registry.literal.parse(["literal",T===void 0?null:T],o)}if(!E)return null;h.push(E)}}else{if((u==="to-boolean"||u==="to-string")&&r.length!==2)return o.error("Expected one argument.");g=Fp[u];for(let _=1;_<r.length;_++){const b=o.parse(r[_],_,kr);if(!b)return null;h.push(b)}}return new _o(g,h)}evaluate(r){if(this.type.kind==="boolean")return!!this.args[0].evaluate(r);if(this.type.kind==="color"){let o,u;for(const h of this.args){if(o=h.evaluate(r),u=null,o instanceof Pr)return o;if(typeof o=="string"){const g=r.parseColor(o);if(g)return g}else if(Array.isArray(o)&&(u=o.length<3||o.length>4?`Invalid rbga value ${JSON.stringify(o)}: expected an array containing either three or four numeric values.`:Qi(o[0],o[1],o[2],o[3]),!u))return new Pr(o[0]/255,o[1]/255,o[2]/255,o[3])}throw new Gt(u||`Could not parse color from value '${typeof o=="string"?o:String(JSON.stringify(o))}'`)}if(this.type.kind==="number"){let o=null;for(const u of this.args){if(o=u.evaluate(r),o===null)return 0;const h=Number(o);if(!isNaN(h))return h}throw new Gt(`Could not convert ${JSON.stringify(o)} to number.`)}return this.type.kind==="formatted"?pt.fromString($i(this.args[0].evaluate(r))):this.type.kind==="resolvedImage"?gn.build($i(this.args[0].evaluate(r))):this.type.kind==="array"?this.args.map((o=>o.evaluate(r))):$i(this.args[0].evaluate(r))}eachChild(r){this.args.forEach(r)}outputDefined(){return this.args.every((r=>r.outputDefined()))}serialize(){if(this.type.kind==="formatted")return new Ya([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new Fd(this.args[0]).serialize();const r=this.type.kind==="array"?[]:[`to-${this.type.kind}`];return this.eachChild((o=>{r.push(o.serialize())})),r}}const f_=["Unknown","Point","LineString","Polygon"];class Xl{constructor(r,o,u){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null,this.scope=r,this.options=o,this.iconImageUseTheme=u}id(){return this.feature&&this.feature.id!==void 0?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?f_[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}measureLight(r){return this.globals.brightness||0}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const r=this.featureDistanceData.center,o=this.featureDistanceData.scale,{x:u,y:h}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(u*o-r[0])+this.featureDistanceData.bearing[1]*(h*o-r[1])}return 0}parseColor(r){let o=this._parseColorCache[r];return o||(o=this._parseColorCache[r]=Pr.parse(r)),o}getConfig(r){return this.options?this.options.get(r):null}}class xs{constructor(r,o,u,h,g){this.name=r,this.type=o,this._evaluate=u,this.args=h,this._overloadIndex=g}evaluate(r){if(!this._evaluate){const o=xs.definitions[this.name];this._evaluate=Array.isArray(o)?o[2]:o.overloads[this._overloadIndex][1]}return this._evaluate(r,this.args)}eachChild(r){this.args.forEach(r)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map((r=>r.serialize())))}static parse(r,o){const u=r[0],h=xs.definitions[u];if(!h)return o.error(`Unknown expression "${u}". If you wanted a literal array, use ["literal", [...]].`,0);const g=Array.isArray(h)?h[0]:h.type,_=Array.isArray(h)?[[h[1],h[2]]]:h.overloads,b=[];let T=null,E=-1;for(const[A,R]of _){if(Array.isArray(A)&&A.length!==r.length-1)continue;b.push(A),E++,T=new Jp(o.registry,o.path,null,o.scope,void 0,o._scope,o.options,o.iconImageUseTheme);const M=[];let F=!1;for(let B=1;B<r.length;B++){const W=r[B],q=Array.isArray(A)?A[B-1]:A.type,K=T.parse(W,1+M.length,q);if(!K){F=!0;break}M.push(K)}if(!F)if(Array.isArray(A)&&A.length!==M.length)T.error(`Expected ${A.length} arguments, but found ${M.length} instead.`);else{for(let B=0;B<M.length;B++){const W=Array.isArray(A)?A[B]:A.type,q=M[B];T.concat(B+1).checkSubtype(W,q.type)}if(T.errors.length===0)return new xs(u,g,R,M,E)}}if(b.length===1)o.errors.push(...T.errors);else{const A=(b.length?b:_.map((([M])=>M))).map(Pc).join(" | "),R=[];for(let M=1;M<r.length;M++){const F=o.parse(r[M],1+R.length);if(!F)return null;R.push(fi(F.type))}o.error(`Expected arguments of type ${A}, but found (${R.join(", ")}) instead.`)}return null}static register(r,o){xs.definitions=o;for(const u in o)r[u]=xs}}function Pc(a){return Array.isArray(a)?`(${a.map(fi).join(", ")})`:`(${fi(a.type)}...)`}class Yo{constructor(r,o,u){this.type=Mu,this.locale=u,this.caseSensitive=r,this.diacriticSensitive=o}static parse(r,o){if(r.length!==2)return o.error("Expected one argument.");const u=r[1];if(typeof u!="object"||Array.isArray(u))return o.error("Collator options argument must be an object.");const h=u["case-sensitive"]===void 0?o.parse(!1,1,Vr):o.parseObjectValue(u["case-sensitive"],1,"case-sensitive",Vr);if(!h)return null;const g=u["diacritic-sensitive"]===void 0?o.parse(!1,1,Vr):o.parseObjectValue(u["diacritic-sensitive"],1,"diacritic-sensitive",Vr);if(!g)return null;let _=null;return u.locale&&(_=o.parseObjectValue(u.locale,1,"locale",Rr),!_)?null:new Yo(h,g,_)}evaluate(r){return new te(this.caseSensitive.evaluate(r),this.diacriticSensitive.evaluate(r),this.locale?this.locale.evaluate(r):null)}eachChild(r){r(this.caseSensitive),r(this.diacriticSensitive),this.locale&&r(this.locale)}outputDefined(){return!1}serialize(){const r={};return r["case-sensitive"]=this.caseSensitive.serialize(),r["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(r.locale=this.locale.serialize()),["collator",r]}}function gb(a,r,o=0,u=a.length-1,h=ZT){for(;u>o;){if(u-o>600){const T=u-o+1,E=r-o+1,A=Math.log(T),R=.5*Math.exp(2*A/3),M=.5*Math.sqrt(A*R*(T-R)/T)*(E-T/2<0?-1:1);gb(a,r,Math.max(o,Math.floor(r-E*R/T+M)),Math.min(u,Math.floor(r+(T-E)*R/T+M)),h)}const g=a[r];let _=o,b=u;for(bf(a,o,r),h(a[u],g)>0&&bf(a,o,u);_<b;){for(bf(a,_,b),_++,b--;h(a[_],g)<0;)_++;for(;h(a[b],g)>0;)b--}h(a[o],g)===0?bf(a,o,b):(b++,bf(a,b,u)),b<=r&&(o=b+1),r<=b&&(u=b-1)}}function bf(a,r,o){const u=a[r];a[r]=a[o],a[o]=u}function ZT(a,r){return a<r?-1:a>r?1:0}function Bp(a){let r=0;for(let o,u,h=0,g=a.length,_=g-1;h<g;_=h++)o=a[h],u=a[_],r+=(u.x-o.x)*(o.y+u.y);return r}function Bd(a,r){a[0]=Math.min(a[0],r[0]),a[1]=Math.min(a[1],r[1]),a[2]=Math.max(a[2],r[0]),a[3]=Math.max(a[3],r[1])}function Ja(a,r){return!(a[0]<=r[0]||a[2]>=r[2]||a[1]<=r[1]||a[3]>=r[3])}function XT(a,r,o){const u=a[0]-r[0],h=a[1]-r[1],g=a[0]-o[0],_=a[1]-o[1];return u*_-g*h==0&&u*g<=0&&h*_<=0}function Nd(a,r,o=!1){let u=!1;for(let b=0,T=r.length;b<T;b++){const E=r[b];for(let A=0,R=E.length,M=R-1;A<R;M=A++){const F=E[M],B=E[A];if(XT(a,F,B))return o;(g=F)[1]>(h=a)[1]!=(_=B)[1]>h[1]&&h[0]<(_[0]-g[0])*(h[1]-g[1])/(_[1]-g[1])+g[0]&&(u=!u)}}var h,g,_;return u}function _b(a,r,o,u){const h=u[0]-o[0],g=u[1]-o[1],_=(a[0]-o[0])*g-h*(a[1]-o[1]),b=(r[0]-o[0])*g-h*(r[1]-o[1]);return _>0&&b<0||_<0&&b>0}function Np(a,r,o,u){return(h=[u[0]-o[0],u[1]-o[1]])[0]*(g=[r[0]-a[0],r[1]-a[1]])[1]-h[1]*g[0]!=0&&!(!_b(a,r,o,u)||!_b(o,u,a,r));var h,g}function Vp(a){const r=new xt(Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY),o=new xt(Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY);for(const u of a[0])r.x>u.x&&(r.x=u.x),r.y>u.y&&(r.y=u.y),o.x<u.x&&(o.x=u.x),o.y<u.y&&(o.y=u.y);return{min:r,max:o}}const Rc=8192;function Du(a,r){const o=(180+a[0])/360,u=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+a[1]*Math.PI/360)))/360,h=Math.pow(2,r.z);return[Math.round(o*h*Rc),Math.round(u*h*Rc)]}function YT(a,r){for(let o=0;o<r.length;o++)if(Nd(a,r[o]))return!0;return!1}function JT(a,r,o){for(const u of o)for(let h=0,g=u.length,_=g-1;h<g;_=h++)if(Np(a,r,u[_],u[h]))return!0;return!1}function $p(a,r){for(let o=0;o<a.length;++o)if(!Nd(a[o],r))return!1;for(let o=0;o<a.length-1;++o)if(JT(a[o],a[o+1],r))return!1;return!0}function yb(a,r){for(let o=0;o<r.length;o++)if($p(a,r[o]))return!0;return!1}function Up(a,r,o){const u=[];for(let h=0;h<a.length;h++){const g=[];for(let _=0;_<a[h].length;_++){const b=Du(a[h][_],o);Bd(r,b),g.push(b)}u.push(g)}return u}function za(a,r,o){const u=[];for(let h=0;h<a.length;h++){const g=Up(a[h],r,o);u.push(g)}return u}function vb(a,r,o,u){if(a[0]<o[0]||a[0]>o[2]){const h=.5*u;let g=a[0]-o[0]>h?-u:o[0]-a[0]>h?u:0;g===0&&(g=a[0]-o[2]>h?-u:o[2]-a[0]>h?u:0),a[0]+=g}Bd(r,a)}function bb(a,r,o,u){const h=Math.pow(2,u.z)*Rc,g=[u.x*Rc,u.y*Rc],_=[];if(!a)return _;for(const b of a)for(const T of b){const E=[T.x+g[0],T.y+g[1]];vb(E,r,o,h),_.push(E)}return _}function xb(a,r,o,u){const h=Math.pow(2,u.z)*Rc,g=[u.x*Rc,u.y*Rc],_=[];if(!a)return _;for(const T of a){const E=[];for(const A of T){const R=[A.x+g[0],A.y+g[1]];Bd(r,R),E.push(R)}_.push(E)}if(r[2]-r[0]<=h/2){(b=r)[0]=b[1]=1/0,b[2]=b[3]=-1/0;for(const T of _)for(const E of T)vb(E,r,o,h)}var b;return _}class Lu{constructor(r,o){this.type=Vr,this.geojson=r,this.geometries=o}static parse(r,o){if(r.length!==2)return o.error(`'within' expression requires exactly one argument, but found ${r.length-1} instead.`);if(Eo(r[1])){const u=r[1];if(u.type==="FeatureCollection")for(let h=0;h<u.features.length;++h){const g=u.features[h].geometry.type;if(g==="Polygon"||g==="MultiPolygon")return new Lu(u,u.features[h].geometry)}else if(u.type==="Feature"){const h=u.geometry.type;if(h==="Polygon"||h==="MultiPolygon")return new Lu(u,u.geometry)}else if(u.type==="Polygon"||u.type==="MultiPolygon")return new Lu(u,u)}return o.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(r){if(r.geometry()!=null&&r.canonicalID()!=null){if(r.geometryType()==="Point")return(function(o,u){const h=[1/0,1/0,-1/0,-1/0],g=[1/0,1/0,-1/0,-1/0],_=o.canonicalID();if(!_)return!1;if(u.type==="Polygon"){const b=Up(u.coordinates,g,_),T=bb(o.geometry(),h,g,_);if(!Ja(h,g))return!1;for(const E of T)if(!Nd(E,b))return!1}if(u.type==="MultiPolygon"){const b=za(u.coordinates,g,_),T=bb(o.geometry(),h,g,_);if(!Ja(h,g))return!1;for(const E of T)if(!YT(E,b))return!1}return!0})(r,this.geometries);if(r.geometryType()==="LineString")return(function(o,u){const h=[1/0,1/0,-1/0,-1/0],g=[1/0,1/0,-1/0,-1/0],_=o.canonicalID();if(!_)return!1;if(u.type==="Polygon"){const b=Up(u.coordinates,g,_),T=xb(o.geometry(),h,g,_);if(!Ja(h,g))return!1;for(const E of T)if(!$p(E,b))return!1}if(u.type==="MultiPolygon"){const b=za(u.coordinates,g,_),T=xb(o.geometry(),h,g,_);if(!Ja(h,g))return!1;for(const E of T)if(!yb(E,b))return!1}return!0})(r,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}const xf={kilometers:1,miles:1e3/1609.344,nauticalmiles:1e3/1852,meters:1e3,metres:1e3,yards:1e3/.9144,feet:1e3/.3048,inches:1e3/.0254},p_=1/298.257223563,m_=p_*(2-p_),Vd=Math.PI/180;class $d{static fromTile(r,o,u){const h=Math.PI*(1-2*(r+.5)/Math.pow(2,o)),g=Math.atan(.5*(Math.exp(h)-Math.exp(-h)))/Vd;return new $d(g,u)}static get units(){return xf}constructor(r,o){if(r===void 0)throw new Error("No latitude given.");if(o&&!xf[o])throw new Error(`Unknown unit ${o}. Use one of: ${Object.keys(xf).join(", ")}`);const u=6378.137*Vd*(o?xf[o]:1),h=Math.cos(r*Vd),g=1/(1-m_*(1-h*h)),_=Math.sqrt(g);this.kx=u*_*h,this.ky=u*_*g*(1-m_)}distance(r,o){const u=ga(r[0]-o[0])*this.kx,h=(r[1]-o[1])*this.ky;return Math.sqrt(u*u+h*h)}bearing(r,o){const u=ga(o[0]-r[0])*this.kx;return Math.atan2(u,(o[1]-r[1])*this.ky)/Vd}destination(r,o,u){const h=u*Vd;return this.offset(r,Math.sin(h)*o,Math.cos(h)*o)}offset(r,o,u){return[r[0]+o/this.kx,r[1]+u/this.ky]}lineDistance(r){let o=0;for(let u=0;u<r.length-1;u++)o+=this.distance(r[u],r[u+1]);return o}area(r){let o=0;for(let u=0;u<r.length;u++){const h=r[u];for(let g=0,_=h.length,b=_-1;g<_;b=g++)o+=ga(h[g][0]-h[b][0])*(h[g][1]+h[b][1])*(u?-1:1)}return Math.abs(o)/2*this.kx*this.ky}along(r,o){let u=0;if(o<=0)return r[0];for(let h=0;h<r.length-1;h++){const g=r[h],_=r[h+1],b=this.distance(g,_);if(u+=b,u>o)return jp(g,_,(o-(u-b))/b)}return r[r.length-1]}pointToSegmentDistance(r,o,u){let[h,g]=o,_=ga(u[0]-h)*this.kx,b=(u[1]-g)*this.ky;if(_!==0||b!==0){const T=(ga(r[0]-h)*this.kx*_+(r[1]-g)*this.ky*b)/(_*_+b*b);T>1?(h=u[0],g=u[1]):T>0&&(h+=_/this.kx*T,g+=b/this.ky*T)}return _=ga(r[0]-h)*this.kx,b=(r[1]-g)*this.ky,Math.sqrt(_*_+b*b)}pointOnLine(r,o){let u=1/0,h=r[0][0],g=r[0][1],_=0,b=0;for(let T=0;T<r.length-1;T++){let E=r[T][0],A=r[T][1],R=ga(r[T+1][0]-E)*this.kx,M=(r[T+1][1]-A)*this.ky,F=0;R===0&&M===0||(F=(ga(o[0]-E)*this.kx*R+(o[1]-A)*this.ky*M)/(R*R+M*M),F>1?(E=r[T+1][0],A=r[T+1][1]):F>0&&(E+=R/this.kx*F,A+=M/this.ky*F)),R=ga(o[0]-E)*this.kx,M=(o[1]-A)*this.ky;const B=R*R+M*M;B<u&&(u=B,h=E,g=A,_=T,b=F)}return{point:[h,g],index:_,t:Math.max(0,Math.min(1,b))}}lineSlice(r,o,u){let h=this.pointOnLine(u,r),g=this.pointOnLine(u,o);if(h.index>g.index||h.index===g.index&&h.t>g.t){const E=h;h=g,g=E}const _=[h.point],b=h.index+1,T=g.index;!g_(u[b],_[0])&&b<=T&&_.push(u[b]);for(let E=b+1;E<=T;E++)_.push(u[E]);return g_(u[T],g.point)||_.push(g.point),_}lineSliceAlong(r,o,u){let h=0;const g=[];for(let _=0;_<u.length-1;_++){const b=u[_],T=u[_+1],E=this.distance(b,T);if(h+=E,h>r&&g.length===0&&g.push(jp(b,T,(r-(h-E))/E)),h>=o)return g.push(jp(b,T,(o-(h-E))/E)),g;h>r&&g.push(T)}return g}bufferPoint(r,o){const u=o/this.ky,h=o/this.kx;return[r[0]-h,r[1]-u,r[0]+h,r[1]+u]}bufferBBox(r,o){const u=o/this.ky,h=o/this.kx;return[r[0]-h,r[1]-u,r[2]+h,r[3]+u]}insideBBox(r,o){return ga(r[0]-o[0])>=0&&ga(r[0]-o[2])<=0&&r[1]>=o[1]&&r[1]<=o[3]}}function g_(a,r){return a[0]===r[0]&&a[1]===r[1]}function jp(a,r,o){const u=ga(r[0]-a[0]);return[a[0]+u*o,a[1]+(r[1]-a[1])*o]}function ga(a){for(;a<-180;)a+=360;for(;a>180;)a-=360;return a}class Gp{constructor(r=[],o=((u,h)=>u<h?-1:u>h?1:0)){if(this.data=r,this.length=this.data.length,this.compare=o,this.length>0)for(let u=(this.length>>1)-1;u>=0;u--)this._down(u)}push(r){this.data.push(r),this._up(this.length++)}pop(){if(this.length===0)return;const r=this.data[0],o=this.data.pop();return--this.length>0&&(this.data[0]=o,this._down(0)),r}peek(){return this.data[0]}_up(r){const{data:o,compare:u}=this,h=o[r];for(;r>0;){const g=r-1>>1,_=o[g];if(u(h,_)>=0)break;o[r]=_,r=g}o[r]=h}_down(r){const{data:o,compare:u}=this,h=this.length>>1,g=o[r];for(;r<h;){let _=1+(r<<1);const b=_+1;if(b<this.length&&u(o[b],o[_])<0&&(_=b),u(o[_],g)>=0)break;o[r]=o[_],r=_}o[r]=g}}var zt=8192;function __(a,r){return r.dist-a.dist}const Ud=100,jd=50;function wf(a){const r=[1/0,1/0,-1/0,-1/0];if(r.length!==a.length)return!1;for(let o=0;o<r.length;o++)if(r[o]!==a[o])return!1;return!0}function Tf(a){return a[1]-a[0]+1}function Tl(a,r){const o=a[1]>=a[0]&&a[1]<r;return o||console.warn("Distance Expression: Index is out of range"),o}function Hp(a,r){if(a[0]>a[1])return[null,null];const o=Tf(a);if(r){if(o===2)return[a,null];const u=Math.floor(o/2);return[[a[0],a[0]+u],[a[0]+u,a[1]]]}{if(o===1)return[a,null];const u=Math.floor(o/2)-1;return[[a[0],a[0]+u],[a[0]+u+1,a[1]]]}}function Fa(a,r){const o=[1/0,1/0,-1/0,-1/0];if(!Tl(r,a.length))return o;for(let u=r[0];u<=r[1];++u)Bd(o,a[u]);return o}function mr(a){const r=[1/0,1/0,-1/0,-1/0];for(let o=0;o<a.length;++o)for(let u=0;u<a[o].length;++u)Bd(r,a[o][u]);return r}function Gd(a,r,o){if(wf(a)||wf(r))return NaN;let u=0,h=0;return a[2]<r[0]&&(u=r[0]-a[2]),a[0]>r[2]&&(u=a[0]-r[2]),a[1]>r[3]&&(h=a[1]-r[3]),a[3]<r[1]&&(h=r[1]-a[3]),o.distance([0,0],[u,h])}function QT(a){return 360*a-180}function eS(a){return 360/Math.PI*Math.atan(Math.exp((180-360*a)*Math.PI/180))-90}function Wp(a,r){const o=Math.pow(2,r.z),u=(a.y/zt+r.y)/o;return[QT((a.x/zt+r.x)/o),eS(u)]}function tS(a,r){const o=[];for(let u=0;u<a.length;++u)o.push(Wp(a[u],r));return o}function Fi(a,r,o){const u=o.pointOnLine(r,a).point;return o.distance(a,u)}function wb(a,r,o,u,h){const g=o.slice(u[0],u[1]+1);let _=1/0;for(let b=r[0];b<=r[1];++b)if((_=Math.min(_,Fi(a[b],g,h)))===0)return 0;return _}function y_(a,r,o,u,h){const g=Math.min(h.pointToSegmentDistance(a,o,u),h.pointToSegmentDistance(r,o,u)),_=Math.min(h.pointToSegmentDistance(o,a,r),h.pointToSegmentDistance(u,a,r));return Math.min(g,_)}function nS(a,r,o,u,h){if(!Tl(r,a.length)||!Tl(u,o.length))return NaN;let g=1/0;for(let _=r[0];_<r[1];++_)for(let b=u[0];b<u[1];++b){if(Np(a[_],a[_+1],o[b],o[b+1]))return 0;g=Math.min(g,y_(a[_],a[_+1],o[b],o[b+1],h))}return g}function rS(a,r,o,u,h){if(!Tl(r,a.length)||!Tl(u,o.length))return NaN;let g=1/0;for(let _=r[0];_<=r[1];++_)for(let b=u[0];b<=u[1];++b)if((g=Math.min(g,h.distance(a[_],o[b])))===0)return g;return g}function iS(a,r,o){if(Nd(a,r,!0))return 0;let u=1/0;for(const h of r){const g=h.length;if(g<2)return console.warn("Distance Expression: Invalid polygon!"),NaN;if(h[0]!==h[g-1]&&(u=Math.min(u,o.pointToSegmentDistance(a,h[g-1],h[0])))===0||(u=Math.min(u,Fi(a,h,o)))===0)return u}return u}function oS(a,r,o,u){if(!Tl(r,a.length))return NaN;for(let g=r[0];g<=r[1];++g)if(Nd(a[g],o,!0))return 0;let h=1/0;for(let g=r[0];g<r[1];++g)for(const _ of o)for(let b=0,T=_.length,E=T-1;b<T;E=b++){if(Np(a[g],a[g+1],_[E],_[b]))return 0;h=Math.min(h,y_(a[g],a[g+1],_[E],_[b],u))}return h}function Tb(a,r){for(const o of a)for(let u=0;u<=o.length-1;++u)if(Nd(o[u],r,!0))return!0;return!1}function sS(a,r,o,u=1/0){const h=mr(a),g=mr(r);if(u!==1/0&&Gd(h,g,o)>=u)return u;if(Ja(h,g)){if(Tb(a,r))return 0}else if(Tb(r,a))return 0;let _=u;for(const b of a)for(let T=0,E=b.length,A=E-1;T<E;A=T++)for(const R of r)for(let M=0,F=R.length,B=F-1;M<F;B=M++){if(Np(b[A],b[T],R[B],R[M]))return 0;_=Math.min(_,y_(b[A],b[T],R[B],R[M],o))}return _}function qp(a,r,o,u,h,g,_){if(g===null||_===null)return;const b=Gd(Fa(u,g),Fa(h,_),o);b<r&&a.push({dist:b,range1:g,range2:_})}function aS(a,r,o,u,h=1/0){let g=Math.min(u.distance(a[0],o[0][0]),h);if(g===0)return g;const _=new Gp([{dist:0,range1:[0,a.length-1],range2:[0,0]}],__),b=r?jd:Ud,T=mr(o);for(;_.length;){const E=_.pop();if(E.dist>=g)continue;const A=E.range1;if(Tf(A)<=b){if(!Tl(A,a.length))return NaN;if(r){const R=oS(a,A,o,u);if((g=Math.min(g,R))===0)return g}else for(let R=A[0];R<=A[1];++R){const M=iS(a[R],o,u);if((g=Math.min(g,M))===0)return g}}else{const R=Hp(A,r);if(R[0]!==null){const M=Gd(Fa(a,R[0]),T,u);M<g&&_.push({dist:M,range1:R[0],range2:[0,0]})}if(R[1]!==null){const M=Gd(Fa(a,R[1]),T,u);M<g&&_.push({dist:M,range1:R[1],range2:[0,0]})}}}return g}function Sb(a,r,o,u,h,g=1/0){let _=Math.min(g,h.distance(a[0],o[0]));if(_===0)return _;const b=new Gp([{dist:0,range1:[0,a.length-1],range2:[0,o.length-1]}],__),T=r?jd:Ud,E=u?jd:Ud;for(;b.length;){const A=b.pop();if(A.dist>=_)continue;const R=A.range1,M=A.range2;if(Tf(R)<=T&&Tf(M)<=E){if(!Tl(R,a.length)||!Tl(M,o.length))return NaN;if(r&&u?_=Math.min(_,nS(a,R,o,M,h)):r||u?r&&!u?_=Math.min(_,wb(o,M,a,R,h)):!r&&u&&(_=Math.min(_,wb(a,R,o,M,h))):_=Math.min(_,rS(a,R,o,M,h)),_===0)return _}else{const F=Hp(R,r),B=Hp(M,u);qp(b,_,h,a,o,F[0],B[0]),qp(b,_,h,a,o,F[0],B[1]),qp(b,_,h,a,o,F[1],B[0]),qp(b,_,h,a,o,F[1],B[1])}}return _}function v_(a,r,o,u,h=1/0){let g=h;const _=Fa(a,[0,a.length-1]);for(const b of o)if(!(g!==1/0&&Gd(_,Fa(b,[0,b.length-1]),u)>=g)&&(g=Math.min(g,Sb(a,r,b,!0,u,g)),g===0))return g;return g}function Kp(a,r,o,u,h=1/0){let g=h;const _=Fa(a,[0,a.length-1]);for(const b of o){if(g!==1/0&&Gd(_,mr(b),u)>=g)continue;const T=aS(a,r,b,u,g);if(isNaN(T))return T;if((g=Math.min(g,T))===0)return g}return g}function b_(a){return a==="Point"||a==="MultiPoint"||a==="LineString"||a==="MultiLineString"||a==="Polygon"||a==="MultiPolygon"}class zu{constructor(r,o){this.type=sn,this.geojson=r,this.geometries=o}static parse(r,o){if(r.length!==2)return o.error(`'distance' expression requires either one argument, but found ' ${r.length-1} instead.`);if(Eo(r[1])){const u=r[1];if(u.type==="FeatureCollection"){for(let h=0;h<u.features.length;++h)if(b_(u.features[h].geometry.type))return new zu(u,u.features[h].geometry)}else if(u.type==="Feature"){if(b_(u.geometry.type))return new zu(u,u.geometry)}else if(b_(u.type))return new zu(u,u)}return o.error("'distance' expression needs to be an array with format ['Distance', GeoJSONObj].")}evaluate(r){const o=r.geometry(),u=r.canonicalID();if(o!=null&&u!=null){if(r.geometryType()==="Point")return(function(h,g,_){const b=[];for(const E of h)for(const A of E)b.push(Wp(A,g));const T=new $d(b[0][1],"meters");return _.type==="Point"||_.type==="MultiPoint"||_.type==="LineString"?Sb(b,!1,_.type==="Point"?[_.coordinates]:_.coordinates,_.type==="LineString",T):_.type==="MultiLineString"?v_(b,!1,_.coordinates,T):_.type==="Polygon"||_.type==="MultiPolygon"?Kp(b,!1,_.type==="Polygon"?[_.coordinates]:_.coordinates,T):null})(o,u,this.geometries);if(r.geometryType()==="LineString")return(function(h,g,_){const b=[];for(const E of h){const A=[];for(const R of E)A.push(Wp(R,g));b.push(A)}const T=new $d(b[0][0][1],"meters");if(_.type==="Point"||_.type==="MultiPoint"||_.type==="LineString")return v_(_.type==="Point"?[_.coordinates]:_.coordinates,_.type==="LineString",b,T);if(_.type==="MultiLineString"){let E=1/0;for(let A=0;A<_.coordinates.length;A++){const R=v_(_.coordinates[A],!0,b,T,E);if(isNaN(R))return R;if((E=Math.min(E,R))===0)return E}return E}if(_.type==="Polygon"||_.type==="MultiPolygon"){let E=1/0;for(let A=0;A<b.length;A++){const R=Kp(b[A],!0,_.type==="Polygon"?[_.coordinates]:_.coordinates,T,E);if(isNaN(R))return R;if((E=Math.min(E,R))===0)return E}return E}return null})(o,u,this.geometries);if(r.geometryType()==="Polygon")return(function(h,g,_){const b=[];for(const E of(function(A,R){const M=A.length;if(M<=1)return[A];const F=[];let B,W;for(let q=0;q<M;q++){const K=Bp(A[q]);K!==0&&(A[q].area=Math.abs(K),W===void 0&&(W=K<0),W===K<0?(B&&F.push(B),B=[A[q]]):B.push(A[q]))}return B&&F.push(B),F})(h)){const A=[];for(let R=0;R<E.length;++R)A.push(tS(E[R],g));b.push(A)}const T=new $d(b[0][0][0][1],"meters");if(_.type==="Point"||_.type==="MultiPoint"||_.type==="LineString")return Kp(_.type==="Point"?[_.coordinates]:_.coordinates,_.type==="LineString",b,T);if(_.type==="MultiLineString"){let E=1/0;for(let A=0;A<_.coordinates.length;A++){const R=Kp(_.coordinates[A],!0,b,T,E);if(isNaN(R))return R;if((E=Math.min(E,R))===0)return E}return E}return _.type==="Polygon"||_.type==="MultiPolygon"?(function(E,A,R){let M=1/0;for(const F of E)for(const B of A){const W=sS(F,B,R,M);if(isNaN(W))return W;if((M=Math.min(M,W))===0)return M}return M})(_.type==="Polygon"?[_.coordinates]:_.coordinates,b,T):null})(o,u,this.geometries);console.warn("Distance Expression: currently only evaluates valid Point/LineString/Polygon geometries.")}else console.warn("Distance Expression: requirs valid feature and canonical information.");return null}eachChild(){}outputDefined(){return!0}serialize(){return["distance",this.geojson]}}function Hd(a){if(a instanceof xs&&(a.name==="get"&&a.args.length===1||a.name==="feature-state"||a.name==="has"&&a.args.length===1||a.name==="properties"||a.name==="geometry-type"||a.name==="id"||/^filter-/.test(a.name))||a instanceof Lu||a instanceof zu)return!1;if(a instanceof qd)return a.featureConstant;let r=!0;return a.eachChild((o=>{r&&!Hd(o)&&(r=!1)})),r}function Zp(a){if(a instanceof xs&&a.name==="feature-state")return!1;let r=!0;return a.eachChild((o=>{r&&!Zp(o)&&(r=!1)})),r}function Xp(a){if(a instanceof qd)return new Set([a.key]);let r=new Set;return a.eachChild((o=>{r=new Set([...r,...Xp(o)])})),r}function Wd(a,r){if(a instanceof xs&&r.indexOf(a.name)>=0)return!1;let o=!0;return a.eachChild((u=>{o&&!Wd(u,r)&&(o=!1)})),o}function Eb(a,r,o){return[a,r,o].filter(Boolean).join("")}function x_(a,r){switch(a){case"string":return $i(r);case"number":return+r;case"boolean":return!!r;case"color":return Pr.parse(r);case"formatted":return pt.fromString($i(r));case"resolvedImage":return gn.build($i(r))}return r}function Cb(a,r,o,u){return u!==void 0&&(a=u*Math.round(a/u)),r!==void 0&&a<r&&(a=r),o!==void 0&&a>o&&(a=o),a}class qd{constructor(r,o,u,h=!1){this.type=r,this.key=o,this.scope=u,this.featureConstant=h}static parse(r,o){let u=o.expectedType;if(u==null&&(u=kr),r.length<2||r.length>3)return o.error("Invalid number of arguments for 'config' expression.");const h=o.parse(r[1],1);if(!(h instanceof In))return o.error("Key name of 'config' expression must be a string literal.");let g,_=!0;const b=$i(h.value);if(r.length>=3){const T=o.parse(r[2],2);if(!(T instanceof In))return o.error("Scope of 'config' expression must be a string literal.");g=$i(T.value)}if(o.options){const T=Eb(b,g,o._scope),E=o.options.get(T);E&&(_=Hd(E.value||E.default))}return new qd(u,b,g,_)}evaluate(r){const o=Eb(this.key,this.scope,r.scope),u=r.getConfig(o);if(!u)return null;const{type:h,value:g,values:_,minValue:b,maxValue:T,stepValue:E}=u,A=u.default.evaluate(r);let R=A;if(g){const M=r.scope;r.scope=(M||"").split("").slice(1).join(""),R=g.evaluate(r),r.scope=M}return h&&(R=x_(h,R)),R===void 0||b===void 0&&T===void 0&&E===void 0||(typeof R=="number"?R=Cb(R,b,T,E):Array.isArray(R)&&(R=R.map((M=>typeof M=="number"?Cb(M,b,T,E):M)))),g!==void 0&&R!==void 0&&_&&!_.includes(R)&&(R=A,h&&(R=x_(h,R))),(h&&h!==this.type||R!==void 0&&!X(yr(R),this.type))&&(R=x_(this.type.kind,R)),R}eachChild(){}outputDefined(){return!1}serialize(){const r=["config",this.key];return this.scope&&r.concat(this.scope),r}}class Yp{constructor(r,o){this.type=o.type,this.name=r,this.boundExpression=o}static parse(r,o){if(r.length!==2||typeof r[1]!="string")return o.error("'var' expression requires exactly one string literal argument.");const u=r[1];return o.scope.has(u)?new Yp(u,o.scope.get(u)):o.error(`Unknown variable "${u}". Make sure "${u}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(r){return this.boundExpression.evaluate(r)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}class Jp{constructor(r,o=[],u,h=new Cc,g=[],_,b,T){this.registry=r,this.path=o,this.key=o.map((E=>typeof E=="string"?`['${E}']`:`[${E}]`)).join(""),this.scope=h,this.errors=g,this.expectedType=u,this._scope=_,this.options=b,this.iconImageUseTheme=T}parse(r,o,u,h,g={}){return o||u?this.concat(o,null,u,h)._parse(r,g):this._parse(r,g)}parseObjectValue(r,o,u,h,g,_={}){return this.concat(o,u,h,g)._parse(r,_)}_parse(r,o){function u(h,g,_){return _==="assert"?new Tn(g,[h]):_==="coerce"?new _o(g,[h]):h}if(r!==null&&typeof r!="string"&&typeof r!="boolean"&&typeof r!="number"||(r=["literal",r]),Array.isArray(r)){if(r.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const h=typeof r[0]=="string"?this.registry[r[0]]:void 0;if(h){let g=h.parse(r,this);if(!g)return null;if(this.expectedType){const _=this.expectedType,b=g.type;if(_.kind!=="string"&&_.kind!=="number"&&_.kind!=="boolean"&&_.kind!=="object"&&_.kind!=="array"||b.kind!=="value")if(_.kind!=="color"&&_.kind!=="formatted"&&_.kind!=="resolvedImage"||b.kind!=="value"&&b.kind!=="string"){if(this.checkSubtype(_,b))return null}else g=u(g,_,o.typeAnnotation||"coerce");else g=u(g,_,o.typeAnnotation||"assert")}if(!(g instanceof In)&&g.type.kind!=="resolvedImage"&&w_(g)){const _=new Xl(this._scope,this.options,this.iconImageUseTheme);try{g=new In(g.type,g.evaluate(_))}catch(b){return this.error(b.message),null}}return g}return _o.parse(["to-array",r],this)}return this.error(r===void 0?"'undefined' value invalid. Use null instead.":typeof r=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof r} instead.`)}concat(r,o,u,h){let g=typeof r=="number"?this.path.concat(r):this.path;g=typeof o=="string"?g.concat(o):g;const _=h?this.scope.concat(h):this.scope;return new Jp(this.registry,g,u||null,_,this.errors,this._scope,this.options,this.iconImageUseTheme)}error(r,...o){const u=`${this.key}${o.map((h=>`[${h}]`)).join("")}`;this.errors.push(new Ks(u,r))}checkSubtype(r,o){const u=Ac(r,o);return u&&this.error(u),u}}function w_(a){if(a instanceof Yp)return w_(a.boundExpression);if(a instanceof xs&&a.name==="error"||a instanceof Yo||a instanceof Lu||a instanceof zu||a instanceof qd)return!1;const r=a instanceof _o||a instanceof Tn;let o=!0;return a.eachChild((u=>{o=r?o&&w_(u):o&&u instanceof In})),!!o&&Hd(a)&&Wd(a,["zoom","heatmap-density","worldview","line-progress","raster-value","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center","measure-light","raster-particle-speed"])}function Qp(a,r){const o=a.length-1;let u,h,g=0,_=o,b=0;for(;g<=_;)if(b=Math.floor((g+_)/2),u=a[b],h=a[b+1],u<=r){if(b===o||r<h)return b;g=b+1}else{if(!(u>r))throw new Gt("Input is not a number.");_=b-1}return 0}class Sf{constructor(r,o,u){this.type=r,this.input=o,this.labels=[],this.outputs=[];for(const[h,g]of u)this.labels.push(h),this.outputs.push(g)}static parse(r,o){if(r.length-1<4)return o.error(`Expected at least 4 arguments, but found only ${r.length-1}.`);if((r.length-1)%2!=0)return o.error("Expected an even number of arguments.");const u=o.parse(r[1],1,sn);if(!u)return null;const h=[];let g=null;o.expectedType&&o.expectedType.kind!=="value"&&(g=o.expectedType);for(let _=1;_<r.length;_+=2){const b=_===1?-1/0:r[_],T=r[_+1],E=_,A=_+1;if(typeof b!="number")return o.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',E);if(h.length&&h[h.length-1][0]>=b)return o.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',E);const R=o.parse(T,A,g);if(!R)return null;g=g||R.type,h.push([b,R])}return new Sf(g,u,h)}evaluate(r){const o=this.labels,u=this.outputs;if(o.length===1)return u[0].evaluate(r);const h=this.input.evaluate(r);if(h<=o[0])return u[0].evaluate(r);const g=o.length;return h>=o[g-1]?u[g-1].evaluate(r):u[Qp(o,h)].evaluate(r)}eachChild(r){r(this.input);for(const o of this.outputs)r(o)}outputDefined(){return this.outputs.every((r=>r.outputDefined()))}serialize(){const r=["step",this.input.serialize()];for(let o=0;o<this.labels.length;o++)o>0&&r.push(this.labels[o]),r.push(this.outputs[o].serialize());return r}}const Ib=.95047,Ab=1.08883,Pb=4/29,kc=6/29,Rb=3*kc*kc,kb=kc*kc*kc,lS=Math.PI/180,cS=180/Math.PI;function T_(a){return a>kb?Math.pow(a,1/3):a/Rb+Pb}function em(a){return a>kc?a*a*a:Rb*(a-Pb)}function tm(a){return 255*(a<=.0031308?12.92*a:1.055*Math.pow(a,1/2.4)-.055)}function Oc(a){return(a/=255)<=.04045?a/12.92:Math.pow((a+.055)/1.055,2.4)}function S_(a){const r=Oc(a.r),o=Oc(a.g),u=Oc(a.b),h=T_((.4124564*r+.3575761*o+.1804375*u)/Ib),g=T_((.2126729*r+.7151522*o+.072175*u)/1);return{l:116*g-16,a:500*(h-g),b:200*(g-T_((.0193339*r+.119192*o+.9503041*u)/Ab)),alpha:a.a}}function E_(a){let r=(a.l+16)/116,o=isNaN(a.a)?r:r+a.a/500,u=isNaN(a.b)?r:r-a.b/200;return r=1*em(r),o=Ib*em(o),u=Ab*em(u),new Pr(tm(3.2404542*o-1.5371385*r-.4985314*u),tm(-.969266*o+1.8760108*r+.041556*u),tm(.0556434*o-.2040259*r+1.0572252*u),a.alpha)}function uS(a,r,o){const u=r-a;return a+o*(u>180||u<-180?u-360*Math.round(u/360):u)}const Fu={forward:S_,reverse:E_,interpolate:function(a,r,o){return{l:wn(a.l,r.l,o),a:wn(a.a,r.a,o),b:wn(a.b,r.b,o),alpha:wn(a.alpha,r.alpha,o)}}},Bu={forward:function(a){const{l:r,a:o,b:u}=S_(a),h=Math.atan2(u,o)*cS;return{h:h<0?h+360:h,c:Math.sqrt(o*o+u*u),l:r,alpha:a.a}},reverse:function(a){const r=a.h*lS,o=a.c;return E_({l:a.l,a:Math.cos(r)*o,b:Math.sin(r)*o,alpha:a.alpha})},interpolate:function(a,r,o){return{h:uS(a.h,r.h,o),c:wn(a.c,r.c,o),l:wn(a.l,r.l,o),alpha:wn(a.alpha,r.alpha,o)}}};var Ob=Object.freeze({__proto__:null,hcl:Bu,lab:Fu});class _a{constructor(r,o,u,h,g){this.type=r,this.operator=o,this.interpolation=u,this.input=h,this.labels=[],this.outputs=[];for(const[_,b]of g)this.labels.push(_),this.outputs.push(b)}static interpolationFactor(r,o,u,h){let g=0;if(r.name==="exponential")g=nm(o,r.base,u,h);else if(r.name==="linear")g=nm(o,1,u,h);else if(r.name==="cubic-bezier"){const _=r.controlPoints;g=new xu(_[0],_[1],_[2],_[3]).solve(nm(o,1,u,h))}return g}static parse(r,o){let[u,h,g,..._]=r;if(!Array.isArray(h)||h.length===0)return o.error("Expected an interpolation type expression.",1);if(h[0]==="linear")h={name:"linear"};else if(h[0]==="exponential"){const E=h[1];if(typeof E!="number")return o.error("Exponential interpolation requires a numeric base.",1,1);h={name:"exponential",base:E}}else{if(h[0]!=="cubic-bezier")return o.error(`Unknown interpolation type ${String(h[0])}`,1,0);{const E=h.slice(1);if(E.length!==4||E.some((A=>typeof A!="number"||A<0||A>1)))return o.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);h={name:"cubic-bezier",controlPoints:E}}}if(r.length-1<4)return o.error(`Expected at least 4 arguments, but found only ${r.length-1}.`);if(r.length-1>3&&(r.length-1)%2!=0)return o.error("Expected an even number of arguments.");if(g=o.parse(g,2,sn),!g)return null;const b=[];let T=null;u==="interpolate-hcl"||u==="interpolate-lab"?T=us:o.expectedType&&o.expectedType.kind!=="value"&&(T=o.expectedType);for(let E=0;E<_.length;E+=2){const A=_[E],R=_[E+1],M=E+3,F=E+4;if(typeof A!="number")return o.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',M);if(b.length&&b[b.length-1][0]>=A)return o.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',M);const B=o.parse(R,F,T);if(!B)return null;T=T||B.type,b.push([A,B])}return T.kind==="number"||T.kind==="color"||T.kind==="array"&&T.itemType.kind==="number"&&typeof T.N=="number"?new _a(T,u,h,g,b):o.error(`Type ${fi(T)} is not interpolatable.`)}evaluate(r){const o=this.labels,u=this.outputs;if(o.length===1)return u[0].evaluate(r);const h=this.input.evaluate(r);if(h<=o[0])return u[0].evaluate(r);const g=o.length;if(h>=o[g-1])return u[g-1].evaluate(r);const _=Qp(o,h),b=_a.interpolationFactor(this.interpolation,h,o[_],o[_+1]),T=u[_].evaluate(r),E=u[_+1].evaluate(r);return this.operator==="interpolate"?bs[this.type.kind.toLowerCase()](T,E,b):this.operator==="interpolate-hcl"?Bu.reverse(Bu.interpolate(Bu.forward(T),Bu.forward(E),b)):Fu.reverse(Fu.interpolate(Fu.forward(T),Fu.forward(E),b))}eachChild(r){r(this.input);for(const o of this.outputs)r(o)}outputDefined(){return this.outputs.every((r=>r.outputDefined()))}serialize(){let r;r=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier",...this.interpolation.controlPoints];const o=[this.operator,r,this.input.serialize()];for(let u=0;u<this.labels.length;u++)o.push(this.labels[u],this.outputs[u].serialize());return o}}function nm(a,r,o,u){const h=u-o,g=a-o;return h===0?0:r===1?g/h:(Math.pow(r,g)-1)/(Math.pow(r,h)-1)}class Ef{constructor(r,o){this.type=r,this.args=o}static parse(r,o){if(r.length<2)return o.error("Expectected at least one argument.");let u=null;const h=o.expectedType;h&&h.kind!=="value"&&(u=h);const g=[];for(const b of r.slice(1)){const T=o.parse(b,1+g.length,u,void 0,{typeAnnotation:"omit"});if(!T)return null;u=u||T.type,g.push(T)}const _=h&&g.some((b=>Ac(h,b.type)));return new Ef(_?kr:u,g)}evaluate(r){let o,u=null,h=0;for(const g of this.args){if(h++,u=g.evaluate(r),u&&u instanceof gn&&!u.available&&(o||(o=u),u=null,h===this.args.length))return o;if(u!==null)break}return u}eachChild(r){this.args.forEach(r)}outputDefined(){return this.args.every((r=>r.outputDefined()))}serialize(){const r=["coalesce"];return this.eachChild((o=>{r.push(o.serialize())})),r}}class rm{constructor(r,o){this.type=o.type,this.bindings=[].concat(r),this.result=o}evaluate(r){return this.result.evaluate(r)}eachChild(r){for(const o of this.bindings)r(o[1]);r(this.result)}static parse(r,o){if(r.length<4)return o.error(`Expected at least 3 arguments, but found ${r.length-1} instead.`);const u=[];for(let g=1;g<r.length-1;g+=2){const _=r[g];if(typeof _!="string")return o.error(`Expected string, but found ${typeof _} instead.`,g);if(/[^a-zA-Z0-9_]/.test(_))return o.error("Variable names must contain only alphanumeric characters or '_'.",g);const b=o.parse(r[g+1],g+1);if(!b)return null;u.push([_,b])}const h=o.parse(r[r.length-1],r.length-1,o.expectedType,u);return h?new rm(u,h):null}outputDefined(){return this.result.outputDefined()}serialize(){const r=["let"];for(const[o,u]of this.bindings)r.push(o,u.serialize());return r.push(this.result.serialize()),r}}class C_{constructor(r,o,u){this.type=r,this.index=o,this.input=u}static parse(r,o){if(r.length!==3)return o.error(`Expected 2 arguments, but found ${r.length-1} instead.`);const u=o.parse(r[1],1,sn),h=o.parse(r[2],2,No(o.expectedType||kr));return u&&h?new C_(h.type.itemType,u,h):null}evaluate(r){const o=this.index.evaluate(r),u=this.input.evaluate(r);if(o<0)throw new Gt("Array index out of bounds: negative index");if(o>=u.length)throw new Gt("Array index out of bounds: index exceeds array size");if(o!==Math.floor(o))throw new Gt("Array index must be an integer. Use at-interpolated for fractional indices");return u[o]}eachChild(r){r(this.index),r(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}class I_{constructor(r,o,u){this.type=r,this.index=o,this.input=u}static parse(r,o){if(r.length!==3)return o.error(`Expected 2 arguments, but found ${r.length-1} instead.`);const u=o.parse(r[1],1,sn),h=o.parse(r[2],2,No(o.expectedType||kr));return u&&h?new I_(h.type.itemType,u,h):null}evaluate(r){const o=this.index.evaluate(r),u=this.input.evaluate(r);if(o<0)throw new Gt(`Array index out of bounds: ${o} < 0.`);if(o>u.length-1)throw new Gt(`Array index out of bounds: ${o} > ${u.length-1}.`);if(o===Math.floor(o))return u[o];const h=Math.floor(o),g=Math.ceil(o),_=u[h],b=u[g];if(typeof _!="number"||typeof b!="number")throw new Gt(`Cannot interpolate between non-number values at index ${o}.`);const T=o-h;return _*(1-T)+b*T}eachChild(r){r(this.index),r(this.input)}outputDefined(){return!1}serialize(){return["at-interpolated",this.index.serialize(),this.input.serialize()]}}class im{constructor(r,o){this.type=Vr,this.needle=r,this.haystack=o}static parse(r,o){if(r.length!==3)return o.error(`Expected 2 arguments, but found ${r.length-1} instead.`);const u=o.parse(r[1],1,kr),h=o.parse(r[2],2,kr);return u&&h?wl(u.type,[Vr,Rr,sn,Zs,kr])?new im(u,h):o.error(`Expected first argument to be of type boolean, string, number or null, but found ${fi(u.type)} instead`):null}evaluate(r){const o=this.needle.evaluate(r),u=this.haystack.evaluate(r);if(u==null)return!1;if(!k(o,["boolean","string","number","null"]))throw new Gt(`Expected first argument to be of type boolean, string, number or null, but found ${fi(yr(o))} instead.`);if(!k(u,["string","array"]))throw new Gt(`Expected second argument to be of type array or string, but found ${fi(yr(u))} instead.`);return u.indexOf(o)>=0}eachChild(r){r(this.needle),r(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}class Cf{constructor(r,o,u){this.type=sn,this.needle=r,this.haystack=o,this.fromIndex=u}static parse(r,o){if(r.length<=2||r.length>=5)return o.error(`Expected 3 or 4 arguments, but found ${r.length-1} instead.`);const u=o.parse(r[1],1,kr),h=o.parse(r[2],2,kr);if(!u||!h)return null;if(!wl(u.type,[Vr,Rr,sn,Zs,kr]))return o.error(`Expected first argument to be of type boolean, string, number or null, but found ${fi(u.type)} instead`);if(r.length===4){const g=o.parse(r[3],3,sn);return g?new Cf(u,h,g):null}return new Cf(u,h)}evaluate(r){const o=this.needle.evaluate(r),u=this.haystack.evaluate(r);if(!k(o,["boolean","string","number","null"]))throw new Gt(`Expected first argument to be of type boolean, string, number or null, but found ${fi(yr(o))} instead.`);if(!k(u,["string","array"]))throw new Gt(`Expected second argument to be of type array or string, but found ${fi(yr(u))} instead.`);if(this.fromIndex){const h=this.fromIndex.evaluate(r);return u.indexOf(o,h)}return u.indexOf(o)}eachChild(r){r(this.needle),r(this.haystack),this.fromIndex&&r(this.fromIndex)}outputDefined(){return!1}serialize(){if(this.fromIndex!=null&&this.fromIndex!==void 0){const r=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),r]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}class Kd{constructor(r,o,u,h,g,_){this.inputType=r,this.type=o,this.input=u,this.cases=h,this.outputs=g,this.otherwise=_}static parse(r,o){if(r.length<5)return o.error(`Expected at least 4 arguments, but found only ${r.length-1}.`);if(r.length%2!=1)return o.error("Expected an even number of arguments.");let u,h;o.expectedType&&o.expectedType.kind!=="value"&&(h=o.expectedType);const g={},_=[];for(let E=2;E<r.length-1;E+=2){let A=r[E];const R=r[E+1];Array.isArray(A)||(A=[A]);const M=o.concat(E);if(A.length===0)return M.error("Expected at least one branch label.");for(const B of A){if(typeof B!="number"&&typeof B!="string")return M.error("Branch labels must be numbers or strings.");if(typeof B=="number"&&Math.abs(B)>Number.MAX_SAFE_INTEGER)return M.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof B=="number"&&Math.floor(B)!==B)return M.error("Numeric branch labels must be integer values.");if(u){if(M.checkSubtype(u,yr(B)))return null}else u=yr(B);if(g[String(B)]!==void 0)return M.error("Branch labels must be unique.");g[String(B)]=_.length}const F=o.parse(R,E,h);if(!F)return null;h=h||F.type,_.push(F)}const b=o.parse(r[1],1,kr);if(!b)return null;const T=o.parse(r[r.length-1],r.length-1,h);return T?b.type.kind!=="value"&&o.concat(1).checkSubtype(u,b.type)?null:new Kd(u,h,b,g,_,T):null}evaluate(r){const o=this.input.evaluate(r);return(X(yr(o),this.inputType)&&this.outputs[this.cases[o]]||this.otherwise).evaluate(r)}eachChild(r){r(this.input),this.outputs.forEach(r),r(this.otherwise)}outputDefined(){return this.outputs.every((r=>r.outputDefined()))&&this.otherwise.outputDefined()}serialize(){const r=["match",this.input.serialize()],o=Object.keys(this.cases).sort(),u=[],h={};for(const _ of o){const b=h[this.cases[_]];b===void 0?(h[this.cases[_]]=u.length,u.push([this.cases[_],[_]])):u[b][1].push(_)}const g=_=>this.inputType.kind==="number"?Number(_):_;for(const[_,b]of u)r.push(b.length===1?g(b[0]):b.map(g)),r.push(this.outputs[_].serialize());return r.push(this.otherwise.serialize()),r}}class A_{constructor(r,o,u){this.type=r,this.branches=o,this.otherwise=u}static parse(r,o){if(r.length<4)return o.error(`Expected at least 3 arguments, but found only ${r.length-1}.`);if(r.length%2!=0)return o.error("Expected an odd number of arguments.");let u;o.expectedType&&o.expectedType.kind!=="value"&&(u=o.expectedType);const h=[];for(let _=1;_<r.length-1;_+=2){const b=o.parse(r[_],_,Vr);if(!b)return null;const T=o.parse(r[_+1],_+1,u);if(!T)return null;h.push([b,T]),u=u||T.type}const g=o.parse(r[r.length-1],r.length-1,u);return g?new A_(u,h,g):null}evaluate(r){for(const[o,u]of this.branches)if(o.evaluate(r))return u.evaluate(r);return this.otherwise.evaluate(r)}eachChild(r){for(const[o,u]of this.branches)r(o),r(u);r(this.otherwise)}outputDefined(){return this.branches.every((([r,o])=>o.outputDefined()))&&this.otherwise.outputDefined()}serialize(){const r=["case"];return this.eachChild((o=>{r.push(o.serialize())})),r}}class If{constructor(r,o,u,h){this.type=r,this.input=o,this.beginIndex=u,this.endIndex=h}static parse(r,o){if(r.length<=2||r.length>=5)return o.error(`Expected 3 or 4 arguments, but found ${r.length-1} instead.`);const u=o.parse(r[1],1,kr),h=o.parse(r[2],2,sn);if(!u||!h)return null;if(!wl(u.type,[No(kr),Rr,kr]))return o.error(`Expected first argument to be of type array or string, but found ${fi(u.type)} instead`);if(r.length===4){const g=o.parse(r[3],3,sn);return g?new If(u.type,u,h,g):null}return new If(u.type,u,h)}evaluate(r){const o=this.input.evaluate(r),u=this.beginIndex.evaluate(r);if(!k(o,["string","array"]))throw new Gt(`Expected first argument to be of type array or string, but found ${fi(yr(o))} instead.`);if(this.endIndex){const h=this.endIndex.evaluate(r);return o.slice(u,h)}return o.slice(u)}eachChild(r){r(this.input),r(this.beginIndex),this.endIndex&&r(this.endIndex)}outputDefined(){return!1}serialize(){if(this.endIndex!=null&&this.endIndex!==void 0){const r=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),r]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}class P_{constructor(r,o){this.type=No(Rr),this.str=r,this.delimiter=o}static parse(r,o){if(r.length!==3)return o.error(`Expected 2 arguments, but found ${r.length-1} instead.`);const u=o.parse(r[1],1,Rr),h=o.parse(r[2],2,Rr);return u&&h?new P_(u,h):void 0}evaluate(r){const o=this.str.evaluate(r),u=this.delimiter.evaluate(r);return o.split(u)}eachChild(r){r(this.str),r(this.delimiter)}outputDefined(){return!1}serialize(){return["split",this.str.serialize(),this.delimiter.serialize()]}}function Mb(a,r){return a==="=="||a==="!="?r.kind==="boolean"||r.kind==="string"||r.kind==="number"||r.kind==="null"||r.kind==="value":r.kind==="string"||r.kind==="number"||r.kind==="value"}function R_(a,r,o,u){return u.compare(r,o)===0}function Nu(a,r,o){const u=a!=="=="&&a!=="!=";return class rV{constructor(g,_,b){this.type=Vr,this.lhs=g,this.rhs=_,this.collator=b,this.hasUntypedArgument=g.type.kind==="value"||_.type.kind==="value"}static parse(g,_){if(g.length!==3&&g.length!==4)return _.error("Expected two or three arguments.");const b=g[0];let T=_.parse(g[1],1,kr);if(!T)return null;if(!Mb(b,T.type))return _.concat(1).error(`"${b}" comparisons are not supported for type '${fi(T.type)}'.`);let E=_.parse(g[2],2,kr);if(!E)return null;if(!Mb(b,E.type))return _.concat(2).error(`"${b}" comparisons are not supported for type '${fi(E.type)}'.`);if(T.type.kind!==E.type.kind&&T.type.kind!=="value"&&E.type.kind!=="value")return _.error(`Cannot compare types '${fi(T.type)}' and '${fi(E.type)}'.`);u&&(T.type.kind==="value"&&E.type.kind!=="value"?T=new Tn(E.type,[T]):T.type.kind!=="value"&&E.type.kind==="value"&&(E=new Tn(T.type,[E])));let A=null;if(g.length===4){if(T.type.kind!=="string"&&E.type.kind!=="string"&&T.type.kind!=="value"&&E.type.kind!=="value")return _.error("Cannot use collator to compare non-string types.");if(A=_.parse(g[3],3,Mu),!A)return null}return new rV(T,E,A)}evaluate(g){const _=this.lhs.evaluate(g),b=this.rhs.evaluate(g);if(u&&this.hasUntypedArgument){const T=yr(_),E=yr(b);if(T.kind!==E.kind||T.kind!=="string"&&T.kind!=="number")throw new Gt(`Expected arguments for "${a}" to be (string, string) or (number, number), but found (${T.kind}, ${E.kind}) instead.`)}if(this.collator&&!u&&this.hasUntypedArgument){const T=yr(_),E=yr(b);if(T.kind!=="string"||E.kind!=="string")return r(g,_,b)}return this.collator?o(g,_,b,this.collator.evaluate(g)):r(g,_,b)}eachChild(g){g(this.lhs),g(this.rhs),this.collator&&g(this.collator)}outputDefined(){return!0}serialize(){const g=[a];return this.eachChild((_=>{g.push(_.serialize())})),g}}}const dS=Nu("==",(function(a,r,o){return r===o}),R_),hS=Nu("!=",(function(a,r,o){return r!==o}),(function(a,r,o,u){return!R_(0,r,o,u)})),fS=Nu("<",(function(a,r,o){return r<o}),(function(a,r,o,u){return u.compare(r,o)<0})),om=Nu(">",(function(a,r,o){return r>o}),(function(a,r,o,u){return u.compare(r,o)>0})),pS=Nu("<=",(function(a,r,o){return r<=o}),(function(a,r,o,u){return u.compare(r,o)<=0})),mS=Nu(">=",(function(a,r,o){return r>=o}),(function(a,r,o,u){return u.compare(r,o)>=0}));class k_{constructor(r,o,u,h,g,_){this.type=Rr,this.number=r,this.locale=o,this.currency=u,this.unit=h,this.minFractionDigits=g,this.maxFractionDigits=_}static parse(r,o){if(r.length!==3)return o.error("Expected two arguments.");const u=o.parse(r[1],1,sn);if(!u)return null;const h=r[2];if(typeof h!="object"||Array.isArray(h))return o.error("NumberFormat options argument must be an object.");let g=null;if(h.locale&&(g=o.parseObjectValue(h.locale,2,"locale",Rr),!g))return null;let _=null;if(h.currency&&(_=o.parseObjectValue(h.currency,2,"currency",Rr),!_))return null;let b=null;if(h.unit&&(b=o.parseObjectValue(h.unit,2,"unit",Rr),!b))return null;let T=null;if(h["min-fraction-digits"]&&(T=o.parseObjectValue(h["min-fraction-digits"],2,"min-fraction-digits",sn),!T))return null;let E=null;return h["max-fraction-digits"]&&(E=o.parseObjectValue(h["max-fraction-digits"],2,"max-fraction-digits",sn),!E)?null:new k_(u,g,_,b,T,E)}evaluate(r){return new Intl.NumberFormat(this.locale?this.locale.evaluate(r):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(r):void 0,unit:this.unit?this.unit.evaluate(r):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(r):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(r):void 0}).format(this.number.evaluate(r))}eachChild(r){r(this.number),this.locale&&r(this.locale),this.currency&&r(this.currency),this.unit&&r(this.unit),this.minFractionDigits&&r(this.minFractionDigits),this.maxFractionDigits&&r(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const r={};return this.locale&&(r.locale=this.locale.serialize()),this.currency&&(r.currency=this.currency.serialize()),this.unit&&(r.unit=this.unit.serialize()),this.minFractionDigits&&(r["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(r["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),r]}}class O_{constructor(r){this.type=sn,this.input=r}static parse(r,o){if(r.length!==2)return o.error(`Expected 1 argument, but found ${r.length-1} instead.`);const u=o.parse(r[1],1);return u?u.type.kind!=="array"&&u.type.kind!=="string"&&u.type.kind!=="value"?o.error(`Expected argument of type string or array, but found ${fi(u.type)} instead.`):new O_(u):null}evaluate(r){const o=this.input.evaluate(r);if(typeof o=="string"||Array.isArray(o))return o.length;throw new Gt(`Expected value to be of type string or array, but found ${fi(yr(o))} instead.`)}eachChild(r){r(this.input)}outputDefined(){return!1}serialize(){const r=["length"];return this.eachChild((o=>{r.push(o.serialize())})),r}}function M_(a){return function(){a=1831565813+(a|=0)|0;let r=Math.imul(a^a>>>15,1|a);return r=r+Math.imul(r^r>>>7,61|r)^r,((r^r>>>14)>>>0)/4294967296}}const Zd={"==":dS,"!=":hS,">":om,"<":fS,">=":mS,"<=":pS,array:Tn,at:C_,"at-interpolated":I_,boolean:Tn,case:A_,coalesce:Ef,collator:Yo,format:Ya,image:Fd,in:im,"index-of":Cf,interpolate:_a,"interpolate-hcl":_a,"interpolate-lab":_a,length:O_,let:rm,literal:In,match:Kd,number:Tn,"number-format":k_,object:Tn,slice:If,step:Sf,string:Tn,"to-boolean":_o,"to-color":_o,"to-number":_o,"to-string":_o,var:Yp,within:Lu,distance:zu,config:qd,split:P_};function Db(a,[r,o,u,h]){r=r.evaluate(a),o=o.evaluate(a),u=u.evaluate(a);const g=h?h.evaluate(a):1,_=Qi(r,o,u,g);if(_)throw new Gt(_);return new Pr(r/255,o/255,u/255,g)}function D_(a,[r,o,u,h]){r=r.evaluate(a),o=o.evaluate(a),u=u.evaluate(a);const g=h?h.evaluate(a):1,_=(function(E,A,R,M){return typeof E=="number"&&E>=0&&E<=360?typeof A=="number"&&A>=0&&A<=100&&typeof R=="number"&&R>=0&&R<=100?M===void 0||typeof M=="number"&&M>=0&&M<=1?null:`Invalid hsla value [${[E,A,R,M].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid hsla value [${(typeof M=="number"?[E,A,R,M]:[E,A,R]).join(", ")}]: 's', and 'l' must be between 0 and 100.`:`Invalid hsla value [${(typeof M=="number"?[E,A,R,M]:[E,A,R]).join(", ")}]: 'h' must be between 0 and 360.`})(r,o,u,g);if(_)throw new Gt(_);const b=`hsla(${r}, ${o}%, ${u}%, ${g})`,T=Pr.parse(b);if(!T)throw new Gt(`Failed to parse HSLA color: ${b}`);return T}function L_(a,r){return a in r}function sm(a,r){const o=r[a];return o===void 0?null:o}function Vu(a){return{type:a}}function $u(a){return{result:"success",value:a}}function Mc(a){return{result:"error",value:a}}function z_(a,r){return!!a&&!!a.parameters&&a.parameters.indexOf(r)>-1}function am(a){return a["property-type"]==="data-driven"}function F_(a){return z_(a.expression,"measure-light")}function B_(a){return z_(a.expression,"zoom")}function lm(a){return!!a.expression&&a.expression.interpolated}function cm(a){return typeof a=="object"&&a!==null&&!Array.isArray(a)}function N_(a){return a}function um(a,r){const o=r.type==="color",u=a.stops&&typeof a.stops[0][0]=="object",h=u||!(u||a.property!==void 0),g=a.type||(lm(r)?"exponential":"interval");if(o&&((a=Object.assign({},a)).stops&&(a.stops=a.stops.map((E=>[E[0],Pr.parse(E[1])]))),a.default=Pr.parse(a.default?a.default:r.default)),a.colorSpace&&a.colorSpace!=="rgb"&&!Ob[a.colorSpace])throw new Error(`Unknown color space: ${a.colorSpace}`);let _,b,T;if(g==="exponential")_=Lb;else if(g==="interval")_=Dc;else if(g==="categorical"){_=gS,b=Object.create(null);for(const E of a.stops)b[E[0]]=E[1];T=typeof a.stops[0][0]}else{if(g!=="identity")throw new Error(`Unknown function type "${g}"`);_=_S}if(u){const E={},A=[];for(let F=0;F<a.stops.length;F++){const B=a.stops[F],W=B[0].zoom;E[W]===void 0&&(E[W]={zoom:W,type:a.type,property:a.property,default:a.default,stops:[]},A.push(W)),E[W].stops.push([B[0].value,B[1]])}const R=[];for(const F of A)R.push([E[F].zoom,um(E[F],r)]);const M={name:"linear"};return{kind:"composite",interpolationType:M,interpolationFactor:_a.interpolationFactor.bind(void 0,M),zoomStops:R.map((F=>F[0])),evaluate:({zoom:F},B)=>Lb({stops:R,base:a.base},r,F).evaluate(F,B)}}if(h){const E=g==="exponential"?{name:"exponential",base:a.base!==void 0?a.base:1}:null;return{kind:"camera",interpolationType:E,interpolationFactor:_a.interpolationFactor.bind(void 0,E),zoomStops:a.stops.map((A=>A[0])),evaluate:({zoom:A})=>_(a,r,A,b,T)}}return{kind:"source",evaluate(E,A){const R=A&&A.properties?A.properties[a.property]:void 0;return R===void 0?Xd(a.default,r.default):_(a,r,R,b,T)}}}function Xd(a,r,o){return a!==void 0?a:r!==void 0?r:o!==void 0?o:void 0}function gS(a,r,o,u,h){return Xd(typeof o===h?u[o]:void 0,a.default,r.default)}function Dc(a,r,o){if(!vf(o))return Xd(a.default,r.default);const u=a.stops.length;if(u===1||o<=a.stops[0][0])return a.stops[0][1];if(o>=a.stops[u-1][0])return a.stops[u-1][1];const h=Qp(a.stops.map((g=>g[0])),o);return a.stops[h][1]}function Lb(a,r,o){const u=a.base!==void 0?a.base:1;if(!vf(o))return Xd(a.default,r.default);const h=a.stops.length;if(h===1||o<=a.stops[0][0])return a.stops[0][1];if(o>=a.stops[h-1][0])return a.stops[h-1][1];const g=Qp(a.stops.map((A=>A[0])),o),_=(function(A,R,M,F){const B=F-M,W=A-M;return B===0?0:R===1?W/B:(Math.pow(R,W)-1)/(Math.pow(R,B)-1)})(o,u,a.stops[g][0],a.stops[g+1][0]),b=a.stops[g][1],T=a.stops[g+1][1];let E=bs[r.type]||N_;if(a.colorSpace&&a.colorSpace!=="rgb"){const A=Ob[a.colorSpace];E=(R,M)=>A.reverse(A.interpolate(A.forward(R),A.forward(M),_))}return typeof b.evaluate=="function"?{evaluate(...A){const R=b.evaluate.apply(void 0,A),M=T.evaluate.apply(void 0,A);if(R!==void 0&&M!==void 0)return E(R,M,_)}}:E(b,T,_)}function _S(a,r,o){return r.type==="color"?o=Pr.parse(o):r.type==="formatted"?o=pt.fromString(o.toString()):r.type==="resolvedImage"?o=gn.build(o.toString()):Dn(o)===r.type||r.type==="enum"&&r.values[o]||(o=void 0),Xd(o,a.default,r.default)}xs.register(Zd,{error:[{kind:"error"},[Rr],(a,[r])=>{throw new Gt(r.evaluate(a))}],typeof:[Rr,[kr],(a,[r])=>fi(yr(r.evaluate(a)))],"to-rgba":[No(sn,4),[us],(a,[r])=>r.evaluate(a).toNonPremultipliedRenderColor(null).toArray()],"to-hsla":[No(sn,4),[us],(a,[r])=>r.evaluate(a).toNonPremultipliedRenderColor(null).toHslaArray()],rgb:[us,[sn,sn,sn],Db],rgba:[us,[sn,sn,sn,sn],Db],hsl:[us,[sn,sn,sn],D_],hsla:[us,[sn,sn,sn,sn],D_],has:{type:Vr,overloads:[[[Rr],(a,[r])=>L_(r.evaluate(a),a.properties())],[[Rr,Fs],(a,[r,o])=>L_(r.evaluate(a),o.evaluate(a))]]},get:{type:kr,overloads:[[[Rr],(a,[r])=>sm(r.evaluate(a),a.properties())],[[Rr,Fs],(a,[r,o])=>sm(r.evaluate(a),o.evaluate(a))]]},"feature-state":[kr,[Rr],(a,[r])=>sm(r.evaluate(a),a.featureState||{})],properties:[Fs,[],a=>a.properties()],"geometry-type":[Rr,[],a=>a.geometryType()],worldview:[Rr,[],a=>a.globals.worldview||""],id:[kr,[],a=>a.id()],zoom:[sn,[],a=>a.globals.zoom],pitch:[sn,[],a=>a.globals.pitch||0],"distance-from-center":[sn,[],a=>a.distanceFromCenter()],"measure-light":[sn,[Rr],(a,[r])=>a.measureLight(r.evaluate(a))],"heatmap-density":[sn,[],a=>a.globals.heatmapDensity||0],"line-progress":[sn,[],a=>a.globals.lineProgress||0],"raster-value":[sn,[],a=>a.globals.rasterValue||0],"raster-particle-speed":[sn,[],a=>a.globals.rasterParticleSpeed||0],"sky-radial-progress":[sn,[],a=>a.globals.skyRadialProgress||0],accumulated:[kr,[],a=>a.globals.accumulated===void 0?null:a.globals.accumulated],"+":[sn,Vu(sn),(a,r)=>{let o=0;for(const u of r)o+=u.evaluate(a);return o}],"*":[sn,Vu(sn),(a,r)=>{let o=1;for(const u of r)o*=u.evaluate(a);return o}],"-":{type:sn,overloads:[[[sn,sn],(a,[r,o])=>r.evaluate(a)-o.evaluate(a)],[[sn],(a,[r])=>-r.evaluate(a)]]},"/":[sn,[sn,sn],(a,[r,o])=>r.evaluate(a)/o.evaluate(a)],"%":[sn,[sn,sn],(a,[r,o])=>r.evaluate(a)%o.evaluate(a)],ln2:[sn,[],()=>Math.LN2],pi:[sn,[],()=>Math.PI],e:[sn,[],()=>Math.E],"^":[sn,[sn,sn],(a,[r,o])=>Math.pow(r.evaluate(a),o.evaluate(a))],sqrt:[sn,[sn],(a,[r])=>Math.sqrt(r.evaluate(a))],log10:[sn,[sn],(a,[r])=>Math.log(r.evaluate(a))/Math.LN10],ln:[sn,[sn],(a,[r])=>Math.log(r.evaluate(a))],log2:[sn,[sn],(a,[r])=>Math.log2(r.evaluate(a))],sin:[sn,[sn],(a,[r])=>Math.sin(r.evaluate(a))],cos:[sn,[sn],(a,[r])=>Math.cos(r.evaluate(a))],tan:[sn,[sn],(a,[r])=>Math.tan(r.evaluate(a))],asin:[sn,[sn],(a,[r])=>Math.asin(r.evaluate(a))],acos:[sn,[sn],(a,[r])=>Math.acos(r.evaluate(a))],atan:[sn,[sn],(a,[r])=>Math.atan(r.evaluate(a))],min:[sn,Vu(sn),(a,r)=>Math.min(...r.map((o=>o.evaluate(a))))],max:[sn,Vu(sn),(a,r)=>Math.max(...r.map((o=>o.evaluate(a))))],abs:[sn,[sn],(a,[r])=>Math.abs(r.evaluate(a))],round:[sn,[sn],(a,[r])=>{const o=r.evaluate(a);return o<0?-Math.round(-o):Math.round(o)}],floor:[sn,[sn],(a,[r])=>Math.floor(r.evaluate(a))],ceil:[sn,[sn],(a,[r])=>Math.ceil(r.evaluate(a))],"filter-==":[Vr,[Rr,kr],(a,[r,o])=>a.properties()[r.value]===o.value],"filter-id-==":[Vr,[kr],(a,[r])=>a.id()===r.value],"filter-type-==":[Vr,[Rr],(a,[r])=>a.geometryType()===r.value],"filter-<":[Vr,[Rr,kr],(a,[r,o])=>{const u=a.properties()[r.value],h=o.value;return typeof u==typeof h&&u<h}],"filter-id-<":[Vr,[kr],(a,[r])=>{const o=a.id(),u=r.value;return typeof o==typeof u&&o<u}],"filter->":[Vr,[Rr,kr],(a,[r,o])=>{const u=a.properties()[r.value],h=o.value;return typeof u==typeof h&&u>h}],"filter-id->":[Vr,[kr],(a,[r])=>{const o=a.id(),u=r.value;return typeof o==typeof u&&o>u}],"filter-<=":[Vr,[Rr,kr],(a,[r,o])=>{const u=a.properties()[r.value],h=o.value;return typeof u==typeof h&&u<=h}],"filter-id-<=":[Vr,[kr],(a,[r])=>{const o=a.id(),u=r.value;return typeof o==typeof u&&o<=u}],"filter->=":[Vr,[Rr,kr],(a,[r,o])=>{const u=a.properties()[r.value],h=o.value;return typeof u==typeof h&&u>=h}],"filter-id->=":[Vr,[kr],(a,[r])=>{const o=a.id(),u=r.value;return typeof o==typeof u&&o>=u}],"filter-has":[Vr,[kr],(a,[r])=>r.value in a.properties()],"filter-has-id":[Vr,[],a=>a.id()!==null&&a.id()!==void 0],"filter-type-in":[Vr,[No(Rr)],(a,[r])=>r.value.indexOf(a.geometryType())>=0],"filter-id-in":[Vr,[No(kr)],(a,[r])=>r.value.indexOf(a.id())>=0],"filter-in-small":[Vr,[Rr,No(kr)],(a,[r,o])=>o.value.indexOf(a.properties()[r.value])>=0],"filter-in-large":[Vr,[Rr,No(kr)],(a,[r,o])=>(function(u,h,g,_){for(;g<=_;){const b=g+_>>1;if(h[b]===u)return!0;h[b]>u?_=b-1:g=b+1}return!1})(a.properties()[r.value],o.value,0,o.value.length-1)],all:{type:Vr,overloads:[[[Vr,Vr],(a,[r,o])=>r.evaluate(a)&&o.evaluate(a)],[Vu(Vr),(a,r)=>{for(const o of r)if(!o.evaluate(a))return!1;return!0}]]},any:{type:Vr,overloads:[[[Vr,Vr],(a,[r,o])=>r.evaluate(a)||o.evaluate(a)],[Vu(Vr),(a,r)=>{for(const o of r)if(o.evaluate(a))return!0;return!1}]]},"!":[Vr,[Vr],(a,[r])=>!r.evaluate(a)],"is-supported-script":[Vr,[Rr],(a,[r])=>{const o=a.globals&&a.globals.isSupportedScript;return!o||o(r.evaluate(a))}],upcase:[Rr,[Rr],(a,[r])=>r.evaluate(a).toUpperCase()],downcase:[Rr,[Rr],(a,[r])=>r.evaluate(a).toLowerCase()],concat:[Rr,Vu(kr),(a,r)=>r.map((o=>$i(o.evaluate(a)))).join("")],"resolved-locale":[Rr,[Mu],(a,[r])=>r.evaluate(a).resolvedLocale()],random:[sn,[sn,sn,kr],(a,r)=>{const[o,u,h]=r.map((_=>_.evaluate(a)));if(o>u||o===u)return o;let g;if(typeof h=="string")g=(function(_){let b=0;if(_.length===0)return b;for(let T=0;T<_.length;T++)b=(b<<5)-b+_.charCodeAt(T),b|=0;return b})(h);else{if(typeof h!="number")throw new Gt(`Invalid seed input: ${h}`);g=h}return o+M_(g)()*(u-o)}]});class dm{constructor(r,o,u,h,g){this.expression=r,this._warningHistory={},this._evaluator=new Xl(u,h,g),this._defaultValue=o?(function(_){return _.type==="color"&&(cm(_.default)||Array.isArray(_.default))?new Pr(0,0,0,0):_.type==="color"?Pr.parse(_.default)||null:_.default===void 0?null:_.default})(o):null,this._enumValues=o&&o.type==="enum"?o.values:null,this.configDependencies=Xp(r)}evaluateWithoutErrorHandling(r,o,u,h,g,_,b,T){return this._evaluator.globals=r,this._evaluator.feature=o,this._evaluator.featureState=u,this._evaluator.canonical=h||null,this._evaluator.availableImages=g||null,this._evaluator.formattedSection=_,this._evaluator.featureTileCoord=b||null,this._evaluator.featureDistanceData=T||null,this.expression.evaluate(this._evaluator)}evaluate(r,o,u,h,g,_,b,T,E){this._evaluator.globals=r,this._evaluator.feature=o||null,this._evaluator.featureState=u||null,this._evaluator.canonical=h||null,this._evaluator.availableImages=g||null,this._evaluator.formattedSection=_||null,this._evaluator.featureTileCoord=b||null,this._evaluator.featureDistanceData=T||null,this._evaluator.iconImageUseTheme=E||null;try{const A=this.expression.evaluate(this._evaluator);if(A==null||typeof A=="number"&&A!=A)return this._defaultValue;if(this._enumValues&&!(A in this._enumValues))throw new Gt(`Expected value to be one of ${Object.keys(this._enumValues).map((R=>JSON.stringify(R))).join(", ")}, but found ${JSON.stringify(A)} instead.`);return A}catch(A){return this._warningHistory[A.message]||(this._warningHistory[A.message]=!0,typeof console<"u"&&console.warn(`Failed to evaluate expression "${JSON.stringify(this.expression.serialize())}". ${A.message}`)),this._defaultValue}}}function V_(a){return Array.isArray(a)&&a.length>0&&typeof a[0]=="string"&&a[0]in Zd}function Sl(a,r,o,u,h){const g=new Jp(Zd,[],r?(function(b){const T={color:us,string:Rr,number:sn,enum:Rr,boolean:Vr,formatted:Xa,resolvedImage:Ic};return b.type==="array"?No(T[b.value]||kr,b.length):T[b.type]})(r):void 0,void 0,void 0,o,u,h),_=g.parse(a,void 0,void 0,void 0,r&&r.type==="string"?{typeAnnotation:"coerce"}:void 0);return _?$u(new dm(_,r,o,u,h)):Mc(g.errors)}class Af{constructor(r,o,u,h){this.kind=r,this._styleExpression=o,this.isLightConstant=u,this.isLineProgressConstant=h,this.isStateDependent=r!=="constant"&&!Zp(o.expression),this.configDependencies=Xp(o.expression)}evaluateWithoutErrorHandling(r,o,u,h,g,_){return this._styleExpression.evaluateWithoutErrorHandling(r,o,u,h,g,_)}evaluate(r,o,u,h,g,_,b){return this._styleExpression.evaluate(r,o,u,h,g,_,void 0,void 0,b)}}class Lc{constructor(r,o,u,h,g,_){this.kind=r,this.zoomStops=u,this._styleExpression=o,this.isStateDependent=r!=="camera"&&!Zp(o.expression),this.isLightConstant=g,this.isLineProgressConstant=_,this.configDependencies=Xp(o.expression),this.interpolationType=h}evaluateWithoutErrorHandling(r,o,u,h,g,_){return this._styleExpression.evaluateWithoutErrorHandling(r,o,u,h,g,_)}evaluate(r,o,u,h,g,_){return this._styleExpression.evaluate(r,o,u,h,g,_)}interpolationFactor(r,o,u){return this.interpolationType?_a.interpolationFactor(this.interpolationType,r,o,u):0}}function $_(a,r,o,u,h){if((a=Sl(a,r,o,u,h)).result==="error")return a;const g=a.value.expression,_=Hd(g);if(!_&&!am(r))return Mc([new Ks("","data expressions not supported")]);const b=Wd(g,["zoom","pitch","distance-from-center"]);if(!b&&!B_(r))return Mc([new Ks("","zoom expressions not supported")]);const T=Wd(g,["measure-light"]);if(!T&&!F_(r))return Mc([new Ks("","measure-light expression not supported")]);const E=Wd(g,["line-progress"]);if(!E&&!(function(M){return z_(M.expression,"line-progress")})(r))return Mc([new Ks("","line-progress expression not supported")]);const A=r.expression&&r.expression.relaxZoomRestriction,R=fm(g);return R||b||A?R instanceof Ks?Mc([R]):R instanceof _a&&!lm(r)?Mc([new Ks("",'"interpolate" expressions cannot be used with this property')]):$u(R?new Lc(_&&E?"camera":"composite",a.value,R.labels,R instanceof _a?R.interpolation:void 0,T,E):new Af(_&&E?"constant":"source",a.value,T,E)):Mc([new Ks("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression, or in the properties of atmosphere.')])}class hm{constructor(r,o){this._parameters=r,this._specification=o,Object.assign(this,um(this._parameters,this._specification))}static deserialize(r){return new hm(r._parameters,r._specification)}static serialize(r){return{_parameters:r._parameters,_specification:r._specification}}}function fm(a){let r=null;if(a instanceof rm)r=fm(a.result);else if(a instanceof Ef){for(const o of a.args)if(r=fm(o),r)break}else(a instanceof Sf||a instanceof _a)&&a.input instanceof xs&&a.input.name==="zoom"&&(r=a);return r instanceof Ks||a.eachChild((o=>{const u=fm(o);u instanceof Ks?r=u:r&&u&&r!==u&&(r=new Ks("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))})),r}var Pf,pm,zb=(function(){if(pm)return Pf;pm=1,Pf=r;var a=3;function r(o,u,h){var g=this.cells=[];if(o instanceof ArrayBuffer){this.arrayBuffer=o;var _=new Int32Array(this.arrayBuffer);o=_[0],this.d=(u=_[1])+2*(h=_[2]);for(var b=0;b<this.d*this.d;b++){var T=_[a+b],E=_[a+b+1];g.push(T===E?null:_.subarray(T,E))}var A=_[a+g.length+1];this.keys=_.subarray(_[a+g.length],A),this.bboxes=_.subarray(A),this.insert=this._insertReadonly}else{this.d=u+2*h;for(var R=0;R<this.d*this.d;R++)g.push([]);this.keys=[],this.bboxes=[]}this.n=u,this.extent=o,this.padding=h,this.scale=u/o,this.uid=0;var M=h/u*o;this.min=-M,this.max=o+M}return r.prototype.insert=function(o,u,h,g,_){this._forEachCell(u,h,g,_,this._insertCell,this.uid++),this.keys.push(o),this.bboxes.push(u),this.bboxes.push(h),this.bboxes.push(g),this.bboxes.push(_)},r.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},r.prototype._insertCell=function(o,u,h,g,_,b){this.cells[_].push(b)},r.prototype.query=function(o,u,h,g,_){var b=this.min,T=this.max;if(o<=b&&u<=b&&T<=h&&T<=g&&!_)return Array.prototype.slice.call(this.keys);var E=[];return this._forEachCell(o,u,h,g,this._queryCell,E,{},_),E},r.prototype._queryCell=function(o,u,h,g,_,b,T,E){var A=this.cells[_];if(A!==null)for(var R=this.keys,M=this.bboxes,F=0;F<A.length;F++){var B=A[F];if(T[B]===void 0){var W=4*B;(E?E(M[W+0],M[W+1],M[W+2],M[W+3]):o<=M[W+2]&&u<=M[W+3]&&h>=M[W+0]&&g>=M[W+1])?(T[B]=!0,b.push(R[B])):T[B]=!1}}},r.prototype._forEachCell=function(o,u,h,g,_,b,T,E){for(var A=this._convertToCellCoord(o),R=this._convertToCellCoord(u),M=this._convertToCellCoord(h),F=this._convertToCellCoord(g),B=A;B<=M;B++)for(var W=R;W<=F;W++){var q=this.d*W+B;if((!E||E(this._convertFromCellCoord(B),this._convertFromCellCoord(W),this._convertFromCellCoord(B+1),this._convertFromCellCoord(W+1)))&&_.call(this,o,u,h,g,q,b,T,E))return}},r.prototype._convertFromCellCoord=function(o){return(o-this.padding)/this.scale},r.prototype._convertToCellCoord=function(o){return Math.max(0,Math.min(this.d-1,Math.floor(o*this.scale)+this.padding))},r.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var o=this.cells,u=a+this.cells.length+1+1,h=0,g=0;g<this.cells.length;g++)h+=this.cells[g].length;var _=new Int32Array(u+h+this.keys.length+this.bboxes.length);_[0]=this.extent,_[1]=this.n,_[2]=this.padding;for(var b=u,T=0;T<o.length;T++){var E=o[T];_[a+T]=b,_.set(E,b),b+=E.length}return _[a+o.length]=b,_.set(this.keys,b),_[a+o.length+1]=b+=this.keys.length,_.set(this.bboxes,b),b+=this.bboxes.length,_.buffer},Pf})(),Uu=Ul(zb);const Yd={};function Wt(a,r,o={}){Object.defineProperty(a,"_classRegistryKey",{value:r,writable:!1}),Yd[r]={klass:a,omit:o.omit||[]}}Wt(Object,"Object"),Uu.serialize=function(a,r){const o=a.toArrayBuffer();return r&&r.add(o),{buffer:o}},Uu.deserialize=function(a){return new Uu(a.buffer)},Object.defineProperty(Uu,"name",{value:"Grid"}),Wt(Uu,"Grid"),delete xt.prototype.constructor,typeof DOMMatrix<"u"&&Wt(DOMMatrix,"DOMMatrix"),Wt(Pr,"Color"),Wt(Error,"Error"),Wt(pt,"Formatted"),Wt(Ee,"FormattedSection"),Wt(gf,"AJAXError"),Wt(gn,"ResolvedImage"),Wt(hm,"StylePropertyFunction"),Wt(dm,"StyleExpression",{omit:["_evaluator"]}),Wt(zs,"ImageId"),Wt(Ft,"ImageVariant"),Wt(Lc,"ZoomDependentExpression"),Wt(Af,"ZoomConstantExpression"),Wt(xs,"CompoundExpression",{omit:["_evaluate"]});for(const a in Zd)Yd[Zd[a]._classRegistryKey]||Wt(Zd[a],`Expression${a}`);function U_(a){return a&&typeof ArrayBuffer<"u"&&(a instanceof ArrayBuffer||a.constructor&&a.constructor.name==="ArrayBuffer")}function Yl(a){return self.ImageBitmap&&a instanceof ImageBitmap}function zc(a,r){if(a==null||typeof a=="boolean"||typeof a=="number"||typeof a=="string"||a instanceof Boolean||a instanceof Number||a instanceof String||a instanceof Date||a instanceof RegExp)return a;if(U_(a)||Yl(a))return r&&r.add(a),a;if(ArrayBuffer.isView(a))return r&&r.add(a.buffer),a;if(a instanceof ImageData)return r&&r.add(a.data.buffer),a;if(Array.isArray(a)){const o=[];for(const u of a)o.push(zc(u,r));return o}if(a instanceof Map){const o={$name:"Map",entries:[]};for(const[u,h]of a.entries())o.entries.push(zc(u),zc(h,r));return o}if(a instanceof Set){const o={$name:"Set"};let u=0;for(const h of a.values())o[++u]=zc(h);return o}if(a instanceof DOMMatrix){const o={$name:"DOMMatrix"},u=["is2D","m11","m12","m13","m14","m21","m22","m23","m24","m31","m32","m33","m34","m41","m42","m43","m44","a","b","c","d","e","f"];for(const h of u)o[h]=a[h];return o}if(typeof a=="bigint")return{$name:"BigInt",value:a.toString()};if(typeof a=="object"){const o=a.constructor,u=o._classRegistryKey;if(!u)throw new Error(`Can't serialize object of unregistered class "${o.name}".`);const h=o.serialize?o.serialize(a,r):{};if(!o.serialize){for(const g in a)a.hasOwnProperty(g)&&(Yd[u].omit.indexOf(g)>=0||(h[g]=zc(a[g],r)));a instanceof Error&&(h.message=a.message)}if(h.$name)throw new Error("$name property is reserved for worker serialization logic.");return u!=="Object"&&(h.$name=u),h}throw new Error("can't serialize object of type "+typeof a)}function Fc(a){if(a==null||typeof a=="boolean"||typeof a=="number"||typeof a=="string"||a instanceof Boolean||a instanceof Number||a instanceof String||a instanceof Date||a instanceof RegExp||U_(a)||Yl(a)||ArrayBuffer.isView(a)||a instanceof ImageData)return a;if(Array.isArray(a))return a.map(Fc);if(typeof a=="object"){const r=a.$name||"Object";if(r==="Map"){const h=a.entries||[],g=new Map;for(let _=0;_<h.length;_+=2)g.set(Fc(h[_]),Fc(h[_+1]));return g}if(r==="Set"){const h=new Set;for(const g of Object.keys(a))g!=="$name"&&h.add(Fc(a[g]));return h}if(r==="DOMMatrix"){let h;return h=a.is2D?[a.a,a.b,a.c,a.d,a.e,a.f]:[a.m11,a.m12,a.m13,a.m14,a.m21,a.m22,a.m23,a.m24,a.m31,a.m32,a.m33,a.m34,a.m41,a.m42,a.m43,a.m44],new DOMMatrix(h)}if(r==="BigInt")return BigInt(a.value);const{klass:o}=Yd[r];if(!o)throw new Error(`Can't deserialize unregistered class "${r}".`);if(o.deserialize)return o.deserialize(a);const u=Object.create(o.prototype);for(const h of Object.keys(a))h!=="$name"&&(u[h]=Fc(a[h]));return u}throw new Error("can't deserialize object of type "+typeof a)}const Cn={"Latin-1 Supplement":a=>a>=128&&a<=255,Arabic:a=>a>=1536&&a<=1791,"Arabic Supplement":a=>a>=1872&&a<=1919,"Arabic Extended-A":a=>a>=2208&&a<=2303,"Hangul Jamo":a=>a>=4352&&a<=4607,"Unified Canadian Aboriginal Syllabics":a=>a>=5120&&a<=5759,Khmer:a=>a>=6016&&a<=6143,"Unified Canadian Aboriginal Syllabics Extended":a=>a>=6320&&a<=6399,"General Punctuation":a=>a>=8192&&a<=8303,"Letterlike Symbols":a=>a>=8448&&a<=8527,"Number Forms":a=>a>=8528&&a<=8591,"Miscellaneous Technical":a=>a>=8960&&a<=9215,"Control Pictures":a=>a>=9216&&a<=9279,"Optical Character Recognition":a=>a>=9280&&a<=9311,"Enclosed Alphanumerics":a=>a>=9312&&a<=9471,"Geometric Shapes":a=>a>=9632&&a<=9727,"Miscellaneous Symbols":a=>a>=9728&&a<=9983,"Miscellaneous Symbols and Arrows":a=>a>=11008&&a<=11263,"CJK Radicals Supplement":a=>a>=11904&&a<=12031,"Kangxi Radicals":a=>a>=12032&&a<=12255,"Ideographic Description Characters":a=>a>=12272&&a<=12287,"CJK Symbols and Punctuation":a=>a>=12288&&a<=12351,Hiragana:a=>a>=12352&&a<=12447,Katakana:a=>a>=12448&&a<=12543,Bopomofo:a=>a>=12544&&a<=12591,"Hangul Compatibility Jamo":a=>a>=12592&&a<=12687,Kanbun:a=>a>=12688&&a<=12703,"Bopomofo Extended":a=>a>=12704&&a<=12735,"CJK Strokes":a=>a>=12736&&a<=12783,"Katakana Phonetic Extensions":a=>a>=12784&&a<=12799,"Enclosed CJK Letters and Months":a=>a>=12800&&a<=13055,"CJK Compatibility":a=>a>=13056&&a<=13311,"CJK Unified Ideographs Extension A":a=>a>=13312&&a<=19903,"Yijing Hexagram Symbols":a=>a>=19904&&a<=19967,"CJK Unified Ideographs":a=>a>=19968&&a<=40959,"Yi Syllables":a=>a>=40960&&a<=42127,"Yi Radicals":a=>a>=42128&&a<=42191,"Hangul Jamo Extended-A":a=>a>=43360&&a<=43391,"Hangul Syllables":a=>a>=44032&&a<=55215,"Hangul Jamo Extended-B":a=>a>=55216&&a<=55295,"Private Use Area":a=>a>=57344&&a<=63743,"CJK Compatibility Ideographs":a=>a>=63744&&a<=64255,"Arabic Presentation Forms-A":a=>a>=64336&&a<=65023,"Vertical Forms":a=>a>=65040&&a<=65055,"CJK Compatibility Forms":a=>a>=65072&&a<=65103,"Small Form Variants":a=>a>=65104&&a<=65135,"Arabic Presentation Forms-B":a=>a>=65136&&a<=65279,"Halfwidth and Fullwidth Forms":a=>a>=65280&&a<=65519,Osage:a=>a>=66736&&a<=66815,"CJK Unified Ideographs Extension B":a=>a>=131072&&a<=173791};function j_(a){for(const r of a)if(gm(r.charCodeAt(0)))return!0;return!1}function Fb(a){for(const r of a)if(!mm(r.charCodeAt(0)))return!1;return!0}function mm(a){return!(Cn.Arabic(a)||Cn["Arabic Supplement"](a)||Cn["Arabic Extended-A"](a)||Cn["Arabic Presentation Forms-A"](a)||Cn["Arabic Presentation Forms-B"](a))}function gm(a){return!(a!==746&&a!==747&&(a<4352||!(Cn["Bopomofo Extended"](a)||Cn.Bopomofo(a)||Cn["CJK Compatibility Forms"](a)&&!(a>=65097&&a<=65103)||Cn["CJK Compatibility Ideographs"](a)||Cn["CJK Compatibility"](a)||Cn["CJK Radicals Supplement"](a)||Cn["CJK Strokes"](a)||!(!Cn["CJK Symbols and Punctuation"](a)||a>=12296&&a<=12305||a>=12308&&a<=12319||a===12336)||Cn["CJK Unified Ideographs Extension A"](a)||Cn["CJK Unified Ideographs"](a)||Cn["Enclosed CJK Letters and Months"](a)||Cn["Hangul Compatibility Jamo"](a)||Cn["Hangul Jamo Extended-A"](a)||Cn["Hangul Jamo Extended-B"](a)||Cn["Hangul Jamo"](a)||Cn["Hangul Syllables"](a)||Cn.Hiragana(a)||Cn["Ideographic Description Characters"](a)||Cn.Kanbun(a)||Cn["Kangxi Radicals"](a)||Cn["Katakana Phonetic Extensions"](a)||Cn.Katakana(a)&&a!==12540||!(!Cn["Halfwidth and Fullwidth Forms"](a)||a===65288||a===65289||a===65293||a>=65306&&a<=65310||a===65339||a===65341||a===65343||a>=65371&&a<=65503||a===65507||a>=65512&&a<=65519)||!(!Cn["Small Form Variants"](a)||a>=65112&&a<=65118||a>=65123&&a<=65126)||Cn["Unified Canadian Aboriginal Syllabics"](a)||Cn["Unified Canadian Aboriginal Syllabics Extended"](a)||Cn["Vertical Forms"](a)||Cn["Yijing Hexagram Symbols"](a)||Cn["Yi Syllables"](a)||Cn["Yi Radicals"](a))))}function _m(a){return!(gm(a)||(function(r){return!!(Cn["Latin-1 Supplement"](r)&&(r===167||r===169||r===174||r===177||r===188||r===189||r===190||r===215||r===247)||Cn["General Punctuation"](r)&&(r===8214||r===8224||r===8225||r===8240||r===8241||r===8251||r===8252||r===8258||r===8263||r===8264||r===8265||r===8273)||Cn["Letterlike Symbols"](r)||Cn["Number Forms"](r)||Cn["Miscellaneous Technical"](r)&&(r>=8960&&r<=8967||r>=8972&&r<=8991||r>=8996&&r<=9e3||r===9003||r>=9085&&r<=9114||r>=9150&&r<=9165||r===9167||r>=9169&&r<=9179||r>=9186&&r<=9215)||Cn["Control Pictures"](r)&&r!==9251||Cn["Optical Character Recognition"](r)||Cn["Enclosed Alphanumerics"](r)||Cn["Geometric Shapes"](r)||Cn["Miscellaneous Symbols"](r)&&!(r>=9754&&r<=9759)||Cn["Miscellaneous Symbols and Arrows"](r)&&(r>=11026&&r<=11055||r>=11088&&r<=11097||r>=11192&&r<=11243)||Cn["CJK Symbols and Punctuation"](r)||Cn.Katakana(r)||Cn["Private Use Area"](r)||Cn["CJK Compatibility Forms"](r)||Cn["Small Form Variants"](r)||Cn["Halfwidth and Fullwidth Forms"](r)||r===8734||r===8756||r===8757||r>=9984&&r<=10087||r>=10102&&r<=10131||r===65532||r===65533)})(a))}function yS(a){return Cn.Arabic(a)||Cn["Arabic Supplement"](a)||Cn["Arabic Extended-A"](a)||Cn["Arabic Presentation Forms-A"](a)||Cn["Arabic Presentation Forms-B"](a)}function Bb(a){return a>=1424&&a<=2303||Cn["Arabic Presentation Forms-A"](a)||Cn["Arabic Presentation Forms-B"](a)}function vS(a,r){return!(!r&&Bb(a)||a>=2304&&a<=3583||a>=3840&&a<=4255||Cn.Khmer(a))}function bS(a){for(const r of a)if(Bb(r.charCodeAt(0)))return!0;return!1}const Xs={unavailable:"unavailable",deferred:"deferred",loading:"loading",parsing:"parsing",parsed:"parsed",loaded:"loaded",error:"error"};let G_=null,ws=Xs.unavailable,Bc=null;const Nb=function(a){a&&typeof a=="string"&&a.indexOf("NetworkError")>-1&&(ws=Xs.error),G_&&G_(a)};function H_(){W_.fire(new qs("pluginStateChange",{pluginStatus:ws,pluginURL:Bc}))}const W_=new xl,ym=function(){return ws},ju=function(){if(ws!==Xs.deferred||!Bc)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");ws=Xs.loading,H_(),Bc&&Ec({url:Bc},(a=>{a?Nb(a):(ws=Xs.loaded,H_())}))},El={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>ws===Xs.loaded||El.applyArabicShaping!=null,isLoading:()=>ws===Xs.loading,setState(a){ws=a.pluginStatus,Bc=a.pluginURL},isParsing:()=>ws===Xs.parsing,isParsed:()=>ws===Xs.parsed,getPluginURL:()=>Bc};class pi{constructor(r,o){this.zoom=r,o?(this.now=o.now,this.fadeDuration=o.fadeDuration,this.transition=o.transition,this.pitch=o.pitch,this.brightness=o.brightness,this.worldview=o.worldview):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0,this.brightness=0)}isSupportedScript(r){return(function(o,u){for(const h of o)if(!vS(h.charCodeAt(0),u))return!1;return!0})(r,El.isLoaded())}}class Gu{constructor(r,o,u,h,g){this.property=r,this.value=o,this.expression=(function(_,b,T,E,A){if(cm(_))return new hm(_,b);if(V_(_)||Array.isArray(_)&&_.length>0){const R=$_(_,b,T,E,A);if(R.result==="error")throw new Error(R.value.map((M=>`${M.key}: ${M.message}`)).join(", "));return R.value}{let R=_;return typeof _=="string"&&b.type==="color"&&(R=Pr.parse(_)),{kind:"constant",configDependencies:new Set,evaluate:()=>R}}})(o===void 0?r.specification.default:o,r.specification,u,h,g)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(r,o,u,h){return this.property.possiblyEvaluate(this,r,o,u,h)}}class q_{constructor(r,o,u,h){this.property=r,this.value=new Gu(r,void 0,o,u,h)}transitioned(r,o){return new Jl(this.property,this.value,o,Object.assign({},r.transition,this.transition),r.now)}untransitioned(){return new Jl(this.property,this.value,null,{},0)}}class Vb{constructor(r,o,u,h){this._properties=r,this._values=Object.create(r.defaultTransitionablePropertyValues),this._scope=o,this._options=u,this._iconImageUseTheme=h,this.configDependencies=new Set}getValue(r){return Yn(this._values[r].value.value)}setValue(r,o){this._values.hasOwnProperty(r)||(this._values[r]=new q_(this._values[r].property,this._scope,this._options,this._iconImageUseTheme)),this._values[r].value=new Gu(this._values[r].property,o===null?void 0:Yn(o),this._scope,this._options,this._iconImageUseTheme),this._values[r].value.expression.configDependencies&&(this.configDependencies=new Set([...this.configDependencies,...this._values[r].value.expression.configDependencies]))}setTransitionOrValue(r,o){o&&(this._options=o);const u=this._properties.properties;if(r)for(const h in r){const g=r[h];if(h.endsWith("-transition")){const _=h.slice(0,-11);u[_]&&this.setTransition(_,g)}else u.hasOwnProperty(h)&&this.setValue(h,g)}}getTransition(r){return Yn(this._values[r].transition)}setTransition(r,o){this._values.hasOwnProperty(r)||(this._values[r]=new q_(this._values[r].property)),this._values[r].transition=Yn(o)||void 0}serialize(){const r={};for(const o of Object.keys(this._values)){const u=this.getValue(o);u!==void 0&&(r[o]=u);const h=this.getTransition(o);h!==void 0&&(r[`${o}-transition`]=h)}return r}transitioned(r,o){const u=new K_(this._properties);for(const h of Object.keys(this._values))u._values[h]=this._values[h].transitioned(r,o._values[h]);return u}untransitioned(){const r=new K_(this._properties);for(const o of Object.keys(this._values))r._values[o]=this._values[o].untransitioned();return r}}class Jl{constructor(r,o,u,h,g){const _=h.delay||0,b=h.duration||0;g=g||0,this.property=r,this.value=o,this.begin=g+_,this.end=this.begin+b,r.specification.transition&&(h.delay||h.duration)&&(this.prior=u)}possiblyEvaluate(r,o,u){const h=r.now||0,g=this.value.possiblyEvaluate(r,o,u),_=this.prior;if(_){if(h>this.end)return this.prior=null,g;if(this.value.isDataDriven())return this.prior=null,g;if(h<this.begin)return _.possiblyEvaluate(r,o,u);{const b=(h-this.begin)/(this.end-this.begin);return this.property.interpolate(_.possiblyEvaluate(r,o,u),g,ce(b))}}return g}}class K_{constructor(r){this._properties=r,this._values=Object.create(r.defaultTransitioningPropertyValues)}possiblyEvaluate(r,o,u){const h=new qu(this._properties);for(const g of Object.keys(this._values))h._values[g]=this._values[g].possiblyEvaluate(r,o,u);return h}hasTransition(){for(const r of Object.keys(this._values))if(this._values[r].prior)return!0;return!1}}class Hu{constructor(r,o,u,h){this._properties=r,this._values=Object.create(r.defaultPropertyValues),this._scope=o,this._options=u,this._iconImageUseTheme=h,this.configDependencies=new Set}getValue(r){return Yn(this._values[r].value)}setValue(r,o){this._values[r]=new Gu(this._values[r].property,o===null?void 0:Yn(o),this._scope,this._options,this._iconImageUseTheme),this._values[r].expression.configDependencies&&(this.configDependencies=new Set([...this.configDependencies,...this._values[r].expression.configDependencies]))}serialize(){const r={};for(const o of Object.keys(this._values)){const u=this.getValue(o);u!==void 0&&(r[o]=u)}return r}possiblyEvaluate(r,o,u,h){const g=new qu(this._properties);for(const _ of Object.keys(this._values))g._values[_]=this._values[_].possiblyEvaluate(r,o,u,h);return g}}class Wu{constructor(r,o,u,h){this.property=r,this.value=o,this.parameters=u,this.iconImageUseTheme=h}isConstant(){return this.value.kind==="constant"}constantOr(r){return this.value.kind==="constant"?this.value.value:r}evaluate(r,o,u,h){return this.property.evaluate(this.value,this.parameters,r,o,u,h,this.iconImageUseTheme)}}class qu{constructor(r){this._properties=r,this._values=Object.create(r.defaultPossiblyEvaluatedValues)}get(r){return this._values[r]}}class It{constructor(r){this.specification=r}possiblyEvaluate(r,o){return r.expression.evaluate(o)}interpolate(r,o,u){const h=bs[this.specification.type];return h?h(r,o,u):r}}class $t{constructor(r,o){this.specification=r,this.overrides=o}possiblyEvaluate(r,o,u,h,g){return r.expression.kind==="constant"||r.expression.kind==="camera"?new Wu(this,{kind:"constant",value:r.expression.evaluate(o,null,{},u,h,void 0,g)},o):new Wu(this,r.expression,o,g)}interpolate(r,o,u){if(r.value.kind!=="constant"||o.value.kind!=="constant")return r;if(r.value.value===void 0||o.value.value===void 0)return new Wu(this,{kind:"constant",value:void 0},r.parameters);const h=bs[this.specification.type];return h?new Wu(this,{kind:"constant",value:h(r.value.value,o.value.value,u)},r.parameters):r}evaluate(r,o,u,h,g,_,b){return r.kind==="constant"?r.value:r.evaluate(o,u,h,g,_,void 0,b)}}class Jd{constructor(r){this.specification=r}possiblyEvaluate(r,o,u,h){return!!r.expression.evaluate(o,null,{},u,h)}interpolate(){return!1}}class Wi{constructor(r){this.properties=r,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const o=new pi(0,{});for(const u in r){const h=r[u];h.specification.overridable&&this.overridableProperties.push(u);const g=this.defaultPropertyValues[u]=new Gu(h,void 0),_=this.defaultTransitionablePropertyValues[u]=new q_(h);this.defaultTransitioningPropertyValues[u]=_.untransitioned(),this.defaultPossiblyEvaluatedValues[u]=g.possiblyEvaluate(o)}}}Wt($t,"DataDrivenProperty"),Wt(It,"DataConstantProperty"),Wt(Jd,"ColorRampProperty");var $e=JSON.parse('{"$version":8,"$root":{"version":{"type":"enum","values":[8]},"fragment":{"type":"boolean"},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360},"pitch":{"type":"number","default":0},"light":{"type":"light"},"lights":{"type":"array","value":"light-3d"},"terrain":{"type":"terrain","optional":true},"fog":{"type":"fog"},"snow":{"type":"snow"},"rain":{"type":"rain"},"camera":{"type":"camera"},"color-theme":{"type":"colorTheme"},"indoor":{"type":"indoor"},"imports":{"type":"array","value":"import"},"iconsets":{"type":"iconsets"},"schema":{"type":"schema"},"sources":{"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string","default":"mapbox://fonts/mapbox/{fontstack}/{range}.pbf"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"type":"array","value":"layer"},"models":{"type":"models"},"featuresets":{"type":"featuresets"}},"featuresets":{"*":{"type":"featureset"}},"featureset":{"metadata":{"type":"*"},"selectors":{"type":"array","value":"selector"}},"selector":{"layer":{"type":"string"},"properties":{"type":"selectorProperty"},"featureNamespace":{"type":"string"},"_uniqueFeatureID":{"type":"boolean"}},"selectorProperty":{"*":{"type":"*"}},"model":{"type":"string"},"import":{"id":{"type":"string"},"url":{"type":"string"},"config":{"type":"config"},"data":{"type":"$root"},"color-theme":{"type":"colorTheme","optional":true}},"config":{"*":{"type":"*"}},"schema":{"*":{"type":"option"}},"option":{"default":{"type":"*","expression":{}},"type":{"type":"enum","values":{"string":1,"number":1,"boolean":1,"color":1}},"array":{"type":"boolean"},"minValue":{"type":"number"},"maxValue":{"type":"number"},"stepValue":{"type":"number"},"values":{"type":"array","value":"*"},"metadata":{"type":"*"}},"models":{"*":{"type":"model"}},"light-3d":{"id":{"type":"string"},"properties":{"type":"properties"},"type":{"type":"enum","values":{"ambient":{},"directional":{},"flat":{}}}},"properties":["properties_light_directional","properties_light_ambient","properties_light_flat"],"properties_light_directional":{"direction":{"type":"array","default":[210,30],"minimum":[0,0],"maximum":[360,90],"length":2,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"use-theme":true,"transition":true},"intensity":{"type":"number","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"cast-shadows":{"type":"boolean","default":false},"shadow-quality":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"parameters":["zoom"]}},"shadow-intensity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_ambient":{"color":{"type":"color","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"use-theme":true,"transition":true},"intensity":{"type":"number","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_flat":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"use-theme":true,"transition":true},"intensity":{"type":"number","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"iconsets":{"*":{"type":"iconset"}},"iconset":["iconset_sprite","iconset_source"],"iconset_sprite":{"type":{"type":"enum","values":{"sprite":1}},"url":{"type":"string"}},"iconset_source":{"type":{"type":"enum","values":{"source":1}},"source":{"type":"string"}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_raster_array","source_geojson","source_video","source_image","source_model"],"source_vector":{"type":{"type":"enum","values":{"vector":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"extra_bounds":{"type":"array","value":{"type":"array","value":"number","length":4}},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"type":"enum","values":{"raster":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"extra_bounds":{"type":"array","value":{"type":"array","value":"number","length":4}},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"type":"enum","values":{"raster-dem":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"extra_bounds":{"type":"array","value":{"type":"array","value":"number","length":4}},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":1,"mapbox":1},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_array":{"type":{"type":"enum","values":{"raster-array":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"extra_bounds":{"type":"array","value":{"type":"array","value":"number","length":4}},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"attribution":{"type":"string"},"rasterLayers":{"type":"*"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"type":"enum","values":{"geojson":1}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"minzoom":{"type":"number","default":0},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"},"dynamic":{"type":"boolean","default":false}},"source_video":{"type":{"type":"enum","values":{"video":1}},"urls":{"type":"array","value":"string"},"coordinates":{"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"type":"enum","values":{"image":1}},"url":{"type":"string"},"coordinates":{"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"modelNodeOverride":{"orientation":{"type":"array","value":"number","length":3,"default":[0,0,0],"period":360}},"modelNodeOverrides":{"*":{"type":"modelNodeOverride"}},"modelMaterialOverride":{"model-color":{"type":"color"},"model-color-mix-intensity":{"type":"number"},"model-opacity":{"type":"number"},"model-emissive-strength":{"type":"number"}},"modelMaterialOverrides":{"*":{"type":"modelMaterialOverride"}},"modelSourceModel":{"uri":{"type":"string"},"position":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[-180,-90],"maximum":[180,90]},"orientation":{"type":"array","value":"number","length":3,"default":[0,0,0],"period":360},"nodeOverrides":{"type":"modelNodeOverrides"},"materialOverrides":{"type":"modelMaterialOverrides"},"nodeOverrideNames":{"type":"array","value":"string"},"materialOverrideNames":{"type":"array","value":"string"},"featureProperties":{"type":"*"}},"modelSourceModels":{"*":{"type":"modelSourceModel"}},"source_model":{"type":{"type":"enum","values":{"model":1,"batched-model":1}},"maxzoom":{"type":"number","default":18},"minzoom":{"type":"number","default":0},"tiles":{"type":"array","value":"string"},"models":{"type":"modelSourceModels"}},"layer":{"id":{"type":"string"},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"building":{},"raster":{},"raster-particle":{},"hillshade":{},"model":{},"background":{},"sky":{},"slot":{},"clip":{}}},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"slot":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"},"appearances":{"type":"array","value":"appearance","supported-layer-types":["symbol"]}},"appearance":{"condition":{"type":"boolean","expression":{"parameters":["zoom","pitch","feature","feature-state","measure-light","distance-from-center"]},"property-type":"data-driven"},"name":{"type":"string"},"properties":{"type":"*"}},"layout":["layout_clip","layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_building","layout_symbol","layout_raster","layout_raster-particle","layout_hillshade","layout_background","layout_sky","layout_model"],"layout_background":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"layout_model":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}},"model-id":{"type":"string","default":"","property-type":"data-driven","expression":{"parameters":["zoom","feature"]}}},"layout_clip":{"clip-layer-types":{"type":"array","value":"enum","values":{"model":1,"symbol":1},"default":[],"expression":{}},"clip-layer-scope":{"type":"array","value":"string","default":[],"expression":{}}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}},"fill-elevation-reference":{"type":"enum","values":{"none":1,"hd-road-base":1,"hd-road-markup":1},"default":"none","expression":{}},"fill-construct-bridge-guard-rail":{"type":"boolean","default":"true","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"circle-elevation-reference":{"type":"enum","values":{"none":1,"hd-road-markup":1},"default":"none","expression":{}},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}},"fill-extrusion-edge-radius":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{}}},"layout_building":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}},"building-facade":{"type":"boolean","default":false,"expression":{"parameters":["feature"]},"property-type":"data-driven"},"building-facade-floors":{"type":"number","minimum":1,"maximum":200,"default":3,"property-type":"data-driven","expression":{"parameters":["feature"]}},"building-facade-unit-width":{"type":"number","minimum":1,"maximum":20,"default":3.1,"property-type":"data-driven","expression":{"parameters":["feature"]}},"building-facade-window":{"type":"array","length":2,"value":"number","minimum":0.1,"maximum":1,"default":[0.9,0.9],"property-type":"data-driven","expression":{"parameters":["feature"]}},"building-roof-shape":{"type":"enum","values":{"flat":1,"hipped":1,"gabled":1,"parapet":1,"mansard":1,"skillion":1,"pyramidal":1},"default":"flat","expression":{"parameters":["feature"]},"property-type":"data-driven"},"building-height":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{},"property-type":"data-driven"},"building-base":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{},"property-type":"data-driven"},"building-flood-light-wall-radius":{"property-type":"data-driven","type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"building-flood-light-ground-radius":{"property-type":"data-driven","type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"building-flip-roof-orientation":{"property-type":"data-driven","type":"boolean","default":false,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":1,"round":1,"square":1},"default":"butt","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":1,"round":1,"miter":1,"none":1},"default":"miter","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"expression":{"interpolated":true,"parameters":["zoom"]}},"line-round-limit":{"type":"number","default":1.05,"expression":{"interpolated":true,"parameters":["zoom"]}},"line-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-z-offset":{"type":"number","default":0,"expression":{"parameters":["zoom","feature","line-progress"]},"property-type":"data-driven"},"line-elevation-reference":{"type":"enum","values":{"none":1,"sea":1,"ground":1,"hd-road-markup":1},"default":"none","expression":{}},"line-cross-slope":{"type":"number","expression":{}},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}},"line-width-unit":{"type":"enum","values":{"pixels":1,"meters":1},"default":"pixels","expression":{"parameters":["zoom"]}}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":1,"line":1,"line-center":1},"default":"point","expression":{"parameters":["zoom"]}},"symbol-spacing":{"type":"number","default":250,"minimum":1,"expression":{"interpolated":true,"parameters":["zoom"]}},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"symbol-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":1,"viewport-y":1,"source":1},"default":"auto","expression":{"parameters":["zoom"]}},"symbol-z-elevate":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"symbol-elevation-reference":{"type":"enum","values":{"sea":1,"ground":1,"hd-road-markup":1},"default":"ground","expression":{"parameters":["zoom"]}},"icon-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"icon-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"icon-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"icon-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]}},"icon-size":{"type":"number","default":1,"minimum":0,"appearance":true,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-size-scale-range":{"type":"array","value":"number","length":2,"default":[0.8,2],"minimum":0.1,"maximum":10,"expression":{}},"icon-text-fit":{"type":"enum","values":{"none":1,"width":1,"height":1,"both":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-image":{"type":"resolvedImage","tokens":true,"appearance":true,"use-theme":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"appearance":true,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]}},"icon-keep-upright":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"appearance":true,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]}},"text-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]}},"text-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]}},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size-scale-range":{"type":"array","value":"number","length":2,"default":[0.8,2],"minimum":0.1,"maximum":10,"expression":{}},"text-max-width":{"type":"number","default":10,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":1,"left":1,"center":1,"right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","default":0,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"expression":{"parameters":["zoom"]}},"text-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"expression":{"interpolated":true,"parameters":["zoom"]}},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":1,"vertical":1},"expression":{"parameters":["zoom"]}},"text-rotate":{"type":"number","default":0,"period":360,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]}},"text-keep-upright":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]}},"text-transform":{"type":"enum","values":{"none":1,"uppercase":1,"lowercase":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","length":2,"default":[0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"text-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"text-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"layout_raster-particle":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_hillshade":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_raster":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_raster-particle":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_clip":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_model":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_building":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":1,"!=":1,">":1,">=":1,"<":1,"<=":1,"in":1,"!in":1,"all":1,"any":1,"none":1,"has":1,"!has":1}},"geometry_type":{"type":"enum","values":{"Point":1,"LineString":1,"Polygon":1}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":1,"exponential":1,"interval":1,"categorical":1},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":1,"lab":1,"hcl":1},"default":"rgb"},"default":{"type":"*"}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"color":{"type":"color","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"use-theme":true,"transition":true},"high-color":{"type":"color","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"use-theme":true,"transition":true},"space-color":{"type":"color","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"use-theme":true,"transition":true},"horizon-blend":{"type":"number","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"star-intensity":{"type":"number","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vertical-range":{"type":"array","default":[0,0],"minimum":0,"length":2,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}}},"snow":{"density":{"type":"number","default":["interpolate",["linear"],["zoom"],11,0,13,0.85],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"intensity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"color":{"type":"color","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"use-theme":true,"transition":true},"opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette":{"type":"number","default":["interpolate",["linear"],["zoom"],11,0,13,0.3],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette-color":{"type":"color","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"use-theme":true,"transition":true},"center-thinning":{"type":"number","default":0.4,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"direction":{"type":"array","default":[0,50],"minimum":0,"maximum":360,"length":2,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"flake-size":{"type":"number","default":0.71,"minimum":0,"maximum":5,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true}},"rain":{"density":{"type":"number","default":["interpolate",["linear"],["zoom"],11,0,13,0.5],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"intensity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"color":{"type":"color","default":["interpolate",["linear"],["measure-light","brightness"],0,"#03113d",0.3,"#a8adbc"],"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"use-theme":true,"transition":true},"opacity":{"type":"number","default":["interpolate",["linear"],["measure-light","brightness"],0,0.88,1,0.7],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette":{"type":"number","default":["interpolate",["linear"],["zoom"],11,0,13,1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette-color":{"type":"color","default":["interpolate",["linear"],["measure-light","brightness"],0,"#001736",0.3,"#464646"],"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"use-theme":true,"transition":true},"center-thinning":{"type":"number","default":0.57,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"direction":{"type":"array","default":[0,80],"minimum":0,"maximum":360,"length":2,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"droplet-size":{"type":"array","default":[2.6,18.2],"minimum":0,"maximum":50,"length":2,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"distortion-strength":{"type":"number","default":0.7,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true}},"camera":{"camera-projection":{"type":"enum","values":{"perspective":1,"orthographic":1},"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"default":"perspective"}},"colorTheme":{"data":{"type":"string","expression":{}}},"indoor":{"floorplanFeaturesetId":{"type":"string","expression":{}},"buildingFeaturesetId":{"type":"string","expression":{}}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"use-theme":true,"transition":true},"intensity":{"type":"number","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":1,"equalEarth":1,"equirectangular":1,"lambertConformalConic":1,"mercator":1,"naturalEarth":1,"winkelTripel":1,"globe":1},"default":"mercator"},"center":{"type":"array","length":2,"value":"number","minimum":[-180,-90],"maximum":[180,90]},"parallels":{"type":"array","length":2,"value":"number","minimum":[-90,-90],"maximum":[90,90]}},"terrain":{"source":{"type":"string"},"exaggeration":{"type":"number","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_building","paint_symbol","paint_raster","paint_raster-particle","paint_hillshade","paint_background","paint_sky","paint_model"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]}},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]}},"fill-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-pattern-cross-fade":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-z-offset":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-bridge-guard-rail-color":{"type":"color","default":"rgba(241, 236, 225, 255)","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature"]},"property-type":"data-driven"},"fill-tunnel-structure-color":{"type":"color","default":"rgba(241, 236, 225, 255)","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature"]},"property-type":"data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]}},"fill-extrusion-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-pattern-cross-fade":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-height-alignment":{"type":"enum","values":{"terrain":1,"flat":1},"default":"flat"},"fill-extrusion-base-alignment":{"type":"enum","values":{"terrain":1,"flat":1},"default":"terrain"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]}},"fill-extrusion-ambient-occlusion-intensity":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-wall-radius":{"type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-radius":{"type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-attenuation":{"type":"number","default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-flood-light-color":{"type":"color","default":"#ffffff","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-intensity":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-wall-radius":{"property-type":"data-driven","type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-radius":{"property-type":"data-driven","type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-attenuation":{"type":"number","default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-vertical-scale":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-rounded-roof":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]}},"fill-extrusion-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{}},"fill-extrusion-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"fill-extrusion-line-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-extrusion-cast-shadows":{"type":"boolean","default":true}},"paint_building":{"building-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"building-ambient-occlusion-intensity":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"parameters":[]},"transition":true},"building-ambient-occlusion-ground-intensity":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"building-ambient-occlusion-ground-radius":{"type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"building-ambient-occlusion-ground-attenuation":{"type":"number","default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"building-vertical-scale":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"building-cast-shadows":{"type":"boolean","default":true},"building-color":{"type":"color","default":"rgba(193, 154, 127, 1)","use-theme":true,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"property-type":"data-driven"},"building-emissive-strength":{"type":"number","default":0,"minimum":0,"maximum":5,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"property-type":"data-driven"},"building-facade-emissive-chance":{"type":"number","default":0.35,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["measure-light","zoom"]}},"building-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{}},"building-flood-light-color":{"type":"color","default":"#ffffff","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"building-flood-light-intensity":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"building-flood-light-ground-attenuation":{"type":"number","default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"line-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]}},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light","line-progress"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern-cross-fade":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"line-gradient":{"type":"color","use-theme":true,"expression":{"interpolated":true,"parameters":["line-progress"]}},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1]},"line-trim-fade-range":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"line-trim-color":{"type":"color","default":"transparent","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"line-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"line-border-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-border-color":{"type":"color","default":"rgba(0, 0, 0, 0)","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-occlusion-opacity":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"circle-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]}},"circle-pitch-scale":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]}},"circle-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]}},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"use-theme":true,"expression":{"interpolated":true,"parameters":["heatmap-density"]}},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-occlusion-opacity":{"type":"number","minimum":0,"maximum":1,"default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"text-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"icon-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]}},"icon-image-cross-fade":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-occlusion-opacity":{"type":"number","minimum":0,"maximum":1,"default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"overridable":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"text-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]}},"icon-color-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"expression":{}},"icon-color-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"expression":{}},"icon-color-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{}},"icon-color-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{}},"symbol-z-offset":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-color":{"type":"color","use-theme":true,"expression":{"interpolated":true,"parameters":["raster-value"]}},"raster-color-mix":{"type":"array","default":[0.2126,0.7152,0.0722,0],"length":4,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-color-range":{"type":"array","length":2,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-resampling":{"type":"enum","values":{"linear":1,"nearest":1},"default":"linear","expression":{"parameters":["zoom"]}},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"raster-array-band":{"type":"string"},"raster-elevation":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}}},"paint_raster-particle":{"raster-particle-array-band":{"type":"string"},"raster-particle-count":{"type":"number","default":512,"minimum":1},"raster-particle-color":{"type":"color","use-theme":true,"expression":{"interpolated":true,"parameters":["raster-particle-speed"]}},"raster-particle-max-speed":{"type":"number","default":1,"minimum":1},"raster-particle-speed-factor":{"type":"number","default":0.2,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-particle-fade-opacity-factor":{"type":"number","default":0.98,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-particle-reset-rate-factor":{"type":"number","default":0.8,"minimum":0,"maximum":1},"raster-particle-elevation":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"expression":{"interpolated":true,"parameters":["zoom"]}},"hillshade-illumination-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]}},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"hillshade-shadow-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"hillshade-accent-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"hillshade-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}}},"paint_background":{"background-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":[]}},"background-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"background-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom"]}},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"background-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":1,"atmosphere":1},"default":"atmosphere","expression":{"parameters":["zoom"]}},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]}},"sky-atmosphere-sun-intensity":{"type":"number","default":10,"minimum":0,"maximum":100},"sky-gradient-center":{"type":"array","value":"number","default":[0,0],"length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]}},"sky-gradient-radius":{"type":"number","default":90,"minimum":0,"maximum":180,"expression":{"parameters":["zoom"]}},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"use-theme":true,"expression":{"interpolated":true,"parameters":["sky-radial-progress"]}},"sky-atmosphere-halo-color":{"type":"color","default":"white","use-theme":true},"sky-atmosphere-color":{"type":"color","default":"white","use-theme":true},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}}},"paint_model":{"model-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"property-type":"data-driven"},"model-rotation":{"type":"array","value":"number","length":3,"default":[0,0,0],"period":360,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-scale":{"type":"array","value":"number","length":3,"default":[1,1,1],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-translation":{"type":"array","value":"number","length":3,"default":[0,0,0],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-color":{"type":"color","default":"#ffffff","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light","zoom"]},"use-theme":true,"transition":true},"model-color-mix-intensity":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-type":{"type":"enum","values":{"common-3d":1,"location-indicator":1},"default":"common-3d"},"model-cast-shadows":{"type":"boolean","default":true},"model-receive-shadows":{"type":"boolean","default":true},"model-ambient-occlusion-intensity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"model-emissive-strength":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":5,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-roughness":{"type":"number","default":1,"minimum":0,"maximum":1,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state"]},"transition":true},"model-height-based-emissive-strength-multiplier":{"type":"array","default":[1,1,1,1,0],"length":5,"value":"number","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{}},"model-front-cutoff":{"type":"array","value":"number","expression":{"interpolated":true,"parameters":["zoom"]},"length":3,"default":[0,0,1],"minimum":[0,0,0],"maximum":[1,1,1]},"model-elevation-reference":{"type":"enum","values":{"sea":1,"ground":1,"hd-road-markup":1},"default":"ground","expression":{}}},"transition":{"duration":{"type":"number","default":300,"minimum":0},"delay":{"type":"number","default":0,"minimum":0}},"promoteId":{"*":{"type":"*"}}}');function vm(a){return a instanceof Number||a instanceof String||a instanceof Boolean?a.valueOf():a}function Ku(a){if(Array.isArray(a))return a.map(Ku);if(a instanceof Object&&!(a instanceof Number||a instanceof String||a instanceof Boolean)){const r={};for(const o in a)r[o]=Ku(a[o]);return r}return vm(a)}function bm(a){if(a===!0||a===!1)return!0;if(!Array.isArray(a)||a.length===0)return!1;switch(a[0]){case"has":return a.length>=2&&a[1]!=="$id"&&a[1]!=="$type";case"in":return a.length>=3&&(typeof a[1]!="string"||Array.isArray(a[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return a.length!==3||Array.isArray(a[1])||Array.isArray(a[2]);case"any":case"all":for(const r of a.slice(1))if(!bm(r)&&typeof r!="boolean")return!1;return!0;default:return!0}}function Rf(a,r="",o=null,u="fill"){if(a==null)return{filter:()=>!0,needGeometry:!1,needFeature:!1};bm(a)||(a=xm(a));const h=a;let g=!0;try{g=(function(A){if(!Qd(A))return A;let R=Ku(A);return Qa(R),R=$b(R),R})(h)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.
This is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md
and paste the contents of this message in the report.
Thank you!
Filter Expression:
${JSON.stringify(h,null,2)}
        `)}let _=null,b=null;if(u!=="background"&&u!=="sky"&&u!=="slot"){b=$e[`filter_${u}`];const A=Sl(g,b,r,o);if(A.result==="error")throw new Error(A.value.map((R=>`${R.key}: ${R.message}`)).join(", "));_=(R,M,F)=>A.value.evaluate(R,M,{},F)}let T=null,E=null;if(g!==h){const A=Sl(h,b,r,o);if(A.result==="error")throw new Error(A.value.map((R=>`${R.key}: ${R.message}`)).join(", "));T=(R,M,F,B,W)=>A.value.evaluate(R,M,{},F,void 0,void 0,B,W),E=!Hd(A.value.expression)}return{filter:_,dynamicFilter:T||void 0,needGeometry:jb(g),needFeature:!!E}}function $b(a){if(!Array.isArray(a))return a;const r=(function(o){if(Ub.has(o[0])){for(let u=1;u<o.length;u++)if(Qd(o[u]))return!0}return o})(a);return r===!0?r:r.map((o=>$b(o)))}function Qa(a){let r=!1;const o=[];if(a[0]==="case"){for(let u=1;u<a.length-1;u+=2)r=r||Qd(a[u]),o.push(a[u+1]);o.push(a[a.length-1])}else if(a[0]==="match"){r=r||Qd(a[1]);for(let u=2;u<a.length-1;u+=2)o.push(a[u+1]);o.push(a[a.length-1])}else if(a[0]==="step"){r=r||Qd(a[1]);for(let u=1;u<a.length-1;u+=2)o.push(a[u+1])}r&&(a.length=0,a.push("any",...o));for(let u=1;u<a.length;u++)Qa(a[u])}function Qd(a){if(!Array.isArray(a))return!1;if((r=a[0])==="pitch"||r==="distance-from-center")return!0;var r;for(let o=1;o<a.length;o++)if(Qd(a[o]))return!0;return!1}const Ub=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function xS(a,r){return a<r?-1:a>r?1:0}function jb(a){if(!Array.isArray(a))return!1;if(a[0]==="within"||a[0]==="distance")return!0;for(let r=1;r<a.length;r++)if(jb(a[r]))return!0;return!1}function xm(a){if(!a)return!0;const r=a[0];return a.length<=1?r!=="any":r==="=="?Z_(a[1],a[2],"=="):r==="!="?wm(Z_(a[1],a[2],"==")):r==="<"||r===">"||r==="<="||r===">="?Z_(a[1],a[2],r):r==="any"?(o=a.slice(1),["any"].concat(o.map(xm))):r==="all"?["all"].concat(a.slice(1).map(xm)):r==="none"?["all"].concat(a.slice(1).map(xm).map(wm)):r==="in"?Gb(a[1],a.slice(2)):r==="!in"?wm(Gb(a[1],a.slice(2))):r==="has"?Hb(a[1]):r!=="!has"||wm(Hb(a[1]));var o}function Z_(a,r,o){switch(a){case"$type":return[`filter-type-${o}`,r];case"$id":return[`filter-id-${o}`,r];default:return[`filter-${o}`,a,r]}}function Gb(a,r){if(r.length===0)return!1;switch(a){case"$type":return["filter-type-in",["literal",r]];case"$id":return["filter-id-in",["literal",r]];default:return r.length>200&&!r.some((o=>typeof o!=typeof r[0]))?["filter-in-large",a,["literal",r.sort(xS)]]:["filter-in-small",a,["literal",r]]}}function Hb(a){switch(a){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",a]}}function wm(a){return["!",a]}const kf="";function eh(a,r){return r?`${a}${kf}${r}`:a}let X_;const Wb=()=>X_||(X_=new Wi({"icon-size":new $t($e.layout_symbol["icon-size"]),"icon-image":new $t($e.layout_symbol["icon-image"]),"icon-rotate":new $t($e.layout_symbol["icon-rotate"]),"icon-offset":new $t($e.layout_symbol["icon-offset"])}));class wS{constructor(r,o,u,h,g,_){const b=Sl(r,$e.appearance.condition);if(b.result==="success"&&(this.condition=b.value),this.name=o,u){this.properties=new qu(Wb()),this.unevaluatedLayout=new Hu(Wb(),h,g,_);for(const T in u)this.unevaluatedLayout.setValue(T,u[T])}}isActive(r){return!(this.condition||!r.isHidden||this.name!=="hidden")||this.condition.evaluate(r.globals,r.feature,r.featureState,r.canonical)}getCondition(){return this.condition}getName(){return this.name}getProperty(r){return this.properties.get(r)}getUnevaluatedProperties(){return this.unevaluatedLayout}serialize(){const r={};return r.condition=this.condition.expression.serialize(),this.name&&(r.name=this.name),this.properties&&(r.properties=this.properties),r}}const qb="-transition",Kb=new Set(["fill","line","background","hillshade","raster"]);class hs extends xl{constructor(r,o,u,h,g,_){if(super(),this.id=r.id,this.fqid=eh(this.id,u),this.type=r.type,this.scope=u,this.lut=h,this.options=g,this.iconImageUseTheme=_,this.appearances=new Array,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,this.configDependencies=new Set,r.type!=="custom"){if(this.metadata=r.metadata,this.minzoom=r.minzoom,this.maxzoom=r.maxzoom,r.type&&r.type!=="background"&&r.type!=="sky"&&r.type!=="slot"){this.source=r.source,this.sourceLayer=r["source-layer"],this.filter=r.filter;const b=Sl(this.filter,$e[`filter_${r.type}`]);b.result!=="error"&&(this.configDependencies=new Set([...this.configDependencies,...b.value.configDependencies]))}if(r.slot&&(this.slot=r.slot),r.appearances&&r.appearances.forEach((b=>{this.appearances.push(new wS(b.condition,b.name,b.properties,this.scope,g,this.iconImageUseTheme))})),o.layout&&(this._unevaluatedLayout=new Hu(o.layout,this.scope,g,this.iconImageUseTheme),this.configDependencies=new Set([...this.configDependencies,...this._unevaluatedLayout.configDependencies])),o.paint){this._transitionablePaint=new Vb(o.paint,this.scope,g);for(const b in r.paint)this.setPaintProperty(b,r.paint[b]);for(const b in r.layout)this.setLayoutProperty(b,r.layout[b]);this.configDependencies=new Set([...this.configDependencies,...this._transitionablePaint.configDependencies]),this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new qu(o.paint)}}}onAdd(r){}onRemove(r){}isDraped(r){return!this.is3D(!0)&&Kb.has(this.type)}getLayoutProperty(r){return r==="visibility"?this.visibility:this._unevaluatedLayout.getValue(r)}setLayoutProperty(r,o){if(this.type==="custom"&&r==="visibility")return void(this.visibility=o);const u=this._unevaluatedLayout;u._properties.properties[r]&&(u.setValue(r,o),this.configDependencies=new Set([...this.configDependencies,...u.configDependencies]),r==="visibility"&&this.possiblyEvaluateVisibility())}possiblyEvaluateVisibility(){this._unevaluatedLayout._values.visibility&&(this.visibility=this._unevaluatedLayout._values.visibility.possiblyEvaluate({zoom:0}))}getPaintProperty(r){return r.endsWith(qb)?this._transitionablePaint.getTransition(r.slice(0,-11)):this._transitionablePaint.getValue(r)}setPaintProperty(r,o){const u=this._transitionablePaint,h=u._properties.properties;if(r.endsWith(qb)){const R=r.slice(0,-11);return h[R]&&u.setTransition(R,o||void 0),!1}if(!h[r])return!1;const g=u._values[r],_=g.value.isDataDriven(),b=g.value;u.setValue(r,o),this.configDependencies=new Set([...this.configDependencies,...u.configDependencies]),this._handleSpecialPaintPropertyUpdate(r);const T=u._values[r].value,E=T.isDataDriven(),A=r.endsWith("pattern")||r==="line-dasharray";return E||_||A||this._handleOverridablePaintPropertyUpdate(r,b,T)}_handleSpecialPaintPropertyUpdate(r){}getProgramIds(){return null}getDefaultProgramParams(r,o,u){return null}_handleOverridablePaintPropertyUpdate(r,o,u){return!1}isHidden(r){return!!(this.minzoom&&r<this.minzoom)||!!(this.maxzoom&&r>=this.maxzoom)||this.visibility==="none"}updateTransitions(r){this._transitioningPaint=this._transitionablePaint.transitioned(r,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(r,o){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(r,void 0,o,this.iconImageUseTheme)),this.paint=this._transitioningPaint.possiblyEvaluate(r,void 0,o)}serialize(){const r={id:this.id,type:this.type,slot:this.slot,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.appearances.length!==0&&(r.appearances=this.appearances.map((o=>o.serialize()))),lr(r,((o,u)=>!(o===void 0||u==="layout"&&!Object.keys(o).length||u==="paint"&&!Object.keys(o).length)))}is3D(r){return!1}hasElevation(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}hasShadowPass(){return!1}canCastShadows(){return!1}hasLightBeamPass(){return!1}cutoffRange(){return 0}tileCoverLift(){return 0}resize(){}_clear(){}isStateDependent(){for(const r in this.paint._values){const o=this.paint.get(r);if(o instanceof Wu&&am(o.property.specification)&&(o.value.kind==="source"||o.value.kind==="composite")&&o.value.isStateDependent)return!0}return!1}compileFilter(r){this._filterCompiled||(this._featureFilter=Rf(this.filter,this.scope,r),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}getLayerRenderingStats(){return this._stats}resetLayerRenderingStats(r){this._stats&&(r.renderPass==="shadow"?this._stats.numRenderedVerticesInShadowPass=0:this._stats.numRenderedVerticesInTransparentPass=0)}getAppearances(){return this.appearances}queryRadius(r){}queryIntersectsFeature(r,o,u,h,g,_,b,T,E){}}const Nc={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class th{constructor(r,o){this._structArray=r,this._pos1=o*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class wi{constructor(){this.capacity=-1,this.resize(0)}static serialize(r,o){return r._trim(),o&&o.add(r.arrayBuffer),{length:r.length,arrayBuffer:r.arrayBuffer}}static deserialize(r){const o=Object.create(this.prototype);return o.arrayBuffer=r.arrayBuffer,o.length=r.length,o.capacity=r.arrayBuffer.byteLength/o.bytesPerElement,o._refreshViews(),o}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(r){this.reserve(r),this.length=r}reserve(r){if(r>this.capacity){this.capacity=Math.max(r,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const o=this.uint8;this._refreshViews(),o&&this.uint8.set(o)}}_refreshViews(){throw new Error("StructArray#_refreshViews() must be implemented by each concrete StructArray layout")}emplace(...r){throw new Error("StructArray#emplace() must be implemented by each concrete StructArray layout")}emplaceBack(...r){throw new Error("StructArray#emplaceBack() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function gr(a,r=1){let o=0,u=0;return{members:a.map((h=>{const g=Nc[h.type].BYTES_PER_ELEMENT,_=o=Zb(o,Math.max(r,g)),b=h.components||1;return u=Math.max(u,g),o+=g*b,{name:h.name,type:h.type,components:b,offset:_}})),size:Zb(o,Math.max(u,r)),alignment:r}}function Zb(a,r){return Math.ceil(a/r)*r}class Vc extends wi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,o){const u=this.length;return this.resize(u+1),this.emplace(u,r,o)}emplace(r,o,u){const h=2*r;return this.int16[h+0]=o,this.int16[h+1]=u,r}}Vc.prototype.bytesPerElement=4,Wt(Vc,"StructArrayLayout2i4");class Zu extends wi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,o,u){const h=this.length;return this.resize(h+1),this.emplace(h,r,o,u)}emplace(r,o,u,h){const g=3*r;return this.int16[g+0]=o,this.int16[g+1]=u,this.int16[g+2]=h,r}}Zu.prototype.bytesPerElement=6,Wt(Zu,"StructArrayLayout3i6");class Xu extends wi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,o,u,h){const g=this.length;return this.resize(g+1),this.emplace(g,r,o,u,h)}emplace(r,o,u,h,g){const _=4*r;return this.int16[_+0]=o,this.int16[_+1]=u,this.int16[_+2]=h,this.int16[_+3]=g,r}}Xu.prototype.bytesPerElement=8,Wt(Xu,"StructArrayLayout4i8");class $c extends wi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r){const o=this.length;return this.resize(o+1),this.emplace(o,r)}emplace(r,o){return this.float32[1*r+0]=o,r}}$c.prototype.bytesPerElement=4,Wt($c,"StructArrayLayout1f4");class Y_ extends wi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,o,u){const h=this.length;return this.resize(h+1),this.emplace(h,r,o,u)}emplace(r,o,u,h){const g=4*r,_=2*r;return this.int16[g+0]=o,this.int16[g+1]=u,this.float32[_+1]=h,r}}Y_.prototype.bytesPerElement=8,Wt(Y_,"StructArrayLayout2i1f8");class Tm extends wi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,o,u){const h=this.length;return this.resize(h+1),this.emplace(h,r,o,u)}emplace(r,o,u,h){const g=4*r;return this.int16[g+0]=o,this.int16[g+1]=u,this.int16[g+2]=h,r}}Tm.prototype.bytesPerElement=8,Wt(Tm,"StructArrayLayout3i8");class J_ extends wi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,o,u,h,g){const _=this.length;return this.resize(_+1),this.emplace(_,r,o,u,h,g)}emplace(r,o,u,h,g,_){const b=5*r;return this.int16[b+0]=o,this.int16[b+1]=u,this.int16[b+2]=h,this.int16[b+3]=g,this.int16[b+4]=_,r}}J_.prototype.bytesPerElement=10,Wt(J_,"StructArrayLayout5i10");class Sm extends wi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,o,u,h,g,_,b){const T=this.length;return this.resize(T+1),this.emplace(T,r,o,u,h,g,_,b)}emplace(r,o,u,h,g,_,b,T){const E=6*r,A=12*r,R=3*r;return this.int16[E+0]=o,this.int16[E+1]=u,this.uint8[A+4]=h,this.uint8[A+5]=g,this.uint8[A+6]=_,this.uint8[A+7]=b,this.float32[R+2]=T,r}}Sm.prototype.bytesPerElement=12,Wt(Sm,"StructArrayLayout2i4ub1f12");class Bs extends wi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,o,u){const h=this.length;return this.resize(h+1),this.emplace(h,r,o,u)}emplace(r,o,u,h){const g=3*r;return this.float32[g+0]=o,this.float32[g+1]=u,this.float32[g+2]=h,r}}Bs.prototype.bytesPerElement=12,Wt(Bs,"StructArrayLayout3f12");class Uc extends wi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,o,u,h,g){const _=this.length;return this.resize(_+1),this.emplace(_,r,o,u,h,g)}emplace(r,o,u,h,g,_){const b=6*r,T=3*r;return this.uint16[b+0]=o,this.uint16[b+1]=u,this.uint16[b+2]=h,this.uint16[b+3]=g,this.float32[T+2]=_,r}}Uc.prototype.bytesPerElement=12,Wt(Uc,"StructArrayLayout4ui1f12");class nh extends wi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,o,u,h){const g=this.length;return this.resize(g+1),this.emplace(g,r,o,u,h)}emplace(r,o,u,h,g){const _=4*r;return this.uint16[_+0]=o,this.uint16[_+1]=u,this.uint16[_+2]=h,this.uint16[_+3]=g,r}}nh.prototype.bytesPerElement=8,Wt(nh,"StructArrayLayout4ui8");class Em extends wi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,o,u,h,g,_){const b=this.length;return this.resize(b+1),this.emplace(b,r,o,u,h,g,_)}emplace(r,o,u,h,g,_,b){const T=6*r;return this.int16[T+0]=o,this.int16[T+1]=u,this.int16[T+2]=h,this.int16[T+3]=g,this.int16[T+4]=_,this.int16[T+5]=b,r}}Em.prototype.bytesPerElement=12,Wt(Em,"StructArrayLayout6i12");class Q_ extends wi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,o,u,h,g,_,b,T,E,A,R,M){const F=this.length;return this.resize(F+1),this.emplace(F,r,o,u,h,g,_,b,T,E,A,R,M)}emplace(r,o,u,h,g,_,b,T,E,A,R,M,F){const B=12*r;return this.int16[B+0]=o,this.int16[B+1]=u,this.int16[B+2]=h,this.int16[B+3]=g,this.uint16[B+4]=_,this.uint16[B+5]=b,this.uint16[B+6]=T,this.uint16[B+7]=E,this.int16[B+8]=A,this.int16[B+9]=R,this.int16[B+10]=M,this.int16[B+11]=F,r}}Q_.prototype.bytesPerElement=24,Wt(Q_,"StructArrayLayout4i4ui4i24");class ey extends wi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,o,u,h,g,_){const b=this.length;return this.resize(b+1),this.emplace(b,r,o,u,h,g,_)}emplace(r,o,u,h,g,_,b){const T=10*r,E=5*r;return this.int16[T+0]=o,this.int16[T+1]=u,this.int16[T+2]=h,this.float32[E+2]=g,this.float32[E+3]=_,this.float32[E+4]=b,r}}ey.prototype.bytesPerElement=20,Wt(ey,"StructArrayLayout3i3f20");class el extends wi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,o,u,h){const g=this.length;return this.resize(g+1),this.emplace(g,r,o,u,h)}emplace(r,o,u,h,g){const _=4*r;return this.float32[_+0]=o,this.float32[_+1]=u,this.float32[_+2]=h,this.float32[_+3]=g,r}}el.prototype.bytesPerElement=16,Wt(el,"StructArrayLayout4f16");class rh extends wi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(r){const o=this.length;return this.resize(o+1),this.emplace(o,r)}emplace(r,o){return this.uint32[1*r+0]=o,r}}rh.prototype.bytesPerElement=4,Wt(rh,"StructArrayLayout1ul4");class Co extends wi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,o){const u=this.length;return this.resize(u+1),this.emplace(u,r,o)}emplace(r,o,u){const h=2*r;return this.uint16[h+0]=o,this.uint16[h+1]=u,r}}Co.prototype.bytesPerElement=4,Wt(Co,"StructArrayLayout2ui4");class ih extends wi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,o,u,h,g,_,b,T,E,A,R,M,F){const B=this.length;return this.resize(B+1),this.emplace(B,r,o,u,h,g,_,b,T,E,A,R,M,F)}emplace(r,o,u,h,g,_,b,T,E,A,R,M,F,B){const W=20*r,q=10*r;return this.int16[W+0]=o,this.int16[W+1]=u,this.int16[W+2]=h,this.int16[W+3]=g,this.int16[W+4]=_,this.float32[q+3]=b,this.float32[q+4]=T,this.float32[q+5]=E,this.float32[q+6]=A,this.int16[W+14]=R,this.uint32[q+8]=M,this.uint16[W+18]=F,this.uint16[W+19]=B,r}}ih.prototype.bytesPerElement=40,Wt(ih,"StructArrayLayout5i4f1i1ul2ui40");class Cm extends wi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,o,u,h,g,_,b){const T=this.length;return this.resize(T+1),this.emplace(T,r,o,u,h,g,_,b)}emplace(r,o,u,h,g,_,b,T){const E=8*r;return this.int16[E+0]=o,this.int16[E+1]=u,this.int16[E+2]=h,this.int16[E+4]=g,this.int16[E+5]=_,this.int16[E+6]=b,this.int16[E+7]=T,r}}Cm.prototype.bytesPerElement=16,Wt(Cm,"StructArrayLayout3i2i2i16");class ty extends wi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r,o,u,h,g){const _=this.length;return this.resize(_+1),this.emplace(_,r,o,u,h,g)}emplace(r,o,u,h,g,_){const b=4*r,T=8*r;return this.float32[b+0]=o,this.float32[b+1]=u,this.float32[b+2]=h,this.int16[T+6]=g,this.int16[T+7]=_,r}}ty.prototype.bytesPerElement=16,Wt(ty,"StructArrayLayout2f1f2i16");class ny extends wi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,o,u,h,g,_){const b=this.length;return this.resize(b+1),this.emplace(b,r,o,u,h,g,_)}emplace(r,o,u,h,g,_,b){const T=20*r,E=5*r;return this.uint8[T+0]=o,this.uint8[T+1]=u,this.float32[E+1]=h,this.float32[E+2]=g,this.float32[E+3]=_,this.float32[E+4]=b,r}}ny.prototype.bytesPerElement=20,Wt(ny,"StructArrayLayout2ub4f20");class Mo extends wi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,o,u){const h=this.length;return this.resize(h+1),this.emplace(h,r,o,u)}emplace(r,o,u,h){const g=3*r;return this.uint16[g+0]=o,this.uint16[g+1]=u,this.uint16[g+2]=h,r}}Mo.prototype.bytesPerElement=6,Wt(Mo,"StructArrayLayout3ui6");class Of extends wi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(r,o,u,h,g,_,b,T,E,A,R,M,F,B,W,q,K,ne,re,oe,ye){const ve=this.length;return this.resize(ve+1),this.emplace(ve,r,o,u,h,g,_,b,T,E,A,R,M,F,B,W,q,K,ne,re,oe,ye)}emplace(r,o,u,h,g,_,b,T,E,A,R,M,F,B,W,q,K,ne,re,oe,ye,ve){const Ce=30*r,Oe=15*r,De=60*r;return this.int16[Ce+0]=o,this.int16[Ce+1]=u,this.int16[Ce+2]=h,this.float32[Oe+2]=g,this.float32[Oe+3]=_,this.uint16[Ce+8]=b,this.uint16[Ce+9]=T,this.uint32[Oe+5]=E,this.uint32[Oe+6]=A,this.uint32[Oe+7]=R,this.uint16[Ce+16]=M,this.uint16[Ce+17]=F,this.uint16[Ce+18]=B,this.float32[Oe+10]=W,this.float32[Oe+11]=q,this.uint8[De+48]=K,this.uint8[De+49]=ne,this.uint8[De+50]=re,this.uint32[Oe+13]=oe,this.int16[Ce+28]=ye,this.uint8[De+58]=ve,r}}Of.prototype.bytesPerElement=60,Wt(Of,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class ry extends wi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(r,o,u,h,g,_,b,T,E,A,R,M,F,B,W,q,K,ne,re,oe,ye,ve,Ce,Oe,De,ut,Ue,ht,wt,mt,yt,Et,lt){const vt=this.length;return this.resize(vt+1),this.emplace(vt,r,o,u,h,g,_,b,T,E,A,R,M,F,B,W,q,K,ne,re,oe,ye,ve,Ce,Oe,De,ut,Ue,ht,wt,mt,yt,Et,lt)}emplace(r,o,u,h,g,_,b,T,E,A,R,M,F,B,W,q,K,ne,re,oe,ye,ve,Ce,Oe,De,ut,Ue,ht,wt,mt,yt,Et,lt,vt){const rt=20*r,Xe=40*r,Ct=80*r;return this.float32[rt+0]=o,this.float32[rt+1]=u,this.int16[Xe+4]=h,this.int16[Xe+5]=g,this.int16[Xe+6]=_,this.int16[Xe+7]=b,this.int16[Xe+8]=T,this.int16[Xe+9]=E,this.int16[Xe+10]=A,this.int16[Xe+11]=R,this.int16[Xe+12]=M,this.uint16[Xe+13]=F,this.uint16[Xe+14]=B,this.uint16[Xe+15]=W,this.uint16[Xe+16]=q,this.uint16[Xe+17]=K,this.uint16[Xe+18]=ne,this.uint16[Xe+19]=re,this.uint16[Xe+20]=oe,this.uint16[Xe+21]=ye,this.uint16[Xe+22]=ve,this.uint16[Xe+23]=Ce,this.uint16[Xe+24]=Oe,this.uint16[Xe+25]=De,this.uint16[Xe+26]=ut,this.uint16[Xe+27]=Ue,this.uint32[rt+14]=ht,this.float32[rt+15]=wt,this.float32[rt+16]=mt,this.float32[rt+17]=yt,this.float32[rt+18]=Et,this.uint8[Ct+76]=lt,this.uint16[Xe+39]=vt,r}}ry.prototype.bytesPerElement=80,Wt(ry,"StructArrayLayout2f9i15ui1ul4f1ub1ui80");class Mf extends wi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,o,u,h,g,_){const b=this.length;return this.resize(b+1),this.emplace(b,r,o,u,h,g,_)}emplace(r,o,u,h,g,_,b){const T=6*r;return this.float32[T+0]=o,this.float32[T+1]=u,this.float32[T+2]=h,this.float32[T+3]=g,this.float32[T+4]=_,this.float32[T+5]=b,r}}Mf.prototype.bytesPerElement=24,Wt(Mf,"StructArrayLayout6f24");class Yu extends wi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,o,u,h,g){const _=this.length;return this.resize(_+1),this.emplace(_,r,o,u,h,g)}emplace(r,o,u,h,g,_){const b=5*r;return this.float32[b+0]=o,this.float32[b+1]=u,this.float32[b+2]=h,this.float32[b+3]=g,this.float32[b+4]=_,r}}Yu.prototype.bytesPerElement=20,Wt(Yu,"StructArrayLayout5f20");class iy extends wi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,o,u,h,g,_,b){const T=this.length;return this.resize(T+1),this.emplace(T,r,o,u,h,g,_,b)}emplace(r,o,u,h,g,_,b,T){const E=7*r;return this.float32[E+0]=o,this.float32[E+1]=u,this.float32[E+2]=h,this.float32[E+3]=g,this.float32[E+4]=_,this.float32[E+5]=b,this.float32[E+6]=T,r}}iy.prototype.bytesPerElement=28,Wt(iy,"StructArrayLayout7f28");class Im extends wi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,o,u,h,g,_,b,T,E,A,R){const M=this.length;return this.resize(M+1),this.emplace(M,r,o,u,h,g,_,b,T,E,A,R)}emplace(r,o,u,h,g,_,b,T,E,A,R,M){const F=11*r;return this.float32[F+0]=o,this.float32[F+1]=u,this.float32[F+2]=h,this.float32[F+3]=g,this.float32[F+4]=_,this.float32[F+5]=b,this.float32[F+6]=T,this.float32[F+7]=E,this.float32[F+8]=A,this.float32[F+9]=R,this.float32[F+10]=M,r}}Im.prototype.bytesPerElement=44,Wt(Im,"StructArrayLayout11f44");class Df extends wi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,o,u,h,g,_,b,T,E){const A=this.length;return this.resize(A+1),this.emplace(A,r,o,u,h,g,_,b,T,E)}emplace(r,o,u,h,g,_,b,T,E,A){const R=9*r;return this.float32[R+0]=o,this.float32[R+1]=u,this.float32[R+2]=h,this.float32[R+3]=g,this.float32[R+4]=_,this.float32[R+5]=b,this.float32[R+6]=T,this.float32[R+7]=E,this.float32[R+8]=A,r}}Df.prototype.bytesPerElement=36,Wt(Df,"StructArrayLayout9f36");class oh extends wi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,o){const u=this.length;return this.resize(u+1),this.emplace(u,r,o)}emplace(r,o,u){const h=2*r;return this.float32[h+0]=o,this.float32[h+1]=u,r}}oh.prototype.bytesPerElement=8,Wt(oh,"StructArrayLayout2f8");class Am extends wi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r,o,u,h){const g=this.length;return this.resize(g+1),this.emplace(g,r,o,u,h)}emplace(r,o,u,h,g){const _=6*r;return this.uint32[3*r+0]=o,this.uint16[_+2]=u,this.uint16[_+3]=h,this.uint16[_+4]=g,r}}Am.prototype.bytesPerElement=12,Wt(Am,"StructArrayLayout1ul3ui12");class Pm extends wi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(r){const o=this.length;return this.resize(o+1),this.emplace(o,r)}emplace(r,o){return this.uint16[1*r+0]=o,r}}Pm.prototype.bytesPerElement=2,Wt(Pm,"StructArrayLayout1ui2");class oy extends wi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,o,u,h,g,_,b,T,E,A,R,M,F,B,W,q){const K=this.length;return this.resize(K+1),this.emplace(K,r,o,u,h,g,_,b,T,E,A,R,M,F,B,W,q)}emplace(r,o,u,h,g,_,b,T,E,A,R,M,F,B,W,q,K){const ne=16*r;return this.float32[ne+0]=o,this.float32[ne+1]=u,this.float32[ne+2]=h,this.float32[ne+3]=g,this.float32[ne+4]=_,this.float32[ne+5]=b,this.float32[ne+6]=T,this.float32[ne+7]=E,this.float32[ne+8]=A,this.float32[ne+9]=R,this.float32[ne+10]=M,this.float32[ne+11]=F,this.float32[ne+12]=B,this.float32[ne+13]=W,this.float32[ne+14]=q,this.float32[ne+15]=K,r}}oy.prototype.bytesPerElement=64,Wt(oy,"StructArrayLayout16f64");class sh extends wi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(r,o,u,h,g,_,b){const T=this.length;return this.resize(T+1),this.emplace(T,r,o,u,h,g,_,b)}emplace(r,o,u,h,g,_,b,T){const E=10*r,A=5*r;return this.uint16[E+0]=o,this.uint16[E+1]=u,this.uint16[E+2]=h,this.uint16[E+3]=g,this.float32[A+2]=_,this.float32[A+3]=b,this.float32[A+4]=T,r}}sh.prototype.bytesPerElement=20,Wt(sh,"StructArrayLayout4ui3f20");class ah extends wi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(r){const o=this.length;return this.resize(o+1),this.emplace(o,r)}emplace(r,o){return this.int16[1*r+0]=o,r}}ah.prototype.bytesPerElement=2,Wt(ah,"StructArrayLayout1i2");class Rm extends wi{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer)}emplaceBack(r){const o=this.length;return this.resize(o+1),this.emplace(o,r)}emplace(r,o){return this.uint8[1*r+0]=o,r}}Rm.prototype.bytesPerElement=1,Wt(Rm,"StructArrayLayout1ub1");class Xb extends th{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}Xb.prototype.size=40;class sy extends ih{get(r){return new Xb(this,r)}}Wt(sy,"CollisionBoxArray");class Yb extends th{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(r){this._structArray.uint8[this._pos1+49]=r}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(r){this._structArray.uint8[this._pos1+50]=r}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(r){this._structArray.uint32[this._pos4+13]=r}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(r){this._structArray.uint8[this._pos1+58]=r}}Yb.prototype.size=60;class km extends Of{get(r){return new Yb(this,r)}}Wt(km,"PlacedSymbolArray");class Jb extends th{get tileAnchorX(){return this._structArray.float32[this._pos4+0]}get tileAnchorY(){return this._structArray.float32[this._pos4+1]}get projectedAnchorX(){return this._structArray.int16[this._pos2+4]}get projectedAnchorY(){return this._structArray.int16[this._pos2+5]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+6]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+7]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+11]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get key(){return this._structArray.uint16[this._pos2+13]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+14]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+15]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+17]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+19]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+21]}get featureIndex(){return this._structArray.uint16[this._pos2+22]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+23]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numIconVertices(){return this._structArray.uint16[this._pos2+25]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+26]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+27]}get crossTileID(){return this._structArray.uint32[this._pos4+14]}set crossTileID(r){this._structArray.uint32[this._pos4+14]=r}get textOffset0(){return this._structArray.float32[this._pos4+15]}get textOffset1(){return this._structArray.float32[this._pos4+16]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+17]}get zOffset(){return this._structArray.float32[this._pos4+18]}set zOffset(r){this._structArray.float32[this._pos4+18]=r}get hasIconTextFit(){return this._structArray.uint8[this._pos1+76]}get elevationFeatureIndex(){return this._structArray.uint16[this._pos2+39]}}Jb.prototype.size=80;class Qb extends ry{get(r){return new Jb(this,r)}}Wt(Qb,"SymbolInstanceArray");class e1 extends $c{getoffsetX(r){return this.float32[1*r+0]}}Wt(e1,"GlyphOffsetArray");class t1 extends Vc{getx(r){return this.int16[2*r+0]}gety(r){return this.int16[2*r+1]}}Wt(t1,"SymbolLineVertexArray");class ay extends th{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}ay.prototype.size=12;class n1 extends Am{get(r){return new ay(this,r)}}Wt(n1,"FeatureIndexArray");class r1 extends Co{geta_centroid_pos0(r){return this.uint16[2*r+0]}geta_centroid_pos1(r){return this.uint16[2*r+1]}}Wt(r1,"FillExtrusionCentroidArray");class i1 extends th{get a_join_normal_inside0(){return this._structArray.int16[this._pos2+0]}get a_join_normal_inside1(){return this._structArray.int16[this._pos2+1]}get a_join_normal_inside2(){return this._structArray.int16[this._pos2+2]}}i1.prototype.size=6;class o1 extends Zu{get(r){return new i1(this,r)}}Wt(o1,"FillExtrusionWallArray");const TS=gr([{name:"a_pos",components:2,type:"Int16"}],4),SS=gr([{name:"a_circle_z_offset",components:1,type:"Float32"}],4),ES=gr([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class Bi{constructor(r=[]){this.segments=r}_prepareSegment(r,o,u,h){let g=this.segments[this.segments.length-1];return r>Bi.MAX_VERTEX_ARRAY_LENGTH&&cr(`Max vertices per segment is ${Bi.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${r}`),(!g||g.vertexLength+r>Bi.MAX_VERTEX_ARRAY_LENGTH||g.sortKey!==h)&&(g={vertexOffset:o,primitiveOffset:u,vertexLength:0,primitiveLength:0},h!==void 0&&(g.sortKey=h),this.segments.push(g)),g}prepareSegment(r,o,u,h){return this._prepareSegment(r,o.length,u.length,h)}get(){return this.segments}destroy(){for(const r of this.segments)for(const o in r.vaos)r.vaos[o].destroy()}static simpleSegment(r,o,u,h){return new Bi([{vertexOffset:r,primitiveOffset:o,vertexLength:u,primitiveLength:h,vaos:{},sortKey:0}])}}function Lf(a,r){return 256*(a=be(Math.floor(a),0,255))+be(Math.floor(r),0,255)}Bi.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Wt(Bi,"SegmentVector");const CS=gr([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),IS=gr([{name:"a_pattern_b",components:4,type:"Uint16"}]),Om=gr([{name:"a_dash",components:4,type:"Uint16"}]);class zf{constructor(){this.ids=[],this.uniqueIds=[],this.positions=[],this.indexed=!1}add(r,o,u,h){this.ids.push(ly(r)),this.positions.push(o,u,h)}eachPosition(r,o){const u=ly(r);let h=0,g=this.ids.length-1;for(;h<g;){const _=h+g>>1;this.ids[_]>=u?g=_:h=_+1}for(;this.ids[h]===u;)o(this.positions[3*h],this.positions[3*h+1],this.positions[3*h+2]),h++}static serialize(r,o){const u=new Float64Array(r.ids),h=new Uint32Array(r.positions);return cy(u,h,0,u.length-1),o&&(o.add(u.buffer),o.add(h.buffer)),{ids:u,positions:h}}static deserialize(r){const o=new zf;let u;o.ids=r.ids,o.positions=r.positions;for(const h of o.ids)h!==u&&o.uniqueIds.push(h),u=h;return o.indexed=!0,o}}function ly(a){const r=+a;return Number.isSafeInteger(r)?r:Au(String(a))}function cy(a,r,o,u){for(;o<u;){const h=a[o+u>>1];let g=o-1,_=u+1;for(;;){do g++;while(a[g]<h);do _--;while(a[_]>h);if(g>=_)break;Ff(a,g,_),Ff(r,3*g,3*_),Ff(r,3*g+1,3*_+1),Ff(r,3*g+2,3*_+2)}_-o<u-_?(cy(a,r,o,_),o=_+1):(cy(a,r,_+1,u),u=_)}}function Ff(a,r,o){const u=a[r];a[r]=a[o],a[o]=u}Wt(zf,"FeaturePositionMap");class Cl{constructor(r){this.gl=r.gl,this.initialized=!1}fetchUniformLocation(r,o){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(r,o),this.initialized=!0),!!this.location}set(r,o,u){throw new Error("Uniform#set() must be implemented by each concrete Uniform")}}class Bf extends Cl{constructor(r){super(r),this.current=0}set(r,o,u){this.fetchUniformLocation(r,o)&&this.current!==u&&(this.current=u,this.gl.uniform1i(this.location,u))}}class po extends Cl{constructor(r){super(r),this.current=0}set(r,o,u){this.fetchUniformLocation(r,o)&&this.current!==u&&(this.current=u,this.gl.uniform1f(this.location,u))}}class Il extends Cl{constructor(r){super(r),this.current=[0,0]}set(r,o,u){this.fetchUniformLocation(r,o)&&(u[0]===this.current[0]&&u[1]===this.current[1]||(this.current=u,this.gl.uniform2f(this.location,u[0],u[1])))}}class Nf extends Cl{constructor(r){super(r),this.current=[0,0,0]}set(r,o,u){this.fetchUniformLocation(r,o)&&(u[0]===this.current[0]&&u[1]===this.current[1]&&u[2]===this.current[2]||(this.current=u,this.gl.uniform3f(this.location,u[0],u[1],u[2])))}}class Vf extends Cl{constructor(r){super(r),this.current=[0,0,0,0]}set(r,o,u){this.fetchUniformLocation(r,o)&&(u[0]===this.current[0]&&u[1]===this.current[1]&&u[2]===this.current[2]&&u[3]===this.current[3]||(this.current=u,this.gl.uniform4f(this.location,u[0],u[1],u[2],u[3])))}}class s1 extends Cl{constructor(r){super(r),this.current=Pr.transparent.toPremultipliedRenderColor(null)}set(r,o,u){this.fetchUniformLocation(r,o)&&(u.r===this.current.r&&u.g===this.current.g&&u.b===this.current.b&&u.a===this.current.a||(this.current=u,this.gl.uniform4f(this.location,u.r,u.g,u.b,u.a)))}}const AS=new Float32Array(16);class $f extends Cl{constructor(r){super(r),this.current=AS}set(r,o,u){if(this.fetchUniformLocation(r,o)){if(u[12]!==this.current[12]||u[0]!==this.current[0])return this.current=u,void this.gl.uniformMatrix4fv(this.location,!1,u);for(let h=1;h<16;h++)if(u[h]!==this.current[h]){this.current=u,this.gl.uniformMatrix4fv(this.location,!1,u);break}}}}const PS=new Float32Array(9),RS=new Float32Array(4);class Mm extends Cl{constructor(r){super(r),this.current=RS}set(r,o,u){if(this.fetchUniformLocation(r,o)){for(let h=0;h<4;h++)if(u[h]!==this.current[h]){this.current=u,this.gl.uniformMatrix2fv(this.location,!1,u);break}}}}function Uf(a){return[Lf(255*a.r,255*a.g),Lf(255*a.b,255*a.a)]}class ya{constructor(r,o,u,h){this.value=r,this.uniformNames=o.map((g=>`u_${g}`)),this.type=u,this.context=h}setUniform(r,o,u,h,g){const _=h.constantOr(this.value);o.set(r,g,_ instanceof Pr?_.toPremultipliedRenderColor(this.lutExpression&&this.lutExpression.kind==="constant"&&this.lutExpression.value==="none"?null:this.context.lut):_)}getBinding(r,o){return this.type==="color"?new s1(r):new po(r)}}class Ju{constructor(r,o){this.uniformNames=o.map((u=>`u_${u}`)),this.pattern=null,this.patternTransition=null,this.pixelRatio=1}setConstantPatternPositions(r,o){this.pixelRatio=r.pixelRatio||1,this.pattern=r.tl.concat(r.br),this.patternTransition=o?o.tl.concat(o.br):this.pattern}setUniform(r,o,u,h,g){let _=null;g!=="u_pattern"&&g!=="u_dash"||(_=this.pattern),g==="u_pattern_b"&&(_=this.patternTransition),g==="u_pixel_ratio"&&(_=this.pixelRatio),_&&o.set(r,g,_)}getBinding(r,o){return o==="u_pattern"||o==="u_pattern_b"||o==="u_dash"?new Vf(r):new po(r)}}class jc{constructor(r,o,u,h){this.expression=r,this.type=u,this.maxValue=0,this.paintVertexAttributes=o.map((g=>({name:`a_${g}`,type:"Float32",components:u==="color"?2:1,offset:0}))),this.paintVertexArray=new h}populatePaintArray(r,o,u,h,g,_,b,T){const E=this.paintVertexArray.length,A=this.expression.kind==="composite"||this.expression.kind==="source"?this.expression.evaluate(new pi(0,{brightness:_,worldview:T}),o,{},g,h,b):this.expression.kind==="constant"&&this.expression.value,R=!!this.lutExpression&&(this.lutExpression.kind==="composite"||this.lutExpression.kind==="source"?this.lutExpression.evaluate(new pi(0,{brightness:_,worldview:T}),o,{},g,h,b):this.lutExpression.value)==="none";this.paintVertexArray.resize(r),this._setPaintValue(E,r,A,R?null:this.context.lut)}updatePaintArray(r,o,u,h,g,_,b,T){const E=this.expression.kind==="composite"||this.expression.kind==="source"?this.expression.evaluate({zoom:0,brightness:b,worldview:T},u,h,void 0,g):this.expression.kind==="constant"&&this.expression.value,A=!!this.lutExpression&&(this.lutExpression.kind==="composite"||this.lutExpression.kind==="source"?this.lutExpression.evaluate(new pi(0,{brightness:b,worldview:T}),u,h,void 0,g):this.lutExpression.value)==="none";this._setPaintValue(r,o,E,A?null:this.context.lut)}_setPaintValue(r,o,u,h){if(this.type==="color"){const g=Uf(u.toPremultipliedRenderColor(h));for(let _=r;_<o;_++)this.paintVertexArray.emplace(_,g[0],g[1])}else{for(let g=r;g<o;g++)this.paintVertexArray.emplace(g,u);this.maxValue=Math.max(this.maxValue,Math.abs(u))}}upload(r){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=r.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.lutExpression&&this.lutExpression.kind!=="constant"&&(this.lutExpression.isStateDependent||!this.lutExpression.isLightConstant)||this.expression.kind!=="constant"&&(this.expression.isStateDependent||!this.expression.isLightConstant)))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Ql{constructor(r,o,u,h,g,_){this.expression=r,this.uniformNames=o.map((b=>`u_${b}_t`)),this.type=u,this.useIntegerZoom=h,this.context=g,this.maxValue=0,this.paintVertexAttributes=o.map((b=>({name:`a_${b}`,type:"Float32",components:u==="color"?4:2,offset:0}))),this.paintVertexArray=new _}populatePaintArray(r,o,u,h,g,_,b,T){const E=this.expression.evaluate(new pi(this.context.zoom,{brightness:_,worldview:T}),o,{},g,h,b),A=this.expression.evaluate(new pi(this.context.zoom+1,{brightness:_,worldview:T}),o,{},g,h,b),R=!!this.lutExpression&&(this.lutExpression.kind==="composite"||this.lutExpression.kind==="source"?this.lutExpression.evaluate(new pi(0,{brightness:_,worldview:T}),o,{},g,h,b):this.lutExpression.value)==="none",M=this.paintVertexArray.length;this.paintVertexArray.resize(r),this._setPaintValue(M,r,E,A,R?null:this.context.lut)}updatePaintArray(r,o,u,h,g,_,b,T){const E=this.expression.evaluate({zoom:this.context.zoom,brightness:b,worldview:T},u,h,void 0,g),A=this.expression.evaluate({zoom:this.context.zoom+1,brightness:b,worldview:T},u,h,void 0,g),R=!!this.lutExpression&&(this.lutExpression.kind==="composite"||this.lutExpression.kind==="source"?this.lutExpression.evaluate(new pi(0,{brightness:b,worldview:T}),u,h,void 0,g):this.lutExpression.value)==="none";this._setPaintValue(r,o,E,A,R?null:this.context.lut)}_setPaintValue(r,o,u,h,g){if(this.type==="color"){const _=Uf(u.toPremultipliedRenderColor(g)),b=Uf(u.toPremultipliedRenderColor(g));for(let T=r;T<o;T++)this.paintVertexArray.emplace(T,_[0],_[1],b[0],b[1])}else{for(let _=r;_<o;_++)this.paintVertexArray.emplace(_,u,h);this.maxValue=Math.max(this.maxValue,Math.abs(u),Math.abs(h))}}upload(r){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=r.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(r,o,u,h,g){const _=this.useIntegerZoom?Math.floor(u.zoom):u.zoom,b=be(this.expression.interpolationFactor(_,this.context.zoom,this.context.zoom+1),0,1);o.set(r,g,b)}getBinding(r,o){return new po(r)}}class ec{constructor(r,o,u,h,g){this.expression=r,this.layerId=g,this.paintVertexAttributes=(u==="array"?Om:CS).members;for(let _=0;_<o.length;++_);this.paintVertexArray=new h,this.paintTransitionVertexArray=new nh}populatePaintArray(r,o,u,h){const g=this.paintVertexArray.length;this.paintVertexArray.resize(r),this._setPaintValues(g,r,o.patterns&&o.patterns[this.layerId],u)}updatePaintArray(r,o,u,h,g,_,b){this._setPaintValues(r,o,u.patterns&&u.patterns[this.layerId],_)}_setPaintValues(r,o,u,h){if(!h||!u)return;const g=h[u[0]],_=h[u[1]];if(g){if(g){const{tl:b,br:T,pixelRatio:E}=g;for(let A=r;A<o;A++)this.paintVertexArray.emplace(A,b[0],b[1],T[0],T[1],E)}if(_){this.paintTransitionVertexArray.resize(this.paintVertexArray.length);const{tl:b,br:T}=_;for(let E=r;E<o;E++)this.paintTransitionVertexArray.emplace(E,b[0],b[1],T[0],T[1])}}}upload(r){const o=this.expression.isStateDependent||!this.expression.isLightConstant;this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=r.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,o)),this.paintTransitionVertexArray&&this.paintTransitionVertexArray.length&&(this.paintTransitionVertexBuffer=r.createVertexBuffer(this.paintTransitionVertexArray,IS.members,o))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy(),this.paintTransitionVertexBuffer&&this.paintTransitionVertexBuffer.destroy()}}class Qu{constructor(r,o,u=(()=>!0)){this.binders={},this._buffers=[],this.context=o;const h=[];for(const g in r.paint._values){const _=r.paint.get(g);if(g.endsWith("-use-theme")||!u(g)||!(_ instanceof Wu&&am(_.property.specification)))continue;const b=RP(g,r.type),T=_.value,E=_.property.specification.type,A=!!_.property.useIntegerZoom,R=g==="line-dasharray"||g.endsWith("pattern"),M=r.paint.get(`${g}-use-theme`),F=g==="line-dasharray"&&r.layout.get("line-cap").value.kind!=="constant"||M&&M.value.kind!=="constant";if(T.kind!=="constant"||F)if(T.kind==="source"||F||R){const B=c(g,E,"source");this.binders[g]=R?new ec(T,b,E,B,r.id):new jc(T,b,E,B),h.push(`/a_${g}`)}else{const B=c(g,E,"composite");this.binders[g]=new Ql(T,b,E,A,o,B),h.push(`/z_${g}`)}else this.binders[g]=R?new Ju(T.value,b):new ya(T.value,b,E,o),h.push(`/u_${g}`);M&&(this.binders[g].lutExpression=M.value)}this.cacheKey=h.sort().join("")}getMaxValue(r){const o=this.binders[r];return o instanceof jc||o instanceof Ql?o.maxValue:0}populatePaintArrays(r,o,u,h,g,_,b,T){for(const E in this.binders){const A=this.binders[E];A.context=this.context,(A instanceof jc||A instanceof Ql||A instanceof ec)&&A.populatePaintArray(r,o,u,h,g,_,b,T)}}setConstantPatternPositions(r,o){for(const u in this.binders){const h=this.binders[u];h instanceof Ju&&h.setConstantPatternPositions(r,o)}}getPatternTransitionVertexBuffer(r){const o=this.binders[r];return o instanceof ec?o.paintTransitionVertexBuffer:null}updatePaintArrays(r,o,u,h,g,_,b,T,E,A){let R=!1;const M=Object.keys(r),F=M.length!==0&&!T,B=F?M:o.uniqueIds;this.context.lut=g.lut;for(const W in this.binders){const q=this.binders[W];if(q.context=this.context,(q instanceof jc||q instanceof Ql||q instanceof ec)&&q.expression&&q.expression.kind&&q.expression.kind!=="constant"&&(q.expression.isStateDependent===!0||q.expression.isLightConstant===!1)){const K=g.paint.get(W);q.expression=K.value;for(const ne of B){const re=r[ne.toString()];o.eachPosition(ne,((oe,ye,ve)=>{const Ce=h.feature(oe);q.updatePaintArray(ye,ve,Ce,re,_,b,E,A)}))}if(!F)for(const ne of u.uniqueIds){const re=r[ne.toString()];u.eachPosition(ne,((oe,ye,ve)=>{const Ce=h.feature(oe);q.updatePaintArray(ye,ve,Ce,re,_,b,E,A)}))}R=!0}}return R}defines(){const r=[];for(const o in this.binders){const u=this.binders[o];(u instanceof ya||u instanceof Ju)&&r.push(...u.uniformNames.map((h=>`#define HAS_UNIFORM_${h}`)))}return r}getPaintVertexBuffers(){return this._buffers}getUniforms(r){const o=[];for(const u in this.binders){const h=this.binders[u];if(h instanceof ya||h instanceof Ju||h instanceof Ql)for(const g of h.uniformNames)o.push({name:g,property:u,binding:h.getBinding(r,g)})}return o}setUniforms(r,o,u,h,g){for(const{name:_,property:b,binding:T}of u)this.binders[b].setUniform(r,T,g,h.get(b),_)}updatePaintBuffers(){this._buffers=[];for(const r in this.binders){const o=this.binders[r];(o instanceof jc||o instanceof Ql||o instanceof ec)&&o.paintVertexBuffer&&this._buffers.push(o.paintVertexBuffer),o instanceof ec&&o.paintTransitionVertexBuffer&&this._buffers.push(o.paintTransitionVertexBuffer)}}upload(r){for(const o in this.binders){const u=this.binders[o];(u instanceof jc||u instanceof Ql||u instanceof ec)&&u.upload(r)}this.updatePaintBuffers()}destroy(){for(const r in this.binders){const o=this.binders[r];(o instanceof jc||o instanceof Ql||o instanceof ec)&&o.destroy()}}}class tl{constructor(r,o,u=(()=>!0)){this.programConfigurations={};for(const h of r)this.programConfigurations[h.id]=new Qu(h,o,u);this.needsUpload=!1,this._featureMap=new zf,this._featureMapWithoutIds=new zf,this._bufferOffset=0,this._idlessCounter=0}populatePaintArrays(r,o,u,h,g,_,b,T,E){for(const A in this.programConfigurations)this.programConfigurations[A].populatePaintArrays(r,o,h,g,_,b,T,E);o.id!==void 0?this._featureMap.add(o.id,u,this._bufferOffset,r):(this._featureMapWithoutIds.add(this._idlessCounter,u,this._bufferOffset,r),this._idlessCounter+=1),this._bufferOffset=r,this.needsUpload=!0}updatePaintArrays(r,o,u,h,g,_,b,T){for(const E of u)this.needsUpload=this.programConfigurations[E.id].updatePaintArrays(r,this._featureMap,this._featureMapWithoutIds,o,E,h,g,_,b||0,T)||this.needsUpload}get(r){return this.programConfigurations[r]}upload(r){if(this.needsUpload){for(const o in this.programConfigurations)this.programConfigurations[o].upload(r);this.needsUpload=!1}}destroy(){for(const r in this.programConfigurations)this.programConfigurations[r].destroy()}}const a1={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-occlusion-opacity":["occlusion_opacity"],"icon-occlusion-opacity":["occlusion_opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-emissive-strength":["emissive_strength"],"icon-emissive-strength":["emissive_strength"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"symbol-z-offset":["z_offset"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio","pattern_b"],"fill-pattern":["pattern","pixel_ratio","pattern_b"],"fill-extrusion-pattern":["pattern","pixel_ratio","pattern_b"],"line-dasharray":["dash"],"fill-bridge-guard-rail-color":["structure_color"],"fill-tunnel-structure-color":["structure_color"]};function RP(a,r){return a1[a]||[a.replace(`${r}-`,"").replace(/-/g,"_")]}const m={"line-pattern":{source:Uc,composite:Uc},"fill-pattern":{source:Uc,composite:Uc},"fill-extrusion-pattern":{source:Uc,composite:Uc},"line-dasharray":{source:nh,composite:nh}},i={color:{source:oh,composite:el},number:{source:$c,composite:oh}};function c(a,r,o){const u=m[a];return u&&u[o]||i[r][o]}Wt(ya,"ConstantBinder"),Wt(Ju,"PatternConstantBinder"),Wt(jc,"SourceExpressionBinder"),Wt(ec,"PatternCompositeBinder"),Wt(Ql,"CompositeExpressionBinder"),Wt(Qu,"ProgramConfiguration",{omit:["_buffers"]}),Wt(tl,"ProgramConfigurationSet");const p=zt/Math.PI/2,y=5,v=6,w=16383,S=64,I=[S,32,16],O=-p,D=p;function N(a,r,o,u=p){return o=Fe(o),[a*Math.sin(o)*u,-r*u,a*Math.cos(o)*u]}function z(a,r,o){return N(Math.cos(Fe(a)),Math.sin(Fe(a)),r,o)}const U=63710088e-1,G=2*Math.PI*U;class H{constructor(r,o){if(isNaN(r)||isNaN(o))throw new Error(`Invalid LngLat object: (${r}, ${o})`);if(this.lng=+r,this.lat=+o,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new H(ze(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(r){const o=Math.PI/180,u=this.lat*o,h=r.lat*o,g=Math.sin(u)*Math.sin(h)+Math.cos(u)*Math.cos(h)*Math.cos((r.lng-this.lng)*o);return U*Math.acos(Math.min(g,1))}toBounds(r=0){const o=360*r/40075017,u=o/Math.cos(Math.PI/180*this.lat);return new J({lng:this.lng-u,lat:this.lat-o},{lng:this.lng+u,lat:this.lat+o})}toEcef(r){return z(this.lat,this.lng,p+r*p/U)}static convert(r){if(r instanceof H)return r;if(Array.isArray(r)&&(r.length===2||r.length===3))return new H(Number(r[0]),Number(r[1]));if(!Array.isArray(r)&&typeof r=="object"&&r!==null)return new H(Number("lng"in r?r.lng:r.lon),Number(r.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}class J{constructor(r,o){r&&(o?this.setSouthWest(r).setNorthEast(o):Array.isArray(r)&&r.length===4?this.setSouthWest([r[0],r[1]]).setNorthEast([r[2],r[3]]):this.setSouthWest(r[0]).setNorthEast(r[1]))}setNorthEast(r){return this._ne=r instanceof H?new H(r.lng,r.lat):H.convert(r),this}setSouthWest(r){return this._sw=r instanceof H?new H(r.lng,r.lat):H.convert(r),this}extend(r){const o=this._sw,u=this._ne;let h,g;if(r instanceof H)h=r,g=r;else{if(!(r instanceof J))return Array.isArray(r)?r.length===4||r.every(Array.isArray)?this.extend(J.convert(r)):this.extend(H.convert(r)):typeof r=="object"&&r!==null&&r.hasOwnProperty("lat")&&(r.hasOwnProperty("lon")||r.hasOwnProperty("lng"))?this.extend(H.convert(r)):this;if(h=r._sw,g=r._ne,!h||!g)return this}return o||u?(o.lng=Math.min(h.lng,o.lng),o.lat=Math.min(h.lat,o.lat),u.lng=Math.max(g.lng,u.lng),u.lat=Math.max(g.lat,u.lat)):(this._sw=new H(h.lng,h.lat),this._ne=new H(g.lng,g.lat)),this}getCenter(){return new H((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new H(this.getWest(),this.getNorth())}getSouthEast(){return new H(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(r){const{lng:o,lat:u}=H.convert(r);let h=this._sw.lng<=o&&o<=this._ne.lng;return this._sw.lng>this._ne.lng&&(h=this._sw.lng>=o&&o>=this._ne.lng),this._sw.lat<=u&&u<=this._ne.lat&&h}static convert(r){if(r)return r instanceof J?r:new J(r)}}const Z=0,ee=25.5;function ie(a){return G*Math.cos(a*Math.PI/180)}function se(a){return(180+a)/360}function me(a){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+a*Math.PI/360)))/360}function fe(a,r){return a/ie(r)}function ge(a){return 360*a-180}function pe(a){return 360/Math.PI*Math.atan(Math.exp((180-360*a)*Math.PI/180))-90}function he(a,r){return a*ie(pe(r))}const _e=85.051129;function Ke(a){return Math.cos(Fe(be(a,-_e,_e)))}function Le(a,r){const o=be(r,Z,ee),u=Math.pow(2,o);return Ke(a)*G/(512*u)}function st(a){return 1/Math.cos(a*Math.PI/180)}function We(a,r=0){const o=Math.exp(Math.PI*(1-(a.y+r/zt)/(1<<a.z)*2));return 80150034*o/(o*o+1)/zt/(1<<a.z)}class it{constructor(r,o,u=0){this.x=+r,this.y=+o,this.z=+u}static fromLngLat(r,o=0){const u=H.convert(r);return new it(se(u.lng),me(u.lat),fe(o,u.lat))}toLngLat(){return new H(ge(this.x),pe(this.y))}toAltitude(){return he(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/G*st(pe(this.y))}}function Pt(a,r,o,u,h,g,_,b,T){const E=(r+u)/2,A=(o+h)/2,R=new xt(E,A);b(R),(function(M,F,B,W,q,K){const ne=B-q,re=W-K;return Math.abs((W-F)*ne-(B-M)*re)/Math.hypot(ne,re)})(R.x,R.y,g.x,g.y,_.x,_.y)>=T?(Pt(a,r,o,E,A,g,R,b,T),Pt(a,E,A,u,h,R,_,b,T)):a.push(_)}function qe(a,r,o){let u=a[0],h=u.x,g=u.y;r(u);const _=[u];for(let b=1;b<a.length;b++){const T=a[b],{x:E,y:A}=T;r(T),Pt(_,h,g,E,A,u,T,r,o),h=E,g=A,u=T}return _}function Ae(a,r,o,u){if(u(r,o)){const h=r.add(o)._mult(.5);Ae(a,r,h,u),Ae(a,h,o,u)}else a.push(o)}function at(a,r){let o=a[0];const u=[o];for(let h=1;h<a.length;h++){const g=a[h];Ae(u,o,g,r),o=g}return u}const Je=Math.pow(2,14)-1,_t=-Je-1;function At(a,r){const o=Math.round(a.x*r),u=Math.round(a.y*r);return a.x=be(o,_t,Je),a.y=be(u,_t,Je),(o<a.x||o>a.x+1||u<a.y||u>a.y+1)&&cr("Geometry exceeds allowed extent, reduce your vector tile buffer size"),a}function Ut(a,r,o){const u=a.loadGeometry(),h=a.extent,g=zt/h;if(r&&o&&o.projection.isReprojectedInTileSpace){const _=1<<r.z,{scale:b,x:T,y:E,projection:A}=o,R=M=>{const F=ge((r.x+M.x/h)/_),B=pe((r.y+M.y/h)/_),W=A.project(F,B);M.x=(W.x*b-T)*h,M.y=(W.y*b-E)*h};for(let M=0;M<u.length;M++)if(a.type!==1)u[M]=qe(u[M],R,1);else{const F=[];for(const B of u[M])B.x<0||B.x>=h||B.y<0||B.y>=h||(R(B),F.push(B));u[M]=F}}for(const _ of u)for(const b of _)At(b,g);return u}function St(a,r){return{type:a.type,id:a.id,properties:a.properties,geometry:r?Ut(a):[]}}class bt{constructor(r,o,u,h,g){this.properties={},this.extent=u,this.type=0,this.id=void 0,this._pbf=r,this._geometry=-1,this._keys=h,this._values=g,r.readFields(un,this,o)}loadGeometry(){const r=this._pbf;r.pos=this._geometry;const o=r.readVarint()+r.pos,u=[];let h,g=1,_=0,b=0,T=0;for(;r.pos<o;){if(_<=0){const E=r.readVarint();g=7&E,_=E>>3}if(_--,g===1||g===2)b+=r.readSVarint(),T+=r.readSVarint(),g===1&&(h&&u.push(h),h=[]),h&&h.push(new xt(b,T));else{if(g!==7)throw new Error(`unknown command ${g}`);h&&h.push(h[0].clone())}}return h&&u.push(h),u}bbox(){const r=this._pbf;r.pos=this._geometry;const o=r.readVarint()+r.pos;let u=1,h=0,g=0,_=0,b=1/0,T=-1/0,E=1/0,A=-1/0;for(;r.pos<o;){if(h<=0){const R=r.readVarint();u=7&R,h=R>>3}if(h--,u===1||u===2)g+=r.readSVarint(),_+=r.readSVarint(),g<b&&(b=g),g>T&&(T=g),_<E&&(E=_),_>A&&(A=_);else if(u!==7)throw new Error(`unknown command ${u}`)}return[b,E,T,A]}toGeoJSON(r,o,u){const h=this.extent*Math.pow(2,u),g=this.extent*r,_=this.extent*o,b=this.loadGeometry();function T(M){return[360*(M.x+g)/h-180,360/Math.PI*Math.atan(Math.exp((1-2*(M.y+_)/h)*Math.PI))-90]}function E(M){return M.map(T)}let A;if(this.type===1){const M=[];for(const B of b)M.push(B[0]);const F=E(M);A=M.length===1?{type:"Point",coordinates:F[0]}:{type:"MultiPoint",coordinates:F}}else if(this.type===2){const M=b.map(E);A=M.length===1?{type:"LineString",coordinates:M[0]}:{type:"MultiLineString",coordinates:M}}else{if(this.type!==3)throw new Error("unknown feature type");{const M=(function(B){const W=B.length;if(W<=1)return[B];const q=[];let K,ne;for(let re=0;re<W;re++){const oe=en(B[re]);oe!==0&&(ne===void 0&&(ne=oe<0),ne===oe<0?(K&&q.push(K),K=[B[re]]):K&&K.push(B[re]))}return K&&q.push(K),q})(b),F=[];for(const B of M)F.push(B.map(E));A=F.length===1?{type:"Polygon",coordinates:F[0]}:{type:"MultiPolygon",coordinates:F}}}const R={type:"Feature",geometry:A,properties:this.properties};return this.id!=null&&(R.id=this.id),R}}function un(a,r,o){a===1?r.id=o.readVarint():a===2?(function(u,h){const g=u.readVarint()+u.pos;for(;u.pos<g;){const _=h._keys[u.readVarint()],b=h._values[u.readVarint()];h.properties[_]=b}})(o,r):a===3?r.type=o.readVarint():a===4&&(r._geometry=o.pos)}function en(a){let r=0;for(let o,u,h=0,g=a.length,_=g-1;h<g;_=h++)o=a[h],u=a[_],r+=(u.x-o.x)*(o.y+u.y);return r}bt.types=["Unknown","Point","LineString","Polygon"];class an{constructor(r,o){this.version=1,this.name="",this.extent=4096,this.length=0,this._pbf=r,this._keys=[],this._values=[],this._features=[],r.readFields(Qt,this,o),this.length=this._features.length}feature(r){if(r<0||r>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[r];const o=this._pbf.readVarint()+this._pbf.pos;return new bt(this._pbf,o,this.extent,this._keys,this._values)}}function Qt(a,r,o){a===15?r.version=o.readVarint():a===1?r.name=o.readString():a===5?r.extent=o.readVarint():a===2?r._features.push(o.pos):a===3?r._keys.push(o.readString()):a===4&&r._values.push((function(u){let h=null;const g=u.readVarint()+u.pos;for(;u.pos<g;){const _=u.readVarint()>>3;h=_===1?u.readString():_===2?u.readFloat():_===3?u.readDouble():_===4?u.readVarint64():_===5?u.readVarint():_===6?u.readSVarint():_===7?u.readBoolean():null}if(h==null)throw new Error("unknown feature value");return h})(o))}class Ln{constructor(r,o){this.layers=r.readFields(Hn,{},o)}}function Hn(a,r,o){if(a===3){const u=new an(o,o.readVarint()+o.pos);u.length&&(r[u.name]=u)}}const qn="3d_elevation_id",Wr="level";class Bn{constructor(){this._valid=!1}reset(r){return this.feature=r,this._valid=!0,this._geometry=r.loadGeometry(),this._geometry.length!==0&&this._geometry[0].length!==0||(this._valid=!1),this}geometry(r,o){return this._valid&&r(o(this._geometry)),this}require(r,o,u){return this.get(r,!0,o,u)}optional(r,o,u){return this.get(r,!1,o,u)}success(){return this._valid}get(r,o,u,h){const g=this.feature.properties.hasOwnProperty(r)?+this.feature.properties[r]:void 0;return this._valid&&g!==void 0&&!Number.isNaN(g)?u(h?h(g):g):o&&(this._valid=!1),this}}class Or{constructor(r,o){this.featureFunc=r,this.vertexFunc=o}parseFeature(r,o,u){return this.featureFunc(r,o,u)}parseVertex(r,o,u){return this.vertexFunc(r,o,u)}}const Gr=new Or(((a,r,o)=>a.reset(r).require(qn,(u=>{o.id=u})).optional("fixed_height_relative",(u=>{o.constantHeight=u}),Wn.decodeRelativeHeight).geometry((u=>{o.bounds=u}),Vp).success()),((a,r,o)=>a.reset(r).require(qn,(u=>{o.id=u})).require("elevation_idx",(u=>{o.idx=u})).require("extent",(u=>{o.extent=u})).require("height_relative",(u=>{o.height=u}),Wn.decodeRelativeHeight).geometry((u=>{o.position=u}),Wn.getPoint).success())),Ti=new Or(((a,r,o)=>a.reset(r).require(qn,(u=>{o.id=u})).optional("fixed_height",(u=>{o.constantHeight=u}),Wn.decodeMetricHeight).geometry((u=>{o.bounds=u}),Vp).success()),((a,r,o)=>a.reset(r).require(qn,(u=>{o.id=u})).require("elevation_idx",(u=>{o.idx=u})).require("extent",(u=>{o.extent=u})).require("height",(u=>{o.height=u}),Wn.decodeMetricHeight).geometry((u=>{o.position=u}),Wn.getPoint).success()));class Wn{static getPoint(r){return oo(r[0][0].x,r[0][0].y)}static decodeRelativeHeight(r){return 1e-4*r*5}static decodeMetricHeight(r){return 1e-4*r}static getVersionSchema(r){return r?r==="1.0.1"?Ti:void 0:Gr}static parse(r){const o=[],u=[],h=r.length,g=new Bn;for(let _=0;_<h;_++){const b=r.feature(_),T=b.properties.version,E=Wn.getVersionSchema(T);if(E===void 0){cr(`Unknown elevation feature version number ${T||"(unknown)"}`);continue}const A=b.properties.type;if(!A)continue;const R=bt.types[b.type];if(R==="Point"&&A==="curve_point"){const M={};E.parseVertex(g,b,M)&&o.push(M)}else if(R==="Polygon"&&A==="curve_meta"){const M={};E.parseFeature(g,b,M)&&u.push(M)}}return{vertices:o,features:u}}}class Lr{constructor(r,o){this.pos=r,this.dir=o}intersectsPlane(r,o,u){const h=ko(o,this.dir);if(Math.abs(h)<1e-6)return!1;const g=((r[0]-this.pos[0])*o[0]+(r[1]-this.pos[1])*o[1])/h;return u[0]=this.pos[0]+this.dir[0]*g,u[1]=this.pos[1]+this.dir[1]*g,!0}}class Mr{constructor(r,o){this.pos=r,this.dir=o}intersectsPlane(r,o,u){const h=Ot(o,this.dir);if(Math.abs(h)<1e-6)return!1;const g=((r[0]-this.pos[0])*o[0]+(r[1]-this.pos[1])*o[1]+(r[2]-this.pos[2])*o[2])/h;return u[0]=this.pos[0]+this.dir[0]*g,u[1]=this.pos[1]+this.dir[1]*g,u[2]=this.pos[2]+this.dir[2]*g,!0}closestPointOnSphere(r,o,u){if((function(F,B){var W=F[0],q=F[1],K=F[2],ne=B[0],re=B[1],oe=B[2];return Math.abs(W-ne)<=C*Math.max(1,Math.abs(W),Math.abs(ne))&&Math.abs(q-re)<=C*Math.max(1,Math.abs(q),Math.abs(re))&&Math.abs(K-oe)<=C*Math.max(1,Math.abs(K),Math.abs(oe))})(this.pos,r)||o===0)return u[0]=u[1]=u[2]=0,!1;const[h,g,_]=this.dir,b=this.pos[0]-r[0],T=this.pos[1]-r[1],E=this.pos[2]-r[2],A=h*h+g*g+_*_,R=2*(b*h+T*g+E*_),M=R*R-4*A*(b*b+T*T+E*E-o*o);if(M<0){const F=Math.max(-R/2,0),B=b+h*F,W=T+g*F,q=E+_*F,K=Math.hypot(B,W,q);return u[0]=B*o/K,u[1]=W*o/K,u[2]=q*o/K,!1}{const F=(-R-Math.sqrt(M))/(2*A);if(F<0){const B=Math.hypot(b,T,E);return u[0]=b*o/B,u[1]=T*o/B,u[2]=E*o/B,!1}return u[0]=b+h*F,u[1]=T+g*F,u[2]=E+_*F,!0}}}class $r{constructor(r,o,u,h,g){this.TL=r,this.TR=o,this.BR=u,this.BL=h,this.horizon=g}static fromInvProjectionMatrix(r,o,u){const h=[-1,1,1],g=[1,1,1],_=[1,-1,1],b=[-1,-1,1],T=vn(h,h,r),E=vn(g,g,r),A=vn(_,_,r),R=vn(b,b,r);return new $r(T,E,A,R,o/u)}}function Ei(a,r,o){let u=1/0,h=-1/0;const g=[];for(const _ of a){Lt(g,_,r);const b=Ot(g,o);u=Math.min(u,b),h=Math.max(h,b)}return[u,h]}function no(a,r){let o=!0;for(let u=0;u<a.planes.length;u++){const h=a.planes[u];let g=0;for(let _=0;_<r.length;_++)g+=+(Ot(h,r[_])+h[3]>=0);if(g===0)return 0;g!==r.length&&(o=!1)}return o?2:1}function Vo(a,r){for(const o of a.projections){const u=Ei(r,a.points[0],o.axis);if(o.projection[1]<u[0]||o.projection[0]>u[1])return 0}return 1}function Ci(a,r){let o=0;const u=[0,0,0,0];for(let _=0;_<a.length;_++)u[0]=a[_][0],u[1]=a[_][1],u[2]=a[_][2],u[3]=1,(h=u)[0]*(g=r)[0]+h[1]*g[1]+h[2]*g[2]+h[3]*g[3]>=0&&o++;var h,g;return o}class Kn{constructor(r,o){this.points=r||new Array(8).fill([0,0,0]),this.planes=o||new Array(6).fill([0,0,0,0]),this.bounds=kn.fromPoints(this.points),this.projections=[],this.frustumEdges=[Lt([],this.points[2],this.points[3]),Lt([],this.points[0],this.points[3]),Lt([],this.points[4],this.points[0]),Lt([],this.points[5],this.points[1]),Lt([],this.points[6],this.points[2]),Lt([],this.points[7],this.points[3])];for(const u of this.frustumEdges){const h=[0,-u[2],u[1]],g=[u[2],0,-u[0]];this.projections.push({axis:h,projection:Ei(this.points,this.points[0],h)}),this.projections.push({axis:g,projection:Ei(this.points,this.points[0],g)})}}static fromInvProjectionMatrix(r,o,u,h){const g=Math.pow(2,u),_=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map((E=>{const A=Zt([],E,r),R=1/A[3]/o*g;return(M=A)[0]=(F=A)[0]*(B=[R,R,h?1/A[3]:R,R])[0],M[1]=F[1]*B[1],M[2]=F[2]*B[2],M[3]=F[3]*B[3],M;var M,F,B})),b=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map((E=>{const A=ur([],ln([],Lt([],_[E[0]],_[E[1]]),Lt([],_[E[2]],_[E[1]]))),R=-Ot(A,_[E[1]]);return A.concat(R)})),T=[];for(let E=0;E<_.length;E++)T.push([_[E][0],_[E][1],_[E][2]]);return new Kn(T,b)}intersectsPrecise(r,o,u){for(let h=0;h<o.length;h++)if(!Ci(r,o[h]))return 0;for(let h=0;h<this.planes.length;h++)if(!Ci(r,this.planes[h]))return 0;for(const h of u)for(const g of this.frustumEdges){const _=ln([],h,g),b=ke(_);if(b===0)continue;or(_,_,1/b);const T=Ei(this.points,this.points[0],_),E=Ei(r,this.points[0],_);if(T[0]>E[1]||E[0]>T[1])return 0}return 1}containsPoint(r){for(const o of this.planes){const u=o[3];if(Ot([o[0],o[1],o[2]],r)+u<0)return!1}return!0}}class kn{static fromPoints(r){const o=[1/0,1/0,1/0],u=[-1/0,-1/0,-1/0];for(const h of r)Br(o,o,h),ei(u,u,h);return new kn(o,u)}static fromTileIdAndHeight(r,o,u){const h=1<<r.canonical.z,g=r.canonical.x,_=r.canonical.y;return new kn([g/h,_/h,o],[(g+1)/h,(_+1)/h,u])}static applyTransform(r,o){const u=r.getCorners();for(let h=0;h<u.length;++h)vn(u[h],u[h],o);return kn.fromPoints(u)}static applyTransformFast(r,o){const u=[o[12],o[13],o[14]],h=[...u];for(let g=0;g<3;g++)for(let _=0;_<3;_++){const b=o[4*_+g],T=b*r.min[_],E=b*r.max[_];u[g]+=Math.min(T,E),h[g]+=Math.max(T,E)}return new kn(u,h)}static projectAabbCorners(r,o){const u=r.getCorners();for(let h=0;h<u.length;++h)vn(u[h],u[h],o);return u}constructor(r,o){this.min=r,this.max=o,this.center=or([],mn([],this.min,this.max),.5)}quadrant(r){const o=[r%2==0,r<2],u=Ve(this.min),h=Ve(this.max);for(let g=0;g<o.length;g++)u[g]=o[g]?this.min[g]:this.center[g],h[g]=o[g]?this.center[g]:this.max[g];return h[2]=this.max[2],new kn(u,h)}distanceX(r){return Math.max(Math.min(this.max[0],r[0]),this.min[0])-r[0]}distanceY(r){return Math.max(Math.min(this.max[1],r[1]),this.min[1])-r[1]}distanceZ(r){return Math.max(Math.min(this.max[2],r[2]),this.min[2])-r[2]}getCorners(){const r=this.min,o=this.max;return[[r[0],r[1],r[2]],[o[0],r[1],r[2]],[o[0],o[1],r[2]],[r[0],o[1],r[2]],[r[0],r[1],o[2]],[o[0],r[1],o[2]],[o[0],o[1],o[2]],[r[0],o[1],o[2]]]}intersects(r){return this.intersectsAabb(r.bounds)?no(r,this.getCorners()):0}intersectsFlat(r){return this.intersectsAabb(r.bounds)?no(r,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsPrecise(r,o){return o||this.intersects(r)?Vo(r,this.getCorners()):0}intersectsPreciseFlat(r,o){return o||this.intersectsFlat(r)?Vo(r,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsAabb(r){for(let o=0;o<3;++o)if(this.min[o]>r.max[o]||r.min[o]>this.max[o])return!1;return!0}intersectsAabbXY(r){return!(this.min[0]>r.max[0]||r.min[0]>this.max[0]||this.min[1]>r.max[1]||r.min[1]>this.max[1])}encapsulate(r){for(let o=0;o<3;o++)this.min[o]=Math.min(this.min[o],r.min[o]),this.max[o]=Math.max(this.max[o],r.max[o])}encapsulatePoint(r){for(let o=0;o<3;o++)this.min[o]=Math.min(this.min[o],r[o]),this.max[o]=Math.max(this.max[o],r[o])}closestPoint(r){return[Math.max(Math.min(this.max[0],r[0]),this.min[0]),Math.max(Math.min(this.max[1],r[1]),this.min[1]),Math.max(Math.min(this.max[2],r[2]),this.min[2])]}}Wt(kn,"Aabb");class qr{constructor(r,o){this.feature=r,this.metersToTile=o,this.index=0}get(){const r=this.feature.vertices[this.index],o=this.feature.vertexProps[this.index].dir,u=o[1],h=-o[0],g=(r.extent+1)*this.metersToTile;return[new xt(Math.trunc(r.position[0]+u*g),Math.trunc(r.position[1]+h*g)),new xt(Math.trunc(r.position[0]-u*g),Math.trunc(r.position[1]-h*g))]}next(){this.index++}valid(){return this.index<this.feature.vertices.length}}class qi{constructor(r,o,u,h,g,_){if(this.vertices=new Array,this.vertexProps=new Array,this.edges=new Array,this.edgeProps=new Array,this._tmpVec2=[Vi(),Vi(),Vi(),Vi(),Vi(),Vi(),Vi()],this.id=r,this.heightRange={min:u,max:u},this.safeArea=o,this.constantHeight=u,this.constantHeight==null&&(this.constantHeight!=null||h.length!==0)){this.vertices=h,this.edges=g,this.edges=this.edges.filter((b=>{return b.a<this.vertices.length&&b.b<this.vertices.length&&!((T=this.vertices[b.a].position)[0]===(E=this.vertices[b.b].position)[0]&&T[1]===E[1]);var T,E})),this.heightRange={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY};for(const b of this.vertices)this.vertexProps.push({dir:oo(0,0)}),this.heightRange.min=Math.min(this.heightRange.min,b.height),this.heightRange.max=Math.max(this.heightRange.max,b.height);for(const b of this.edges){const T=this.vertices[b.a].position,E=this.vertices[b.b].position,A=so(Vi(),E,T),R=Ma(A),M=Fo(Vi(),A,1/R);this.edgeProps.push({vec:A,dir:M,len:R});const F=this.vertexProps[b.a].dir,B=this.vertexProps[b.b].dir;Ws(F,F,M),Ws(B,B,M)}for(const b of this.vertexProps)b.dir[0]===0&&b.dir[1]===0||ai(b.dir,b.dir);this.tessellate(_)}}pointElevation(r){if(this.constantHeight!=null)return this.constantHeight;const o=this.getClosestEdge(r);if(o==null)return 0;const[u,h]=o;return wn(this.vertices[this.edges[u].a].height,this.vertices[this.edges[u].b].height,h)}computeSlopeNormal(r,o){const u=this.getClosestEdge(r);if(!u)return Mn(0,0,1);const h=u[0],g=this.edges[h],_=this.edgeProps[h].vec,b=Mn(_[0],_[1],(this.vertices[g.b].height-this.vertices[g.a].height)*o),T=Mn(b[1],-b[0],0);ln(T,T,b);const E=ke(T);return E>0?or(T,T,1/E):bn(T,0,0,1)}getSafeArea(){return this.safeArea}isTunnel(){return this.heightRange.max<=-5}getClosestEdge(r){if(this.edges.length===0)return;let o=0,u=Number.POSITIVE_INFINITY,h=0;const[g,_,b,T,E,A,R]=this._tmpVec2;Hs(R,r.x,r.y);const M=new Lr(R,null);for(let F=0;F<this.edges.length;F++){const B=this.edges[F],W=this.edgeProps[F].dir;M.dir=W;const q=this.vertices[B.a].position,K=this.vertices[B.b].position,ne=M.intersectsPlane(q,this.vertexProps[B.a].dir,g),re=M.intersectsPlane(K,this.vertexProps[B.b].dir,_);if(!ne||!re)continue;so(b,_,g),so(T,R,g);const oe=ko(b,b),ye=oe>0?ko(T,b)/oe:0,ve=be(ye,0,1),Ce=Math.abs((ye-ve)*this.edgeProps[F].len);so(E,R,q),Hs(A,W[1],-W[0]);const Oe=Ce+Math.abs(ko(E,A));Oe<u&&(o=F,u=Oe,h=ve)}return[o,h]}tessellate(r){const o=Re(),u=Re(),h=Re(),g=Re();for(let _=this.edges.length-1;_>=0;--_){const b=this.edges[_].a,T=this.edges[_].b,{position:E,height:A,extent:R}=this.vertices[b],{position:M,height:F,extent:B}=this.vertices[T],W=this.vertexProps[b].dir,q=this.vertexProps[T].dir;if(bn(o,E[0]/r,E[1]/r,A),bn(u,M[0]/r,M[1]/r,F),bn(h,W[1],-W[0],0),or(h,h,R),bn(g,q[1],-q[0],0),or(g,g,B),this.distSqLines(Mn(o[0]+.5*h[0],o[1]+.5*h[1],o[2]+.5*h[2]),Mn(u[0]-.5*g[0],u[1]-.5*g[1],u[2]-.5*g[2]),Mn(o[0]-.5*h[0],o[1]-.5*h[1],o[2]-.5*h[2]),Mn(u[0]+.5*g[0],u[1]+.5*g[1],u[2]+.5*g[2]))<=.0025000000000000005)continue;const K=this.vertices.length,ne=Ws(Vi(),E,M);this.vertices.push({position:Fo(ne,ne,.5),height:.5*(A+F),extent:.5*(R+B)});const re=Ws(Vi(),W,q);this.vertexProps.push({dir:ai(re,re)}),this.edges.splice(_,1),this.edgeProps.splice(_,1),this.edges.push({a:b,b:K}),this.edges.push({a:K,b:T});const oe=so(Vi(),this.vertices[K].position,E),ye=Ma(oe),ve={vec:oe,dir:Fo(Vi(),oe,1/ye),len:ye};this.edgeProps.push(ve),this.edgeProps.push(ve)}}distSqLines(r,o,u,h){const g=Sn(Re(),o,r),_=Sn(Re(),h,u),b=Sn(Re(),r,u),T=Ot(g,g),E=Ot(g,_),A=Ot(g,b),R=Ot(_,_),M=Ot(_,b),F=T*R-E*E;if(F===0)return oi(yn(g,u,h,Ot(b,_)/Ot(_,_)),r);const B=(T*M-E*A)/F;return oi(yn(g,r,o,(E*M-A*R)/F),yn(_,u,h,B))}}class ki{static parseFrom(r,o){const u=Wn.parse(r);if(!u)return[];let{vertices:h,features:g}=u;const _=1/We(o);g.sort(((A,R)=>A.id-R.id)),h.sort(((A,R)=>A.id-R.id||A.idx-R.idx)),h=h.filter(((A,R,M)=>R===M.findIndex((F=>F.id===A.id&&F.idx===A.idx))));const b=new Array;let T=0;const E=h.length;for(const A of g){if(A.constantHeight){b.push(new qi(A.id,A.bounds,A.constantHeight));continue}for(;T!==E&&h[T].id<A.id;)T++;if(T===E||h[T].id!==A.id)continue;const R=new Array,M=new Array,F=T;for(;T!==E&&h[T].id===A.id;){const B=h[T];if(R.push({position:B.position,height:B.height,extent:B.extent}),T!==F&&h[T-1].idx===B.idx-1){const W=T-F;M.push({a:W-1,b:W})}T++}b.push(new qi(A.id,A.bounds,void 0,R,M,_))}return b}static getElevationFeature(r,o){if(!o)return;const u=+r.properties[qn];return Number.isNaN(u)?void 0:o.find((h=>h.id===u))}}class yo{constructor(r,o){this.zScale=1,this.xOffset=0,this.yOffset=0,r.equals(o)||(this.zScale=Math.pow(2,o.z-r.z),this.xOffset=(r.x*this.zScale-o.x)*zt,this.yOffset=(r.y*this.zScale-o.y)*zt)}constantElevation(r,o){if(r.constantHeight!=null)return this.computeBiasedHeight(r.constantHeight,o)}pointElevation(r,o,u){const h=this.constantElevation(o,u);return h??(r.x=r.x*this.zScale+this.xOffset,r.y=r.y*this.zScale+this.yOffset,this.computeBiasedHeight(o.pointElevation(r),u))}computeBiasedHeight(r,o){return o<=0?r:r+o*tt(0,o,r>=0?r:Math.abs(.5*r))}}Wt(qi,"ElevationFeature");class Ko{constructor(r){this.zoom=r.zoom,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map((o=>o.fqid)),this.index=r.index,this.hasPattern=!1,this.projection=r.projection,this.layoutVertexArray=new Vc,this.indexArray=new Mo,this.segments=new Bi,this.programConfigurations=new tl(r.layers,{zoom:r.zoom,lut:r.lut}),this.stateDependentLayerIds=this.layers.filter((o=>o.isStateDependent())).map((o=>o.id)),this.elevationMode=this.layers[0].layout.get("circle-elevation-reference"),this.hasElevation=!1,this.elevationMode!=="none"&&(this.elevatedLayoutVertexArray=new $c),this.worldview=r.worldview}updateFootprints(r,o){}populate(r,o,u,h){const g=this.layers[0],_=[];let b=null;g.type==="circle"&&(b=g.layout.get("circle-sort-key"));for(const{feature:E,id:A,index:R,sourceLayerIndex:M}of r){const F=this.layers[0]._featureFilter.needGeometry,B=St(E,F);if(!this.layers[0]._featureFilter.filter(new pi(this.zoom,{worldview:this.worldview}),B,u))continue;const W=b?b.evaluate(B,{},u):void 0,q={id:A,properties:E.properties,type:E.type,sourceLayerIndex:M,index:R,geometry:F?B.geometry:Ut(E,u,h),patterns:{},sortKey:W};_.push(q)}b&&_.sort(((E,A)=>E.sortKey-A.sortKey));let T=null;h.projection.name==="globe"&&(this.globeExtVertexArray=new Em,T=h.projection);for(const E of _){const{geometry:A,index:R,sourceLayerIndex:M}=E,F=r[R].feature;this.addFeature(E,A,R,o.availableImages,u,T,o.brightness,o.elevationFeatures),o.featureIndex.insert(F,A,R,M,this.index)}this.hasElevation||(this.elevatedLayoutVertexArray=void 0)}update(r,o,u,h,g,_,b){this.programConfigurations.updatePaintArrays(r,o,g,u,h,_,b,this.worldview)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(r){this.uploaded||(this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,TS.members),this.indexBuffer=r.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=r.createVertexBuffer(this.globeExtVertexArray,ES.members)),this.elevatedLayoutVertexArray&&(this.elevatedLayoutVertexBuffer=r.createVertexBuffer(this.elevatedLayoutVertexArray,SS.members))),this.programConfigurations.upload(r),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy(),this.elevatedLayoutVertexBuffer&&this.elevatedLayoutVertexBuffer.destroy())}addFeature(r,o,u,h,g,_,b,T){let E;this.elevationMode!=="none"&&(E=ki.getElevationFeature(r,T));for(const A of o)for(const R of A){const M=R.x,F=R.y;if(M<0||M>=zt||F<0||F>=zt)continue;if(_){const q=_.projectTilePoint(M,F,g),K=_.upVector(g,M,F);this.addGlobeExtVertex(q,K),this.addGlobeExtVertex(q,K),this.addGlobeExtVertex(q,K),this.addGlobeExtVertex(q,K)}const B=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,r.sortKey),W=B.vertexLength;if(this.addCircleVertex(M,F,-1,-1),this.addCircleVertex(M,F,1,-1),this.addCircleVertex(M,F,1,1),this.addCircleVertex(M,F,-1,1),this.elevationMode!=="none"){const q=E?E.pointElevation(new xt(M,F)):0;this.hasElevation=this.hasElevation||q!==0;for(let K=0;K<4;K++)this.elevatedLayoutVertexArray.emplaceBack(q)}this.indexArray.emplaceBack(W,W+1,W+2),this.indexArray.emplaceBack(W,W+2,W+3),B.vertexLength+=4,B.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,r,u,{},h,g,b,void 0,this.worldview)}addCircleVertex(r,o,u,h){this.layoutVertexArray.emplaceBack(2*r+(u+1)/2,2*o+(h+1)/2)}addGlobeExtVertex(r,o){this.globeExtVertexArray.emplaceBack(r.x,r.y,r.z,o[0]*16384,o[1]*16384,o[2]*16384)}}function va(a,r){for(let o=0;o<a.length;o++)if($o(r,a[o]))return!0;for(let o=0;o<r.length;o++)if($o(a,r[o]))return!0;return!!Ts(a,r)}function ba(a,r,o){return!!$o(a,r)||!!ro(r,a,o)}function Ys(a,r){if(a.length===1)return Io(r,a[0]);for(let o=0;o<r.length;o++){const u=r[o];for(let h=0;h<u.length;h++)if($o(a,u[h]))return!0}for(let o=0;o<a.length;o++)if(Io(r,a[o]))return!0;for(let o=0;o<r.length;o++)if(Ts(a,r[o]))return!0;return!1}function Js(a,r,o){if(a.length>1){if(Ts(a,r))return!0;for(let u=0;u<r.length;u++)if(ro(r[u],a,o))return!0}for(let u=0;u<a.length;u++)if(ro(a[u],r,o))return!0;return!1}function Ts(a,r){if(a.length===0||r.length===0)return!1;for(let o=0;o<a.length-1;o++){const u=a[o],h=a[o+1];for(let g=0;g<r.length-1;g++)if(Ba(u,h,r[g],r[g+1]))return!0}return!1}function Ba(a,r,o,u){return Hi(a,o,u)!==Hi(r,o,u)&&Hi(a,r,o)!==Hi(a,r,u)}function nl(a,r,o){return(a.x-o.x)*(r.y-o.y)-(a.y-o.y)*(r.x-o.x)}function eo(a,r,o,u){const h=nl(a,r,u),g=nl(a,r,o);if(Math.sign(h)===Math.sign(g))return;const _=nl(o,u,a),b=_+g-h;return Math.sign(_)!==Math.sign(b)?[_/(_-b),g/(g-h)]:void 0}function ro(a,r,o){const u=o*o;if(r.length===1)return a.distSqr(r[0])<u;for(let h=1;h<r.length;h++)if(Oi(a,r[h-1],r[h])<u)return!0;return!1}function Oi(a,r,o){const u=r.distSqr(o);if(u===0)return a.distSqr(r);const h=((a.x-r.x)*(o.x-r.x)+(a.y-r.y)*(o.y-r.y))/u;return a.distSqr(h<0?r:h>1?o:o.sub(r)._mult(h)._add(r))}function Io(a,r){let o,u,h,g=!1;for(let _=0;_<a.length;_++){o=a[_];for(let b=0,T=o.length-1;b<o.length;T=b++)u=o[b],h=o[T],u.y>r.y!=h.y>r.y&&r.x<(h.x-u.x)*(r.y-u.y)/(h.y-u.y)+u.x&&(g=!g)}return g}function $o(a,r){let o=!1;for(let u=0,h=a.length-1;u<a.length;h=u++){const g=a[u],_=a[h];g.y>r.y!=_.y>r.y&&r.x<(_.x-g.x)*(r.y-g.y)/(_.y-g.y)+g.x&&(o=!o)}return o}function mo(a,r,o,u,h){for(const _ of a)if(r<=_.x&&o<=_.y&&u>=_.x&&h>=_.y)return!0;const g=[new xt(r,o),new xt(r,h),new xt(u,h),new xt(u,o)];if(a.length>2){for(const _ of g)if($o(a,_))return!0}for(let _=0;_<a.length-1;_++)if(ns(a[_],a[_+1],g))return!0;return!1}function ns(a,r,o){const u=o[0],h=o[2];if(a.x<u.x&&r.x<u.x||a.x>h.x&&r.x>h.x||a.y<u.y&&r.y<u.y||a.y>h.y&&r.y>h.y)return!1;const g=Hi(a,r,o[0]);return g!==Hi(a,r,o[1])||g!==Hi(a,r,o[2])||g!==Hi(a,r,o[3])}function Al(a,r,o,u,h,g){let _=r.y-a.y,b=a.x-r.x;if(g=g||0){const T=_*_+b*b;if(T===0)return!0;const E=Math.sqrt(T);_/=E,b/=E}return!((o.x-a.x)*_+(o.y-a.y)*b-g<0||(u.x-a.x)*_+(u.y-a.y)*b-g<0||(h.x-a.x)*_+(h.y-a.y)*b-g<0)}function tc(a,r,o,u,h,g,_){return!(Al(a,r,u,h,g,_)||Al(r,o,u,h,g,_)||Al(o,a,u,h,g,_)||Al(u,h,a,r,o,_)||Al(h,g,a,r,o,_)||Al(g,u,a,r,o,_))}function rl(a,r,o){const u=r.paint.get(a).value;return u.kind==="constant"?u.value:o.programConfigurations.get(r.id).getMaxValue(a)}function Gc(a){return Math.sqrt(a[0]*a[0]+a[1]*a[1])}function Hc(a,r,o,u,h){if(!r[0]&&!r[1])return a;const g=xt.convert(r)._mult(h);o==="viewport"&&g._rotate(-u);const _=[];for(let b=0;b<a.length;b++)_.push(a[b].sub(g));return _}function Pl(a,r,o,u){const h=xt.convert(a)._mult(u);return r==="viewport"&&h._rotate(-o),h}let lh,nc;function Rl(a,r,o){var u=2*Math.PI*6378137/256/Math.pow(2,o);return[a*u-2*Math.PI*6378137/2,r*u-2*Math.PI*6378137/2]}Wt(Ko,"CircleBucket",{omit:["layers"]});class rc{constructor(r,o,u){this.z=r,this.x=o,this.y=u,this.key=Lm(0,r,r,o,u)}equals(r){return this.z===r.z&&this.x===r.x&&this.y===r.y}isChildOf(r){const o=this.z-r.z;return r.z===0||r.z<this.z&&r.x===this.x>>o&&r.y===this.y>>o}url(r,o){const u=(function(g,_,b){var T=Rl(256*g,256*(_=Math.pow(2,b)-_-1),b),E=Rl(256*(g+1),256*(_+1),b);return T[0]+","+T[1]+","+E[0]+","+E[1]})(this.x,this.y,this.z),h=(function(g,_,b){let T,E="";for(let A=g;A>0;A--)T=1<<A-1,E+=(_&T?1:0)+(b&T?2:0);return E})(this.z,this.x,this.y);return r[(this.x+this.y)%r.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(o==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",h).replace("{bbox-epsg-3857}",u)}toString(){return`${this.z}/${this.x}/${this.y}`}}class Dm{constructor(r,o){this.wrap=r,this.canonical=o,this.key=Lm(r,o.z,o.z,o.x,o.y)}}class Ss{constructor(r,o,u,h,g){this.overscaledZ=r,this.wrap=o,this.canonical=new rc(u,+h,+g),this.key=o===0&&r===u?this.canonical.key:Lm(o,r,u,h,g)}equals(r){return this.overscaledZ===r.overscaledZ&&this.wrap===r.wrap&&this.canonical.equals(r.canonical)}scaledTo(r){const o=this.canonical.z-r;return r>this.canonical.z?new Ss(r,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Ss(r,this.wrap,r,this.canonical.x>>o,this.canonical.y>>o)}calculateScaledKey(r,o=!0){if(this.overscaledZ===r&&o)return this.key;if(r>this.canonical.z)return Lm(this.wrap*+o,r,this.canonical.z,this.canonical.x,this.canonical.y);{const u=this.canonical.z-r;return Lm(this.wrap*+o,r,r,this.canonical.x>>u,this.canonical.y>>u)}}isChildOf(r){if(r.wrap!==this.wrap)return!1;const o=this.canonical.z-r.canonical.z;return r.overscaledZ===0||r.overscaledZ<this.overscaledZ&&r.canonical.z<this.canonical.z&&r.canonical.x===this.canonical.x>>o&&r.canonical.y===this.canonical.y>>o}children(r){if(this.overscaledZ>=r)return[new Ss(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const o=this.canonical.z+1,u=2*this.canonical.x,h=2*this.canonical.y;return[new Ss(o,this.wrap,o,u,h),new Ss(o,this.wrap,o,u+1,h),new Ss(o,this.wrap,o,u,h+1),new Ss(o,this.wrap,o,u+1,h+1)]}isLessThan(r){return this.wrap<r.wrap||!(this.wrap>r.wrap)&&(this.overscaledZ<r.overscaledZ||!(this.overscaledZ>r.overscaledZ)&&(this.canonical.x<r.canonical.x||!(this.canonical.x>r.canonical.x)&&this.canonical.y<r.canonical.y))}wrapped(){return new Ss(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(r){return new Ss(this.overscaledZ,r,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new Dm(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function Lm(a,r,o,u,h){const g=1<<Math.min(o,22);let _=g*(h%g)+u%g;return a&&o<22&&(_+=g*g*((a<0?-2*a-1:2*a)%(1<<2*(22-o)))),16*(32*_+o)+(r-o)}const o8=[a=>{let r=a.canonical.x-1,o=a.wrap;return r<0&&(r=(1<<a.canonical.z)-1,o--),new Ss(a.overscaledZ,o,a.canonical.z,r,a.canonical.y)},a=>{let r=a.canonical.x+1,o=a.wrap;return r===1<<a.canonical.z&&(r=0,o++),new Ss(a.overscaledZ,o,a.canonical.z,r,a.canonical.y)},a=>new Ss(a.overscaledZ,a.wrap,a.canonical.z,a.canonical.x,(a.canonical.y===0?1<<a.canonical.z:a.canonical.y)-1),a=>new Ss(a.overscaledZ,a.wrap,a.canonical.z,a.canonical.x,a.canonical.y===(1<<a.canonical.z)-1?0:a.canonical.y+1)];Wt(rc,"CanonicalTileID"),Wt(Ss,"OverscaledTileID",{omit:["projMatrix","expandedProjMatrix"]});const s8=gr([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:l1}=s8,a8=gr([{name:"a_pos_3",components:3,type:"Int16"}]);var kP=gr([{name:"a_pos",type:"Int16",components:2}]);function c1(a){return a*p/U}const l8=[new kn([O,O,O],[D,D,D]),new kn([O,O,O],[0,0,D]),new kn([0,O,O],[D,0,D]),new kn([O,0,O],[0,D,D]),new kn([0,0,O],[D,D,D])];function OP(a,r,o,u=!0){const h=or([],a._camera.position,a.worldSize),g=[r,o,1,1];Zt(g,g,a.pixelMatrixInverse),fn(g,g,1/g[3]);const _=ur([],Lt([],g,h)),b=a.globeMatrix,T=[b[12],b[13],b[14]],E=Lt([],T,h),A=ke(E),R=ur([],E),M=a.worldSize/(2*Math.PI),F=Ot(R,_),B=Math.asin(M/A);if(B<Math.acos(F)){if(!u)return null;const ut=[],Ue=[];or(ut,_,A/F),ur(Ue,Lt(Ue,ut,E)),ur(_,mn(_,E,or(_,Ue,Math.tan(B)*A)))}const W=[];new Mr(h,_).closestPointOnSphere(T,M,W);const q=ur([],Ri(b,0)),K=ur([],Ri(b,1)),ne=ur([],Ri(b,2)),re=Ot(q,W),oe=Ot(K,W),ye=Ot(ne,W),ve=Y(Math.asin(-oe/M));let Ce=Y(Math.atan2(re,ye));Ce=a.center.lng+(function(ut,Ue){const ht=(Ue-ut+180)%360-180;return ht<-180?ht+360:ht})(a.center.lng,Ce);const Oe=se(Ce),De=be(me(ve),0,1);return new it(Oe,De)}class c8{constructor(r,o,u){this.a=Lt([],r,u),this.b=Lt([],o,u),this.center=u;const h=ur([],this.a),g=ur([],this.b);this.angle=Math.acos(Ot(h,g))}}function kS(a,r){if(a.angle===0)return null;let o;return o=a.a[r]===0?1/a.angle*.5*Math.PI:1/a.angle*Math.atan(a.b[r]/a.a[r]/Math.sin(a.angle)-1/Math.tan(a.angle)),o<0||o>1?null:(function(u,h,g,_){const b=Math.sin(g);return u*(Math.sin((1-_)*g)/b)+h*(Math.sin(_*g)/b)})(a.a[r],a.b[r],a.angle,be(o,0,1))+a.center[r]}function Wc(a){if(a.z<=1)return l8[a.z+2*a.y+a.x];const r=OS(u1(a));return kn.fromPoints(r)}function ed(a,r,o){return or(a,a,1-o),vr(a,a,r,o)}function MP(a,r,o){for(const u of a)vn(u,u,r),or(u,u,o)}function DP(a,r,o,u){const h=r/a.worldSize,g=a.globeMatrix;if(o.z<=1){const De=Wc(o).getCorners();return MP(De,g,h),kn.fromPoints(De)}const _=u1(o,u),b=OS(_,p+c1(a._tileCoverLift));MP(b,g,h);const T=Number.MAX_VALUE,E=[-T,-T,-T],A=[T,T,T];if(_.contains(a.center)){for(const Ue of b)Br(A,A,Ue),ei(E,E,Ue);E[2]=0;const De=a.point,ut=[De.x*h,De.y*h,0];return Br(A,A,ut),ei(E,E,ut),new kn(A,E)}if(a._tileCoverLift>0){for(const De of b)Br(A,A,De),ei(E,E,De);return new kn(A,E)}const R=[g[12]*h,g[13]*h,g[14]*h],M=_.getCenter(),F=be(a.center.lat,-_e,_e),B=be(M.lat,-_e,_e),W=se(a.center.lng),q=me(F);let K=W-se(M.lng);const ne=q-me(B);K>.5?K-=1:K<-.5&&(K+=1);let re=0;Math.abs(K)>Math.abs(ne)?re=K>=0?1:3:(re=ne>=0?0:2,vr(R,R,[g[4]*h,g[5]*h,g[6]*h],-Math.sin(Fe(ne>=0?_.getSouth():_.getNorth()))*p));const oe=b[re],ye=b[(re+1)%4],ve=new c8(oe,ye,R),Ce=[kS(ve,0)||oe[0],kS(ve,1)||oe[1],kS(ve,2)||oe[2]],Oe=ch(a.zoom);if(Oe>0){const De=(function({x:Ue,y:ht,z:wt},mt,yt,Et,lt){const vt=1/(1<<wt);let rt=Ue*vt,Xe=rt+vt,Ct=ht*vt,Tt=Ct+vt,hn=0;const Ht=(rt+Xe)/2-Et;return Ht>.5?hn=-1:Ht<-.5&&(hn=1),rt=((rt+hn)*mt-(Et*=mt))*yt+Et,Xe=((Xe+hn)*mt-Et)*yt+Et,Ct=(Ct*mt-(lt*=mt))*yt+lt,Tt=(Tt*mt-lt)*yt+lt,[[rt,Tt,0],[Xe,Tt,0],[Xe,Ct,0],[rt,Ct,0]]})(o,r,a._pixelsPerMercatorPixel,W,q);for(let Ue=0;Ue<b.length;Ue++)ed(b[Ue],De[Ue],Oe);const ut=mn([],De[re],De[(re+1)%4]);or(ut,ut,.5),ed(Ce,ut,Oe)}for(const De of b)Br(A,A,De),ei(E,E,De);return A[2]=Math.min(oe[2],ye[2]),Br(A,A,Ce),ei(E,E,Ce),new kn(A,E)}function u1({x:a,y:r,z:o},u=!1){const h=1/(1<<o),g=new H(ge(a*h),r===(1<<o)-1&&u?-90:pe((r+1)*h)),_=new H(ge((a+1)*h),r===0&&u?90:pe(r*h));return new J(g,_)}function OS(a,r=p){const o=Fe(a.getNorth()),u=Fe(a.getSouth()),h=Math.cos(o),g=Math.cos(u),_=Math.sin(o),b=Math.sin(u),T=a.getWest(),E=a.getEast();return[N(g,b,T,r),N(g,b,E,r),N(h,_,E,r),N(h,_,T,r)]}function uy(a,r,o,u){const h=1<<o.z,g=(a/zt+o.x)/h;return z(pe((r/zt+o.y)/h),ge(g),u)}function d1({min:a,max:r}){return w/Math.max(r[0]-a[0],r[1]-a[1],r[2]-a[2])}const LP=new Float64Array(16);function h1(a){const r=d1(a),o=Pe(LP,[r,r,r]);return Ge(o,o,Gi([],a.min))}function MS(a){const r=(u=a.min,(o=LP)[0]=1,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=1,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=1,o[11]=0,o[12]=u[0],o[13]=u[1],o[14]=u[2],o[15]=1,o);var o,u;const h=1/d1(a);return Ye(r,r,[h,h,h])}function DS(a){const r=zt/(2*Math.PI);return a/(2*Math.PI)/r}function zP(a,r){return zt/(512*Math.pow(2,a))*d1(Wc(r))}function FP(a,r,o,u,h){const g=DS(o),_=[a,r,-o/(2*Math.PI)],b=de(new Float64Array(16));return Ge(b,b,_),Ye(b,b,[g,g,g]),Ne(b,b,Fe(-h)),Mt(b,b,Fe(-u)),b}function ch(a){return tt(y,v,a)}function BP(a,r){const o=z(r.lat,r.lng),u=(function(B){const W=z(B._center.lat,B._center.lng);let q=ln([],Mn(0,1,0),W);const K=we([],-B.angle,W);q=vn(q,q,K),we(K,-B._pitch,q);const ne=ur([],W);return or(ne,ne,c1(B.cameraToCenterDistance/B.pixelsPerMeter)),vn(ne,ne,K),mn([],W,ne)})(a);return _=(h=Sn([],u,o))[0],b=h[1],T=h[2],E=(g=o)[0],A=g[1],R=g[2],F=(M=Math.sqrt((_*_+b*b+T*T)*(E*E+A*A+R*R)))&&Ot(h,g)/M,Math.acos(Math.min(Math.max(F,-1),1));var h,g,_,b,T,E,A,R,M,F}function LS(a,r){return BP(a,r)>Math.PI/2*1.01}const NP=Fe(85),u8=Math.cos(NP),d8=Math.sin(NP),h8=ue(),VP=a=>{const r=[];return a.paint.get("circle-pitch-alignment")==="map"&&r.push("PITCH_WITH_MAP"),a.paint.get("circle-pitch-scale")==="map"&&r.push("SCALE_WITH_MAP"),r};function $P(a,r,o,u,h,g,_,b,T){if(g&&a.queryGeometry.isAboveHorizon)return!1;g&&(T*=a.pixelToTileUnitsFactor);const E=a.tileID.canonical,A=o.projection.upVectorScale(E,o.center.lat,o.worldSize).metersToTile;for(const R of r)for(const M of R){const F=M.add(b),B=h&&o.elevation?o.elevation.exaggeration()*h.getElevationAt(F.x,F.y,!0):0,W=o.projection.projectTilePoint(F.x,F.y,E);if(B>0){const re=o.projection.upVector(E,F.x,F.y);W.x+=re[0]*A*B,W.y+=re[1]*A*B,W.z+=re[2]*A*B}const q=g?F:f8(W.x,W.y,W.z,u),K=g?a.tilespaceRays.map((re=>m8(re,B))):a.queryGeometry.screenGeometry,ne=Zt([],[W.x,W.y,W.z,1],u);if(!_&&g?T*=ne[3]/o.cameraToCenterDistance:_&&!g&&(T*=o.cameraToCenterDistance/ne[3]),g){const re=pe((M.y/zt+E.y)/(1<<E.z));T/=o.projection.pixelsPerMeter(re,1)/fe(1,re)}if(ba(K,q,T))return!0}return!1}function f8(a,r,o,u){const h=Zt([],[a,r,o,1],u);return new xt(h[0]/h[3],h[1]/h[3])}const UP=Mn(0,0,0),p8=Mn(0,0,1);function m8(a,r){const o=Re();return UP[2]=r,a.intersectsPlane(UP,p8,o),new xt(o[0],o[1])}class jP extends Ko{}let GP,HP,WP,qP;function KP(a,{width:r,height:o},u,h){if(h){if(h instanceof Uint8ClampedArray)h=new Uint8Array(h.buffer);else if(h.length!==r*o*u)throw new RangeError("mismatched image size")}else h=new Uint8Array(r*o*u);return a.width=r,a.height=o,a.data=h,a}function ZP(a,r,o){const{width:u,height:h}=r;u===a.width&&h===a.height||(zS(a,r,{x:0,y:0},{x:0,y:0},{width:Math.min(a.width,u),height:Math.min(a.height,h)},o,null),a.width=u,a.height=h,a.data=r.data)}function zS(a,r,o,u,h,g,_,b){if(h.width===0||h.height===0)return r;if(h.width>a.width||h.height>a.height||o.x>a.width-h.width||o.y>a.height-h.height)throw new RangeError("out of range source coordinates for image copy");if(h.width>r.width||h.height>r.height||u.x>r.width-h.width||u.y>r.height-h.height)throw new RangeError("out of range destination coordinates for image copy");const T=a.data,E=r.data,A=g===4&&b;for(let R=0;R<h.height;R++){const M=((o.y+R)*a.width+o.x)*g,F=((u.y+R)*r.width+u.x)*g;if(A)for(let B=0;B<h.width;B++){const W=M+B*g+3,q=F+B*g;E[q+0]=255,E[q+1]=255,E[q+2]=255,E[q+3]=T[W]}else if(_)for(let B=0;B<h.width;B++){const W=M+B*g,q=F+B*g,K=new Pr(T[W+0]/255,T[W+1]/255,T[W+2]/255,T[W+3]).toNonPremultipliedRenderColor(_).toArray();E[q+0]=K[0],E[q+1]=K[1],E[q+2]=K[2],E[q+3]=K[3]}else for(let B=0;B<h.width*g;B++)E[F+B]=T[M+B]}return r}Wt(jP,"HeatmapBucket",{omit:["layers"]});class uh{constructor(r,o){KP(this,r,1,o)}resize(r){ZP(this,new uh(r),1)}clone(){return new uh({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(r,o,u,h,g){zS(r,o,u,h,g,1,null)}}class rs{constructor(r,o){KP(this,r,4,o)}resize(r){ZP(this,new rs(r),4)}replace(r,o){o?this.data.set(r):this.data=r instanceof Uint8ClampedArray?new Uint8Array(r.buffer):r}clone(){return new rs({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(r,o,u,h,g,_,b){zS(r,o,u,h,g,4,_,b)}}class XP{constructor(r,o){this.width=r.width,this.height=r.height,this.data=o instanceof Uint8Array?new Float32Array(o.buffer):o}}function dy(a){const r={},o=a.resolution||256,u=a.clips?a.clips.length:1,h=a.image||new rs({width:o,height:u}),g=(_,b,T)=>{r[a.evaluationKey]=T;const E=a.expression.evaluate(r),A=E?E.toNonPremultipliedRenderColor(null):null;A&&(h.data[_+b+0]=Math.floor(255*A.r),h.data[_+b+1]=Math.floor(255*A.g),h.data[_+b+2]=Math.floor(255*A.b),h.data[_+b+3]=Math.floor(255*A.a))};if(a.clips)for(let _=0,b=0;_<u;++_,b+=4*o)for(let T=0,E=0;T<o;T++,E+=4){const A=T/(o-1),{start:R,end:M}=a.clips[_];g(b,E,R*(1-A)+M*A)}else for(let _=0,b=0;_<o;_++,b+=4)g(0,b,_/(o-1));return h}Wt(uh,"AlphaImage"),Wt(rs,"RGBAImage");const g8=gr([{name:"a_pos",components:2,type:"Int16"}],4),_8=gr([{name:"a_road_z_offset",components:1,type:"Float32"}],4),y8=gr([{name:"a_pos",components:2,type:"Int16"},{name:"a_height",components:1,type:"Float32"}],4),v8=gr([{name:"a_pos_normal_3",components:3,type:"Int16"}],4);function zm(a,r,o=2){const u=r&&r.length,h=u?r[0]*o:a.length;let g=YP(a,0,h,o,!0);const _=[];if(!g||g.next===g.prev)return _;let b,T,E;if(u&&(g=(function(A,R,M,F){const B=[];for(let W=0,q=R.length;W<q;W++){const K=YP(A,R[W]*F,W<q-1?R[W+1]*F:A.length,F,!1);K===K.next&&(K.steiner=!0),B.push(I8(K))}B.sort(S8);for(let W=0;W<B.length;W++)M=E8(B[W],M);return M})(a,r,g,o)),a.length>80*o){b=a[0],T=a[1];let A=b,R=T;for(let M=o;M<h;M+=o){const F=a[M],B=a[M+1];F<b&&(b=F),B<T&&(T=B),F>A&&(A=F),B>R&&(R=B)}E=Math.max(A-b,R-T),E=E!==0?32767/E:0}return hy(g,_,o,b,T,E,0),_}function YP(a,r,o,u,h){let g;if(h===(function(_,b,T,E){let A=0;for(let R=b,M=T-E;R<T;R+=E)A+=(_[M]-_[R])*(_[R+1]+_[M+1]),M=R;return A})(a,r,o,u)>0)for(let _=r;_<o;_+=u)g=tR(_/u|0,a[_],a[_+1],g);else for(let _=o-u;_>=r;_-=u)g=tR(_/u|0,a[_],a[_+1],g);return g&&Fm(g,g.next)&&(my(g),g=g.next),g}function jf(a,r){if(!a)return a;r||(r=a);let o,u=a;do if(o=!1,u.steiner||!Fm(u,u.next)&&Wo(u.prev,u,u.next)!==0)u=u.next;else{if(my(u),u=r=u.prev,u===u.next)break;o=!0}while(o||u!==r);return r}function hy(a,r,o,u,h,g,_){if(!a)return;!_&&g&&(function(T,E,A,R){let M=T;do M.z===0&&(M.z=FS(M.x,M.y,E,A,R)),M.prevZ=M.prev,M.nextZ=M.next,M=M.next;while(M!==T);M.prevZ.nextZ=null,M.prevZ=null,(function(F){let B,W=1;do{let q,K=F;F=null;let ne=null;for(B=0;K;){B++;let re=K,oe=0;for(let ve=0;ve<W&&(oe++,re=re.nextZ,re);ve++);let ye=W;for(;oe>0||ye>0&&re;)oe!==0&&(ye===0||!re||K.z<=re.z)?(q=K,K=K.nextZ,oe--):(q=re,re=re.nextZ,ye--),ne?ne.nextZ=q:F=q,q.prevZ=ne,ne=q;K=re}ne.nextZ=null,W*=2}while(B>1)})(M)})(a,u,h,g);let b=a;for(;a.prev!==a.next;){const T=a.prev,E=a.next;if(g?x8(a,u,h,g):b8(a))r.push(T.i,a.i,E.i),my(a),a=E.next,b=E.next;else if((a=E)===b){_?_===1?hy(a=w8(jf(a),r),r,o,u,h,g,2):_===2&&T8(a,r,o,u,h,g):hy(jf(a),r,o,u,h,g,1);break}}}function b8(a){const r=a.prev,o=a,u=a.next;if(Wo(r,o,u)>=0)return!1;const h=r.x,g=o.x,_=u.x,b=r.y,T=o.y,E=u.y,A=Math.min(h,g,_),R=Math.min(b,T,E),M=Math.max(h,g,_),F=Math.max(b,T,E);let B=u.next;for(;B!==r;){if(B.x>=A&&B.x<=M&&B.y>=R&&B.y<=F&&fy(h,b,g,T,_,E,B.x,B.y)&&Wo(B.prev,B,B.next)>=0)return!1;B=B.next}return!0}function x8(a,r,o,u){const h=a.prev,g=a,_=a.next;if(Wo(h,g,_)>=0)return!1;const b=h.x,T=g.x,E=_.x,A=h.y,R=g.y,M=_.y,F=Math.min(b,T,E),B=Math.min(A,R,M),W=Math.max(b,T,E),q=Math.max(A,R,M),K=FS(F,B,r,o,u),ne=FS(W,q,r,o,u);let re=a.prevZ,oe=a.nextZ;for(;re&&re.z>=K&&oe&&oe.z<=ne;){if(re.x>=F&&re.x<=W&&re.y>=B&&re.y<=q&&re!==h&&re!==_&&fy(b,A,T,R,E,M,re.x,re.y)&&Wo(re.prev,re,re.next)>=0||(re=re.prevZ,oe.x>=F&&oe.x<=W&&oe.y>=B&&oe.y<=q&&oe!==h&&oe!==_&&fy(b,A,T,R,E,M,oe.x,oe.y)&&Wo(oe.prev,oe,oe.next)>=0))return!1;oe=oe.nextZ}for(;re&&re.z>=K;){if(re.x>=F&&re.x<=W&&re.y>=B&&re.y<=q&&re!==h&&re!==_&&fy(b,A,T,R,E,M,re.x,re.y)&&Wo(re.prev,re,re.next)>=0)return!1;re=re.prevZ}for(;oe&&oe.z<=ne;){if(oe.x>=F&&oe.x<=W&&oe.y>=B&&oe.y<=q&&oe!==h&&oe!==_&&fy(b,A,T,R,E,M,oe.x,oe.y)&&Wo(oe.prev,oe,oe.next)>=0)return!1;oe=oe.nextZ}return!0}function w8(a,r){let o=a;do{const u=o.prev,h=o.next.next;!Fm(u,h)&&QP(u,o,o.next,h)&&py(u,h)&&py(h,u)&&(r.push(u.i,o.i,h.i),my(o),my(o.next),o=a=h),o=o.next}while(o!==a);return jf(o)}function T8(a,r,o,u,h,g){let _=a;do{let b=_.next.next;for(;b!==_.prev;){if(_.i!==b.i&&A8(_,b)){let T=eR(_,b);return _=jf(_,_.next),T=jf(T,T.next),hy(_,r,o,u,h,g,0),void hy(T,r,o,u,h,g,0)}b=b.next}_=_.next}while(_!==a)}function S8(a,r){let o=a.x-r.x;return o===0&&(o=a.y-r.y,o===0)&&(o=(a.next.y-a.y)/(a.next.x-a.x)-(r.next.y-r.y)/(r.next.x-r.x)),o}function E8(a,r){const o=(function(h,g){let _=g;const b=h.x,T=h.y;let E,A=-1/0;if(Fm(h,_))return _;do{if(Fm(h,_.next))return _.next;if(T<=_.y&&T>=_.next.y&&_.next.y!==_.y){const W=_.x+(T-_.y)*(_.next.x-_.x)/(_.next.y-_.y);if(W<=b&&W>A&&(A=W,E=_.x<_.next.x?_:_.next,W===b))return E}_=_.next}while(_!==g);if(!E)return null;const R=E,M=E.x,F=E.y;let B=1/0;_=E;do{if(b>=_.x&&_.x>=M&&b!==_.x&&JP(T<F?b:A,T,M,F,T<F?A:b,T,_.x,_.y)){const W=Math.abs(T-_.y)/(b-_.x);py(_,h)&&(W<B||W===B&&(_.x>E.x||_.x===E.x&&C8(E,_)))&&(E=_,B=W)}_=_.next}while(_!==R);return E})(a,r);if(!o)return r;const u=eR(o,a);return jf(u,u.next),jf(o,o.next)}function C8(a,r){return Wo(a.prev,a,r.prev)<0&&Wo(r.next,a,a.next)<0}function FS(a,r,o,u,h){return(a=1431655765&((a=858993459&((a=252645135&((a=16711935&((a=(a-o)*h|0)|a<<8))|a<<4))|a<<2))|a<<1))|(r=1431655765&((r=858993459&((r=252645135&((r=16711935&((r=(r-u)*h|0)|r<<8))|r<<4))|r<<2))|r<<1))<<1}function I8(a){let r=a,o=a;do(r.x<o.x||r.x===o.x&&r.y<o.y)&&(o=r),r=r.next;while(r!==a);return o}function JP(a,r,o,u,h,g,_,b){return(h-_)*(r-b)>=(a-_)*(g-b)&&(a-_)*(u-b)>=(o-_)*(r-b)&&(o-_)*(g-b)>=(h-_)*(u-b)}function fy(a,r,o,u,h,g,_,b){return!(a===_&&r===b)&&JP(a,r,o,u,h,g,_,b)}function A8(a,r){return a.next.i!==r.i&&a.prev.i!==r.i&&!(function(o,u){let h=o;do{if(h.i!==o.i&&h.next.i!==o.i&&h.i!==u.i&&h.next.i!==u.i&&QP(h,h.next,o,u))return!0;h=h.next}while(h!==o);return!1})(a,r)&&(py(a,r)&&py(r,a)&&(function(o,u){let h=o,g=!1;const _=(o.x+u.x)/2,b=(o.y+u.y)/2;do h.y>b!=h.next.y>b&&h.next.y!==h.y&&_<(h.next.x-h.x)*(b-h.y)/(h.next.y-h.y)+h.x&&(g=!g),h=h.next;while(h!==o);return g})(a,r)&&(Wo(a.prev,a,r.prev)||Wo(a,r.prev,r))||Fm(a,r)&&Wo(a.prev,a,a.next)>0&&Wo(r.prev,r,r.next)>0)}function Wo(a,r,o){return(r.y-a.y)*(o.x-r.x)-(r.x-a.x)*(o.y-r.y)}function Fm(a,r){return a.x===r.x&&a.y===r.y}function QP(a,r,o,u){const h=p1(Wo(a,r,o)),g=p1(Wo(a,r,u)),_=p1(Wo(o,u,a)),b=p1(Wo(o,u,r));return h!==g&&_!==b||!(h!==0||!f1(a,o,r))||!(g!==0||!f1(a,u,r))||!(_!==0||!f1(o,a,u))||!(b!==0||!f1(o,r,u))}function f1(a,r,o){return r.x<=Math.max(a.x,o.x)&&r.x>=Math.min(a.x,o.x)&&r.y<=Math.max(a.y,o.y)&&r.y>=Math.min(a.y,o.y)}function p1(a){return a>0?1:a<0?-1:0}function py(a,r){return Wo(a.prev,a,a.next)<0?Wo(a,r,a.next)>=0&&Wo(a,a.prev,r)>=0:Wo(a,r,a.prev)<0||Wo(a,a.next,r)<0}function eR(a,r){const o=BS(a.i,a.x,a.y),u=BS(r.i,r.x,r.y),h=a.next,g=r.prev;return a.next=r,r.prev=a,o.next=h,h.prev=o,u.next=o,o.prev=u,g.next=u,u.prev=g,u}function tR(a,r,o,u){const h=BS(a,r,o);return u?(h.next=u.next,h.prev=u,u.next.prev=h,u.next=h):(h.prev=h,h.next=h),h}function my(a){a.next.prev=a.prev,a.prev.next=a.next,a.prevZ&&(a.prevZ.nextZ=a.nextZ),a.nextZ&&(a.nextZ.prevZ=a.prevZ)}function BS(a,r,o){return{i:a,x:r,y:o,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function gy(a,r){const o=a.length;if(o<=1)return[a];const u=[];let h,g;for(let _=0;_<o;_++){const b=to(a[_]);b!==0&&(a[_].area=Math.abs(b),g===void 0&&(g=b<0),g===b<0?(h&&u.push(h),h=[a[_]]):h.push(a[_]))}if(h&&u.push(h),r>1)for(let _=0;_<u.length;_++)u[_].length<=r||(gb(u[_],r,1,u[_].length-1,P8),u[_]=u[_].slice(0,r));return u}function P8(a,r){return r.area-a.area}function nR(a,r,o=1){if(!a)return null;const u=typeof a=="string"?gn.from(a).getPrimary():a.getPrimary(),h=typeof a=="string"?null:a.getSecondary();for(const g of[u,h]){if(!g)continue;const _=g.id.toString();r.has(_)||r.set(_,[]),g.scaleSelf(o),r.get(_).push(g)}return{primary:u.toString(),secondary:h?h.toString():null}}function NS(a,r,o,u){const h=u.patternDependencies;let g=!1;for(const _ of r){const b=_.paint.get(`${a}-pattern`);b.isConstant()||(g=!0),nR(b.constantOr(null),h,o)&&(g=!0)}return g}function VS(a,r,o,u,h,g){const _=g.patternDependencies;for(const b of r){const T=b.paint.get(`${a}-pattern`).value;if(T.kind!=="constant"){let E=T.evaluate({zoom:u},o,{},g.availableImages);E=E&&E.name?E.name:E;const A=nR(E,_,h);if(!A)continue;const{primary:R,secondary:M}=A;R&&(o.patterns[b.id]=[R,M].filter(Boolean))}}return o}class rR{constructor(){this.polygons=new Map}add(r,...o){const u=this.polygons.get(r);u?u.push(...o):this.polygons.set(r,o)}merge(r){for(const[o,u]of r.polygons)this.add(o,...u)}}class td{constructor(){this.portals=[]}static isOnBorder(r,o){return r<=0&&o<=0||r>=zt&&o>=zt}static evaluate(r){if(r.length===0)return new td;let o=[];for(const T of r)o.push(...T.portals);if(o.length===0)return new td;for(const T of o){const E=T.va,A=T.vb;(td.isOnBorder(E.x,A.x)||td.isOnBorder(E.y,A.y))&&(T.type="border")}const u=o.filter((T=>T.type!=="unevaluated")),h=o.filter((T=>T.type==="unevaluated"));if(h.length===0)return new td;h.sort(((T,E)=>T.hash===E.hash?T.isTunnel===E.isTunnel?0:T.isTunnel?-1:1:T.hash<E.hash?1:-1)),o=u.concat(h);let g=u.length,_=g,b=g;do if(_++,_===o.length||o[g].hash!==o[_].hash){if(_-g==2){b<g&&(o[b]=o[g],o[g]=null);const T=o[b],E=o[_-1];T.type=T.isTunnel!==E.isTunnel?"tunnel":"polygon",T.connection={a:T.connection.a,b:E.connection.a},b++}g=_}while(g!==o.length);return o.splice(b),o.sort(((T,E)=>T.hash<E.hash?1:-1)),{portals:o}}}Wt(td,"ElevationPortalGraph"),Wt(rR,"ElevationPolygons");class R8{constructor(r,o,u){this.outPositions=r,this.outNormals=o,this.outIndices=u,this.vertexLookup=new Map}addVertex(r,o,u){let h=r[2];u!=null&&(h*=u);const g=`${r[0]},${r[1]},${r[2]},${o[0]},${o[1]},${o[2]}`,_=this.vertexLookup.get(g);if(_!=null)return _;const b=this.outPositions.length;this.vertexLookup.set(g,b);const T=Math.trunc(16384*o[0]),E=Math.trunc(16384*o[1]),A=Math.trunc(16384*o[2]);return this.outPositions.emplaceBack(r[0],r[1],h),this.outNormals.emplaceBack(T,E,A),b}addTriangle(r,o,u){this.outIndices.emplaceBack(r,o,u)}addTriangles(r,o,u){if(r.length===0)return;const h=u.length===1,g=Re(),_=Re();for(let b=0;b<r.length;b+=3){const T=o[r[b+0]],E=o[r[b+1]],A=o[r[b+2]],R=h?u[0]:u[r[b+1]],M=h?u[0]:u[r[b+2]];bn(g,T.x,T.y,h?u[0]:u[r[b+0]]);const F=this.addVertex(g,_);bn(g,E.x,E.y,R);const B=this.addVertex(g,_);bn(g,A.x,A.y,M);const W=this.addVertex(g,_);this.outIndices.emplaceBack(F,B,W)}}addQuad(r,o,u,h,g,_){const b=this.addVertex(r,g,_),T=this.addVertex(o,g,_),E=this.addVertex(u,g,_),A=this.addVertex(h,g,_);this.addTriangle(b,T,E),this.addTriangle(E,A,b)}getVertexCount(){return this.outPositions.length}clearVertexLookup(){this.vertexLookup.clear()}}class xa{constructor(r,o,u,h){this.unevaluatedPortals=new td,this.portalPolygons=new rR,this.bridgeFeatureSections=[],this.tunnelFeatureSections=[],this.vertexHashLookup=new Map,this.unevalVertices=[],this.unevalHeights=[],this.unevalTriangles=[],this.unevalTunnelTriangles=[],this.unevalEdges=[],this.vertexPositions=new Y_,this.vertexNormals=new Tm,this.indexArray=new Mo,this.tileToMeters=We(r),this.bridgeProgramConfigurations=new tl(o,{zoom:u,lut:h},(g=>g!=="fill-tunnel-structure-color")),this.tunnelProgramConfigurations=new tl(o,{zoom:u,lut:h},(g=>g!=="fill-bridge-guard-rail-color"))}addVertices(r,o){const u=this.unevalVertices.length;for(let h=0;h<r.length;h++)this.unevalVertices.push(r[h]),this.unevalHeights.push(o[h]);return u}addTriangles(r,o,u){const h=u?this.unevalTunnelTriangles:this.unevalTriangles;for(const g of r)h.push(g+o)}addRenderableRing(r,o,u,h,g,_){const b=[new xt(g.min.x,g.min.y),new xt(g.max.x,g.min.y),new xt(g.max.x,g.max.y),new xt(g.min.x,g.max.y)];for(let T=0;T<u-1;T++){const E=o+T,A=E+1,R=this.unevalVertices[E],M=this.unevalVertices[A];if(!(R.x>=g.min.x&&R.x<=g.max.x&&R.y>=g.min.y&&R.y<=g.max.y||M.x>=g.min.x&&M.x<=g.max.x&&M.y>=g.min.y&&M.y<=g.max.y||ns(R,M,b))||this.isOnBorder(R.x,M.x)||this.isOnBorder(R.y,M.y))continue;const F=xa.computeEdgeHash(this.unevalVertices[E],this.unevalVertices[A]);let B,W=this.vertexHashLookup.get(xa.computePosHash(R));W!=null?B=W.next:(W=this.vertexHashLookup.get(xa.computePosHash(M)),B=W!=null?W.prev:F),this.unevalEdges.push({polygonIdx:r,a:E,b:A,hash:F,portalHash:B,isTunnel:h,type:"unevaluated",featureInfo:_})}}addPortalCandidates(r,o,u,h,g){if(o.length===0)return;this.portalPolygons.add(r,{geometry:o,zLevel:g});const _=o[0];this.vertexHashLookup.clear();let b=xa.computeEdgeHash(_[_.length-2],_[_.length-1]);for(let T=0;T<_.length-1;T++){const E=_[T+0],A=_[T+1],R=oo(A.x-E.x,A.y-E.y),M=Ma(R);if(M===0)continue;let F="unevaluated";const B=h.pointElevation(E),W=h.pointElevation(A);Math.abs(B)<.01&&Math.abs(W)<.01?F="entrance":(this.isOnBorder(E.x,A.x)||this.isOnBorder(E.y,A.y))&&(F="border");const q=xa.computeEdgeHash(E,A);this.unevaluatedPortals.portals.push({connection:{a:r,b:void 0},va:E,vb:A,vab:R,length:M,hash:q,isTunnel:u,type:F});const K=xa.computePosHash(E);this.vertexHashLookup.set(K,{prev:b,next:q}),b=q}}construct(r){if(this.unevalVertices.length===0)return;const o=()=>({vertexOffset:0,primitiveOffset:this.indexArray.length}),u=M=>{M.primitiveLength=this.indexArray.length-M.primitiveOffset},h=new R8(this.vertexPositions,this.vertexNormals,this.indexArray);this.prepareEdges(r.portals,this.unevalEdges);const g=o(),_=o(),b=o(),T=(M,F)=>{M.sort(((W,q)=>W.type===F&&q.type!==F?-1:W.type!==F&&q.type===F?1:0));const B=M.findIndex((W=>W.type!==F));return B>=0?B:M.length};let E=0;this.unevalEdges.length>0&&(E=T(this.unevalEdges,"none"),this.constructBridgeStructures(h,this.unevalVertices,this.unevalHeights,this.unevalEdges,{min:0,max:E},this.tileToMeters)),u(b);const A=o(),R=o();if(this.unevalEdges.length>0){const M=this.unevalEdges.splice(E),F=T(M,"tunnel")+E;this.unevalEdges.push(...M),this.constructTunnelStructures(h,this.unevalVertices,this.unevalHeights,this.unevalEdges,{min:0,max:E},{min:E,max:F})}u(A),h.addTriangles(this.unevalTriangles,this.unevalVertices,this.unevalHeights),u(R),h.addTriangles(this.unevalTunnelTriangles,this.unevalVertices,this.unevalHeights),u(_),h.addTriangles(this.unevalTunnelTriangles,this.unevalVertices,[-.1]),u(g),this.maskSegments=Bi.simpleSegment(0,R.primitiveOffset,0,R.primitiveLength),this.depthSegments=Bi.simpleSegment(0,_.primitiveOffset,0,_.primitiveLength),this.renderableBridgeSegments=Bi.simpleSegment(0,b.primitiveOffset,0,b.primitiveLength),this.renderableTunnelSegments=Bi.simpleSegment(0,A.primitiveOffset,0,A.primitiveLength),this.shadowCasterSegments=Bi.simpleSegment(0,g.primitiveOffset,0,g.primitiveLength)}update(r,o,u,h,g,_,b,T){this.bridgeProgramConfigurations.updatePaintArrays(r,o,g,u,h,_,b,T),this.tunnelProgramConfigurations.updatePaintArrays(r,o,g,u,h,_,b,T)}upload(r){this.vertexBuffer||this.vertexPositions.length===0||this.vertexNormals.length===0||this.indexArray.length===0||(this.vertexBuffer=r.createVertexBuffer(this.vertexPositions,y8.members),this.vertexBufferNormal=r.createVertexBuffer(this.vertexNormals,v8.members),this.indexBuffer=r.createIndexBuffer(this.indexArray),this.bridgeProgramConfigurations.upload(r),this.tunnelProgramConfigurations.upload(r))}destroy(){this.vertexBuffer&&(this.vertexBuffer.destroy(),this.vertexBufferNormal.destroy(),this.indexBuffer.destroy()),this.maskSegments&&(this.maskSegments.destroy(),this.depthSegments.destroy(),this.renderableBridgeSegments.destroy(),this.renderableTunnelSegments.destroy(),this.shadowCasterSegments.destroy()),this.bridgeProgramConfigurations.destroy(),this.tunnelProgramConfigurations.destroy()}populatePaintArrays(r,o,u,h,g){const _=(b,T)=>{for(let E=0;E<T.length-1;E++){const A=T[E].featureIndex,R=T[E+1].vertexStart,M=r.feature(A);b.populatePaintArrays(R,M,A,{},u,o,h,void 0,g)}};_(this.bridgeProgramConfigurations,this.bridgeFeatureSections),_(this.tunnelProgramConfigurations,this.tunnelFeatureSections)}computeVertexConnections(r,o,u,h,g){const _=new Map;for(let b=h;b<g;b++){const T=u[b],E=T.a,A=T.b,R=xa.computePosHash(r[E]),M=xa.computePosHash(r[A]);let F=_.get(R);F||(F={},_.set(R,F));let B=_.get(M);B||(B={},_.set(M,B)),o[E]<=0&&o[A]<=0||(F.to=A,B.from=E)}return _}isTerminalVertex(r,o){const u=xa.computePosHash(this.unevalVertices[r]),h=o.get(u);return!h||!h.from||!h.to}constructBridgeStructures(r,o,u,h,g,_){r.clearVertexLookup();const b=this.computeVertexConnections(o,u,h,g.min,g.max),T=1/_,E=.5*T,A=(yt,Et)=>bn(yt,o[Et].x,o[Et].y,u[Et]*T),R=Re(),M=Re(),F=Re(),B=Re(),W=Re(),q=(yt,Et)=>{const lt=b.get(xa.computePosHash(o[Et])),vt=lt.from,rt=lt.to;if(!vt||!rt)return;A(R,vt),A(M,Et),A(F,rt),Qe(B),dt(R,M)||(Lt(W,M,R),ur(B,W)),dt(F,M)||(Lt(W,F,M),mn(B,B,ur(W,W)));const Xe=jt(B);return Xe>0?or(yt,B,1/Xe):void 0};let K=Number.POSITIVE_INFINITY;this.sortSubarray(h,g.min,g.max,((yt,Et)=>yt.featureInfo.featureIndex-Et.featureInfo.featureIndex));const ne=Re(),re=Re(),oe=Re(),ye=Re(),ve=Re(),Ce=Re(),Oe=Re(),De=Re(),ut=Re(),Ue=[Re(),Re(),Re(),Re()],ht=[Re(),Re(),Re(),Re()],wt=[{coord:new xt(0,0),height:0},{coord:new xt(0,0),height:0}],mt=(yt,Et)=>yt>Et;for(let yt=g.min;yt<g.max;yt++){const Et=h[yt];if(!Et.featureInfo.guardRailEnabled||!this.prepareEdgePoints(wt,o,u,Et,mt))continue;const[lt,vt]=wt;if(bn(ne,lt.coord.x,lt.coord.y,T*lt.height),bn(re,vt.coord.x,vt.coord.y,T*vt.height),dt(ne,re))continue;Lt(oe,re,ne),ur(oe,oe);const rt=q(De,Et.a)||oe,Xe=q(ut,Et.b)||oe;bn(ye,rt[1],-rt[0],0),ur(ye,ye),bn(ve,Xe[1],-Xe[0],0),ur(ve,ve),ln(De,ye,rt),ur(Ce,De),ln(De,ve,Xe),ur(Oe,De),mn(Ue[0],ne,or(De,Lt(De,ye,Ce),E)),mn(Ue[1],ne,or(De,mn(De,ye,Ce),E)),mn(Ue[2],ne,or(De,Ce,E)),Ue[3]=ne,mn(ht[0],re,or(De,Lt(De,ve,Oe),E)),mn(ht[1],re,or(De,mn(De,ve,Oe),E)),mn(ht[2],re,or(De,Oe,E)),ht[3]=re,K=this.addFeatureSection(Et.featureInfo.featureIndex,K,this.bridgeFeatureSections,r);const Ct=r.addVertex(Ue[0],ye,_),Tt=r.addVertex(Ue[1],ye,_),hn=r.addVertex(ht[0],ve,_),Ht=r.addVertex(ht[1],ve,_);r.addTriangle(Ct,Tt,hn),r.addTriangle(Tt,Ht,hn);const Jt=r.addVertex(Ue[1],Ce,_),Dt=r.addVertex(Ue[2],Ce,_),dn=r.addVertex(ht[1],Oe,_),Fn=r.addVertex(ht[2],Oe,_);r.addTriangle(Jt,Dt,dn),r.addTriangle(Dt,Fn,dn),Gi(ye,ye),Gi(ve,ve);const Vt=r.addVertex(Ue[2],ye,_),tn=r.addVertex(Ue[3],ye,_),An=r.addVertex(ht[2],ve,_),Nn=r.addVertex(ht[3],ve,_);r.addTriangle(Vt,tn,An),r.addTriangle(tn,Nn,An);const er=this.isTerminalVertex(Et.a,b),Un=this.isTerminalVertex(Et.b,b);lt.height<.01&&er&&r.addQuad(Ue[3],Ue[2],Ue[1],Ue[0],Gi(rt,rt),_),vt.height<.01&&Un&&r.addQuad(ht[0],ht[1],ht[2],ht[3],Xe,_)}this.bridgeFeatureSections.push({featureIndex:Number.POSITIVE_INFINITY,vertexStart:r.getVertexCount()})}constructTunnelStructures(r,o,u,h,g,_){r.clearVertexLookup();let b=Number.POSITIVE_INFINITY;const T=(K,ne)=>K.featureInfo.featureIndex-ne.featureInfo.featureIndex;this.sortSubarray(h,g.min,g.max,T),this.sortSubarray(h,_.min,_.max,T);const E=K=>ur(K,K),A=[{coord:new xt(0,0),height:0},{coord:new xt(0,0),height:0}],R=(K,ne)=>K<ne,M=Re(),F=Re(),B=Re(),W=Re(),q=Re();for(let K=g.min;K<g.max;K++){if(!this.prepareEdgePoints(A,o,u,h[K],R))continue;const[ne,re]=A,oe=E(bn(q,-(re.coord.y-ne.coord.y),re.coord.x-ne.coord.x,0));b=this.addFeatureSection(h[K].featureInfo.featureIndex,b,this.tunnelFeatureSections,r),r.addQuad(bn(M,ne.coord.x,ne.coord.y,ne.height),bn(F,re.coord.x,re.coord.y,re.height),bn(B,re.coord.x,re.coord.y,h[K].isTunnel?-.1:0),bn(W,ne.coord.x,ne.coord.y,h[K].isTunnel?-.1:0),oe)}for(let K=_.min;K<_.max;K++){const ne=h[K];ne.isTunnel&&([ne.a,ne.b]=[ne.b,ne.a]);const re=o[ne.a],oe=o[ne.b],ye=E(bn(q,-(oe.y-re.y),oe.x-re.x,0));b=this.addFeatureSection(ne.featureInfo.featureIndex,b,this.tunnelFeatureSections,r),r.addQuad(bn(M,oe.x,oe.y,0),bn(F,re.x,re.y,0),bn(B,re.x,re.y,u[ne.a]+4),bn(W,oe.x,oe.y,u[ne.b]+4),ye),r.addQuad(bn(M,re.x,re.y,0),bn(F,oe.x,oe.y,0),bn(B,oe.x,oe.y,u[ne.b]+4),bn(W,re.x,re.y,u[ne.a]+4),ye)}this.tunnelFeatureSections.push({featureIndex:Number.POSITIVE_INFINITY,vertexStart:r.getVertexCount()})}setElevatedPoint(r,o,u,h){r.coord.x=o,r.coord.y=u,r.height=h}prepareEdgePoints(r,o,u,h,g){let _=o[h.a].x,b=o[h.a].y,T=o[h.b].x,E=o[h.b].y,A=u[h.a],R=u[h.b];const M=g(A,0),F=g(R,0);if(M&&F)return this.setElevatedPoint(r[0],_,b,A),this.setElevatedPoint(r[1],T,E,R),!0;if(!M&&!F)return!1;if(M){if(!F){const B=R/(R-A);T=wn(T,_,B),E=wn(E,b,B),R=wn(R,A,B)}}else{const B=A/(A-R);_=wn(_,T,B),b=wn(b,E,B),A=wn(A,R,B)}return this.setElevatedPoint(r[0],_,b,A),this.setElevatedPoint(r[1],T,E,R),!0}prepareEdges(r,o){if(o.length===0)return;o.sort(((b,T)=>b.hash===T.hash?T.polygonIdx-b.polygonIdx:T.hash>b.hash?1:-1));let u=0,h=0,g=0,_=o[u].polygonIdx;do h++,(h===o.length||o[u].hash!==o[h].hash)&&((h-u==1||o[h-1].polygonIdx!==_)&&(g<u&&(o[g]=o[u],o[u]=null),o[g].type="none",g++),u=h,u!==o.length&&(_=o[u].polygonIdx));while(u!==o.length);if(o.splice(g),o.length!==0&&r.length!==0){o.sort(((E,A)=>E.portalHash<A.portalHash?1:-1));let b=0,T=0;for(;b!==o.length&&T!==r.length;){const E=o[b],A=r[T];E.portalHash>A.hash?b++:A.hash>E.portalHash?T++:(E.type=A.type,b++)}}}isOnBorder(r,o){return r<=0&&o<=0||r>=zt&&o>=zt}addFeatureSection(r,o,u,h){return r!==o&&(o=r,u.push({featureIndex:r,vertexStart:h.getVertexCount()}),h.clearVertexLookup()),o}sortSubarray(r,o,u,h){const g=r.slice(o,u);g.sort(h),r.splice(o,g.length,...g)}static computeEdgeHash(r,o){return(r.y===o.y&&r.x>o.x||r.y>o.y)&&([r,o]=[o,r]),BigInt(xa.computePosHash(r))<<32n|BigInt(xa.computePosHash(o))}static computePosHash(r){return((65535&r.x)<<16|65535&r.y)>>>0}}var iR,oR={exports:{}},sR=(iR||(iR=1,(function(a,r){(function(o){function u(ae,le){return ae>le?1:ae<le?-1:0}var h=function(ae,le){ae===void 0&&(ae=u),le===void 0&&(le=!1),this._compare=ae,this._root=null,this._size=0,this._noDuplicates=!!le},g={size:{configurable:!0}};function _(ae,le,et,ct,Nt){var Bt=Nt-ct;if(Bt>0){var Kt=ct+Math.floor(Bt/2),_n={key:le[Kt],data:et[Kt],parent:ae};return _n.left=_(_n,le,et,ct,Kt),_n.right=_(_n,le,et,Kt+1,Nt),_n}return null}function b(ae,le,et,ct,Nt){if(!(et>=ct)){for(var Bt=ae[et+ct>>1],Kt=et-1,_n=ct+1;;){do Kt++;while(Nt(ae[Kt],Bt)<0);do _n--;while(Nt(ae[_n],Bt)>0);if(Kt>=_n)break;var tr=ae[Kt];ae[Kt]=ae[_n],ae[_n]=tr,tr=le[Kt],le[Kt]=le[_n],le[_n]=tr}b(ae,le,et,_n,Nt),b(ae,le,_n+1,ct,Nt)}}h.prototype.rotateLeft=function(ae){var le=ae.right;le&&(ae.right=le.left,le.left&&(le.left.parent=ae),le.parent=ae.parent),ae.parent?ae===ae.parent.left?ae.parent.left=le:ae.parent.right=le:this._root=le,le&&(le.left=ae),ae.parent=le},h.prototype.rotateRight=function(ae){var le=ae.left;le&&(ae.left=le.right,le.right&&(le.right.parent=ae),le.parent=ae.parent),ae.parent?ae===ae.parent.left?ae.parent.left=le:ae.parent.right=le:this._root=le,le&&(le.right=ae),ae.parent=le},h.prototype._splay=function(ae){for(;ae.parent;){var le=ae.parent;le.parent?le.left===ae&&le.parent.left===le?(this.rotateRight(le.parent),this.rotateRight(le)):le.right===ae&&le.parent.right===le?(this.rotateLeft(le.parent),this.rotateLeft(le)):le.left===ae&&le.parent.right===le?(this.rotateRight(le),this.rotateLeft(le)):(this.rotateLeft(le),this.rotateRight(le)):le.left===ae?this.rotateRight(le):this.rotateLeft(le)}},h.prototype.splay=function(ae){for(var le,et,ct,Nt,Bt;ae.parent;)(et=(le=ae.parent).parent)&&et.parent?((ct=et.parent).left===et?ct.left=ae:ct.right=ae,ae.parent=ct):(ae.parent=null,this._root=ae),Nt=ae.left,Bt=ae.right,ae===le.left?(et&&(et.left===le?(le.right?(et.left=le.right,et.left.parent=et):et.left=null,le.right=et,et.parent=le):(Nt?(et.right=Nt,Nt.parent=et):et.right=null,ae.left=et,et.parent=ae)),Bt?(le.left=Bt,Bt.parent=le):le.left=null,ae.right=le,le.parent=ae):(et&&(et.right===le?(le.left?(et.right=le.left,et.right.parent=et):et.right=null,le.left=et,et.parent=le):(Bt?(et.left=Bt,Bt.parent=et):et.left=null,ae.right=et,et.parent=ae)),Nt?(le.right=Nt,Nt.parent=le):le.right=null,ae.left=le,le.parent=ae)},h.prototype.replace=function(ae,le){ae.parent?ae===ae.parent.left?ae.parent.left=le:ae.parent.right=le:this._root=le,le&&(le.parent=ae.parent)},h.prototype.minNode=function(ae){if(ae===void 0&&(ae=this._root),ae)for(;ae.left;)ae=ae.left;return ae},h.prototype.maxNode=function(ae){if(ae===void 0&&(ae=this._root),ae)for(;ae.right;)ae=ae.right;return ae},h.prototype.insert=function(ae,le){var et=this._root,ct=null,Nt=this._compare;if(this._noDuplicates)for(;et;){if(ct=et,Nt(et.key,ae)===0)return;et=Nt(et.key,ae)<0?et.right:et.left}else for(;et;)ct=et,et=Nt(et.key,ae)<0?et.right:et.left;return et={key:ae,data:le,left:null,right:null,parent:ct},ct?Nt(ct.key,et.key)<0?ct.right=et:ct.left=et:this._root=et,this.splay(et),this._size++,et},h.prototype.find=function(ae){for(var le=this._root,et=this._compare;le;){var ct=et(le.key,ae);if(ct<0)le=le.right;else{if(!(ct>0))return le;le=le.left}}return null},h.prototype.contains=function(ae){for(var le=this._root,et=this._compare;le;){var ct=et(ae,le.key);if(ct===0)return!0;le=ct<0?le.left:le.right}return!1},h.prototype.remove=function(ae){var le=this.find(ae);if(!le)return!1;if(this.splay(le),le.left)if(le.right){var et=this.minNode(le.right);et.parent!==le&&(this.replace(et,et.right),et.right=le.right,et.right.parent=et),this.replace(le,et),et.left=le.left,et.left.parent=et}else this.replace(le,le.left);else this.replace(le,le.right);return this._size--,!0},h.prototype.removeNode=function(ae){if(!ae)return!1;if(this.splay(ae),ae.left)if(ae.right){var le=this.minNode(ae.right);le.parent!==ae&&(this.replace(le,le.right),le.right=ae.right,le.right.parent=le),this.replace(ae,le),le.left=ae.left,le.left.parent=le}else this.replace(ae,ae.left);else this.replace(ae,ae.right);return this._size--,!0},h.prototype.erase=function(ae){var le=this.find(ae);if(le){this.splay(le);var et=le.left,ct=le.right,Nt=null;et&&(et.parent=null,Nt=this.maxNode(et),this.splay(Nt),this._root=Nt),ct&&(et?Nt.right=ct:this._root=ct,ct.parent=Nt),this._size--}},h.prototype.pop=function(){var ae=this._root,le=null;if(ae){for(;ae.left;)ae=ae.left;le={key:ae.key,data:ae.data},this.remove(ae.key)}return le},h.prototype.next=function(ae){var le=ae;if(le)if(le.right)for(le=le.right;le&&le.left;)le=le.left;else for(le=ae.parent;le&&le.right===ae;)ae=le,le=le.parent;return le},h.prototype.prev=function(ae){var le=ae;if(le)if(le.left)for(le=le.left;le&&le.right;)le=le.right;else for(le=ae.parent;le&&le.left===ae;)ae=le,le=le.parent;return le},h.prototype.forEach=function(ae){for(var le=this._root,et=[],ct=!1,Nt=0;!ct;)le?(et.push(le),le=le.left):et.length>0?(ae(le=et.pop(),Nt++),le=le.right):ct=!0;return this},h.prototype.range=function(ae,le,et,ct){for(var Nt=[],Bt=this._compare,Kt=this._root;Nt.length!==0||Kt;)if(Kt)Nt.push(Kt),Kt=Kt.left;else{if(Bt((Kt=Nt.pop()).key,le)>0)break;if(Bt(Kt.key,ae)>=0&&et.call(ct,Kt))return this;Kt=Kt.right}return this},h.prototype.keys=function(){for(var ae=this._root,le=[],et=[],ct=!1;!ct;)ae?(le.push(ae),ae=ae.left):le.length>0?(ae=le.pop(),et.push(ae.key),ae=ae.right):ct=!0;return et},h.prototype.values=function(){for(var ae=this._root,le=[],et=[],ct=!1;!ct;)ae?(le.push(ae),ae=ae.left):le.length>0?(ae=le.pop(),et.push(ae.data),ae=ae.right):ct=!0;return et},h.prototype.at=function(ae){for(var le=this._root,et=[],ct=!1,Nt=0;!ct;)if(le)et.push(le),le=le.left;else if(et.length>0){if(le=et.pop(),Nt===ae)return le;Nt++,le=le.right}else ct=!0;return null},h.prototype.load=function(ae,le,et){if(ae===void 0&&(ae=[]),le===void 0&&(le=[]),et===void 0&&(et=!1),this._size!==0)throw new Error("bulk-load: tree is not empty");var ct=ae.length;return et&&b(ae,le,0,ct-1,this._compare),this._root=_(null,ae,le,0,ct),this._size=ct,this},h.prototype.min=function(){var ae=this.minNode(this._root);return ae?ae.key:null},h.prototype.max=function(){var ae=this.maxNode(this._root);return ae?ae.key:null},h.prototype.isEmpty=function(){return this._root===null},g.size.get=function(){return this._size},h.createTree=function(ae,le,et,ct,Nt){return new h(et,Nt).load(ae,le,ct)},Object.defineProperties(h.prototype,g);var T=0,E=1,A=2,R=3,M=0,F=1,B=2,W=3;function q(ae,le,et){le===null?(ae.inOut=!1,ae.otherInOut=!0):(ae.isSubject===le.isSubject?(ae.inOut=!le.inOut,ae.otherInOut=le.otherInOut):(ae.inOut=!le.otherInOut,ae.otherInOut=le.isVertical()?!le.inOut:le.inOut),le&&(ae.prevInResult=!K(le,et)||le.isVertical()?le.prevInResult:le));var ct=K(ae,et);ae.resultTransition=ct?(function(Nt,Bt){var Kt,_n=!Nt.inOut,tr=!Nt.otherInOut;switch(Bt){case M:Kt=_n&&tr;break;case F:Kt=_n||tr;break;case W:Kt=_n^tr;break;case B:Kt=Nt.isSubject?_n&&!tr:tr&&!_n}return Kt?1:-1})(ae,et):0}function K(ae,le){switch(ae.type){case T:switch(le){case M:return!ae.otherInOut;case F:return ae.otherInOut;case B:return ae.isSubject&&ae.otherInOut||!ae.isSubject&&!ae.otherInOut;case W:return!0}break;case A:return le===M||le===F;case R:return le===B;case E:return!1}return!1}var ne=function(ae,le,et,ct,Nt){this.left=le,this.point=ae,this.otherEvent=et,this.isSubject=ct,this.type=Nt||T,this.inOut=!1,this.otherInOut=!1,this.prevInResult=null,this.resultTransition=0,this.otherPos=-1,this.outputContourId=-1,this.isExteriorRing=!0},re={inResult:{configurable:!0}};function oe(ae,le){return ae[0]===le[0]&&ae[1]===le[1]}ne.prototype.isBelow=function(ae){var le=this.point,et=this.otherEvent.point;return this.left?(le[0]-ae[0])*(et[1]-ae[1])-(et[0]-ae[0])*(le[1]-ae[1])>0:(et[0]-ae[0])*(le[1]-ae[1])-(le[0]-ae[0])*(et[1]-ae[1])>0},ne.prototype.isAbove=function(ae){return!this.isBelow(ae)},ne.prototype.isVertical=function(){return this.point[0]===this.otherEvent.point[0]},re.inResult.get=function(){return this.resultTransition!==0},ne.prototype.clone=function(){var ae=new ne(this.point,this.left,this.otherEvent,this.isSubject,this.type);return ae.contourId=this.contourId,ae.resultTransition=this.resultTransition,ae.prevInResult=this.prevInResult,ae.isExteriorRing=this.isExteriorRing,ae.inOut=this.inOut,ae.otherInOut=this.otherInOut,ae},Object.defineProperties(ne.prototype,re);var ye=11102230246251565e-32,ve=134217729,Ce=(3+8*ye)*ye;function Oe(ae,le,et,ct,Nt){var Bt,Kt,_n,tr,nr=le[0],Jn=ct[0],Kr=0,Ii=0;Jn>nr==Jn>-nr?(Bt=nr,nr=le[++Kr]):(Bt=Jn,Jn=ct[++Ii]);var Zn=0;if(Kr<ae&&Ii<et)for(Jn>nr==Jn>-nr?(_n=Bt-((Kt=nr+Bt)-nr),nr=le[++Kr]):(_n=Bt-((Kt=Jn+Bt)-Jn),Jn=ct[++Ii]),Bt=Kt,_n!==0&&(Nt[Zn++]=_n);Kr<ae&&Ii<et;)Jn>nr==Jn>-nr?(_n=Bt-((Kt=Bt+nr)-(tr=Kt-Bt))+(nr-tr),nr=le[++Kr]):(_n=Bt-((Kt=Bt+Jn)-(tr=Kt-Bt))+(Jn-tr),Jn=ct[++Ii]),Bt=Kt,_n!==0&&(Nt[Zn++]=_n);for(;Kr<ae;)_n=Bt-((Kt=Bt+nr)-(tr=Kt-Bt))+(nr-tr),nr=le[++Kr],Bt=Kt,_n!==0&&(Nt[Zn++]=_n);for(;Ii<et;)_n=Bt-((Kt=Bt+Jn)-(tr=Kt-Bt))+(Jn-tr),Jn=ct[++Ii],Bt=Kt,_n!==0&&(Nt[Zn++]=_n);return Bt===0&&Zn!==0||(Nt[Zn++]=Bt),Zn}function De(ae){return new Float64Array(ae)}var ut=33306690738754716e-32,Ue=22204460492503146e-32,ht=11093356479670487e-47,wt=De(4),mt=De(8),yt=De(12),Et=De(16),lt=De(4);function vt(ae,le,et){var ct=(function(Nt,Bt,Kt,_n,tr,nr){var Jn=(Bt-nr)*(Kt-tr),Kr=(Nt-tr)*(_n-nr),Ii=Jn-Kr;if(Jn===0||Kr===0||Jn>0!=Kr>0)return Ii;var Zn=Math.abs(Jn+Kr);return Math.abs(Ii)>=ut*Zn?Ii:-(function(mi,Jr,Dr,_i,yi,ci,gi){var Qr,rr,ni,Ni,On,Er,vi,Ki,Si,Ao,ii,xo,Qs,is,Jo,ea,Zc,Po,Uo=mi-yi,os=Dr-yi,Es=Jr-ci,fs=_i-ci;wt[0]=(Jo=(Ki=Uo-(vi=(Er=ve*Uo)-(Er-Uo)))*(Ao=fs-(Si=(Er=ve*fs)-(Er-fs)))-((is=Uo*fs)-vi*Si-Ki*Si-vi*Ao))-((ii=Jo-(Zc=(Ki=Es-(vi=(Er=ve*Es)-(Er-Es)))*(Ao=os-(Si=(Er=ve*os)-(Er-os)))-((ea=Es*os)-vi*Si-Ki*Si-vi*Ao)))+(On=Jo-ii))+(On-Zc),wt[1]=(Qs=is-((xo=is+ii)-(On=xo-is))+(ii-On))-((ii=Qs-ea)+(On=Qs-ii))+(On-ea),wt[2]=xo-((Po=xo+ii)-(On=Po-xo))+(ii-On),wt[3]=Po;var _h=(function(SSe,bO){for(var xO=bO[0],WE=1;WE<4;WE++)xO+=bO[WE];return xO})(0,wt),qy=Ue*gi;if(_h>=qy||-_h>=qy||(Qr=mi-(Uo+(On=mi-Uo))+(On-yi),ni=Dr-(os+(On=Dr-os))+(On-yi),rr=Jr-(Es+(On=Jr-Es))+(On-ci),Ni=_i-(fs+(On=_i-fs))+(On-ci),Qr===0&&rr===0&&ni===0&&Ni===0)||(qy=ht*gi+Ce*Math.abs(_h),(_h+=Uo*Ni+fs*Qr-(Es*ni+os*rr))>=qy||-_h>=qy))return _h;lt[0]=(Jo=(Ki=Qr-(vi=(Er=ve*Qr)-(Er-Qr)))*(Ao=fs-(Si=(Er=ve*fs)-(Er-fs)))-((is=Qr*fs)-vi*Si-Ki*Si-vi*Ao))-((ii=Jo-(Zc=(Ki=rr-(vi=(Er=ve*rr)-(Er-rr)))*(Ao=os-(Si=(Er=ve*os)-(Er-os)))-((ea=rr*os)-vi*Si-Ki*Si-vi*Ao)))+(On=Jo-ii))+(On-Zc),lt[1]=(Qs=is-((xo=is+ii)-(On=xo-is))+(ii-On))-((ii=Qs-ea)+(On=Qs-ii))+(On-ea),lt[2]=xo-((Po=xo+ii)-(On=Po-xo))+(ii-On),lt[3]=Po;var D9=Oe(4,wt,4,lt,mt);lt[0]=(Jo=(Ki=Uo-(vi=(Er=ve*Uo)-(Er-Uo)))*(Ao=Ni-(Si=(Er=ve*Ni)-(Er-Ni)))-((is=Uo*Ni)-vi*Si-Ki*Si-vi*Ao))-((ii=Jo-(Zc=(Ki=Es-(vi=(Er=ve*Es)-(Er-Es)))*(Ao=ni-(Si=(Er=ve*ni)-(Er-ni)))-((ea=Es*ni)-vi*Si-Ki*Si-vi*Ao)))+(On=Jo-ii))+(On-Zc),lt[1]=(Qs=is-((xo=is+ii)-(On=xo-is))+(ii-On))-((ii=Qs-ea)+(On=Qs-ii))+(On-ea),lt[2]=xo-((Po=xo+ii)-(On=Po-xo))+(ii-On),lt[3]=Po;var L9=Oe(D9,mt,4,lt,yt);lt[0]=(Jo=(Ki=Qr-(vi=(Er=ve*Qr)-(Er-Qr)))*(Ao=Ni-(Si=(Er=ve*Ni)-(Er-Ni)))-((is=Qr*Ni)-vi*Si-Ki*Si-vi*Ao))-((ii=Jo-(Zc=(Ki=rr-(vi=(Er=ve*rr)-(Er-rr)))*(Ao=ni-(Si=(Er=ve*ni)-(Er-ni)))-((ea=rr*ni)-vi*Si-Ki*Si-vi*Ao)))+(On=Jo-ii))+(On-Zc),lt[1]=(Qs=is-((xo=is+ii)-(On=xo-is))+(ii-On))-((ii=Qs-ea)+(On=Qs-ii))+(On-ea),lt[2]=xo-((Po=xo+ii)-(On=Po-xo))+(ii-On),lt[3]=Po;var z9=Oe(L9,yt,4,lt,Et);return Et[z9-1]})(Nt,Bt,Kt,_n,tr,nr,Zn)})(ae[0],ae[1],le[0],le[1],et[0],et[1]);return ct>0?-1:ct<0?1:0}function rt(ae,le){var et=ae.point,ct=le.point;return et[0]>ct[0]?1:et[0]<ct[0]?-1:et[1]!==ct[1]?et[1]>ct[1]?1:-1:(function(Nt,Bt,Kt,_n){return Nt.left!==Bt.left?Nt.left?1:-1:vt(Kt,Nt.otherEvent.point,Bt.otherEvent.point)!==0?Nt.isBelow(Bt.otherEvent.point)?-1:1:!Nt.isSubject&&Bt.isSubject?1:-1})(ae,le,et)}function Xe(ae,le,et){var ct=new ne(le,!1,ae,ae.isSubject),Nt=new ne(le,!0,ae.otherEvent,ae.isSubject);return oe(ae.point,ae.otherEvent.point)&&console.warn("what is that, a collapsed segment?",ae),ct.contourId=Nt.contourId=ae.contourId,rt(Nt,ae.otherEvent)>0&&(ae.otherEvent.left=!0,Nt.left=!1),ae.otherEvent.otherEvent=Nt,ae.otherEvent=ct,et.push(Nt),et.push(ct),et}function Ct(ae,le){return ae[0]*le[1]-ae[1]*le[0]}function Tt(ae,le){return ae[0]*le[0]+ae[1]*le[1]}function hn(ae,le,et){var ct=(function(tr,nr,Jn,Kr,Ii){var Zn=[nr[0]-tr[0],nr[1]-tr[1]],mi=[Kr[0]-Jn[0],Kr[1]-Jn[1]];function Jr(Er,vi,Ki){return[Er[0]+vi*Ki[0],Er[1]+vi*Ki[1]]}var Dr=[Jn[0]-tr[0],Jn[1]-tr[1]],_i=Ct(Zn,mi),yi=_i*_i,ci=Tt(Zn,Zn);if(yi>0){var gi=Ct(Dr,mi)/_i;if(gi<0||gi>1)return null;var Qr=Ct(Dr,Zn)/_i;return Qr<0||Qr>1?null:gi===0||gi===1?[Jr(tr,gi,Zn)]:Qr===0||Qr===1?[Jr(Jn,Qr,mi)]:[Jr(tr,gi,Zn)]}if((yi=(_i=Ct(Dr,Zn))*_i)>0)return null;var rr=Tt(Zn,Dr)/ci,ni=rr+Tt(Zn,mi)/ci,Ni=Math.min(rr,ni),On=Math.max(rr,ni);return Ni<=1&&On>=0?Ni===1?[Jr(tr,Ni>0?Ni:0,Zn)]:On===0?[Jr(tr,On<1?On:1,Zn)]:[Jr(tr,Ni>0?Ni:0,Zn),Jr(tr,On<1?On:1,Zn)]:null})(ae.point,ae.otherEvent.point,le.point,le.otherEvent.point),Nt=ct?ct.length:0;if(Nt===0||Nt===1&&(oe(ae.point,le.point)||oe(ae.otherEvent.point,le.otherEvent.point))||Nt===2&&ae.isSubject===le.isSubject)return 0;if(Nt===1)return oe(ae.point,ct[0])||oe(ae.otherEvent.point,ct[0])||Xe(ae,ct[0],et),oe(le.point,ct[0])||oe(le.otherEvent.point,ct[0])||Xe(le,ct[0],et),1;var Bt=[],Kt=!1,_n=!1;return oe(ae.point,le.point)?Kt=!0:rt(ae,le)===1?Bt.push(le,ae):Bt.push(ae,le),oe(ae.otherEvent.point,le.otherEvent.point)?_n=!0:rt(ae.otherEvent,le.otherEvent)===1?Bt.push(le.otherEvent,ae.otherEvent):Bt.push(ae.otherEvent,le.otherEvent),Kt&&_n||Kt?(le.type=E,ae.type=le.inOut===ae.inOut?A:R,Kt&&!_n&&Xe(Bt[1].otherEvent,Bt[0].point,et),2):_n?(Xe(Bt[0],Bt[1].point,et),3):Bt[0]!==Bt[3].otherEvent?(Xe(Bt[0],Bt[1].point,et),Xe(Bt[1],Bt[2].point,et),3):(Xe(Bt[0],Bt[1].point,et),Xe(Bt[3].otherEvent,Bt[2].point,et),3)}function Ht(ae,le){if(ae===le)return 0;if(vt(ae.point,ae.otherEvent.point,le.point)!==0||vt(ae.point,ae.otherEvent.point,le.otherEvent.point)!==0)return oe(ae.point,le.point)?ae.isBelow(le.otherEvent.point)?-1:1:ae.point[0]===le.point[0]?ae.point[1]<le.point[1]?-1:1:rt(ae,le)===1?le.isAbove(ae.point)?-1:1:ae.isBelow(le.point)?-1:1;if(ae.isSubject!==le.isSubject)return ae.isSubject?-1:1;var et=ae.point,ct=le.point;return et[0]===ct[0]&&et[1]===ct[1]?(et=ae.otherEvent.point)[0]===(ct=le.otherEvent.point)[0]&&et[1]===ct[1]?0:ae.contourId>le.contourId?1:-1:rt(ae,le)===1?1:-1}var Jt=function(){this.points=[],this.holeIds=[],this.holeOf=null,this.depth=null};function Dt(ae,le,et,ct){var Nt,Bt=ae+1,Kt=le[ae].point,_n=le.length;for(Bt<_n&&(Nt=le[Bt].point);Bt<_n&&Nt[0]===Kt[0]&&Nt[1]===Kt[1];){if(!et[Bt])return Bt;++Bt<_n&&(Nt=le[Bt].point)}for(Bt=ae-1;et[Bt]&&Bt>ct;)Bt--;return Bt}Jt.prototype.isExterior=function(){return this.holeOf==null};var dn=Vt,Fn=Vt;function Vt(ae,le){if(!(this instanceof Vt))return new Vt(ae,le);if(this.data=ae||[],this.length=this.data.length,this.compare=le||tn,this.length>0)for(var et=(this.length>>1)-1;et>=0;et--)this._down(et)}function tn(ae,le){return ae<le?-1:ae>le?1:0}Vt.prototype={push:function(ae){this.data.push(ae),this.length++,this._up(this.length-1)},pop:function(){if(this.length!==0){var ae=this.data[0];return this.length--,this.length>0&&(this.data[0]=this.data[this.length],this._down(0)),this.data.pop(),ae}},peek:function(){return this.data[0]},_up:function(ae){for(var le=this.data,et=this.compare,ct=le[ae];ae>0;){var Nt=ae-1>>1,Bt=le[Nt];if(et(ct,Bt)>=0)break;le[ae]=Bt,ae=Nt}le[ae]=ct},_down:function(ae){for(var le=this.data,et=this.compare,ct=this.length>>1,Nt=le[ae];ae<ct;){var Bt=1+(ae<<1),Kt=Bt+1,_n=le[Bt];if(Kt<this.length&&et(le[Kt],_n)<0&&(Bt=Kt,_n=le[Kt]),et(_n,Nt)>=0)break;le[ae]=_n,ae=Bt}le[ae]=Nt}},dn.default=Fn;var An=Math.max,Nn=Math.min,er=0;function Un(ae,le,et,ct,Nt,Bt){var Kt,_n,tr,nr,Jn,Kr;for(Kt=0,_n=ae.length-1;Kt<_n;Kt++)if(nr=ae[Kt+1],Jn=new ne(tr=ae[Kt],!1,void 0,le),Kr=new ne(nr,!1,Jn,le),Jn.otherEvent=Kr,tr[0]!==nr[0]||tr[1]!==nr[1]){Jn.contourId=Kr.contourId=et,Bt||(Jn.isExteriorRing=!1,Kr.isExteriorRing=!1),rt(Jn,Kr)>0?Kr.left=!0:Jn.left=!0;var Ii=tr[0],Zn=tr[1];Nt[0]=Nn(Nt[0],Ii),Nt[1]=Nn(Nt[1],Zn),Nt[2]=An(Nt[2],Ii),Nt[3]=An(Nt[3],Zn),ct.push(Jn),ct.push(Kr)}}var Xt=[];function Vn(ae,le,et){typeof ae[0][0][0]=="number"&&(ae=[ae]),typeof le[0][0][0]=="number"&&(le=[le]);var ct=(function(Zn,mi,Jr){var Dr=null;return Zn.length*mi.length==0&&(Jr===M?Dr=Xt:Jr===B?Dr=Zn:Jr!==F&&Jr!==W||(Dr=Zn.length===0?mi:Zn)),Dr})(ae,le,et);if(ct)return ct===Xt?null:ct;var Nt=[1/0,1/0,-1/0,-1/0],Bt=[1/0,1/0,-1/0,-1/0],Kt=(function(Zn,mi,Jr,Dr,_i){var yi,ci,gi,Qr,rr,ni,Ni=new dn(null,rt);for(gi=0,Qr=Zn.length;gi<Qr;gi++)for(rr=0,ni=(yi=Zn[gi]).length;rr<ni;rr++)(ci=rr===0)&&er++,Un(yi[rr],!0,er,Ni,Jr,ci);for(gi=0,Qr=mi.length;gi<Qr;gi++)for(rr=0,ni=(yi=mi[gi]).length;rr<ni;rr++)ci=rr===0,_i===B&&(ci=!1),ci&&er++,Un(yi[rr],!1,er,Ni,Dr,ci);return Ni})(ae,le,Nt,Bt,et);if(ct=(function(Zn,mi,Jr,Dr,_i){var yi=null;return(Jr[0]>Dr[2]||Dr[0]>Jr[2]||Jr[1]>Dr[3]||Dr[1]>Jr[3])&&(_i===M?yi=Xt:_i===B?yi=Zn:_i!==F&&_i!==W||(yi=Zn.concat(mi))),yi})(ae,le,Nt,Bt,et))return ct===Xt?null:ct;for(var _n=(function(Zn){var mi,Jr,Dr=(function(gi){var Qr,rr,ni,Ni,On=[];for(rr=0,ni=gi.length;rr<ni;rr++)((Qr=gi[rr]).left&&Qr.inResult||!Qr.left&&Qr.otherEvent.inResult)&&On.push(Qr);for(var Er=!1;!Er;)for(Er=!0,rr=0,ni=On.length;rr<ni;rr++)rr+1<ni&&rt(On[rr],On[rr+1])===1&&(Ni=On[rr],On[rr]=On[rr+1],On[rr+1]=Ni,Er=!1);for(rr=0,ni=On.length;rr<ni;rr++)(Qr=On[rr]).otherPos=rr;for(rr=0,ni=On.length;rr<ni;rr++)(Qr=On[rr]).left||(Ni=Qr.otherPos,Qr.otherPos=Qr.otherEvent.otherPos,Qr.otherEvent.otherPos=Ni);return On})(Zn),_i={},yi=[],ci=function(){if(!_i[mi]){var gi=yi.length,Qr=(function(On,Er,vi){var Ki=new Jt;if(On.prevInResult!=null){var Si=On.prevInResult,Ao=Si.outputContourId;if(Si.resultTransition>0){var ii=Er[Ao];if(ii.holeOf!=null){var xo=ii.holeOf;Er[xo].holeIds.push(vi),Ki.holeOf=xo,Ki.depth=Er[Ao].depth}else Er[Ao].holeIds.push(vi),Ki.holeOf=Ao,Ki.depth=Er[Ao].depth+1}else Ki.holeOf=null,Ki.depth=Er[Ao].depth}else Ki.holeOf=null,Ki.depth=0;return Ki})(Dr[mi],yi,gi),rr=function(On){_i[On]=!0,On<Dr.length&&Dr[On]&&(Dr[On].outputContourId=gi)},ni=mi,Ni=mi;for(Qr.points.push(Dr[mi].point);rr(ni),rr(ni=Dr[ni].otherPos),Qr.points.push(Dr[ni].point),!((ni=Dt(ni,Dr,_i,Ni))==Ni||ni>=Dr.length)&&Dr[ni];);yi.push(Qr)}};for(mi=0,Jr=Dr.length;mi<Jr;mi++)ci();return yi})((function(Zn,mi,Jr,Dr,_i,yi){for(var ci,gi,Qr,rr=new h(Ht),ni=[],Ni=Math.min(Dr[2],_i[2]);Zn.length!==0;){var On=Zn.pop();if(ni.push(On),yi===M&&On.point[0]>Ni||yi===B&&On.point[0]>Dr[2])break;if(On.left){gi=ci=rr.insert(On),ci=ci!==(Qr=rr.minNode())?rr.prev(ci):null,gi=rr.next(gi);var Er=ci?ci.key:null;if(q(On,Er,yi),gi&&hn(On,gi.key,Zn)===2&&(q(On,Er,yi),q(gi.key,On,yi)),ci&&hn(ci.key,On,Zn)===2){var vi=ci;q(Er,(vi=vi!==Qr?rr.prev(vi):null)?vi.key:null,yi),q(On,Er,yi)}}else gi=ci=rr.find(On=On.otherEvent),ci&&gi&&(ci=ci!==Qr?rr.prev(ci):null,gi=rr.next(gi),rr.remove(On),gi&&ci&&hn(ci.key,gi.key,Zn))}return ni})(Kt,0,0,Nt,Bt,et)),tr=[],nr=0;nr<_n.length;nr++){var Jn=_n[nr];if(Jn.isExterior()){for(var Kr=[Jn.points],Ii=0;Ii<Jn.holeIds.length;Ii++)Kr.push(_n[Jn.holeIds[Ii]].points);tr.push(Kr)}}return tr}var br={UNION:F,DIFFERENCE:B,INTERSECTION:M,XOR:W};o.diff=function(ae,le){return Vn(ae,le,B)},o.intersection=function(ae,le){return Vn(ae,le,M)},o.operations=br,o.union=function(ae,le){return Vn(ae,le,F)},o.xor=function(ae,le){return Vn(ae,le,W)},Object.defineProperty(o,"__esModule",{value:!0})})(r)})(0,oR.exports)),oR.exports);/**
 * martinez v0.7.4
 * Martinez polygon clipping algorithm, does boolean operation on polygons (multipolygons, polygons with holes etc): intersection, union, difference, xor
 *
 * @author Alex Milevski <info@w8r.name>
 * @license MIT
 * @preserve
 */function m1(a,r,o,u){const h=[],g=u===0?(_,b,T,E,A,R)=>{_.push(new xt(R,T+(R-b)/(E-b)*(A-T)))}:(_,b,T,E,A,R)=>{_.push(new xt(b+(R-T)/(A-T)*(E-b),R))};for(const _ of a){const b=[];for(const T of _){if(T.length<=2)continue;const E=[];for(let M=0;M<T.length-1;M++){const F=T[M].x,B=T[M].y,W=T[M+1].x,q=T[M+1].y,K=u===0?F:B,ne=u===0?W:q;K<r?ne>r&&g(E,F,B,W,q,r):K>o?ne<o&&g(E,F,B,W,q,o):E.push(T[M]),ne<r&&K>=r&&g(E,F,B,W,q,r),ne>o&&K<=o&&g(E,F,B,W,q,o)}let A=T[T.length-1];const R=u===0?A.x:A.y;R>=r&&R<=o&&E.push(A),E.length&&(A=E[E.length-1],E[0].x===A.x&&E[0].y===A.y||E.push(E[0]),b.push(E))}b.length&&h.push(b)}return h}function k8(a,r){const o=$S(a),u=$S([r]),h=sR.intersection(o,u);return h==null?[]:aR(h)}function O8(a,r){let u=$S(a,65536);const h=[];for(;r.valid();r.next()){const[g,_]=r.get(),b=g.x*65536,T=g.y*65536,E=_.x*65536,A=_.y*65536,R=E-b,M=A-T,F=Math.hypot(R,M);if(F===0)continue;const B=Math.trunc(M/F*3),W=-Math.trunc(R/F*3);h.push([[[b,T],[E,A],[E+B,A+W],[b+B,T+W],[b,T]]])}return h.length>0&&(u=sR.diff(u,h)),aR(u,1/65536)}function $S(a,r=1){return[a.map((o=>o.map((u=>[u.x*r,u.y*r]))))]}function aR(a,r=1){return a.map((o=>o.map(((u,h)=>{const g=u.map((_=>new xt(_[0]*r,_[1]*r).round()));return h>0&&g.reverse(),g}))))}class US{constructor(r,o){this.layoutVertexArray=new Vc,this.indexArray=new Mo,this.lineIndexArray=new Co,this.triangleSegments=new Bi,this.lineSegments=new Bi,this.programConfigurations=new tl(r.layers,{zoom:r.zoom,lut:r.lut}),this.uploaded=!1,o&&(this.elevatedLayoutVertexArray=new $c)}update(r,o,u,h,g,_,b,T){this.programConfigurations.updatePaintArrays(r,o,g,u,h,_,b,T)}isEmpty(){return this.layoutVertexArray.length===0}needsUpload(){return this.programConfigurations.needsUpload}upload(r){this.uploaded||(this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,g8.members),this.indexBuffer=r.createIndexBuffer(this.indexArray),this.lineIndexBuffer=r.createIndexBuffer(this.lineIndexArray),this.elevatedLayoutVertexArray&&this.elevatedLayoutVertexArray.length>0&&(this.elevatedLayoutVertexBuffer=r.createVertexBuffer(this.elevatedLayoutVertexArray,_8.members))),this.programConfigurations.upload(r),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.elevatedLayoutVertexBuffer&&this.elevatedLayoutVertexBuffer.destroy(),this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.lineIndexBuffer.destroy(),this.programConfigurations.destroy(),this.triangleSegments.destroy(),this.lineSegments.destroy())}populatePaintArrays(r,o,u,h,g,_,b){this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,r,o,u,h,g,_,void 0,b)}}class jS{constructor(r){this.zoom=r.zoom,this.pixelRatio=r.pixelRatio,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map((o=>o.fqid)),this.index=r.index,this.hasPattern=!1,this.patternFeatures=[],this.lut=r.lut,this.bufferData=new US(r,!1),this.elevationBufferData=new US(r,!0),this.stateDependentLayerIds=this.layers.filter((o=>o.isStateDependent())).map((o=>o.id)),this.projection=r.projection,this.elevationMode=this.layers[0].layout.get("fill-elevation-reference"),this.sourceLayerIndex=r.sourceLayerIndex,this.worldview=r.worldview}updateFootprints(r,o){}populate(r,o,u,h){this.hasPattern=NS("fill",this.layers,this.pixelRatio,o);const g=this.layers[0].layout.get("fill-sort-key"),_=[];for(const{feature:b,id:T,index:E,sourceLayerIndex:A}of r){const R=this.layers[0]._featureFilter.needGeometry,M=St(b,R);if(!this.layers[0]._featureFilter.filter(new pi(this.zoom,{worldview:this.worldview}),M,u))continue;const F=g?g.evaluate(M,{},u,o.availableImages):void 0,B={id:T,properties:b.properties,type:b.type,sourceLayerIndex:A,index:E,geometry:R?M.geometry:Ut(b,u,h),patterns:{},sortKey:F};_.push(B)}g&&_.sort(((b,T)=>b.sortKey-T.sortKey));for(const b of _){const{geometry:T,index:E,sourceLayerIndex:A}=b;if(this.hasPattern){const R=VS("fill",this.layers,b,this.zoom,this.pixelRatio,o);this.patternFeatures.push(R)}else this.addFeature(b,T,E,u,{},o.availableImages,o.brightness,o.elevationFeatures);o.featureIndex.insert(r[E].feature,T,E,A,this.index)}}update(r,o,u,h,g,_,b){this.bufferData.update(r,o,u,h,g,_,b,this.worldview),this.elevationBufferData.update(r,o,u,h,g,_,b,this.worldview),this.elevatedStructures&&this.elevatedStructures.update(r,o,u,h,g,_,b,this.worldview)}addFeatures(r,o,u,h,g,_){for(const b of this.patternFeatures)this.addFeature(b,b.geometry,b.index,o,u,h,_,r.elevationFeatures)}isEmpty(){return this.bufferData.isEmpty()&&this.elevationBufferData.isEmpty()}uploadPending(){return!this.uploaded||this.bufferData.needsUpload()||this.elevationBufferData.needsUpload()}upload(r){this.bufferData.upload(r),this.elevationBufferData.upload(r),this.elevatedStructures&&this.elevatedStructures.upload(r)}destroy(){this.bufferData.destroy(),this.elevationBufferData.destroy(),this.elevatedStructures&&this.elevatedStructures.destroy()}addFeature(r,o,u,h,g,_=[],b,T){const E=gy(o,500);this.elevationMode!=="none"?this.addElevatedRoadFeature(r,E,h,u,T):this.addGeometry(E,this.bufferData),this.bufferData.populatePaintArrays(r,u,g,_,h,b,this.worldview),this.elevationBufferData.populatePaintArrays(r,u,g,_,h,b,this.worldview)}getUnevaluatedPortalGraph(){return this.elevatedStructures?this.elevatedStructures.unevaluatedPortals:void 0}getElevationPolygons(){return this.elevatedStructures?this.elevatedStructures.portalPolygons:void 0}setEvaluatedPortalGraph(r,o,u,h,g){this.elevatedStructures&&(this.elevatedStructures.construct(r),this.elevatedStructures.populatePaintArrays(o,u,h,g,this.worldview))}addElevatedRoadFeature(r,o,u,h,g){const _=new Array,b=ki.getElevationFeature(r,g);if(!b)return void this.addGeometry(o,this.bufferData);{const E=this.clipPolygonsToTile(o,1);E.length>0&&_.push({polygons:E,elevationFeature:b,elevationTileID:u})}const T={guardRailEnabled:this.layers[0].layout.get("fill-construct-bridge-guard-rail").evaluate(r,{},u),featureIndex:h};for(const E of _)if(E.elevationFeature){if(this.elevationMode==="hd-road-base"){this.elevatedStructures||(this.elevatedStructures=new xa(E.elevationTileID,this.layers,this.zoom,this.lut));const R=E.elevationFeature.isTunnel();let M=0;r.properties.hasOwnProperty(Wr)&&(M=+r.properties[Wr]);for(const F of E.polygons)this.elevatedStructures.addPortalCandidates(E.elevationFeature.id,F,R,E.elevationFeature,M)}E.elevationFeature.constantHeight==null&&(E.polygons=this.prepareElevatedPolygons(E.polygons,E.elevationFeature,E.elevationTileID));const A=new yo(u,E.elevationTileID);this.addElevatedGeometry(E.polygons,A,E.elevationFeature,this.elevationMode==="hd-road-base"?0:.05,h,T)}}addElevatedGeometry(r,o,u,h,g,_){const b={elevation:u,elevationSampler:o,bias:h,index:g,featureInfo:_},[T,E]=this.addGeometry(r,this.elevationBufferData,b);this.elevationBufferData.heightRange==null?this.elevationBufferData.heightRange={min:T,max:E}:(this.elevationBufferData.heightRange.min=Math.min(this.elevationBufferData.heightRange.min,T),this.elevationBufferData.heightRange.max=Math.max(this.elevationBufferData.heightRange.max,E))}addGeometry(r,o,u){let h=Number.POSITIVE_INFINITY,g=Number.NEGATIVE_INFINITY,_=null;u&&(_=u.elevationSampler.constantElevation(u.elevation,u.bias),_!=null&&(h=_,g=_));const b=(T,E,A)=>{if(u!=null)if(E.push(T),_!=null)o.elevatedLayoutVertexArray.emplaceBack(_),A.push(_);else{const R=u.elevationSampler.pointElevation(T,u.elevation,u.bias);o.elevatedLayoutVertexArray.emplaceBack(R),A.push(R),h=Math.min(h,R),g=Math.max(g,R)}};for(const T of r){let E=0;for(const re of T)E+=re.length;const A=o.triangleSegments.prepareSegment(E,o.layoutVertexArray,o.indexArray),R=A.vertexLength,M=[],F=[],B=[],W=[],q=[],K=o.layoutVertexArray.length;for(const re of T){if(re.length===0)continue;re!==T[0]&&F.push(M.length/2);const oe=o.lineSegments.prepareSegment(re.length,o.layoutVertexArray,o.lineIndexArray),ye=oe.vertexLength;u&&q.push(o.layoutVertexArray.length-K),b(re[0],B,W),o.layoutVertexArray.emplaceBack(re[0].x,re[0].y),o.lineIndexArray.emplaceBack(ye+re.length-1,ye),M.push(re[0].x),M.push(re[0].y);for(let ve=1;ve<re.length;ve++)b(re[ve],B,W),o.layoutVertexArray.emplaceBack(re[ve].x,re[ve].y),o.lineIndexArray.emplaceBack(ye+ve-1,ye+ve),M.push(re[ve].x),M.push(re[ve].y);oe.vertexLength+=re.length,oe.primitiveLength+=re.length}const ne=zm(M,F);for(let re=0;re<ne.length;re+=3)o.indexArray.emplaceBack(R+ne[re],R+ne[re+1],R+ne[re+2]);if(ne.length>0&&u&&this.elevationMode==="hd-road-base"){const re=u.elevation.isTunnel(),oe=u.elevation.safeArea,ye=this.elevatedStructures.addVertices(B,W);this.elevatedStructures.addTriangles(ne,ye,re);const ve=q.length;if(ve>0){for(let Ce=0;Ce<ve-1;Ce++)this.elevatedStructures.addRenderableRing(u.index,q[Ce]+ye,q[Ce+1]-q[Ce],re,oe,u.featureInfo);this.elevatedStructures.addRenderableRing(u.index,q[ve-1]+ye,B.length-q[ve-1],re,oe,u.featureInfo)}}A.vertexLength+=E,A.primitiveLength+=ne.length/3}return[h,g]}prepareElevatedPolygons(r,o,u){const h=1/We(u),g=[];for(const _ of r){const b=O8(_,new qr(o,h));g.push(...b)}return g}clipPolygonsToTile(r,o){const u=-o,h=-o,g=zt+o,_=zt+o;let b=0;const T=[],E=[];for(;b<r.length;b++){const M=r[b],F=Vp(M);(F.min.x>=u&&F.max.x<=g&&F.min.y>=h&&F.max.y<=_?T:E).push(M)}if(T.length===r.length)return r;const A=[new xt(u,h),new xt(g,h),new xt(g,_),new xt(u,_),new xt(u,h)],R=T;for(const M of E)R.push(...k8(M,A));return R}}let lR,cR,uR,dR;Wt(jS,"FillBucket",{omit:["layers","patternFeatures"]}),Wt(US,"FillBufferData"),Wt(xa,"ElevatedStructures");class g1{constructor(r,o,u,h){if(this.triangleCount=o.length/3,this.min=new xt(0,0),this.max=new xt(0,0),this.xScale=0,this.yScale=0,this.cellsX=0,this.cellsY=0,this.cells=[],this.payload=[],this.triangleCount===0||r.length===0)return;const[g,_]=[r[0].clone(),r[0].clone()];for(let R=1;R<r.length;++R){const M=r[R];g.x=Math.min(g.x,M.x),g.y=Math.min(g.y,M.y),_.x=Math.max(_.x,M.x),_.y=Math.max(_.y,M.y)}if(h){const R=Math.ceil(Math.max(_.x-g.x,_.y-g.y)/h);u=Math.max(u,R)}if(u===0)return;this.min=g,this.max=_;const b=this.max.sub(this.min);b.x=Math.max(b.x,1),b.y=Math.max(b.y,1);const T=Math.max(b.x,b.y)/u;this.cellsX=Math.max(1,Math.ceil(b.x/T)),this.cellsY=Math.max(1,Math.ceil(b.y/T)),this.xScale=1/T,this.yScale=1/T;const E=[];for(let R=0;R<this.triangleCount;R++){const M=r[o[3*R+0]].sub(this.min),F=r[o[3*R+1]].sub(this.min),B=r[o[3*R+2]].sub(this.min),W=qc(Math.floor(Math.min(M.x,F.x,B.x)),this.xScale,this.cellsX),q=qc(Math.floor(Math.max(M.x,F.x,B.x)),this.xScale,this.cellsX),K=qc(Math.floor(Math.min(M.y,F.y,B.y)),this.yScale,this.cellsY),ne=qc(Math.floor(Math.max(M.y,F.y,B.y)),this.yScale,this.cellsY),re=new xt(0,0),oe=new xt(0,0),ye=new xt(0,0),ve=new xt(0,0);for(let Ce=K;Ce<=ne;++Ce){re.y=oe.y=Ce*T,ye.y=ve.y=(Ce+1)*T;for(let Oe=W;Oe<=q;++Oe)re.x=ye.x=Oe*T,oe.x=ve.x=(Oe+1)*T,(tc(M,F,B,re,oe,ve)||tc(M,F,B,re,ve,ye))&&E.push({cellIdx:Ce*this.cellsX+Oe,triIdx:R})}}if(E.length===0)return;E.sort(((R,M)=>R.cellIdx-M.cellIdx||R.triIdx-M.triIdx));let A=0;for(;A<E.length;){const R=E[A].cellIdx,M={start:this.payload.length,len:0};for(;A<E.length&&E[A].cellIdx===R;)++M.len,this.payload.push(E[A++].triIdx);this.cells[R]=M}}_lazyInitLookup(){this.lookup||(this.lookup=new Uint8Array(Math.ceil(this.triangleCount/8))),this.lookup.fill(0)}queryPoint(r,o){if(this.triangleCount===0||this.cells.length===0||r.x>this.max.x||this.min.x>r.x||r.y>this.max.y||this.min.y>r.y)return;const u=qc(r.x-this.min.x,this.xScale,this.cellsX),h=qc(r.y-this.min.y,this.yScale,this.cellsY),g=this.cells[h*this.cellsX+u];if(g){this._lazyInitLookup();for(let _=0;_<g.len;_++){const b=this.payload[g.start+_],T=Math.floor(b/8),E=1<<b%8;if(!(this.lookup[T]&E)&&(this.lookup[T]|=E,o.push(b),o.length===this.triangleCount))return}}}query(r,o,u){if(this.triangleCount===0||this.cells.length===0||r.x>this.max.x||this.min.x>o.x||r.y>this.max.y||this.min.y>o.y)return;this._lazyInitLookup();const h=qc(r.x-this.min.x,this.xScale,this.cellsX),g=qc(o.x-this.min.x,this.xScale,this.cellsX),_=qc(r.y-this.min.y,this.yScale,this.cellsY),b=qc(o.y-this.min.y,this.yScale,this.cellsY);for(let T=_;T<=b;T++)for(let E=h;E<=g;E++){const A=this.cells[T*this.cellsX+E];if(A)for(let R=0;R<A.len;R++){const M=this.payload[A.start+R],F=Math.floor(M/8),B=1<<M%8;if(!(this.lookup[F]&B)&&(this.lookup[F]|=B,u.push(M),u.length===this.triangleCount))return}}}}function qc(a,r,o){return Math.max(0,Math.min(o-1,Math.floor(a*r)))}Wt(g1,"TriangleGridIndex");class hR{constructor(r){this.zoom=r.zoom,this.layers=r.layers,this.layerIds=this.layers.map((o=>o.fqid)),this.index=r.index,this.hasPattern=!1,this.stateDependentLayerIds=this.layers.filter((o=>o.isStateDependent())).map((o=>o.id)),this.footprints=[],this.worldview=r.worldview}updateFootprints(r,o){for(const u of this.footprints)o.push({footprint:u,id:r})}populate(r,o,u,h){const g=[];for(const{feature:_,id:b,index:T,sourceLayerIndex:E}of r){const A=this.layers[0]._featureFilter.needGeometry,R=St(_,A);if(!this.layers[0]._featureFilter.filter(new pi(this.zoom,{worldview:this.worldview}),R,u))continue;const M={id:b,properties:_.properties,type:_.type,sourceLayerIndex:E,index:T,geometry:A?R.geometry:Ut(_,u,h),patterns:{}};g.push(M)}for(const _ of g){const{geometry:b,index:T,sourceLayerIndex:E}=_;this.addFeature(_,b,T,u,{},o.availableImages,o.brightness),o.featureIndex.insert(r[T].feature,b,T,E,this.index)}}isEmpty(){return this.footprints.length===0}uploadPending(){return!1}upload(r){}update(r,o,u,h,g,_,b){}destroy(){}addFeature(r,o,u,h,g,_=[],b){for(const T of gy(o,2)){const E=[],A=[],R=[],M=new xt(1/0,1/0),F=new xt(-1/0,-1/0);for(const q of T)if(q.length!==0){q!==T[0]&&R.push(A.length/2);for(let K=0;K<q.length;K++)A.push(q[K].x),A.push(q[K].y),E.push(q[K]),M.x=Math.min(M.x,q[K].x),M.y=Math.min(M.y,q[K].y),F.x=Math.max(F.x,q[K].x),F.y=Math.max(F.y,q[K].y)}const B=zm(A,R),W=new g1(E,B,8,256);this.footprints.push({vertices:E,indices:B,grid:W,min:M,max:F})}}}Wt(hR,"ClipBucket",{omit:["layers"]});const M8=gr([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),D8=gr([{name:"a_pos_end",components:4,type:"Int16"},{name:"a_angular_offset_factor",components:1,type:"Int16"}]),L8=gr([{name:"a_centroid_pos",components:2,type:"Uint16"}]),z8=gr([{name:"a_join_normal_inside",components:3,type:"Int16"}]),F8=gr([{name:"a_hidden_by_landmark",components:1,type:"Uint8"}]),B8=gr([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:N8}=M8,_y=Number.MAX_SAFE_INTEGER,fR=_y-1;function pR(a,r,o,u){return a.order<r||a.order===_y||!(a.clipMask&o)||(function(h,g){return g.length!==0&&g.find((_=>_===h))===void 0})(u,a.clipScope)}function _1(a,r){return a.x-r.x||a.y-r.y}function mR(a,r){return _1(a.min,r.min)===0&&_1(a.max,r.max)===0}function GS(a,r){return!(a.min.x>r.max.x||a.max.x<r.min.x||a.min.y>r.max.y||a.max.y<r.min.y)}function y1(a,r){if(a.length!==r.length)return!1;for(let o=0;o<a.length;o++)if(a[o].sourceId!==r[o].sourceId||!mR(a[o],r[o])||a[o].order!==r[o].order||a[o].clipMask!==r[o].clipMask||!Da(a[o].clipScope,r[o].clipScope))return!1;return!0}function gR(a,r,o){const u=1/zt,h=1/(1<<o.canonical.z),g=(r.x*u+o.canonical.x)*h+o.wrap,_=(r.y*u+o.canonical.y)*h;return{min:new xt((a.x*u+o.canonical.x)*h+o.wrap,(a.y*u+o.canonical.y)*h),max:new xt(g,_)}}function V8(a,r,o){const u=1<<o.canonical.z,h=((r.x-o.wrap)*u-o.canonical.x)*zt,g=(r.y*u-o.canonical.y)*zt;return{min:new xt(((a.x-o.wrap)*u-o.canonical.x)*zt,(a.y*u-o.canonical.y)*zt),max:new xt(h,g)}}function HS(a,r,o,u,h,g,_){const b=a.indices,T=a.vertices,E=[];for(let A=u;A<u+h;A+=3){const R=r[o[A+0]+g],M=r[o[A+1]+g],F=r[o[A+2]+g],B=Math.min(R.x,M.x,F.x),W=Math.max(R.x,M.x,F.x),q=Math.min(R.y,M.y,F.y),K=Math.max(R.y,M.y,F.y);E.length=0,a.grid.query(new xt(B,q),new xt(W,K),E);for(let ne=0;ne<E.length;ne++){const re=E[ne];if(tc(T[b[3*re+0]],T[b[3*re+1]],T[b[3*re+2]],R,M,F,_))return!0}}return!1}function _R(a,r,o,u){if(!a||!o)return!1;let h=a.vertices;if(!r.canonical.equals(u.canonical)||r.wrap!==u.wrap){if(o.vertices.length<a.vertices.length)return _R(o,u,a,r);const g=r.canonical,_=u.canonical,b=Math.pow(2,_.z-g.z);h=a.vertices.map((T=>new xt((T.x+g.x*zt)*b-_.x*zt,(T.y+g.y*zt)*b-_.y*zt)))}return HS(o,h,a.indices,0,a.indices.length,0,0)}function yR(a,r,o,u){const h=Math.pow(2,u.z-o.z);return new xt((a+o.x*zt)*h-u.x*zt,(r+o.y*zt)*h-u.y*zt)}function WS(a,r){const o=[];r.grid.queryPoint(a,o);const u=r.indices,h=r.vertices;for(let g=0;g<o.length;g++){const _=o[g];if($o([h[u[3*_+0]],h[u[3*_+1]],h[u[3*_+2]]],a))return!0}return!1}const qS=[new xt(0,0),new xt(zt,0),new xt(zt,zt),new xt(0,zt)];function vR(a,r){const o=[];let u=[];if(!r||a.length<2)return[a];if(a.length===2)return ns(a[0],a[1],qS)?[a]:[];for(let h=0;h<a.length+2;h++){const g=a[h%a.length],_=a[(h+1)%a.length],b=ns(h===0?a[a.length-1]:a[(h-1)%a.length],g,qS),T=ns(g,_,qS),E=b||T;E&&u.push(g),E&&T||u.length>0&&(u.length>1&&o.push(u),u=[])}return u.length>1&&o.push(u),o}const KS=bt.types,$8=["fill-extrusion-base","fill-extrusion-height","fill-extrusion-color","fill-extrusion-pattern","fill-extrusion-flood-light-wall-radius","fill-extrusion-line-width","fill-extrusion-emissive-strength"],U8=["fill-extrusion-flood-light-ground-radius"],j8=Math.pow(2,13),G8=Math.pow(2,15)-1,bR=new xt(0,1),dh=2147483648;function yy(a,r,o,u,h,g,_,b){a.emplaceBack((r<<1)+_,(o<<1)+g,(Math.floor(u*j8)<<1)+h,Math.round(b))}function vy(a,r,o){a.emplaceBack(r.x*zt,r.y*zt,o?1:0)}function v1(a,r,o,u,h,g){a.emplaceBack(r.x,r.y,(o.x<<1)+u,(o.y<<1)+h,g)}function by(a,r,o){a.emplaceBack(r.x,r.y,r.z,o[0]*16384,o[1]*16384,o[2]*16384)}class xR{constructor(){this.vertexOffset=0,this.vertexCount=0,this.indexOffset=0,this.indexCount=0}}class wR{constructor(){this.centroidXY=new xt(0,0),this.vertexArrayOffset=0,this.vertexCount=0,this.groundVertexArrayOffset=0,this.groundVertexCount=0,this.flags=0,this.footprintSegIdx=-1,this.footprintSegLen=0,this.polygonSegIdx=-1,this.polygonSegLen=0,this.min=new xt(Number.MAX_VALUE,Number.MAX_VALUE),this.max=new xt(-Number.MAX_VALUE,-Number.MAX_VALUE),this.height=0,this.buildingId=0}span(){return new xt(this.max.x-this.min.x,this.max.y-this.min.y)}}class TR{constructor(){this.acc=new xt(0,0),this.accCount=0,this.centroidDataIndex=0}startRing(r,o){r.min.x===Number.MAX_VALUE&&(r.min.x=r.max.x=o.x,r.min.y=r.max.y=o.y)}appendEdge(r,o,u){this.accCount++,this.acc._add(o);let h=!!this.borders;o.x<r.min.x?(r.min.x=o.x,h=!0):o.x>r.max.x&&(r.max.x=o.x,h=!0),o.y<r.min.y?(r.min.y=o.y,h=!0):o.y>r.max.y&&(r.max.y=o.y,h=!0),((o.x===0||o.x===zt)&&o.x===u.x)!=((o.y===0||o.y===zt)&&o.y===u.y)&&this.processBorderOverlap(o,u),h&&this.checkBorderIntersection(o,u)}checkBorderIntersection(r,o){o.x<0!=r.x<0&&this.addBorderIntersection(0,wn(o.y,r.y,(0-o.x)/(r.x-o.x))),o.x>zt!=r.x>zt&&this.addBorderIntersection(1,wn(o.y,r.y,(zt-o.x)/(r.x-o.x))),o.y<0!=r.y<0&&this.addBorderIntersection(2,wn(o.x,r.x,(0-o.y)/(r.y-o.y))),o.y>zt!=r.y>zt&&this.addBorderIntersection(3,wn(o.x,r.x,(zt-o.y)/(r.y-o.y)))}addBorderIntersection(r,o){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const u=this.borders[r];o<u[0]&&(u[0]=o),o>u[1]&&(u[1]=o)}processBorderOverlap(r,o){if(r.x===o.x){if(r.y===o.y)return;const u=r.x===0?0:1;this.addBorderIntersection(u,o.y),this.addBorderIntersection(u,r.y)}else{const u=r.y===0?2:3;this.addBorderIntersection(u,o.x),this.addBorderIntersection(u,r.x)}}centroid(){return this.accCount===0?new xt(0,0):new xt(Math.floor(Math.max(0,this.acc.x)/this.accCount),Math.floor(Math.max(0,this.acc.y)/this.accCount))}intersectsCount(){return this.borders?this.borders.reduce(((r,o)=>r+ +(o[0]!==Number.MAX_VALUE)),0):0}}function SR(a,r){const o=a.add(r)._unit(),u=be(a.x*o.x+a.y*o.y,-1,1);var h,g,_;return h=Math.acos(u),Math.min(4,Math.max(-4,Math.tan(h)))/4*G8*((g=a).x*(_=r).y-g.y*_.x<0?-1:1)}const H8=[a=>a.x<0,a=>a.x>zt,a=>a.y<0,a=>a.y>zt];function W8(a,r,o,u){const h=[4];if(u===0)return h;o._mult(u);const g=a.sub(o),_=r.sub(o),b=[a,r,g,_];for(let T=0;T<4;T++)for(const E of b)if(H8[T](E)){h.push(T);break}return h}class ZS{constructor(r){this.vertexArray=new J_,this.indexArray=new Mo,this.programConfigurations=new tl(r.layers,{zoom:r.zoom,lut:r.lut},(o=>U8.includes(o))),this._segments=new Bi,this.hiddenByLandmarkVertexArray=new Rm,this._segmentToGroundQuads={},this._segmentToGroundQuads[0]=[],this._segmentToRegionTriCounts={},this._segmentToRegionTriCounts[0]=[0,0,0,0,0],this.regionSegments={},this.regionSegments[4]=new Bi}getDefaultSegment(){return this.regionSegments[4]}hasData(){return this.vertexArray.length!==0}addData(r,o,u,h=!1){const g=r.length;if(g>2){let _=Math.max(0,this._segments.get().length-1);const b=this._segments._prepareSegment(4*g,this.vertexArray.length,2*this._segmentToGroundQuads[_].length);let T;_!==this._segments.get().length-1&&(_++,this._segmentToGroundQuads[_]=[],this._segmentToRegionTriCounts[_]=[0,0,0,0,0]);{const E=r[0],A=r[1];T=SR(E.sub(r[g-1])._perp()._unit(),A.sub(E)._perp()._unit())}for(let E=0;E<g;E++){const A=E===g-1?0:E+1,R=r[E],M=r[A],F=r[A===g-1?0:A+1],B=M.sub(R)._perp()._unit(),W=SR(B,F.sub(M)._perp()._unit()),q=T,K=W;if(XS(R,M,o)||h&&IR(R,o)&&IR(M,o)){T=W;continue}const ne=b.vertexLength;v1(this.vertexArray,R,M,1,1,q),v1(this.vertexArray,R,M,1,0,q),v1(this.vertexArray,R,M,0,1,K),v1(this.vertexArray,R,M,0,0,K),b.vertexLength+=4;const re=W8(R,M,B,u);for(const oe of re)this._segmentToGroundQuads[_].push({id:ne,region:oe}),this._segmentToRegionTriCounts[_][oe]+=2,b.primitiveLength+=2;T=W}}}prepareBorderSegments(){if(!this.hasData())return;const r=this._segments.get(),o=r.length;for(let u=0;u<o;u++)this._segmentToGroundQuads[u].sort(((h,g)=>h.region-g.region));for(let u=0;u<o;u++){const h=this._segmentToGroundQuads[u],g=r[u],_=this._segmentToRegionTriCounts[u];_.reduce(((T,E)=>T+E),0);let b=0;for(let T=0;T<=4;T++){const E=_[T];if(E!==0){let A=this.regionSegments[T];A||(A=this.regionSegments[T]=new Bi);const R={vertexOffset:g.vertexOffset,primitiveOffset:g.primitiveOffset+b,vertexLength:g.vertexLength,primitiveLength:E};A.get().push(R)}b+=E}for(let T=0;T<h.length;T++){const E=h[T].id;this.indexArray.emplaceBack(E,E+1,E+3),this.indexArray.emplaceBack(E,E+3,E+2)}}this._segmentToGroundQuads=null,this._segmentToRegionTriCounts=null,this._segments.destroy(),this._segments=null}addPaintPropertiesData(r,o,u,h,g,_,b){this.hasData()&&this.programConfigurations.populatePaintArrays(this.vertexArray.length,r,o,u,h,g,_,void 0,b)}upload(r){this.hasData()&&(this.vertexBuffer=r.createVertexBuffer(this.vertexArray,D8.members),this.indexBuffer=r.createIndexBuffer(this.indexArray))}uploadPaintProperties(r){this.hasData()&&this.programConfigurations.upload(r)}update(r,o,u,h,g,_,b,T){this.hasData()&&this.programConfigurations.updatePaintArrays(r,o,u,h,g,_,b,T)}updateHiddenByLandmark(r){this.updateHiddenByLandmarkRange(r.groundVertexArrayOffset,r.groundVertexCount,!!(r.flags&dh))}updateHiddenByLandmarkRange(r,o,u){if(!this.hasData())return;const h=o+r;if(o!==0){for(let g=r;g<h;++g)this.hiddenByLandmarkVertexArray.emplace(g,u?1:0);this._needsHiddenByLandmarkUpdate=!0}}uploadHiddenByLandmark(r){this.hasData()&&this._needsHiddenByLandmarkUpdate&&(!this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexArray.length>0?this.hiddenByLandmarkVertexBuffer=r.createVertexBuffer(this.hiddenByLandmarkVertexArray,F8.members,!0):this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.updateData(this.hiddenByLandmarkVertexArray),this._needsHiddenByLandmarkUpdate=!1)}destroy(){if(this.vertexBuffer){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.destroy(),this._segments&&this._segments.destroy(),this.programConfigurations.destroy();for(let r=0;r<=4;r++){const o=this.regionSegments[r];o&&o.destroy()}}}}class b1{constructor(r){this.zoom=r.zoom,this.canonical=r.canonical,this.overscaling=r.overscaling,this.layers=r.layers,this.pixelRatio=r.pixelRatio,this.layerIds=this.layers.map((o=>o.fqid)),this.index=r.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=r.projection,this.activeReplacements=[],this.replacementUpdateTime=0,this.centroidData=[],this.footprintIndices=new Mo,this.footprintVertices=new Vc,this.footprintSegments=[],this.layoutVertexArray=new Xu,this.centroidVertexArray=new r1,this.wallVertexArray=new o1,this.indexArray=new Mo,this.programConfigurations=new tl(r.layers,{zoom:r.zoom,lut:r.lut},(o=>$8.includes(o))),this.segments=new Bi,this.stateDependentLayerIds=this.layers.filter((o=>o.isStateDependent())).map((o=>o.id)),this.groundEffect=new ZS(r),this.maxHeight=0,this.partLookup={},this.triangleSubSegments=[],this.polygonSegments=[],this.worldview=r.worldview}updateFootprints(r,o){}populate(r,o,u,h){this.features=[],this.hasPattern=NS("fill-extrusion",this.layers,this.pixelRatio,o),this.featuresOnBorder=[],this.borderFeatureIndices=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.selfDEMTileTimestamp=Number.MAX_VALUE,this.borderDEMTileTimestamp=[Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE],this.tileToMeter=We(u),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter,this.wallMode=this.layers[0].paint.get("fill-extrusion-line-width").constantOr(1)!==0;for(const{feature:g,id:_,index:b,sourceLayerIndex:T}of r){const E=this.layers[0]._featureFilter.needGeometry,A=St(g,E);if(!this.layers[0]._featureFilter.filter(new pi(this.zoom,{worldview:this.worldview}),A,u))continue;const R={id:_,sourceLayerIndex:T,index:b,geometry:E?A.geometry:Ut(g,u,h),properties:g.properties,type:g.type,patterns:{}},M=this.layoutVertexArray.length,F=KS[R.type]==="Polygon";if(this.hasPattern)this.features.push({featureId:g.id,feature:VS("fill-extrusion",this.layers,R,this.zoom,this.pixelRatio,o)});else if(this.wallMode)for(const B of R.geometry)for(const W of vR(B,F))this.addFeature(g.id,R,[W],b,u,{},o.availableImages,h,o.brightness);else this.addFeature(g.id,R,R.geometry,b,u,{},o.availableImages,h,o.brightness);o.featureIndex.insert(g,R.geometry,b,T,this.index,M)}this.sortBorders(),this.projection.name==="mercator"&&this.splitToSubtiles(),this.groundEffect.prepareBorderSegments(),this.polygonSegments.length=0}addFeatures(r,o,u,h,g,_){for(const{featureId:b,feature:T}of this.features){const E=KS[T.type]==="Polygon",{geometry:A}=T;if(this.wallMode)for(const R of A)for(const M of vR(R,E))this.addFeature(b,T,[M],T.index,o,u,h,g,_);else this.addFeature(b,T,A,T.index,o,u,h,g,_)}this.sortBorders(),this.projection.name==="mercator"&&this.splitToSubtiles()}update(r,o,u,h,g,_,b){this.programConfigurations.updatePaintArrays(r,o,g,u,h,_,b,this.worldview),this.groundEffect.update(r,o,g,u,h,_,b,this.worldview)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload||this.groundEffect.programConfigurations.needsUpload}upload(r){this.uploaded||(this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,N8),this.indexBuffer=r.createIndexBuffer(this.indexArray),this.wallVertexBuffer=r.createVertexBuffer(this.wallVertexArray,z8.members),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=r.createVertexBuffer(this.layoutVertexExtArray,B8.members,!0)),this.groundEffect.upload(r)),this.groundEffect.uploadPaintProperties(r),this.programConfigurations.upload(r),this.uploaded=!0}uploadCentroid(r){this.groundEffect.uploadHiddenByLandmark(r),this.needsCentroidUpdate&&(!this.centroidVertexBuffer&&this.centroidVertexArray.length>0?this.centroidVertexBuffer=r.createVertexBuffer(this.centroidVertexArray,L8.members,!0):this.centroidVertexBuffer&&this.centroidVertexBuffer.updateData(this.centroidVertexArray),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.groundEffect.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(r,o,u,h,g,_,b,T,E){const A=this.layers[0].paint.get("fill-extrusion-flood-light-ground-radius").evaluate(o,{})/this.tileToMeter,R=[new xt(0,0),new xt(zt,zt)],M=T.projection,F=M.name==="globe",B=this.wallMode||KS[o.type]==="Polygon",W=new TR;W.centroidDataIndex=this.centroidData.length;const q=new wR;q.buildingId=r,o.properties&&o.properties.hasOwnProperty("building_id")&&(q.buildingId=o.properties.building_id);const K=this.layers[0].paint.get("fill-extrusion-base").evaluate(o,{},g)<=0,ne=this.layers[0].paint.get("fill-extrusion-height").evaluate(o,{},g);let re;if(q.height=ne,q.vertexArrayOffset=this.layoutVertexArray.length,q.groundVertexArrayOffset=this.groundEffect.vertexArray.length,F&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new Em),this.wallMode){if(F)return void cr("Non zero fill-extrusion-line-width is not yet supported on globe.");if(u.length!==1)return;re=(function(Ue){const ht=Ue[0].x===Ue[Ue.length-1].x&&Ue[0].y===Ue[Ue.length-1].y;(function(Dt){let dn=0;const Fn=Dt.length;for(let Vt=0;Vt<Fn;Vt++)dn+=(Dt[(Vt+1)%Fn].x-Dt[Vt].x)*(Dt[(Vt+1)%Fn].y+Dt[Vt].y);return dn>=0})(Ue)||(Ue=Ue.reverse());const mt={geometry:[],joinNormals:[],indices:[]},yt=[],Et=[],lt=[];let vt=Ue.length;for(;vt>=2&&Ue[vt-1].equals(Ue[vt-2]);)vt--;if(vt<(ht?3:2))return mt;let rt,Xe,Ct,Tt,hn,Ht=0;for(;Ht<vt-1&&Ue[Ht].equals(Ue[Ht+1]);)Ht++;ht&&(rt=Ue[vt-2],hn=Ue[Ht].sub(rt)._unit()._perp());for(let Dt=Ht;Dt<vt;Dt++){if(Ct=Dt===vt-1?ht?Ue[Ht+1]:void 0:Ue[Dt+1],Ct&&Ue[Dt].equals(Ct))continue;hn&&(Tt=hn),rt&&(Xe=rt),rt=Ue[Dt],hn=Ct?Ct.sub(rt)._unit()._perp():Tt,Tt=Tt||hn;let dn=Tt.add(hn);dn.x===0&&dn.y===0||dn._unit();const Fn=dn.x*hn.x+dn.y*hn.y,Vt=Fn!==0?1/Fn:1/0,tn=Tt.x*hn.y-Tt.y*hn.x>0;let An="miter";const Nn=2;An==="miter"&&Vt>Nn&&(An="bevel"),An==="bevel"&&(Vt>100&&(An="flipbevel"),Vt<Nn&&(An="miter"));const er=(Un,Xt,Vn,br)=>{const ae=new xt(Un.x,Un.y),le=new xt(Un.x,Un.y);ae.x+=Xt.x*br,ae.y+=Xt.y*br,le.x-=Xt.x*Math.max(Vn,1),le.y-=Xt.y*Math.max(Vn,1),lt.push(Xt),yt.push(ae),Et.push(le)};if(An==="miter")dn._mult(Vt),er(rt,dn,0,0);else if(An==="flipbevel")dn=hn.mult(-1),er(rt,dn,0,0),er(rt,dn.mult(-1),0,0);else{const Un=-Math.sqrt(Vt*Vt-1),Xt=tn?Un:0,Vn=tn?0:Un;Xe&&er(rt,Tt,Xt,Vn),Ct&&er(rt,hn,Xt,Vn)}}mt.geometry=[...yt,...Et.reverse(),yt[0]],mt.joinNormals=[...lt,...lt.reverse(),lt[lt.length-1]];const Jt=mt.geometry.length-1;for(let Dt=0;Dt<Jt/2;Dt++)if(Dt+1<Jt/2){let dn=Dt,Fn=Dt+1,Vt=Jt-1-Dt,tn=Jt-2-Dt;dn=dn===0?Jt-1:dn-1,Fn=Fn===0?Jt-1:Fn-1,Vt=Vt===0?Jt-1:Vt-1,tn=tn===0?Jt-1:tn-1,mt.indices.push(Vt),mt.indices.push(Fn),mt.indices.push(dn),mt.indices.push(Vt),mt.indices.push(tn),mt.indices.push(Fn)}return mt})(u[0]),u=[re.geometry]}const oe=(Ue,ht)=>Ue<(ht.length-1)/2||Ue===ht.length-1,ye=this.wallMode?[u]:gy(u,500);for(let Ue=ye.length-1;Ue>=0;Ue--){const ht=ye[Ue];(ht.length===0||(ve=ht[0]).every((wt=>wt.x<=0))||ve.every((wt=>wt.x>=zt))||ve.every((wt=>wt.y<=0))||ve.every((wt=>wt.y>=zt)))&&ye.splice(Ue,1)}var ve;let Ce;if(F)Ce=kR(ye,R,g);else{Ce=[];for(const Ue of ye)Ce.push({polygon:Ue,bounds:R})}const Oe=B?this.edgeRadius:0,De=Oe>0&&this.zoom<17,ut=(Ue,ht)=>{if(Ue.length===0)return!1;const wt=Ue[Ue.length-1];return ht.x===wt.x&&ht.y===wt.y};for(const{polygon:Ue,bounds:ht}of Ce){let wt=0,mt=0;for(const vt of Ue)B&&!vt[0].equals(vt[vt.length-1])&&vt.push(vt[0]),mt+=B?vt.length-1:vt.length;const yt=this.segments.prepareSegment((B?5:4)*mt,this.layoutVertexArray,this.indexArray);q.footprintSegIdx<0&&(q.footprintSegIdx=this.footprintSegments.length),q.polygonSegIdx<0&&(q.polygonSegIdx=this.polygonSegments.length);const Et={triangleArrayOffset:this.indexArray.length,triangleCount:0,triangleSegIdx:this.segments.segments.length-1},lt=new xR;if(lt.vertexOffset=this.footprintVertices.length,lt.indexOffset=3*this.footprintIndices.length,lt.ringIndices=[],B){const vt=[],rt=[];wt=yt.vertexLength;for(let Ct=0;Ct<Ue.length;Ct++){const Tt=Ue[Ct];Tt.length&&Ct!==0&&rt.push(vt.length/2);const hn=[];let Ht,Jt;Ht=Tt[1].sub(Tt[0])._perp()._unit(),lt.ringIndices.push(Tt.length-1);for(let Dt=1;Dt<Tt.length;Dt++){const dn=Tt[Dt],Fn=Tt[Dt===Tt.length-1?1:Dt+1],Vt=dn.clone();if(Oe){Jt=Fn.sub(dn)._perp()._unit();const tn=Ht.add(Jt)._unit(),An=Oe*Math.min(4,1/(Ht.x*tn.x+Ht.y*tn.y));Vt.x+=An*tn.x,Vt.y+=An*tn.y,Vt.x=Math.round(Vt.x),Vt.y=Math.round(Vt.y),Ht=Jt}if(!K||Oe!==0&&!De||ut(hn,Vt)||hn.push(Vt),yy(this.layoutVertexArray,Vt.x,Vt.y,0,0,1,1,0),this.wallMode){const tn=oe(Dt,Tt);vy(this.wallVertexArray,re.joinNormals[Dt],!tn)}yt.vertexLength++,this.footprintVertices.emplaceBack(dn.x,dn.y),vt.push(dn.x,dn.y),F&&by(this.layoutVertexExtArray,M.projectTilePoint(Vt.x,Vt.y,g),M.upVector(g,Vt.x,Vt.y))}K&&(Oe===0||De)&&(hn.length!==0&&ut(hn,hn[0])&&hn.pop(),this.groundEffect.addData(hn,ht,A))}const Xe=this.wallMode?re.indices:zm(vt,rt);for(let Ct=0;Ct<Xe.length;Ct+=3)this.footprintIndices.emplaceBack(lt.vertexOffset+Xe[Ct+0],lt.vertexOffset+Xe[Ct+1],lt.vertexOffset+Xe[Ct+2]),this.indexArray.emplaceBack(wt+Xe[Ct],wt+Xe[Ct+2],wt+Xe[Ct+1]),yt.primitiveLength++;lt.indexCount+=Xe.length,lt.vertexCount+=this.footprintVertices.length-lt.vertexOffset}for(let vt=0;vt<Ue.length;vt++){const rt=Ue[vt];W.startRing(q,rt[0]);let Xe=rt.length>4&&AR(rt[rt.length-2],rt[0],rt[1]),Ct=Oe?q8(rt[rt.length-2],rt[0],rt[1],Oe):0;const Tt=[];let hn,Ht,Jt;Ht=rt[1].sub(rt[0])._perp()._unit();let Dt=!0;for(let dn=1,Fn=0;dn<rt.length;dn++){let Vt=rt[dn-1],tn=rt[dn];const An=rt[dn===rt.length-1?1:dn+1];if(W.appendEdge(q,tn,Vt),XS(tn,Vt,ht)){Oe&&(Ht=An.sub(tn)._perp()._unit(),Dt=!Dt);continue}const Nn=tn.sub(Vt)._perp(),er=Nn.x/(Math.abs(Nn.x)+Math.abs(Nn.y)),Un=Nn.y>0?1:0,Xt=Vt.dist(tn);if(Fn+Xt>32768&&(Fn=0),Oe){Jt=An.sub(tn)._perp()._unit();let le=CR(Vt,tn,An,ER(Ht,Jt),Oe);isNaN(le)&&(le=0);const et=tn.sub(Vt)._unit();Vt=Vt.add(et.mult(Ct))._round(),tn=tn.add(et.mult(-le))._round(),Ct=le,Ht=Jt,K&&this.zoom>=17&&(ut(Tt,Vt)||Tt.push(Vt),ut(Tt,tn)||Tt.push(tn))}const Vn=yt.vertexLength,br=rt.length>4&&AR(Vt,tn,An);let ae=PR(Fn,Xe,Dt);if(yy(this.layoutVertexArray,Vt.x,Vt.y,er,Un,0,0,ae),yy(this.layoutVertexArray,Vt.x,Vt.y,er,Un,0,1,ae),this.wallMode){const le=oe(dn-1,rt),et=re.joinNormals[dn-1];vy(this.wallVertexArray,et,le),vy(this.wallVertexArray,et,le)}if(Fn+=Xt,ae=PR(Fn,br,!Dt),Xe=br,yy(this.layoutVertexArray,tn.x,tn.y,er,Un,0,0,ae),yy(this.layoutVertexArray,tn.x,tn.y,er,Un,0,1,ae),this.wallMode){const le=oe(dn,rt),et=re.joinNormals[dn];vy(this.wallVertexArray,et,le),vy(this.wallVertexArray,et,le)}if(yt.vertexLength+=4,this.indexArray.emplaceBack(Vn+0,Vn+1,Vn+2),this.indexArray.emplaceBack(Vn+1,Vn+3,Vn+2),yt.primitiveLength+=2,Oe){const le=wt+(dn===1?rt.length-2:dn-2),et=dn===1?wt:le+1;if(this.indexArray.emplaceBack(Vn+1,le,Vn+3),this.indexArray.emplaceBack(le,et,Vn+3),yt.primitiveLength+=2,hn===void 0&&(hn=Vn),!XS(An,rt[dn],ht)){const ct=dn===rt.length-1?hn:yt.vertexLength;this.indexArray.emplaceBack(Vn+2,Vn+3,ct),this.indexArray.emplaceBack(Vn+3,ct+1,ct),this.indexArray.emplaceBack(Vn+3,et,ct+1),yt.primitiveLength+=3}Dt=!Dt}if(F){const le=this.layoutVertexExtArray,et=M.projectTilePoint(Vt.x,Vt.y,g),ct=M.projectTilePoint(tn.x,tn.y,g),Nt=M.upVector(g,Vt.x,Vt.y),Bt=M.upVector(g,tn.x,tn.y);by(le,et,Nt),by(le,et,Nt),by(le,ct,Bt),by(le,ct,Bt)}}B&&(wt+=rt.length-1),K&&Oe&&this.zoom>=17&&(Tt.length!==0&&ut(Tt,Tt[0])&&Tt.pop(),this.groundEffect.addData(Tt,ht,A,Oe>0))}this.footprintSegments.push(lt),Et.triangleCount=this.indexArray.length-Et.triangleArrayOffset,this.polygonSegments.push(Et),++q.footprintSegLen,++q.polygonSegLen}if(q.vertexCount=this.layoutVertexArray.length-q.vertexArrayOffset,q.groundVertexCount=this.groundEffect.vertexArray.length-q.groundVertexArrayOffset,q.vertexCount!==0){if(q.centroidXY=W.borders?bR:this.encodeCentroid(W,q),this.centroidData.push(q),W.borders){this.featuresOnBorder.push(W);const Ue=this.featuresOnBorder.length-1;for(let ht=0;ht<W.borders.length;ht++)W.borders[ht][0]!==Number.MAX_VALUE&&this.borderFeatureIndices[ht].push(Ue)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,o,h,_,b,g,E,void 0,this.worldview),this.groundEffect.addPaintPropertiesData(o,h,_,b,g,E,this.worldview),this.maxHeight=Math.max(this.maxHeight,ne)}}sortBorders(){for(let r=0;r<this.borderFeatureIndices.length;r++)this.borderFeatureIndices[r].sort(((o,u)=>this.featuresOnBorder[o].borders[r][0]-this.featuresOnBorder[u].borders[r][0]))}splitToSubtiles(){const r=[];for(let b=0;b<this.centroidData.length;b++){const T=this.centroidData[b],E=+(T.min.y+T.max.y>zt),A=2*E+(+(T.min.x+T.max.x>zt)^E);for(let R=0;R<T.polygonSegLen;R++){const M=T.polygonSegIdx+R;r.push({centroidIdx:b,subtile:A,polygonSegmentIdx:M,triangleSegmentIdx:this.polygonSegments[M].triangleSegIdx})}}const o=new Mo;r.sort(((b,T)=>b.triangleSegmentIdx===T.triangleSegmentIdx?b.subtile-T.subtile:b.triangleSegmentIdx-T.triangleSegmentIdx));let u=0,h=0,g=0;for(const b of r){if(b.triangleSegmentIdx!==u)break;g++}const _=r.length;for(;h!==r.length;){u=r[h].triangleSegmentIdx;let b=0,T=h,E=h;for(let A=T;A<g&&r[A].subtile===b;A++)E++;for(;T!==g;){const A=r[T];b=A.subtile;const R=this.centroidData[A.centroidIdx].min.clone(),M=this.centroidData[A.centroidIdx].max.clone(),F={vertexOffset:this.segments.segments[u].vertexOffset,primitiveOffset:o.length,vertexLength:this.segments.segments[u].vertexLength,primitiveLength:0,sortKey:void 0,vaos:{}};for(let B=T;B<E;B++){const W=r[B],q=this.polygonSegments[W.polygonSegmentIdx],K=this.centroidData[W.centroidIdx].min,ne=this.centroidData[W.centroidIdx].max,re=this.indexArray.uint16;for(let oe=q.triangleArrayOffset;oe<q.triangleArrayOffset+q.triangleCount;oe++)o.emplaceBack(re[3*oe],re[3*oe+1],re[3*oe+2]);F.primitiveLength+=q.triangleCount,R.x=Math.min(R.x,K.x),R.y=Math.min(R.y,K.y),M.x=Math.max(M.x,ne.x),M.y=Math.max(M.y,ne.y)}F.primitiveLength>0&&this.triangleSubSegments.push({segment:F,min:R,max:M}),T=E;for(let B=T;B<g&&r[B].subtile===r[T].subtile;B++)E++}h=g;for(let A=h;A<_&&r[A].triangleSegmentIdx===r[h].triangleSegmentIdx;A++)g++}o._trim(),this.indexArray=o}getVisibleSegments(r,o,u){const h=new Bi;if(this.wallMode){for(const W of this.triangleSubSegments)h.segments.push(W.segment);return h}let g=0,_=0;const b=1<<r.canonical.z;if(o){const W=o.getMinMaxForTile(r);W&&(g=W.min,_=W.max)}_+=this.maxHeight;const T=r.toUnwrapped();let E;const A=[T.canonical.x/b+T.wrap,T.canonical.y/b],R=[(T.canonical.x+1)/b+T.wrap,(T.canonical.y+1)/b],M=(W,q,K)=>[W[0]*(1-K[0])+q[0]*K[0],W[1]*(1-K[1])+q[1]*K[1]],F=[],B=[];for(const W of this.triangleSubSegments){F[0]=W.min.x/zt,F[1]=W.min.y/zt,B[0]=W.max.x/zt,B[1]=W.max.y/zt;const q=M(A,R,F),K=M(A,R,B);if(new kn([q[0],q[1],g],[K[0],K[1],_]).intersectsPrecise(u)===0){E&&(h.segments.push(E),E=void 0);continue}const ne=W.segment;E&&E.vertexOffset!==ne.vertexOffset&&(h.segments.push(E),E=void 0),E?(E.vertexLength+=ne.vertexLength,E.primitiveLength+=ne.primitiveLength):E={vertexOffset:ne.vertexOffset,primitiveLength:ne.primitiveLength,vertexLength:ne.vertexLength,primitiveOffset:ne.primitiveOffset,sortKey:void 0,vaos:{}}}return E&&h.segments.push(E),h}encodeCentroid(r,o){const u=r.centroid(),h=o.span(),g=Math.min(7,Math.round(h.x*this.tileToMeter/10)),_=Math.min(7,Math.round(h.y*this.tileToMeter/10));return new xt(be(u.x,1,zt-1)<<3|g,be(u.y,1,zt-1)<<3|_)}encodeBorderCentroid(r){if(!r.borders)return new xt(0,0);const o=r.borders,u=Number.MAX_VALUE;if(o[0][0]!==u||o[1][0]!==u){const h=o[0][0]!==u?0:1;return new xt(6|(o[0][0]!==u?0:65528),(o[h][0]+o[h][1])/2<<3|6)}{const h=o[2][0]!==u?2:3;return new xt((o[h][0]+o[h][1])/2<<3|6,6|(o[2][0]!==u?0:65528))}}showCentroid(r){const o=this.centroidData[r.centroidDataIndex];o.flags&=2147483647,o.centroidXY.x=0,o.centroidXY.y=0,this.writeCentroidToBuffer(o)}writeCentroidToBuffer(r){this.groundEffect.updateHiddenByLandmark(r);const o=r.vertexArrayOffset,u=r.vertexCount+r.vertexArrayOffset,h=r.flags&dh?bR:r.centroidXY,g=this.centroidVertexArray.geta_centroid_pos0(o);if(this.centroidVertexArray.geta_centroid_pos1(o)!==h.y||g!==h.x){for(let _=o;_<u;++_)this.centroidVertexArray.emplace(_,h.x,h.y);this.needsCentroidUpdate=!0}}createCentroidsBuffer(){this.centroidVertexArray.resize(this.layoutVertexArray.length),this.groundEffect.hiddenByLandmarkVertexArray.resize(this.groundEffect.vertexArray.length);for(const r of this.centroidData)this.writeCentroidToBuffer(r)}updateReplacement(r,o,u){if(o.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=o.updateTime;const h=o.getReplacementRegionsForTile(r.toUnwrapped());if(y1(this.activeReplacements,h))return;if(this.activeReplacements=h,this.centroidVertexArray.length===0)this.createCentroidsBuffer();else for(const _ of this.centroidData)_.flags&=2147483647;const g=[];for(const _ of this.activeReplacements){if(_.order<u)continue;const b=Math.max(1,Math.pow(2,_.footprintTileId.canonical.z-r.canonical.z));if(_.footprint.buildingId){const T=_.footprint.buildingId;for(const E of this.centroidData)E.buildingId===T&&(E.flags|=dh)}else for(const T of this.centroidData)if(!(T.flags&dh||_.min.x>T.max.x||T.min.x>_.max.x||_.min.y>T.max.y||T.min.y>_.max.y))for(let E=0;E<T.footprintSegLen;E++){const A=this.footprintSegments[T.footprintSegIdx+E];if(g.length=0,K8(this.footprintVertices,A.vertexOffset,A.vertexCount,_.footprintTileId.canonical,r.canonical,g),HS(_.footprint,g,this.footprintIndices.uint16,A.indexOffset,A.indexCount,-A.vertexOffset,-b)){T.flags|=dh;break}}}for(const _ of this.centroidData)this.writeCentroidToBuffer(_);this.borderDoneWithNeighborZ=[-1,-1,-1,-1]}footprintContainsPoint(r,o,u){let h=!1;for(let g=0;g<u.footprintSegLen;g++){const _=this.footprintSegments[u.footprintSegIdx+g];let b=0;for(const T of _.ringIndices){for(let E=b,A=T+b-1;E<T+b;A=E++){const R=this.footprintVertices.int16[2*(E+_.vertexOffset)+0],M=this.footprintVertices.int16[2*(E+_.vertexOffset)+1],F=this.footprintVertices.int16[2*(A+_.vertexOffset)+1];M>o!=F>o&&r<(this.footprintVertices.int16[2*(A+_.vertexOffset)+0]-R)*(o-M)/(F-M)+R&&(h=!h)}b=T}}return h}getHeightAtTileCoord(r,o){let u=Number.NEGATIVE_INFINITY,h=!0;const g=4*(r+zt)*zt+(o+zt);if(this.partLookup.hasOwnProperty(g)){const _=this.partLookup[g];return _?{height:_.height,hidden:!!(_.flags&dh)}:void 0}for(const _ of this.centroidData)r>_.max.x||_.min.x>r||o>_.max.y||_.min.y>o||_.height<=u||this.footprintContainsPoint(r,o,_)&&(u=_.height,this.partLookup[g]=_,h=!!(_.flags&dh));if(u!==Number.NEGATIVE_INFINITY)return{height:u,hidden:h};this.partLookup[g]=void 0}}function ER(a,r){const o=a.add(r)._unit();return a.x*o.x+a.y*o.y}function q8(a,r,o,u){const h=r.sub(a)._perp()._unit(),g=o.sub(r)._perp()._unit();return CR(a,r,o,ER(h,g),u)}function CR(a,r,o,u,h){const g=Math.sqrt(1-u*u);return Math.min(a.dist(r)/3,r.dist(o)/3,h*g/u)}function XS(a,r,o){return a.x<o[0].x&&r.x<o[0].x||a.x>o[1].x&&r.x>o[1].x||a.y<o[0].y&&r.y<o[0].y||a.y>o[1].y&&r.y>o[1].y}function IR(a,r){return a.x<r[0].x||a.x>r[1].x||a.y<r[0].y||a.y>r[1].y}function AR(a,r,o){if(a.x<0||a.x>=zt||r.x<0||r.x>=zt||o.x<0||o.x>=zt)return!1;const u=o.sub(r),h=u.perp(),g=a.sub(r);return(u.x*g.x+u.y*g.y)/Math.sqrt((u.x*u.x+u.y*u.y)*(g.x*g.x+g.y*g.y))>-.866&&h.x*g.x+h.y*g.y<0}function PR(a,r,o){const u=r?2|a:-3&a;return o?1|u:-2&u}function RR(){const a=Math.PI/32,r=Math.tan(a),o=U;return o*Math.sqrt(1+2*r*r)-o}function kR(a,r,o){const u=1<<o.z,h=ge(o.x/u),g=ge((o.x+1)/u),_=pe(o.y/u),b=pe((o.y+1)/u);return(function(T,E,A,R,M=0,F){const B=[];if(!T.length||!A||!R)return B;const W=(ve,Ce)=>{for(const Oe of ve)B.push({polygon:Oe,bounds:Ce})},q=Math.ceil(Math.log2(A)),K=Math.ceil(Math.log2(R)),ne=q-K,re=[];for(let ve=0;ve<Math.abs(ne);ve++)re.push(ne>0?0:1);for(let ve=0;ve<Math.min(q,K);ve++)re.push(0),re.push(1);let oe=T;if(oe=m1(oe,E[0].y-M,E[1].y+M,1),oe=m1(oe,E[0].x-M,E[1].x+M,0),!oe.length)return B;const ye=[];for(re.length?ye.push({polygons:oe,bounds:E,depth:0}):W(oe,E);ye.length;){const ve=ye.pop(),Ce=ve.depth,Oe=re[Ce],De=ve.bounds[0],ut=ve.bounds[1],Ue=Oe===0?De.x:De.y,ht=Oe===0?ut.x:ut.y,wt=F?F(Oe,Ue,ht):.5*(Ue+ht),mt=m1(ve.polygons,Ue-M,wt+M,Oe),yt=m1(ve.polygons,wt-M,ht+M,Oe);if(mt.length){const Et=[De,new xt(Oe===0?wt:ut.x,Oe===1?wt:ut.y)];re.length>Ce+1?ye.push({polygons:mt,bounds:Et,depth:Ce+1}):W(mt,Et)}if(yt.length){const Et=[new xt(Oe===0?wt:De.x,Oe===1?wt:De.y),ut];re.length>Ce+1?ye.push({polygons:yt,bounds:Et,depth:Ce+1}):W(yt,Et)}}return B})(a,r,Math.ceil((g-h)/11.25),Math.ceil((_-b)/11.25),1,((T,E,A)=>{if(T===0)return .5*(E+A);{const R=pe((o.y+E/zt)/u);return(me(.5*(pe((o.y+A/zt)/u)+R))*u-o.y)*zt}}))}function K8(a,r,o,u,h,g){const _=Math.pow(2,u.z-h.z);for(let b=0;b<o;b++){let T=a.int16[2*(b+r)+0],E=a.int16[2*(b+r)+1];T=(T+h.x*zt)*_-u.x*zt,E=(E+h.y*zt)*_-u.y*zt,g.push(new xt(T,E))}}let OR,MR;Wt(b1,"FillExtrusionBucket",{omit:["layers","features"]}),Wt(wR,"PartData"),Wt(xR,"FootprintSegment"),Wt(TR,"BorderCentroidData"),Wt(ZS,"GroundEffect");class Gf extends xt{constructor(r,o,u){super(r,o),this.z=u}}class DR extends Gf{constructor(r,o,u,h){super(r,o,u),this.w=h}}function LR(a,r,o,u){const h=o==="x"?"y":"x",g=(u-a[o])/(r[o]-a[o]);a[h]=Math.round(a[h]+(r[h]-a[h])*g),a[o]=u,a.hasOwnProperty("z")&&(a.z=wn(a.z,r.z,g)),a.hasOwnProperty("w")&&(a.w=wn(a.w,r.w,g))}function zR(a,r,o,u){const h=o,g=u;for(const _ of["x","y"]){let b=a,T=r;b[_]>=T[_]&&(b=r,T=a),b[_]<h&&T[_]>h&&LR(b,T,_,h),b[_]<g&&T[_]>g&&LR(T,b,_,g)}}function x1(a,r,o,u,h,g){const _=[];for(let b=0;b<a.length;b++){const T=a[b];let E;const A=_.length;let R=0;for(let M=0;M<T.length-1;M++){let F=T[M],B=T[M+1],W=0;const q=R;let K,ne;g&&(W=Math.hypot(B.x-F.x,B.y-F.y),R+=W,K=F,ne=B),F.x<r&&B.x<r||(F.x<r?F=new xt(r,F.y+(r-F.x)/(B.x-F.x)*(B.y-F.y))._round():B.x<r&&(B=new xt(r,F.y+(r-F.x)/(B.x-F.x)*(B.y-F.y))._round()),F.y<o&&B.y<o||(F.y<o?F=new xt(F.x+(o-F.y)/(B.y-F.y)*(B.x-F.x),o)._round():B.y<o&&(B=new xt(F.x+(o-F.y)/(B.y-F.y)*(B.x-F.x),o)._round()),F.x>=u&&B.x>=u||(F.x>=u?F=new xt(u,F.y+(u-F.x)/(B.x-F.x)*(B.y-F.y))._round():B.x>=u&&(B=new xt(u,F.y+(u-F.x)/(B.x-F.x)*(B.y-F.y))._round()),F.y>=h&&B.y>=h||(F.y>=h?F=new xt(F.x+(h-F.y)/(B.y-F.y)*(B.x-F.x),h)._round():B.y>=h&&(B=new xt(F.x+(h-F.y)/(B.y-F.y)*(B.x-F.x),h)._round()),E&&F.equals(E[E.length-1])||(E=[F],_.push(E),g&&g.push({progress:{min:q+FR(K,ne,F)*W,max:1},parentIndex:b,prevPoint:K,nextPoint:ne})),E.push(B),g&&(g[g.length-1].progress.max=q+FR(K,ne,B)*W,g[g.length-1].nextPoint=ne)))))}if(g&&R>0)for(let M=A;M<_.length;M++)g[M].progress.min/=R,g[M].progress.max/=R}return _}function Z8(a,r,o,u,h){if(a.length<2)return void u.push(a);const g=[];for(;r.valid();){const[E,A]=r.get();for(let R=0;R<a.length-1;R++){const M=a[R],F=a[R+1],B=eo(M,F,E,A);if(B){const[W]=B,q=new xt(wn(M.x,F.x,W),wn(M.y,F.y,W));g.push({t:R+W,distance:0,point:q})}}r.next()}if(g.length===0)return void u.push(a);g.sort(((E,A)=>E.t-A.t));let _=0,b=0,T=[];for(u.push(T);_!==a.length;){if(b===g.length){for(;_!==a.length;)T.length!==0&&T[T.length-1].equals(a[_])||T.push(a[_]),_++;break}g[b].t<=_?(T.length!==0&&T[T.length-1].equals(g[b].point)||T.push(g[b].point),Math.trunc(g[b].t),b++):(T.length!==0&&T[T.length-1].equals(a[_])||T.push(a[_]),_++)}}function FR(a,r,o){return a.x!==r.x?(o.x-a.x)/(r.x-a.x):a.y!==r.y?(o.y-a.y)/(r.y-a.y):0}function xy(a,r){return a.x*r.x+a.y*r.y}function BR(a,r){if(a.length===1){let o=0;const u=r[o++];let h;for(;!h||u.equals(h);)if(h=r[o++],!h)return 1/0;for(;o<r.length;o++){const g=r[o],_=a[0],b=h.sub(u),T=g.sub(u),E=_.sub(u),A=xy(b,b),R=xy(b,T),M=xy(T,T),F=xy(E,b),B=xy(E,T),W=A*M-R*R,q=(M*F-R*B)/W,K=(A*B-R*F)/W,ne=u.z*(1-q-K)+h.z*q+g.z*K;if(isFinite(ne))return ne}return 1/0}{let o=1/0;for(const u of r)o=Math.min(o,u.z);return o}}function NR(a,r,o,u,h,g,_,b){const T=_*h.getElevationAt(a,r,!0,!0),E=g[0]!==0,A=E?g[1]===0?_*(g[0]/7-450):_*(function(R,M,F){const B=Math.floor(M[0]/8),W=Math.floor(M[1]/8),q=10*(M[0]-8*B),K=10*(M[1]-8*W),ne=R.getElevationAt(B,W,!0,!0),re=R.getMeterToDEM(F),oe=Math.floor(.5*(q*re-1)),ye=Math.floor(.5*(K*re-1)),ve=R.tileCoordToPixel(B,W),Ce=2*oe+1,Oe=2*ye+1,De=(function(yt,Et,lt,vt,rt){return[yt.getElevationAtPixel(Et,lt,!0),yt.getElevationAtPixel(Et+rt,lt,!0),yt.getElevationAtPixel(Et,lt+rt,!0),yt.getElevationAtPixel(Et+vt,lt+rt,!0)]})(R,ve.x-oe,ve.y-ye,Ce,Oe),ut=Math.abs(De[0]-De[1]),Ue=Math.abs(De[2]-De[3]),ht=Math.abs(De[0]-De[2])+Math.abs(De[1]-De[3]),wt=Math.min(.25,.5*re*(ut+Ue)/Ce),mt=Math.min(.25,.5*re*ht/Oe);return ne+Math.max(wt*q,mt*K)})(h,g,b):T;return{base:T+(o===0?-1:o),top:E?Math.max(A+u,T+o+2):T+u}}class X8{constructor(r){this._callback=r,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout((()=>{this._triggered=!1,this._callback()}),0))}remove(){this._channel=void 0,this._callback=()=>{}}}class Y8{constructor(){this.tasks={},this.taskQueue=[],xn(["process"],this),this.invoker=new X8(this.process),this.nextId=0}add(r,o){const u=this.nextId++,h=(function({type:g,isSymbolTile:_,zoom:b}){return b=b||0,g==="message"?0:g!=="maybePrepare"||_?g!=="parseTile"||_?g==="parseTile"&&_?300-b:g==="maybePrepare"&&_?400-b:500:200-b:100-b})(o);if(h===0){try{r()}finally{}return null}return this.tasks[u]={fn:r,metadata:o,priority:h,id:u},this.taskQueue.push(u),this.invoker.trigger(),{cancel:()=>{delete this.tasks[u]}}}process(){try{if(this.taskQueue=this.taskQueue.filter((u=>!!this.tasks[u])),!this.taskQueue.length)return;const r=this.pick();if(r===null)return;const o=this.tasks[r];if(delete this.tasks[r],this.taskQueue.length&&this.invoker.trigger(),!o)return;o.fn()}finally{}}pick(){let r=null,o=1/0;for(let h=0;h<this.taskQueue.length;h++){const g=this.tasks[this.taskQueue[h]];g.priority<o&&(o=g.priority,r=h)}if(r===null)return null;const u=this.taskQueue[r];return this.taskQueue.splice(r,1),u}remove(){this.invoker.remove()}}class VR{constructor(r,o,u){this.target=r,this.parent=o,this.mapId=u,this.callbacks={},this.cancelCallbacks={},xn(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.scheduler=new Y8}send(r,o,u,h,g=!1,_){const b=Math.round(1e18*Math.random()).toString(36).substring(0,10);u&&(u.metadata=_,this.callbacks[b]=u);const T=new Set;return this.target.postMessage({id:b,type:r,hasCallback:!!u,targetMapId:h,mustQueue:g,sourceMapId:this.mapId,data:zc(o,T)},T),{cancel:()=>{u&&delete this.callbacks[b],this.target.postMessage({id:b,type:"<cancel>",targetMapId:h,sourceMapId:this.mapId})}}}receive(r){const o=r.data;if(!o)return;const u=o.id;if(u&&(!o.targetMapId||this.mapId===o.targetMapId))if(o.type==="<cancel>"){const h=this.cancelCallbacks[u];delete this.cancelCallbacks[u],h&&h.cancel()}else if(o.mustQueue||Zr(self)){const h=this.callbacks[u],g=this.scheduler.add((()=>this.processTask(u,o)),h&&h.metadata||{type:"message"});g&&(this.cancelCallbacks[u]=g)}else this.processTask(u,o)}processTask(r,o){if(delete this.cancelCallbacks[r],o.type==="<response>"){const u=this.callbacks[r];delete this.callbacks[r],u&&(o.error?u(Fc(o.error)):u(null,Fc(o.data)))}else{const u=new Set,h=o.hasCallback?(_,b)=>{this.target.postMessage({id:r,type:"<response>",sourceMapId:this.mapId,error:_?zc(_):null,data:zc(b,u)},u)}:()=>{},g=Fc(o.data);if(this.parent[o.type])this.parent[o.type](o.sourceMapId,g,h);else if(this.parent.getWorkerSource){const _=o.type.split("."),{source:b,scope:T}=g;this.parent.getWorkerSource(o.sourceMapId,_[0],b,T)[_[1]](g,h)}else h(new Error(`Could not find function ${o.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}}var wy={workerUrl:"",workerClass:null,workerParams:void 0};const YS="mapboxgl_preloaded_worker_pool";class Hf{constructor(){this.active={}}acquire(r,o=Hf.workerCount){if(!this.workers)for(this.workers=[];this.workers.length<o;)this.workers.push(wy.workerClass!=null?new wy.workerClass:new self.Worker(wy.workerUrl,wy.workerParams));return this.active[r]=!0,this.workers.slice()}release(r){delete this.active[r],this.workers&&this.numActive()===0&&(this.workers.forEach((o=>{o.terminate()})),this.workers=null)}isPreloaded(){return!!this.active[YS]}numActive(){return Object.keys(this.active).length}}Hf.workerCount=2;class Bm{constructor(r,o,u="Worker",h=Hf.workerCount){this.workerPool=r,this.actors=[],this.currentActor=0,this.id=gt();const g=this.workerPool.acquire(this.id,h);for(let _=0;_<g.length;_++){const b=new Bm.Actor(g[_],o,this.id);b.name=`${u} ${_}`,this.actors.push(b)}this.ready=!1,this.broadcast("checkIfReady",null,(()=>{this.ready=!0}))}broadcast(r,o,u){nt(this.actors,((h,g)=>{h.send(r,o,g)}),u=u||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach((r=>{r.remove()})),this.actors=[],this.workerPool.release(this.id)}}let Ty,JS;function w1(){return Ty||(Ty=new Hf),Ty}Bm.Actor=VR;class J8{constructor(r){this.module=r}createIntArray(r){const o=new Int32Array(r),u=this.module.malloc(o.length*o.BYTES_PER_ELEMENT);return this.module.heap32.set(o,u/o.BYTES_PER_ELEMENT),u}createFloatArray(r){const o=new Float32Array(r),u=this.module.malloc(o.length*o.BYTES_PER_ELEMENT);return this.module.heapF32.set(o,u/o.BYTES_PER_ELEMENT),u}createStringBuffer(r){const o=this.module.malloc(r.length+1);for(let u=0;u<r.length;++u)this.module.heapU8[o+u]=r.charCodeAt(u);return this.module.heapU8[o+r.length]=0,o}readStringBuffer(r){let o="";for(;this.module.heapU8[r]!==0;)o+=String.fromCharCode(this.module.heapU8[r]),++r;return o}setStyle(r){const o=r.entranceColorRgb,u=r.facadeGlazingColorRgb,h=r.roofColorRgb,g=r.wallColorRgb,_=r.normalScale;this.module.setStyle(o[0],o[1],o[2],u[0],u[1],u[2],h[0],h[1],h[2],g[0],g[1],g[2],_[0],_[1],_[2],r.tileToMeters)}setAOOptions(r,o){this.module.setAOOptions(r?1:0,o)}setMetricOptions(r,o){this.module.setMetricOptions(r?1:0,o)}setStructuralOptions(r){this.module.setStructuralOptions(r?1:0)}setFacadeOptions(r,o){this.module.setFacadeOptions(r,o?1:0)}setFauxFacadeOptions(r,o,u){this.module.setFauxFacadeOptions(r?1:0,o?1:0,u)}setFacadeClassifierOptions(r){this.module.setFacadeClassifierOptions(r)}generateMesh(r,o){for(const b of r){const T=this.createStringBuffer(b.roofType),E=[0],A=[];for(const F of b.coordinates)if(Array.isArray(F)){for(const B of F)A.push(B.x),A.push(B.y);E.push(A.length)}const R=this.createIntArray(E),M=this.createFloatArray(A);this.module.addFeature(b.id,b.sourceId,b.minHeight,b.height,T,b.roofType.length,M,R,E.length-1),this.module.free(T),this.module.free(R),this.module.free(M)}for(const b of o){let T;T=b.entrances?JSON.parse(b.entrances):[];const E=this.createFloatArray(T),A=[];for(const M of b.coordinates)A.push(M.x),A.push(M.y);const R=this.createFloatArray(A);this.module.addFacade(b.sourceId,b.crossPerc,b.distanceToRoad,E,T.length,R,A.length),this.module.free(E),this.module.free(R)}if(!this.module.generateMesh()){const b=this.module.getLastError();return this.readStringBuffer(b)}const u=this.module.getMeshCount(),h=new Array(u);for(let b=0;b<u;b++){const T=this.module.getPositionsPtr(b),E=this.module.getPositionsLength(b),A=new Float32Array(this.module.heapF32.buffer,T,E),R=this.module.getNormalsPtr(b),M=this.module.getNormalsLength(b),F=new Float32Array(this.module.heapF32.buffer,R,M),B=this.module.getColorsPtr(b),W=this.module.getColorsLength(b),q=new Uint8Array(this.module.heapU8.buffer,B,W),K=this.module.getAOPtr(b),ne=this.module.getAOLength(b),re=new Float32Array(this.module.heapF32.buffer,K,ne),oe=this.module.getUVPtr(b),ye=this.module.getUVLength(b),ve=new Float32Array(this.module.heapF32.buffer,oe,ye),Ce=this.module.getFauxFacadePtr(b),Oe=this.module.getFauxFacadeLength(b),De=new Uint8Array(this.module.heapU8.buffer,Ce,Oe),ut=this.module.getIndicesPtr(b),Ue=this.module.getIndicesLength(b),ht=new Int32Array(this.module.heap32.buffer,ut,Ue),wt=this.module.getBuildingPart(b),mt=this.readStringBuffer(wt);h[b]={positions:A,normals:F,colors:q,ao:re,uv:ve,isFauxFacade:De,indices:ht,buildingPart:mt}}const g=this.module.getRingCount(),_=[];for(let b=0;b<g;b++){const T=this.module.getRingPtr(b),E=this.module.getRingLength(b),A=new Float32Array(this.module.heapF32.buffer,T,E);_.push(A)}return{meshes:h,outerRingLength:this.module.getOuterRingLength(),modifiedPolygonRings:_}}}let Sy,QS,ic,Nm,eE,Vm=null,$m=null,$R=null,T1=null;function UR(){return Zr(self)&&self.worker.dracoUrl?self.worker.dracoUrl:QS||Ho.DRACO_URL}function jR(){if(Zr(self)&&self.worker.meshoptUrl)return self.worker.meshoptUrl;if(Nm)return Nm;const a=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]);if(typeof WebAssembly!="object")throw new Error("WebAssembly not supported, cannot instantiate meshoptimizer");return Nm=WebAssembly.validate(a)?Ho.MESHOPT_SIMD_URL:Ho.MESHOPT_URL,Nm}function Q8(){return T1}const S1={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},e$={5120:"DT_INT8",5121:"DT_UINT8",5122:"DT_INT16",5123:"DT_UINT16",5125:"DT_UINT32",5126:"DT_FLOAT32"},Ey={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16};function GR(a,r,o){const u=o.json.bufferViews.length,h=o.buffers.length;r.bufferView=u,o.json.bufferViews[u]={buffer:h,byteLength:a.byteLength},o.buffers[h]=a}const tE="KHR_draco_mesh_compression";function t$(a,r){const o=a.extensions&&a.extensions[tE];if(!o)return;const u=new ic.Decoder,h=KR(r,o.bufferView),g=new ic.Mesh;if(!u.DecodeArrayToMesh(h,h.byteLength,g))throw new Error("Failed to decode Draco mesh");const _=r.json.accessors[a.indices],b=S1[_.componentType],T=_.count*b.BYTES_PER_ELEMENT,E=ic._malloc(T);b===Uint16Array?u.GetTrianglesUInt16Array(g,T,E):u.GetTrianglesUInt32Array(g,T,E),GR(ic.memory.buffer.slice(E,E+T),_,r),ic._free(E);for(const A of Object.keys(o.attributes)){const R=u.GetAttributeByUniqueId(g,o.attributes[A]),M=r.json.accessors[a.attributes[A]],F=e$[M.componentType],B=M.count*Ey[M.type]*S1[M.componentType].BYTES_PER_ELEMENT,W=ic._malloc(B);u.GetAttributeDataArrayForAllPoints(g,R,ic[F],B,W),GR(ic.memory.buffer.slice(W,W+B),M,r),ic._free(W)}u.destroy(),g.destroy(),delete a.extensions[tE]}const E1="EXT_meshopt_compression";function n$(a,r){if(!a.extensions||!a.extensions[E1])return;const o=a.extensions[E1],u=new Uint8Array(r.buffers[o.buffer],o.byteOffset||0,o.byteLength||0),h=new Uint8Array(o.count*o.byteStride);eE.decodeGltfBuffer(h,o.count,o.byteStride,u,o.mode,o.filter),a.buffer=r.buffers.length,a.byteOffset=0,r.buffers[a.buffer]=h.buffer,delete a.extensions[E1]}const HR=1179937895,WR=new TextDecoder("utf8");function qR(a,r){return new URL(a,r).href}function r$(a,r,o,u){return fetch(qR(a.uri,u)).then((h=>h.arrayBuffer())).then((h=>{r.buffers[o]=h}))}function KR(a,r){const o=a.json.bufferViews[r];return new Uint8Array(a.buffers[o.buffer],o.byteOffset||0,o.byteLength)}function i$(a,r,o,u){if(a.uri){const h=qR(a.uri,u);return fetch(h).then((g=>g.blob())).then((g=>createImageBitmap(g))).then((g=>{r.images[o]=g}))}if(a.bufferView!==void 0){const h=KR(r,a.bufferView),g=new Blob([h],{type:a.mimeType});return createImageBitmap(g).then((_=>{r.images[o]=_}))}}function ZR(a,r=0,o){const u={json:null,images:[],buffers:[]};if(new Uint32Array(a,r,1)[0]===HR){const A=new Uint32Array(a,r);let R=2;const M=(A[R++]>>2)-3,F=A[R++]>>2;if(R++,u.json=JSON.parse(WR.decode(A.subarray(R,R+F))),R+=F,R<M){const B=A[R++];R++;const W=r+(R<<2);u.buffers[0]=a.slice(W,W+B)}}else u.json=JSON.parse(WR.decode(new Uint8Array(a,r)));const{buffers:h,images:g,meshes:_,extensionsUsed:b,bufferViews:T}=u.json;let E=Promise.resolve();if(h){const A=[];for(let R=0;R<h.length;R++){const M=h[R];M.uri?A.push(r$(M,u,R,o)):u.buffers[R]||(u.buffers[R]=null)}E=Promise.all(A)}return E.then((()=>{const A=[],R=b&&b.includes(tE),M=b&&b.includes(E1);if(R&&A.push((function(){if(!ic)return Sy??(Sy=(function(F){let B,W=null;function q(){B=new Uint8Array(W.buffer)}function K(){throw new Error("Unexpected Draco error.")}const ne={a:{a:K,d:function(re,oe,ye){return B.copyWithin(re,oe,oe+ye)},c:function(re){const oe=B.length,ye=Math.max(re>>>0,Math.ceil(1.2*oe)),ve=Math.ceil((ye-oe)/65536);try{return W.grow(ve),q(),!0}catch{return!1}},b:K}};return(WebAssembly.instantiateStreaming?WebAssembly.instantiateStreaming(F,ne):F.then((re=>re.arrayBuffer())).then((re=>WebAssembly.instantiate(re,ne)))).then((re=>{const{Rb:oe,Qb:ye,P:ve,T:Ce,X:Oe,Ja:De,La:ut,Qa:Ue,Va:ht,Wa:wt,eb:mt,jb:yt,f:Et,e:lt,yb:vt,zb:rt,Ab:Xe,Bb:Ct,Db:Tt,Gb:hn}=re.instance.exports;W=lt;const Ht=(()=>{let Jt=0,Dt=0,dn=0,Fn=0;return Vt=>{dn&&(oe(Fn),oe(Jt),Dt+=dn,dn=Jt=0),Jt||(Dt+=128,Jt=ye(Dt));const tn=Vt.length+7&-8;let An=Jt;tn>=Dt&&(dn=tn,An=Fn=ye(tn));for(let Nn=0;Nn<Vt.length;Nn++)B[An+Nn]=Vt[Nn];return An}})();return q(),Et(),{memory:lt,_free:oe,_malloc:ye,Mesh:class{constructor(){this.ptr=ve()}destroy(){Ce(this.ptr)}},Decoder:class{constructor(){this.ptr=De()}destroy(){yt(this.ptr)}DecodeArrayToMesh(Jt,Dt,dn){const Fn=Ht(Jt),Vt=ut(this.ptr,Fn,Dt,dn.ptr);return!!Oe(Vt)}GetAttributeByUniqueId(Jt,Dt){return{ptr:Ue(this.ptr,Jt.ptr,Dt)}}GetTrianglesUInt16Array(Jt,Dt,dn){ht(this.ptr,Jt.ptr,Dt,dn)}GetTrianglesUInt32Array(Jt,Dt,dn){wt(this.ptr,Jt.ptr,Dt,dn)}GetAttributeDataArrayForAllPoints(Jt,Dt,dn,Fn,Vt){mt(this.ptr,Jt.ptr,Dt.ptr,dn,Fn,Vt)}},DT_INT8:vt(),DT_UINT8:rt(),DT_INT16:Xe(),DT_UINT16:Ct(),DT_UINT32:Tt(),DT_FLOAT32:hn()}}))})(fetch(UR())),Sy.then((F=>{ic=F,Sy=void 0})))})()),M&&A.push((function(){if(eE)return;const F=(function(B){let W;const q=WebAssembly.instantiateStreaming(B,{}).then((re=>{W=re.instance,W.exports.__wasm_call_ctors()})),K={NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},ne={ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"};return{ready:q,supported:!0,decodeGltfBuffer(re,oe,ye,ve,Ce,Oe){(function(De,ut,Ue,ht,wt,mt,yt){const Et=De.exports.sbrk,lt=ht+3&-4,vt=Et(lt*wt),rt=Et(mt.length),Xe=new Uint8Array(De.exports.memory.buffer);Xe.set(mt,rt);const Ct=ut(vt,ht,wt,rt,mt.length);if(Ct===0&&yt&&yt(vt,lt,wt),Ue.set(Xe.subarray(vt,vt+ht*wt)),Et(vt-Et(0)),Ct!==0)throw new Error(`Malformed buffer data: ${Ct}`)})(W,W.exports[ne[Ce]],re,oe,ye,ve,W.exports[K[Oe]])}}})(fetch(jR()));return F.ready.then((()=>{eE=F}))})()),g)for(let F=0;F<g.length;F++)A.push(i$(g[F],u,F,o));return(A.length?Promise.all(A):Promise.resolve()).then((()=>{if(R&&_)for(const{primitives:F}of _)for(const B of F)t$(B,u);if(M&&_&&T)for(const F of T)n$(F,u);return u}))}))}function nE(a){switch(a){case WebGL2RenderingContext.RGBA8:return WebGL2RenderingContext.RGBA;case WebGL2RenderingContext.DEPTH_COMPONENT16:return WebGL2RenderingContext.DEPTH_COMPONENT;case WebGL2RenderingContext.DEPTH24_STENCIL8:return WebGL2RenderingContext.DEPTH_STENCIL;case WebGL2RenderingContext.R8:case WebGL2RenderingContext.R32F:return WebGL2RenderingContext.RED}}function rE(a){switch(a){case WebGL2RenderingContext.RGBA8:return WebGL2RenderingContext.UNSIGNED_BYTE;case WebGL2RenderingContext.DEPTH_COMPONENT16:return WebGL2RenderingContext.UNSIGNED_SHORT;case WebGL2RenderingContext.DEPTH24_STENCIL8:return WebGL2RenderingContext.UNSIGNED_INT_24_8;case WebGL2RenderingContext.R8:return WebGL2RenderingContext.UNSIGNED_BYTE;case WebGL2RenderingContext.R32F:return WebGL2RenderingContext.FLOAT}}class iE{constructor(r,o,u,h){this.context=r,this.format=u,this.useMipmap=h&&h.useMipmap,this.texture=r.gl.createTexture(),this.update(o,{premultiply:h&&h.premultiply})}update(r,o){const u=r&&r instanceof HTMLVideoElement&&r.width===0?r.videoWidth:r.width,h=r&&r instanceof HTMLVideoElement&&r.height===0?r.videoHeight:r.height,{context:g}=this,{gl:_}=g,{x:b,y:T}=o&&o.position?o.position:{x:0,y:0},E=b+u,A=T+h;!this.size||this.size[0]===E&&this.size[1]===A||(_.bindTexture(_.TEXTURE_2D,null),_.deleteTexture(this.texture),this.texture=_.createTexture(),this.size=null),_.bindTexture(_.TEXTURE_2D,this.texture),g.pixelStoreUnpackFlipY.set(!1),g.pixelStoreUnpack.set(1),g.pixelStoreUnpackPremultiplyAlpha.set(this.format===_.RGBA8&&(!o||o.premultiply!==!1));const R=r instanceof HTMLImageElement||r instanceof HTMLCanvasElement||r instanceof HTMLVideoElement||r instanceof ImageData||ImageBitmap&&r instanceof ImageBitmap;if(!this.size&&E>0&&A>0){const M=this.useMipmap?Math.floor(Math.log2(Math.max(E,A)))+1:1;_.texStorage2D(_.TEXTURE_2D,M,this.format,E,A),this.size=[E,A]}this.size&&(R?_.texSubImage2D(_.TEXTURE_2D,0,b,T,nE(this.format),rE(this.format),r):"data"in r&&r.data&&_.texSubImage2D(_.TEXTURE_2D,0,b,T,u,h,nE(this.format),rE(this.format),r.data)),this.useMipmap&&_.generateMipmap(_.TEXTURE_2D)}bind(r,o,u=!1){const{context:h}=this,{gl:g}=h;g.bindTexture(g.TEXTURE_2D,this.texture),r!==this.minFilter&&(g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MAG_FILTER,r),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MIN_FILTER,this.useMipmap&&!u?r===g.NEAREST?g.NEAREST_MIPMAP_NEAREST:g.LINEAR_MIPMAP_LINEAR:r),this.minFilter=r),o!==this.wrapS&&(g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_S,o),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_T,o),this.wrapS=o)}bindExtraParam(r,o,u,h,g){const{context:_}=this,{gl:b}=_;b.bindTexture(b.TEXTURE_2D,this.texture),o!==this.magFilter&&(b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MAG_FILTER,o),this.magFilter=o),r!==this.minFilter&&(b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,this.useMipmap?r===b.NEAREST?b.NEAREST_MIPMAP_NEAREST:b.LINEAR_MIPMAP_LINEAR:r),this.minFilter=r),u!==this.wrapS&&(b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_S,u),this.wrapS=u),h!==this.wrapT&&(b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_T,h),this.wrapT=h),g!==this.compareMode&&(g?(b.texParameteri(b.TEXTURE_2D,b.TEXTURE_COMPARE_MODE,b.COMPARE_REF_TO_TEXTURE),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_COMPARE_FUNC,g)):b.texParameteri(b.TEXTURE_2D,b.TEXTURE_COMPARE_MODE,b.NONE),this.compareMode=g)}destroy(){const{gl:r}=this.context;r.deleteTexture(this.texture),this.texture=null}}class Cy{constructor(r,o){this.context=r,this.texture=o}bind(r,o){const{context:u}=this,{gl:h}=u;h.bindTexture(h.TEXTURE_2D,this.texture),r!==this.minFilter&&(h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MAG_FILTER,r),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MIN_FILTER,r),this.minFilter=r),o!==this.wrapS&&(h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_S,o),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_T,o),this.wrapS=o)}}const o$=gr([{name:"a_pos_3f",components:3,type:"Float32"}]),s$=gr([{name:"a_color_3f",components:3,type:"Float32"}]),a$=gr([{name:"a_color_4f",components:4,type:"Float32"}]),l$=gr([{name:"a_uv_2f",components:2,type:"Float32"}]),c$=gr([{name:"a_normal_3f",components:3,type:"Float32"}]),u$=gr([{name:"a_normal_matrix0",components:4,type:"Float32"},{name:"a_normal_matrix1",components:4,type:"Float32"},{name:"a_normal_matrix2",components:4,type:"Float32"},{name:"a_normal_matrix3",components:4,type:"Float32"}]),d$=gr([{name:"a_pbr",components:4,type:"Uint16"},{name:"a_heightBasedEmissiveStrength",components:3,type:"Float32"}]);function XR(a,r){const o=C1(a.projection,a.zoom,a.width,a.height),u=(function(g,_,b,T,E){const A=new H(b.lng-180*hh,b.lat),R=new H(b.lng+180*hh,b.lat),M=g.project(A.lng,A.lat),F=g.project(R.lng,R.lat),B=-Math.atan2(F.y-M.y,F.x-M.x),W=it.fromLngLat(b);W.y=be(W.y,-1+hh,1-hh);const q=W.toLngLat(),K=g.project(q.lng,q.lat),ne=it.fromLngLat(q);ne.x+=hh;const re=ne.toLngLat(),oe=g.project(re.lng,re.lat),ye=JR(oe.x-K.x,oe.y-K.y,B),ve=it.fromLngLat(q);ve.y+=hh;const Ce=ve.toLngLat(),Oe=g.project(Ce.lng,Ce.lat),De=JR(Oe.x-K.x,Oe.y-K.y,B),ut=Math.abs(ye.x)/Math.abs(De.y),Ue=de([]);kt(Ue,Ue,-B*(1-(E?0:T)));const ht=de([]);return Ye(ht,ht,[1,1-(1-ut)*T,1]),ht[4]=-De.x/De.y*T,kt(ht,ht,B),Be(ht,Ue,ht),ht})(a.projection,0,a.center,o,r),h=YR(a);return Ye(u,u,[h,h,1]),u}function YR(a){const r=a.projection,o=C1(a.projection,a.zoom,a.width,a.height),u=oE(r,a.center),h=oE(r,H.convert(r.center));return Math.pow(2,u*o+(1-o)*h)}function C1(a,r,o,u,h=1/0){const g=a.range;if(!g)return 0;const _=Math.min(h,Math.max(o,u)),b=Math.log2(_/1024);return tt(g[0]+b,g[1]+b,r)}const hh=1/4e4;function oE(a,r){const o=be(r.lat,-_e,_e),u=new H(r.lng-180*hh,o),h=new H(r.lng+180*hh,o),g=a.project(u.lng,o),_=a.project(h.lng,o),b=it.fromLngLat(u),T=it.fromLngLat(h),E=_.x-g.x,A=_.y-g.y,R=T.x-b.x,M=T.y-b.y,F=Math.sqrt((R*R+M*M)/(E*E+A*A));return Math.log2(F)}function JR(a,r,o){const u=Math.cos(o),h=Math.sin(o);return{x:a*u-r*h,y:a*h+r*u}}function QR(a,r,o){de(a),kt(a,a,Fe(r[2])),Ne(a,a,Fe(r[0])),Mt(a,a,Fe(r[1])),Ye(a,a,o),Be(a,a,[1,0,0,0,0,0,1,0,0,1,0,0,0,0,0,1])}function I1(a,r,o,u,h,g,_,b){const T=[o[0]-r[0],o[1]-r[1],0],E=[u[0]-r[0],u[1]-r[1],0];if(ke(T)<1e-12||ke(E)<1e-12)return En(a);const A=ln([],T,E);ur(A,A),Sn(E,u,r),T[2]=(g-h)*b,E[2]=(_-h)*b;const R=T;return ln(R,T,E),ur(R,R),So(a,A,R)}function sE(a,r,o=!1){const u=ch(r.zoom),h=(function(g,_,b){const T=_.worldSize,E=[g[12],g[13],g[14]],A=pe(E[1]/T),R=ge(E[0]/T),M=de([]),F=fe(1,A)*T,B=fe(1,0)*T*Le(A,_.zoom),W=1/DS(T);let q=B*W;if(b){const oe=C1(_.projection,_.zoom,_.width,_.height,1024);q=W*_.projection.pixelSpaceConversion(_.center.lat,T,oe)}const K=z(A,R);mn(K,K,or([],ur([],K),F*q*E[2]));const ne=(function(oe){const ye=[oe[0],oe[1],oe[2]];let ve=[0,1,0];const Ce=ln([],ve,ye);return ln(ve,ye,Ce),uo(ve)===0&&(ve=[0,1,0],ln(Ce,ye,ve)),ur(Ce,Ce),ur(ve,ve),ur(ye,ye),[Ce[0],Ce[1],Ce[2],0,ve[0],ve[1],ve[2],0,ye[0],ye[1],ye[2],0,oe[0],oe[1],oe[2],1]})(K);Ye(M,M,[q,q,q*F]),Ge(M,M,[-E[0],-E[1],-E[2]]);const re=Be([],_.globeMatrix,ne);return Be(re,re,M),Be(re,re,g),re})(a,r,o);if(u>0){const g=(function(_,b){const T=b.worldSize,E=fe(1,0)*T*Le(b.center.lat,b.zoom)/DS(T),A=fe(1,b.center.lat)*T,R=de([]);Mt(R,R,Fe(b.center.lng)),Ne(R,R,Fe(b.center.lat)),Ge(R,R,[0,0,p]),Ye(R,R,[E,E,E*A]);const M=b.point;return Ge(R,R,[-M.x,-M.y,0]),Be(R,R,_),Be(R,b.globeMatrix,R)})(a,r);return(function(_,b,T){const E=(B,W,q)=>{const K=ke(B),ne=ke(W),re=ed(B,W,q);return or(re,re,1/ke(re)*wn(K,ne,q))},A=E([_[0],_[1],_[2]],[b[0],b[1],b[2]],T),R=E([_[4],_[5],_[6]],[b[4],b[5],b[6]],T),M=E([_[8],_[9],_[10]],[b[8],b[9],b[10]],T),F=ed([_[12],_[13],_[14]],[b[12],b[13],b[14]],T);return[A[0],A[1],A[2],0,R[0],R[1],R[2],0,M[0],M[1],M[2],0,F[0],F[1],F[2],1]})(h,g,u)}return h}function ek(a,r,o,u){const h=kn.projectAabbCorners(u,o);let g=Number.MAX_VALUE,_=-1;for(let E=0;E<h.length;++E){const A=h[E];A[0]=(.5*A[0]+.5)*r.width,A[1]=(.5-.5*A[1])*r.height,A[2]<g&&(_=E,g=A[2])}const b=E=>new xt(h[E][0],h[E][1]);let T;switch(_){case 0:case 6:T=[b(1),b(5),b(4),b(7),b(3),b(2),b(1)];break;case 1:case 7:T=[b(0),b(4),b(5),b(6),b(2),b(3),b(0)];break;case 3:case 5:T=[b(1),b(0),b(4),b(7),b(6),b(2),b(1)];break;default:T=[b(1),b(5),b(6),b(7),b(3),b(0),b(1)]}if(va(a,T))return g}const Wf=64,Um={CoordinateSpaceTile:1,HasMapboxMeshFeatures:4,HasMeshoptCompression:8};function tk(a,r,o,u,h,g,_,b,T,E=!1){const A=o.zoom,R=o.project(u),M=Le(u.lat,A),F=1/M;de(a),Ge(a,a,[R.x+_[0]*F,R.y+_[1]*F,_[2]]);let B=1,W=1;const q=o.worldSize;if(E){if(o.projection.name==="mercator"){let oe=0;o.elevation&&(oe=o.elevation.getAtPointOrZero(new it(R.x/q,R.y/q),0));const ye=Zt([],[R.x,R.y,oe,1],o.projMatrix)[3]/o.cameraToCenterDistance;B=ye,W=ye*Le(o.center.lat,A)}else if(o.projection.name==="globe"){const oe=sE(a,o),ye=[0,0,0,1];Zt(ye,ye,Be([],o.projMatrix,oe));const ve=ye[3]/o.cameraToCenterDistance,Ce=ch(A),Oe=o.projection.pixelsPerMeter(u.lat,q)*Le(u.lat,A),De=o.projection.pixelsPerMeter(o.center.lat,q)*Le(o.center.lat,A);B=ve/wn(Oe,Ke(o.center.lat),Ce),W=ve*M/Oe,B*=De,W*=De}}else B=F;Ye(a,a,[B,B,W]);const K=[...a],ne=r.orientation,re=[];if(QR(re,[ne[0]+h[0],ne[1]+h[1],ne[2]+h[2]],g),Be(a,K,re),b&&o.elevation){let oe=0;const ye=[];if(T&&o.elevation){oe=(function(Ce,Oe,De,ut,Ue){const ht=Oe.elevation;if(!ht)return 0;const wt=kn.projectAabbCorners(De,ut),mt=fe(1,Ue.lat)*Oe.worldSize,yt=(function(Dt,dn){const Fn=[0,0,1],Vt=[{corners:[0,1,3,2],dotProductWithUp:0},{corners:[1,5,2,6],dotProductWithUp:0},{corners:[0,4,1,5],dotProductWithUp:0},{corners:[2,6,3,7],dotProductWithUp:0},{corners:[4,7,5,6],dotProductWithUp:0},{corners:[0,3,4,7],dotProductWithUp:0}];for(const tn of Vt){const An=Dt[tn.corners[0]],Nn=Dt[tn.corners[1]],er=Dt[tn.corners[2]],Un=[Nn[0]-An[0],Nn[1]-An[1],dn*(Nn[2]-An[2])],Xt=ln(Un,Un,[er[0]-An[0],er[1]-An[1],dn*(er[2]-An[2])]);ur(Xt,Xt),tn.dotProductWithUp=Ot(Xt,Fn)}return Vt.sort(((tn,An)=>tn.dotProductWithUp-An.dotProductWithUp)),Vt[0].corners})(wt,mt),Et=wt[yt[0]],lt=wt[yt[1]],vt=wt[yt[2]],rt=wt[yt[3]],Xe=ht.getAtPointOrZero(new it(Et[0]/Oe.worldSize,Et[1]/Oe.worldSize),0),Ct=ht.getAtPointOrZero(new it(lt[0]/Oe.worldSize,lt[1]/Oe.worldSize),0),Tt=ht.getAtPointOrZero(new it(vt[0]/Oe.worldSize,vt[1]/Oe.worldSize),0),hn=ht.getAtPointOrZero(new it(rt[0]/Oe.worldSize,rt[1]/Oe.worldSize),0),Ht=(Xe+hn)/2,Jt=(Ct+Tt)/2;return Ht>Jt?Ct<Tt?I1(Ce,lt,rt,Et,Ct,hn,Xe,mt):I1(Ce,vt,Et,rt,Tt,Xe,hn,mt):Xe<hn?I1(Ce,Et,lt,vt,Xe,Ct,Tt,mt):I1(Ce,rt,vt,lt,hn,Tt,Ct,mt),Math.max(Ht,Jt)})(ye,o,r.aabb,a,u);const ve=Be([],Se([],ye),re);Be(a,K,ve)}else oe=o.elevation.getAtPointOrZero(new it(R.x/q,R.y/q),0);oe!==0&&(a[14]+=oe)}}function Iy(a,r,o=!1){a.uploaded||(a.gfxTexture=new iE(r,a.image,o?r.gl.R8:r.gl.RGBA8,{useMipmap:a.sampler.minFilter>=r.gl.NEAREST_MIPMAP_NEAREST}),a.uploaded=!0,a.image=null)}function h$(a,r,o){a.indexBuffer=r.createIndexBuffer(a.indexArray,!1,!0),a.vertexBuffer=r.createVertexBuffer(a.vertexArray,o$.members,!1,!0),a.normalArray&&(a.normalBuffer=r.createVertexBuffer(a.normalArray,c$.members,!1,!0)),a.texcoordArray&&(a.texcoordBuffer=r.createVertexBuffer(a.texcoordArray,l$.members,!1,!0)),a.colorArray&&(a.colorBuffer=r.createVertexBuffer(a.colorArray,(a.colorArray.bytesPerElement===12?s$:a$).members,!1,!0)),a.featureArray&&(a.pbrBuffer=r.createVertexBuffer(a.featureArray,d$.members,!0)),a.segments=Bi.simpleSegment(0,0,a.vertexArray.length,a.indexArray.length);const u=a.material;u.pbrMetallicRoughness.baseColorTexture&&Iy(u.pbrMetallicRoughness.baseColorTexture,r),u.pbrMetallicRoughness.metallicRoughnessTexture&&Iy(u.pbrMetallicRoughness.metallicRoughnessTexture,r),u.normalTexture&&Iy(u.normalTexture,r),u.occlusionTexture&&Iy(u.occlusionTexture,r,o),u.emissionTexture&&Iy(u.emissionTexture,r)}function aE(a,r,o){if(a.meshes)for(const u of a.meshes)h$(u,r,o);if(a.children)for(const u of a.children)aE(u,r,o)}function A1(a){if(a.meshes)for(const r of a.meshes)r.indexArray.destroy(),r.vertexArray.destroy(),r.colorArray&&r.colorArray.destroy(),r.normalArray&&r.normalArray.destroy(),r.texcoordArray&&r.texcoordArray.destroy(),r.featureArray&&r.featureArray.destroy();if(a.children)for(const r of a.children)A1(r)}function lE(a){if(a.meshes)for(const o of a.meshes)o.vertexBuffer&&(o.vertexBuffer.destroy(),o.indexBuffer.destroy(),o.normalBuffer&&o.normalBuffer.destroy(),o.texcoordBuffer&&o.texcoordBuffer.destroy(),o.colorBuffer&&o.colorBuffer.destroy(),o.pbrBuffer&&o.pbrBuffer.destroy(),o.segments.destroy(),o.material&&((r=o.material).pbrMetallicRoughness.baseColorTexture&&r.pbrMetallicRoughness.baseColorTexture.gfxTexture&&r.pbrMetallicRoughness.baseColorTexture.gfxTexture.destroy(),r.pbrMetallicRoughness.metallicRoughnessTexture&&r.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture&&r.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture.destroy(),r.normalTexture&&r.normalTexture.gfxTexture&&r.normalTexture.gfxTexture.destroy(),r.emissionTexture&&r.emissionTexture.gfxTexture&&r.emissionTexture.gfxTexture.destroy(),r.occlusionTexture&&r.occlusionTexture.gfxTexture&&r.occlusionTexture.gfxTexture.destroy()));var r;if(a.children)for(const o of a.children)lE(o)}function qf(a,r){const o=a.json.bufferViews[r.bufferView],u=S1[r.componentType];return new u(a.buffers[o.buffer],(r.byteOffset||0)+(o.byteOffset||0),r.count*(o.byteStride&&o.byteStride!==Ey[r.type]*u.BYTES_PER_ELEMENT?o.byteStride/u.BYTES_PER_ELEMENT:Ey[r.type]))}function cE(a,r,o,u){const h=S1[r.componentType],g=(function(A){switch(A){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:return 1}})(h),_=a.json.bufferViews[r.bufferView],b=_.byteStride?_.byteStride/h.BYTES_PER_ELEMENT:Ey[r.type],T=o.float32,E=T.length/o.capacity;for(let A=0,R=0;A<r.count*b;A+=b,R+=E)for(let M=0;M<E;M++)T[R+M]=u[A+M]*g;o._trim()}function f$(a,r,o){const u=a.indices,h=a.attributes,g={};g.indexArray=new Mo;const _=r.json.accessors[u],b=_.count/3;g.indexArray.reserve(b);const T=qf(r,_);for(let M=0;M<b;M++)g.indexArray.emplaceBack(T[3*M],T[3*M+1],T[3*M+2]);g.indexArray._trim(),g.vertexArray=new Bs;const E=r.json.accessors[h.POSITION];g.vertexArray.reserve(E.count);const A=qf(r,E);for(let M=0;M<E.count;M++)g.vertexArray.emplaceBack(A[3*M],A[3*M+1],A[3*M+2]);if(g.vertexArray._trim(),g.aabb=new kn(E.min,E.max),g.centroid=(function(M,F){const B=[0,0,0],W=M.length;if(W>0){for(let q=0;q<W;q++){const K=3*M[q];B[0]+=F[K],B[1]+=F[K+1],B[2]+=F[K+2]}B[0]/=W,B[1]/=W,B[2]/=W}return B})(T,A),h.COLOR_0!==void 0){const M=r.json.accessors[h.COLOR_0],F=Ey[M.type],B=qf(r,M);g.colorArray=F===3?new Bs:new el,g.colorArray.resize(M.count),cE(r,M,g.colorArray,B)}if(h.NORMAL!==void 0){g.normalArray=new Bs;const M=r.json.accessors[h.NORMAL];g.normalArray.resize(M.count);const F=qf(r,M);cE(r,M,g.normalArray,F)}if(h.TEXCOORD_0!==void 0&&o.length>0){g.texcoordArray=new oh;const M=r.json.accessors[h.TEXCOORD_0];g.texcoordArray.resize(M.count);const F=qf(r,M);cE(r,M,g.texcoordArray,F)}if(h._FEATURE_ID_RGBA4444!==void 0){const M=r.json.accessors[h._FEATURE_ID_RGBA4444];r.json.extensionsUsed&&r.json.extensionsUsed.includes("EXT_meshopt_compression")&&(g.featureData=qf(r,M))}h._FEATURE_RGBA4444!==void 0&&(g.featureData=new Uint32Array(qf(r,r.json.accessors[h._FEATURE_RGBA4444]).buffer));const R=a.material;return g.material=(function(M,F){const{emissiveFactor:B=[0,0,0],alphaMode:W="OPAQUE",alphaCutoff:q=.5,normalTexture:K,occlusionTexture:ne,emissiveTexture:re,doubleSided:oe}=M,{baseColorFactor:ye=[1,1,1,1],metallicFactor:ve=1,roughnessFactor:Ce=1,baseColorTexture:Oe,metallicRoughnessTexture:De}=M.pbrMetallicRoughness||{},ut=ne?F[ne.index]:void 0;if(ne&&ne.extensions&&ne.extensions.KHR_texture_transform&&ut){const Ue=ne.extensions.KHR_texture_transform;ut.offsetScale=[Ue.offset[0],Ue.offset[1],Ue.scale[0],Ue.scale[1]]}return{pbrMetallicRoughness:{baseColorFactor:new Pr(...ye),metallicFactor:ve,roughnessFactor:Ce,baseColorTexture:Oe?F[Oe.index]:void 0,metallicRoughnessTexture:De?F[De.index]:void 0},doubleSided:oe,emissiveFactor:new Pr(...B),alphaMode:W,alphaCutoff:q,normalTexture:K?F[K.index]:void 0,occlusionTexture:ut,emissionTexture:re?F[re.index]:void 0,defined:M.defined===void 0}})(R!==void 0?r.json.materials[R]:{defined:!1},o),g}function nk(a,r,o){const{matrix:u,rotation:h,translation:g,scale:_,mesh:b,extras:T,children:E}=a,A={};if(A.matrix=u||(function(R,M,F,B){var W=M[0],q=M[1],K=M[2],ne=M[3],re=W+W,oe=q+q,ye=K+K,ve=W*re,Ce=W*oe,Oe=W*ye,De=q*oe,ut=q*ye,Ue=K*ye,ht=ne*re,wt=ne*oe,mt=ne*ye,yt=B[0],Et=B[1],lt=B[2];return R[0]=(1-(De+Ue))*yt,R[1]=(Ce+mt)*yt,R[2]=(Oe-wt)*yt,R[3]=0,R[4]=(Ce-mt)*Et,R[5]=(1-(ve+Ue))*Et,R[6]=(ut+ht)*Et,R[7]=0,R[8]=(Oe+wt)*lt,R[9]=(ut-ht)*lt,R[10]=(1-(ve+De))*lt,R[11]=0,R[12]=F[0],R[13]=F[1],R[14]=F[2],R[15]=1,R})([],h||[0,0,0,1],g||[0,0,0],_||[1,1,1]),b!==void 0){A.meshes=o[b];const R=A.anchor=[0,0];for(const M of A.meshes){const{min:F,max:B}=M.aabb;R[0]+=F[0]+B[0],R[1]+=F[1]+B[1]}R[0]=Math.floor(R[0]/A.meshes.length/2),R[1]=Math.floor(R[1]/A.meshes.length/2)}if(T&&(T.id&&(A.id=T.id),T.lights&&(A.lights=(function(R){if(!R.length)return[];const M=(function(K){const ne=atob(K),re=new Uint8Array(ne.length);for(let oe=0;oe<ne.length;oe++)re[oe]=ne.codePointAt(oe);return re})(R),F=[],B=M.length/24,W=new Uint16Array(M.buffer),q=new Float32Array(M.buffer);for(let K=0;K<B;K++){const ne=W[2*K*6]/30,re=W[2*K*6+1]/30,oe=W[2*K*6+10]/100,ye=q[6*K+1],ve=q[6*K+2],Ce=q[6*K+3],Oe=q[6*K+4],De=Ce-ye,ut=Oe-ve,Ue=Math.hypot(De,ut);F.push({pos:[ye+.5*De,ve+.5*ut,re],normal:[ut/Ue,-De/Ue,0],width:Ue,height:ne,depth:oe,points:[ye,ve,Ce,Oe]})}return F})(T.lights))),E){const R=[];for(const M of E)R.push(nk(r.json.nodes[M],r,o));A.children=R}return A}function p$(a){if(a.vertices.length===0||a.indices.length===0)return null;const r=new g1(a.vertices,a.indices,8,256),[o,u]=[r.min.clone(),r.max.clone()];return{vertices:a.vertices,indices:a.indices,grid:r,min:o,max:u}}function m$(a){if(!a.extras||!a.extras.ground)return null;const r=a.extras.ground;if(!r||!Array.isArray(r)||r.length===0)return null;const o=r[0];if(!o||!Array.isArray(o)||o.length===0)return null;const u=[];for(const _ of o){if(!Array.isArray(_)||_.length!==2)continue;const b=_[0],T=_[1];typeof b=="number"&&typeof T=="number"&&u.push(new xt(b,T))}if(u.length<3)return null;u.length>1&&u[u.length-1].equals(u[0])&&u.pop();let h=0;for(let _=0;_<u.length;_++){const b=u[_],T=u[(_+1)%u.length],E=u[(_+2)%u.length];h+=(b.x-T.x)*(E.y-T.y)-(E.x-T.x)*(b.y-T.y)}h>0&&u.reverse();const g=zm(u.flatMap((_=>[_.x,_.y])),[]);return g.length===0?null:{vertices:u,indices:g}}function g$(a,r){const o=[],u=[];let h=0;const g=[];for(const _ of a){h=o.length;const b=_.vertexArray.float32,T=_.indexArray.uint16;for(let E=0;E<_.vertexArray.length;E++)g[0]=b[3*E+0],g[1]=b[3*E+1],g[2]=b[3*E+2],vn(g,g,r),o.push(new xt(g[0],g[1]));for(let E=0;E<3*_.indexArray.length;E++)u.push(T[E]+h)}if(u.length%3!=0)return null;for(let _=0;_<u.length;_+=3){const b=o[u[_+0]],T=o[u[_+1]],E=o[u[_+2]];(b.x-T.x)*(E.y-T.y)-(E.x-T.x)*(b.y-T.y)>0&&([u[_+1],u[_+2]]=[u[_+2],u[_+1]])}return{vertices:o,indices:u}}function rk(a){const r=(function(T,E){const A=[],R=WebGL2RenderingContext;if(T.json.textures)for(const M of T.json.textures){const F={magFilter:R.LINEAR,minFilter:R.NEAREST,wrapS:R.REPEAT,wrapT:R.REPEAT};M.sampler!==void 0&&Object.assign(F,T.json.samplers[M.sampler]),A.push({image:E[M.source],sampler:F,uploaded:!1})}return A})(a,a.images),o=(function(T,E){const A=[];for(const R of T.json.meshes){const M=[];for(const F of R.primitives)M.push(f$(F,T,E));A.push(M)}return A})(a,r),{scenes:u,scene:h,nodes:g}=a.json,_=u?u[h||0].nodes:[...g.keys()],b=[];for(const T of _)b.push(nk(g[T],a,o));return(function(T,E,A){const R={},M=new Set;for(let F=0;F<T.length;F++){const B=A[E[F]];if(!B.extras)continue;const W=B.extras["mapbox:footprint:version"],q=B.extras["mapbox:footprint:id"];(W||q)&&M.add(F),W==="1.0.0"&&q&&(R[q]=F)}for(let F=0;F<T.length;F++){if(M.has(F))continue;const B=T[F],W=A[E[F]];if(!W.extras)continue;let q=null;B.id in R&&(q=g$(T[R[B.id]].meshes,B.matrix)),q||(q=m$(W)),q&&(B.footprint=p$(q))}if(M.size>0){const F=Array.from(M.values()).sort(((B,W)=>B-W));for(let B=F.length-1;B>=0;B--)T.splice(F[B],1)}})(b,_,a.json.nodes),b}function _$(a){a.heightmap=new Float32Array(4096),a.heightmap.fill(-1);const r=a.vertexArray.float32,o=a.aabb.min[0]-1,u=a.aabb.min[1]-1,h=Wf/(a.aabb.max[0]-o+2),g=Wf/(a.aabb.max[1]-u+2);for(let _=0;_<r.length;_+=3){const b=r[_+2],T=(r[_+0]-o)*h|0,E=(r[_+1]-u)*g|0;b>a.heightmap[E*Wf+T]&&(a.heightmap[E*Wf+T]=b)}}function ik(a,r,o,u,h){o.reserve(o.length+4*a.length),u.reserve(u.length+10*a.length),h.reserve(h.length+10*a.length);let g=u.length;for(const _ of a){const b=Math.min(10,Math.max(4,1.3*_.height))*r,T=[-_.normal[1],_.normal[0],0],E=Math.min(.29,.1*_.width/_.depth),A=_.width-2*_.depth*r*(E+.01),R=vr([],_.pos,T,A/2),M=vr([],_.pos,T,-A/2),F=[R[0],R[1],R[2]+_.height],B=[M[0],M[1],M[2]+_.height],W=vr([],_.normal,T,E);or(W,W,b);const q=vr([],_.normal,T,-E);or(q,q,b),mn(W,R,W),mn(q,M,q),R[2]+=.1,M[2]+=.1,u.emplaceBack(W[0],W[1],W[2]),u.emplaceBack(q[0],q[1],q[2]),u.emplaceBack(R[0],R[1],R[2]),u.emplaceBack(M[0],M[1],M[2]),u.emplaceBack(F[0],F[1],F[2]),u.emplaceBack(B[0],B[1],B[2]),u.emplaceBack(R[0],R[1],R[2]),u.emplaceBack(M[0],M[1],M[2]),u.emplaceBack(W[0],W[1],W[2]),u.emplaceBack(q[0],q[1],q[2]);const K=A/b/2;h.emplaceBack(-K-E,-1,K,.8),h.emplaceBack(K+E,-1,K,.8),h.emplaceBack(-K,0,K,1.3),h.emplaceBack(K,0,K,1.3),h.emplaceBack(K+E,-.8,K,.7),h.emplaceBack(K+E,-.8,K,.7),h.emplaceBack(0,0,K,1.3),h.emplaceBack(0,0,K,1.3),h.emplaceBack(K+E,-1.2,K,.8),h.emplaceBack(K+E,-1.2,K,.8),o.emplaceBack(6+g,4+g,8+g),o.emplaceBack(7+g,9+g,5+g),o.emplaceBack(0+g,1+g,2+g),o.emplaceBack(1+g,3+g,2+g),g+=10}}function y$(a,r){const o={};o.indexArray=new Mo,o.vertexArray=new Bs,o.colorArray=new el,ik(a,r,o.indexArray,o.vertexArray,o.colorArray);const u={defined:!0};u.emissiveFactor=Pr.black;const h={};return h.baseColorFactor=Pr.white,u.pbrMetallicRoughness=h,o.material=u,o.aabb=new kn([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),o}const ok=gr([{name:"a_pos_3f",components:3,type:"Float32"}]),v$=gr([{name:"a_normal_3",components:3,type:"Int16"}]),b$=gr([{name:"a_centroid_3",components:3,type:"Int16"}]),sk=gr([{name:"a_part_color_emissive",components:2,type:"Uint16"}]),x$=gr([{name:"a_faux_facade_color_emissive",components:2,type:"Uint16"}]),w$=gr([{name:"a_faux_facade_data",components:4,type:"Uint16"}]),T$=gr([{name:"a_faux_facade_vertical_range",components:2,type:"Uint16"}]),S$=gr([{name:"a_bloom_attenuation",components:4,type:"Float32"}]),ak=bt.types,uE=32767;function E$(a,r){const o=zt+r;for(const u of a)for(const h of u)if(h.x<-r||h.x>o||h.y<-r||h.y>o)return!1;return!0}class lk{constructor(){this.layoutVertexArray=new Bs,this.layoutAttenuationArray=new el,this.layoutColorArray=new Co,this.indexArray=new Mo,this.indexArrayForConflation=new Mo,this.segmentsBucket=new Bi}}class dE{constructor(){this.layoutVertexArray=new Bs,this.layoutNormalArray=new Zu,this.layoutCentroidArray=new Zu,this.layoutColorArray=new Co,this.layoutFacadePaintArray=null,this.layoutFacadeDataArray=null,this.layoutFacadeVerticalRangeArray=null,this.layoutAOArray=[],this.indexArray=new Mo,this.indexArrayForConflation=new Mo,this.segmentsBucket=new Bi,this.entranceBloom=new lk}}class ck{constructor(r){this.colorBufferUploaded=!1,this.maxHeight=0,this.replacementUpdateTime=0,this.activeReplacements=[],this.footprints=[],this.featuresOnBorder=[],this.buildingFeatures=[],this.buildingWithoutFacade=new dE,this.buildingWithFacade=new dE,this.indexArrayForConflationUploaded=!1,this.footprintLookup={},this.zoom=r.zoom,this.canonical=r.canonical,this.layers=r.layers,this.layerIds=this.layers.map((o=>o.fqid)),this.index=r.index,this.hasPattern=!1,this.worldview=r.worldview,this.lut=r.lut,this.buildingWithFacade.layoutFacadePaintArray=new Co,this.buildingWithFacade.layoutFacadeDataArray=new nh,this.buildingWithFacade.layoutFacadeVerticalRangeArray=new Co,this.programConfigurations=new tl(r.layers,{zoom:r.zoom,lut:r.lut}),this.stateDependentLayerIds=this.layers.filter((o=>o.isStateDependent())).map((o=>o.id)),this.projection=r.projection,this.groundEffect=new ZS(r)}updateFootprints(r,o){for(const u of this.footprints)o.push({footprint:u,id:r})}prepare(){return(function(){if(T1!=null||$R!=null)return null;if($m!=null)return $m;const r=fetch(Ho.BUILDING_GEN_URL);return $m=(function(o){let u,h,g,_;function b(){u=new Uint8Array(_.buffer),h=new Int32Array(_.buffer),g=new Float32Array(_.buffer)}function T(){throw new Error("Unexpected BuildingGen error.")}const E=()=>{},A={a:{a:T,f:function(R){const M=u.length,F=Math.max(R>>>0,Math.ceil(1.2*M)),B=Math.ceil((F-M)/65536);try{return _.grow(B),b(),!0}catch{return!1}},g:T,b:E,c:E,d:E,e:E}};return(WebAssembly.instantiateStreaming?WebAssembly.instantiateStreaming(o,A):o.then((R=>R.arrayBuffer())).then((R=>WebAssembly.instantiate(R,A)))).then((R=>{const M=R.instance.exports;return(0,M.g)(),_=M.f,b(),new J8({setStyle:M.h,setAOOptions:M.i,setMetricOptions:M.j,setStructuralOptions:M.k,setFacadeOptions:M.l,setFauxFacadeOptions:M.m,setFacadeClassifierOptions:M.n,addFeature:M.o,addFacade:M.p,generateMesh:M.q,getLastError:M.r,getOuterRingLength:M.s,getMeshCount:M.t,getPositionsPtr:M.u,getPositionsLength:M.v,getNormalsPtr:M.w,getNormalsLength:M.x,getColorsPtr:M.y,getColorsLength:M.z,getAOPtr:M.A,getAOLength:M.B,getUVPtr:M.C,getUVLength:M.D,getFauxFacadePtr:M.E,getFauxFacadeLength:M.F,getIndicesPtr:M.G,getIndicesLength:M.H,getBuildingPart:M.I,getRingCount:M.J,getRingPtr:M.K,getRingLength:M.L,free:M.M,malloc:M.N,heapU8:u,heap32:h,heapF32:g})}))})(r).then((o=>($m=null,T1=o,T1))).catch((o=>{cr("Could not load building-gen"),$m=null,$R=o})),$m})()}populate(r,o,u,h){const g=Q8();if(!g)return;const _=We(u);this.tileToMeter=_,this.brightness=o.brightness,g.setStyle({convertToMeters:!1,entranceColorRgb:[1,1,1],facadeGlazingColorRgb:[.5607843137254902,.6745098039215687,.7215686274509804],normalScale:[1,-1,_],ridgeHeight:3,roofColorRgb:[.886274516,.784313738,.713725507],tileToMeters:_,tileZoom:16,wallColorRgb:[.988235294,.933333337,.811764717]}),g.setAOOptions(!1,.3),g.setMetricOptions(!1,16),g.setStructuralOptions(!0),g.setFacadeClassifierOptions(3);const b=new Map;for(const{feature:T}of r){if(ak[T.type]!=="LineString")continue;const E=this.layers[0]._featureFilter.needGeometry,A=St(T,E);if(!this.layers[0]._featureFilter.filter(new pi(this.zoom),A,u))continue;const R=E?A.geometry:Ut(T,u,h),M=[];for(const q of R)for(const K of q)M.push({x:K.x,y:K.y});const F={coordinates:M,crossPerc:T.properties.cross_perc,distanceToRoad:T.properties.distance_to_road,entrances:T.properties.entrances,sourceId:0},B=T.properties.source_id;let W=b.get(B);W||(W=[],b.set(B,W)),W.push(F)}this.maxHeight=0;for(const{feature:T,index:E}of r){if(ak[T.type]==="LineString")continue;const A=this.layers[0]._featureFilter.needGeometry,R=St(T,A);if(!this.layers[0]._featureFilter.filter(new pi(this.zoom),R,u))continue;const M=A?R.geometry:Ut(T,u,h),F=gy(M,500);if(!E$(M,163))continue;const B=this.layers[0],W=B.layout.get("building-base").evaluate(T,{},u),q=B.layout.get("building-height").evaluate(T,{},u),K=B.layout.get("building-roof-shape").evaluate(T,{},u),ne=B.paint.get("building-ambient-occlusion-intensity"),re=B.paint.get("building-ambient-occlusion-ground-radius")/this.tileToMeter;if(K==="flat")continue;const oe=B.layout.get("building-facade").evaluate(T,{},u);g.setFacadeOptions(4,!0),g.setFauxFacadeOptions(oe,!1,1);const ye=T.properties.source_id;let ve;ve=b.has(ye)?b.get(ye):[];let Ce=0,Oe=0,De=0,ut=0,Ue=0,ht=0;if(oe){let Xt=Math.round(B.layout.get("building-facade-floors").evaluate(T,{},u));if(W===0){Xt=Math.max(1,Xt-(ve.length>0?1:0));let br=4;if(q>100){const ae=[10,13,15];br=ae[T.id?T.id%ae.length:0],g.setFacadeOptions(br,!0)}Ue=1.6803*br/_}else Ue=W/_;ht=q/_,Ue=Math.min(Ue,ht),De=B.layout.get("building-facade-unit-width").evaluate(T,{},u)/_,ut=(ht-Ue)/Xt,g.setFauxFacadeOptions(!0,!0,De);const Vn=B.layout.get("building-facade-window").evaluate(T,{},u);Ce=Vn[0],Oe=Vn[1]}const wt=[],mt=new xt(1/0,1/0),yt=new xt(-1/0,-1/0),Et=new xt(0,0);let lt=0;for(const Xt of F)if(Xt.length>0){const Vn=[];for(const br of Xt){const ae=[];for(let le=br.length-1;le>=0;le--){const et=br[le];ae.push({x:et.x,y:et.y}),mt.x=Math.min(mt.x,et.x),mt.y=Math.min(mt.y,et.y),yt.x=Math.max(yt.x,et.x),yt.y=Math.max(yt.y,et.y),Et.x+=et.x,Et.y+=et.y,lt++}Vn.push(ae)}wt.push({id:T.id?T.id:0,height:q,minHeight:W,sourceId:0,roofType:K,coordinates:Vn})}Et.x/=lt||1,Et.y/=lt||1;const vt=g.generateMesh(wt,ve);if(typeof vt=="string"){cr(`Unable to generate building ${T.id}: ${vt}`);continue}if(vt.meshes.length===0||vt.modifiedPolygonRings.length===0)continue;let rt=0;for(const Xt of vt.meshes)rt+=Xt.positions.length/3;const Xe=oe?this.buildingWithFacade:this.buildingWithoutFacade,Ct=Xe.segmentsBucket.prepareSegment(rt,Xe.layoutVertexArray,Xe.indexArray),Tt=[];let hn=null,Ht=0,Jt=-1;const Dt=Xe.indexArray.length;let dn=0;for(const Xt of vt.meshes){const Vn=Xe.layoutVertexArray.length;if(Xt.buildingPart==="entrance"){const ct=new Array;for(let _n=0;_n<Xt.indices.length;_n+=12){const tr=Xt.positions[_n+0],nr=Xt.positions[_n+1],Jn=Xt.positions[_n+3],Kr=Xt.positions[_n+4],Ii=Xt.positions[_n+2],Zn=Xt.positions[_n+8]-Ii,mi=1,Jr=Jn-tr,Dr=Kr-nr,_i=Math.hypot(Jr,Dr);ct.push({pos:[tr+.5*Jr,nr+.5*Dr,Ii],normal:[Dr/_i,-Jr/_i,0],width:_i,height:Zn,depth:mi,points:[tr,nr,Jn,Kr]})}const Nt=Xe.entranceBloom.segmentsBucket.prepareSegment(10*ct.length,Xe.entranceBloom.layoutVertexArray,Xe.entranceBloom.indexArray),Bt=Xe.entranceBloom.layoutVertexArray.length;Ht=Xe.entranceBloom.indexArray.length,ik(ct,.5/this.tileToMeter,Xe.entranceBloom.indexArray,Xe.entranceBloom.layoutVertexArray,Xe.entranceBloom.layoutAttenuationArray);const Kt=Xe.entranceBloom.layoutVertexArray.length-Bt;Jt=Xe.entranceBloom.indexArray.length-Ht;for(let _n=0;_n<Kt;_n++)Xe.entranceBloom.layoutColorArray.emplaceBack(65535,65535);Nt.vertexLength+=Kt,Nt.primitiveLength+=Jt,hn={part:Xt.buildingPart,vertexOffset:Bt,vertexLength:Kt}}for(let ct=0;ct<Xt.positions.length;ct+=3)dn=Math.max(dn,Xt.positions[ct+2]),Xe.layoutVertexArray.emplaceBack(Xt.positions[ct],Xt.positions[ct+1],Xt.positions[ct+2]);const br=Math.floor(Et.x),ae=Math.floor(Et.y),le=Math.floor(dn);for(let ct=0;ct<Xt.positions.length;ct+=3)Xe.layoutCentroidArray.emplaceBack(br,ae,le);for(let ct=0;ct<Xt.normals.length;ct+=3)Xe.layoutNormalArray.emplaceBack(Xt.normals[ct+0]*uE,Xt.normals[ct+1]*uE,Xt.normals[ct+2]*uE);for(let ct=0;ct<Xt.ao.length;ct++)Xe.layoutAOArray.push(Xt.ao[ct]);for(let ct=0;ct<Xt.colors.length;ct+=3){const Nt=1+(Xt.ao[ct/3]-1)*ne;Xe.layoutColorArray.emplaceBack(Xt.colors[ct]*Nt<<8|Xt.colors[ct+1]*Nt,Xt.colors[ct+2]*Nt<<8)}if(oe){for(let ct=0;ct<Xt.positions.length;ct+=3)Xe.layoutFacadePaintArray.emplaceBack(65535,255);for(let ct=0;ct<Xt.isFauxFacade.length;ct++)if(Xt.isFauxFacade[ct]){const Nt=1|Math.min(65535,Math.floor(Xt.uv[2*ct]*vt.outerRingLength)),Bt=Math.floor(255*Ce)<<8|Math.floor(255*Oe),Kt=Math.floor(65535*Math.min(1,De/zt)),_n=Math.floor(65535*Math.min(1,ut/zt));Xe.layoutFacadeDataArray.emplaceBack(Nt,Bt,Kt,_n);const tr=Math.floor(65535*Math.min(1,Ue/zt)),nr=Math.floor(65535*Math.min(1,ht/zt));Xe.layoutFacadeVerticalRangeArray.emplaceBack(tr,nr)}else Xe.layoutFacadeDataArray.emplaceBack(0,0,0,0),Xe.layoutFacadeVerticalRangeArray.emplaceBack(0,0)}const et=Ct.vertexLength;for(let ct=0;ct<Xt.indices.length;ct+=3)Xe.indexArray.emplaceBack(et+Xt.indices[ct],et+Xt.indices[ct+1],et+Xt.indices[ct+2]);Ct.vertexLength+=Xt.positions.length/3,Ct.primitiveLength+=Xt.indices.length/3,(Xt.buildingPart==="roof"||Xt.buildingPart==="wall"||Xt.buildingPart==="facade_glazing"||Xt.buildingPart==="entrance")&&Tt.push({part:Xt.buildingPart,vertexOffset:Vn,vertexLength:Xt.positions.length/3})}this.maxHeight=Math.max(this.maxHeight,dn),this.buildingFeatures.push({feature:R,hasFauxFacade:oe,segment:Ct,parts:Tt,buildingBloom:hn});const Fn=Xe.indexArray.length-Dt,Vt=[],tn=[],An=new xt(1/0,1/0),Nn=new xt(-1/0,-1/0),er=this.groundEffect.vertexArray.length;for(const Xt of vt.modifiedPolygonRings){const Vn=[],br=new xt(1/0,1/0),ae=new xt(-1/0,-1/0);for(let le=0;le<Xt.length;le+=2){const et=Xt.length-le-2;br.x=Math.min(br.x,Xt[et]),br.y=Math.min(br.y,Xt[et+1]),ae.x=Math.max(ae.x,Xt[et]),ae.y=Math.max(ae.y,Xt[et+1]);const ct=new xt(Xt[et],Xt[et+1]);Vn.push(ct),Vt.push(ct.x,ct.y),tn.push(ct.clone())}An.x=Math.min(An.x,br.x),An.y=Math.min(An.y,br.y),Nn.x=Math.max(Nn.x,ae.x),Nn.y=Math.max(Nn.y,ae.y),this.groundEffect.addData(Vn,[br,ae],re)}const Un=this.groundEffect.vertexArray.length-er;(mt.x<0||yt.x>zt||mt.y<0||yt.y>zt)&&this.featuresOnBorder.push({featureId:T.id,footprintIndex:this.footprints.length});{const Xt=zm(Vt,null,2),Vn=new g1(tn,Xt,8,256);let br=T.id;T.properties&&T.properties.hasOwnProperty("building_id")&&(br=T.properties.building_id),this.footprints.push({vertices:tn,indices:Xt,grid:Vn,min:An,max:Nn,buildingId:br,hiddenFlags:0,indicesOffset:Dt,indicesLength:Fn,bloomIndicesOffset:Ht,bloomIndicesLength:Jt,groundEffectVertexOffset:er,groundEffectVertexLength:Un,hasFauxFacade:oe,segment:Ct,height:dn})}this.programConfigurations.populatePaintArrays(Xe.layoutVertexArray.length,T,E,{},o.availableImages,u,o.brightness),this.groundEffect.addPaintPropertiesData(T,E,{},o.availableImages,u,o.brightness)}this.groundEffect.prepareBorderSegments(),this.evaluate(this.layers[0],{})}update(r,o,u,h,g,_,b){this.programConfigurations.updatePaintArrays(r,o,g,u,h,_,b),this.groundEffect.update(r,o,g,u,h,_,b),this.evaluate(this.layers[0],r),this.colorBufferUploaded=!1}isEmpty(){return this.buildingWithoutFacade.layoutVertexArray.length===0&&this.buildingWithFacade.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload||this.groundEffect.programConfigurations.needsUpload}upload(r){const o=u=>{u.layoutVertexBuffer=r.createVertexBuffer(u.layoutVertexArray,ok.members),u.layoutNormalBuffer=r.createVertexBuffer(u.layoutNormalArray,v$.members),u.layoutCentroidBuffer=r.createVertexBuffer(u.layoutCentroidArray,b$.members),u.layoutFacadeDataArray&&u.layoutFacadeDataArray.length&&(u.layoutFacadeDataBuffer=r.createVertexBuffer(u.layoutFacadeDataArray,w$.members)),u.layoutFacadeVerticalRangeArray&&u.layoutFacadeVerticalRangeArray.length&&(u.layoutFacadeVerticalRangeBuffer=r.createVertexBuffer(u.layoutFacadeVerticalRangeArray,T$.members)),u.entranceBloom.layoutVertexArray.length&&(u.entranceBloom.layoutVertexBuffer=r.createVertexBuffer(u.entranceBloom.layoutVertexArray,ok.members),u.entranceBloom.layoutAttenuationBuffer=r.createVertexBuffer(u.entranceBloom.layoutAttenuationArray,S$.members)),this.uploadUpdatedColorBuffer(r),this.uploadUpdatedIndexBuffer(r)};this.uploaded||(o(this.buildingWithoutFacade),o(this.buildingWithFacade),this.groundEffect.upload(r)),this.groundEffect.uploadPaintProperties(r),this.programConfigurations.upload(r),this.uploaded=!0}destroy(){const r=o=>{o.layoutVertexBuffer&&(o.layoutVertexBuffer.destroy(),o.layoutNormalBuffer.destroy(),o.layoutColorBuffer.destroy(),o.segmentsBucket.destroy(),o.indexBuffer&&o.indexBuffer.destroy(),o.entranceBloom.layoutVertexBuffer&&(o.entranceBloom.layoutVertexBuffer.destroy(),o.entranceBloom.layoutColorBuffer.destroy(),o.entranceBloom.layoutAttenuationBuffer.destroy(),o.entranceBloom.indexBuffer.destroy(),o.entranceBloom.segmentsBucket.destroy()))};r(this.buildingWithoutFacade),r(this.buildingWithFacade),this.groundEffect.destroy(),this.programConfigurations.destroy()}updateFootprintHiddenFlags(r,o,u=!0){let h=!1;const g=u?o:0,_=0|(u?-1:~o);this.groundEffect.hiddenByLandmarkVertexArray.length===0&&this.groundEffect.hiddenByLandmarkVertexArray.resize(this.groundEffect.vertexArray.length);for(const b of r){const T=this.footprints[b],E=T.hiddenFlags&_|g;T.hiddenFlags!==E&&(T.hiddenFlags=E,h=!0,this.groundEffect.updateHiddenByLandmarkRange(T.groundEffectVertexOffset,T.groundEffectVertexLength,T.hiddenFlags!==0))}return h&&(this.indexArrayForConflationUploaded=!1),h}uploadUpdatedIndexBuffer(r){if(this.groundEffect.uploadHiddenByLandmark(r),this.indexArrayForConflationUploaded)return;const o=h=>{h.indexArray.length!==0&&(h.indexArrayForConflation.resize(h.indexArray.length),h.indexArrayForConflation.uint16.set(h.indexArray.uint16),h.entranceBloom.indexArrayForConflation.resize(h.entranceBloom.indexArray.length),h.entranceBloom.indexArrayForConflation.uint16.set(h.entranceBloom.indexArray.uint16))};o(this.buildingWithoutFacade),o(this.buildingWithFacade);for(const h of this.footprints){const g=h.hasFauxFacade?this.buildingWithFacade:this.buildingWithoutFacade,_=h.indicesOffset+h.indicesLength;if(h.hiddenFlags!==0){for(let T=h.indicesOffset;T<_;T++)g.indexArrayForConflation.uint16[3*T+0]=0,g.indexArrayForConflation.uint16[3*T+1]=0,g.indexArrayForConflation.uint16[3*T+2]=0;const b=h.bloomIndicesOffset+h.bloomIndicesLength;for(let T=h.bloomIndicesOffset;T<b;T++)g.entranceBloom.indexArrayForConflation.uint16[3*T+0]=0,g.entranceBloom.indexArrayForConflation.uint16[3*T+1]=0,g.entranceBloom.indexArrayForConflation.uint16[3*T+2]=0}}const u=h=>{h.indexArray.length!==0&&(h.indexBuffer?h.indexBuffer.updateData(h.indexArrayForConflation):h.indexBuffer=r.createIndexBuffer(h.indexArrayForConflation,!0),h.entranceBloom.indexBuffer?h.entranceBloom.indexBuffer.updateData(h.entranceBloom.indexArrayForConflation):h.entranceBloom.indexBuffer=r.createIndexBuffer(h.entranceBloom.indexArrayForConflation,!0))};u(this.buildingWithoutFacade),u(this.buildingWithFacade),this.indexArrayForConflationUploaded=!0}uploadUpdatedColorBuffer(r){const o=u=>{u.layoutColorBuffer?u.layoutColorBuffer.updateData(u.layoutColorArray):u.layoutColorBuffer=r.createVertexBuffer(u.layoutColorArray,sk.members,!0),u.layoutFacadePaintArray&&(u.layoutFacadePaintBuffer?u.layoutFacadePaintBuffer.updateData(u.layoutFacadePaintArray):u.layoutFacadePaintBuffer=r.createVertexBuffer(u.layoutFacadePaintArray,x$.members,!0)),u.entranceBloom.layoutColorBuffer?u.entranceBloom.layoutColorBuffer.updateData(u.entranceBloom.layoutColorArray):u.entranceBloom.layoutColorBuffer=r.createVertexBuffer(u.entranceBloom.layoutColorArray,sk.members,!0)};o(this.buildingWithoutFacade),o(this.buildingWithFacade),this.colorBufferUploaded=!0}evaluate(r,o){const u=r.paint.get("building-ambient-occlusion-intensity");for(const h of this.buildingFeatures){const g=o[h.feature.id],_=h.feature;_.properties["building-part"]="roof";const b=r.paint.get("building-color").evaluate(_,g,this.canonical).toPremultipliedRenderColor(this.lut),T=r.paint.get("building-emissive-strength").evaluate(_,g,this.canonical);_.properties["building-part"]="wall";const E=r.paint.get("building-color").evaluate(_,g,this.canonical).toPremultipliedRenderColor(this.lut),A=r.paint.get("building-emissive-strength").evaluate(_,g,this.canonical);_.properties["building-part"]="window";const R=r.paint.get("building-color").evaluate(_,g,this.canonical).toPremultipliedRenderColor(this.lut),M=r.paint.get("building-emissive-strength").evaluate(_,g,this.canonical);_.properties["building-part"]="door";const F=r.paint.get("building-color").evaluate(_,g,this.canonical).toPremultipliedRenderColor(this.lut),B=r.paint.get("building-emissive-strength").evaluate(_,g,this.canonical),W=h.hasFauxFacade?this.buildingWithFacade:this.buildingWithoutFacade;for(const K of h.parts){let ne,re=b;K.part==="roof"?(re=b,ne=T):K.part==="wall"?(re=E,ne=A):K.part==="facade_glazing"?(re=R,ne=M):K.part==="entrance"&&(re=F,ne=B),ne=be(ne,0,1);for(let oe=0;oe<K.vertexLength;oe++){const ye=K.vertexOffset+oe,ve=1+(W.layoutAOArray[ye]-1)*u;W.layoutColorArray.emplace(ye,re.r*ve*255<<8|re.g*ve*255,re.b*ve*255<<8|255*ne),h.hasFauxFacade&&W.layoutFacadePaintArray.emplace(ye,255*R.r<<8|255*R.g,255*R.b<<8|255*M)}}const q=h.buildingBloom;if(q)for(let K=0;K<q.vertexLength;K++)W.entranceBloom.layoutColorArray.emplace(q.vertexOffset+K,255*F.r<<8|255*F.g,255*F.b<<8|51*B)}}needsEvaluation(){return!this.colorBufferUploaded}updateReplacement(r,o,u){if(o.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=o.updateTime;const h=o.getReplacementRegionsForTile(r.toUnwrapped());if(y1(this.activeReplacements,h))return;this.activeReplacements=h;for(const _ of this.footprints)_.hiddenFlags&=-2;const g=[];for(const _ of this.activeReplacements){if(_.order<=fR)continue;const b=Math.max(1,Math.pow(2,_.footprintTileId.canonical.z-r.canonical.z));for(const T of this.footprints)T.min.x>_.max.x||T.max.x<_.min.x||T.min.y>_.max.y||T.max.y<_.min.y||(g.length=0,C$(T.vertices,0,T.vertices.length,_.footprintTileId.canonical,r.canonical,g),HS(_.footprint,g,T.indices,0,T.indices.length,0,-b)&&(T.hiddenFlags|=1))}this.groundEffect.hiddenByLandmarkVertexArray.length===0&&this.groundEffect.hiddenByLandmarkVertexArray.resize(this.groundEffect.vertexArray.length);for(const _ of this.footprints)this.groundEffect.updateHiddenByLandmarkRange(_.groundEffectVertexOffset,_.groundEffectVertexLength,_.hiddenFlags!==0);this.indexArrayForConflationUploaded=!1}getHeightAtTileCoord(r,o){let u=Number.NEGATIVE_INFINITY,h=!0;const g=4*(r+zt)*zt+(o+zt);if(this.footprintLookup.hasOwnProperty(g)){const b=this.footprintLookup[g];return b?{height:b.height,hidden:b.hiddenFlags!==0}:void 0}const _=new xt(r,o);for(const b of this.footprints)r>b.max.x||b.min.x>r||o>b.max.y||b.min.y>o||b.height<=u||WS(_,b)&&(u=b.height,this.footprintLookup[g]=b,h=b.hiddenFlags!==0);if(u!==Number.NEGATIVE_INFINITY)return{height:u,hidden:h};this.footprintLookup[g]=void 0}}function C$(a,r,o,u,h,g){const _=Math.pow(2,u.z-h.z);for(let b=0;b<o;b++){let T=a[b+r].x,E=a[b+r].y;T=(T+h.x*zt)*_-u.x*zt,E=(E+h.y*zt)*_-u.y*zt,g.push(new xt(T,E))}}let uk,dk;Wt(ck,"BuildingBucket",{omit:["layers"]}),Wt(dE,"BuildingGeometry"),Wt(lk,"BuildingBloomGeometry");const I$=gr([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),A$=gr([{name:"a_z_offset_width",components:3,type:"Float32"}],4),{members:P$}=I$,R$=gr([{name:"a_packed",components:3,type:"Float32"}]),{members:k$}=R$,O$=gr([{name:"a_pattern_data",components:3,type:"Float32"}]),{members:M$}=O$;class hk{constructor(r,o){this.width=r,this.height=o,this.nextRow=0,this.image=new uh({width:r,height:o}),this.positions={},this.uploaded=!1}getDash(r,o){const u=this.getKey(r,o);return this.positions[u]}trim(){const r=this.width,o=this.height=on(this.nextRow);this.image.resize({width:r,height:o})}getKey(r,o){return r.join(",")+o}getDashRanges(r,o,u){const h=[];let g=r.length%2==1?-r[r.length-1]*u:0,_=r[0]*u,b=!0;h.push({left:g,right:_,isDash:b,zeroLength:r[0]===0});let T=r[0];for(let E=1;E<r.length;E++){b=!b;const A=r[E];g=T*u,T+=A,_=T*u,h.push({left:g,right:_,isDash:b,zeroLength:A===0})}return h}addRoundDash(r,o,u){const h=o/2;for(let g=-u;g<=u;g++){const _=this.width*(this.nextRow+u+g);let b=0,T=r[b];for(let E=0;E<this.width;E++){E/T.right>1&&(T=r[++b]);const A=Math.abs(E-T.left),R=Math.abs(E-T.right),M=Math.min(A,R);let F;const B=g/u*(h+1);if(T.isDash){const W=h-Math.abs(B);F=Math.sqrt(M*M+W*W)}else F=h-Math.sqrt(M*M+B*B);this.image.data[_+E]=Math.max(0,Math.min(255,F+128))}}}addRegularDash(r,o){for(let T=r.length-1;T>=0;--T){const E=r[T],A=r[T+1];E.zeroLength?r.splice(T,1):A&&A.isDash===E.isDash&&(A.left=E.left,r.splice(T,1))}const u=r[0],h=r[r.length-1];u.isDash===h.isDash&&(u.left=h.left-this.width,h.right=u.right+this.width);const g=this.width*this.nextRow;let _=0,b=r[_];for(let T=0;T<this.width;T++){T/b.right>1&&(b=r[++_]);const E=Math.abs(T-b.left),A=Math.abs(T-b.right),R=Math.min(E,A);this.image.data[g+T]=Math.max(0,Math.min(255,(b.isDash?R:-R)+o+128))}}addDash(r,o){const u=this.getKey(r,o);if(this.positions[u])return this.positions[u];const h=o==="round",g=h?7:0,_=2*g+1;if(this.nextRow+_>this.height)return cr("LineAtlas out of space"),null;r.length===0&&r.push(1);let b=0;for(let A=0;A<r.length;A++)r[A]<0&&(cr("Negative value is found in line dasharray, replacing values with 0"),r[A]=0),b+=r[A];if(b!==0){const A=this.width/b,R=this.getDashRanges(r,this.width,A);h?this.addRoundDash(R,A,g):this.addRegularDash(R,o==="square"?.5*A:0)}const T=this.nextRow+g;this.nextRow+=_;const E={tl:[T,g],br:[b,0]};return this.positions[u]=E,E}}Wt(hk,"LineAtlas");const D$=bt.types,L$=Math.cos(Math.PI/180*37.5),z$=Math.cos(Math.PI/180*5);class hE{constructor(r){this.evaluationGlobals={zoom:0,lineProgress:void 0},this.elevationType="none",this.zoom=r.zoom,this.evaluationGlobals.zoom=this.zoom,this.overscaling=r.overscaling,this.pixelRatio=r.pixelRatio,this.layers=r.layers,this.layerIds=this.layers.map((o=>o.fqid)),this.index=r.index,this.projection=r.projection,this.hasPattern=!1,this.hasCrossSlope=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach((o=>{this.gradients[o.id]={}})),this.layoutVertexArray=new Sm,this.layoutVertexArray2=new Bs,this.patternVertexArray=new Bs,this.indexArray=new Mo,this.programConfigurations=new tl(r.layers,{zoom:r.zoom,lut:r.lut}),this.segments=new Bi,this.maxLineLength=0,this.zOffsetVertexArray=new Bs,this.stateDependentLayerIds=this.layers.filter((o=>o.isStateDependent())).map((o=>o.id)),this.tessellationStep=r.tessellationStep?r.tessellationStep:zt/64,this.worldview=r.worldview}updateFootprints(r,o){}populate(r,o,u,h){this.hasPattern=NS("line",this.layers,this.pixelRatio,o);const g=this.layers[0].layout.get("line-sort-key");this.tileToMeter=We(u);const _=this.layers[0].layout.get("line-elevation-reference");if(_==="hd-road-markup")this.elevationType="road";else{const M=this.layers[0].layout.get("line-z-offset"),F=M.isConstant()&&!M.constantOr(0);this.elevationType=_!=="sea"&&_!=="ground"&&F?"none":"offset",this.elevationType==="offset"&&_==="none"&&cr(`line-elevation-reference: ground is used for the layer ${this.layerIds[0]} because non-zero line-z-offset value was found.`)}const b=this.layers[0].layout.get("line-cross-slope");this.hasCrossSlope=this.elevationType==="offset"&&b!==void 0;const T=[];for(const{feature:M,id:F,index:B,sourceLayerIndex:W}of r){const q=this.layers[0]._featureFilter.needGeometry,K=St(M,q);if(!this.layers[0]._featureFilter.filter(new pi(this.zoom,{worldview:this.worldview}),K,u))continue;const ne=g?g.evaluate(K,{},u):void 0,re={id:F,properties:M.properties,type:M.type,sourceLayerIndex:W,index:B,geometry:q?K.geometry:Ut(M,u,h),patterns:{},sortKey:ne};T.push(re)}g&&T.sort(((M,F)=>M.sortKey-F.sortKey));const{lineAtlas:E,featureIndex:A}=o,R=this.addConstantDashes(E);for(const M of T){const{geometry:F,index:B,sourceLayerIndex:W}=M;if(R&&this.addFeatureDashes(M,E),this.hasPattern){const q=VS("line",this.layers,M,this.zoom,this.pixelRatio,o);this.patternFeatures.push(q)}else this.addFeature(M,F,B,u,E.positions,o.availableImages,o.brightness,o.elevationFeatures);A.insert(r[B].feature,F,B,W,this.index)}}addConstantDashes(r){let o=!1;for(const u of this.layers){const h=u.paint.get("line-dasharray").value,g=u.layout.get("line-cap").value;if(h.kind!=="constant"||g.kind!=="constant")o=!0;else{const _=g.value,b=h.value;if(!b)continue;r.addDash(b,_)}}return o}addFeatureDashes(r,o){const u=this.zoom;for(const h of this.layers){const g=h.paint.get("line-dasharray").value,_=h.layout.get("line-cap").value;if(g.kind==="constant"&&_.kind==="constant")continue;let b,T;if(g.kind==="constant"){if(b=g.value,!b)continue}else b=g.evaluate({zoom:u},r);T=_.kind==="constant"?_.value:_.evaluate({zoom:u},r),o.addDash(b,T),r.patterns[h.id]=[o.getKey(b,T)]}}update(r,o,u,h,g,_,b,T){this.programConfigurations.updatePaintArrays(r,o,g,u,h,_,b,T)}addFeatures(r,o,u,h,g,_){for(const b of this.patternFeatures)this.addFeature(b,b.geometry,b.index,o,u,h,_)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(r){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=r.createVertexBuffer(this.layoutVertexArray2,k$)),this.patternVertexArray.length!==0&&(this.patternVertexBuffer=r.createVertexBuffer(this.patternVertexArray,M$)),!this.zOffsetVertexBuffer&&this.zOffsetVertexArray.length>0&&(this.zOffsetVertexBuffer=r.createVertexBuffer(this.zOffsetVertexArray,A$.members,!0)),this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,P$),this.indexBuffer=r.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(r),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.zOffsetVertexBuffer&&this.zOffsetVertexBuffer.destroy(),this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(r,o){let u,h;if(o&&o>0?(u=`mapbox_clip_start_${o}`,h=`mapbox_clip_end_${o}`):(u="mapbox_clip_start",h="mapbox_clip_end"),r.properties&&r.properties.hasOwnProperty(u)&&r.properties.hasOwnProperty(h))return{start:+r.properties[u],end:+r.properties[h]}}addFeature(r,o,u,h,g,_,b,T){const E=this.layers[0].layout,A=E.get("line-join").evaluate(r,{}),R=E.get("line-cap").evaluate(r,{}),M=E.get("line-miter-limit"),F=E.get("line-round-limit");this.lineClips=this.lineFeatureClips(r),this.lineFeature=r;const B=!(!r.properties||!r.properties.hasOwnProperty("mapbox_line_metrics"))&&r.properties.mapbox_line_metrics;this.zOffsetValue=E.get("line-z-offset").value;const W=this.layers[0].paint.get("line-width").value;if(W.kind!=="constant"&&W.isLineProgressConstant===!1&&(this.variableWidthValue=W),this.elevationType==="road"){const q=this.layoutVertexArray.length;if(!this.addElevatedRoadFeature(r,o,h,T,A,R,M,F)){const[K,ne]=this.clipRuntimeLinesToTile(o,1);for(let re=0;re<K.length;re++){const oe=K[re],ye=ne[re],ve={progress:{min:ye.progress.min,max:ye.progress.max},nextDir:this.computeSegNextDir(ye,oe),prevDir:this.computeSegPrevDir(ye,oe)};this.addLine(oe,r,h,A,R,M,F,ve,B&&ye.parentIndex>0?ye.parentIndex:null)}this.fillNonElevatedRoadSegment(q)}}else for(let q=0;q<o.length;q++)this.addLine(o[q],r,h,A,R,M,F,void 0,B&&q>0?q:null);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,r,u,g,_,h,b,void 0,this.worldview)}computeSegNextDir(r,o){return r.nextPoint.sub(o.at(-2)).unit()}computeSegPrevDir(r,o){return o[1].sub(r.prevPoint).unit()}clipLinesToTile(r,o){return x1(r,-o,-o,zt+o,zt+o)}clipRuntimeLinesToTile(r,o){const u=[];return[x1(r,-o,-o,zt+o,zt+o,u),u]}addElevatedRoadFeature(r,o,u,h,g,_,b,T){const E=[],A=ki.getElevationFeature(r,h);if(A){const R=this.clipLinesToTile(o,1),M=this.prepareElevatedLines(R,A,u);for(const F of M)E.push({geometry:F,elevation:A,elevationTileID:u,segment:{progress:{min:0,max:1},nextDir:void 0,prevDir:void 0}})}if(E.length===0)return!1;for(const R of E){const M=this.layoutVertexArray.length;this.addLine(R.geometry,r,u,g,_,b,T);const F=new yo(u,R.elevationTileID);if(R.elevation)for(let B=M;B<this.layoutVertexArray.length;B++){const W=new xt(this.layoutVertexArray.int16[6*B]>>1,this.layoutVertexArray.int16[6*B+1]>>1),q=F.pointElevation(W,R.elevation,.05);this.updateHeightRange(q),this.zOffsetVertexArray.emplaceBack(q,0,0)}else this.fillNonElevatedRoadSegment(M)}return!0}prepareElevatedLines(r,o,u){if(o.constantHeight!=null)return r;const h=[],g=1/We(u);for(const _ of r)Z8(_,new qr(o,g),0,h);return h}fillNonElevatedRoadSegment(r){for(let o=r;o<this.layoutVertexArray.length;o++)this.zOffsetVertexArray.emplaceBack(0,0,0)}updateHeightRange(r){this.heightRange?(this.heightRange.min=Math.min(this.heightRange.min,r),this.heightRange.max=Math.max(this.heightRange.max,r)):this.heightRange={min:r,max:r}}addLine(r,o,u,h,g,_,b,T,E){this.distance=0,this.prevDistance=0,this.scaledDistance=0,this.totalDistance=0,this.totalFeatureLength=0,this.lineSoFar=0,this.currentVertex=void 0,this.lineClips=E?this.lineFeatureClips(o,E):this.lineClips;const A=h==="none";this.patternJoinNone=this.hasPattern&&A,this.segmentStart=0,this.segmentStartf32=0,this.segmentPoints=[];const R=T&&T.progress.min>0,M=T&&T.progress.max<1;if(this.lineClips){let De={min:this.lineClips.start,max:this.lineClips.end},ut=1;if(T){const wt=this.lineClips.end-this.lineClips.start;De=(function(mt,yt,Et){return{min:ha(mt.min,yt,Et),max:ha(mt.max,yt,Et)}})(T.progress,{min:0,max:1},De),wt>0&&(ut=(De.max-De.min)/wt)}const Ue=+o.properties.mapbox_clip_feature_len,ht=+o.properties.mapbox_clip_seg_len;if(Number.isNaN(Ue)||Number.isNaN(ht)){for(let mt=0;mt<r.length-1;mt++)this.totalDistance+=r[mt].dist(r[mt+1]);const wt=this.totalDistance/(De.max-De.min);this.totalFeatureLength=Number.isFinite(wt)?wt:0,this.lineClips.start=De.min,this.lineClips.end=De.max,this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}else this.totalFeatureLength=Ue,this.distance=ht*ut,this.lineClips.start=De.min,this.lineClips.end=De.max,this.maxLineLength=Math.max(this.maxLineLength,this.distance);this.lineClipsArray.push(this.lineClips),this.updateScaledDistance()}const F=D$[o.type]==="Polygon";let B=r.length;for(;B>=2&&r[B-1].equals(r[B-2]);)B--;let W=0;for(;W<B-1&&r[W].equals(r[W+1]);)W++;if(B<(F?3:2))return;h==="bevel"&&(_=1.05);const q=this.segments.prepareSegment(10*B,this.layoutVertexArray,this.indexArray);let K,ne,re,oe,ye,ve,Ce,Oe;T&&T.prevDir&&(ve=T.prevDir.perp()),T&&T.nextDir&&(Ce=T.nextDir.perp()),this.e1=this.e2=-1,F&&(K=r[B-2],ye=r[W].sub(K)._unit()._perp());for(let De=W;De<B;De++){if(re=De===B-1?F?r[W+1]:void 0:r[De+1],re&&r[De].equals(re))continue;ye&&(oe=ye),K&&(ne=K),K=r[De],Oe=this.evaluateLineProgressFeatures(ne?ne.dist(K):0),ye=re?re.sub(K)._unit()._perp():oe,oe=oe||ye;const ut=ne&&re;let Ue=ut?h:F||A?"butt":g;const ht=oe.x*ye.x+oe.y*ye.y;if(A){const Xe=function(Ct){if(Ct.patternJoinNone){const Tt=Ct.segmentPoints.length/2,hn=Ct.lineSoFar-Ct.segmentStart;for(let Ht=0;Ht<Tt;++Ht){const Jt=Ct.segmentPoints[2*Ht+1],Dt=Math.round(Ct.segmentPoints[2*Ht])+.5+.25*Jt;Ct.patternVertexArray.emplaceBack(Dt,hn,Ct.segmentStart),Ct.patternVertexArray.emplaceBack(Dt,hn,Ct.segmentStart)}Ct.segmentPoints.length=0}Ct.e1=Ct.e2=-1};if(ut&&ht<z$){this.updateDistance(ne,K),this.addCurrentVertex(K,oe,1,1,q,Oe),Xe(this),this.addCurrentVertex(K,ye,-1,-1,q,Oe);continue}if(ne){if(!re){this.updateDistance(ne,K),this.addCurrentVertex(K,oe,1,1,q,Oe),Xe(this);continue}Ue="miter"}}let wt=oe.add(ye);wt.x===0&&wt.y===0||wt._unit();const mt=wt.x*ye.x+wt.y*ye.y,yt=mt!==0?1/mt:1/0,Et=2*Math.sqrt(2-2*mt),lt=mt<L$&&ne&&re,vt=oe.x*ye.y-oe.y*ye.x>0,rt=this.overscaling<=16?15*zt/(512*this.overscaling):0;if(ut&&Ue==="round"){if(yt<b)Ue="miter";else if(yt<=2){const Xe=fE(K,-10,zt+10);Ue=this.elevationType==="offset"&&(Xe||this.hasCrossSlope)?"miter":"fakeround"}}if(Ue==="miter"&&yt>_&&(Ue="bevel"),Ue==="bevel"&&(yt>2&&(Ue="flipbevel"),yt<_&&(Ue="miter")),ne&&!(Ue==="miter"&&lt)&&this.updateDistance(ne,K),Ue==="miter")if(lt){const Xe=K.dist(ne);if(Xe>2*rt){const Tt=K.sub(K.sub(ne)._mult(rt/Xe)._round());this.updateDistance(ne,Tt),this.addCurrentVertex(Tt,oe,0,0,q,Oe),ne=Tt}this.updateDistance(ne,K),wt._mult(yt),this.addCurrentVertex(K,wt,0,0,q,Oe);const Ct=K.dist(re);if(Ct>2*rt){const Tt=K.add(re.sub(K)._mult(rt/Ct)._round());this.updateDistance(K,Tt),this.addCurrentVertex(Tt,ye,0,0,q,Oe),K=Tt}}else wt._mult(yt),this.addCurrentVertex(K,wt,0,0,q,Oe);else if(Ue==="flipbevel"){if(yt>100)wt=ye.mult(-1);else{const Xe=yt*oe.add(ye).mag()/oe.sub(ye).mag();wt._perp()._mult(Xe*(vt?-1:1))}this.addCurrentVertex(K,wt,0,0,q,Oe),this.addCurrentVertex(K,wt.mult(-1),0,0,q,Oe)}else if(Ue==="bevel"||Ue==="fakeround"){Oe!=null&&ne&&this.addCurrentVertex(K,Ce||oe,-1,-1,q,Oe);const Xe=K.dist(ne)<=2*rt&&Ue!=="bevel",Ct=wt.mult(vt?1:-1);Ct._mult(yt);const Tt=ye.mult(vt?-1:1),hn=oe.mult(vt?-1:1),Ht=this.evaluateLineProgressFeatures(this.distance);if(Oe==null&&(this.addHalfVertex(K,Ct.x,Ct.y,!1,!vt,0,q,Ht),Xe||this.addHalfVertex(K,Ct.x+2*hn.x,Ct.y+2*hn.y,!1,vt,0,q,Ht)),Ue==="fakeround"){const Jt=Math.round(180*Et/Math.PI/20);this.addHalfVertex(K,hn.x,hn.y,!1,vt,0,q,Ht);for(let Dt=0;Dt<Jt;Dt++){let dn=Dt/Jt;if(dn!==.5){const Vt=dn-.5;dn+=dn*Vt*(dn-1)*((1.0904+ht*(ht*(3.55645-1.43519*ht)-3.2452))*Vt*Vt+(.848013+ht*(.215638*ht-1.06021)))}const Fn=Tt.sub(hn)._mult(dn)._add(hn)._unit();this.addHalfVertex(K,Fn.x,Fn.y,!1,vt,0,q,Ht)}this.addHalfVertex(K,Tt.x,Tt.y,!1,vt,0,q,Ht)}Xe||Oe!=null||this.addHalfVertex(K,Ct.x+2*Tt.x,Ct.y+2*Tt.y,!1,vt,0,q,Ht),Oe!=null&&re&&this.addCurrentVertex(K,ve||ye,1,1,q,Oe)}else if(Ue==="butt")this.addCurrentVertex(K,wt,0,0,q,Oe);else if(Ue==="square"){if(!ne){const Xe=R?0:-1;this.addCurrentVertex(K,wt,Xe,Xe,q,Oe)}if(this.addCurrentVertex(K,wt,0,0,q,Oe),ne){const Xe=M?0:1;this.addCurrentVertex(K,wt,Xe,Xe,q,Oe)}}else if(Ue==="round"){if(ne){const Xe=!ut&&Ce?Ce:oe;this.addCurrentVertex(K,Xe,0,0,q,Oe),!ut&&M||this.addCurrentVertex(K,Xe,1,1,q,Oe,!0)}if(re){const Xe=!ut&&ve?ve:ye;!ut&&R||this.addCurrentVertex(K,Xe,-1,-1,q,Oe,!0),this.addCurrentVertex(K,Xe,0,0,q,Oe)}}}}addVerticesTo(r,o,u,h,g,_,b,T,E,A){const R=(o.w-r.w)/this.tessellationStep|0;let M=0;const F=this.scaledDistance;if(R>1){this.lineSoFar=r.w;const W=(o.x-r.x)/R,q=(o.y-r.y)/R,K=(o.z-r.z)/R,ne=(o.w-r.w)/R;for(let re=1;re<R;++re){r.x+=W,r.y+=q,r.z+=K,this.lineSoFar+=ne,M+=ne;const oe=this.evaluateLineProgressFeatures(this.prevDistance+M);this.scaledDistance=(this.prevDistance+M)/this.totalDistance,this.addHalfVertex(r,u,h,A,!1,b,E,oe),this.addHalfVertex(r,g,_,A,!0,-T,E,oe)}}this.lineSoFar=o.w,this.scaledDistance=F;const B=this.evaluateLineProgressFeatures(this.distance);this.addHalfVertex(o,u,h,A,!1,b,E,B),this.addHalfVertex(o,g,_,A,!0,-T,E,B)}evaluateLineProgressFeatures(r){if(!this.variableWidthValue&&this.elevationType!=="offset")return null;this.evaluationGlobals.lineProgress=0,this.lineClips?this.evaluationGlobals.lineProgress=Math.min(1,(this.totalFeatureLength*this.lineClips.start+r)/this.totalFeatureLength):cr(`line-progress evaluation for ${this.layerIds[0]} requires enabling 'lineMetrics' for the source.`);let o=0;return this.variableWidthValue&&this.variableWidthValue.kind!=="constant"&&(o=this.variableWidthValue.evaluate(this.evaluationGlobals,this.lineFeature)||0),this.elevationType!=="offset"?{zOffset:0,variableWidth:o}:this.zOffsetValue.kind==="constant"?{zOffset:this.zOffsetValue.value,variableWidth:o}:{zOffset:this.zOffsetValue.evaluate(this.evaluationGlobals,this.lineFeature)||0,variableWidth:o}}addCurrentVertex(r,o,u,h,g,_,b=!1){const T=o.x+o.y*u,E=o.y-o.x*u,A=o.y*h-o.x,R=-o.y-o.x*h;if(_!=null){const M=this.elevationType==="offset",F=-10,B=zt+10,W=_.zOffset,q=new DR(r.x,r.y,W,this.lineSoFar),K=!!M&&fE(r,F,B),ne=this.lineSoFar,re=this.distance;if(this.currentVertex)if(K){const oe=this.currentVertexIsOutside,ye=this.currentVertex,ve=new DR(r.x,r.y,W,this.lineSoFar);if(zR(ye,ve,F,B),!fE(ve,F,B)){if(oe){this.e1=this.e2=-1,this.distance-=ye.dist(q),this.lineSoFar=ye.w;const Ce=this.evaluateLineProgressFeatures(ye.w-this.totalFeatureLength*(this.lineClips?this.lineClips.start:0));this.addHalfVertex(ye,T,E,b,!1,u,g,Ce),this.addHalfVertex(ye,A,R,b,!0,-h,g,Ce),this.prevDistance=this.distance}this.distance=this.prevDistance+ye.dist(ve),this.scaledDistance=this.distance/this.totalDistance,this.addVerticesTo(ye,ve,T,E,A,R,u,h,g,b),this.distance=re,this.scaledDistance=this.distance/this.totalDistance}}else{const oe=this.currentVertex;if(this.currentVertexIsOutside){zR(oe,q,F,B),this.e1=this.e2=-1,this.distance-=oe.dist(q),this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=oe.w;const ye=this.evaluateLineProgressFeatures(oe.w-this.totalFeatureLength*(this.lineClips?this.lineClips.start:0));this.addHalfVertex(oe,T,E,b,!1,u,g,ye),this.addHalfVertex(oe,A,R,b,!0,-h,g,ye),this.prevDistance=this.distance,this.distance=re,this.scaledDistance=this.distance/this.totalDistance}this.addVerticesTo(oe,q,T,E,A,R,u,h,g,b)}else K||(this.addHalfVertex(r,T,E,b,!1,u,g,_),this.addHalfVertex(r,A,R,b,!0,-h,g,_));this.currentVertex=q,this.currentVertexIsOutside=K,this.lineSoFar=ne}else this.addHalfVertex(r,T,E,b,!1,u,g,_),this.addHalfVertex(r,A,R,b,!0,-h,g,_)}addHalfVertex({x:r,y:o},u,h,g,_,b,T,E){if(this.patternJoinNone&&(this.segmentPoints.length===0&&(this.segmentStart=this.lineSoFar,this.segmentStartf32=Math.fround(this.lineSoFar)),_||this.segmentPoints.push(this.lineSoFar-this.segmentStart,b)),this.layoutVertexArray.emplaceBack((r<<1)+(g?1:0),(o<<1)+(_?1:0),Math.round(63*u)+128,Math.round(63*h)+128,1+(b===0?0:b<0?-1:1),0,this.lineSoFar-this.segmentStartf32),this.lineClips){const R=wn(this.lineClips.start,this.lineClips.end,this.scaledDistance);this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,R)}const A=T.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,A),T.primitiveLength++),_?this.e2=A:this.e1=A,E!=null&&this.zOffsetVertexArray.emplaceBack(E.zOffset,E.variableWidth,E.variableWidth)}updateScaledDistance(){this.lineClips?(this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=this.totalFeatureLength*this.lineClips.start+this.distance):this.lineSoFar=this.distance}updateDistance(r,o){this.prevDistance=this.distance,this.distance+=r.dist(o),this.updateScaledDistance()}}function fE(a,r,o){return a.x<r||a.x>o||a.y<r||a.y>o}let fk,pk;function mk(a,r,o){return r*(zt/(a.tileSize*Math.pow(2,o-a.tileID.overscaledZ)))}Wt(hE,"LineBucket",{omit:["layers","patternFeatures","currentVertex","currentVertexIsOutside"]});const gk=(a,r,o)=>(1-o)*a+o*r;function _k(a,r){return 1/mk(a,1,r.tileZoom)}function yk(a,r,o,u){return a.translatePosMatrix(u||r.tileID.projMatrix,r,o.paint.get("line-translate"),o.paint.get("line-translate-anchor"))}const vk=a=>{const r=[];bk(a)&&r.push("RENDER_LINE_DASH"),a.paint.get("line-gradient")&&r.push("RENDER_LINE_GRADIENT");const o=a.paint.get("line-trim-offset");o[0]===0&&o[1]===0||r.push("RENDER_LINE_TRIM_OFFSET"),a.paint.get("line-border-width").constantOr(1)!==0&&r.push("RENDER_LINE_BORDER");const u=a.layout.get("line-join").constantOr("miter")==="none",h=!!a.paint.get("line-pattern").constantOr(1);return u&&h&&r.push("LINE_JOIN_NONE"),r};function bk(a){const r=a.paint.get("line-dasharray").value;return r.kind!=="constant"||r.value}let pE;const xk=()=>pE||(pE={layout:fk||(fk=new Wi({"line-cap":new $t($e.layout_line["line-cap"]),"line-join":new $t($e.layout_line["line-join"]),"line-miter-limit":new It($e.layout_line["line-miter-limit"]),"line-round-limit":new It($e.layout_line["line-round-limit"]),"line-sort-key":new $t($e.layout_line["line-sort-key"]),"line-z-offset":new $t($e.layout_line["line-z-offset"]),"line-elevation-reference":new It($e.layout_line["line-elevation-reference"]),"line-cross-slope":new It($e.layout_line["line-cross-slope"]),visibility:new It($e.layout_line.visibility),"line-width-unit":new It($e.layout_line["line-width-unit"])})),paint:pk||(pk=new Wi({"line-opacity":new $t($e.paint_line["line-opacity"]),"line-color":new $t($e.paint_line["line-color"]),"line-translate":new It($e.paint_line["line-translate"]),"line-translate-anchor":new It($e.paint_line["line-translate-anchor"]),"line-width":new $t($e.paint_line["line-width"]),"line-gap-width":new $t($e.paint_line["line-gap-width"]),"line-offset":new $t($e.paint_line["line-offset"]),"line-blur":new $t($e.paint_line["line-blur"]),"line-dasharray":new $t($e.paint_line["line-dasharray"]),"line-pattern":new $t($e.paint_line["line-pattern"]),"line-pattern-cross-fade":new It($e.paint_line["line-pattern-cross-fade"]),"line-gradient":new Jd($e.paint_line["line-gradient"]),"line-trim-offset":new It($e.paint_line["line-trim-offset"]),"line-trim-fade-range":new It($e.paint_line["line-trim-fade-range"]),"line-trim-color":new It($e.paint_line["line-trim-color"]),"line-emissive-strength":new It($e.paint_line["line-emissive-strength"]),"line-border-width":new $t($e.paint_line["line-border-width"]),"line-border-color":new $t($e.paint_line["line-border-color"]),"line-occlusion-opacity":new It($e.paint_line["line-occlusion-opacity"]),"line-color-use-theme":new $t({type:"string",default:"default","property-type":"data-driven"}),"line-gradient-use-theme":new $t({type:"string",default:"default","property-type":"data-driven"}),"line-trim-color-use-theme":new $t({type:"string",default:"default","property-type":"data-driven"}),"line-border-color-use-theme":new $t({type:"string",default:"default","property-type":"data-driven"})}))},pE);class F$ extends $t{possiblyEvaluate(r,o){return o=new pi(Math.floor(o.zoom),{now:o.now,fadeDuration:o.fadeDuration,transition:o.transition,worldview:o.worldview}),super.possiblyEvaluate(r,o)}evaluate(r,o,u,h){return o=Object.assign({},o,{zoom:Math.floor(o.zoom)}),super.evaluate(r,o,u,h)}}let Ay;function wk(a,r){return r>0?r+2*a:a}const B$=gr([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),N$=gr([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),V$=gr([{name:"a_projected_pos",components:4,type:"Float32"}],4);gr([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const $$=gr([{name:"a_auto_z_offset",components:1,type:"Float32"}],4),U$=gr([{name:"a_x_axis",components:3,type:"Float32"},{name:"a_y_axis",components:3,type:"Float32"}]),j$=gr([{name:"a_texb",components:2,type:"Uint16"}]),G$=gr([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_elevation_from_sea",components:2,type:"Float32"}]),H$=gr([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"},{name:"a_auto_z_offset",components:1,type:"Float32"}]);gr([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const Tk=gr([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),W$=gr([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);gr([{name:"triangle",components:3,type:"Uint16"}]),gr([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),gr([{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Float32",name:"zOffset"},{type:"Uint8",name:"hasIconTextFit"},{type:"Uint16",name:"elevationFeatureIndex"}]),gr([{type:"Float32",name:"offsetX"}]),gr([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);var Zo=24;function q$(a,r,o){return a.sections.forEach((u=>{u.text=(function(h,g,_){const b=g.layout.get("text-transform").evaluate(_,{});return b==="uppercase"?h=h.toLocaleUpperCase():b==="lowercase"&&(h=h.toLocaleLowerCase()),El.applyArabicShaping&&(h=El.applyArabicShaping(h)),h})(u.text,r,o)})),a}const Py={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};function K$(a){return a===""||a===""||a===""||a===""||a===""||a===""||a===""||a===""||a===""||a===""||a===""||a===""||a===""||a===""||a===""||a===""||a===""}function Z$(a){return a===""||a===""||a===""||a===""||a===""||a===""||a===""||a===""||a===""||a===""}const mE=4294967296,Sk=1/mE,Ek=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");let P1=class{constructor(a=new Uint8Array(16)){this.buf=ArrayBuffer.isView(a)?a:new Uint8Array(a),this.dataView=new DataView(this.buf.buffer),this.pos=0,this.type=0,this.length=this.buf.length}readFields(a,r,o=this.length){for(;this.pos<o;){const u=this.readVarint(),h=u>>3,g=this.pos;this.type=7&u,a(h,r,this),this.pos===g&&this.skip(u)}return r}readMessage(a,r){return this.readFields(a,r,this.readVarint()+this.pos)}readFixed32(){const a=this.dataView.getUint32(this.pos,!0);return this.pos+=4,a}readSFixed32(){const a=this.dataView.getInt32(this.pos,!0);return this.pos+=4,a}readFixed64(){const a=this.dataView.getUint32(this.pos,!0)+this.dataView.getUint32(this.pos+4,!0)*mE;return this.pos+=8,a}readSFixed64(){const a=this.dataView.getUint32(this.pos,!0)+this.dataView.getInt32(this.pos+4,!0)*mE;return this.pos+=8,a}readFloat(){const a=this.dataView.getFloat32(this.pos,!0);return this.pos+=4,a}readDouble(){const a=this.dataView.getFloat64(this.pos,!0);return this.pos+=8,a}readVarint(a){const r=this.buf;let o,u;return u=r[this.pos++],o=127&u,u<128?o:(u=r[this.pos++],o|=(127&u)<<7,u<128?o:(u=r[this.pos++],o|=(127&u)<<14,u<128?o:(u=r[this.pos++],o|=(127&u)<<21,u<128?o:(u=r[this.pos],o|=(15&u)<<28,(function(h,g,_){const b=_.buf;let T,E;if(E=b[_.pos++],T=(112&E)>>4,E<128||(E=b[_.pos++],T|=(127&E)<<3,E<128)||(E=b[_.pos++],T|=(127&E)<<10,E<128)||(E=b[_.pos++],T|=(127&E)<<17,E<128)||(E=b[_.pos++],T|=(127&E)<<24,E<128)||(E=b[_.pos++],T|=(1&E)<<31,E<128))return jm(h,T,g);throw new Error("Expected varint not more than 10 bytes")})(o,a,this)))))}readVarint64(){return this.readVarint(!0)}readSVarint(){const a=this.readVarint();return a%2==1?(a+1)/-2:a/2}readBoolean(){return!!this.readVarint()}readString(){const a=this.readVarint()+this.pos,r=this.pos;return this.pos=a,a-r>=12&&Ek?Ek.decode(this.buf.subarray(r,a)):(function(o,u,h){let g="",_=u;for(;_<h;){const b=o[_];let T,E,A,R=null,M=b>239?4:b>223?3:b>191?2:1;if(_+M>h)break;M===1?b<128&&(R=b):M===2?(T=o[_+1],(192&T)==128&&(R=(31&b)<<6|63&T,R<=127&&(R=null))):M===3?(T=o[_+1],E=o[_+2],(192&T)==128&&(192&E)==128&&(R=(15&b)<<12|(63&T)<<6|63&E,(R<=2047||R>=55296&&R<=57343)&&(R=null))):M===4&&(T=o[_+1],E=o[_+2],A=o[_+3],(192&T)==128&&(192&E)==128&&(192&A)==128&&(R=(15&b)<<18|(63&T)<<12|(63&E)<<6|63&A,(R<=65535||R>=1114112)&&(R=null))),R===null?(R=65533,M=1):R>65535&&(R-=65536,g+=String.fromCharCode(R>>>10&1023|55296),R=56320|1023&R),g+=String.fromCharCode(R),_+=M}return g})(this.buf,r,a)}readBytes(){const a=this.readVarint()+this.pos,r=this.buf.subarray(this.pos,a);return this.pos=a,r}readPackedVarint(a=[],r){const o=this.readPackedEnd();for(;this.pos<o;)a.push(this.readVarint(r));return a}readPackedSVarint(a=[]){const r=this.readPackedEnd();for(;this.pos<r;)a.push(this.readSVarint());return a}readPackedBoolean(a=[]){const r=this.readPackedEnd();for(;this.pos<r;)a.push(this.readBoolean());return a}readPackedFloat(a=[]){const r=this.readPackedEnd();for(;this.pos<r;)a.push(this.readFloat());return a}readPackedDouble(a=[]){const r=this.readPackedEnd();for(;this.pos<r;)a.push(this.readDouble());return a}readPackedFixed32(a=[]){const r=this.readPackedEnd();for(;this.pos<r;)a.push(this.readFixed32());return a}readPackedSFixed32(a=[]){const r=this.readPackedEnd();for(;this.pos<r;)a.push(this.readSFixed32());return a}readPackedFixed64(a=[]){const r=this.readPackedEnd();for(;this.pos<r;)a.push(this.readFixed64());return a}readPackedSFixed64(a=[]){const r=this.readPackedEnd();for(;this.pos<r;)a.push(this.readSFixed64());return a}readPackedEnd(){return this.type===2?this.readVarint()+this.pos:this.pos+1}skip(a){const r=7&a;if(r===0)for(;this.buf[this.pos++]>127;);else if(r===2)this.pos=this.readVarint()+this.pos;else if(r===5)this.pos+=4;else{if(r!==1)throw new Error(`Unimplemented type: ${r}`);this.pos+=8}}writeTag(a,r){this.writeVarint(a<<3|r)}realloc(a){let r=this.length||16;for(;r<this.pos+a;)r*=2;if(r!==this.length){const o=new Uint8Array(r);o.set(this.buf),this.buf=o,this.dataView=new DataView(o.buffer),this.length=r}}finish(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)}writeFixed32(a){this.realloc(4),this.dataView.setInt32(this.pos,a,!0),this.pos+=4}writeSFixed32(a){this.realloc(4),this.dataView.setInt32(this.pos,a,!0),this.pos+=4}writeFixed64(a){this.realloc(8),this.dataView.setInt32(this.pos,-1&a,!0),this.dataView.setInt32(this.pos+4,Math.floor(a*Sk),!0),this.pos+=8}writeSFixed64(a){this.realloc(8),this.dataView.setInt32(this.pos,-1&a,!0),this.dataView.setInt32(this.pos+4,Math.floor(a*Sk),!0),this.pos+=8}writeVarint(a){(a=+a||0)>268435455||a<0?(function(r,o){let u,h;if(r>=0?(u=r%4294967296|0,h=r/4294967296|0):(u=~(-r%4294967296),h=~(-r/4294967296),4294967295^u?u=u+1|0:(u=0,h=h+1|0)),r>=18446744073709552e3||r<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");o.realloc(10),(function(g,_,b){b.buf[b.pos++]=127&g|128,g>>>=7,b.buf[b.pos++]=127&g|128,g>>>=7,b.buf[b.pos++]=127&g|128,g>>>=7,b.buf[b.pos++]=127&g|128,b.buf[b.pos]=127&(g>>>=7)})(u,0,o),(function(g,_){const b=(7&g)<<4;_.buf[_.pos++]|=b|((g>>>=3)?128:0),g&&(_.buf[_.pos++]=127&g|((g>>>=7)?128:0),g&&(_.buf[_.pos++]=127&g|((g>>>=7)?128:0),g&&(_.buf[_.pos++]=127&g|((g>>>=7)?128:0),g&&(_.buf[_.pos++]=127&g|((g>>>=7)?128:0),g&&(_.buf[_.pos++]=127&g)))))})(h,o)})(a,this):(this.realloc(4),this.buf[this.pos++]=127&a|(a>127?128:0),a<=127||(this.buf[this.pos++]=127&(a>>>=7)|(a>127?128:0),a<=127||(this.buf[this.pos++]=127&(a>>>=7)|(a>127?128:0),a<=127||(this.buf[this.pos++]=a>>>7&127))))}writeSVarint(a){this.writeVarint(a<0?2*-a-1:2*a)}writeBoolean(a){this.writeVarint(+a)}writeString(a){a=String(a),this.realloc(4*a.length),this.pos++;const r=this.pos;this.pos=(function(u,h,g){for(let _,b,T=0;T<h.length;T++){if(_=h.charCodeAt(T),_>55295&&_<57344){if(!b){_>56319||T+1===h.length?(u[g++]=239,u[g++]=191,u[g++]=189):b=_;continue}if(_<56320){u[g++]=239,u[g++]=191,u[g++]=189,b=_;continue}_=b-55296<<10|_-56320|65536,b=null}else b&&(u[g++]=239,u[g++]=191,u[g++]=189,b=null);_<128?u[g++]=_:(_<2048?u[g++]=_>>6|192:(_<65536?u[g++]=_>>12|224:(u[g++]=_>>18|240,u[g++]=_>>12&63|128),u[g++]=_>>6&63|128),u[g++]=63&_|128)}return g})(this.buf,a,this.pos);const o=this.pos-r;o>=128&&Ck(r,o,this),this.pos=r-1,this.writeVarint(o),this.pos+=o}writeFloat(a){this.realloc(4),this.dataView.setFloat32(this.pos,a,!0),this.pos+=4}writeDouble(a){this.realloc(8),this.dataView.setFloat64(this.pos,a,!0),this.pos+=8}writeBytes(a){const r=a.length;this.writeVarint(r),this.realloc(r);for(let o=0;o<r;o++)this.buf[this.pos++]=a[o]}writeRawMessage(a,r){this.pos++;const o=this.pos;a(r,this);const u=this.pos-o;u>=128&&Ck(o,u,this),this.pos=o-1,this.writeVarint(u),this.pos+=u}writeMessage(a,r,o){this.writeTag(a,2),this.writeRawMessage(r,o)}writePackedVarint(a,r){r.length&&this.writeMessage(a,X$,r)}writePackedSVarint(a,r){r.length&&this.writeMessage(a,Y$,r)}writePackedBoolean(a,r){r.length&&this.writeMessage(a,e7,r)}writePackedFloat(a,r){r.length&&this.writeMessage(a,J$,r)}writePackedDouble(a,r){r.length&&this.writeMessage(a,Q$,r)}writePackedFixed32(a,r){r.length&&this.writeMessage(a,t7,r)}writePackedSFixed32(a,r){r.length&&this.writeMessage(a,n7,r)}writePackedFixed64(a,r){r.length&&this.writeMessage(a,r7,r)}writePackedSFixed64(a,r){r.length&&this.writeMessage(a,i7,r)}writeBytesField(a,r){this.writeTag(a,2),this.writeBytes(r)}writeFixed32Field(a,r){this.writeTag(a,5),this.writeFixed32(r)}writeSFixed32Field(a,r){this.writeTag(a,5),this.writeSFixed32(r)}writeFixed64Field(a,r){this.writeTag(a,1),this.writeFixed64(r)}writeSFixed64Field(a,r){this.writeTag(a,1),this.writeSFixed64(r)}writeVarintField(a,r){this.writeTag(a,0),this.writeVarint(r)}writeSVarintField(a,r){this.writeTag(a,0),this.writeSVarint(r)}writeStringField(a,r){this.writeTag(a,2),this.writeString(r)}writeFloatField(a,r){this.writeTag(a,5),this.writeFloat(r)}writeDoubleField(a,r){this.writeTag(a,1),this.writeDouble(r)}writeBooleanField(a,r){this.writeVarintField(a,+r)}};function jm(a,r,o){return o?4294967296*r+(a>>>0):4294967296*(r>>>0)+(a>>>0)}function Ck(a,r,o){const u=r<=16383?1:r<=2097151?2:r<=268435455?3:Math.floor(Math.log(r)/(7*Math.LN2));o.realloc(u);for(let h=o.pos-1;h>=a;h--)o.buf[h+u]=o.buf[h]}function X$(a,r){for(let o=0;o<a.length;o++)r.writeVarint(a[o])}function Y$(a,r){for(let o=0;o<a.length;o++)r.writeSVarint(a[o])}function J$(a,r){for(let o=0;o<a.length;o++)r.writeFloat(a[o])}function Q$(a,r){for(let o=0;o<a.length;o++)r.writeDouble(a[o])}function e7(a,r){for(let o=0;o<a.length;o++)r.writeBoolean(a[o])}function t7(a,r){for(let o=0;o<a.length;o++)r.writeFixed32(a[o])}function n7(a,r){for(let o=0;o<a.length;o++)r.writeSFixed32(a[o])}function r7(a,r){for(let o=0;o<a.length;o++)r.writeFixed64(a[o])}function i7(a,r){for(let o=0;o<a.length;o++)r.writeSFixed64(a[o])}const gE=3;function o7(a,r,o){r.glyphs=[],a===1&&o.readMessage(s7,r)}function s7(a,r,o){if(a===3){const{id:u,bitmap:h,width:g,height:_,left:b,top:T,advance:E}=o.readMessage(a7,{});r.glyphs.push({id:u,bitmap:new uh({width:g+2*gE,height:_+2*gE},h),metrics:{width:g,height:_,left:b,top:T,advance:E}})}else a===4?r.ascender=o.readSVarint():a===5&&(r.descender=o.readSVarint())}function a7(a,r,o){a===1?r.id=o.readVarint():a===2?r.bitmap=o.readBytes():a===3?r.width=o.readVarint():a===4?r.height=o.readVarint():a===5?r.left=o.readSVarint():a===6?r.top=o.readSVarint():a===7&&(r.advance=o.readVarint())}const Ik=gE,wa={horizontal:1,vertical:2,horizontalOnly:3};class Ry{constructor(){this.scale=1,this.fontStack="",this.image=null}static forText(r,o){const u=new Ry;return u.scale=r||1,u.fontStack=o,u}static forImage(r){const o=new Ry;return o.image=r,o}}class Gm{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(r,o,u){const h=new Gm;for(let g=0;g<r.sections.length;g++){const _=r.sections[g];_.image?h.addImageSection(_,u):h.addTextSection(_,o)}return h}length(){return this.text.length}getSection(r){return this.sections[this.sectionIndex[r]]}getSections(){return this.sections}getSectionIndex(r){return this.sectionIndex[r]}getCodePoint(r){return this.text.codePointAt(r)}verticalizePunctuation(r){this.text=(function(o,u){let h="";for(let g=0;g<o.length;g++){const _=o.charCodeAt(g+1)||null,b=o.charCodeAt(g-1)||null;h+=!u&&(_&&_m(_)&&!Py[o[g+1]]||b&&_m(b)&&!Py[o[g-1]])||!Py[o[g]]?o[g]:Py[o[g]]}return h})(this.text,r)}trim(){let r=0;for(let u=0;u<this.text.length&&R1[this.text.charCodeAt(u)];u++)r++;let o=this.text.length;for(let u=this.text.length-1;u>=0&&u>=r&&R1[this.text.charCodeAt(u)];u--)o--;this.text=this.text.substring(r,o),this.sectionIndex=this.sectionIndex.slice(r,o)}substring(r,o){const u=new Gm;return u.text=this.text.substring(r,o),u.sectionIndex=this.sectionIndex.slice(r,o),u.sections=this.sections,u}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce(((r,o)=>Math.max(r,this.sections[o].scale)),0)}addTextSection(r,o){this.text+=r.text,this.sections.push(Ry.forText(r.scale,r.fontStack||o));const u=this.sections.length-1;for(let h=0;h<r.text.length;++h)this.sectionIndex.push(u)}addImageSection(r,o){const u=r.image?r.image.getPrimary():null;if(!u)return void cr("Can't add FormattedSection with an empty image.");u.scaleSelf(o);const h=this.getNextImageSectionCharCode();h?(this.text+=String.fromCodePoint(h),this.sections.push(Ry.forImage(u)),this.sectionIndex.push(this.sections.length-1)):cr("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function _E(a,r,o,u,h,g,_,b,T,E,A,R,M,F,B,W=1){const q=Gm.fromFeature(a,h,W);R===wa.vertical&&q.verticalizePunctuation(M);let K=[];const ne=(function(Ce,Oe,De,ut,Ue,ht){if(!Ce)return[];const wt=[],mt=(function(vt,rt,Xe,Ct,Tt,hn){let Ht=0;for(let Jt=0;Jt<vt.length();Jt++){const Dt=vt.getSection(Jt);Ht+=Ak(vt.getCodePoint(Jt),Dt,Ct,Tt,rt,hn)}return Ht/Math.max(1,Math.ceil(Ht/Xe))})(Ce,Oe,De,ut,Ue,ht),yt=Ce.text.indexOf("")>=0;let Et=0;for(let vt=0;vt<Ce.length();vt++){const rt=Ce.getSection(vt),Xe=Ce.getCodePoint(vt);if(R1[Xe]||(Et+=Ak(Xe,rt,ut,Ue,Oe,ht)),vt<Ce.length()-1){const Ct=!((lt=Xe)<11904||!(Cn["Bopomofo Extended"](lt)||Cn.Bopomofo(lt)||Cn["CJK Compatibility Forms"](lt)||Cn["CJK Compatibility Ideographs"](lt)||Cn["CJK Compatibility"](lt)||Cn["CJK Radicals Supplement"](lt)||Cn["CJK Strokes"](lt)||Cn["CJK Symbols and Punctuation"](lt)||Cn["CJK Unified Ideographs Extension A"](lt)||Cn["CJK Unified Ideographs"](lt)||Cn["Enclosed CJK Letters and Months"](lt)||Cn["Halfwidth and Fullwidth Forms"](lt)||Cn.Hiragana(lt)||Cn["Ideographic Description Characters"](lt)||Cn["Kangxi Radicals"](lt)||Cn["Katakana Phonetic Extensions"](lt)||Cn.Katakana(lt)||Cn["Vertical Forms"](lt)||Cn["Yi Radicals"](lt)||Cn["Yi Syllables"](lt)));(l7[Xe]||Ct||rt.image)&&wt.push(Rk(vt+1,Et,mt,wt,c7(Xe,Ce.getCodePoint(vt+1),Ct&&yt),!1))}}var lt;return kk(Rk(Ce.length(),Et,mt,wt,0,!0))})(q,E,g,r,u,F),{processBidirectionalText:re,processStyledBidirectionalText:oe}=El;if(re&&q.sections.length===1){const Ce=re(q.toString(),ne);for(const Oe of Ce){const De=new Gm;De.text=Oe,De.sections=q.sections;for(let ut=0;ut<Oe.length;ut++)De.sectionIndex.push(0);K.push(De)}}else if(oe){const Ce=oe(q.text,q.sectionIndex,ne);for(const Oe of Ce){const De=new Gm;De.text=Oe[0],De.sectionIndex=Oe[1],De.sections=q.sections,K.push(De)}}else K=(function(Ce,Oe){const De=[],ut=Ce.text;let Ue=0;for(const ht of Oe)De.push(Ce.substring(Ue,ht)),Ue=ht;return Ue<ut.length&&De.push(Ce.substring(Ue,ut.length)),De})(q,ne);const ye=[],ve={positionedLines:ye,text:q.toString(),top:A[1],bottom:A[1],left:A[0],right:A[0],writingMode:R,iconsInText:!1,verticalizable:!1,hasBaseline:!1};if((function(Ce,Oe,De,ut,Ue,ht,wt,mt,yt,Et,lt,vt){let rt=0,Xe=0,Ct=0;const Tt=mt==="right"?1:mt==="left"?0:.5;let hn=!1;for(const Vt of Ue){const tn=Vt.getSections();for(const An of tn){if(An.image)continue;const Nn=Oe[An.fontStack];if(Nn&&(hn=Nn.ascender!==void 0&&Nn.descender!==void 0,!hn))break}if(!hn)break}let Ht=0;for(const Vt of Ue){Vt.trim();const tn=Vt.getMaxScale(),An=(tn-1)*Zo,Nn={positionedGlyphs:[],lineOffset:0};Ce.positionedLines[Ht]=Nn;const er=Nn.positionedGlyphs;let Un=0;if(!Vt.length()){Xe+=ht,++Ht;continue}let Xt=0,Vn=0;for(let ae=0;ae<Vt.length();ae++){const le=Vt.getSection(ae),et=Vt.getSectionIndex(ae),ct=Vt.getCodePoint(ae);let Nt=le.scale,Bt=null,Kt=null,_n=null,tr=Zo,nr=0,Jn=yt;Jn===wa.vertical&&((Jt=ct)===12312||Jt===12313||Jt===12316||Jt===12540||Jt===12448)&&(Jn=wa.horizontal);const Kr=!(Jn===wa.horizontal||!lt&&!gm(ct)||lt&&(R1[ct]||yS(ct)));if(le.image){const Ii=ut.get(le.image.toString());if(!Ii)continue;_n=le.image,Ce.iconsInText=Ce.iconsInText||!0,Kt=Ii.paddedRect;const Zn=Ii.displaySize;Nt=Nt*Zo/vt,Bt={width:Zn[0],height:Zn[1],left:0,top:-Ik,advance:Kr?Zn[1]:Zn[0],localGlyph:!1},nr=hn?-Bt.height*Nt:tn*Zo-17-Zn[1]*Nt,tr=Bt.advance;const mi=(Kr?Zn[0]:Zn[1])*Nt-Zo*tn;mi>0&&mi>Un&&(Un=mi)}else{const Ii=De[le.fontStack];if(!Ii)continue;Ii[ct]&&(Kt=Ii[ct]);const Zn=Oe[le.fontStack];if(!Zn)continue;const mi=Zn.glyphs[ct];if(!mi)continue;if(Bt=mi.metrics,tr=ct!==8203?Zo:0,hn){const Jr=Zn.ascender!==void 0?Math.abs(Zn.ascender):0,Dr=Zn.descender!==void 0?Math.abs(Zn.descender):0,_i=(Jr+Dr)*Nt;Xt<_i&&(Xt=_i,Vn=(Jr-Dr)/2*Nt),nr=-Jr*Nt}else nr=(tn-Nt)*Zo-17}Kr?(Ce.verticalizable=!0,er.push({glyph:ct,image:_n,x:rt,y:Xe+nr,vertical:Kr,scale:Nt,localGlyph:Bt.localGlyph,fontStack:le.fontStack,sectionIndex:et,metrics:Bt,rect:Kt}),rt+=tr*Nt+Et):(er.push({glyph:ct,image:_n,x:rt,y:Xe+nr,vertical:Kr,scale:Nt,localGlyph:Bt.localGlyph,fontStack:le.fontStack,sectionIndex:et,metrics:Bt,rect:Kt}),rt+=Bt.advance*Nt+Et)}er.length!==0&&(Ct=Math.max(rt-Et,Ct),hn?Ok(er,Tt,Un,Vn,ht*tn/2):Ok(er,Tt,Un,0,ht/2)),rt=0;const br=ht*tn+Un;Nn.lineOffset=Math.max(Un,An),Xe+=br,++Ht}var Jt;const Dt=Xe,{horizontalAlign:dn,verticalAlign:Fn}=yE(wt);(function(Vt,tn,An,Nn,er,Un){const Xt=(tn-An)*er,Vn=-Un*Nn;for(const br of Vt)for(const ae of br.positionedGlyphs)ae.x+=Xt,ae.y+=Vn})(Ce.positionedLines,Tt,dn,Fn,Ct,Dt),Ce.top+=-Fn*Dt,Ce.bottom=Ce.top+Dt,Ce.left+=-dn*Ct,Ce.right=Ce.left+Ct,Ce.hasBaseline=hn})(ve,r,o,u,K,_,b,T,R,E,M,B),!(function(Ce){for(const Oe of Ce)if(Oe.positionedGlyphs.length!==0)return!1;return!0})(ye))return ve}const R1={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},l7={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function Ak(a,r,o,u,h,g){if(r.image){const _=u.get(r.image.toString());return _?_.displaySize[0]*r.scale*Zo/g+h:0}{const _=o[r.fontStack],b=_&&_.glyphs[a];return b?b.metrics.advance*r.scale+h:0}}function Pk(a,r,o,u){const h=Math.pow(a-r,2);return u?a<r?h/2:2*h:h+Math.abs(o)*o}function c7(a,r,o){let u=0;return a===10&&(u-=1e4),o&&(u+=150),a!==40&&a!==65288||(u+=50),r!==41&&r!==65289||(u+=50),u}function Rk(a,r,o,u,h,g){let _=null,b=Pk(r,o,h,g);for(const T of u){const E=Pk(r-T.x,o,h,g)+T.badness;E<=b&&(_=T,b=E)}return{index:a,x:r,priorBreak:_,badness:b}}function kk(a){return a?kk(a.priorBreak).concat(a.index):[]}function yE(a){let r=.5,o=.5;switch(a){case"right":case"top-right":case"bottom-right":r=1;break;case"left":case"top-left":case"bottom-left":r=0}switch(a){case"bottom":case"bottom-right":case"bottom-left":o=1;break;case"top":case"top-right":case"top-left":o=0}return{horizontalAlign:r,verticalAlign:o}}function Ok(a,r,o,u,h){if(!(r||o||u||h))return;const g=a.length-1,_=a[g],b=(_.x+_.metrics.advance*_.scale)*r;for(let T=0;T<=g;T++)a[T].x-=b,a[T].y+=o+u+h}function Mk(a){return a.imagePrimary!==void 0&&a.top!==void 0&&a.bottom!==void 0&&a.left!==void 0&&a.right!==void 0}function u7(a,r,o,u){const{horizontalAlign:h,verticalAlign:g}=yE(u),_=o[0]-a.displaySize[0]*h,b=o[1]-a.displaySize[1]*g;return{imagePrimary:a,imageSecondary:r,top:b,bottom:b+a.displaySize[1],left:_,right:_+a.displaySize[0]}}function Dk(a,r,o,u,h,g){const _=a.imagePrimary;let b;if(_.content){const q=_.content,K=_.pixelRatio||1;b=[q[0]/K,q[1]/K,_.displaySize[0]-q[2]/K,_.displaySize[1]-q[3]/K]}const T=r.left*g,E=r.right*g;let A,R,M,F;o==="width"||o==="both"?(F=h[0]+T-u[3],R=h[0]+E+u[1]):(F=h[0]+(T+E-_.displaySize[0])/2,R=F+_.displaySize[0]);const B=r.top*g,W=r.bottom*g;return o==="height"||o==="both"?(A=h[1]+B-u[0],M=h[1]+W+u[2]):(A=h[1]+(B+W-_.displaySize[1])/2,M=A+_.displaySize[1]),{imagePrimary:_,imageSecondary:void 0,top:A,right:R,bottom:M,left:F,collisionPadding:b}}function Lk(a){return!a.imagePrimary.stretchX}function zk(a){return!a.imagePrimary.stretchY}function Fk(a){return{width:a.right-a.left,height:a.bottom-a.top}}const Kc=128;function Bk(a,r,o){const{expression:u}=r;if(u.kind==="constant")return{kind:"constant",layoutSize:u.evaluate(new pi(a+1,{worldview:o}))};if(u.kind==="source")return{kind:"source"};{const{zoomStops:h,interpolationType:g}=u;let _=0;for(;_<h.length&&h[_]<=a;)_++;_=Math.max(0,_-1);let b=_;for(;b<h.length&&h[b]<a+1;)b++;b=Math.min(h.length-1,b);const T=h[_],E=h[b];return u.kind==="composite"?{kind:"composite",minZoom:T,maxZoom:E,interpolationType:g}:{kind:"camera",minZoom:T,maxZoom:E,minSize:u.evaluate(new pi(T,{worldview:o})),maxSize:u.evaluate(new pi(E,{worldview:o})),interpolationType:g}}}function vE(a,{uSize:r,uSizeT:o},{lowerSize:u,upperSize:h}){return a.kind==="source"?u/Kc:a.kind==="composite"?wn(u/Kc,h/Kc,o):r}function ky(a,r,o=1){let u=0,h=0;if(a.kind==="constant")h=a.layoutSize*o;else if(a.kind!=="source"){const{interpolationType:g,minZoom:_,maxZoom:b}=a,T=g?be(_a.interpolationFactor(g,r,_,b),0,1):0;a.kind==="camera"?h=wn(a.minSize,a.maxSize,T)*o:u=T*o}return{uSizeT:u,uSize:h}}class nd extends xt{constructor(r,o,u,h,g){super(r,o),this.angle=h,this.z=u,g!==void 0&&(this.segment=g)}clone(){return new nd(this.x,this.y,this.z,this.angle,this.segment)}}function Nk(a,r,o,u,h){if(r.segment===void 0)return!0;let g=r,_=r.segment+1,b=0;for(;b>-o/2;){if(_--,_<0)return!1;b-=a[_].dist(g),g=a[_]}b+=a[_].dist(a[_+1]),_++;const T=[];let E=0;for(;b<o/2;){const A=a[_],R=a[_+1];if(!R)return!1;let M=a[_-1].angleTo(A)-A.angleTo(R);for(M=Math.abs((M+3*Math.PI)%(2*Math.PI)-Math.PI),T.push({distance:b,angleDelta:M}),E+=M;b-T[0].distance>u;)E-=T.shift().angleDelta;if(E>h)return!1;_++,b+=A.dist(R)}return!0}function Vk(a){let r=0;for(let o=0;o<a.length-1;o++)r+=a[o].dist(a[o+1]);return r}function $k(a,r,o){return a?.6*r*o:0}function Uk(a,r){return Math.max(a?a.right-a.left:0,r?r.right-r.left:0)}function d7(a,r,o,u,h,g){const _=$k(o,h,g),b=Uk(o,u)*g;let T=0;const E=Vk(a)/2;for(let A=0;A<a.length-1;A++){const R=a[A],M=a[A+1],F=R.dist(M);if(T+F>E){const B=(E-T)/F,W=wn(R.x,M.x,B),q=wn(R.y,M.y,B),K=new nd(W,q,0,M.angleTo(R),A);return!_||Nk(a,K,b,_,r)?K:void 0}T+=F}}function h7(a,r,o,u,h,g,_,b,T){const E=$k(u,g,_),A=Uk(u,h),R=A*_,M=a[0].x===0||a[0].x===T||a[0].y===0||a[0].y===T;return r-R<r/4&&(r=R+r/4),jk(a,M?r/2*b%r:(A/2+2*g)*_*b%r,r,E,o,R,M,!1,T)}function jk(a,r,o,u,h,g,_,b,T){const E=g/2,A=Vk(a);let R=0,M=r-o,F=[];for(let B=0;B<a.length-1;B++){const W=a[B],q=a[B+1],K=W.dist(q),ne=q.angleTo(W);for(;M+o<R+K;){M+=o;const re=(M-R)/K,oe=wn(W.x,q.x,re),ye=wn(W.y,q.y,re);if(oe>=0&&oe<T&&ye>=0&&ye<T&&M-E>=0&&M+E<=A){const ve=new nd(oe,ye,0,ne,B);u&&!Nk(a,ve,g,u,h)||F.push(ve)}}R+=K}return b||F.length||_||(F=jk(a,R/2,o,u,h,g,_,!0,T)),F}function Gk(a){let r=0,o=0;for(const _ of a)r+=_.w*_.h,o=Math.max(o,_.w);a.sort(((_,b)=>b.h-_.h));const u=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(r/.95)),o),h:1/0}];let h=0,g=0;for(const _ of a)for(let b=u.length-1;b>=0;b--){const T=u[b];if(!(_.w>T.w||_.h>T.h)){if(_.x=T.x,_.y=T.y,g=Math.max(g,_.y+_.h),h=Math.max(h,_.x+_.w),_.w===T.w&&_.h===T.h){const E=u.pop();E&&b<u.length&&(u[b]=E)}else _.h===T.h?(T.x+=_.w,T.w-=_.w):_.w===T.w?(T.y+=_.h,T.h-=_.h):(u.push({x:T.x+_.w,y:T.y,w:T.w-_.w,h:_.h}),T.y+=_.h,T.h-=_.h);break}}return{w:h,h:g,fill:r/(h*g)||0}}Wt(nd,"Anchor");const Kf=1;class Oy{static getImagePositionScale(r,o,u){if(o&&r&&r.options&&r.options.transform){const h=r.options.transform;return{x:h.a,y:h.d}}return{x:u,y:u}}constructor(r,o,u,h){this.paddedRect=r;const{pixelRatio:g,version:_,stretchX:b,stretchY:T,content:E,sdf:A,usvg:R}=o;this.pixelRatio=g,this.stretchX=b,this.stretchY=T,this.content=E,this.version=_,this.padding=u,this.sdf=A,this.usvg=R,this.scale=Oy.getImagePositionScale(h,R,g)}get tl(){return[this.paddedRect.x+this.padding,this.paddedRect.y+this.padding]}get br(){return[this.paddedRect.x+this.paddedRect.w-this.padding,this.paddedRect.y+this.paddedRect.h-this.padding]}get displaySize(){return[(this.paddedRect.w-2*this.padding)/this.scale.x,(this.paddedRect.h-2*this.padding)/this.scale.y]}}function bE(a,r,o){const u=Ft.parse(a),h=(function(g,_,b=[1,1]){return{x:0,y:0,w:(g.data?g.data.width:g.width*b[0])+2*_,h:(g.data?g.data.height:g.height*b[1])+2*_}})(r,o,[u.options.transform.a,u.options.transform.d]);return{bin:h,imagePosition:new Oy(h,r,o,u),imageVariant:u}}class Hk{constructor(r,o,u){const h=new Map,g=new Map;this.haveRenderCallbacks=[];const _=[];this.addImages(r,h,Kf,_),this.addImages(o,g,2,_);const{w:b,h:T}=Gk(_),E=new rs({width:b||1,height:T||1});for(const[A,R]of r.entries()){const M=h.get(A).paddedRect;rs.copy(R.data,E,{x:0,y:0},{x:M.x+Kf,y:M.y+Kf},R.data,null,R.sdf)}for(const[A,R]of o.entries()){const M=g.get(A),F=M.paddedRect;let B=M.padding;const W=F.x+B,q=F.y+B,K=R.data.width,ne=R.data.height;B=B>1?B-1:B,rs.copy(R.data,E,{x:0,y:0},{x:W,y:q},R.data,u),rs.copy(R.data,E,{x:0,y:ne-B},{x:W,y:q-B},{width:K,height:B},u),rs.copy(R.data,E,{x:0,y:0},{x:W,y:q+ne},{width:K,height:B},u),rs.copy(R.data,E,{x:K-B,y:0},{x:W-B,y:q},{width:B,height:ne},u),rs.copy(R.data,E,{x:0,y:0},{x:W+K,y:q},{width:B,height:ne},u),rs.copy(R.data,E,{x:K-B,y:ne-B},{x:W-B,y:q-B},{width:B,height:B},u),rs.copy(R.data,E,{x:0,y:ne-B},{x:W+K,y:q-B},{width:B,height:B},u),rs.copy(R.data,E,{x:0,y:0},{x:W+K,y:q+ne},{width:B,height:B},u),rs.copy(R.data,E,{x:K-B,y:0},{x:W-B,y:q+ne},{width:B,height:B},u)}this.lut=u,this.image=E,this.iconPositions=h,this.patternPositions=g}addImages(r,o,u,h){for(const[g,_]of r.entries()){const{bin:b,imagePosition:T,imageVariant:E}=bE(g,_,u);o.set(g,T),h.push(b),_.hasRenderCallback&&this.haveRenderCallbacks.push(E.id)}}patchUpdatedImages(r,o,u){this.haveRenderCallbacks=this.haveRenderCallbacks.filter((h=>r.hasImage(h,u))),r.dispatchRenderCallbacks(this.haveRenderCallbacks,u);for(const h of r.getUpdatedImages(u)){for(const g of this.iconPositions.keys()){const _=Ft.parse(g);if(zs.isEqual(_.id,h)){const b=r.getImage(h,u);this.patchUpdatedImage(this.iconPositions.get(g),b,o,null)}}for(const g of this.patternPositions.keys()){const _=Ft.parse(g);if(zs.isEqual(_.id,h)){const b=r.getImage(h,u);this.patchUpdatedImage(this.patternPositions.get(g),b,o,this.lut)}}}}patchUpdatedImage(r,o,u,h=null){if(!r||!o||r.version===o.version)return;r.version=o.version;const[g,_]=r.tl,b=r.sdf;if(this.lut||b){const T={width:o.data.width,height:o.data.height},E=new rs(T);rs.copy(o.data,E,{x:0,y:0},{x:0,y:0},T,h,b),u.update(E,{position:{x:g,y:_}})}else u.update(o.data,{position:{x:g,y:_}})}}Wt(Oy,"ImagePosition"),Wt(Hk,"ImageAtlas");const My=1e20;function Wk(a,r,o,u,h,g,_,b,T){for(let E=r;E<r+u;E++)qk(a,o*g+E,g,h,_,b,T);for(let E=o;E<o+h;E++)qk(a,E*g+r,1,u,_,b,T)}function qk(a,r,o,u,h,g,_){g[0]=0,_[0]=-My,_[1]=My,h[0]=a[r];for(let b=1,T=0,E=0;b<u;b++){h[b]=a[r+b*o];const A=b*b;do{const R=g[T];E=(h[b]-h[R]+A-R*R)/(b-R)/2}while(E<=_[T]&&--T>-1);T++,g[T]=b,_[T]=E,_[T+1]=My}for(let b=0,T=0;b<u;b++){for(;_[T+1]<b;)T++;const E=g[T],A=b-E;a[r+b*o]=h[E]+A*A}}const oc=2,xE={none:0,ideographs:1,all:2};class Hm{constructor(r,o,u){this.requestManager=r,this.localGlyphMode=o,this.localFontFamily=u,this.url="",this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(r){this.url=r}getGlyphs(r,o){const u=[],h=this.url||Ho.GLYPHS_URL;for(const g in r)for(const _ of r[g])u.push({stack:g,id:_});nt(u,(({stack:g,id:_},b)=>{let T=this.entries[g];T||(T=this.entries[g]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let E=T.glyphs[_];if(E!==void 0)return void b(null,{stack:g,id:_,glyph:E});if(E=this._tinySDF(T,g,_),E)return T.glyphs[_]=E,void b(null,{stack:g,id:_,glyph:E});const A=Math.floor(_/256);if(256*A>65535)return cr("glyphs > 65535 not supported"),void b(null,{stack:g,id:_,glyph:E});if(T.ranges[A])return void b(null,{stack:g,id:_,glyph:E});let R=T.requests[A];R||(R=T.requests[A]=[],Hm.loadGlyphRange(g,A,h,this.requestManager,((M,F)=>{if(F){T.ascender=F.ascender,T.descender=F.descender;for(const B in F.glyphs)this._doesCharSupportLocalGlyph(+B)||(T.glyphs[+B]=F.glyphs[+B]);T.ranges[A]=!0}for(const B of R)B(M,F);delete T.requests[A]}))),R.push(((M,F)=>{M?b(M):F&&b(null,{stack:g,id:_,glyph:F.glyphs[_]||null})}))}),((g,_)=>{if(g)o(g);else if(_){const b={};for(const{stack:T,id:E,glyph:A}of _)b[T]===void 0&&(b[T]={}),b[T].glyphs===void 0&&(b[T].glyphs={}),b[T].glyphs[E]=A&&{id:A.id,bitmap:A.bitmap.clone(),metrics:A.metrics},b[T].ascender=this.entries[T].ascender,b[T].descender=this.entries[T].descender;o(null,b)}}))}_doesCharSupportLocalGlyph(r){return this.localGlyphMode!==xE.none&&(this.localGlyphMode===xE.all?!!this.localFontFamily:!!this.localFontFamily&&(Cn["CJK Unified Ideographs"](r)||Cn["Hangul Syllables"](r)||Cn.Hiragana(r)||Cn.Katakana(r)||Cn["CJK Symbols and Punctuation"](r)||Cn["CJK Unified Ideographs Extension A"](r)||Cn["CJK Unified Ideographs Extension B"](r)||Cn.Osage(r)))}_tinySDF(r,o,u){const h=this.localFontFamily;if(!h||!this._doesCharSupportLocalGlyph(u))return;let g=r.tinySDF;if(!g){let W="400";/bold/i.test(o)?W="900":/medium/i.test(o)?W="500":/light/i.test(o)&&(W="200"),g=r.tinySDF=new Hm.TinySDF({fontFamily:h,fontWeight:W,fontSize:24*oc,buffer:3*oc,radius:8*oc}),g.fontWeight=W}if(this.localGlyphs[g.fontWeight][u])return this.localGlyphs[g.fontWeight][u];const _=String.fromCodePoint(u),{data:b,width:T,height:E,glyphWidth:A,glyphHeight:R,glyphLeft:M,glyphTop:F,glyphAdvance:B}=g.draw(_);return this.localGlyphs[g.fontWeight][u]={id:u,bitmap:new uh({width:T,height:E},b),metrics:{width:A/oc,height:R/oc,left:M/oc,top:F/oc-27,advance:B/oc,localGlyph:!0}}}}Hm.loadGlyphRange=function(a,r,o,u,h){const g=256*r,_=g+255,b=u.transformRequest(u.normalizeGlyphsURL(o).replace("{fontstack}",a).replace("{range}",`${g}-${_}`),Od.Glyphs);Ec(b,((T,E)=>{if(T)h(T);else if(E){const A={},R=(function(M){return new P1(M).readFields(o7,{})})(E);for(const M of R.glyphs)A[M.id]=M;h(null,{glyphs:A,ascender:R.ascender,descender:R.descender})}}))},Hm.TinySDF=class{constructor({fontSize:a=24,buffer:r=3,radius:o=8,cutoff:u=.25,fontFamily:h="sans-serif",fontWeight:g="normal",fontStyle:_="normal",lang:b=null}={}){this.buffer=r,this.cutoff=u,this.radius=o,this.lang=b;const T=this.size=a+4*r,E=this._createCanvas(T),A=this.ctx=E.getContext("2d",{willReadFrequently:!0});A.font=`${_} ${g} ${a}px ${h}`,A.textBaseline="alphabetic",A.textAlign="left",A.fillStyle="black",this.gridOuter=new Float64Array(T*T),this.gridInner=new Float64Array(T*T),this.f=new Float64Array(T),this.z=new Float64Array(T+1),this.v=new Uint16Array(T)}_createCanvas(a){const r=document.createElement("canvas");return r.width=r.height=a,r}draw(a){const{width:r,actualBoundingBoxAscent:o,actualBoundingBoxDescent:u,actualBoundingBoxLeft:h,actualBoundingBoxRight:g}=this.ctx.measureText(a),_=Math.ceil(o),b=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(g-h))),T=Math.min(this.size-this.buffer,_+Math.ceil(u)),E=b+2*this.buffer,A=T+2*this.buffer,R=Math.max(E*A,0),M=new Uint8ClampedArray(R),F={data:M,width:E,height:A,glyphWidth:b,glyphHeight:T,glyphTop:_,glyphLeft:0,glyphAdvance:r};if(b===0||T===0)return F;const{ctx:B,buffer:W,gridInner:q,gridOuter:K}=this;this.lang&&(B.lang=this.lang),B.clearRect(W,W,b,T),B.fillText(a,W,W+_);const ne=B.getImageData(W,W,b,T);K.fill(My,0,R),q.fill(0,0,R);for(let re=0;re<T;re++)for(let oe=0;oe<b;oe++){const ye=ne.data[4*(re*b+oe)+3]/255;if(ye===0)continue;const ve=(re+W)*E+oe+W;if(ye===1)K[ve]=0,q[ve]=My;else{const Ce=.5-ye;K[ve]=Ce>0?Ce*Ce:0,q[ve]=Ce<0?Ce*Ce:0}}Wk(K,0,0,E,A,E,this.f,this.v,this.z),Wk(q,W,W,b,T,E,this.f,this.v,this.z);for(let re=0;re<R;re++){const oe=Math.sqrt(K[re])-Math.sqrt(q[re]);M[re]=Math.round(255-255*(oe/this.radius+this.cutoff))}return F}};const fh=Kf;function Kk(a,r){return a+r[1]-r[0]}function Zk(a,r,o,u,h=1){const g=[],_=a.imagePrimary,b=_.pixelRatio,T=_.paddedRect.w-2*fh,E=_.paddedRect.h-2*fh,A=(a.right-a.left)*h,R=(a.bottom-a.top)*h,M=_.stretchX||[[0,T]],F=_.stretchY||[[0,E]],B=M.reduce(Kk,0),W=F.reduce(Kk,0),q=T-B,K=E-W;let ne=0,re=B,oe=0,ye=W,ve=0,Ce=q,Oe=0,De=K;if(_.content&&u){const Ue=_.content;ne=k1(M,0,Ue[0]),oe=k1(F,0,Ue[1]),re=k1(M,Ue[0],Ue[2]),ye=k1(F,Ue[1],Ue[3]),ve=Ue[0]-ne,Oe=Ue[1]-oe,Ce=Ue[2]-Ue[0]-re,De=Ue[3]-Ue[1]-ye}const ut=(Ue,ht,wt,mt)=>{const yt=O1(Ue.stretch-ne,re,A,a.left*h),Et=M1(Ue.fixed-ve,Ce,Ue.stretch,B),lt=O1(ht.stretch-oe,ye,R,a.top*h),vt=M1(ht.fixed-Oe,De,ht.stretch,W),rt=O1(wt.stretch-ne,re,A,a.left*h),Xe=M1(wt.fixed-ve,Ce,wt.stretch,B),Ct=O1(mt.stretch-oe,ye,R,a.top*h),Tt=M1(mt.fixed-Oe,De,mt.stretch,W),hn=new xt(yt,lt),Ht=new xt(rt,lt),Jt=new xt(rt,Ct),Dt=new xt(yt,Ct),dn=new xt(Et/b,vt/b),Fn=new xt(Xe/b,Tt/b),Vt=r*Math.PI/180;if(Vt){const Xt=Math.sin(Vt),Vn=Math.cos(Vt),br=[Vn,-Xt,Xt,Vn];hn._matMult(br),Ht._matMult(br),Dt._matMult(br),Jt._matMult(br)}const tn=Ue.stretch+Ue.fixed,An=wt.stretch+wt.fixed,Nn=ht.stretch+ht.fixed,er=mt.stretch+mt.fixed,Un=a.imageSecondary;return{tl:hn,tr:Ht,bl:Dt,br:Jt,texPrimary:{x:_.paddedRect.x+fh+tn,y:_.paddedRect.y+fh+Nn,w:An-tn,h:er-Nn},texSecondary:Un?{x:Un.paddedRect.x+fh+tn,y:Un.paddedRect.y+fh+Nn,w:An-tn,h:er-Nn}:void 0,writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:dn,pixelOffsetBR:Fn,minFontScaleX:Ce/b/A,minFontScaleY:De/b/R,isSDF:o}};if(u&&(_.stretchX||_.stretchY)){const Ue=Xk(M,q,B),ht=Xk(F,K,W);for(let wt=0;wt<Ue.length-1;wt++){const mt=Ue[wt],yt=Ue[wt+1];for(let Et=0;Et<ht.length-1;Et++)g.push(ut(mt,ht[Et],yt,ht[Et+1]))}}else g.push(ut({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:T+1},{fixed:0,stretch:E+1}));return g}function k1(a,r,o){let u=0;for(const h of a)u+=Math.max(r,Math.min(o,h[1]))-Math.max(r,Math.min(o,h[0]));return u}function Xk(a,r,o){const u=[{fixed:-fh,stretch:0}];for(const[h,g]of a){const _=u[u.length-1];u.push({fixed:h-_.stretch,stretch:_.stretch}),u.push({fixed:h-_.stretch,stretch:_.stretch+(g-h)})}return u.push({fixed:r+fh,stretch:o}),u}function O1(a,r,o,u){return a/r*o+u}function M1(a,r,o,u){return a-r*o/u}function f7(a,r,o,u){const h=r+a.positionedLines[u].lineOffset;return u===0?o+h/2:o+(h+(r+a.positionedLines[u-1].lineOffset))/2}function p7(a,r=1,o=!1){let u=1/0,h=1/0,g=-1/0,_=-1/0;const b=a[0];for(let F=0;F<b.length;F++){const B=b[F];(!F||B.x<u)&&(u=B.x),(!F||B.y<h)&&(h=B.y),(!F||B.x>g)&&(g=B.x),(!F||B.y>_)&&(_=B.y)}const T=Math.min(g-u,_-h);let E=T/2;const A=new Gp([],m7);if(T===0)return new xt(u,h);for(let F=u;F<g;F+=T)for(let B=h;B<_;B+=T)A.push(new Wm(F+E,B+E,E,a));let R=(function(F){let B=0,W=0,q=0;const K=F[0];for(let ne=0,re=K.length,oe=re-1;ne<re;oe=ne++){const ye=K[ne],ve=K[oe],Ce=ye.x*ve.y-ve.x*ye.y;W+=(ye.x+ve.x)*Ce,q+=(ye.y+ve.y)*Ce,B+=3*Ce}return new Wm(W/B,q/B,0,F)})(a),M=A.length;for(;A.length;){const F=A.pop();(F.d>R.d||!R.d)&&(R=F,o&&console.log("found best %d after %d probes",Math.round(1e4*F.d)/1e4,M)),F.max-R.d<=r||(E=F.h/2,A.push(new Wm(F.p.x-E,F.p.y-E,E,a)),A.push(new Wm(F.p.x+E,F.p.y-E,E,a)),A.push(new Wm(F.p.x-E,F.p.y+E,E,a)),A.push(new Wm(F.p.x+E,F.p.y+E,E,a)),M+=4)}return o&&(console.log(`num probes: ${M}`),console.log(`best distance: ${R.d}`)),R.p}function m7(a,r){return r.max-a.max}class Wm{constructor(r,o,u,h){this.p=new xt(r,o),this.h=u,this.d=(function(g,_){let b=!1,T=1/0;for(let E=0;E<_.length;E++){const A=_[E];for(let R=0,M=A.length,F=M-1;R<M;F=R++){const B=A[R],W=A[F];B.y>g.y!=W.y>g.y&&g.x<(W.x-B.x)*(g.y-B.y)/(W.y-B.y)+B.x&&(b=!b),T=Math.min(T,Oi(g,B,W))}}return(b?1:-1)*Math.sqrt(T)})(this.p,h),this.max=this.d+this.h*Math.SQRT2}}const g7=Object.keys,wE=Number.POSITIVE_INFINITY,_7=Math.sqrt(2);function Yk(a,[r,o]){let u=0,h=0;if(o===wE){r<0&&(r=0);const g=r/_7;switch(a){case"top-right":case"top-left":h=g-7;break;case"bottom-right":case"bottom-left":h=7-g;break;case"bottom":h=7-r;break;case"top":h=r-7}switch(a){case"top-right":case"bottom-right":u=-g;break;case"top-left":case"bottom-left":u=g;break;case"left":u=r;break;case"right":u=-r}}else{switch(r=Math.abs(r),o=Math.abs(o),a){case"top-right":case"top-left":case"top":h=o-7;break;case"bottom-right":case"bottom-left":case"bottom":h=7-o}switch(a){case"top-right":case"bottom-right":case"right":u=-r;break;case"top-left":case"bottom-left":case"left":u=r}}return[u,h]}function D1(a,r,o,u,h,g,_,b,T){if(!r||!r.usvg)return;const E=Fk(u),A=Fk(h),R=g!=="both"&&g!=="width"||!Lk(u)?1:A.width/E.width,M=g!=="both"&&g!=="height"||!zk(u)?1:A.height/E.height;o.scaleSelf(R,M);const F=o.toString();_.set(F,o),b.set(F,r);const{imagePosition:B}=bE(F,r,Kf);T.set(F,B)}function Jk(a,r,o,u,h,g,_,b,T){if(!a)return;const E=(function(A,R,M,F,B,W){if(A.kind==="camera")return A.maxSize;if(A.kind==="composite"){const q=R.possiblyEvaluate(new pi(A.maxZoom,{worldview:W}),M).evaluate(B,{},M),K=R.possiblyEvaluate(new pi(A.minZoom,{worldview:W}),M).evaluate(B,{},M);return Math.max(q,K)}return R.possiblyEvaluate(new pi(F,{worldview:W})).evaluate(B,{},M)})(r,o,u,h,g,T);return a.scaleSelf(E*b*_)}function Qk(a,r,o,u,h,g,_,b,T){return{iconPrimary:Jk(a.getPrimary(),r,o,u,h,g,_,b,T),iconSecondary:Jk(a.getSecondary(),r,o,u,h,g,_,b,T)}}function y7(a,r,o){if(!r)return;const u=o.get(a.toString()),h=o.get(r.toString());u&&h&&(u.paddedRect.w===h.paddedRect.w&&u.paddedRect.h===h.paddedRect.h||cr(`Mismatch in icon variant sizes: ${a.toString()} and ${r.toString()}`),u.usvg!==h.usvg&&cr(`Mismatch in icon variant image types: ${a.id} and ${r.id}`))}function e3(a,r,o,u){if(!a)return;const h=r.get(o.toString());if(a.imagePrimary=h,u){const g=r.get(u.toString());a.imageSecondary=g}}function v7(a,r){for(const o in a.horizontal)t3(a.horizontal[o],r);t3(a.vertical,r)}function t3(a,r){if(a){for(const o of a.positionedLines)for(const u of o.positionedGlyphs)if(u.image!==null){const h=u.image.toString();u.rect=r.get(h).paddedRect}}}function TE(a){switch(a){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function b7(a,r,o,u,h,g,_,b,T){const E=SE(g.horizontal)||g.vertical,A=o.get("icon-text-fit-padding").evaluate(u,{},h);let R,M=r;return r&&T!=="none"&&(a.allowVerticalPlacement&&g.vertical&&(R=Dk(r,g.vertical,T,A,b,_)),E&&(M=Dk(r,E,T,A,b,_))),{defaultShapedIcon:M,verticallyShapedIcon:R}}function x7(a,r,o,u,h,g,_,b,T,E,A,R,M,F,B,W,q,K,ne,re){let oe=_.textMaxSize.evaluate(r,{},M);oe===void 0?oe=b*_.textScaleFactor:oe*=_.textScaleFactor;const ye=a.layers[0].layout,ve=SE(o.horizontal)||o.vertical,Ce=F.name==="globe",Oe=Zo,De=a.tilePixelRatio*oe/Oe,ut=(Et=a.overscaling,a.zoom>18&&Et>2&&(Et>>=1),Math.max(zt/(512*Et),1)*ye.get("symbol-spacing")),Ue=ye.get("text-padding")*a.tilePixelRatio,ht=ye.get("icon-padding")*a.tilePixelRatio,wt=Fe(ye.get("text-max-angle")),mt=ye.get("icon-rotation-alignment")==="map"&&re!=="point",yt=ut/2;var Et;a.hasAnyIconTextFit===!1&&q!=="none"&&(a.hasAnyIconTextFit=!0);const lt=r.properties?+r.properties[qn]:null,vt=lt&&a.elevationFeatureIdToIndex?a.elevationFeatureIdToIndex.get(lt):65535,rt=(Xe,Ct,Tt)=>{if(Ct.x<0||Ct.x>=zt||Ct.y<0||Ct.y>=zt)return;let hn=null;if(Ce){const{x:Ht,y:Jt,z:Dt}=F.projectTilePoint(Ct.x,Ct.y,Tt);hn={anchor:new nd(Ht,Jt,Dt,0,void 0),up:F.upVector(Tt,Ct.x,Ct.y)}}(function(Ht,Jt,Dt,dn,Fn,Vt,tn,An,Nn,er,Un,Xt,Vn,br,ae,le,et,ct,Nt,Bt,Kt,_n,tr,nr,Jn,Kr,Ii,Zn,mi){const Jr=Ht.addToLineVertexArray(Jt,dn);let Dr,_i,yi,ci,gi,Qr,rr,ni=0,Ni=0,On=0,Er=0,vi=-1,Ki=-1;const Si={};let Ao=Au("");const ii=Dt?Dt.anchor:Jt,xo=Zn!=="none";let Qs=0,is=0;if(Nn._unevaluatedLayout.getValue("text-radial-offset")===void 0){const Po=Nn.layout.get("text-offset").evaluate(Kt,{},Jn);Qs=Po[0]*Zo,is=Po[1]*Zo}else Qs=Nn.layout.get("text-radial-offset").evaluate(Kt,{},Jn)*Zo,is=wE;if(Ht.allowVerticalPlacement&&Fn.vertical){const Po=Fn.vertical;if(ae)Qr=EE(Po),An&&(rr=EE(An));else{const Uo=Nn.layout.get("text-rotate").evaluate(Kt,{},Jn)+90;yi=L1(er,ii,Jt,Un,Xt,Vn,Po,br,Uo,le),An&&(ci=L1(er,ii,Jt,Un,Xt,Vn,An,ct,Uo))}}if(Vt){const Po=Ht.iconSizeData,Uo=Nn.layout.get("icon-rotate").evaluate(Kt,{},Jn),os=Zk(Vt,Uo,tr,xo,_n.iconScaleFactor),Es=An?Zk(An,Uo,tr,xo,_n.iconScaleFactor):void 0;_i=L1(er,ii,Jt,Un,Xt,Vn,Vt,ct,Uo,null),ni=4*os.length;let fs=null;Po.kind==="source"?(fs=[Kc*Nn.layout.get("icon-size").evaluate(Kt,{},Jn)*_n.iconScaleFactor],fs[0]>ph&&cr(`${Ht.layerIds[0]}: Value for "icon-size" is >= ${Dy}. Reduce your "icon-size".`)):Po.kind==="composite"&&(fs=[Kc*_n.compositeIconSizes[0].evaluate(Kt,{},Jn)*_n.iconScaleFactor,Kc*_n.compositeIconSizes[1].evaluate(Kt,{},Jn)*_n.iconScaleFactor],(fs[0]>ph||fs[1]>ph)&&cr(`${Ht.layerIds[0]}: Value for "icon-size" is >= ${Dy}. Reduce your "icon-size".`)),Ht.addSymbols(Ht.icon,os,fs,Bt,Nt,Kt,void 0,Dt,Jt,Jr.lineStartIndex,Jr.lineLength,-1,nr,Jn,Kr,Ii),vi=Ht.icon.placedSymbolArray.length-1,Es&&(Ni=4*Es.length,Ht.addSymbols(Ht.icon,Es,fs,Bt,Nt,Kt,wa.vertical,Dt,Jt,Jr.lineStartIndex,Jr.lineLength,-1,nr,Jn,Kr,Ii),Ki=Ht.icon.placedSymbolArray.length-1)}for(const Po in Fn.horizontal){const Uo=Po,os=Fn.horizontal[Uo];Dr||(Ao=Au(os.text),ae?gi=EE(os):Dr=L1(er,ii,Jt,Un,Xt,Vn,os,br,Nn.layout.get("text-rotate").evaluate(Kt,{},Jn),le));const Es=os.positionedLines.length===1;if(On+=n3(Ht,Dt,Jt,os,tn,Nn,ae,Kt,le,Jr,Fn.vertical?wa.horizontal:wa.horizontalOnly,Es?g7(Fn.horizontal):[Uo],Si,vi,_n,nr,Jn,Kr),Es)break}Fn.vertical&&(Er+=n3(Ht,Dt,Jt,Fn.vertical,tn,Nn,ae,Kt,le,Jr,wa.vertical,["vertical"],Si,Ki,_n,nr,Jn,Kr));let Jo=-1;const ea=(Po,Uo)=>Po?Math.max(Po,Uo):Uo;Jo=ea(gi,Jo),Jo=ea(Qr,Jo),Jo=ea(rr,Jo);const Zc=Jo>-1?1:0;Ht.glyphOffsetArray.length>=65535&&cr("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Kt.sortKey!==void 0&&Ht.addToSortKeyRanges(Ht.symbolInstances.length,Kt.sortKey),Ht.symbolInstances.emplaceBack(Jt.x,Jt.y,ii.x,ii.y,ii.z,Si.right>=0?Si.right:-1,Si.center>=0?Si.center:-1,Si.left>=0?Si.left:-1,Si.vertical>=0?Si.vertical:-1,vi,Ki,Ao,Dr!==void 0?Dr:Ht.collisionBoxArray.length,Dr!==void 0?Dr+1:Ht.collisionBoxArray.length,yi!==void 0?yi:Ht.collisionBoxArray.length,yi!==void 0?yi+1:Ht.collisionBoxArray.length,_i!==void 0?_i:Ht.collisionBoxArray.length,_i!==void 0?_i+1:Ht.collisionBoxArray.length,ci||Ht.collisionBoxArray.length,ci?ci+1:Ht.collisionBoxArray.length,Un,On,Er,ni,Ni,Zc,0,Qs,is,Jo,0,xo?1:0,mi)})(a,Ct,hn,Xe,o,u,g,h,a.layers[0],a.collisionBoxArray,r.index,r.sourceLayerIndex,a.index,Ue,ne,E,0,ht,mt,K,r,_,A,R,M,B,W,q,vt)};if(re==="line")for(const Xe of x1(r.geometry,0,0,zt,zt)){const Ct=h7(Xe,ut,wt,o.vertical||ve,u,Oe,De,a.overscaling,zt);for(const Tt of Ct)ve&&w7(a,ve.text,yt,Tt)||rt(Xe,Tt,M)}else if(re==="line-center"){for(const Xe of r.geometry)if(Xe.length>1){const Ct=d7(Xe,wt,o.vertical||ve,u,Oe,De);Ct&&rt(Xe,Ct,M)}}else if(r.type==="Polygon")for(const Xe of gy(r.geometry,0)){const Ct=p7(Xe,16);rt(Xe[0],new nd(Ct.x,Ct.y,0,0,void 0),M)}else if(r.type==="LineString")for(const Xe of r.geometry)rt(Xe,new nd(Xe[0].x,Xe[0].y,0,0,void 0),M);else if(r.type==="Point")for(const Xe of r.geometry)for(const Ct of Xe)rt([Ct],new nd(Ct.x,Ct.y,0,0,void 0),M)}const Dy=255,ph=Dy*Kc;function n3(a,r,o,u,h,g,_,b,T,E,A,R,M,F,B,W,q,K){const ne=(function(ye,ve,Ce,Oe,De,ut,Ue,ht){const wt=[];if(ve.positionedLines.length===0)return wt;const mt=Oe.layout.get("text-rotate").evaluate(ut,{})*Math.PI/180,yt=(function(Xe){const Ct=Xe[0],Tt=Xe[1],hn=Ct*Tt;return hn>0?[Ct,-Tt]:hn<0?[-Ct,Tt]:Ct===0?[Tt,Ct]:[Tt,-Ct]})(Ce);let Et=Math.abs(ve.top-ve.bottom);for(const Xe of ve.positionedLines)Et-=Xe.lineOffset;const lt=ve.positionedLines.length,vt=Et/lt;let rt=ve.top-Ce[1];for(let Xe=0;Xe<lt;++Xe){const Ct=ve.positionedLines[Xe];rt=f7(ve,vt,rt,Xe);for(const Tt of Ct.positionedGlyphs){if(!Tt.rect)continue;const hn=Tt.rect||{};let Ht=Ik+1,Jt=!0,Dt=1,dn=0;if(Tt.image){const Kt=Ue.get(Tt.image.toString());if(!Kt)continue;if(Kt.sdf){cr("SDF images are not supported in formatted text and will be ignored.");continue}Jt=!1,Dt=Kt.pixelRatio,Ht=Kf/Dt}const Fn=(De||ht)&&Tt.vertical,Vt=Tt.metrics.advance*Tt.scale/2,tn=Tt.metrics,An=Tt.rect;if(An===null)continue;ht&&ve.verticalizable&&(dn=Tt.image?Vt-Tt.metrics.width*Tt.scale/2:0);const Nn=De?[Tt.x+Vt,Tt.y]:[0,0];let er=[0,0],Un=[0,0],Xt=!1;De||(Fn?(Un=[Tt.x+Vt+yt[0],Tt.y+yt[1]-dn],Xt=!0):er=[Tt.x+Vt+Ce[0],Tt.y+Ce[1]-dn]);const Vn=An.w*Tt.scale/(Dt*(Tt.localGlyph?oc:1)),br=An.h*Tt.scale/(Dt*(Tt.localGlyph?oc:1));let ae,le,et,ct;if(Fn){const Kt=Tt.y-rt,_n=new xt(-Vt,Vt-Kt),tr=-Math.PI/2,nr=new xt(...Un);ae=new xt(-Vt+er[0],er[1]),ae._rotateAround(tr,_n)._add(nr),ae.x+=-Kt+Vt,ae.y-=(tn.left-Ht)*Tt.scale;const Jn=Tt.image?tn.advance*Tt.scale:Zo*Tt.scale,Kr=String.fromCodePoint(Tt.glyph);K$(Kr)?ae.x+=(1-Ht)*Tt.scale:Z$(Kr)?ae.x+=Jn-tn.height*Tt.scale+(-Ht-1)*Tt.scale:ae.x+=Tt.image||tn.width+2*Ht===An.w&&tn.height+2*Ht===An.h?(Jn-br)/2:(Jn-(tn.height+2*Ht)*Tt.scale)/2,le=new xt(ae.x,ae.y-Vn),et=new xt(ae.x+br,ae.y),ct=new xt(ae.x+br,ae.y-Vn)}else{const Kt=(tn.left-Ht)*Tt.scale-Vt+er[0],_n=(-tn.top-Ht)*Tt.scale+er[1],tr=Kt+Vn,nr=_n+br;ae=new xt(Kt,_n),le=new xt(tr,_n),et=new xt(Kt,nr),ct=new xt(tr,nr)}if(mt){let Kt;Kt=De?new xt(0,0):Xt?new xt(yt[0],yt[1]):new xt(Ce[0],Ce[1]),ae._rotateAround(mt,Kt),le._rotateAround(mt,Kt),et._rotateAround(mt,Kt),ct._rotateAround(mt,Kt)}const Nt=new xt(0,0),Bt=new xt(0,0);wt.push({tl:ae,tr:le,bl:et,br:ct,texPrimary:hn,texSecondary:void 0,writingMode:ve.writingMode,glyphOffset:Nn,sectionIndex:Tt.sectionIndex,isSDF:Jt,pixelOffsetTL:Nt,pixelOffsetBR:Bt,minFontScaleX:0,minFontScaleY:0})}}return wt})(0,u,T,g,_,b,h,a.allowVerticalPlacement),re=a.textSizeData;let oe=null;re.kind==="source"?(oe=[Kc*g.layout.get("text-size").evaluate(b,{},q)*B.textScaleFactor],oe[0]>ph&&cr(`${a.layerIds[0]}: Value for "text-size" is >= ${Dy}. Reduce your "text-size".`)):re.kind==="composite"&&(oe=[Kc*B.compositeTextSizes[0].evaluate(b,{},q)*B.textScaleFactor,Kc*B.compositeTextSizes[1].evaluate(b,{},q)*B.textScaleFactor],(oe[0]>ph||oe[1]>ph)&&cr(`${a.layerIds[0]}: Value for "text-size" is >= ${Dy}. Reduce your "text-size".`)),a.addSymbols(a.text,ne,oe,T,_,b,A,r,o,E.lineStartIndex,E.lineLength,F,W,q,K,!1);for(const ye of R)M[ye]=a.text.placedSymbolArray.length-1;return 4*ne.length}function SE(a){for(const r in a)return a[r];return null}function L1(a,r,o,u,h,g,_,b,T,E){let A=_.top,R=_.bottom,M=_.left,F=_.right;if(Mk(_)&&_.collisionPadding){const B=_.collisionPadding;M-=B[0],A-=B[1],F+=B[2],R+=B[3]}if(T){const B=new xt(M,A),W=new xt(F,A),q=new xt(M,R),K=new xt(F,R),ne=Fe(T);let re=new xt(0,0);E&&(re=new xt(E[0],E[1])),B._rotateAround(ne,re),W._rotateAround(ne,re),q._rotateAround(ne,re),K._rotateAround(ne,re),M=Math.min(B.x,W.x,q.x,K.x),F=Math.max(B.x,W.x,q.x,K.x),A=Math.min(B.y,W.y,q.y,K.y),R=Math.max(B.y,W.y,q.y,K.y)}return a.emplaceBack(r.x,r.y,r.z,o.x,o.y,M,A,F,R,b,u,h,g),a.length-1}function EE(a){Mk(a)&&a.collisionPadding&&(a.top-=a.collisionPadding[1],a.bottom+=a.collisionPadding[3]);const r=a.bottom-a.top;return r>0?Math.max(10,r):null}function w7(a,r,o,u){const h=a.compareText;if(r in h){const g=h[r];for(let _=g.length-1;_>=0;_--)if(u.dist(g[_])<o)return!0}else h[r]=[];return h[r].push(u),!1}function r3(a,r){const o=a.fovAboveCenter,u=a.elevation?a.elevation.getMinElevationBelowMSL()*r:0,h=(a._camera.position[2]*a.worldSize-u)/Math.cos(a._pitch),g=Math.sin(o)*h/Math.sin(Math.max(Math.PI/2-a._pitch-o,.01));let _=Math.sin(a._pitch)*g+h;const b=h*(1/a._horizonShift);if(!a.elevation||a.elevation.exaggeration()===0){let T=Math.max(a.zoom-17,0);a.isOrthographic&&(T/=10),_*=1+T}return Math.min(1.01*_,b)}function Ly(a,r){if(!r.isReprojectedInTileSpace)return{scale:1<<a.z,x:a.x,y:a.y,x2:a.x+1,y2:a.y+1,projection:r};const o=Math.pow(2,-a.z),u=a.x*o,h=(a.x+1)*o,g=a.y*o,_=(a.y+1)*o,b=ge(u),T=ge(h),E=pe(g),A=pe(_),R=r.project(b,E),M=r.project(T,E),F=r.project(T,A),B=r.project(b,A);let W=Math.min(R.x,M.x,F.x,B.x),q=Math.min(R.y,M.y,F.y,B.y),K=Math.max(R.x,M.x,F.x,B.x),ne=Math.max(R.y,M.y,F.y,B.y);const re=o/16;function oe(ve,Ce,Oe,De,ut,Ue){const ht=(Oe+ut)/2,wt=(De+Ue)/2,mt=r.project(ge(ht),pe(wt)),yt=Math.max(0,W-mt.x,q-mt.y,mt.x-K,mt.y-ne);W=Math.min(W,mt.x),K=Math.max(K,mt.x),q=Math.min(q,mt.y),ne=Math.max(ne,mt.y),yt>re&&(oe(ve,mt,Oe,De,ht,wt),oe(mt,Ce,ht,wt,ut,Ue))}oe(R,M,u,g,h,g),oe(M,F,h,g,h,_),oe(F,B,h,_,u,_),oe(B,R,u,_,u,g),W-=re,q-=re,K+=re,ne+=re;const ye=1/Math.max(K-W,ne-q);return{scale:ye,x:W*ye,y:q*ye,x2:K*ye,y2:ne*ye,projection:r}}function i3(a,{x:r,y:o},u=0){return new xt(((r-u)*a.scale-a.x)*zt,(o*a.scale-a.y)*zt)}const T7=de(new Float32Array(16));class mh{constructor(r){this.spec=r,this.name=r.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(r,o){return{x:0,y:0,z:0}}unproject(r,o){return new H(0,0)}projectTilePoint(r,o,u){return{x:r,y:o,z:0}}locationPoint(r,o,u,h=!0){return r._coordinatePoint(r.locationCoordinate(o,u),h)}pixelsPerMeter(r,o){return fe(1,r)*o}pixelSpaceConversion(r,o,u){return 1}farthestPixelDistance(r){return r3(r,r.pixelsPerMeter)}pointCoordinate(r,o,u,h){const g=r.horizonLineFromTop(!1),_=new xt(o,Math.max(g,u));return r.rayIntersectionCoordinate(r.pointRayIntersection(_,h))}pointCoordinate3D(r,o,u){const h=new xt(o,u);if(r.elevation)return r.elevation.pointCoordinate(h);{const g=this.pointCoordinate(r,h.x,h.y,0);return[g.x,g.y,g.z]}}isPointAboveHorizon(r,o){if(r.elevation&&r.elevation.visibleDemTiles.length)return!this.pointCoordinate3D(r,o.x,o.y);const u=r.horizonLineFromTop();return o.y<u}createInversionMatrix(r,o){return T7}createTileMatrix(r,o,u){let h,g,_;const b=u.canonical,T=de(new Float64Array(16));if(this.isReprojectedInTileSpace){const E=Ly(b,this);h=1,g=E.x+u.wrap*E.scale,_=E.y,Ye(T,T,[h/E.scale,h/E.scale,r.pixelsPerMeter/o])}else h=o/r.zoomScale(b.z),g=(b.x+Math.pow(2,b.z)*u.wrap)*h,_=b.y*h;return Ge(T,T,[g,_,0]),Ye(T,T,[h/zt,h/zt,1]),T}upVector(r,o,u){return[0,0,1]}upVectorScale(r,o,u){return{metersToTile:1}}}class S7 extends mh{constructor(r){super(r),this.range=[4,7],this.center=r.center||[-96,37.5];const[o,u]=this.parallels=r.parallels||[29.5,45.5],h=Math.sin(Fe(o));this.n=(h+Math.sin(Fe(u)))/2,this.c=1+h*(2*this.n-h),this.r0=Math.sqrt(this.c)/this.n}project(r,o){const{n:u,c:h,r0:g}=this,_=Fe(r-this.center[0]),b=Fe(o),T=Math.sqrt(h-2*u*Math.sin(b))/u;return{x:T*Math.sin(_*u),y:T*Math.cos(_*u)-g,z:0}}unproject(r,o){const{n:u,c:h,r0:g}=this,_=g+o;let b=Math.atan2(r,Math.abs(_))*Math.sign(_);_*u<0&&(b-=Math.PI*Math.sign(r)*Math.sign(_));const T=Fe(this.center[0])*u;b=ze(b,-Math.PI-T,Math.PI-T);const E=be(Y(b/u)+this.center[0],-180,180),A=Math.asin(be((h-(r*r+_*_)*u*u)/(2*u),-1,1)),R=be(Y(A),-_e,_e);return new H(E,R)}}const zy=1.340264,Fy=-.081106,By=893e-6,Ny=.003796,z1=Math.sqrt(3)/2;class E7 extends mh{project(r,o){o=o/180*Math.PI,r=r/180*Math.PI;const u=Math.asin(z1*Math.sin(o)),h=u*u,g=h*h*h;return{x:.5*(r*Math.cos(u)/(z1*(zy+3*Fy*h+g*(7*By+9*Ny*h)))/Math.PI+.5),y:1-.5*(u*(zy+Fy*h+g*(By+Ny*h))/Math.PI+1),z:0}}unproject(r,o){r=(2*r-.5)*Math.PI;let u=o=(2*(1-o)-1)*Math.PI,h=u*u,g=h*h*h;for(let A,R,M,F=0;F<12&&(R=u*(zy+Fy*h+g*(By+Ny*h))-o,M=zy+3*Fy*h+g*(7*By+9*Ny*h),A=R/M,u=be(u-A,-Math.PI/3,Math.PI/3),h=u*u,g=h*h*h,!(Math.abs(A)<1e-12));++F);const _=z1*r*(zy+3*Fy*h+g*(7*By+9*Ny*h))/Math.cos(u),b=Math.asin(Math.sin(u)/z1),T=be(180*_/Math.PI,-180,180),E=be(180*b/Math.PI,-_e,_e);return new H(T,E)}}class C7 extends mh{constructor(r){super(r),this.wrap=!0,this.supportsWorldCopies=!0}project(r,o){return{x:.5+r/360,y:.5-o/360,z:0}}unproject(r,o){const u=360*(r-.5),h=be(360*(.5-o),-_e,_e);return new H(u,h)}}const qm=Math.PI/2;function F1(a){return Math.tan((qm+a)/2)}class I7 extends mh{constructor(r){super(r),this.center=r.center||[0,30];const[o,u]=this.parallels=r.parallels||[30,30];let h=Fe(o),g=Fe(u);this.southernCenter=h+g<0,this.southernCenter&&(h=-h,g=-g);const _=Math.cos(h),b=F1(h);this.n=h===g?Math.sin(h):Math.log(_/Math.cos(g))/Math.log(F1(g)/b),this.f=_*Math.pow(F1(h),this.n)/this.n}project(r,o){o=Fe(o),this.southernCenter&&(o=-o),r=Fe(r-this.center[0]);const u=1e-6,{n:h,f:g}=this;g>0?o<-qm+u&&(o=-qm+u):o>qm-u&&(o=qm-u);const _=g/Math.pow(F1(o),h);let b=_*Math.sin(h*r),T=g-_*Math.cos(h*r);return b=.5*(b/Math.PI+.5),T=.5*(T/Math.PI+.5),{x:b,y:this.southernCenter?T:1-T,z:0}}unproject(r,o){r=(2*r-.5)*Math.PI,this.southernCenter&&(o=1-o),o=(2*(1-o)-.5)*Math.PI;const{n:u,f:h}=this,g=h-o,_=Math.sign(g),b=Math.sign(u)*Math.sqrt(r*r+g*g);let T=Math.atan2(r,Math.abs(g))*_;g*u<0&&(T-=Math.PI*Math.sign(r)*_);const E=be(Y(T/u)+this.center[0],-180,180),A=be(Y(2*Math.atan(Math.pow(h/b,1/u))-qm),-_e,_e);return new H(E,this.southernCenter?-A:A)}}class o3 extends mh{constructor(r){super(r),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(r,o){return{x:se(r),y:me(o),z:0}}unproject(r,o){const u=ge(r),h=pe(o);return new H(u,h)}}const s3=Fe(_e);class A7 extends mh{project(r,o){const u=(o=Fe(o))*o,h=u*u;return{x:.5*((r=Fe(r))*(.8707-.131979*u+h*(h*(.003971*u-.001529*h)-.013791))/Math.PI+.5),y:1-.5*(o*(1.007226+u*(.015085+h*(.028874*u-.044475-.005916*h)))/Math.PI+1),z:0}}unproject(r,o){r=(2*r-.5)*Math.PI;let u=o=(2*(1-o)-1)*Math.PI,h=25,g=0,_=u*u;do{_=u*u;const E=_*_;g=(u*(1.007226+_*(.015085+E*(.028874*_-.044475-.005916*E)))-o)/(1.007226+_*(.045255+E*(.259866*_-.311325-.005916*11*E))),u=be(u-g,-s3,s3)}while(Math.abs(g)>1e-6&&--h>0);_=u*u;const b=be(Y(r/(.8707+_*(_*(_*_*_*(.003971-.001529*_)-.013791)-.131979))),-180,180),T=Y(u);return new H(b,T)}}const a3=Fe(_e);class P7 extends mh{project(r,o){o=Fe(o),r=Fe(r);const u=Math.cos(o),h=2/Math.PI,g=Math.acos(u*Math.cos(r/2)),_=Math.sin(g)/g,b=.5*(r*h+2*u*Math.sin(r/2)/_)||0,T=.5*(o+Math.sin(o)/_)||0;return{x:.5*(b/Math.PI+.5),y:1-.5*(T/Math.PI+1),z:0}}unproject(r,o){let u=r=(2*r-.5)*Math.PI,h=o=(2*(1-o)-1)*Math.PI,g=25;const _=1e-6;let b=0,T=0;do{const E=Math.cos(h),A=Math.sin(h),R=2*A*E,M=A*A,F=E*E,B=Math.cos(u/2),W=Math.sin(u/2),q=2*B*W,K=W*W,ne=1-F*B*B,re=ne?1/ne:0,oe=ne?Math.acos(E*B)*Math.sqrt(1/ne):0,ye=.5*(2*oe*E*W+2*u/Math.PI)-r,ve=.5*(oe*A+h)-o,Ce=.5*re*(F*K+oe*E*B*M)+1/Math.PI,Oe=re*(q*R/4-oe*A*W),De=.125*re*(R*W-oe*A*F*q),ut=.5*re*(M*B+oe*K*E)+.5,Ue=Oe*De-ut*Ce;b=(ve*Oe-ye*ut)/Ue,T=(ye*De-ve*Ce)/Ue,u=be(u-b,-Math.PI,Math.PI),h=be(h-T,-a3,a3)}while((Math.abs(b)>_||Math.abs(T)>_)&&--g>0);return new H(Y(u),Y(h))}}class l3 extends mh{constructor(r){super(r),this.center=r.center||[0,0],this.parallels=r.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(Fe(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(r,o){const{scale:u,cosPhi:h}=this;return{x:Fe(r)*h*u+.5,y:-Math.sin(Fe(o))/h*u+.5,z:0}}unproject(r,o){const{scale:u,cosPhi:h}=this,g=-(o-.5)/u,_=be(Y((r-.5)/u)/h,-180,180),b=Math.asin(be(g*h,-1,1)),T=be(Y(b),-_e,_e);return new H(_,T)}}class R7 extends o3{constructor(r){super(r),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug"],this.range=[3,5]}projectTilePoint(r,o,u){const h=uy(r,o,u);return vn(h,h,h1(Wc(u))),{x:h[0],y:h[1],z:h[2]}}locationPoint(r,o,u){const h=z(o.lat,o.lng),g=ur([],h),_=u?r._centerAltitude+u:r.elevation?r.elevation.getAtPointOrZero(r.locationCoordinate(o),r._centerAltitude):r._centerAltitude;vr(h,h,g,fe(1,0)*zt*_);const b=de(new Float64Array(16));return Be(b,r.pixelMatrix,r.globeMatrix),vn(h,h,b),new xt(h[0],h[1])}pixelsPerMeter(r,o){return fe(1,0)*o}pixelSpaceConversion(r,o,u){const h=fe(1,r)*o,g=wn(fe(1,45)*o,h,u);return this.pixelsPerMeter(r,o)/g}createTileMatrix(r,o,u){const h=MS(Wc(u.canonical));return Be(new Float64Array(16),r.globeMatrix,h)}createInversionMatrix(r,o){const{center:u}=r,h=h1(Wc(o));return Mt(h,h,Fe(u.lng)),Ne(h,h,Fe(u.lat)),Ye(h,h,[r._pixelsPerMercatorPixel,r._pixelsPerMercatorPixel,1]),Float32Array.from(h)}pointCoordinate(r,o,u,h){return OP(r,o,u,!0)||new it(0,0)}pointCoordinate3D(r,o,u){const h=this.pointCoordinate(r,o,u,0);return[h.x,h.y,h.z]}isPointAboveHorizon(r,o){return!OP(r,o.x,o.y,!1)}farthestPixelDistance(r){const o=(function(h,g){const _=h.cameraToCenterDistance,b=h._centerAltitude*g,T=h._camera,E=h._camera.forward(),A=mn([],or([],E,-_),[0,0,b]),R=h.worldSize/(2*Math.PI),M=[0,0,-R],F=h.width/h.height,B=Math.tan(h.fovAboveCenter),W=or([],T.up(),B),q=or([],T.right(),B*F),K=ur([],mn([],mn([],E,W),q)),ne=[];let re;if(new Mr(A,K).closestPointOnSphere(M,R,ne)){const oe=mn([],ne,M),ye=Lt([],oe,A);re=Math.cos(h.fovAboveCenter)*ke(ye)}else{const oe=Lt([],A,M),ye=Lt([],M,A);ur(ye,ye);const ve=ke(oe)-R;re=Math.sqrt(ve*(ve+2*R));const Ce=Math.acos(re/(R+ve))-Math.acos(Ot(E,ye));re*=Math.cos(Ce)}return 1.01*re})(r,this.pixelsPerMeter(r.center.lat,r.worldSize)),u=ch(r.zoom);if(u>0){const h=r3(r,fe(1,r.center.lat)*r.worldSize),g=r.worldSize/(2*Math.PI),_=Math.max(r.width,r.height)/r.worldSize*Math.PI;return wn(o,h+g*(1-Math.cos(_)),Math.pow(u,10))}return o}upVector(r,o,u){return uy(o,u,r,1)}upVectorScale(r){return{metersToTile:c1(d1(Wc(r)))}}}function c3(a){const r=a.parallels,o=!!r&&Math.abs(r[0]+r[1])<.01;switch(a.name){case"mercator":return new o3(a);case"equirectangular":return new C7(a);case"naturalEarth":return new A7(a);case"equalEarth":return new E7(a);case"winkelTripel":return new P7(a);case"albers":return o?new l3(a):new S7(a);case"lambertConformalConic":return o?new l3(a):new I7(a);case"globe":return new R7(a)}throw new Error(`Invalid projection name: ${a.name}`)}const k7=bt.types,O7=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function B1(a,r,o,u,h,g,_,b,T,E,A,R,M){const F=b?Math.min(ph,Math.round(b[0])):0,B=b?Math.min(ph,Math.round(b[1])):0;a.emplaceBack(r,o,Math.round(32*u),Math.round(32*h),g,_,(F<<1)+(T?1:0),B,16*E,16*A,256*R,256*M)}function N1(a,r,o){a.emplaceBack(r,o)}function V1(a,r,o,u,h,g,_){a.emplaceBack(r,o,u,h,g,_)}const $1=(a,r,o,u)=>{for(let h=0;h<r;h++)a.emplaceBack(o[0],o[1],o[2],u[0],u[1],u[2])};function U1(a,r,o,u,h){a.emplaceBack(r,o,u,h),a.emplaceBack(r,o,u,h),a.emplaceBack(r,o,u,h),a.emplaceBack(r,o,u,h)}function M7(a){for(const r of a.sections)if(bS(r.text))return!0;return!1}class CE{constructor(r){this.layoutVertexArray=new Q_,this.indexArray=new Mo,this.programConfigurations=r,this.segments=new Bi,this.dynamicLayoutVertexArray=new el,this.opacityVertexArray=new rh,this.placedSymbolArray=new km,this.iconTransitioningVertexArray=new Co,this.globeExtVertexArray=new ey,this.zOffsetVertexArray=new $c,this.orientationVertexArray=new Mf}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0&&this.iconTransitioningVertexArray.length===0}upload(r,o,u,h,g){this.isEmpty()||(u&&(this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,B$.members),this.indexBuffer=r.createIndexBuffer(this.indexArray,o),this.dynamicLayoutVertexBuffer=r.createVertexBuffer(this.dynamicLayoutVertexArray,V$.members,!0),this.opacityVertexBuffer=r.createVertexBuffer(this.opacityVertexArray,O7,!0),this.iconTransitioningVertexArray.length>0&&(this.iconTransitioningVertexBuffer=r.createVertexBuffer(this.iconTransitioningVertexArray,j$.members,!0)),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=r.createVertexBuffer(this.globeExtVertexArray,N$.members,!0)),!this.zOffsetVertexBuffer&&(this.zOffsetVertexArray.length>0||g)&&(this.zOffsetVertexBuffer=r.createVertexBuffer(this.zOffsetVertexArray,$$.members,!0)),!this.orientationVertexBuffer&&this.orientationVertexArray&&this.orientationVertexArray.length>0&&(this.orientationVertexBuffer=r.createVertexBuffer(this.orientationVertexArray,U$.members,!0)),this.opacityVertexBuffer.itemSize=1),(u||h)&&this.programConfigurations.upload(r))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.iconTransitioningVertexBuffer&&this.iconTransitioningVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy(),this.zOffsetVertexBuffer&&this.zOffsetVertexBuffer.destroy(),this.orientationVertexBuffer&&this.orientationVertexBuffer.destroy())}}Wt(CE,"SymbolBuffers");class IE{constructor(r,o,u){this.layoutVertexArray=new r,this.layoutAttributes=o,this.indexArray=new u,this.segments=new Bi,this.collisionVertexArray=new ny,this.collisionVertexArrayExt=new el}upload(r){this.layoutVertexBuffer=r.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=r.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=r.createVertexBuffer(this.collisionVertexArray,G$.members,!0),this.collisionVertexBufferExt=r.createVertexBuffer(this.collisionVertexArrayExt,H$.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}Wt(IE,"CollisionBuffers");class j1{constructor(r){this.collisionBoxArray=r.collisionBoxArray,this.zoom=r.zoom,this.overscaling=r.overscaling,this.layers=r.layers,this.layerIds=this.layers.map((_=>_.fqid)),this.index=r.index,this.pixelRatio=r.pixelRatio,this.sourceLayerIndex=r.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.hasAnyIconTextFit=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=de([]),this.placementViewportMatrix=de([]);const o=this.layers[0]._unevaluatedLayout._values;this.worldview=r.worldview,this.textSizeData=Bk(this.zoom,o["text-size"],this.worldview),this.iconSizeData=Bk(this.zoom,o["icon-size"],this.worldview);const u=this.layers[0].layout,h=u.get("symbol-sort-key"),g=u.get("symbol-z-order");this.lut=r.lut,this.canOverlap=u.get("text-allow-overlap")||u.get("icon-allow-overlap")||u.get("text-ignore-placement")||u.get("icon-ignore-placement"),this.sortFeaturesByKey=g!=="viewport-y"&&h.constantOr(1)!==void 0,this.sortFeaturesByY=(g==="viewport-y"||g==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=u.get("text-writing-mode").map((_=>wa[_])),this.stateDependentLayerIds=this.layers.filter((_=>_.isStateDependent())).map((_=>_.id)),this.sourceID=r.sourceID,this.projection=r.projection,this.hasAnyZOffset=!1,this.zOffsetSortDirty=!1,this.zOffsetBuffersNeedUpload=!1,this.elevationType="none",this.elevationStateComplete=!1,this.activeReplacements=[],this.replacementUpdateTime=0,this.hasAnySecondaryIcon=!1}createArrays(){this.text=new CE(new tl(this.layers,{zoom:this.zoom,lut:this.lut},(r=>r.startsWith("text")||r.startsWith("symbol")))),this.icon=new CE(new tl(this.layers,{zoom:this.zoom,lut:this.lut},(r=>r.startsWith("icon")||r.startsWith("symbol")))),this.glyphOffsetArray=new e1,this.lineVertexArray=new t1,this.symbolInstances=new Qb}calculateGlyphDependencies(r,o,u,h,g){for(const _ of r){const b=_.codePointAt(0);if(b===void 0)break;if(o[b]=!0,h&&g&&b<=65535){const T=Py[_];T&&(o[T.charCodeAt(0)]=!0)}}}updateFootprints(r,o){}updateReplacement(r,o){if(o.updateTime===this.replacementUpdateTime)return!1;this.replacementUpdateTime=o.updateTime;const u=o.getReplacementRegionsForTile(r.toUnwrapped(),!0);return!y1(this.activeReplacements,u)&&(this.activeReplacements=u,!0)}populate(r,o,u,h){const g=this.layers[0],_=g.layout,b=this.projection.name==="globe",T=_.get("text-font"),E=_.get("text-field"),A=_.get("icon-image"),[R,M]=_.get("icon-size-scale-range"),F=be(o.scaleFactor||1,R,M),B=(E.value.kind!=="constant"||E.value.value instanceof pt&&!E.value.value.isEmpty()||E.value.value.toString().length>0)&&(T.value.kind!=="constant"||T.value.value.length>0),W=A.value.kind!=="constant"||!!A.value.value||Object.keys(A.parameters).length>0,q=_.get("symbol-sort-key");if(this.features=[],!B&&!W)return;const K=o.iconDependencies,ne=o.glyphDependencies,re=o.availableImages,oe=new pi(this.zoom,{worldview:this.worldview});for(const{feature:ye,id:ve,index:Ce,sourceLayerIndex:Oe}of r){const De=g._featureFilter.needGeometry,ut=St(ye,De);if(!g._featureFilter.filter(oe,ut,u))continue;if(De||(ut.geometry=Ut(ye,u,h)),b&&ye.type!==1&&u.z<=5){const yt=ut.geometry,Et=.98078528056,lt=(vt,rt)=>Ot(uy(vt.x,vt.y,u,1),uy(rt.x,rt.y,u,1))<Et;for(let vt=0;vt<yt.length;vt++)yt[vt]=at(yt[vt],lt)}let Ue,ht;if(B){const yt=g.getValueAndResolveTokens("text-field",ut,u,re),Et=pt.factory(yt);M7(Et)&&(this.hasRTLText=!0),(!this.hasRTLText||ym()==="unavailable"||this.hasRTLText&&El.isParsed())&&(Ue=q$(Et,g,ut))}if(W){const yt=g.getValueAndResolveTokens("icon-image",ut,u,re);ht=typeof yt=="string"?gn.build(yt):yt}if(!Ue&&!ht)continue;const wt=this.sortFeaturesByKey?q.evaluate(ut,{},u):void 0,mt={id:ve,text:Ue,icon:ht,index:Ce,sourceLayerIndex:Oe,geometry:ut.geometry,properties:ye.properties,type:k7[ye.type],sortKey:wt};if(this.features.push(mt),ht){const yt=this.layers[0]._unevaluatedLayout._values,{iconPrimary:Et,iconSecondary:lt}=Qk(ht,this.iconSizeData,yt["icon-size"],u,this.zoom,mt,this.pixelRatio,F,this.worldview),vt=Et.id.toString();if(K.has(vt)?K.get(vt).push(Et):K.set(vt,[Et]),lt){this.hasAnySecondaryIcon=!0;const rt=lt.id.toString();K.has(rt)?K.get(rt).push(lt):K.set(rt,[lt])}}if(Ue){const yt=T.evaluate(ut,{},u).join(","),Et=_.get("text-rotation-alignment")==="map"&&_.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(wa.vertical)>=0;for(const lt of Ue.sections)if(lt.image){const vt=lt.image.getPrimary().scaleSelf(this.pixelRatio),rt=vt.id.toString(),Xe=K.get(rt)||[];Xe.push(vt),K.set(rt,Xe)}else{const vt=j_(Ue.toString()),rt=lt.fontStack||yt,Xe=ne[rt]=ne[rt]||{};this.calculateGlyphDependencies(lt.text,Xe,Et,this.allowVerticalPlacement,vt)}}}if(_.get("symbol-placement")==="line"&&(this.features=(function(ye){const ve={},Ce={},Oe=[];let De=0;function ut(mt){Oe.push(ye[mt]),De++}function Ue(mt,yt,Et){const lt=Ce[mt];return delete Ce[mt],Ce[yt]=lt,Oe[lt].geometry[0].pop(),Oe[lt].geometry[0]=Oe[lt].geometry[0].concat(Et[0]),lt}function ht(mt,yt,Et){const lt=ve[yt];return delete ve[yt],ve[mt]=lt,Oe[lt].geometry[0].shift(),Oe[lt].geometry[0]=Et[0].concat(Oe[lt].geometry[0]),lt}function wt(mt,yt,Et){const lt=Et?yt[0][yt[0].length-1]:yt[0][0];return`${mt}:${lt.x}:${lt.y}`}for(let mt=0;mt<ye.length;mt++){const yt=ye[mt],Et=yt.geometry,lt=yt.text?yt.text.toString():null;if(!lt){ut(mt);continue}const vt=wt(lt,Et),rt=wt(lt,Et,!0);if(vt in Ce&&rt in ve&&Ce[vt]!==ve[rt]){const Xe=ht(vt,rt,Et),Ct=Ue(vt,rt,Oe[Xe].geometry);delete ve[vt],delete Ce[rt],Ce[wt(lt,Oe[Ct].geometry,!0)]=Ct,Oe[Xe].geometry=null}else vt in Ce?Ue(vt,rt,Et):rt in ve?ht(vt,rt,Et):(ut(mt),ve[vt]=De-1,Ce[rt]=De-1)}return Oe.filter((mt=>mt.geometry))})(this.features)),_.get("symbol-elevation-reference")==="hd-road-markup"){if(this.elevationType="road",o.elevationFeatures){!this.elevationFeatures&&o.elevationFeatures.length>0&&(this.elevationFeatures=[],this.elevationFeatureIdToIndex=new Map);for(const ye of o.elevationFeatures)this.elevationFeatureIdToIndex.set(ye.id,this.elevationFeatures.length),this.elevationFeatures.push(ye)}}else _.get("symbol-z-elevate")&&(this.elevationType="offset");this.elevationType!=="none"&&(this.zOffsetBuffersNeedUpload=!0),this.sortFeaturesByKey&&this.features.sort(((ye,ve)=>ye.sortKey-ve.sortKey))}update(r,o,u,h,g,_,b){this.text.programConfigurations.updatePaintArrays(r,o,g,u,h,_,b,this.worldview),this.icon.programConfigurations.updatePaintArrays(r,o,g,u,h,_,b,this.worldview)}updateRoadElevation(r){if(this.elevationType!=="road"||!this.elevationFeatures||this.elevationStateComplete)return;this.elevationStateComplete=!0,this.hasAnyZOffset=!1;let o=!1;const u=We(r),h=1/u;let g=!1,_=!1;for(let b=0;b<this.symbolInstances.length;b++){const T=this.symbolInstances.get(b),E=Mn(1,0,0),A=Mn(0,1,0),{numHorizontalGlyphVertices:R,numVerticalGlyphVertices:M,numIconVertices:F,numVerticalIconVertices:B}=T,W=R>0||M>0,q=F>0,K=this.elevationFeatures[T.elevationFeatureIndex];if(K){const ne=new xt(T.tileAnchorX,T.tileAnchorY),re=.075+K.pointElevation(ne);T.zOffset!==re&&(o=!0,T.zOffset=re);const oe=K.computeSlopeNormal(ne,h),ye=So(Xn(),Mn(0,0,1),oe);He(E,E,ye),He(A,A,ye),E[2]*=u,A[2]*=u,E[0]===1&&E[1]===0&&E[2]===0&&A[0]===0&&A[1]===1&&A[2]===0||(g=g||W,_=_||q)}if(W&&($1(this.text.orientationVertexArray,R,E,A),$1(this.text.orientationVertexArray,M,E,A)),q){const{placedIconSymbolIndex:ne,verticalPlacedIconSymbolIndex:re}=T;ne>=0&&$1(this.icon.orientationVertexArray,F,E,A),re>=0&&$1(this.icon.orientationVertexArray,B,E,A)}}g||(this.text.orientationVertexArray=void 0),_||(this.icon.orientationVertexArray=void 0),o&&(this.zOffsetBuffersNeedUpload=!0,this.zOffsetSortDirty=!0)}updateZOffset(){const r=(g,_,b)=>{u+=_,u>g.length&&g.resize(u);for(let T=-_;T<0;T++)g.emplace(T+u,b)},o=(g,_,b)=>{h+=_,h>g.length&&g.resize(h);for(let T=-_;T<0;T++)g.emplace(T+h,b)};if(!this.zOffsetBuffersNeedUpload)return;this.zOffsetBuffersNeedUpload=!1;let u=0,h=0;for(let g=0;g<this.symbolInstances.length;g++){const _=this.symbolInstances.get(g),{numHorizontalGlyphVertices:b,numVerticalGlyphVertices:T,numIconVertices:E}=_,A=_.zOffset,R=E>0;if((b>0||T>0)&&(r(this.text.zOffsetVertexArray,b,A),r(this.text.zOffsetVertexArray,T,A)),R){const{placedIconSymbolIndex:M,verticalPlacedIconSymbolIndex:F}=_;M>=0&&o(this.icon.zOffsetVertexArray,E,A),F>=0&&o(this.icon.zOffsetVertexArray,_.numVerticalIconVertices,A)}}this.text.zOffsetVertexBuffer&&this.text.zOffsetVertexBuffer.updateData(this.text.zOffsetVertexArray),this.icon.zOffsetVertexBuffer&&this.icon.zOffsetVertexBuffer.updateData(this.icon.zOffsetVertexArray)}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(r){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(r),this.iconCollisionBox.upload(r)),this.text.upload(r,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload),this.icon.upload(r,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=c3(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(r,o){const u=this.lineVertexArray.length;if(r.segment!==void 0)for(const{x:h,y:g}of o)this.lineVertexArray.emplaceBack(h,g);return{lineStartIndex:u,lineLength:this.lineVertexArray.length-u}}addSymbols(r,o,u,h,g,_,b,T,E,A,R,M,F,B,W,q){const K=r.indexArray,ne=r.layoutVertexArray,re=r.globeExtVertexArray,oe=r.segments.prepareSegment(4*o.length,ne,K,this.canOverlap?_.sortKey:void 0),ye=this.glyphOffsetArray.length,ve=oe.vertexLength,Ce=this.allowVerticalPlacement&&b===wa.vertical?Math.PI/2:0,Oe=_.text&&_.text.sections;for(let ut=0;ut<o.length;ut++){const{tl:Ue,tr:ht,bl:wt,br:mt,texPrimary:yt,texSecondary:Et,pixelOffsetTL:lt,pixelOffsetBR:vt,minFontScaleX:rt,minFontScaleY:Xe,glyphOffset:Ct,isSDF:Tt,sectionIndex:hn}=o[ut],Ht=oe.vertexLength,Jt=Ct[1];if(B1(ne,E.x,E.y,Ue.x,Jt+Ue.y,yt.x,yt.y,u,Tt,lt.x,lt.y,rt,Xe),B1(ne,E.x,E.y,ht.x,Jt+ht.y,yt.x+yt.w,yt.y,u,Tt,vt.x,lt.y,rt,Xe),B1(ne,E.x,E.y,wt.x,Jt+wt.y,yt.x,yt.y+yt.h,u,Tt,lt.x,vt.y,rt,Xe),B1(ne,E.x,E.y,mt.x,Jt+mt.y,yt.x+yt.w,yt.y+yt.h,u,Tt,vt.x,vt.y,rt,Xe),T){const{x:Dt,y:dn,z:Fn}=T.anchor,[Vt,tn,An]=T.up;V1(re,Dt,dn,Fn,Vt,tn,An),V1(re,Dt,dn,Fn,Vt,tn,An),V1(re,Dt,dn,Fn,Vt,tn,An),V1(re,Dt,dn,Fn,Vt,tn,An),U1(r.dynamicLayoutVertexArray,Dt,dn,Fn,Ce)}else U1(r.dynamicLayoutVertexArray,E.x,E.y,E.z,Ce);if(q){const Dt=Et||yt;N1(r.iconTransitioningVertexArray,Dt.x,Dt.y),N1(r.iconTransitioningVertexArray,Dt.x+Dt.w,Dt.y),N1(r.iconTransitioningVertexArray,Dt.x,Dt.y+Dt.h),N1(r.iconTransitioningVertexArray,Dt.x+Dt.w,Dt.y+Dt.h)}K.emplaceBack(Ht,Ht+1,Ht+2),K.emplaceBack(Ht+1,Ht+2,Ht+3),oe.vertexLength+=4,oe.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Ct[0]),ut!==o.length-1&&hn===o[ut+1].sectionIndex||r.programConfigurations.populatePaintArrays(ne.length,_,_.index,{},F,B,W,Oe&&Oe[hn],this.worldview)}const De=T?T.anchor:E;r.placedSymbolArray.emplaceBack(De.x,De.y,De.z,E.x,E.y,ye,this.glyphOffsetArray.length-ye,ve,A,R,E.segment,u?u[0]:0,u?u[1]:0,h[0],h[1],b,0,0,0,M,0)}_commitLayoutVertex(r,o,u,h,g,_,b){r.emplaceBack(o,u,h,g,_,Math.round(b.x),Math.round(b.y))}_addCollisionDebugVertices(r,o,u,h,g,_,b){const T=u.segments.prepareSegment(4,u.layoutVertexArray,u.indexArray),E=T.vertexLength,A=b.tileAnchorX,R=b.tileAnchorY;for(let F=0;F<4;F++)u.collisionVertexArray.emplaceBack(0,0,0,0,0,0);this._commitDebugCollisionVertexUpdate(u.collisionVertexArrayExt,o,r.padding,b.zOffset),this._commitLayoutVertex(u.layoutVertexArray,h,g,_,A,R,new xt(r.x1,r.y1)),this._commitLayoutVertex(u.layoutVertexArray,h,g,_,A,R,new xt(r.x2,r.y1)),this._commitLayoutVertex(u.layoutVertexArray,h,g,_,A,R,new xt(r.x2,r.y2)),this._commitLayoutVertex(u.layoutVertexArray,h,g,_,A,R,new xt(r.x1,r.y2)),T.vertexLength+=4;const M=u.indexArray;M.emplaceBack(E,E+1),M.emplaceBack(E+1,E+2),M.emplaceBack(E+2,E+3),M.emplaceBack(E+3,E),T.primitiveLength+=4}_addTextDebugCollisionBoxes(r,o,u,h,g,_){for(let b=h;b<g;b++){const T=u.get(b),E=this.getSymbolInstanceTextSize(r,_,o,b);this._addCollisionDebugVertices(T,E,this.textCollisionBox,T.projectedAnchorX,T.projectedAnchorY,T.projectedAnchorZ,_)}}_addIconDebugCollisionBoxes(r,o,u,h,g,_){for(let b=h;b<g;b++){const T=u.get(b),E=this.getSymbolInstanceIconSize(r,o,_.placedIconSymbolIndex);this._addCollisionDebugVertices(T,E,this.iconCollisionBox,T.projectedAnchorX,T.projectedAnchorY,T.projectedAnchorZ,_)}}generateCollisionDebugBuffers(r,o,u){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new IE(Cm,Tk.members,Co),this.iconCollisionBox=new IE(Cm,Tk.members,Co);const h=ky(this.iconSizeData,r),g=ky(this.textSizeData,r,u);for(let _=0;_<this.symbolInstances.length;_++){const b=this.symbolInstances.get(_);this._addTextDebugCollisionBoxes(g,r,o,b.textBoxStartIndex,b.textBoxEndIndex,b),this._addTextDebugCollisionBoxes(g,r,o,b.verticalTextBoxStartIndex,b.verticalTextBoxEndIndex,b),this._addIconDebugCollisionBoxes(h,r,o,b.iconBoxStartIndex,b.iconBoxEndIndex,b),this._addIconDebugCollisionBoxes(h,r,o,b.verticalIconBoxStartIndex,b.verticalIconBoxEndIndex,b)}}getSymbolInstanceTextSize(r,o,u,h){const g=this.text.placedSymbolArray.get(o.rightJustifiedTextSymbolIndex>=0?o.rightJustifiedTextSymbolIndex:o.centerJustifiedTextSymbolIndex>=0?o.centerJustifiedTextSymbolIndex:o.leftJustifiedTextSymbolIndex>=0?o.leftJustifiedTextSymbolIndex:o.verticalPlacedTextSymbolIndex>=0?o.verticalPlacedTextSymbolIndex:h),_=vE(this.textSizeData,r,g)/Zo;return this.tilePixelRatio*_}getSymbolInstanceIconSize(r,o,u){const h=this.icon.placedSymbolArray.get(u),g=vE(this.iconSizeData,r,h);return this.tilePixelRatio*g}_commitDebugCollisionVertexUpdate(r,o,u,h){r.emplaceBack(o,-u,-u,h),r.emplaceBack(o,u,-u,h),r.emplaceBack(o,u,u,h),r.emplaceBack(o,-u,u,h)}_updateTextDebugCollisionBoxes(r,o,u,h,g,_,b){for(let T=h;T<g;T++){const E=u.get(T),A=this.getSymbolInstanceTextSize(r,_,o,T);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,A,E.padding,_.zOffset)}}_updateIconDebugCollisionBoxes(r,o,u,h,g,_,b){for(let T=h;T<g;T++){const E=u.get(T),A=this.getSymbolInstanceIconSize(r,o,_.placedIconSymbolIndex);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,A,E.padding,_.zOffset)}}updateCollisionDebugBuffers(r,o,u,h){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const g=ky(this.iconSizeData,r,h),_=ky(this.textSizeData,r,u);for(let b=0;b<this.symbolInstances.length;b++){const T=this.symbolInstances.get(b);this._updateTextDebugCollisionBoxes(_,r,o,T.textBoxStartIndex,T.textBoxEndIndex,T,u),this._updateTextDebugCollisionBoxes(_,r,o,T.verticalTextBoxStartIndex,T.verticalTextBoxEndIndex,T,u),this._updateIconDebugCollisionBoxes(g,r,o,T.iconBoxStartIndex,T.iconBoxEndIndex,T,h),this._updateIconDebugCollisionBoxes(g,r,o,T.verticalIconBoxStartIndex,T.verticalIconBoxEndIndex,T,h)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(r,o,u,h,g,_,b,T,E){const A={};if(o<u){const{x1:R,y1:M,x2:F,y2:B,padding:W,projectedAnchorX:q,projectedAnchorY:K,projectedAnchorZ:ne,tileAnchorX:re,tileAnchorY:oe,featureIndex:ye}=r.get(o);A.textBox={x1:R,y1:M,x2:F,y2:B,padding:W,projectedAnchorX:q,projectedAnchorY:K,projectedAnchorZ:ne,tileAnchorX:re,tileAnchorY:oe},A.textFeatureIndex=ye}if(h<g){const{x1:R,y1:M,x2:F,y2:B,padding:W,projectedAnchorX:q,projectedAnchorY:K,projectedAnchorZ:ne,tileAnchorX:re,tileAnchorY:oe,featureIndex:ye}=r.get(h);A.verticalTextBox={x1:R,y1:M,x2:F,y2:B,padding:W,projectedAnchorX:q,projectedAnchorY:K,projectedAnchorZ:ne,tileAnchorX:re,tileAnchorY:oe},A.verticalTextFeatureIndex=ye}if(_<b){const{x1:R,y1:M,x2:F,y2:B,padding:W,projectedAnchorX:q,projectedAnchorY:K,projectedAnchorZ:ne,tileAnchorX:re,tileAnchorY:oe,featureIndex:ye}=r.get(_);A.iconBox={x1:R,y1:M,x2:F,y2:B,padding:W,projectedAnchorX:q,projectedAnchorY:K,projectedAnchorZ:ne,tileAnchorX:re,tileAnchorY:oe},A.iconFeatureIndex=ye}if(T<E){const{x1:R,y1:M,x2:F,y2:B,padding:W,projectedAnchorX:q,projectedAnchorY:K,projectedAnchorZ:ne,tileAnchorX:re,tileAnchorY:oe,featureIndex:ye}=r.get(T);A.verticalIconBox={x1:R,y1:M,x2:F,y2:B,padding:W,projectedAnchorX:q,projectedAnchorY:K,projectedAnchorZ:ne,tileAnchorX:re,tileAnchorY:oe},A.verticalIconFeatureIndex=ye}return A}deserializeCollisionBoxes(r){this.collisionArrays=[];for(let o=0;o<this.symbolInstances.length;o++){const u=this.symbolInstances.get(o);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(r,u.textBoxStartIndex,u.textBoxEndIndex,u.verticalTextBoxStartIndex,u.verticalTextBoxEndIndex,u.iconBoxStartIndex,u.iconBoxEndIndex,u.verticalIconBoxStartIndex,u.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}hasIconTextFit(){return this.hasAnyIconTextFit}addIndicesForPlacedSymbol(r,o){const u=r.placedSymbolArray.get(o),h=u.vertexStartIndex+4*u.numGlyphs;for(let g=u.vertexStartIndex;g<h;g+=4)r.indexArray.emplaceBack(g,g+1,g+2),r.indexArray.emplaceBack(g+1,g+2,g+3)}getSortedSymbolIndexes(r){if(this.sortedAngle===r&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const o=Math.sin(r),u=Math.cos(r),h=[],g=[],_=[];for(let b=0;b<this.symbolInstances.length;++b){_.push(b);const T=this.symbolInstances.get(b);h.push(0|Math.round(o*T.tileAnchorX+u*T.tileAnchorY)),g.push(T.featureIndex)}return _.sort(((b,T)=>h[b]-h[T]||g[T]-g[b])),_}getSortedIndexesByZOffset(){if(!this.zOffsetSortDirty)return this.symbolInstanceIndexesSortedZOffset;if(!this.symbolInstanceIndexesSortedZOffset){this.symbolInstanceIndexesSortedZOffset=[];for(let r=0;r<this.symbolInstances.length;++r)this.symbolInstanceIndexesSortedZOffset.push(r)}return this.zOffsetSortDirty=!1,this.symbolInstanceIndexesSortedZOffset.sort(((r,o)=>this.symbolInstances.get(o).zOffset-this.symbolInstances.get(r).zOffset))}addToSortKeyRanges(r,o){const u=this.sortKeyRanges[this.sortKeyRanges.length-1];u&&u.sortKey===o?u.symbolInstanceEnd=r+1:this.sortKeyRanges.push({sortKey:o,symbolInstanceStart:r,symbolInstanceEnd:r+1})}sortFeatures(r){if(this.sortFeaturesByY&&this.sortedAngle!==r&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(r),this.sortedAngle=r,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const o of this.symbolInstanceIndexes){const u=this.symbolInstances.get(o);this.featureSortOrder.push(u.featureIndex);const{rightJustifiedTextSymbolIndex:h,centerJustifiedTextSymbolIndex:g,leftJustifiedTextSymbolIndex:_,verticalPlacedTextSymbolIndex:b,placedIconSymbolIndex:T,verticalPlacedIconSymbolIndex:E}=u;h>=0&&this.addIndicesForPlacedSymbol(this.text,h),g>=0&&g!==h&&this.addIndicesForPlacedSymbol(this.text,g),_>=0&&_!==g&&_!==h&&this.addIndicesForPlacedSymbol(this.text,_),b>=0&&this.addIndicesForPlacedSymbol(this.text,b),T>=0&&this.addIndicesForPlacedSymbol(this.icon,T),E>=0&&this.addIndicesForPlacedSymbol(this.icon,E)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let u3,d3,AE;Wt(j1,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),j1.addDynamicAttributes=U1;class h3{constructor(r){this.type=r.property.overrides?r.property.overrides.runtimeType:Zs,this.defaultValue=r}evaluate(r){if(r.formattedSection){const o=this.defaultValue.property.overrides;if(o&&o.hasOverride(r.formattedSection))return o.getOverride(r.formattedSection)}return r.feature&&r.featureState?this.defaultValue.evaluate(r.feature,r.featureState):this.defaultValue.property.specification.default}eachChild(r){this.defaultValue.isConstant()||r(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Wt(h3,"FormatSectionOverride",{omit:["defaultValue"]});const PE=()=>AE||(AE={layout:u3||(u3=new Wi({"symbol-placement":new It($e.layout_symbol["symbol-placement"]),"symbol-spacing":new It($e.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new It($e.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new $t($e.layout_symbol["symbol-sort-key"]),"symbol-z-order":new It($e.layout_symbol["symbol-z-order"]),"symbol-z-elevate":new It($e.layout_symbol["symbol-z-elevate"]),"symbol-elevation-reference":new It($e.layout_symbol["symbol-elevation-reference"]),"icon-allow-overlap":new It($e.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new It($e.layout_symbol["icon-ignore-placement"]),"icon-optional":new It($e.layout_symbol["icon-optional"]),"icon-rotation-alignment":new It($e.layout_symbol["icon-rotation-alignment"]),"icon-size":new $t($e.layout_symbol["icon-size"]),"icon-size-scale-range":new It($e.layout_symbol["icon-size-scale-range"]),"icon-text-fit":new $t($e.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new $t($e.layout_symbol["icon-text-fit-padding"]),"icon-image":new $t($e.layout_symbol["icon-image"]),"icon-image-use-theme":new It({type:"string",default:"default","property-type":"data-constant"}),"icon-rotate":new $t($e.layout_symbol["icon-rotate"]),"icon-padding":new It($e.layout_symbol["icon-padding"]),"icon-keep-upright":new It($e.layout_symbol["icon-keep-upright"]),"icon-offset":new $t($e.layout_symbol["icon-offset"]),"icon-anchor":new $t($e.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new It($e.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new It($e.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new It($e.layout_symbol["text-rotation-alignment"]),"text-field":new $t($e.layout_symbol["text-field"]),"text-font":new $t($e.layout_symbol["text-font"]),"text-size":new $t($e.layout_symbol["text-size"]),"text-size-scale-range":new It($e.layout_symbol["text-size-scale-range"]),"text-max-width":new $t($e.layout_symbol["text-max-width"]),"text-line-height":new $t($e.layout_symbol["text-line-height"]),"text-letter-spacing":new $t($e.layout_symbol["text-letter-spacing"]),"text-justify":new $t($e.layout_symbol["text-justify"]),"text-radial-offset":new $t($e.layout_symbol["text-radial-offset"]),"text-variable-anchor":new It($e.layout_symbol["text-variable-anchor"]),"text-anchor":new $t($e.layout_symbol["text-anchor"]),"text-max-angle":new It($e.layout_symbol["text-max-angle"]),"text-writing-mode":new It($e.layout_symbol["text-writing-mode"]),"text-rotate":new $t($e.layout_symbol["text-rotate"]),"text-padding":new It($e.layout_symbol["text-padding"]),"text-keep-upright":new It($e.layout_symbol["text-keep-upright"]),"text-transform":new $t($e.layout_symbol["text-transform"]),"text-offset":new $t($e.layout_symbol["text-offset"]),"text-allow-overlap":new It($e.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new It($e.layout_symbol["text-ignore-placement"]),"text-optional":new It($e.layout_symbol["text-optional"]),visibility:new It($e.layout_symbol.visibility)})),paint:d3||(d3=new Wi({"icon-opacity":new $t($e.paint_symbol["icon-opacity"]),"icon-occlusion-opacity":new $t($e.paint_symbol["icon-occlusion-opacity"]),"icon-emissive-strength":new $t($e.paint_symbol["icon-emissive-strength"]),"text-emissive-strength":new $t($e.paint_symbol["text-emissive-strength"]),"icon-color":new $t($e.paint_symbol["icon-color"]),"icon-halo-color":new $t($e.paint_symbol["icon-halo-color"]),"icon-halo-width":new $t($e.paint_symbol["icon-halo-width"]),"icon-halo-blur":new $t($e.paint_symbol["icon-halo-blur"]),"icon-translate":new It($e.paint_symbol["icon-translate"]),"icon-translate-anchor":new It($e.paint_symbol["icon-translate-anchor"]),"icon-image-cross-fade":new It($e.paint_symbol["icon-image-cross-fade"]),"text-opacity":new $t($e.paint_symbol["text-opacity"]),"text-occlusion-opacity":new $t($e.paint_symbol["text-occlusion-opacity"]),"text-color":new $t($e.paint_symbol["text-color"],{runtimeType:us,getOverride:a=>a.textColor,hasOverride:a=>!!a.textColor}),"text-halo-color":new $t($e.paint_symbol["text-halo-color"]),"text-halo-width":new $t($e.paint_symbol["text-halo-width"]),"text-halo-blur":new $t($e.paint_symbol["text-halo-blur"]),"text-translate":new It($e.paint_symbol["text-translate"]),"text-translate-anchor":new It($e.paint_symbol["text-translate-anchor"]),"icon-color-saturation":new It($e.paint_symbol["icon-color-saturation"]),"icon-color-contrast":new It($e.paint_symbol["icon-color-contrast"]),"icon-color-brightness-min":new It($e.paint_symbol["icon-color-brightness-min"]),"icon-color-brightness-max":new It($e.paint_symbol["icon-color-brightness-max"]),"symbol-z-offset":new $t($e.paint_symbol["symbol-z-offset"]),"icon-color-use-theme":new $t({type:"string",default:"default","property-type":"data-driven"}),"icon-halo-color-use-theme":new $t({type:"string",default:"default","property-type":"data-driven"}),"text-color-use-theme":new $t({type:"string",default:"default","property-type":"data-driven"}),"text-halo-color-use-theme":new $t({type:"string",default:"default","property-type":"data-driven"})}))},AE);class G1 extends hs{constructor(r,o,u,h){super(r,PE(),o,u,h,r.layout?r.layout["icon-image-use-theme"]:null),this._colorAdjustmentMatrix=de([]),this.hasOcclusionOpacityProperties=r.paint!==void 0&&("icon-occlusion-opacity"in r.paint||"text-occlusion-opacity"in r.paint)}_handleSpecialPaintPropertyUpdate(r){r!=="icon-occlusion-opacity"&&r!=="text-occlusion-opacity"||(this.hasOcclusionOpacityProperties=!0)}recalculate(r,o){super.recalculate(r,o),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const u=this.layout.get("text-writing-mode");if(u){const h=[];for(const g of u)h.indexOf(g)<0&&h.push(g);this.layout._values["text-writing-mode"]=h}else this.layout._values["text-writing-mode"]=this.layout.get("symbol-placement")==="point"?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getColorAdjustmentMatrix(r,o,u,h){return this._saturation===r&&this._contrast===o&&this._brightnessMin===u&&this._brightnessMax===h||(this._colorAdjustmentMatrix=(function(g,_,b,T){g=_s(g),_=Xo(_);const E=ue(),A=g/3,R=1-2*A,M=[R,A,A,0,A,R,A,0,A,A,R,0,0,0,0,1],F=.5-.5*_,B=T-b;return Be(E,[B,0,0,0,0,B,0,0,0,0,B,0,b,b,b,1],[_,0,0,0,0,_,0,0,0,0,_,0,F,F,F,1]),Be(E,E,M),E})(r,o,u,h),this._saturation=r,this._contrast=o,this._brightnessMin=u,this._brightnessMax=h),this._colorAdjustmentMatrix}getValueAndResolveTokens(r,o,u,h){const g=this.layout.get(r).evaluate(o,{},u,h),_=this._unevaluatedLayout._values[r];return _.isDataDriven()||V_(_.value)||!g?g:(function(b,T){return T.replace(/{([^{}]+)}/g,((E,A)=>A in b?String(b[A]):""))})(o.properties,g)}createBucket(r){return new j1(r)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const r of PE().paint.overridableProperties){if(!G1.hasPaintOverride(this.layout,r))continue;const o=this.paint.get(r),u=new h3(o),h=new dm(u,o.property.specification,this.scope,this.options,this.layout.get("icon-image-use-theme"));let g=null;g=o.value.kind==="constant"||o.value.kind==="source"?new Af("source",h):new Lc("composite",h,o.value.zoomStops,o.value.interpolationType),this.paint._values[r]=new Wu(o.property,g,o.parameters)}}_handleOverridablePaintPropertyUpdate(r,o,u){return!(!this.layout||o.isDataDriven()||u.isDataDriven())&&G1.hasPaintOverride(this.layout,r)}static hasPaintOverride(r,o){const u=r.get("text-field"),h=PE().paint.properties[o];let g=!1;const _=b=>{for(const T of b)if(h.overrides&&h.overrides.hasOverride(T))return void(g=!0)};if(u.value.kind==="constant"&&u.value.value instanceof pt)_(u.value.value.sections);else if(u.value.kind==="source"){const b=E=>{g||(E instanceof In&&yr(E.value)===Xa?_(E.value.sections):E instanceof Ya?_(E.sections):E.eachChild(b))},T=u.value;T._styleExpression&&b(T._styleExpression.expression)}return g}getProgramIds(){return["symbol"]}getDefaultProgramParams(r,o,u){return{config:new Qu(this,{zoom:o,lut:u}),overrideFog:!1}}hasElevation(){return this.layout&&this.layout.get("symbol-elevation-reference")==="hd-road-markup"}}let f3,p3,m3,g3;var RE=gr([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);function H1(a,r,o,u,h,g,_,b){const T=[a,r,1,o,u,1,h,g,1],E=[_,b,1],A=V([],T),[R,M,F]=Nr(E,E,A);return j(T,T,[R,0,0,0,M,0,0,0,F])}function _3(a,r,o,u,h,g,_,b){const T=(function(E,A,R,M,F,B,W,q){const K=H1(0,0,1,0,1,1,0,1),ne=H1(E,A,R,M,F,B,W,q);return j(ne,ne,V([],K))})(a,r,o,u,h,g,_,b);return[T[2]/T[8]/zt,T[5]/T[8]/zt]}function W1(a){return[a[0],Math.min(Math.max(a[1],-_e),_e)]}class y3 extends xl{constructor(r,o,u,h){super(),this.id=r,this.dispatcher=u,this.coordinates=o.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.onNorthPole=!1,this.onSouthPole=!1,this.setEventedParent(h),this.options=o,this._dirty=!1}load(r,o){if(this._loaded=o||!1,this.fire(new qs("dataloading",{dataType:"source"})),this.url=this.options.url,!this.url)return r&&(this.coordinates=r),this._loaded=!0,void this._finishLoading();this._imageRequest=La(this.map._requestManager.transformRequest(this.url,Od.Image),((u,h)=>{this._imageRequest=null,this._loaded=!0,u?this.fire(new bl(u)):h&&(this.image=h instanceof HTMLImageElement?Ms.getImageData(h):h,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,r&&(this.coordinates=r),this._finishLoading())}))}loaded(){return this._loaded}updateImage(r){return r.url?(this._imageRequest&&r.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=r.url,this.load(r.coordinates,this._loaded),this):this}setTexture(r){if(!(r.handle instanceof WebGLTexture))throw new Error("The provided handle is not a WebGLTexture instance");return this.texture=new Cy(this.map.painter.context,r.handle),this.width=r.dimensions[0],this.height=r.dimensions[1],this._dirty=!1,this._loaded=!0,this._finishLoading(),this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new qs("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(r){this.map=r,this.load()}onRemove(r){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),!this.texture||this.texture instanceof Cy||this.texture.destroy(),this.boundsBuffer&&(this.boundsBuffer.destroy(),this.elevatedGlobeVertexBuffer&&this.elevatedGlobeVertexBuffer.destroy(),this.elevatedGlobeIndexBuffer&&this.elevatedGlobeIndexBuffer.destroy())}setCoordinates(r){if(this.coordinates=r,this._boundsArray=void 0,this._unsupportedCoords=!1,!r.length)return this;this.onNorthPole=!1,this.onSouthPole=!1;let o=r[0][1],u=r[0][1];for(const g of r)g[1]>u&&(u=g[1]),g[1]<o&&(o=g[1]);const h=(u+o)/2;if(h>_e?this.onNorthPole=!0:h<-_e&&(this.onSouthPole=!0),!this.onNorthPole&&!this.onSouthPole){const g=r.map(it.fromLngLat);this.tileID=(function(_){let b=1/0,T=1/0,E=-1/0,A=-1/0;for(const W of _)b=Math.min(b,W.x),T=Math.min(T,W.y),E=Math.max(E,W.x),A=Math.max(A,W.y);const R=Math.max(E-b,A-T),M=Math.max(0,Math.floor(-Math.log2(R))),F=Math.pow(2,M);let B=Math.floor((b+E)/2*F);return B>1&&(B-=1),new rc(M,B,Math.floor((T+A)/2*F))})(g),this.minzoom=this.maxzoom=this.tileID.z}return this.fire(new qs("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){!this.texture||this.texture instanceof Cy||(this.texture.destroy(),this._dirty=!0),this.texture=null,this._boundsArray=void 0,this._unsupportedCoords=!1}_prepareData(r){for(const K in this.tiles){const ne=this.tiles[K];ne.state!=="loaded"&&(ne.state="loaded",ne.texture=this.texture)}if(this._boundsArray||this.onNorthPole||this.onSouthPole||this._unsupportedCoords)return;const o=Ly(new rc(0,0,0),this.map.transform.projection),u=[o.projection.project(this.coordinates[0][0],this.coordinates[0][1]),o.projection.project(this.coordinates[1][0],this.coordinates[1][1]),o.projection.project(this.coordinates[2][0],this.coordinates[2][1]),o.projection.project(this.coordinates[3][0],this.coordinates[3][1])];if(!(function(K){const ne=K[1].x-K[0].x,re=K[1].y-K[0].y,oe=K[2].x-K[1].x,ye=K[2].y-K[1].y,ve=K[3].x-K[2].x,Ce=K[3].y-K[2].y,Oe=K[0].x-K[3].x,De=K[0].y-K[3].y,ut=ne*ye-oe*re,Ue=oe*Ce-ve*ye,ht=ve*De-Oe*Ce,wt=Oe*re-ne*De;return ut>0&&Ue>0&&ht>0&&wt>0||ut<0&&Ue<0&&ht<0&&wt<0})(u))return console.warn("Image source coordinates are defining non-convex area in the Mercator projection"),void(this._unsupportedCoords=!0);const h=Ly(this.tileID,this.map.transform.projection),[g,_,b,T]=this.coordinates.map((K=>{const ne=h.projection.project(K[0],K[1]);return i3(h,ne)._round()}));this.perspectiveTransform=_3(g.x,g.y,_.x,_.y,b.x,b.y,T.x,T.y);const E=this._boundsArray=new Xu;E.emplaceBack(g.x,g.y,0,0),E.emplaceBack(_.x,_.y,zt,0),E.emplaceBack(T.x,T.y,0,zt),E.emplaceBack(b.x,b.y,zt,zt),this.boundsBuffer&&(this.boundsBuffer.destroy(),this.elevatedGlobeVertexBuffer&&this.elevatedGlobeVertexBuffer.destroy(),this.elevatedGlobeIndexBuffer&&this.elevatedGlobeIndexBuffer.destroy()),this.boundsBuffer=r.createVertexBuffer(E,RE.members),this.boundsSegments=Bi.simpleSegment(0,0,4,2);const A=[],R=[W1((M=this.coordinates)[0]),W1(M[1]),W1(M[2]),W1(M[3])];var M;const[F,B,W,q]=(function(K){let ne=K[0][0],re=ne,oe=K[0][1],ye=oe;for(let ve=1;ve<K.length;ve++)K[ve][0]<ne?ne=K[ve][0]:K[ve][0]>re&&(re=K[ve][0]),K[ve][1]<oe?oe=K[ve][1]:K[ve][1]>ye&&(ye=K[ve][1]);return[ne,oe,re-ne,ye-oe]})(R);{const K=new Xu,[ne,re,oe,ye]=(function(lt){let vt=lt[0].x,rt=vt,Xe=lt[0].y,Ct=Xe;for(let Tt=1;Tt<lt.length;Tt++)lt[Tt].x<vt?vt=lt[Tt].x:lt[Tt].x>rt&&(rt=lt[Tt].x),lt[Tt].y<Xe?Xe=lt[Tt].y:lt[Tt].y>Ct&&(Ct=lt[Tt].y);return[vt,Xe,rt-vt,Ct-Xe]})(u),ve=lt=>[(lt.x-ne)/oe,(lt.y-re)/ye],[Ce,Oe,De,ut]=u.map(ve),Ue=(function(lt,vt,rt,Xe,Ct,Tt,hn,Ht){const Jt=H1(0,0,1,0,1,1,0,1);return j(Jt,Jt,V([],H1(lt,vt,rt,Xe,Ct,Tt,hn,Ht)))})(Ce[0],Ce[1],Oe[0],Oe[1],De[0],De[1],ut[0],ut[1]);this.elevatedGlobePerspectiveTransform=_3(Ce[0],Ce[1],Oe[0],Oe[1],De[0],De[1],ut[0],ut[1]);const ht=(lt,vt)=>{A.push(lt.lng);const rt=Math.round((lt.lng-F)/W*zt),Xe=Math.round((lt.lat-B)/q*zt),Ct=ve(vt),Tt=Nr([],[Ct[0],Ct[1],1],Ue),hn=Math.round(Tt[0]/Tt[2]*zt),Ht=Math.round(Tt[1]/Tt[2]*zt);K.emplaceBack(rt,Xe,hn,Ht)},wt=u[3].x-u[0].x,mt=u[3].y-u[0].y,yt=u[2].x-u[1].x,Et=u[2].y-u[1].y;for(let lt=0;lt<65;lt++){const vt=lt/64,rt=[u[0].x+vt*wt,u[0].y+vt*mt],Xe=[u[1].x+vt*yt,u[1].y+vt*Et],Ct=Xe[0]-rt[0],Tt=Xe[1]-rt[1];for(let hn=0;hn<65;hn++){const Ht=hn/64,Jt={x:rt[0]+Ct*Ht,y:rt[1]+Tt*Ht};ht(o.projection.unproject(Jt.x,Jt.y),Jt)}}this.elevatedGlobeVertexBuffer=r.createVertexBuffer(K,RE.members)}{this.maxLongitudeTriangleSize=0;let K=[],ne=new Mo;const re=(oe,ye,ve)=>{ne.emplaceBack(oe,ye,ve);const Ce=A[oe],Oe=A[ye],De=A[ve],ut=Math.min(Math.min(Ce,Oe),De),Ue=Math.max(Math.max(Ce,Oe),De)-ut;Ue>this.maxLongitudeTriangleSize&&(this.maxLongitudeTriangleSize=Ue),K.push(ut+Ue/2)};for(let oe=0;oe<64;oe++)for(let ye=0;ye<64;ye++){const ve=65*oe+ye,Ce=ve+1,Oe=ve+65,De=Oe+1;re(ve,Oe,Ce),re(Ce,Oe,De)}[K,ne]=(function(oe,ye){const ve=Array.from({length:oe.length},((De,ut)=>ut));ve.sort(((De,ut)=>oe[De]-oe[ut]));const Ce=[],Oe=new Mo;for(let De=0;De<ve.length;De++){const ut=ve[De];Ce.push(oe[ut]);const Ue=3*ut,ht=Ue+1;Oe.emplaceBack(ye.uint16[Ue],ye.uint16[ht],ye.uint16[ht+1])}return[Ce,Oe]})(K,ne),this.elevatedGlobeTrianglesCenterLongitudes=K,this.elevatedGlobeIndexBuffer=r.createIndexBuffer(ne)}this.elevatedGlobeSegments=Bi.simpleSegment(0,0,4225,8192),this.elevatedGlobeGridMatrix=new Float32Array([0,W/zt,0,q/zt,0,0,B,F,0])}prepare(){const r=Object.keys(this.tiles).length!==0;if(this.tileID&&!r)return;const o=this.map.painter.context,u=o.gl;!this._dirty||this.texture instanceof Cy||(this.texture?this.texture.update(this.image):(this.texture=new iE(o,this.image,u.RGBA8),this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE)),this._dirty=!1),r&&this._prepareData(o)}loadTile(r,o){this.tileID&&this.tileID.equals(r.tileID.canonical)?(this.tiles[String(r.tileID.wrap)]=r,r.buckets={},o(null)):(r.state="errored",o(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}getSegmentsForLongitude(r){const o=this.elevatedGlobeSegments;if(!this.elevatedGlobeTrianglesCenterLongitudes||!o)return null;const u=this.elevatedGlobeTrianglesCenterLongitudes;let h=(g=r+180)+360*Math.round((u[0]-g)/360);var g;const _=new Bi,b=(R,M)=>{_.segments.push({vertexOffset:0,primitiveOffset:R,vertexLength:o.segments[0].vertexLength,primitiveLength:M,sortKey:void 0,vaos:{}})},T=.51*this.maxLongitudeTriangleSize;if(Math.abs(u[0]-h)<=T){const R=Bo(u,0,u.length,h+T);return R===u.length||b(R,hi(u,R+1,u.length,h+360-T)-R),_}h<u[0]&&(h+=360);const E=hi(u,0,u.length,h-T);if(E===u.length)return b(0,u.length),_;b(0,E-0);const A=Bo(u,E+1,u.length,h+T);return A!==u.length&&b(A,u.length-A),_}}const D7=(Math.pow(256,2)-1)/16907520;class v3 extends hs{constructor(r,o,u,h){super(r,{layout:m3||(m3=new Wi({visibility:new It($e.layout_raster.visibility)})),paint:g3||(g3=new Wi({"raster-opacity":new It($e.paint_raster["raster-opacity"]),"raster-color":new Jd($e.paint_raster["raster-color"]),"raster-color-mix":new It($e.paint_raster["raster-color-mix"]),"raster-color-range":new It($e.paint_raster["raster-color-range"]),"raster-hue-rotate":new It($e.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new It($e.paint_raster["raster-brightness-min"]),"raster-brightness-max":new It($e.paint_raster["raster-brightness-max"]),"raster-saturation":new It($e.paint_raster["raster-saturation"]),"raster-contrast":new It($e.paint_raster["raster-contrast"]),"raster-resampling":new It($e.paint_raster["raster-resampling"]),"raster-fade-duration":new It($e.paint_raster["raster-fade-duration"]),"raster-emissive-strength":new It($e.paint_raster["raster-emissive-strength"]),"raster-array-band":new It($e.paint_raster["raster-array-band"]),"raster-elevation":new It($e.paint_raster["raster-elevation"]),"raster-color-use-theme":new $t({type:"string",default:"default","property-type":"data-driven"})}))},o,u,h),this.updateColorRamp(),this._curRampRange=[NaN,NaN]}getProgramIds(){return["raster"]}hasColorMap(){return!!this._transitionablePaint._values["raster-color"].value.value}tileCoverLift(){return this.paint.get("raster-elevation")}isDraped(r){return!(r&&r._source instanceof y3&&(r._source.onNorthPole||r._source.onSouthPole))&&this.paint.get("raster-elevation")===0}_handleSpecialPaintPropertyUpdate(r){r!=="raster-color"&&r!=="raster-color-range"||(this._curRampRange=[NaN,NaN],this.updateColorRamp())}_clear(){this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}updateColorRamp(r){if(!this.hasColorMap()||!this._curRampRange)return;const o=this._transitionablePaint._values["raster-color"].value.expression,[u,h]=r||this._transitionablePaint._values["raster-color-range"].value.expression.evaluate({zoom:0})||[NaN,NaN];isNaN(u)&&isNaN(h)||u===this._curRampRange[0]&&h===this._curRampRange[1]||(this.colorRamp=dy({expression:o,evaluationKey:"rasterValue",image:this.colorRamp,clips:[{start:u,end:h}],resolution:256}),this.colorRampTexture=null,this._curRampRange=[u,h])}}let b3,x3,w3,T3,S3;class E3 extends hs{constructor(r,o,u,h){super(r,{layout:b3||(b3=new Wi({visibility:new It($e["layout_raster-particle"].visibility)})),paint:x3||(x3=new Wi({"raster-particle-array-band":new It($e["paint_raster-particle"]["raster-particle-array-band"]),"raster-particle-count":new It($e["paint_raster-particle"]["raster-particle-count"]),"raster-particle-color":new Jd($e["paint_raster-particle"]["raster-particle-color"]),"raster-particle-max-speed":new It($e["paint_raster-particle"]["raster-particle-max-speed"]),"raster-particle-speed-factor":new It($e["paint_raster-particle"]["raster-particle-speed-factor"]),"raster-particle-fade-opacity-factor":new It($e["paint_raster-particle"]["raster-particle-fade-opacity-factor"]),"raster-particle-reset-rate-factor":new It($e["paint_raster-particle"]["raster-particle-reset-rate-factor"]),"raster-particle-elevation":new It($e["paint_raster-particle"]["raster-particle-elevation"]),"raster-particle-color-use-theme":new $t({type:"string",default:"default","property-type":"data-driven"})}))},o,u,h),this._updateColorRamp(),this.lastInvalidatedAt=Ms.now()}_clear(){this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null),this.tileFramebuffer&&(this.tileFramebuffer.destroy(),this.tileFramebuffer=null),this.particleFramebuffer&&(this.particleFramebuffer.destroy(),this.particleFramebuffer=null)}onRemove(r){this.colorRampTexture&&this.colorRampTexture.destroy(),this.tileFramebuffer&&this.tileFramebuffer.destroy(),this.particleFramebuffer&&this.particleFramebuffer.destroy()}hasColorMap(){return!!this._transitionablePaint._values["raster-particle-color"].value.value}getProgramIds(){return["rasterParticle"]}hasOffscreenPass(){return this.visibility!=="none"}isDraped(r){return!1}_handleSpecialPaintPropertyUpdate(r){r!=="raster-particle-color"&&r!=="raster-particle-max-speed"||(this._updateColorRamp(),this._invalidateAnimationState()),r==="raster-particle-count"&&this._invalidateAnimationState()}_updateColorRamp(){if(!this.hasColorMap())return;const r=this._transitionablePaint._values["raster-particle-color"].value.expression,o=this._transitionablePaint._values["raster-particle-max-speed"].value.expression.evaluate({zoom:0});this.colorRamp=dy({expression:r,evaluationKey:"rasterParticleSpeed",image:this.colorRamp,clips:[{start:0,end:o}],resolution:256}),this.colorRampTexture=null}_invalidateAnimationState(){this.lastInvalidatedAt=Ms.now()}tileCoverLift(){return this.paint.get("raster-particle-elevation")}}class L7 extends hs{constructor(r,o){super(r,{},o,null),this.implementation=r,r.slot&&(this.slot=r.slot)}is3D(r){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}isDraped(r){return this.implementation.renderToTile!==void 0}shouldRedrape(){return!!this.implementation.shouldRerenderTiles&&this.implementation.shouldRerenderTiles()}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(r){this.implementation.onAdd&&this.implementation.onAdd(r,r.painter.context.gl)}onRemove(r){this.implementation.onRemove&&this.implementation.onRemove(r,r.painter.context.gl)}}function kE(a,r,o){const u=[0,0,1],h=En([]);return dr(h,h,o?-Fe(a)+Math.PI:Fe(a)),jn(h,h,-Fe(r)),He(u,u,h),ur(u,u)}const C3={None:0,Model:1,Symbol:2,FillExtrusion:4};class q1{constructor(r,o,u,h){this.message=(r?`${r}: `:"")+u,h&&(this.identifier=h),o!=null&&o.__line__&&(this.line=o.__line__)}}function OE(a,r){const o=a.indexOf("://")===-1;try{return new URL(a,o&&r?"http://example.com":void 0),!0}catch{return!1}}class I3{constructor(r,o){this.feature=r,this.instancedDataOffset=o,this.instancedDataCount=0,this.rotation=[0,0,0],this.scale=[1,1,1],this.translation=[0,0,0]}}class A3{constructor(){this.instancedDataArray=new oy,this.instancesEvaluatedElevation=[],this.features=[],this.idToFeaturesIndex={}}}class ME{constructor(r){this.zoom=r.zoom,this.canonical=r.canonical,this.layers=r.layers,this.layerIds=this.layers.map((o=>o.fqid)),this.projection=r.projection,this.index=r.index,this.worldview=r.worldview,this.hasZoomDependentProperties=this.layers[0].isZoomDependent(),this.stateDependentLayerIds=this.layers.filter((o=>o.isStateDependent())).map((o=>o.id)),this.hasPattern=!1,this.instancesPerModel={},this.validForExaggeration=0,this.maxVerticalOffset=0,this.maxScale=0,this.maxHeight=0,this.lookupDim=this.zoom>this.canonical.z+1?0:this.zoom>this.canonical.z?256:this.zoom>15?75:100,this.instanceCount=0,this.terrainElevationMin=0,this.terrainElevationMax=0,this.validForDEMTile={id:null,timestamp:0},this.modelUris=[],this.modelsRequested=!1,this.activeReplacements=[],this.replacementUpdateTime=0,this.styleDefinedModelURLs=r.styleDefinedModelURLs}updateFootprints(r,o){}populate(r,o,u,h){this.tileToMeter=We(u);const g=this.layers[0]._featureFilter.needGeometry;this.lookup=new Uint8Array(this.lookupDim*this.lookupDim);for(const{feature:_,id:b,index:T,sourceLayerIndex:E}of r){const A=b??(_.properties&&_.properties.hasOwnProperty("id")?_.properties.id:void 0),R=St(_,g);if(!this.layers[0]._featureFilter.filter(new pi(this.zoom,{worldview:this.worldview}),R,u))continue;const M={id:A,sourceLayerIndex:E,index:T,geometry:g?R.geometry:Ut(_,u,h),properties:_.properties,type:_.type,patterns:{}},F=this.addFeature(M,M.geometry,R);F&&o.featureIndex.insert(_,M.geometry,T,E,this.index,this.instancesPerModel[F].instancedDataArray.length,zt/32)}this.lookup=null}update(r,o,u,h){for(const g in this.instancesPerModel){const _=this.instancesPerModel[g];for(const b in r)_.idToFeaturesIndex.hasOwnProperty(b)&&(this.evaluate(_.features[_.idToFeaturesIndex[b]],r[b],_,!0),this.uploaded=!1)}this.maxHeight=0}updateZoomBasedPaintProperties(){if(!this.hasZoomDependentProperties)return!1;let r=!1;for(const o in this.instancesPerModel){const u=this.instancesPerModel[o];for(const h of u.features){const g=this.layers[0],_=h.feature,b=this.canonical,T=g.paint.get("model-rotation").evaluate(_,{},b),E=g.paint.get("model-scale").evaluate(_,{},b),A=g.paint.get("model-translation").evaluate(_,{},b);dt(h.rotation,T)&&dt(h.scale,E)&&dt(h.translation,A)||(this.evaluate(h,h.featureStates,u,!0),r=!0)}}return r}updateReplacement(r,o,u,h){if(o.updateTime===this.replacementUpdateTime)return!1;this.replacementUpdateTime=o.updateTime;const g=o.getReplacementRegionsForTile(r.toUnwrapped(),!0);if(y1(this.activeReplacements,g))return!1;this.activeReplacements=g;let _=!1;for(const b in this.instancesPerModel){const T=this.instancesPerModel[b],E=T.instancedDataArray;for(const A of T.features){const R=A.instancedDataOffset,M=A.instancedDataCount;for(let F=0;F<M;F++){const B=16*(F+R);let W=E.float32[B+0];const q=W>zt;W=q?W-zt:W;const K=Math.floor(W),ne=E.float32[B+1];let re=!1;for(const oe of this.activeReplacements)if(!pR(oe,u,C3.Model,h)&&!(oe.min.x>K||K>oe.max.x||oe.min.y>ne||ne>oe.max.y)&&(re=WS(yR(K,ne,r.canonical,oe.footprintTileId.canonical),oe.footprint),re))break;E.float32[B]=re?W+zt:W,_=_||re!==q}}}return _}isEmpty(){for(const r in this.instancesPerModel)if(this.instancesPerModel[r].instancedDataArray.length!==0)return!1;return!0}uploadPending(){return!this.uploaded}upload(r){if(!this.uploaded)for(const o in this.instancesPerModel){const u=this.instancesPerModel[o];u.instancedDataArray.length<0||u.instancedDataArray.length===0||(u.instancedDataBuffer?u.instancedDataBuffer.updateData(u.instancedDataArray):u.instancedDataBuffer=r.createVertexBuffer(u.instancedDataArray,u$.members,!0,void 0,this.instanceCount))}this.uploaded=!0}destroy(){for(const o in this.instancesPerModel){const u=this.instancesPerModel[o];u.instancedDataArray.length!==0&&u.instancedDataBuffer&&u.instancedDataBuffer.destroy()}const r=this.layers[0].modelManager;if(r&&this.modelUris&&this.modelsRequested)for(const o of this.modelUris)r.removeModel(o,"",!0)}addFeature(r,o,u){const h=this.layers[0],g=h.layout.get("model-id").evaluate(u,{},this.canonical);if(!g)return cr(`modelId is not evaluated for layer ${h.id} and it is not going to get rendered.`),g;(OE(g,!1)||this.styleDefinedModelURLs[g]!==void 0)&&(this.modelUris.includes(g)||this.modelUris.push(g)),this.instancesPerModel[g]||(this.instancesPerModel[g]=new A3);const _=this.instancesPerModel[g],b=_.instancedDataArray,T=new I3(u,b.length);for(const E of o)for(const A of E){if(A.x<0||A.x>=zt||A.y<0||A.y>=zt)continue;if(this.lookupDim!==0){const M=(this.lookupDim-1)/zt,F=this.lookupDim*(A.y*M|0)+A.x*M|0;if(this.lookup){if(this.lookup[F]!==0)continue;this.lookup[F]=1}}this.instanceCount++;const R=b.length;b.resize(R+1),_.instancesEvaluatedElevation.push(0),b.float32[16*R]=A.x,b.float32[16*R+1]=A.y}return T.instancedDataCount=_.instancedDataArray.length-T.instancedDataOffset,T.instancedDataCount>0&&(r.id&&(_.idToFeaturesIndex[r.id]=_.features.length),_.features.push(T),this.evaluate(T,{},_,!1)),g}getModelUris(){return this.modelUris}evaluate(r,o,u,h){const g=this.layers[0],_=r.feature,b=this.canonical,T=r.rotation=g.paint.get("model-rotation").evaluate(_,o,b),E=r.scale=g.paint.get("model-scale").evaluate(_,o,b),A=r.translation=g.paint.get("model-translation").evaluate(_,o,b),R=g.paint.get("model-color").evaluate(_,o,b);R.a=g.paint.get("model-color-mix-intensity").evaluate(_,o,b);const M=[];this.maxVerticalOffset<A[2]&&(this.maxVerticalOffset=A[2]),this.maxScale=Math.max(Math.max(this.maxScale,E[0]),Math.max(E[1],E[2])),QR(M,T,E);const F=Math.round(100*R.a)+R.b/1.05;for(let B=0;B<r.instancedDataCount;++B){const W=r.instancedDataOffset+B,q=16*W,K=u.instancedDataArray.float32;let ne=0;h&&(ne=K[q+6]-u.instancesEvaluatedElevation[W]);const re=0|K[q+1];K[q]=(0|K[q])+R.r/1.05,K[q+1]=re+R.g/1.05,K[q+2]=F,K[q+3]=1/(b.z>10?this.tileToMeter:We(b,re)),K[q+4]=A[0],K[q+5]=A[1],K[q+6]=A[2]+ne,K[q+7]=M[0],K[q+8]=M[1],K[q+9]=M[2],K[q+10]=M[4],K[q+11]=M[5],K[q+12]=M[6],K[q+13]=M[8],K[q+14]=M[9],K[q+15]=M[10],u.instancesEvaluatedElevation[W]=A[2]}}}let P3,R3;Wt(ME,"ModelBucket",{omit:["layers"]}),Wt(A3,"PerModelAttributes"),Wt(I3,"ModelFeature");class Km{constructor(r,o,u){this._demTile=r,this._dem=this._demTile.dem,this._scale=o,this._offset=u}static create(r,o,u){const h=u||r.findDEMTileFor(o);if(!h||!h.dem)return;const g=h.dem,_=h.tileID,b=1<<o.canonical.z-_.canonical.z;return new Km(h,g.dim/zt/b,[(o.canonical.x/b-_.canonical.x)*g.dim,(o.canonical.y/b-_.canonical.y)*g.dim])}tileCoordToPixel(r,o){const u=o*this._scale+this._offset[1];return new xt(Math.floor(r*this._scale+this._offset[0]),Math.floor(u))}getElevationAt(r,o,u,h){const g=r*this._scale+this._offset[0],_=o*this._scale+this._offset[1],b=Math.floor(g),T=Math.floor(_),E=this._dem;return h=!!h,u?wn(wn(E.get(b,T,h),E.get(b,T+1,h),_-T),wn(E.get(b+1,T,h),E.get(b+1,T+1,h),_-T),g-b):E.get(b,T,h)}getElevationAtPixel(r,o,u){return this._dem.get(r,o,!!u)}getMeterToDEM(r){return(1<<this._demTile.tileID.canonical.z)*fe(1,r)*this._dem.stride}}const DE=new Float32Array(262144),Zf=new Uint8Array(262144);function k3(a){let r=0;if(a.meshes)for(const o of a.meshes)r=Math.max(r,o.aabb.max[2]);if(a.children)for(const o of a.children)r=Math.max(r,k3(o));return r}function O3(a,r,o){if(a.meshes)for(const u of a.meshes){if(u.aabb.min[0]===1/0)continue;const h=kn.applyTransform(u.aabb,a.matrix);o.insert(r,h.min[0],h.min[1],h.max[0],h.max[1])}if(a.children)for(const u of a.children)O3(u,r,o)}const M3=["","wall","door","roof","window","lamp","logo"];class D3{constructor(r){this.node=r,this.evaluatedRMEA=[[1,0,0,1],[1,0,0,1],[1,0,0,1],[1,0,0,1],[.4,1,0,1],[1,0,0,1],[1,0,0,1]],this.hiddenByReplacement=!1,this.evaluatedTranslation=[0,0,0],this.evaluatedScale=[1,1,1],this.evaluatedColor=[],this.emissionHeightBasedParams=[],this.cameraCollisionOpacity=1,this.feature={type:"Point",id:r.id,geometry:[],properties:{height:k3(r)}},this.aabb=this._getLocalBounds(),this.state=null}_getLocalBounds(){if(!this.node.meshes)return new kn([1/0,1/0,1/0],[-1/0,-1/0,-1/0]);if(!this.aabb){let r=0;const o=new kn([1/0,1/0,1/0],[-1/0,-1/0,-1/0]);for(const u of this.node.meshes)this.node.lightMeshIndex!==r&&(u.transformedAabb=kn.applyTransformFast(u.aabb,this.node.matrix),o.encapsulate(u.transformedAabb)),r++;this.aabb=o}return this.aabb}}class K1{constructor(r,o,u,h,g,_,b,T){this.id=u,this.layers=r,this.layerIds=this.layers.map((E=>E.fqid)),this.stateDependentLayerIds=this.layers.filter((E=>E.isStateDependent())).map((E=>E.id)),this.modelTraits|=Um.CoordinateSpaceTile,this.uploaded=!1,this.hasPattern=!1,h&&(this.modelTraits|=Um.HasMapboxMeshFeatures),g&&(this.modelTraits|=Um.HasMeshoptCompression),this.zoom=-1,this.terrainExaggeration=1,this.projection={name:"mercator"},this.replacementUpdateTime=0,this.elevationReadFromZ=255,this.brightness=_,this.worldview=T,this.dirty=!0,this.needsUpload=!1,this.filter=null,this.nodesInfo=[];for(const E of o)this.nodesInfo.push(new D3(E)),O3(E,b.featureIndexArray.length,b.grid),b.featureIndexArray.emplaceBack(this.nodesInfo.length-1,0,b.bucketLayerIDs.length-1,0);this.states={}}updateFootprints(r,o){for(const u of this.getNodesInfo()){const h=u.node;h.footprint&&o.push({footprint:h.footprint,id:r})}}update(r){const o=Object.keys(r).length!==0;if(o&&!this.stateDependentLayers.length)return;const u=o?this.stateDependentLayers:this.layers;if(!Da(r,this.states))for(const h of u)this.evaluate(h,r);this.states=structuredClone(r)}populate(){console.log("populate 3D model bucket")}uploadPending(){return!this.uploaded||this.needsUpload}upload(r){if(!this.needsUpload)return;const o=this.getNodesInfo();for(const u of o){const h=u.node;this.uploaded?this.updatePbrBuffer(h):aE(h,r,!0)}for(const u of o)A1(u.node);this.uploaded=!0,this.needsUpload=!1}updatePbrBuffer(r){let o=!1;if(!r.meshes)return o;for(const u of r.meshes)u.pbrBuffer&&(u.pbrBuffer.updateData(u.featureArray),o=!0);return o}needsReEvaluation(r,o,u){const h=r.transform.projectionOptions,g=r.style.getBrightness(),_=this.brightness!==g;if(!this.uploaded||this.dirty||h.name!==this.projection.name||Vy(u.paint.get("model-color").value,_)||Vy(u.paint.get("model-color-mix-intensity").value,_)||Vy(u.paint.get("model-roughness").value,_)||Vy(u.paint.get("model-emissive-strength").value,_)||Vy(u.paint.get("model-height-based-emissive-strength-multiplier").value,_)){this.projection=h,this.brightness=g;const b=this.getNodesInfo();for(const T of b)T.state=null;return!0}return!1}evaluateTransform(r,o){if(r.transform.zoom===this.zoom)return;this.zoom=r.transform.zoom;const u=this.getNodesInfo(),h=this.id.canonical;for(const g of u){const _=g.feature;g.evaluatedTranslation=o.paint.get("model-translation").evaluate(_,{},h),g.evaluatedScale=o.paint.get("model-scale").evaluate(_,{},h)}}evaluate(r,o){const u=this.getNodesInfo();for(const h of u){if(!h.node.meshes)continue;const g=h.feature,_=o&&o[g.id];if(Da(_,h.state))continue;h.state=structuredClone(_);const b=h.node.meshes&&h.node.meshes[0].featureData,T=h.evaluatedColor[2],E=h.evaluatedRMEA[2],A=this.id.canonical;if(h.hasTranslucentParts=!1,b){for(let R=0;R<M3.length;R++){const M=M3[R];M.length&&(g.properties.part=M);const F=r.paint.get("model-color").evaluate(g,_,A).toPremultipliedRenderColor(null),B=r.paint.get("model-color-mix-intensity").evaluate(g,_,A);h.evaluatedColor[R]=[F.r,F.g,F.b,B],h.evaluatedRMEA[R][0]=r.paint.get("model-roughness").evaluate(g,_,A),h.evaluatedRMEA[R][2]=r.paint.get("model-emissive-strength").evaluate(g,_,A),h.evaluatedRMEA[R][3]=F.a,h.emissionHeightBasedParams[R]=r.paint.get("model-height-based-emissive-strength-multiplier").evaluate(g,_,A),!h.hasTranslucentParts&&F.a<1&&(h.hasTranslucentParts=!0)}delete g.properties.part,F7(h,T!==h.evaluatedColor[2]||E!==h.evaluatedRMEA[2],this.modelTraits)}else h.evaluatedRMEA[0][2]=r.paint.get("model-emissive-strength").evaluate(g,_,A);h.evaluatedTranslation=r.paint.get("model-translation").evaluate(g,_,A),h.evaluatedScale=r.paint.get("model-scale").evaluate(g,_,A),this.updatePbrBuffer(h.node)||(this.needsUpload=!0)}this.dirty=!1}elevationUpdate(r,o,u,h){const g=r.findDEMTileFor(u);if(g&&(g.tileID.canonical!==this.terrainTile||o!==this.terrainExaggeration)){if(g.dem&&g.tileID.overscaledZ!==this.elevationReadFromZ){this.elevationReadFromZ=g.tileID.overscaledZ;const _=Km.create(r,u,g);if(!_)return;this.modelTraits&Um.HasMapboxMeshFeatures&&this.updateDEM(r,_,u,h);for(const b of this.getNodesInfo()){const T=b.node;if(!T.footprint||!T.footprint.vertices||!T.footprint.vertices.length)continue;const E=T.footprint.vertices;let A=_.getElevationAt(E[0].x,E[0].y,!0,!0);for(let R=1;R<E.length;R++)A=Math.min(A,_.getElevationAt(E[R].x,E[R].y,!0,!0));T.elevation=A}}this.terrainTile=g.tileID.canonical,this.terrainExaggeration=o}}updateDEM(r,o,u,h){let g=o._dem._modifiedForSources[h];if(g===void 0&&(o._dem._modifiedForSources[h]=[],g=o._dem._modifiedForSources[h]),g.includes(u.canonical))return;const _=o._dem.dim;g.push(u.canonical);let b=!1;for(const T of this.getNodesInfo()){const E=T.node;if(!E.footprint||!E.footprint.grid)continue;const A=E.footprint.grid,R=o.tileCoordToPixel(A.min.x,A.min.y),M=o.tileCoordToPixel(A.max.x,A.max.y),F=Math.min(Math.min(_-M.y,R.x),Math.min(R.y,_-M.x));if(F<0)continue;const B=be(F,2,5);let W=Math.max(0,R.x-B),q=Math.max(0,R.y-B),K=Math.min(M.x+B,_-1),ne=Math.min(M.y+B,_-1);for(let ve=q;ve<=ne;++ve)for(let Ce=W;Ce<=K;++Ce)Zf[ve*_+Ce]=255;let re=0,oe=0;for(let ve=0;ve<A.cellsY;++ve)for(let Ce=0;Ce<A.cellsX;++Ce){if(!A.cells[ve*A.cellsX+Ce])continue;const Oe=o.tileCoordToPixel(A.min.x+Ce/A.xScale,A.min.y+ve/A.yScale),De=o.tileCoordToPixel(A.min.x+(Ce+1)/A.xScale,A.min.y+(ve+1)/A.yScale);for(let ut=Oe.y;ut<=Math.min(De.y+1,_-1);++ut)for(let Ue=Oe.x;Ue<=Math.min(De.x+1,_-1);++Ue)Zf[ut*_+Ue]===255&&(Zf[ut*_+Ue]=0,re+=o.getElevationAtPixel(Ue,ut),oe++)}const ye=re/oe;W=Math.max(1,R.x-B),q=Math.max(1,R.y-B),K=Math.min(M.x+B,_-2),ne=Math.min(M.y+B,_-2),b=!0;for(let ve=q;ve<=ne;++ve)for(let Ce=W;Ce<=K;++Ce)Zf[ve*_+Ce]===0&&(DE[ve*_+Ce]=o._dem.set(Ce,ve,ye));for(let ve=1;ve<B;++ve){W=Math.max(1,R.x-ve),q=Math.max(1,R.y-ve),K=Math.min(M.x+ve,_-2),ne=Math.min(M.y+ve,_-2);for(let Ce=q;Ce<=ne;++Ce)for(let Oe=W;Oe<=K;++Oe){const De=Ce*_+Oe;if(Zf[De]===255){let ut=0,Ue=0,ht=-1,wt=-1;for(let mt=-1;mt<=1;++mt)for(let yt=-1;yt<=1;++yt){const Et=(Ce+mt)*_+Oe+yt;if(Zf[Et]>=ve)continue;const lt=DE[Et],vt=Math.abs(lt);vt>Ue&&(ut=lt,Ue=vt,ht=yt,wt=mt)}if(Ue>.1){const mt=1-(ve+.5*Math.abs(ht*wt))/B;let yt=o._dem.get(Oe,Ce)+ut*mt;const Et=o._dem.get(Oe+ht,Ce+wt),lt=o._dem.get(Oe-ht,Ce-wt,!0);(yt-Et)*(yt-lt)>0&&(yt=(Et+lt)/2),DE[De]=o._dem.set(Oe,Ce,yt),Zf[De]=ve}}}}}b&&(o._demTile.needsDEMTextureUpload=!0,o._dem._timestamp=Ms.now())}setFilter(r){this.filter=r?Rf(r):null}getNodesInfo(){return this.filter?this.nodesInfo.filter((r=>this.filter.filter(new pi(this.id.overscaledZ,{worldview:this.worldview}),r.feature,this.id.canonical))):this.nodesInfo}destroy(){const r=this.getNodesInfo();for(const o of r)A1(o.node),lE(o.node)}isEmpty(){return!this.nodesInfo.length}updateReplacement(r,o){if(o.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=o.updateTime;const u=o.getReplacementRegionsForTile(r.toUnwrapped());for(const h of this.getNodesInfo()){const g=h.node.footprint;h.hiddenByReplacement=!!g&&!u.find((_=>_.footprint===g))}}getHeightAtTileCoord(r,o){const u=[],h=[0,0,0],g=de([]);for(const _ of this.getNodesInfo()){const b=_.node.meshes[0],T=b.transformedAabb;if(r<T.min[0]||o<T.min[1]||r>T.max[0]||o>T.max[1])continue;if(_.node.hidden===!0)return{height:1/0,maxHeight:_.feature.properties.height,hidden:!1,verticalScale:_.evaluatedScale[2]};Te(g,_.node.matrix),h[0]=r,h[1]=o,vn(h,h,g);const E=(h[0]-b.aabb.min[0])/(b.aabb.max[0]-b.aabb.min[0])*Wf|0,A=Math.min(63,(h[1]-b.aabb.min[1])/(b.aabb.max[1]-b.aabb.min[1])*Wf|0)*Wf+Math.min(63,E),R=b.heightmap[A];if(!(R<0&&_.node.footprint))return _.hiddenByReplacement?void 0:{height:R,maxHeight:_.feature.properties.height,hidden:!1,verticalScale:_.evaluatedScale[2]};if(_.node.footprint.grid.query(new xt(r,o),new xt(r,o),u),u.length>0)return{height:void 0,maxHeight:_.feature.properties.height,hidden:_.hiddenByReplacement,verticalScale:_.evaluatedScale[2]}}}}function Vy(a,r){return a instanceof Af&&!a.isLightConstant&&r}function z7(a,r,o,u,h,g,_,b){let T=(61440&r|(61440&r)>>4)>>8,E=(3840&r|(3840&r)>>4)>>4,A=240&r|(240&r)>>4;o[3]>0&&(T=wn(T,255*o[0],o[3]),E=wn(E,255*o[1],o[3]),A=wn(A,255*o[2],o[3]));const R=T<<8|E,M=A<<8|Math.floor(255*u[3]),F=(function(ve){const Ce=be(ve,0,2);return Math.min(Math.round(.5*Ce*255),255)})(u[2])<<8|15*u[0]<<4|15*u[1],B=be(h[0],0,1),W=be(h[1],0,1),q=be(h[2],0,1),K=be(h[3],0,1);let ne,re,oe,ye;if(B!==W&&_!==g&&W!==B){const ve=_-g;re=1/(ve*(W-B)),oe=-(g+ve*B)/(ve*(W-B));const Ce=be(h[4],-1,1);ye=Math.pow(10,Ce),ne=255*q<<8|255*K}else ne=65535,re=0,oe=1,ye=1;if(a.emplaceBack(R,M,F,ne,re,oe,ye),b){const ve=b.length;b.clear();for(let Ce=0;Ce<ve;Ce++)b.emplaceBack(R,M,F,ne,re,oe,ye)}}function F7(a,r,o){const u=a.node;let h=0;const g=o&Um.HasMeshoptCompression;for(const _ of u.meshes){if(u.lights&&u.lightMeshIndex===h||!_.featureData)continue;_.featureArray=new sh,_.featureArray.reserve(_.featureData.length);let b=r;for(const T of _.featureData){const E=g?65535&T:T>>16&65535,A=g?T>>16&65535:65535&T,R=(15&A)<8?15&A:0,M=a.evaluatedRMEA[R],F=a.evaluatedColor[R],B=a.emissionHeightBasedParams[R];let W;if(b&&R===2&&u.lights&&(W=new sh,W.resize(10*u.lights.length)),z7(_.featureArray,E,F,M,B,_.aabb.min[2],_.aabb.max[2],W),W&&b){b=!1;const q=u.meshes[u.lightMeshIndex];q.featureArray=W,q.featureArray._trim()}}_.featureArray._trim(),h++}}function L3(a,r,o,u){const h=1<<a.z;r.lat=pe((u/zt+a.y)/h),r.lng=ge((o/zt+a.x)/h)}function B7(a,r,o,u){const h=a.getNodesInfo()[r];if(!h||h.hiddenByReplacement||!h.node.meshes)return;let g=Number.MAX_VALUE;const _=h.node,b=o.tile,T=u.calculatePosMatrix(b.tileID.toUnwrapped(),u.worldSize),E=h.evaluatedScale;let A=0;u.elevation&&_.elevation&&(A=_.elevation*u.elevation.exaggeration()),Ge(T,T,[(_.anchor?_.anchor[0]:0)*(E[0]-1),(_.anchor?_.anchor[1]:0)*(E[1]-1),A]),Ye(T,T,E);const R=o.queryGeometry,M=R.isPointQuery()?R.screenBounds:R.screenGeometry,F=function(W){const q=Be([],T,W.matrix);Be(q,u.expandedFarZProjMatrix,q);for(let K=0;K<W.meshes.length;++K){const ne=W.meshes[K];if(K===W.lightMeshIndex)continue;const re=ek(M,u,q,ne.aabb);re!=null&&(g=Math.min(re,g))}if(W.children)for(const K of W.children)F(K)};if(F(_),g===Number.MAX_VALUE)return;const B=new H(0,0);return L3(b.tileID.canonical,B,h.node.anchor[0],h.node.anchor[1]),{intersectionZ:g,position:B,feature:h.feature}}Wt(K1,"Tiled3dModelBucket",{omit:["layers"]}),Wt(D3,"Tiled3dModelFeature");const N7={circle:class extends hs{constructor(a,r,o,u){super(a,{layout:lh||(lh=new Wi({"circle-sort-key":new $t($e.layout_circle["circle-sort-key"]),"circle-elevation-reference":new It($e.layout_circle["circle-elevation-reference"]),visibility:new It($e.layout_circle.visibility)})),paint:nc||(nc=new Wi({"circle-radius":new $t($e.paint_circle["circle-radius"]),"circle-color":new $t($e.paint_circle["circle-color"]),"circle-blur":new $t($e.paint_circle["circle-blur"]),"circle-opacity":new $t($e.paint_circle["circle-opacity"]),"circle-translate":new It($e.paint_circle["circle-translate"]),"circle-translate-anchor":new It($e.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new It($e.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new It($e.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new $t($e.paint_circle["circle-stroke-width"]),"circle-stroke-color":new $t($e.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new $t($e.paint_circle["circle-stroke-opacity"]),"circle-emissive-strength":new It($e.paint_circle["circle-emissive-strength"]),"circle-color-use-theme":new $t({type:"string",default:"default","property-type":"data-driven"}),"circle-stroke-color-use-theme":new $t({type:"string",default:"default","property-type":"data-driven"})}))},r,o,u)}createBucket(a){return new Ko(a)}queryRadius(a){const r=a;return rl("circle-radius",this,r)+rl("circle-stroke-width",this,r)+Gc(this.paint.get("circle-translate"))}queryIntersectsFeature(a,r,o,u,h,g,_,b){const T=Pl(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),g.angle,a.pixelToTileUnitsFactor),E=this.paint.get("circle-radius").evaluate(r,o)+this.paint.get("circle-stroke-width").evaluate(r,o);return $P(a,u,g,_,b,this.paint.get("circle-pitch-alignment")==="map",this.paint.get("circle-pitch-scale")==="map",T,E)}getProgramIds(){return["circle"]}getDefaultProgramParams(a,r,o){const u=VP(this);return{config:new Qu(this,{zoom:r,lut:o}),defines:u,overrideFog:!1}}is3D(a){return!a&&!!this.layout&&this.layout.get("circle-elevation-reference")!=="none"}hasElevation(){return this.layout&&this.layout.get("circle-elevation-reference")!=="none"}},heatmap:class extends hs{createBucket(a){return new jP(a)}constructor(a,r,o,u){super(a,{layout:GP||(GP=new Wi({visibility:new It($e.layout_heatmap.visibility)})),paint:HP||(HP=new Wi({"heatmap-radius":new $t($e.paint_heatmap["heatmap-radius"]),"heatmap-weight":new $t($e.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new It($e.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Jd($e.paint_heatmap["heatmap-color"]),"heatmap-opacity":new It($e.paint_heatmap["heatmap-opacity"]),"heatmap-color-use-theme":new $t({type:"string",default:"default","property-type":"data-driven"})}))},r,o,u),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(a){a==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=dy({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}_clear(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}queryRadius(a){return rl("heatmap-radius",this,a)}queryIntersectsFeature(a,r,o,u,h,g,_,b){const T=this.paint.get("heatmap-radius").evaluate(r,o);return $P(a,u,g,_,b,!0,!0,new xt(0,0),T)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}getProgramIds(){return["heatmap","heatmapTexture"]}getDefaultProgramParams(a,r,o){return a==="heatmap"?{config:new Qu(this,{zoom:r,lut:o}),overrideFog:!1}:{}}},hillshade:class extends hs{constructor(a,r,o,u){super(a,{layout:WP||(WP=new Wi({visibility:new It($e.layout_hillshade.visibility)})),paint:qP||(qP=new Wi({"hillshade-illumination-direction":new It($e.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new It($e.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new It($e.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new It($e.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new It($e.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new It($e.paint_hillshade["hillshade-accent-color"]),"hillshade-emissive-strength":new It($e.paint_hillshade["hillshade-emissive-strength"]),"hillshade-shadow-color-use-theme":new $t({type:"string",default:"default","property-type":"data-driven"}),"hillshade-highlight-color-use-theme":new $t({type:"string",default:"default","property-type":"data-driven"}),"hillshade-accent-color-use-theme":new $t({type:"string",default:"default","property-type":"data-driven"})}))},r,o,u)}shouldRedrape(){return this.hasOffscreenPass()&&this.paint.get("hillshade-illumination-anchor")==="viewport"}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}getProgramIds(){return["hillshade","hillshadePrepare"]}getDefaultProgramParams(a,r,o){return{overrideFog:!1}}},fill:class extends hs{constructor(a,r,o,u){super(a,{layout:lR||(lR=new Wi({"fill-sort-key":new $t($e.layout_fill["fill-sort-key"]),visibility:new It($e.layout_fill.visibility),"fill-elevation-reference":new It($e.layout_fill["fill-elevation-reference"]),"fill-construct-bridge-guard-rail":new $t($e.layout_fill["fill-construct-bridge-guard-rail"])})),paint:cR||(cR=new Wi({"fill-antialias":new It($e.paint_fill["fill-antialias"]),"fill-opacity":new $t($e.paint_fill["fill-opacity"]),"fill-color":new $t($e.paint_fill["fill-color"]),"fill-outline-color":new $t($e.paint_fill["fill-outline-color"]),"fill-translate":new It($e.paint_fill["fill-translate"]),"fill-translate-anchor":new It($e.paint_fill["fill-translate-anchor"]),"fill-pattern":new $t($e.paint_fill["fill-pattern"]),"fill-pattern-cross-fade":new It($e.paint_fill["fill-pattern-cross-fade"]),"fill-emissive-strength":new It($e.paint_fill["fill-emissive-strength"]),"fill-z-offset":new $t($e.paint_fill["fill-z-offset"]),"fill-bridge-guard-rail-color":new $t($e.paint_fill["fill-bridge-guard-rail-color"]),"fill-tunnel-structure-color":new $t($e.paint_fill["fill-tunnel-structure-color"]),"fill-color-use-theme":new $t({type:"string",default:"default","property-type":"data-driven"}),"fill-outline-color-use-theme":new $t({type:"string",default:"default","property-type":"data-driven"}),"fill-bridge-guard-rail-color-use-theme":new $t({type:"string",default:"default","property-type":"data-driven"}),"fill-tunnel-structure-color-use-theme":new $t({type:"string",default:"default","property-type":"data-driven"})}))},r,o,u)}getProgramIds(){const a=this.paint.get("fill-pattern"),r=a&&a.constantOr(1),o=[r?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&o.push(r&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),o}getDefaultProgramParams(a,r,o){return{config:new Qu(this,{zoom:r,lut:o}),overrideFog:!1}}recalculate(a,r){super.recalculate(a,r);const o=this.paint._values["fill-outline-color"];o.value.kind==="constant"&&o.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(a){return new jS(a)}queryRadius(){return Gc(this.paint.get("fill-translate"))}queryIntersectsFeature(a,r,o,u,h,g){return!a.queryGeometry.isAboveHorizon&&Ys(Hc(a.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),g.angle,a.pixelToTileUnitsFactor),u)}isTileClipped(){return this.paint.get("fill-z-offset").constantOr(1)===0}is3D(a){if(this.paint.get("fill-z-offset").constantOr(1)!==0)return!0;const r=this.layout&&this.layout.get("fill-elevation-reference")!=="none";return a!=null?r&&!a:r}hasElevation(){return this.layout&&this.layout.get("fill-elevation-reference")!=="none"}hasShadowPass(){return this.layout&&this.layout.get("fill-elevation-reference")!=="none"}},"fill-extrusion":class extends hs{constructor(a,r,o,u){super(a,{layout:OR||(OR=new Wi({visibility:new It($e["layout_fill-extrusion"].visibility),"fill-extrusion-edge-radius":new It($e["layout_fill-extrusion"]["fill-extrusion-edge-radius"])})),paint:MR||(MR=new Wi({"fill-extrusion-opacity":new It($e["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new $t($e["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new It($e["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new It($e["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new $t($e["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-pattern-cross-fade":new It($e["paint_fill-extrusion"]["fill-extrusion-pattern-cross-fade"]),"fill-extrusion-height":new $t($e["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new $t($e["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-height-alignment":new It($e["paint_fill-extrusion"]["fill-extrusion-height-alignment"]),"fill-extrusion-base-alignment":new It($e["paint_fill-extrusion"]["fill-extrusion-base-alignment"]),"fill-extrusion-vertical-gradient":new It($e["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new It($e["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new It($e["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"]),"fill-extrusion-ambient-occlusion-wall-radius":new It($e["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-wall-radius"]),"fill-extrusion-ambient-occlusion-ground-radius":new It($e["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-radius"]),"fill-extrusion-ambient-occlusion-ground-attenuation":new It($e["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-attenuation"]),"fill-extrusion-flood-light-color":new It($e["paint_fill-extrusion"]["fill-extrusion-flood-light-color"]),"fill-extrusion-flood-light-intensity":new It($e["paint_fill-extrusion"]["fill-extrusion-flood-light-intensity"]),"fill-extrusion-flood-light-wall-radius":new $t($e["paint_fill-extrusion"]["fill-extrusion-flood-light-wall-radius"]),"fill-extrusion-flood-light-ground-radius":new $t($e["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-radius"]),"fill-extrusion-flood-light-ground-attenuation":new It($e["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-attenuation"]),"fill-extrusion-vertical-scale":new It($e["paint_fill-extrusion"]["fill-extrusion-vertical-scale"]),"fill-extrusion-rounded-roof":new It($e["paint_fill-extrusion"]["fill-extrusion-rounded-roof"]),"fill-extrusion-cutoff-fade-range":new It($e["paint_fill-extrusion"]["fill-extrusion-cutoff-fade-range"]),"fill-extrusion-emissive-strength":new $t($e["paint_fill-extrusion"]["fill-extrusion-emissive-strength"]),"fill-extrusion-line-width":new $t($e["paint_fill-extrusion"]["fill-extrusion-line-width"]),"fill-extrusion-cast-shadows":new It($e["paint_fill-extrusion"]["fill-extrusion-cast-shadows"]),"fill-extrusion-color-use-theme":new $t({type:"string",default:"default","property-type":"data-driven"}),"fill-extrusion-flood-light-color-use-theme":new $t({type:"string",default:"default","property-type":"data-driven"})}))},r,o,u),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(a){return new b1(a)}queryRadius(){return Gc(this.paint.get("fill-extrusion-translate"))}is3D(a){return!0}hasShadowPass(){return this.paint.get("fill-extrusion-cast-shadows")}cutoffRange(){return this.paint.get("fill-extrusion-cutoff-fade-range")}canCastShadows(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}queryIntersectsFeature(a,r,o,u,h,g,_,b,T){const E=Pl(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),g.angle,a.pixelToTileUnitsFactor),A=this.paint.get("fill-extrusion-height").evaluate(r,o),R=this.paint.get("fill-extrusion-base").evaluate(r,o),M=[0,0],F=b&&g.elevation,B=g.elevation?g.elevation.exaggeration():1,W=a.tile.getBucket(this);if(F&&W instanceof b1){const oe=W.centroidVertexArray,ye=T+1;ye<oe.length&&(M[0]=oe.geta_centroid_pos0(ye),M[1]=oe.geta_centroid_pos1(ye))}if(M[0]===0&&M[1]===1)return!1;g.projection.name==="globe"&&(u=kR([u],[new xt(0,0),new xt(zt,zt)],a.tileID.canonical).map((oe=>oe.polygon)).flat());const q=F?b:null,[K,ne]=(function(oe,ye,ve,Ce,Oe,De,ut,Ue,ht,wt,mt){return oe.projection.name==="globe"?(function(yt,Et,lt,vt,rt,Xe,Ct,Tt,hn,Ht,Jt){const Dt=[],dn=[],Fn=yt.projection.upVectorScale(Jt,yt.center.lat,yt.worldSize).metersToTile,Vt=[0,0,0,1],tn=[0,0,0,1],An=(er,Un,Xt,Vn)=>{er[0]=Un,er[1]=Xt,er[2]=Vn,er[3]=1},Nn=RR();lt>0&&(lt+=Nn),vt+=Nn;for(const er of Et){const Un=[],Xt=[];for(const Vn of er){const br=Vn.x+rt.x,ae=Vn.y+rt.y,le=yt.projection.projectTilePoint(br,ae,Jt),et=yt.projection.upVector(Jt,Vn.x,Vn.y);let ct=lt,Nt=vt;if(Ct){const Bt=NR(br,ae,lt,vt,Ct,Tt,hn,Ht);ct+=Bt.base,Nt+=Bt.top}lt!==0?An(Vt,le.x+et[0]*Fn*ct,le.y+et[1]*Fn*ct,le.z+et[2]*Fn*ct):An(Vt,le.x,le.y,le.z),An(tn,le.x+et[0]*Fn*Nt,le.y+et[1]*Fn*Nt,le.z+et[2]*Fn*Nt),vn(Vt,Vt,Xe),vn(tn,tn,Xe),Un.push(new Gf(Vt[0],Vt[1],Vt[2])),Xt.push(new Gf(tn[0],tn[1],tn[2]))}Dt.push(Un),dn.push(Xt)}return[Dt,dn]})(oe,ye,ve,Ce,Oe,De,ut,Ue,ht,wt,mt):ut?(function(yt,Et,lt,vt,rt,Xe,Ct,Tt,hn){const Ht=[],Jt=[],Dt=[0,0,0,1];for(const dn of yt){const Fn=[],Vt=[];for(const tn of dn){const An=tn.x+vt.x,Nn=tn.y+vt.y,er=NR(An,Nn,Et,lt,Xe,Ct,Tt,hn);Dt[0]=An,Dt[1]=Nn,Dt[2]=er.base,Dt[3]=1,Zt(Dt,Dt,rt),Dt[3]=Math.max(Dt[3],1e-5);const Un=new Gf(Dt[0]/Dt[3],Dt[1]/Dt[3],Dt[2]/Dt[3]);Dt[0]=An,Dt[1]=Nn,Dt[2]=er.top,Dt[3]=1,Zt(Dt,Dt,rt),Dt[3]=Math.max(Dt[3],1e-5);const Xt=new Gf(Dt[0]/Dt[3],Dt[1]/Dt[3],Dt[2]/Dt[3]);Fn.push(Un),Vt.push(Xt)}Ht.push(Fn),Jt.push(Vt)}return[Ht,Jt]})(ye,ve,Ce,Oe,De,ut,Ue,ht,wt):(function(yt,Et,lt,vt,rt){const Xe=[],Ct=[],Tt=rt[8]*Et,hn=rt[9]*Et,Ht=rt[10]*Et,Jt=rt[11]*Et,Dt=rt[8]*lt,dn=rt[9]*lt,Fn=rt[10]*lt,Vt=rt[11]*lt;for(const tn of yt){const An=[],Nn=[];for(const er of tn){const Un=er.x+vt.x,Xt=er.y+vt.y,Vn=rt[0]*Un+rt[4]*Xt+rt[12],br=rt[1]*Un+rt[5]*Xt+rt[13],ae=rt[2]*Un+rt[6]*Xt+rt[14],le=rt[3]*Un+rt[7]*Xt+rt[15],et=Vn+Tt,ct=br+hn,Nt=ae+Ht,Bt=Math.max(le+Jt,1e-5),Kt=Vn+Dt,_n=br+dn,tr=ae+Fn,nr=Math.max(le+Vt,1e-5);An.push(new Gf(et/Bt,ct/Bt,Nt/Bt)),Nn.push(new Gf(Kt/nr,_n/nr,tr/nr))}Xe.push(An),Ct.push(Nn)}return[Xe,Ct]})(ye,ve,Ce,Oe,De)})(g,u,R,A,E,_,q,M,B,g.center.lat,a.tileID.canonical),re=a.queryGeometry;return(function(oe,ye,ve){let Ce=1/0;Ys(ve,ye)&&(Ce=BR(ve,ye[0]));for(let Oe=0;Oe<ye.length;Oe++){const De=ye[Oe],ut=oe[Oe];for(let Ue=0;Ue<De.length-1;Ue++){const ht=De[Ue],wt=[ht,De[Ue+1],ut[Ue+1],ut[Ue],ht];va(ve,wt)&&(Ce=Math.min(Ce,BR(ve,wt)))}}return Ce!==1/0&&Ce})(K,ne,re.isPointQuery()?re.screenBounds:re.screenGeometry)}},building:class extends hs{constructor(a,r,o,u){super(a,{layout:uk||(uk=new Wi({visibility:new It($e.layout_building.visibility),"building-facade":new $t($e.layout_building["building-facade"]),"building-facade-floors":new $t($e.layout_building["building-facade-floors"]),"building-facade-unit-width":new $t($e.layout_building["building-facade-unit-width"]),"building-facade-window":new $t($e.layout_building["building-facade-window"]),"building-roof-shape":new $t($e.layout_building["building-roof-shape"]),"building-height":new $t($e.layout_building["building-height"]),"building-base":new $t($e.layout_building["building-base"]),"building-flood-light-wall-radius":new $t($e.layout_building["building-flood-light-wall-radius"]),"building-flood-light-ground-radius":new $t($e.layout_building["building-flood-light-ground-radius"]),"building-flip-roof-orientation":new $t($e.layout_building["building-flip-roof-orientation"])})),paint:dk||(dk=new Wi({"building-opacity":new It($e.paint_building["building-opacity"]),"building-ambient-occlusion-intensity":new It($e.paint_building["building-ambient-occlusion-intensity"]),"building-ambient-occlusion-ground-intensity":new It($e.paint_building["building-ambient-occlusion-ground-intensity"]),"building-ambient-occlusion-ground-radius":new It($e.paint_building["building-ambient-occlusion-ground-radius"]),"building-ambient-occlusion-ground-attenuation":new It($e.paint_building["building-ambient-occlusion-ground-attenuation"]),"building-vertical-scale":new It($e.paint_building["building-vertical-scale"]),"building-cast-shadows":new It($e.paint_building["building-cast-shadows"]),"building-color":new $t($e.paint_building["building-color"]),"building-emissive-strength":new $t($e.paint_building["building-emissive-strength"]),"building-facade-emissive-chance":new It($e.paint_building["building-facade-emissive-chance"]),"building-cutoff-fade-range":new It($e.paint_building["building-cutoff-fade-range"]),"building-flood-light-color":new It($e.paint_building["building-flood-light-color"]),"building-flood-light-intensity":new It($e.paint_building["building-flood-light-intensity"]),"building-flood-light-ground-attenuation":new It($e.paint_building["building-flood-light-ground-attenuation"]),"building-color-use-theme":new $t({type:"string",default:"default","property-type":"data-driven"}),"building-flood-light-color-use-theme":new $t({type:"string",default:"default","property-type":"data-driven"})}))},r,o,u),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(a){return new ck(a)}cutoffRange(){return this.paint.get("building-cutoff-fade-range")}hasShadowPass(){return this.paint.get("building-cast-shadows")}hasLightBeamPass(){return!0}canCastShadows(){return!0}is3D(a){return!0}},line:class extends hs{constructor(a,r,o,u){const h=xk();super(a,h,r,o,u),h.layout&&(this.layout=new qu(h.layout)),this.gradientVersion=0,this.hasElevatedBuckets=!1,this.hasNonElevatedBuckets=!1}_handleSpecialPaintPropertyUpdate(a){if(a==="line-gradient"){const r=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=r._styleExpression&&r._styleExpression.expression instanceof Sf,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}widthExpression(){return this._transitionablePaint._values["line-width"].value.expression}recalculate(a,r){super.recalculate(a,r),this.paint._values["line-floorwidth"]=(()=>{if(Ay)return Ay;const o=xk();return Ay=new F$(o.paint.properties["line-width"].specification),Ay.useIntegerZoom=!0,Ay})().possiblyEvaluate(this._transitioningPaint._values["line-width"].value,a)}createBucket(a){return new hE(a)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getDefaultProgramParams(a,r,o){const u=vk(this);return{config:new Qu(this,{zoom:r,lut:o}),defines:u,overrideFog:!1}}queryRadius(a){const r=a,o=wk(rl("line-width",this,r),rl("line-gap-width",this,r)),u=rl("line-offset",this,r);return o/2+Math.abs(u)+Gc(this.paint.get("line-translate"))}queryIntersectsFeature(a,r,o,u,h,g){if(a.queryGeometry.isAboveHorizon)return!1;const _=Hc(a.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),g.angle,a.pixelToTileUnitsFactor),b=a.pixelToTileUnitsFactor/2*wk(this.paint.get("line-width").evaluate(r,o),this.paint.get("line-gap-width").evaluate(r,o)),T=this.paint.get("line-offset").evaluate(r,o);return T&&(u=(function(E,A){const R=[],M=new xt(0,0);for(let F=0;F<E.length;F++){const B=E[F],W=[];for(let q=0;q<B.length;q++){const K=B[q],ne=B[q+1],re=q===0?M:K.sub(B[q-1])._unit()._perp(),oe=q===B.length-1?M:ne.sub(K)._unit()._perp(),ye=re._add(oe)._unit();ye._mult(1/(ye.x*oe.x+ye.y*oe.y)),W.push(ye._mult(A)._add(K))}R.push(W)}return R})(u,T*a.pixelToTileUnitsFactor)),(function(E,A,R){for(let M=0;M<A.length;M++){const F=A[M];if(E.length>=3){for(let B=0;B<F.length;B++)if($o(E,F[B]))return!0}if(Js(E,F,R))return!0}return!1})(_,u,b)}isTileClipped(){return this.hasNonElevatedBuckets}isDraped(a){return!this.hasElevatedBuckets||this.layout&&this.layout.get("line-elevation-reference")==="hd-road-markup"}hasElevation(){return this.layout&&this.layout.get("line-elevation-reference")!=="none"}},symbol:G1,background:class extends hs{constructor(a,r,o,u){super(a,{layout:f3||(f3=new Wi({visibility:new It($e.layout_background.visibility)})),paint:p3||(p3=new Wi({"background-pitch-alignment":new It($e.paint_background["background-pitch-alignment"]),"background-color":new It($e.paint_background["background-color"]),"background-pattern":new It($e.paint_background["background-pattern"]),"background-opacity":new It($e.paint_background["background-opacity"]),"background-emissive-strength":new It($e.paint_background["background-emissive-strength"]),"background-color-use-theme":new $t({type:"string",default:"default","property-type":"data-driven"})}))},r,o,u)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}getDefaultProgramParams(a,r,o){return{overrideFog:!1}}is3D(a){return this.paint.get("background-pitch-alignment")==="viewport"}},raster:v3,"raster-particle":E3,sky:class extends hs{constructor(a,r,o,u){super(a,{layout:w3||(w3=new Wi({visibility:new It($e.layout_sky.visibility)})),paint:T3||(T3=new Wi({"sky-type":new It($e.paint_sky["sky-type"]),"sky-atmosphere-sun":new It($e.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new It($e.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new It($e.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new It($e.paint_sky["sky-gradient-radius"]),"sky-gradient":new Jd($e.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new It($e.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new It($e.paint_sky["sky-atmosphere-color"]),"sky-opacity":new It($e.paint_sky["sky-opacity"]),"sky-gradient-use-theme":new $t({type:"string",default:"default","property-type":"data-driven"}),"sky-atmosphere-halo-color-use-theme":new $t({type:"string",default:"default","property-type":"data-driven"}),"sky-atmosphere-color-use-theme":new $t({type:"string",default:"default","property-type":"data-driven"})}))},r,o,u),this._updateColorRamp()}_clear(){this.skyboxFbo&&(this.skyboxFbo.destroy(),this.skyboxFbo=null),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null),this._skyboxInvalidated=!0}_handleSpecialPaintPropertyUpdate(a){a==="sky-gradient"?this._updateColorRamp():a!=="sky-atmosphere-sun"&&a!=="sky-atmosphere-halo-color"&&a!=="sky-atmosphere-color"&&a!=="sky-atmosphere-sun-intensity"||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=dy({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(a){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const r=a.style.light.properties.get("position");return this._lightPosition.azimuthal!==r.azimuthal||this._lightPosition.polar!==r.polar}return!1}getCenter(a,r){if(this.paint.get("sky-type")==="atmosphere"){const u=this.paint.get("sky-atmosphere-sun"),h=!u,g=a.style.light,_=g.properties.get("position");return h&&g.properties.get("anchor")==="viewport"&&cr("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),h?kE(_.azimuthal,90-_.polar,r):kE(u[0],90-u[1],r)}const o=this.paint.get("sky-gradient-center");return kE(o[0],90-o[1],r)}isSky(){return!0}markSkyboxValid(a){this._skyboxInvalidated=!1,this._lightPosition=a.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const a=this.paint.get("sky-type");return a==="atmosphere"?["skyboxCapture","skybox"]:a==="gradient"?["skyboxGradient"]:null}},slot:class extends hs{constructor(a,r,o,u){super(a,{paint:S3||(S3=new Wi({}))},r,null)}},model:class extends hs{constructor(a,r,o,u){super(a,{layout:P3||(P3=new Wi({visibility:new It($e.layout_model.visibility),"model-id":new $t($e.layout_model["model-id"])})),paint:R3||(R3=new Wi({"model-opacity":new $t($e.paint_model["model-opacity"]),"model-rotation":new $t($e.paint_model["model-rotation"]),"model-scale":new $t($e.paint_model["model-scale"]),"model-translation":new $t($e.paint_model["model-translation"]),"model-color":new $t($e.paint_model["model-color"]),"model-color-mix-intensity":new $t($e.paint_model["model-color-mix-intensity"]),"model-type":new It($e.paint_model["model-type"]),"model-cast-shadows":new It($e.paint_model["model-cast-shadows"]),"model-receive-shadows":new It($e.paint_model["model-receive-shadows"]),"model-ambient-occlusion-intensity":new It($e.paint_model["model-ambient-occlusion-intensity"]),"model-emissive-strength":new $t($e.paint_model["model-emissive-strength"]),"model-roughness":new $t($e.paint_model["model-roughness"]),"model-height-based-emissive-strength-multiplier":new $t($e.paint_model["model-height-based-emissive-strength-multiplier"]),"model-cutoff-fade-range":new It($e.paint_model["model-cutoff-fade-range"]),"model-front-cutoff":new It($e.paint_model["model-front-cutoff"]),"model-elevation-reference":new It($e.paint_model["model-elevation-reference"]),"model-color-use-theme":new $t({type:"string",default:"default","property-type":"data-driven"})}))},r,o,u),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(a){return new ME(a)}getProgramIds(){return["model"]}is3D(a){return!0}hasShadowPass(){return!0}canCastShadows(){return!0}hasLightBeamPass(){return!0}cutoffRange(){return this.paint.get("model-cutoff-fade-range")}queryRadius(a){return a instanceof K1?zt-1:0}queryIntersectsFeature(a,r,o,u,h,g){if(!this.modelManager)return!1;const _=this.modelManager,b=a.tile.getBucket(this);if(!(b&&b instanceof ME))return!1;for(const T in b.instancesPerModel){const E=b.instancesPerModel[T],A=r.id!==void 0?r.id:r.properties&&r.properties.hasOwnProperty("id")?r.properties.id:void 0;if(E.idToFeaturesIndex.hasOwnProperty(A)){const R=E.features[E.idToFeaturesIndex[A]],M=_.getModel(T,this.scope);if(!M)return!1;let F=ue();const B=new H(0,0),W=b.canonical;let q=Number.MAX_VALUE;for(let K=0;K<R.instancedDataCount;++K){const ne=16*(R.instancedDataOffset+K),re=E.instancedDataArray.float32,oe=[re[ne+4],re[ne+5],re[ne+6]];L3(W,B,re[ne],0|re[ne+1]),tk(F,M,g,B,R.rotation,R.scale,oe,!1,!1,!1),g.projection.name==="globe"&&(F=sE(F,g));const ye=Be([],g.projMatrix,F),ve=a.queryGeometry,Ce=ek(ve.isPointQuery()?ve.screenBounds:ve.screenGeometry,g,ye,M.aabb);Ce!=null&&(q=Math.min(Ce,q))}return q!==Number.MAX_VALUE&&q}}return!1}_handleOverridablePaintPropertyUpdate(a,r,o){return!(!this.layout||r.isDataDriven()||o.isDataDriven()||a!=="model-color"&&a!=="model-color-mix-intensity"&&a!=="model-rotation"&&a!=="model-scale"&&a!=="model-translation"&&a!=="model-emissive-strength")}_isPropertyZoomDependent(a){const r=this._transitionablePaint._values[a];return r!=null&&r.value!=null&&r.value.expression!=null&&r.value.expression instanceof Lc}isZoomDependent(){return this._isPropertyZoomDependent("model-scale")||this._isPropertyZoomDependent("model-rotation")||this._isPropertyZoomDependent("model-translation")}},clip:class extends hs{constructor(a,r,o,u){super(a,{layout:uR||(uR=new Wi({"clip-layer-types":new It($e.layout_clip["clip-layer-types"]),"clip-layer-scope":new It($e.layout_clip["clip-layer-scope"])})),paint:dR||(dR=new Wi({}))},r,o,u)}recalculate(a,r){super.recalculate(a,r)}createBucket(a){return new hR(a)}is3D(a){return!0}}},LE=new Pr(0,0,0),zE={PATH_RULE_NON_ZERO:1,PATH_RULE_EVEN_ODD:2},FE={LINE_CAP_BUTT:1,LINE_CAP_ROUND:2,LINE_CAP_SQUARE:3},Z1={LINE_JOIN_MITER:1,LINE_JOIN_MITER_CLIP:2,LINE_JOIN_ROUND:3,LINE_JOIN_BEVEL:4},V7={PAINT_ORDER_FILL_AND_STROKE:1},$y={PATH_COMMAND_MOVE:1,PATH_COMMAND_LINE:2,PATH_COMMAND_QUAD:3,PATH_COMMAND_CUBIC:4,PATH_COMMAND_CLOSE:5},z3={MASK_TYPE_LUMINANCE:1};function $7(a,r,o){a===1&&r.icons.push((function(u,h){return(function(g){if(g.usvg_tree.height||(g.usvg_tree.height=g.usvg_tree.width),!g.metadata)return g;const{metadata:_}=g;if(_.content_area){const{content_area:b}=_;b.left==null&&(b.left=0),b.top==null&&(b.top=b.left),b.width==null&&(b.width=g.usvg_tree.width),b.height==null&&(b.height=b.width)}if(_.text_placeholder){const{text_placeholder:b}=_;b.top==null&&(b.top=b.left),b.height==null&&(b.height=b.width)}return _.stretch_x&&_.stretch_x.length&&F3(_,"x"),_.stretch_y&&_.stretch_y.length&&F3(_,"y"),g})(u.readFields(U7,{name:void 0},h))})(o,o.readVarint()+o.pos))}function F3(a,r){const o=[],u=a[`stretch_${r}`];let h=null;for(let g=0;g<u.length;g++)h===null?h=o.length===0?u[0]:o[o.length-1][1]+u[g]:(o.push([h,h+u[g]]),h=null);a[`stretch_${r}_areas`]=o}function U7(a,r,o){a===1?r.name=o.readString():a===2?r.metadata=(function(u,h){return u.readFields(j7,{stretch_x:null,stretch_y:null,stretch_x_areas:null,stretch_y_areas:null,variables:[]},h)})(o,o.readVarint()+o.pos):a===3&&(r.usvg_tree=(function(u,h){return u.readFields(W7,{width:20,children:[],linear_gradients:[],radial_gradients:[],clip_paths:[],masks:[]},h)})(o,o.readVarint()+o.pos),r.data="usvg_tree")}function j7(a,r,o){a===1?r.stretch_x=o.readPackedVarint():a===2?r.stretch_y=o.readPackedVarint():a===3?r.content_area=B3(o,o.readVarint()+o.pos):a===4?r.variables.push((function(u,h){return u.readFields(H7,{name:void 0},h)})(o,o.readVarint()+o.pos)):a===5&&(r.text_placeholder=B3(o,o.readVarint()+o.pos))}function B3(a,r){return a.readFields(G7,{},r)}function G7(a,r,o){a===1?r.left=o.readVarint():a===2?r.width=o.readVarint():a===3?r.top=o.readVarint():a===4&&(r.height=o.readVarint())}function H7(a,r,o){a===1?r.name=o.readString():a===2&&(r.rgb_color=J1(o.readVarint()),r.value="rgb_color")}function W7(a,r,o){a===1?r.width=r.height=o.readVarint():a===2?r.height=o.readVarint():a===3?r.children.push(X1(o,o.readVarint()+o.pos)):a===4?r.linear_gradients.push((function(u,h){return u.readFields(Q7,{spread_method:1,stops:[],x1:0,y1:0,x2:1,y2:0},h)})(o,o.readVarint()+o.pos)):a===5?r.radial_gradients.push((function(u,h){return u.readFields(t9,{spread_method:1,stops:[],cx:.5,cy:.5,r:.5,fx:.5,fy:.5,fr:0},h)})(o,o.readVarint()+o.pos)):a===7?r.clip_paths.push((function(u,h){return u.readFields(n9,{children:[]},h)})(o,o.readVarint()+o.pos)):a===8&&r.masks.push((function(u,h){const g=u.readFields(r9,{left:0,width:20,mask_type:z3.MASK_TYPE_LUMINANCE,children:[]},h);return g.height==null&&(g.height=g.width),g.top==null&&(g.top=g.left),g})(o,o.readVarint()+o.pos))}function X1(a,r){return a.readFields(q7,{},r)}function q7(a,r,o){a===1?(r.group=(function(u,h){return u.readFields(K7,{opacity:255,children:[]},h)})(o,o.readVarint()+o.pos),r.node="group"):a===2&&(r.path=(function(u,h){return u.readFields(X7,{paint_order:1,commands:[],step:1,diffs:[],rule:zE.PATH_RULE_NON_ZERO},h)})(o,o.readVarint()+o.pos),r.node="path")}function K7(a,r,o){a===1?r.transform=Y1(o,o.readVarint()+o.pos):a===2?r.opacity=o.readVarint():a===5?r.clip_path_idx=o.readVarint():a===6?r.mask_idx=o.readVarint():a===7&&r.children.push(X1(o,o.readVarint()+o.pos))}function Y1(a,r){return a.readFields(Z7,{sx:1,ky:0,kx:0,sy:1,tx:0,ty:0},r)}function Z7(a,r,o){a===1?r.sx=o.readFloat():a===2?r.ky=o.readFloat():a===3?r.kx=o.readFloat():a===4?r.sy=o.readFloat():a===5?r.tx=o.readFloat():a===6&&(r.ty=o.readFloat())}function X7(a,r,o){a===1?r.fill=(function(u,h){return u.readFields(Y7,{rgb_color:LE,paint:"rgb_color",opacity:255},h)})(o,o.readVarint()+o.pos):a===2?r.stroke=(function(u,h){return u.readFields(J7,{rgb_color:LE,paint:"rgb_color",dasharray:[],dashoffset:0,miterlimit:4,opacity:255,width:1,linecap:1,linejoin:1},h)})(o,o.readVarint()+o.pos):a===3?r.paint_order=o.readVarint():a===5?o.readPackedVarint(r.commands):a===6?r.step=o.readFloat():a===7?o.readPackedSVarint(r.diffs):a===8&&(r.rule=o.readVarint())}function Y7(a,r,o){a===1?(r.rgb_color=J1(o.readVarint()),r.paint="rgb_color"):a===2?(r.linear_gradient_idx=o.readVarint(),r.paint="linear_gradient_idx"):a===3?(r.radial_gradient_idx=o.readVarint(),r.paint="radial_gradient_idx"):a===5&&(r.opacity=o.readVarint())}function J1(a){return new Pr((a>>16&255)/255,(a>>8&255)/255,(255&a)/255,1)}function J7(a,r,o){a===1?(r.rgb_color=J1(o.readVarint()),r.paint="rgb_color"):a===2?(r.linear_gradient_idx=o.readVarint(),r.paint="linear_gradient_idx"):a===3?(r.radial_gradient_idx=o.readVarint(),r.paint="radial_gradient_idx"):a===5?o.readPackedFloat(r.dasharray):a===6?r.dashoffset=o.readFloat():a===7?r.miterlimit=o.readFloat():a===8?r.opacity=o.readVarint():a===9?r.width=o.readFloat():a===10?r.linecap=o.readVarint():a===11&&(r.linejoin=o.readVarint())}function Q7(a,r,o){a===1?r.transform=Y1(o,o.readVarint()+o.pos):a===2?r.spread_method=o.readVarint():a===3?r.stops.push(N3(o,o.readVarint()+o.pos)):a===4?r.x1=o.readFloat():a===5?r.y1=o.readFloat():a===6?r.x2=o.readFloat():a===7&&(r.y2=o.readFloat())}function N3(a,r){return a.readFields(e9,{offset:0,opacity:255,rgb_color:LE},r)}function e9(a,r,o){a===1?r.offset=o.readFloat():a===2?r.opacity=o.readVarint():a===3&&(r.rgb_color=J1(o.readVarint()))}function t9(a,r,o){a===1?r.transform=Y1(o,o.readVarint()+o.pos):a===2?r.spread_method=o.readVarint():a===3?r.stops.push(N3(o,o.readVarint()+o.pos)):a===4?r.cx=o.readFloat():a===5?r.cy=o.readFloat():a===6?r.r=o.readFloat():a===7?r.fx=o.readFloat():a===8?r.fy=o.readFloat():a===9&&(r.fr=o.readFloat())}function n9(a,r,o){a===1?r.transform=Y1(o,o.readVarint()+o.pos):a===2?r.clip_path_idx=o.readVarint():a===3&&r.children.push(X1(o,o.readVarint()+o.pos))}function r9(a,r,o){a===1?r.left=r.top=o.readFloat():a===2?r.width=r.height=o.readFloat():a===3?r.top=o.readFloat():a===4?r.height=o.readFloat():a===5?r.mask_type=o.readVarint():a===6?r.mask_idx=o.readVarint():a===7&&r.children.push(X1(o,o.readVarint()+o.pos))}class i9{static calculate(r={},o=[]){const u=new Map,h=new Map;if(Object.keys(r).length===0)return u;o.forEach((g=>{h.set(g.name,g.rgb_color||new Pr(0,0,0))}));for(const[g,_]of Object.entries(r))h.has(g)?u.set(h.get(g).toString(),_):console.warn(`Ignoring unknown image variable "${g}"`);return u}}function Zm(a,r=255,o){const u=r/255,h=a.toString(),g=o.has(h)?o.get(h).clone():a.clone();return g.a*=u,g.toString()}function Uy(a,r){if(!pa()){const o=document.createElement("canvas");return o.width=a,o.height=r,o}return new OffscreenCanvas(a,r)}function o9(a,r){const o=i9.calculate(r.params,a.metadata?a.metadata.variables:[]),u=a.usvg_tree,h=u.width,g=u.height,_=r.transform?r.transform:new DOMMatrix,b=Math.max(1,Math.round(h*_.a)),T=Math.max(1,Math.round(g*_.d)),E=new DOMMatrix([b/h,0,0,T/g,0,0]),A=Uy(b,T).getContext("2d");return BE(A,E,u,u,o),A.getImageData(0,0,b,T)}function BE(a,r,o,u,h){for(const g of u.children)V3(a,r,o,g,h)}function V3(a,r,o,u,h){u.group?(a.save(),(function(g,_,b,T,E){const A=T.mask_idx!=null?b.masks[T.mask_idx]:null,R=T.clip_path_idx!=null?b.clip_paths[T.clip_path_idx]:null;if(T.transform&&(_=Xm(T.transform).preMultiplySelf(_)),!(function(B,W,q){return B.opacity!==255||W||q})(T,R!=null,A!=null))return void BE(g,_,b,T,E);const M=Uy(g.canvas.width,g.canvas.height),F=M.getContext("2d");BE(F,_,b,T,E),R&&q3(F,_,b,R),A&&K3(F,_,b,A,E),g.globalAlpha=T.opacity/255,g.drawImage(M,0,0)})(a,r,o,u.group,h),a.restore()):u.path&&(a.save(),(function(g,_,b,T,E){g.setTransform(_),T.paint_order===V7.PAINT_ORDER_FILL_AND_STROKE?($3(g,b,T,E),j3(g,b,T,E)):(j3(g,b,T,E),$3(g,b,T,E))})(a,r,o,u.path,h),a.restore())}function $3(a,r,o,u){const h=o.fill;if(!h)return;const g=h.opacity/255;switch(a.save(),a.beginPath(),Z3(o,a),h.paint){case"rgb_color":a.fillStyle=Zm(h.rgb_color,h.opacity,u);break;case"linear_gradient_idx":{const _=r.linear_gradients[h.linear_gradient_idx];_.transform&&a.setTransform(Xm(_.transform).preMultiplySelf(a.getTransform())),a.fillStyle=G3(a,_,g,u);break}case"radial_gradient_idx":{const _=r.radial_gradients[h.radial_gradient_idx];_.transform&&a.setTransform(Xm(_.transform).preMultiplySelf(a.getTransform())),a.fillStyle=H3(a,_,g,u)}}a.fill(U3(o)),a.restore()}function U3(a){return a.rule===zE.PATH_RULE_NON_ZERO?"nonzero":a.rule===zE.PATH_RULE_EVEN_ODD?"evenodd":void 0}function j3(a,r,o,u){const h=o.stroke;if(!h)return;const g=X3(o);a.lineWidth=h.width,a.miterLimit=h.miterlimit,a.setLineDash(h.dasharray),a.lineDashOffset=h.dashoffset;const _=h.opacity/255;switch(h.paint){case"rgb_color":a.strokeStyle=Zm(h.rgb_color,h.opacity,u);break;case"linear_gradient_idx":a.strokeStyle=G3(a,r.linear_gradients[h.linear_gradient_idx],_,u,!0);break;case"radial_gradient_idx":a.strokeStyle=H3(a,r.radial_gradients[h.radial_gradient_idx],_,u,!0)}switch(h.linejoin){case Z1.LINE_JOIN_MITER_CLIP:case Z1.LINE_JOIN_MITER:a.lineJoin="miter";break;case Z1.LINE_JOIN_ROUND:a.lineJoin="round";break;case Z1.LINE_JOIN_BEVEL:a.lineJoin="bevel"}switch(h.linecap){case FE.LINE_CAP_BUTT:a.lineCap="butt";break;case FE.LINE_CAP_ROUND:a.lineCap="round";break;case FE.LINE_CAP_SQUARE:a.lineCap="square"}a.stroke(g)}function G3(a,r,o,u,h=!1){if(r.stops.length===1){const M=r.stops[0];return Zm(M.rgb_color,M.opacity*o,u)}const{x1:g,y1:_,x2:b,y2:T}=r;let E=new DOMPoint(g,_),A=new DOMPoint(b,T);if(h){const M=Xm(r.transform);E=M.transformPoint(E),A=M.transformPoint(A)}const R=a.createLinearGradient(E.x,E.y,A.x,A.y);for(const M of r.stops)R.addColorStop(M.offset,Zm(M.rgb_color,M.opacity*o,u));return R}function H3(a,r,o,u,h=!1){if(r.stops.length===1){const K=r.stops[0];return Zm(K.rgb_color,K.opacity*o,u)}const g=Xm(r.transform),{fx:_,fy:b,fr:T,cx:E,cy:A,r:R}=r;let M=new DOMPoint(_,b),F=new DOMPoint(E,A),B=T,W=R;if(h){M=g.transformPoint(M),F=g.transformPoint(F);const K=(g.a+g.d)/2;B=T*K,W=r.r*K}const q=a.createRadialGradient(M.x,M.y,B,F.x,F.y,W);for(const K of r.stops)q.addColorStop(K.offset,Zm(K.rgb_color,K.opacity*o,u));return q}function W3(a,r,o,u){const h=u.transform?Xm(u.transform).preMultiplySelf(r):r,g=Uy(a.canvas.width,a.canvas.height),_=g.getContext("2d");for(const T of u.children)if(T.group)W3(_,h,o,T.group);else if(T.path){const E=T.path,A=new Path2D;A.addPath(X3(E),h),_.fill(A,U3(E))}const b=u.clip_path_idx!=null?o.clip_paths[u.clip_path_idx]:null;b&&q3(_,h,o,b),a.globalCompositeOperation="source-over",a.drawImage(g,0,0)}function q3(a,r,o,u){const h=Uy(a.canvas.width,a.canvas.height);W3(h.getContext("2d"),r,o,u),a.globalCompositeOperation="destination-in",a.drawImage(h,0,0)}function K3(a,r,o,u,h){if(u.children.length===0)return;const g=u.mask_idx!=null?o.masks[u.mask_idx]:null;g&&K3(a,r,o,g,h);const _=a.canvas.width,b=a.canvas.height,T=Uy(_,b),E=T.getContext("2d"),A=u.width,R=u.height,M=u.left,F=u.top,B=new Path2D,W=new Path2D;W.rect(M,F,A,R),B.addPath(W,r),E.clip(B);for(const ne of u.children)V3(E,r,o,ne,h);const q=E.getImageData(0,0,_,b),K=q.data;if(u.mask_type===z3.MASK_TYPE_LUMINANCE)for(let ne=0;ne<K.length;ne+=4)K[ne+3]=K[ne+3]/255*(.2126*K[ne]+.7152*K[ne+1]+.0722*K[ne+2]);E.putImageData(q,0,0),a.globalCompositeOperation="destination-in",a.drawImage(T,0,0)}function Xm(a){return a?new DOMMatrix([a.sx,a.ky,a.kx,a.sy,a.tx,a.ty]):new DOMMatrix}function Z3(a,r){const o=a.step;let u=a.diffs[0]*o,h=a.diffs[1]*o;r.moveTo(u,h);for(let g=0,_=2;g<a.commands.length;g++)switch(a.commands[g]){case $y.PATH_COMMAND_MOVE:u+=a.diffs[_++]*o,h+=a.diffs[_++]*o,r.moveTo(u,h);break;case $y.PATH_COMMAND_LINE:u+=a.diffs[_++]*o,h+=a.diffs[_++]*o,r.lineTo(u,h);break;case $y.PATH_COMMAND_QUAD:{const b=u+a.diffs[_++]*o,T=h+a.diffs[_++]*o;u=b+a.diffs[_++]*o,h=T+a.diffs[_++]*o,r.quadraticCurveTo(b,T,u,h);break}case $y.PATH_COMMAND_CUBIC:{const b=u+a.diffs[_++]*o,T=h+a.diffs[_++]*o,E=b+a.diffs[_++]*o,A=T+a.diffs[_++]*o;u=E+a.diffs[_++]*o,h=A+a.diffs[_++]*o,r.bezierCurveTo(b,T,E,A,u,h);break}case $y.PATH_COMMAND_CLOSE:r.closePath()}return r}function X3(a){return Z3(a,new Path2D)}class Q1{constructor(r){this.capacity=r,this.cache=new Map}get(r){if(!this.cache.has(r))return;const o=this.cache.get(r);return this.cache.delete(r),this.cache.set(r,o),o}put(r,o){this.cache.has(r)?this.cache.delete(r):this.cache.size===this.capacity&&this.cache.delete(this.cache.keys().next().value),this.cache.set(r,o)}delete(r){this.cache.delete(r)}}Wt(Q1,"LRUCache");class NE{constructor(){this.cacheMap=new Map,this.cacheDependenciesMap=new Map}static _getImage(r){return new rs(r,r.data)}getFromCache(r,o,u){return this.cacheMap.has(u)||this.cacheMap.set(u,new Q1(150)),this.cacheMap.get(u).get(eh(r.toString(),o))}setInCache(r,o,u,h){this.cacheDependenciesMap.has(h)||this.cacheDependenciesMap.set(h,new Map),this.cacheMap.has(h)||this.cacheMap.set(h,new Q1(150));const g=this.cacheDependenciesMap.get(h),_=eh(r.id.toString(),u);g.get(_)||g.set(_,new Set);const b=this.cacheMap.get(h),T=r.toString();g.get(_).add(T),b.put(eh(r.toString(),u),o)}removeImagesFromCacheByIds(r,o,u=0){if(!this.cacheMap.has(u)||!this.cacheDependenciesMap.has(u))return;const h=this.cacheMap.get(u),g=this.cacheDependenciesMap.get(u);for(const _ of r){const b=eh(_.toString(),o);if(g.has(b)){for(const T of g.get(b))h.delete(T);g.delete(b)}}}rasterize(r,o,u,h,g=o9){const _=this.getFromCache(r,u,h);if(_)return _.clone();const b=g(o.icon,r.options),T=NE._getImage(b);return this.setInCache(r,T,u,h),T.clone()}}class Y3{constructor(r){this.size=r,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(r,o){const u=this.toIdx(r,o);return{min:this.minimums[u],max:this.maximums[u]}}isLeaf(r,o){return this.leaves[this.toIdx(r,o)]}toIdx(r,o){return o*this.size+r}}function J3(a,r,o,u){let h=0,g=Number.MAX_VALUE;for(let _=0;_<3;_++)if(Math.abs(u[_])<1e-15){if(o[_]<a[_]||o[_]>r[_])return null}else{const b=1/u[_];let T=(a[_]-o[_])*b,E=(r[_]-o[_])*b;if(T>E){const A=T;T=E,E=A}if(T>h&&(h=T),E<g&&(g=E),h>g)return null}return h}function Q3(a,r,o,u,h,g,_,b,T,E,A){const R=u-a,M=h-r,F=g-o,B=_-a,W=b-r,q=T-o,K=A[1]*q-A[2]*W,ne=A[2]*B-A[0]*q,re=A[0]*W-A[1]*B,oe=R*K+M*ne+F*re;if(Math.abs(oe)<1e-15)return null;const ye=1/oe,ve=E[0]-a,Ce=E[1]-r,Oe=E[2]-o,De=(ve*K+Ce*ne+Oe*re)*ye;if(De<0||De>1)return null;const ut=Ce*F-Oe*M,Ue=Oe*R-ve*F,ht=ve*M-Ce*R,wt=(A[0]*ut+A[1]*Ue+A[2]*ht)*ye;return wt<0||De+wt>1?null:(B*ut+W*Ue+q*ht)*ye}function eO(a,r,o){return(a-r)/(o-r)}function tO(a,r,o,u,h,g,_,b,T){const E=1<<o,A=g-u,R=_-h,M=(a+1)/E*A+u,F=(r+0)/E*R+h,B=(r+1)/E*R+h;b[0]=(a+0)/E*A+u,b[1]=F,T[0]=M,T[1]=B}class nO{constructor(r){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=r,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const o=(function(g){const _=Math.ceil(Math.log2(g.dim/8)),b=[];let T=Math.ceil(Math.pow(2,_));const E=1/T,A=(F,B,W,q,K)=>{const ne=q?1:0,re=(F+1)*W-ne,oe=B*W,ye=(B+1)*W-ne;K[0]=F*W,K[1]=oe,K[2]=re,K[3]=ye};let R=new Y3(T);const M=[];for(let F=0;F<T*T;F++){A(F%T,Math.floor(F/T),E,!1,M);const B=gh(M[0],M[1],g),W=gh(M[2],M[1],g),q=gh(M[2],M[3],g),K=gh(M[0],M[3],g);R.minimums.push(Math.min(B,W,q,K)),R.maximums.push(Math.max(B,W,q,K)),R.leaves.push(1)}for(b.push(R),T/=2;T>=1;T/=2){const F=b[b.length-1];R=new Y3(T);for(let B=0;B<T*T;B++){A(B%T,Math.floor(B/T),2,!0,M);const W=F.getElevation(M[0],M[1]),q=F.getElevation(M[2],M[1]),K=F.getElevation(M[2],M[3]),ne=F.getElevation(M[0],M[3]),re=F.isLeaf(M[0],M[1]),oe=F.isLeaf(M[2],M[1]),ye=F.isLeaf(M[2],M[3]),ve=F.isLeaf(M[0],M[3]),Ce=Math.min(W.min,q.min,K.min,ne.min),Oe=Math.max(W.max,q.max,K.max,ne.max),De=re&&oe&&ye&&ve;R.maximums.push(Oe),R.minimums.push(Ce),R.leaves.push(Oe-Ce<=5&&De?1:0)}b.push(R)}return b})(this.dem),u=o.length-1,h=o[u];this._addNode(h.minimums[0],h.maximums[0],h.leaves[0]),this._construct(o,0,0,u,0)}raycastRoot(r,o,u,h,g,_,b=1){return J3([r,o,-100],[u,h,this.maximums[0]*b],g,_)}raycast(r,o,u,h,g,_,b=1){if(!this.nodeCount)return null;const T=this.raycastRoot(r,o,u,h,g,_,b);if(T==null)return null;const E=[],A=[],R=[],M=[],F=[{idx:0,t:T,nodex:0,nodey:0,depth:0}];for(;F.length>0;){const{idx:B,t:W,nodex:q,nodey:K,depth:ne}=F.pop();if(this.leaves[B]){tO(q,K,ne,r,o,u,h,R,M);const oe=1<<ne,ye=(q+0)/oe,ve=(q+1)/oe,Ce=(K+0)/oe,Oe=(K+1)/oe,De=gh(ye,Ce,this.dem)*b,ut=gh(ve,Ce,this.dem)*b,Ue=gh(ve,Oe,this.dem)*b,ht=gh(ye,Oe,this.dem)*b,wt=Q3(R[0],R[1],De,M[0],R[1],ut,M[0],M[1],Ue,g,_),mt=Q3(M[0],M[1],Ue,R[0],M[1],ht,R[0],R[1],De,g,_),yt=Math.min(wt!==null?wt:Number.MAX_VALUE,mt!==null?mt:Number.MAX_VALUE);if(yt!==Number.MAX_VALUE)return yt;{const Et=vr([],g,_,W);if(rO(De,ut,ht,Ue,eO(Et[0],R[0],M[0]),eO(Et[1],R[1],M[1]))>=Et[2])return W}continue}let re=0;for(let oe=0;oe<this._siblingOffset.length;oe++){tO((q<<1)+this._siblingOffset[oe][0],(K<<1)+this._siblingOffset[oe][1],ne+1,r,o,u,h,R,M),R[2]=-100,M[2]=this.maximums[this.childOffsets[B]+oe]*b;const ye=J3(R,M,g,_);if(ye!=null){const ve=ye;E[oe]=ve;let Ce=!1;for(let Oe=0;Oe<re&&!Ce;Oe++)ve>=E[A[Oe]]&&(A.splice(Oe,0,oe),Ce=!0);Ce||(A[re]=oe),re++}}for(let oe=0;oe<re;oe++){const ye=A[oe];F.push({idx:this.childOffsets[B]+ye,t:E[ye],nodex:(q<<1)+this._siblingOffset[ye][0],nodey:(K<<1)+this._siblingOffset[ye][1],depth:ne+1})}}return null}_addNode(r,o,u){return this.minimums.push(r),this.maximums.push(o),this.leaves.push(u),this.childOffsets.push(0),this.nodeCount++}_construct(r,o,u,h,g){if(r[h].isLeaf(o,u)===1)return;this.childOffsets[g]||(this.childOffsets[g]=this.nodeCount);const _=h-1,b=r[_];let T=0,E=0;for(let A=0;A<this._siblingOffset.length;A++){const R=2*o+this._siblingOffset[A][0],M=2*u+this._siblingOffset[A][1],F=b.getElevation(R,M),B=b.isLeaf(R,M),W=this._addNode(F.min,F.max,B);B&&(T|=1<<A),E||(E=W)}for(let A=0;A<this._siblingOffset.length;A++)T&1<<A||this._construct(r,2*o+this._siblingOffset[A][0],2*u+this._siblingOffset[A][1],_,E+A)}}function rO(a,r,o,u,h,g){return wn(wn(a,o,g),wn(r,u,g),h)}function gh(a,r,o){const u=o.dim,h=be(a*u-.5,0,u-1),g=be(r*u-.5,0,u-1),_=Math.floor(h),b=Math.floor(g),T=Math.min(_+1,u-1),E=Math.min(b+1,u-1);return rO(o.get(_,b),o.get(T,b),o.get(_,E),o.get(T,E),h-_,g-b)}const s9={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};function a9(a,r,o){return(256*a*256+256*r+o)/10-1e4}function l9(a,r,o){return 256*a+r+o/256-32768}class ex{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(r,o,u,h=!1){if(this.uid=r,o.height!==o.width)throw new RangeError("DEM tiles must be square");if(u&&u!=="mapbox"&&u!=="terrarium")return void cr(`"${u}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=o.height;const g=this.dim=o.height-2,_=new Uint32Array(o.data.buffer);if(this.pixels=new Uint8Array(o.data.buffer),this.floatView=new Float32Array(o.data.buffer),this.borderReady=h,this._modifiedForSources={},!h){for(let T=0;T<g;T++)_[this._idx(-1,T)]=_[this._idx(0,T)],_[this._idx(g,T)]=_[this._idx(g-1,T)],_[this._idx(T,-1)]=_[this._idx(T,0)],_[this._idx(T,g)]=_[this._idx(T,g-1)];_[this._idx(-1,-1)]=_[this._idx(0,0)],_[this._idx(g,-1)]=_[this._idx(g-1,0)],_[this._idx(-1,g)]=_[this._idx(0,g-1)],_[this._idx(g,g)]=_[this._idx(g-1,g-1)]}const b=u==="terrarium"?l9:a9;for(let T=0;T<_.length;++T){const E=4*T;this.floatView[T]=b(this.pixels[E],this.pixels[E+1],this.pixels[E+2])}this._timestamp=Ms.now()}_buildQuadTree(){this._tree=new nO(this)}get(r,o,u=!1){u&&(r=be(r,-1,this.dim),o=be(o,-1,this.dim));const h=this._idx(r,o);return this.floatView[h]}set(r,o,u){const h=this._idx(r,o),g=this.floatView[h];return this.floatView[h]=u,u-g}static getUnpackVector(r){return s9[r]}_idx(r,o){if(r<-1||r>=this.dim+1||o<-1||o>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(o+1)*this.stride+(r+1)}static pack(r,o){const u=[0,0,0,0],h=ex.getUnpackVector(o);let g=Math.floor((r+h[3])/h[2]);return u[2]=g%256,g=Math.floor(g/256),u[1]=g%256,g=Math.floor(g/256),u[0]=g,u}getPixels(){return new XP({width:this.stride,height:this.stride},this.pixels)}backfillBorder(r,o,u){if(this.dim!==r.dim)throw new Error("dem dimension mismatch");let h=o*this.dim,g=o*this.dim+this.dim,_=u*this.dim,b=u*this.dim+this.dim;switch(o){case-1:h=g-1;break;case 1:g=h+1}switch(u){case-1:_=b-1;break;case 1:b=_+1}const T=-o*this.dim,E=-u*this.dim;for(let A=_;A<b;A++)for(let R=h;R<g;R++){const M=4*this._idx(R,A),F=4*this._idx(R+T,A+E);this.pixels[M+0]=r.pixels[F+0],this.pixels[M+1]=r.pixels[F+1],this.pixels[M+2]=r.pixels[F+2],this.pixels[M+3]=r.pixels[F+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}function c9(a,r,o){a===1?r.headerLength=o.readFixed32():a===2?r.x=o.readVarint():a===3?r.y=o.readVarint():a===4?r.z=o.readVarint():a===5&&r.layers.push((function(u,h){return u.readFields(p9,{version:0,name:"",units:"",tileSize:0,buffer:0,pixelFormat:0,dataIndex:[]},h)})(o,o.readVarint()+o.pos))}function u9(a,r,o){a===1?(r.delta_filter=(function(u,h){return u.readFields(d9,{blockSize:0},h)})(o,o.readVarint()+o.pos),r.filter="delta_filter"):a===2?(o.readVarint(),r.filter="zigzag_filter"):a===3?(o.readVarint(),r.filter="bitshuffle_filter"):a===4&&(o.readVarint(),r.filter="byteshuffle_filter")}function d9(a,r,o){a===1&&(r.blockSize=o.readVarint())}function h9(a,r,o){a===1?(o.readVarint(),r.codec="gzip_data"):a===2?(o.readVarint(),r.codec="jpeg_image"):a===3?(o.readVarint(),r.codec="webp_image"):a===4&&(o.readVarint(),r.codec="png_image")}function f9(a,r,o){let u=0,h=0;a===1?r.firstByte=o.readFixed64():a===2?r.lastByte=o.readFixed64():a===3?r.filters.push((function(g,_){return g.readFields(u9,{},_)})(o,o.readVarint()+o.pos)):a===4?r.codec=(function(g,_){return g.readFields(h9,{},_)})(o,o.readVarint()+o.pos):a===5?h=o.readFloat():a===6?u=o.readFloat():a===7?r.bands.push(o.readString()):a===8?r.offset=o.readDouble():a===9&&(r.scale=o.readDouble()),r.offset===0&&(r.offset=h),r.scale===0&&(r.scale=u)}function p9(a,r,o){a===1?r.version=o.readVarint():a===2?r.name=o.readString():a===3?r.units=o.readString():a===4?r.tileSize=o.readVarint():a===5?r.buffer=o.readVarint():a===6?r.pixelFormat=o.readVarint():a===7&&r.dataIndex.push((function(u,h){return u.readFields(f9,{firstByte:0,lastByte:0,filters:[],codec:null,offset:0,scale:0,bands:[]},h)})(o,o.readVarint()+o.pos))}function m9(a,r,o){if(a===2)(function(u,h,g){u.readFields(g9,g,h)})(o,o.readVarint()+o.pos,r);else if(a===3)throw new Error("Not implemented")}function g9(a,r,o){if(a===1){let u=0;const h=o.readVarint()+o.pos;for(;o.pos<h;)r[u++]=o.readVarint()}}function _9(a,r){if(r.length!==4)throw new Error(`Expected data of dimension 4 but got ${r.length}.`);let o=r[3];for(let u=2;u>=1;u--){const h=u===1?1:0,g=u===2?1:0;for(let _=0;_<r[0];_++){const b=r[1]*_;for(let T=h;T<r[1];T++){const E=r[2]*(T+b);for(let A=g;A<r[2];A++){const R=r[3]*(A+E);for(let M=0;M<r[3];M++){const F=R+M;a[F]+=a[F-o]}}}}o*=r[u]}return a}function y9(a){for(let r=0,o=a.length;r<o;r++)a[r]=a[r]>>>1^-(1&a[r]);return a}function v9(a,r){switch(r){case"uint32":return a;case"uint16":for(let o=0;o<a.length;o+=2){const u=a[o],h=a[o+1];a[o]=(240&u)>>4|(61440&u)>>8|(240&h)<<4|61440&h,a[o+1]=15&u|(3840&u)>>4|(15&h)<<8|(3840&h)<<4}return a;case"uint8":for(let o=0;o<a.length;o+=4){const u=a[o],h=a[o+1],g=a[o+2],_=a[o+3];a[o+0]=(192&u)>>6|(192&h)>>4|(192&g)>>2|192&_,a[o+1]=(48&u)>>4|(48&h)>>2|48&g|(48&_)<<2,a[o+2]=(12&u)>>2|12&h|(12&g)<<2|(12&_)<<4,a[o+3]=3&u|(3&h)<<2|(3&g)<<4|(3&_)<<6}return a;default:throw new Error(`Invalid pixel format, "${r}"`)}}Wt(ex,"DEMData"),Wt(nO,"DemMinMaxQuadTree",{omit:["dem"]});var il=Uint8Array,jy=Uint16Array,b9=Int32Array,iO=new il([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),oO=new il([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),x9=new il([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),sO=function(a,r){for(var o=new jy(31),u=0;u<31;++u)o[u]=r+=1<<a[u-1];var h=new b9(o[30]);for(u=1;u<30;++u)for(var g=o[u];g<o[u+1];++g)h[g]=g-o[u]<<5|u;return{b:o,r:h}},aO=sO(iO,2),lO=aO.b,w9=aO.r;lO[28]=258,w9[258]=28;for(var T9=sO(oO,0).b,cO=new jy(32768),Do=0;Do<32768;++Do){var Ym=(43690&Do)>>1|(21845&Do)<<1;cO[Do]=((65280&(Ym=(61680&(Ym=(52428&Ym)>>2|(13107&Ym)<<2))>>4|(3855&Ym)<<4))>>8|(255&Ym)<<8)>>1}var Gy=function(a,r,o){for(var u=a.length,h=0,g=new jy(r);h<u;++h)a[h]&&++g[a[h]-1];var _,b=new jy(r);for(h=1;h<r;++h)b[h]=b[h-1]+g[h-1]<<1;_=new jy(1<<r);var T=15-r;for(h=0;h<u;++h)if(a[h])for(var E=h<<4|a[h],A=r-a[h],R=b[a[h]-1]++<<A,M=R|(1<<A)-1;R<=M;++R)_[cO[R]>>T]=E;return _},Hy=new il(288);for(Do=0;Do<144;++Do)Hy[Do]=8;for(Do=144;Do<256;++Do)Hy[Do]=9;for(Do=256;Do<280;++Do)Hy[Do]=7;for(Do=280;Do<288;++Do)Hy[Do]=8;var uO=new il(32);for(Do=0;Do<32;++Do)uO[Do]=5;var S9=Gy(Hy,9),E9=Gy(uO,5),VE=function(a){for(var r=a[0],o=1;o<a.length;++o)a[o]>r&&(r=a[o]);return r},sc=function(a,r,o){var u=r/8|0;return(a[u]|a[u+1]<<8)>>(7&r)&o},$E=function(a,r){var o=r/8|0;return(a[o]|a[o+1]<<8|a[o+2]<<16)>>(7&r)},C9=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],ac=function(a,r,o){var u=new Error(r||C9[a]);if(u.code=a,Error.captureStackTrace&&Error.captureStackTrace(u,ac),!o)throw u;return u},I9=new il(0),A9=typeof TextDecoder<"u"&&new TextDecoder;try{A9.decode(I9,{stream:!0})}catch{}const P9={gzip_data:"gzip"};class kl extends Error{constructor(r){super(r),this.name="MRTError"}}const R9={0:"uint32",1:"uint32",2:"uint16",3:"uint8"},dO={uint32:1,uint16:2,uint8:4},k9={uint32:Uint32Array,uint16:Uint16Array,uint8:Uint8Array};let UE;class tx{constructor(r=5){this.x=NaN,this.y=NaN,this.z=NaN,this.layers={},this._cacheSize=r}getLayer(r){const o=this.layers[r];if(!o)throw new kl(`Layer '${r}' not found`);return o}getHeaderLength(r){const o=new Uint8Array(r),u=new DataView(r);if(o[0]!==13)throw new kl("File is not a valid MRT.");return u.getUint32(1,!0)}parseHeader(r){const o=new Uint8Array(r),u=this.getHeaderLength(r);if(o.length<u)throw new kl(`Expected header with length >= ${u} but got buffer of length ${o.length}`);const h=new UE(o.subarray(0,u)).readFields(c9,{headerLength:0,x:0,y:0,z:0,layers:[]},void 0);if(!isNaN(this.x)&&(this.x!==h.x||this.y!==h.y||this.z!==h.z))throw new kl(`Invalid attempt to parse header ${h.z}/${h.x}/${h.y} for tile ${this.z}/${this.x}/${this.y}`);this.x=h.x,this.y=h.y,this.z=h.z;for(const g of h.layers)this.layers[g.name]=new hO(g,{cacheSize:this._cacheSize});return this}createDecodingTask(r){const o=[],u=this.getLayer(r.layerName);for(let h of r.blockIndices){const g=u.dataIndex[h],_=g.firstByte-r.firstByte,b=g.lastByte-r.firstByte;if(u._blocksInProgress.has(h))continue;const T={layerName:u.name,firstByte:_,lastByte:b,pixelFormat:u.pixelFormat,blockIndex:h,blockShape:[g.bands.length].concat(u.bandShape),buffer:u.buffer,codec:g.codec.codec,filters:g.filters.map((E=>E.filter))};u._blocksInProgress.add(h),o.push(T)}return new fO(o,(()=>{o.forEach((h=>u._blocksInProgress.delete(h.blockIndex)))}),((h,g)=>{if(o.forEach((_=>u._blocksInProgress.delete(_.blockIndex))),h)throw h;g.forEach((_=>{this.getLayer(_.layerName).processDecodedData(_)}))}))}}class hO{constructor({version:r,name:o,units:u,tileSize:h,pixelFormat:g,buffer:_,dataIndex:b},T){if(this.version=r,this.version!==1)throw new kl(`Cannot parse raster layer encoded with MRT version ${r}`);this.name=o,this.units=u,this.tileSize=h,this.buffer=_,this.pixelFormat=R9[g],this.dataIndex=b,this.bandShape=[h+2*_,h+2*_,dO[this.pixelFormat]],this._decodedBlocks=new Q1(T?T.cacheSize:5),this._blocksInProgress=new Set}get dimension(){return dO[this.pixelFormat]}get cacheSize(){return this._decodedBlocks.capacity}getBandList(){return this.dataIndex.map((({bands:r})=>r)).flat()}processDecodedData(r){const o=r.blockIndex.toString();this._decodedBlocks.get(o)||this._decodedBlocks.put(o,r.data)}getBlockForBand(r){let o=0;switch(typeof r){case"string":for(const[u,h]of this.dataIndex.entries()){for(const[g,_]of h.bands.entries())if(_===r)return{bandIndex:o+g,blockIndex:u,blockBandIndex:g};o+=h.bands.length}break;case"number":for(const[u,h]of this.dataIndex.entries()){if(r>=o&&r<o+h.bands.length)return{bandIndex:r,blockIndex:u,blockBandIndex:r-o};o+=h.bands.length}break;default:throw new kl(`Invalid band \`${JSON.stringify(r)}\`. Expected string or integer.`)}return{blockIndex:-1,blockBandIndex:-1}}getDataRange(r){let o=1/0,u=-1/0;const h=[],g=new Set;for(const _ of r){const{blockIndex:b}=this.getBlockForBand(_);if(b<0)throw new kl(`Invalid band: ${JSON.stringify(_)}`);const T=this.dataIndex[b];h.includes(b)||h.push(b),g.add(b),o=Math.min(o,T.firstByte),u=Math.max(u,T.lastByte)}if(g.size>this.cacheSize)throw new kl(`Number of blocks to decode (${g.size}) exceeds cache size (${this.cacheSize}).`);return{layerName:this.name,firstByte:o,lastByte:u,blockIndices:h}}hasBand(r){const{blockIndex:o}=this.getBlockForBand(r);return o>=0}hasDataForBand(r){const{blockIndex:o}=this.getBlockForBand(r);return o>=0&&!!this._decodedBlocks.get(o.toString())}getBandView(r){const{blockIndex:o,blockBandIndex:u}=this.getBlockForBand(r);if(o<0)throw new kl(`Band not found: ${JSON.stringify(r)}`);const h=this._decodedBlocks.get(o.toString());if(!h)throw new kl(`Data for band ${JSON.stringify(r)} of layer "${this.name}" not decoded.`);const g=this.dataIndex[o],_=this.bandShape.reduce(((E,A)=>E*A),1),b=u*_,T=h.subarray(b,b+_);return{data:T,bytes:new Uint8Array(T.buffer).subarray(T.byteOffset,T.byteOffset+T.byteLength),tileSize:this.tileSize,buffer:this.buffer,pixelFormat:this.pixelFormat,dimension:this.dimension,offset:g.offset,scale:g.scale}}}tx.setPbf=function(a){UE=a};class fO{constructor(r,o,u){this.tasks=r,this._onCancel=o,this._onComplete=u,this._finalized=!1}cancel(){this._finalized||(this._onCancel(),this._finalized=!0)}complete(r,o){this._finalized||(this._onComplete(r,o),this._finalized=!0)}}tx.performDecoding=function(a,r){const o=new Uint8Array(a);return Promise.all(r.tasks.map((u=>{const{layerName:h,firstByte:g,lastByte:_,pixelFormat:b,blockShape:T,blockIndex:E,filters:A,codec:R}=u,M=o.subarray(g,_+1),F=new Uint32Array(T[0]*T[1]*T[2]);let B;if(R!=="gzip_data")throw new kl(`Unhandled codec: ${R}`);return B=(function(W,q){if(!globalThis.DecompressionStream&&q==="gzip_data")return Promise.resolve(((oe=(function(Ce){Ce[0]==31&&Ce[1]==139&&Ce[2]==8||ac(6,"invalid gzip data");var Oe=Ce[3],De=10;4&Oe&&(De+=2+(Ce[10]|Ce[11]<<8));for(var ut=(Oe>>3&1)+(Oe>>4&1);ut>0;ut-=!Ce[De++]);return De+(2&Oe)})(re=W))+8>re.length&&ac(6,"invalid gzip data"),(function(Ce,Oe,De,ut){var Ue=Ce.length;if(!Ue||Oe.f&&!Oe.l)return De||new il(0);var ht=!De,wt=ht||Oe.i!=2,mt=Oe.i;ht&&(De=new il(3*Ue));var yt,Et,lt=function(_i){var yi=De.length;if(_i>yi){var ci=new il(Math.max(2*yi,_i));ci.set(De),De=ci}},vt=Oe.f||0,rt=Oe.p||0,Xe=Oe.b||0,Ct=Oe.l,Tt=Oe.d,hn=Oe.m,Ht=Oe.n,Jt=8*Ue;do{if(!Ct){vt=sc(Ce,rt,1);var Dt=sc(Ce,rt+1,3);if(rt+=3,!Dt){var dn=Ce[(ae=4+((rt+7)/8|0))-4]|Ce[ae-3]<<8,Fn=ae+dn;if(Fn>Ue){mt&&ac(0);break}wt&&lt(Xe+dn),De.set(Ce.subarray(ae,Fn),Xe),Oe.b=Xe+=dn,Oe.p=rt=8*Fn,Oe.f=vt;continue}if(Dt==1)Ct=S9,Tt=E9,hn=9,Ht=5;else if(Dt==2){var Vt=sc(Ce,rt,31)+257,tn=sc(Ce,rt+10,15)+4,An=Vt+sc(Ce,rt+5,31)+1;rt+=14;for(var Nn=new il(An),er=new il(19),Un=0;Un<tn;++Un)er[x9[Un]]=sc(Ce,rt+3*Un,7);rt+=3*tn;var Xt=VE(er),Vn=(1<<Xt)-1,br=Gy(er,Xt);for(Un=0;Un<An;){var ae,le=br[sc(Ce,rt,Vn)];if(rt+=15&le,(ae=le>>4)<16)Nn[Un++]=ae;else{var et=0,ct=0;for(ae==16?(ct=3+sc(Ce,rt,3),rt+=2,et=Nn[Un-1]):ae==17?(ct=3+sc(Ce,rt,7),rt+=3):ae==18&&(ct=11+sc(Ce,rt,127),rt+=7);ct--;)Nn[Un++]=et}}var Nt=Nn.subarray(0,Vt),Bt=Nn.subarray(Vt);hn=VE(Nt),Ht=VE(Bt),Ct=Gy(Nt,hn),Tt=Gy(Bt,Ht)}else ac(1);if(rt>Jt){mt&&ac(0);break}}wt&&lt(Xe+131072);for(var Kt=(1<<hn)-1,_n=(1<<Ht)-1,tr=rt;;tr=rt){var nr=(et=Ct[$E(Ce,rt)&Kt])>>4;if((rt+=15&et)>Jt){mt&&ac(0);break}if(et||ac(2),nr<256)De[Xe++]=nr;else{if(nr==256){tr=rt,Ct=null;break}var Jn=nr-254;nr>264&&(Jn=sc(Ce,rt,(1<<(Zn=iO[Un=nr-257]))-1)+lO[Un],rt+=Zn);var Kr=Tt[$E(Ce,rt)&_n],Ii=Kr>>4;if(Kr||ac(3),rt+=15&Kr,Bt=T9[Ii],Ii>3){var Zn=oO[Ii];Bt+=$E(Ce,rt)&(1<<Zn)-1,rt+=Zn}if(rt>Jt){mt&&ac(0);break}wt&&lt(Xe+131072);var mi=Xe+Jn;if(Xe<Bt){var Jr=0-Bt,Dr=Math.min(Bt,mi);for(Jr+Xe<0&&ac(3);Xe<Dr;++Xe)De[Xe]=(void 0)[Jr+Xe]}for(;Xe<mi;++Xe)De[Xe]=De[Xe-Bt]}}Oe.l=Ct,Oe.p=tr,Oe.b=Xe,Oe.f=vt,Ct&&(vt=1,Oe.m=hn,Oe.d=Tt,Oe.n=Ht)}while(!vt);return Xe!=De.length&&ht?(yt=De,((Et=Xe)==null||Et>yt.length)&&(Et=yt.length),new il(yt.subarray(0,Et))):De.subarray(0,Xe)})(re.subarray(oe,-8),{i:2},new il(((K=re)[(ne=K.length)-4]|K[ne-3]<<8|K[ne-2]<<16|K[ne-1]<<24)>>>0))));var K,ne,re,oe;const ye=P9[q];if(!ye)throw new Error(`Unhandled codec: ${q}`);const ve=new globalThis.DecompressionStream(ye);return new Response(new Blob([W]).stream().pipeThrough(ve)).arrayBuffer().then((Ce=>new Uint8Array(Ce)))})(M,R).then((W=>((function(q,K){q.readFields(m9,K)})(new UE(W),F),new k9[b](F.buffer)))),B.then((W=>{for(let q=A.length-1;q>=0;q--)switch(A[q]){case"delta_filter":_9(W,T);break;case"zigzag_filter":y9(W);break;case"bitshuffle_filter":v9(W,b);break;default:throw new kl(`Unhandled filter "${A[q]}"`)}return{layerName:h,blockIndex:E,data:W}})).catch((W=>{throw W}))})))},Wt(fO,"MRTDecodingBatch",{omit:["_onCancel","_onComplete"]}),Wt(tx,"MapboxRasterTile"),Wt(hO,"MapboxRasterLayer",{omit:["_blocksInProgress"]});class pO{constructor(r){this._stringToNumber={},this._numberToString=[];for(let o=0;o<r.length;o++){const u=r[o];this._stringToNumber[u]=o,this._numberToString[o]=u}}encode(r){return this._stringToNumber[r]}decode(r){return this._numberToString[r]}}const O9=["id","tile","layer","source","sourceLayer","state"];class Jm{constructor(r,o,u,h,g){this.type="Feature",this._vectorTileFeature=r,this._z=o,this._x=u,this._y=h,this.properties=r.properties,this.id=g}clone(){const r=new Jm(this._vectorTileFeature,this._z,this._x,this._y,this.id);return this.state&&(r.state=Object.assign({},this.state)),this.layer&&(r.layer=Object.assign({},this.layer)),this.source&&(r.source=this.source),this.sourceLayer&&(r.sourceLayer=this.sourceLayer),r}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(r){this._geometry=r}toJSON(){const r={type:"Feature",state:void 0,geometry:this.geometry,properties:this.properties};for(const o of O9)this[o]!==void 0&&(r[o]=this[o]);return r}}class mO{constructor(r,o){this.tileID=r,this.x=r.canonical.x,this.y=r.canonical.y,this.z=r.canonical.z,this.grid=new Uu(zt,16,0),this.featureIndexArray=new n1,this.promoteId=o,this.is3DTile=!1,this.serializedLayersCache=new Map}insert(r,o,u,h,g,_=0,b=0){const T=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(u,h,g,_);const E=this.grid;for(let A=0;A<o.length;A++){const R=o[A],M=[1/0,1/0,-1/0,-1/0];for(let F=0;F<R.length;F++){const B=R[F];M[0]=Math.min(M[0],B.x),M[1]=Math.min(M[1],B.y),M[2]=Math.max(M[2],B.x),M[3]=Math.max(M[3],B.y)}b!==0&&(M[0]-=b,M[1]-=b,M[2]+=b,M[3]+=b),M[0]<zt&&M[1]<zt&&M[2]>=0&&M[3]>=0&&E.insert(T,M[0],M[1],M[2],M[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new Ln(new P1(this.rawTileData)).layers,this.sourceLayerCoder=new pO(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const r in this.vtLayers)this.vtFeatures[r]=[]}return this.vtLayers}query(r,o){const{tilespaceGeometry:u,transform:h,tileTransform:g,pixelPosMatrix:_,availableImages:b,worldview:T}=o;this.loadVTLayers(),this.serializedLayersCache.clear();const E=u.bufferedTilespaceBounds,A=this.grid.query(E.min.x,E.min.y,E.max.x,E.max.y,((B,W,q,K)=>mo(u.bufferedTilespaceGeometry,B,W,q,K)));A.sort(M9);let R=null;h.elevation&&A.length>0&&(R=Km.create(h.elevation,this.tileID));const M={};let F;for(let B=0;B<A.length;B++){const W=A[B];if(W===F)continue;F=W;const q=this.featureIndexArray.get(W);let K=null;this.is3DTile?this.loadMatchingModelFeature(M,q,r,u,h,T):this.loadMatchingFeature(M,q,r,b,T,((ne,re,oe,ye=0)=>(K||(K=Ut(ne,this.tileID.canonical,g)),re.queryIntersectsFeature(u,ne,oe,K,this.z,h,_,R,ye))))}return M}loadMatchingFeature(r,o,u,h,g,_){const{featureIndex:b,bucketIndex:T,sourceLayerIndex:E,layoutVertexArrayOffset:A}=o,R=this.bucketLayerIDs[T],M=u.layers,F=Object.keys(M);if(F.length&&!fr(F,R))return;const B=u.sourceCache,W=this.sourceLayerCoder.decode(E),q=this.vtLayers[W].feature(b),K=this.getId(q,W);for(let ne=0;ne<R.length;ne++){const re=R[ne];if(!M[re])continue;const{styleLayer:oe,targets:ye}=M[re];let ve={};K!==void 0&&(ve=B.getFeatureState(oe.sourceLayer,K));const Ce=!_||_(q,oe,ve,A);if(!Ce)continue;const Oe=new Jm(q,this.z,this.x,this.y,K);Oe.tile=this.tileID.canonical,Oe.state=ve;let De=this.serializedLayersCache.get(re);De||(De=oe.serialize(),De.id=re,this.serializedLayersCache.set(re,De)),Oe.source=De.source,Oe.sourceLayer=De["source-layer"],Oe.layer=Object.assign({},De),Oe.layer.paint=gO(De.paint,oe.paint,q,ve,h),Oe.layer.layout=gO(De.layout,oe.layout,q,ve,h);let ut=!1;for(const Ue of ye){this.updateFeatureProperties(Oe,Ue);const{filter:ht}=Ue;if(ht){if(q.properties=Oe.properties,ht.needGeometry){const wt=St(q,!0);if(!ht.filter(new pi(this.tileID.overscaledZ,{worldview:g}),wt,this.tileID.canonical))continue}else if(!ht.filter(new pi(this.tileID.overscaledZ,{worldview:g}),q))continue}ut=!0,Ue.targetId&&this.addFeatureVariant(Oe,Ue)}ut&&this.appendToResult(r,re,b,Oe,Ce)}}loadMatchingModelFeature(r,o,u,h,g,_){const{featureIndex:b,bucketIndex:T}=o,E=this.bucketLayerIDs[T],A=u.layers,R=Object.keys(A);if(!R.length||fr(R,E))for(let M=0;M<E.length;M++){const F=E[M],{styleLayer:B,targets:W}=A[F];if(B.type!=="model")continue;const q=h.tile,K=q.getBucket(B);if(!(K&&K instanceof K1))continue;const ne=B7(K,b,h,g);if(!ne)continue;const{z:re,x:oe,y:ye}=q.tileID.canonical,{feature:ve,intersectionZ:Ce,position:Oe}=ne;let De={};ve.id!==void 0&&(De=u.sourceCache.getFeatureState(B.sourceLayer,ve.id));const ut=new Jm({},re,oe,ye,ve.id);ut.tile=this.tileID.canonical,ut.state=De,ut.properties=ve.properties,ut.geometry={type:"Point",coordinates:[Oe.lng,Oe.lat]};let Ue=this.serializedLayersCache.get(F);Ue||(Ue=B.serialize(),Ue.id=F,this.serializedLayersCache.set(F,Ue)),ut.source=Ue.source,ut.sourceLayer=Ue["source-layer"],ut.layer=Object.assign({},Ue);let ht=!1;for(const wt of W){this.updateFeatureProperties(ut,wt);const{filter:mt}=wt;if(mt){if(ve.properties=ut.properties,mt.needGeometry){if(!mt.filter(new pi(this.tileID.overscaledZ,{worldview:_}),ve,this.tileID.canonical))continue}else if(!mt.filter(new pi(this.tileID.overscaledZ,{worldview:_}),ve))continue}ht=!0,wt.targetId&&this.addFeatureVariant(ut,wt)}ht&&this.appendToResult(r,F,b,ut,Ce)}}updateFeatureProperties(r,o,u){if(o.properties){const h={};for(const g in o.properties){const _=o.properties[g].evaluate({zoom:this.z},r._vectorTileFeature,r.state,r.tile,u);_!=null&&(h[g]=_)}r.properties=h}}addFeatureVariant(r,o,u){const h={target:o.target,namespace:o.namespace,uniqueFeatureID:o.uniqueFeatureID};o.properties&&(h.properties=r.properties),r.variants=r.variants||{},r.variants[o.targetId]=r.variants[o.targetId]||[],r.variants[o.targetId].push(h)}appendToResult(r,o,u,h,g){let _=r[o];_===void 0&&(_=r[o]=[]),_.push({featureIndex:u,feature:h,intersectionZ:g})}lookupSymbolFeatures(r,o,u,h,g,_){const b={};this.loadVTLayers();for(const T of r)this.loadMatchingFeature(b,{bucketIndex:o,sourceLayerIndex:u,featureIndex:T,layoutVertexArrayOffset:0},h,g,_);return b}loadFeature(r){const{featureIndex:o,sourceLayerIndex:u}=r;this.loadVTLayers();const h=this.sourceLayerCoder.decode(u),g=this.vtFeatures[h];if(g[o])return g[o];const _=this.vtLayers[h].feature(o);return g[o]=_,_}hasLayer(r){for(const o of this.bucketLayerIDs)for(const u of o)if(r===u)return!0;return!1}getId(r,o){let u=r.id;if(this.promoteId){const h=Array.isArray(this.promoteId)||typeof this.promoteId!="object"?this.promoteId:this.promoteId[o];if(h!=null)if(Array.isArray(h)){if(!this.promoteIdExpression){const g=Sl(h);if(g.result!=="success"){const _=g.value.map((b=>`${b.key}: ${b.message}`)).join(", ");return void cr(`Failed to create expression for promoteId: ${_}`)}this.promoteIdExpression=g.value}this.promoteIdExpression._evaluator||(this.promoteIdExpression._evaluator=new Xl),u=this.promoteIdExpression.evaluate({zoom:0},r)}else u=r.properties[h];typeof u=="boolean"&&(u=Number(u))}return u}}function gO(a,r,o,u,h){return zn(a,((g,_)=>{const b=r instanceof qu?r.get(_):null;return b&&b.evaluate?b.evaluate(o,u,void 0,h):b}))}function M9(a,r){return r-a}Wt(mO,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});const _O=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class jE{static from(r){if(!(r instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[o,u]=new Uint8Array(r,0,2);if(o!==219)throw new Error("Data does not appear to be in a KDBush format.");const h=u>>4;if(h!==1)throw new Error(`Got v${h} data when expected v1.`);const g=_O[15&u];if(!g)throw new Error("Unrecognized array type.");const[_]=new Uint16Array(r,2,1),[b]=new Uint32Array(r,4,1);return new jE(b,_,g,r)}constructor(r,o=64,u=Float64Array,h){if(isNaN(r)||r<0)throw new Error(`Unpexpected numItems value: ${r}.`);this.numItems=+r,this.nodeSize=Math.min(Math.max(+o,2),65535),this.ArrayType=u,this.IndexArrayType=r<65536?Uint16Array:Uint32Array;const g=_O.indexOf(this.ArrayType),_=2*r*this.ArrayType.BYTES_PER_ELEMENT,b=r*this.IndexArrayType.BYTES_PER_ELEMENT,T=(8-b%8)%8;if(g<0)throw new Error(`Unexpected typed array class: ${u}.`);h&&h instanceof ArrayBuffer?(this.data=h,this.ids=new this.IndexArrayType(this.data,8,r),this.coords=new this.ArrayType(this.data,8+b+T,2*r),this._pos=2*r,this._finished=!0):(this.data=new ArrayBuffer(8+_+b+T),this.ids=new this.IndexArrayType(this.data,8,r),this.coords=new this.ArrayType(this.data,8+b+T,2*r),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+g]),new Uint16Array(this.data,2,1)[0]=o,new Uint32Array(this.data,4,1)[0]=r)}add(r,o){const u=this._pos>>1;return this.ids[u]=u,this.coords[this._pos++]=r,this.coords[this._pos++]=o,u}finish(){const r=this._pos>>1;if(r!==this.numItems)throw new Error(`Added ${r} items when expected ${this.numItems}.`);return GE(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(r,o,u,h){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:g,coords:_,nodeSize:b}=this,T=[0,g.length-1,0],E=[];for(;T.length;){const A=T.pop()||0,R=T.pop()||0,M=T.pop()||0;if(R-M<=b){for(let q=M;q<=R;q++){const K=_[2*q],ne=_[2*q+1];K>=r&&K<=u&&ne>=o&&ne<=h&&E.push(g[q])}continue}const F=M+R>>1,B=_[2*F],W=_[2*F+1];B>=r&&B<=u&&W>=o&&W<=h&&E.push(g[F]),(A===0?r<=B:o<=W)&&(T.push(M),T.push(F-1),T.push(1-A)),(A===0?u>=B:h>=W)&&(T.push(F+1),T.push(R),T.push(1-A))}return E}within(r,o,u){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:h,coords:g,nodeSize:_}=this,b=[0,h.length-1,0],T=[],E=u*u;for(;b.length;){const A=b.pop()||0,R=b.pop()||0,M=b.pop()||0;if(R-M<=_){for(let q=M;q<=R;q++)vO(g[2*q],g[2*q+1],r,o)<=E&&T.push(h[q]);continue}const F=M+R>>1,B=g[2*F],W=g[2*F+1];vO(B,W,r,o)<=E&&T.push(h[F]),(A===0?r-u<=B:o-u<=W)&&(b.push(M),b.push(F-1),b.push(1-A)),(A===0?r+u>=B:o+u>=W)&&(b.push(F+1),b.push(R),b.push(1-A))}return T}}function GE(a,r,o,u,h,g){if(h-u<=o)return;const _=u+h>>1;yO(a,r,_,u,h,g),GE(a,r,o,u,_-1,1-g),GE(a,r,o,_+1,h,1-g)}function yO(a,r,o,u,h,g){for(;h>u;){if(h-u>600){const E=h-u+1,A=o-u+1,R=Math.log(E),M=.5*Math.exp(2*R/3),F=.5*Math.sqrt(R*M*(E-M)/E)*(A-E/2<0?-1:1);yO(a,r,o,Math.max(u,Math.floor(o-A*M/E+F)),Math.min(h,Math.floor(o+(E-A)*M/E+F)),g)}const _=r[2*o+g];let b=u,T=h;for(Wy(a,r,u,o),r[2*h+g]>_&&Wy(a,r,u,h);b<T;){for(Wy(a,r,b,T),b++,T--;r[2*b+g]<_;)b++;for(;r[2*T+g]>_;)T--}r[2*u+g]===_?Wy(a,r,u,T):(T++,Wy(a,r,T,h)),T<=o&&(u=T+1),o<=T&&(h=T-1)}}function Wy(a,r,o,u){HE(a,o,u),HE(r,2*o,2*u),HE(r,2*o+1,2*u+1)}function HE(a,r,o){const u=a[r];a[r]=a[o],a[o]=u}function vO(a,r,o,u){const h=a-o,g=r-u;return h*h+g*g}s.$=h_,s.A=Ft,s.B=eh,s.C=2,s.D=Bm,s.E=xl,s.F=Oy,s.G=Gk,s.H=d_,s.I=zs,s.J=vm,s.K=Dn,s.L=vf,s.M=lm,s.N=am,s.O=B_,s.P=xt,s.Q=V_,s.R=Od,s.S=Ku,s.T=iE,s.U=Sl,s.V=q1,s.W=$_,s.X=Wd,s.Y=Hd,s.Z=Zp,s._=xs,s.a=function(a){return Ho.API_CDN_URL_REGEX.test(a)},s.a$=pe,s.a0=yf,s.a1=ku,s.a2=bm,s.a3=class extends q1{},s.a4=cm,s.a5=F_,s.a6=$e,s.a7=function(a){const r=a.value;return r?yf(r)?OE(r,!0)?[]:[new q1(a.key,r,`invalid url "${r}"`)]:[new q1(a.key,r,`string expected, "${Dn(r)}" found`)]:[]},s.a8=Vb,s.a9=Wi,s.aA=be,s.aB=Be,s.aC=Zt,s.aD=p,s.aE=$o,s.aF=se,s.aG=qe,s.aH=function(a,r){const o={};for(let u=0;u<r.length;u++){const h=r[u];h in a&&(o[h]=a[h])}return o},s.aI=J,s.aJ=me,s.aK=class{constructor(a){this.entries={},this.scheduler=a}request(a,r,o,u){const h=this.entries[a]=this.entries[a]||{callbacks:[]};if(h.result){const[g,_]=h.result;return this.scheduler?this.scheduler.add((()=>{u(g,_)}),r):u(g,_),()=>{}}return h.callbacks.push(u),h.cancel||(h.cancel=o(((g,_)=>{h.result=[g,_];for(const b of h.callbacks)this.scheduler?this.scheduler.add((()=>{b(g,_)}),r):b(g,_);setTimeout((()=>delete this.entries[a]),3e3)}))),()=>{h.result||(h.callbacks=h.callbacks.filter((g=>g!==u)),h.callbacks.length||(h.cancel(),delete this.entries[a]))}}},s.aL=function(a,r,o){const u=JSON.stringify(a.request);return a.data&&(this.deduped.entries[u]={result:[null,a.data]}),this.deduped.request(u,{type:"parseTile",isSymbolTile:a.isSymbolTile,zoom:a.tileZoom},(h=>{const g=Ec(a.request,((_,b,T,E)=>{_?h(_):b&&h(null,{vectorTile:o?void 0:new Ln(new P1(b)),rawData:b,cacheControl:T,expires:E})}));return()=>{g.cancel(),h()}}),r)},s.aM=function(a){vl++,vl>Ds&&(a.getActor().send("enforceCacheSizeLimit",ys),vl=0)},s.aN=function(a){return a<=1?1:Math.pow(2,Math.floor(Math.log2(a)))},s.aO=Ss,s.aP=v3,s.aQ=E3,s.aR=H,s.aS=y3,s.aT=function(a,r){const o=document.createElement("video");o.muted=!0,o.onloadstart=function(){r(null,o)};for(let u=0;u<a.length;u++){const h=document.createElement("source");Dp(a[u])||(o.crossOrigin="Anonymous"),h.src=a[u],o.appendChild(h)}return{cancel:()=>{}}},s.aU=Cy,s.aV=function(a){return fetch(a).then((r=>r.arrayBuffer())).then((r=>ZR(r,0,a)))},s.aW=rk,s.aX=class{constructor(a,r,o,u){this.id=a,this.position=r!=null?new H(r[0],r[1]):new H(0,0),this.orientation=o??[0,0,0],this.nodes=u,this.uploaded=!1,this.aabb=new kn([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),this.matrix=[]}_applyTransformations(a,r){if(Be(a.matrix,r,a.matrix),a.meshes)for(const o of a.meshes){const u=kn.applyTransformFast(o.aabb,a.matrix);this.aabb.encapsulate(u)}if(a.children)for(const o of a.children)this._applyTransformations(o,a.matrix)}computeBoundsAndApplyParent(){const a=de([]);for(const r of this.nodes)this._applyTransformations(r,a)}computeModelMatrix(a,r,o,u,h,g,_=!1){tk(this.matrix,this,a.transform,this.position,r,o,u,h,g,_)}upload(a){if(!this.uploaded){for(const r of this.nodes)aE(r,a);for(const r of this.nodes)A1(r);this.uploaded=!0}}destroy(){for(const a of this.nodes)lE(a)}},s.aY=xn,s.aZ=Ly,s.a_=ge,s.aa=It,s.ab=class{constructor(a){this.specification=a}possiblyEvaluate(a,r){return fo(a.expression.evaluate(r))}interpolate(a,r,o){return{x:wn(a.x,r.x,o),y:wn(a.y,r.y,o),z:wn(a.z,r.z,o),azimuthal:wn(a.azimuthal,r.azimuthal,o),polar:wn(a.polar,r.polar,o)}}},s.ac=pi,s.ad=Lc,s.ae=it,s.af=vn,s.ag=ke,s.ah=tt,s.ai=qu,s.aj=ch,s.ak=wn,s.al=zt,s.am=Zl,s.an=Fe,s.ao=Pr,s.ap=class{constructor(a){this.specification=a}possiblyEvaluate(a,r){return(function([o,u]){const h=fo([1,o,u]);return{x:h.x,y:h.y,z:h.z}})(a.expression.evaluate(r))}interpolate(a,r,o){return{x:wn(a.x,r.x,o),y:wn(a.y,r.y,o),z:wn(a.z,r.z,o)}}},s.aq=function(a,r,o=0,u=!0){const h=new xt(o,o),g=a.sub(h),_=r.add(h),b=[g,new xt(_.x,g.y),_,new xt(g.x,_.y)];return u&&b.push(g.clone()),b},s.ar=function(a,r){const o=[];for(let u=0;u<a.length;u++){const h=ze(u-1,-1,a.length-1),g=ze(u+1,-1,a.length-1),_=a[u],b=a[g],T=a[h].sub(_).unit(),E=b.sub(_).unit(),A=E.angleWithSep(T.x,T.y),R=T.add(E).unit().mult(-1*r/Math.sin(A/2));o.push(_.add(R))}return o},s.as=i3,s.at=mo,s.au=function(a,r,o=0){return Mn(((r.x-o)*a.scale-a.x)*zt,(r.y*a.scale-a.y)*zt,he(r.z,r.y))},s.av=Lt,s.aw=ur,s.ax=Mr,s.ay=mk,s.az=function(a){let r=1/0,o=1/0,u=-1/0,h=-1/0;for(const g of a)r=Math.min(r,g.x),o=Math.min(o,g.y),u=Math.max(u,g.x),h=Math.max(h,g.y);return{min:new xt(r,o),max:new xt(u,h)}},s.b=function(a){return Ho.API_FONTS_REGEX.test(a)},s.b$=WS,s.b0=Xu,s.b1=Mo,s.b2=gt,s.b3=sy,s.b4=j1,s.b5=function(){El.isLoading()||El.isLoaded()||ym()!=="deferred"||ju()},s.b6=Rf,s.b7=St,s.b8=Jm,s.b9=Sr,s.bA=de,s.bB=kt,s.bC=ue,s.bD=function(a,r){const{x:o,y:u}=a.point,h=FP(o,u,a.worldSize/a._pixelsPerMercatorPixel,0,0);return Be(h,h,MS(Wc(r)))},s.bE=L,s.bF=Qe,s.bG=function(a,r){var o=r[0]-a[0],u=r[1]-a[1],h=r[2]-a[2];return Math.sqrt(o*o+u*u+h*h)},s.bH=vr,s.bI=ln,s.bJ=Ot,s.bK=ky,s.bL=wa,s.bM=vE,s.bN=function(a,r,o,u,h){const g=5*r+2;a.float32[g+0]=o,a.float32[g+1]=u,a.float32[g+2]=h},s.bO=U1,s.bP=oo,s.bQ=Fo,s.bR=Ws,s.bS=Os,s.bT=ze,s.bU=function(a,r,o,u){var h=new P(4);return h[0]=a,h[1]=r,h[2]=o,h[3]=u,h},s.bV=x1,s.bW=va,s.bX=Zo,s.bY=pR,s.bZ=C3,s.b_=yR,s.ba=hE,s.bb=jS,s.bc=Ut,s.bd=Vc,s.be=Pm,s.bf=kP,s.bg=Bi,s.bh=zm,s.bi=RE,s.bj=function(a,r){const o=ch(r.zoom);if(o===0)return Wc(a);const u=u1(a),h=OS(u),g=se(u.getWest())*r.worldSize,_=se(u.getEast())*r.worldSize,b=me(u.getNorth())*r.worldSize,T=me(u.getSouth())*r.worldSize,E=[g,b,0],A=[_,b,0],R=[g,T,0],M=[_,T,0],F=Te([],r.globeMatrix);return vn(E,E,F),vn(A,A,F),vn(R,R,F),vn(M,M,F),h[0]=ed(h[0],R,o),h[1]=ed(h[1],M,o),h[2]=ed(h[2],A,o),h[3]=ed(h[3],E,o),kn.fromPoints(h)},s.bk=h1,s.bl=Te,s.bm=uy,s.bn=ed,s.bo=Zu,s.bp=a8,s.bq=Pe,s.br=Ge,s.bs=tx,s.bt=P1,s.bu=Ec,s.bv=function(a,r){const o=[];for(const u in a)u in r||o.push(u);return o},s.bw=nt,s.bx=["type","source","source-layer","minzoom","maxzoom","filter","layout"],s.by=Da,s.bz=function(a){var r=new P(16);return r[0]=a[0],r[1]=a[1],r[2]=a[2],r[3]=a[3],r[4]=a[4],r[5]=a[5],r[6]=a[6],r[7]=a[7],r[8]=a[8],r[9]=a[9],r[10]=a[10],r[11]=a[11],r[12]=a[12],r[13]=a[13],r[14]=a[14],r[15]=a[15],r},s.c=pf,s.c$=function(a){return a*a*a*a*a},s.c0=yE,s.c1=Yk,s.c2=TE,s.c3=jE,s.c4=or,s.c5=jt,s.c6=En,s.c7=function(a,r,o){o*=.5;var u=r[0],h=r[1],g=r[2],_=r[3],b=Math.sin(o),T=Math.cos(o);return a[0]=u*T+h*b,a[1]=h*T-u*b,a[2]=g*T+_*b,a[3]=_*T-g*b,a},s.c8=jn,s.c9=Ri,s.cA=Kn,s.cB=YR,s.cC=rc,s.cD=DP,s.cE=function(a,r,o,u,h,g,_,b,T){if(T.name==="globe")return DP(a,r,new rc(o,u,h),!1);const E=Ly({z:o,x:u,y:h},T);return new kn([(g+E.x/E.scale)*r,r*(E.y/E.scale),_],[(g+E.x2/E.scale)*r,r*(E.y2/E.scale),b])},s.cF=function(a,r,o){return a[0]=Math.min(r[0],o[0]),a[1]=Math.min(r[1],o[1]),a[2]=Math.min(r[2],o[2]),a[3]=Math.min(r[3],o[3]),a},s.cG=function(a,r,o){return a[0]=Math.max(r[0],o[0]),a[1]=Math.max(r[1],o[1]),a[2]=Math.max(r[2],o[2]),a[3]=Math.max(r[3],o[3]),a},s.cH=function(a){const r=Math.round((a+45+360)%360/90)%4;return Q[r]},s.cI=_e,s.cJ=fn,s.cK=v,s.cL=function(a){const r=de(new Float64Array(16));Be(r,a.pixelMatrix,a.globeMatrix);const o=[0,O,0],u=[0,D,0];return vn(o,o,r),vn(u,u,r),[o[0]>0&&o[0]<=a.width&&o[1]>0&&o[1]<=a.height&&!LS(a,new H(a.center.lat,90)),u[0]>0&&u[0]<=a.width&&u[1]>0&&u[1]<=a.height&&!LS(a,new H(a.center.lat,-90))]},s.cM=function(a,r){const{scale:o}=a.tileTransform,u=o*zt/(a.tileSize*Math.pow(2,r.zoom-a.tileID.overscaledZ+a.tileID.canonical.z));return(function(h,g,_){var b=g[1],T=g[2],E=g[3],A=_[0],R=_[1];return h[0]=g[0]*A,h[1]=b*A,h[2]=T*R,h[3]=E*R,h})(new Float32Array(4),r.inverseAdjustmentMatrix,[u,u])},s.cN=C1,s.cO=je,s.cP=XR,s.cQ=function(a){const r=XR(a,!0);return L([],[r[0],r[1],r[4],r[5]])},s.cR=Ye,s.cS=$r,s.cT=Ne,s.cU=function(a){const{x:r,y:o}=a.point,{lng:u,lat:h}=a._center;return FP(r,o,a.worldSize,u,h)},s.cV=ar,s.cW=Y,s.cX=Lm,s.cY=ns,s.cZ=y,s.c_=function(a,r,o){let u=0;for(let h=0;h<2;++h)a[h]>0&&(u+=(a[h]-0)*(a[h]-0)),r[h]<0&&(u+=(0-r[h])*(0-r[h]));return u},s.ca=function(a,r){return a[0]=-r[0],a[1]=-r[1],a[2]=-r[2],a[3]=r[3],a},s.cb=Se,s.cc=function(a,r,o,u,h){var g=1/Math.tan(r/2);if(a[0]=g/o,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=g,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[11]=-1,a[12]=0,a[13]=0,a[15]=0,h!=null&&h!==1/0){var _=1/(u-h);a[10]=(h+u)*_,a[14]=2*h*u*_}else a[10]=-1,a[14]=-2*u;return a},s.cd=function(a,r,o,u,h,g,_){var b=1/(r-o),T=1/(u-h),E=1/(g-_);return a[0]=-2*b,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=-2*T,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=2*E,a[11]=0,a[12]=(r+o)*b,a[13]=(h+u)*T,a[14]=(_+g)*E,a[15]=1,a},s.ce=fe,s.cf=function(a,r,o){a[4*r+0]=o[0],a[4*r+1]=o[1],a[4*r+2]=o[2],a[4*r+3]=o[3]},s.cg=Bf,s.ch=Nf,s.ci=po,s.cj=Il,s.ck=$f,s.cl=c3,s.cm=function(){var a=new P(4);return P!=Float32Array&&(a[1]=0,a[2]=0),a[0]=1,a[3]=1,a},s.cn=function(a,r,o){var u=r[0],h=r[1],g=r[2],_=r[3],b=Math.sin(o),T=Math.cos(o);return a[0]=u*T+g*b,a[1]=h*T+_*b,a[2]=u*-b+g*T,a[3]=h*-b+_*T,a},s.co=function(a,r){return a[0]===r[0]&&a[1]===r[1]&&a[2]===r[2]&&a[3]===r[3]},s.cp=dt,s.cq=function(a){var r=a[0],o=a[1],u=a[2],h=a[3];return Math.sqrt(r*r+o*o+u*u+h*h)},s.cr=ho,s.cs=He,s.ct=Dm,s.cu=3,s.cv=2,s.cw=7,s.cx=6,s.cy=yn,s.cz=Re,s.d=function(a){return Ho.API_TILEJSON_REGEX.test(a)},s.d$=vk,s.d0=ie,s.d1=45,s.d2=Vf,s.d3=function(a,r,o){const u=Math.sqrt(a*a+r*r+o*o),h=u>0?Math.acos(o/u)*Gl:0;let g=a!==0||r!==0?Math.atan2(-r,-a)*Gl+90:0;return g<0&&(g+=360),[u,g,h]},s.d4=Mn,s.d5=fo,s.d6=We,s.d7=mn,s.d8=kn,s.d9=Sn,s.dA=function(a,r,o){const u=ch(o.zoom),h=a.style.map._antialias,g=a.terrain&&a.terrain.exaggeration()>0;return u===0&&!h&&!g},s.dB=function(a){const r=a.pixelsPerMeter,o=r/fe(1,a.center.lat),u=de(new Float64Array(16));return Ge(u,u,[a.point.x,a.point.y,0]),Ye(u,u,[o,o,r]),Float32Array.from(u)},s.dC=u1,s.dD=function(a){const r=_e-5;a=be(a,-r,r)/r*90;const o=Math.pow(Math.abs(Math.sin(Fe(a))),3);return Math.round(o*(I.length-1))},s.dE=function(a,r,o,u){const h=r.getNorth(),g=r.getSouth(),_=r.getWest(),b=r.getEast(),T=1<<a.z,E=b-_,A=h-g,R=E/S,M=-A/I[o],F=[0,R,0,M,0,0,h,_,0];if(a.z>0){const B=180/u;j(F,F,[B/E+1,0,0,0,B/A+1,0,-.5*B/R,.5*B/M,1])}return F[2]=T,F[5]=a.x,F[8]=a.y,F},s.dF=Wc,s.dG=function(a,r,o){const u=de(new Float64Array(16)),h=(r/(1<<a)-.5)*Math.PI*2;return Mt(u,o.globeMatrix,h),Float32Array.from(u)},s.dH=class{isDataAvailableAtPoint(a){const r=this._source();if(this.isUsingMockSource()||!r||a.y<0||a.y>1)return!1;const o=r.getSource().maxzoom,u=1<<o,h=Math.floor(a.x),g=Math.floor((a.x-h)*u),_=Math.floor(a.y*u),b=this.findDEMTileFor(new Ss(o,h,o,g,_));return!(!b||!b.dem)}getAtPointOrZero(a,r=0){return this.getAtPoint(a,r)||0}getAtPoint(a,r,o=!0){if(this.isUsingMockSource())return null;r==null&&(r=null);const u=this._source();if(!u||a.y<0||a.y>1)return r;const h=u.getSource().maxzoom,g=1<<h,_=Math.floor(a.x),b=a.x-_,T=new Ss(h,_,h,Math.floor(b*g),Math.floor(a.y*g)),E=this.findDEMTileFor(T);if(!E||!E.dem)return r;const A=E.dem,R=1<<E.tileID.canonical.z,M=(b*R-E.tileID.canonical.x)*A.dim,F=(a.y*R-E.tileID.canonical.y)*A.dim,B=Math.floor(M),W=Math.floor(F);return(o?this.exaggeration():1)*wn(wn(A.get(B,W),A.get(B,W+1),F-W),wn(A.get(B+1,W),A.get(B+1,W+1),F-W),M-B)}getAtTileOffset(a,r,o){const u=1<<a.canonical.z;return this.getAtPointOrZero(new it(a.wrap+(a.canonical.x+r/zt)/u,(a.canonical.y+o/zt)/u))}getAtTileOffsetFunc(a,r,o,u){return h=>{const g=this.getAtTileOffset(a,h.x,h.y),_=u.upVector(a.canonical,h.x,h.y);return or(_,_,g*u.upVectorScale(a.canonical,r,o).metersToTile),_}}getForTilePoints(a,r,o,u){if(this.isUsingMockSource())return!1;const h=Km.create(this,a,u);return!!h&&(r.forEach((g=>{g[2]=this.exaggeration()*h.getElevationAt(g[0],g[1],o)})),!0)}getMinMaxForTile(a){if(this.isUsingMockSource())return null;const r=this.findDEMTileFor(a);if(!r||!r.dem)return null;const o=r.dem.tree,u=r.tileID,h=1<<a.canonical.z-u.canonical.z;let g=a.canonical.x/h-u.canonical.x,_=a.canonical.y/h-u.canonical.y,b=0;for(let T=0;T<a.canonical.z-u.canonical.z&&!o.leaves[b];T++){g*=2,_*=2;const E=2*Math.floor(_)+Math.floor(g);b=o.childOffsets[b]+E,g%=1,_%=1}return{min:this.exaggeration()*o.minimums[b],max:this.exaggeration()*o.maximums[b]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(a,r,o){throw new Error("Pure virtual method called.")}pointCoordinate(a){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(a){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}getMinMaxForVisibleTiles(){const a=this.visibleDemTiles;if(a.length===0)return null;let r=!1,o=Number.MAX_VALUE,u=Number.MIN_VALUE;for(const h of a){const g=this.getMinMaxForTile(h.tileID);g&&(o=Math.min(o,g.min),u=Math.max(u,g.max),r=!0)}return r?{min:o,max:u}:null}},s.dI=XP,s.dJ=c1,s.dK=function(a,r){return[Math.pow(a[0],2.2)*r,Math.pow(a[1],2.2)*r,Math.pow(a[2],2.2)*r]},s.dL=$,s.dM=function(a,r){var o=Math.sin(r),u=Math.cos(r);return a[0]=u,a[1]=o,a[2]=0,a[3]=-o,a[4]=u,a[5]=0,a[6]=0,a[7]=0,a[8]=1,a},s.dN=Nr,s.dO=zP,s.dP=Xo,s.dQ=_s,s.dR=256,s.dS=function(a,r){const o=[0,0,0];return vn(o,o,h1(Wc(r.canonical))),vn(o,o,a),o},s.dT=a=>({u_matrix:new $f(a),u_texsize:new Il(a),u_pixels_to_tile_units:new Mm(a),u_device_pixel_ratio:new po(a),u_width_scale:new po(a),u_floor_width_scale:new po(a),u_image:new Bf(a),u_units_to_pixels:new Il(a),u_tile_units_to_pixels:new po(a),u_alpha_discard_threshold:new po(a),u_trim_offset:new Il(a),u_trim_fade_range:new Il(a),u_trim_color:new Vf(a),u_emissive_strength:new po(a),u_zbias_factor:new po(a),u_tile_to_meter:new po(a),u_ground_shadow_factor:new Nf(a),u_pattern_transition:new po(a)}),s.dU=a=>({u_matrix:new $f(a),u_pixels_to_tile_units:new Mm(a),u_device_pixel_ratio:new po(a),u_width_scale:new po(a),u_floor_width_scale:new po(a),u_units_to_pixels:new Il(a),u_dash_image:new Bf(a),u_gradient_image:new Bf(a),u_image_height:new po(a),u_texsize:new Il(a),u_tile_units_to_pixels:new po(a),u_alpha_discard_threshold:new po(a),u_trim_offset:new Il(a),u_trim_fade_range:new Il(a),u_trim_color:new Vf(a),u_emissive_strength:new po(a),u_zbias_factor:new po(a),u_tile_to_meter:new po(a),u_ground_shadow_factor:new Nf(a)}),s.dV=a=>({u_camera_to_center_distance:new po(a),u_extrude_scale:new Mm(a),u_device_pixel_ratio:new po(a),u_matrix:new $f(a),u_inv_rot_matrix:new $f(a),u_merc_center:new Il(a),u_tile_id:new Nf(a),u_zoom_transition:new po(a),u_up_dir:new Nf(a),u_emissive_strength:new po(a)}),s.dW=ty,s.dX=W$,s.dY=class{constructor(a,r,o,u){this.context=a,this.format=u,this.size=o,this.texture=a.gl.createTexture();const[h,g,_]=this.size,{gl:b}=a;b.bindTexture(b.TEXTURE_3D,this.texture),a.pixelStoreUnpackFlipY.set(!1),a.pixelStoreUnpack.set(1),a.pixelStoreUnpackPremultiplyAlpha.set(!1),"data"in r&&r.data&&b.texImage3D(b.TEXTURE_3D,0,this.format,h,g,_,0,nE(this.format),rE(this.format),r.data)}bind(a,r){const{context:o}=this,{gl:u}=o;u.bindTexture(u.TEXTURE_3D,this.texture),a!==this.minFilter&&(u.texParameteri(u.TEXTURE_3D,u.TEXTURE_MAG_FILTER,a),u.texParameteri(u.TEXTURE_3D,u.TEXTURE_MIN_FILTER,a),this.minFilter=a),r!==this.wrapS&&(u.texParameteri(u.TEXTURE_3D,u.TEXTURE_WRAP_S,r),u.texParameteri(u.TEXTURE_3D,u.TEXTURE_WRAP_T,r),this.wrapS=r)}destroy(){const{gl:a}=this.context;a.deleteTexture(this.texture),this.texture=null}},s.dZ=VP,s.d_=(a,r,o,u,h,g)=>{const _=a.transform,b=_.projection.name==="globe";let T;if(g.paint.get("circle-pitch-alignment")==="map")if(b){const A=zP(_.zoom,r.canonical)*_._pixelsPerMercatorPixel;T=Float32Array.from([A,0,0,A])}else T=_.calculatePixelsToTileUnitsMatrix(o);else T=new Float32Array([_.pixelsToGLUnits[0],0,0,_.pixelsToGLUnits[1]]);const E={u_camera_to_center_distance:a.transform.getCameraToCenterDistance(_.projection),u_matrix:a.translatePosMatrix(r.projMatrix,o,g.paint.get("circle-translate"),g.paint.get("circle-translate-anchor")),u_device_pixel_ratio:Ms.devicePixelRatio,u_extrude_scale:T,u_inv_rot_matrix:h8,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0],u_emissive_strength:g.paint.get("circle-emissive-strength")};if(b){E.u_inv_rot_matrix=u,E.u_merc_center=h,E.u_tile_id=[r.canonical.x,r.canonical.y,1<<r.canonical.z],E.u_zoom_transition=ch(_.zoom);const A=h[0]*zt,R=h[1]*zt;E.u_up_dir=_.projection.upVector(new rc(0,0,0),A,R)}return E},s.da=function(a){return[Math.pow(a[0],1/2.2),Math.pow(a[1],1/2.2),Math.pow(a[2],1/2.2)]},s.db=OE,s.dc=function(a,r){return a.readFields($7,{icons:[]},r)},s.dd=w1,s.de=Hm,s.df=xE,s.dg=Md,s.dh=Nb,s.di=wu,s.dj=Au,s.dk=Yn,s.dl=function(a){const r=a.indexOf(kf);return r>=0?a.slice(0,r):a},s.dm=function(a){return a.indexOf(kf)>=0},s.dn=function(a){const r=a.lastIndexOf(kf);return r>=0?a.slice(r+1):""},s.dp=function(a){const r=[],o=a.id;return o===void 0&&r.push({message:`layers.${o}: missing required property "id"`}),a.render===void 0&&r.push({message:`layers.${o}: missing required method "render"`}),a.renderingMode&&a.renderingMode!=="2d"&&a.renderingMode!=="3d"&&r.push({message:`layers.${o}: property "renderingMode" must be either "2d" or "3d"`}),r},s.dq=function(a,r,o,u){return a.type==="custom"?new L7(a,r):new N7[a.type](a,r,o,u)},s.dr=lr,s.ds=function(a){const r=a.indexOf(kf);return r>=0?a.slice(r+1):""},s.dt=class extends Jm{constructor(a,r){super(a._vectorTileFeature,a._z,a._x,a._y,a.id),a.state&&(this.state=Object.assign({},a.state)),this.target=r.target,this.namespace=r.namespace,r.properties&&(this.properties=r.properties),this.target&&("featuresetId"in this.target&&!this.target.importId||"layerId"in this.target)&&(this.source=a.source,this.sourceLayer=a.sourceLayer,this.layer=a.layer)}toJSON(){const a=super.toJSON();return a.target=this.target,a.namespace=this.namespace,a}},s.du=W_,s.dv=sr,s.dw=function(a){return a({pluginStatus:ws,pluginURL:Bc}),W_.on("pluginStateChange",a),a},s.dx=s1,s.dy=class extends Cl{constructor(a){super(a),this.current=PS}set(a,r,o){if(this.fetchUniformLocation(a,r)){for(let u=0;u<9;u++)if(o[u]!==this.current[u]){this.current=o,this.gl.uniformMatrix3fv(this.location,!1,o);break}}}},s.dz=ce,s.e=Ho,s.e$=function(){const a=Ty;a&&(a.isPreloaded()&&a.numActive()===1?(a.release(YS),Ty=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},s.e0=gn,s.e1=(a,r,o,u,h,g,_,b,T,E)=>{const A=a.transform,R=A.pitch<15?gk(.07,.7,be((14-A.zoom)/5,0,1)):.07,M=o.paint.get("line-trim-color-use-theme").constantOr("default")==="none";return{u_matrix:yk(a,r,o,u),u_texsize:r.imageAtlasTexture?r.imageAtlasTexture.size:[0,0],u_pixels_to_tile_units:A.calculatePixelsToTileUnitsMatrix(r),u_device_pixel_ratio:h,u_width_scale:g,u_floor_width_scale:_,u_image:0,u_tile_units_to_pixels:_k(r,A),u_units_to_pixels:[1/A.pixelsToGLUnits[0],1/A.pixelsToGLUnits[1]],u_alpha_discard_threshold:0,u_trim_offset:b,u_trim_fade_range:o.paint.get("line-trim-fade-range"),u_trim_color:o.paint.get("line-trim-color").toPremultipliedRenderColor(M?null:o.lut).toArray01(),u_emissive_strength:o.paint.get("line-emissive-strength"),u_zbias_factor:R,u_tile_to_meter:We(r.tileID.canonical,0),u_ground_shadow_factor:T,u_pattern_transition:E}},s.e2=(a,r,o,u,h,g,_,b,T,E)=>{const A=a.transform,R=A.calculatePixelsToTileUnitsMatrix(r),M=o.paint.get("line-trim-color-use-theme").constantOr("default")==="none",F=A.pitch<15?gk(.07,.7,be((14-A.zoom)/5,0,1)):.07;return{u_matrix:yk(a,r,o,u),u_pixels_to_tile_units:R,u_device_pixel_ratio:g,u_width_scale:_,u_floor_width_scale:b,u_units_to_pixels:[1/A.pixelsToGLUnits[0],1/A.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:h,u_texsize:bk(o)&&r.lineAtlasTexture?r.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:_k(r,a.transform),u_alpha_discard_threshold:0,u_trim_offset:T,u_trim_fade_range:o.paint.get("line-trim-fade-range"),u_trim_color:o.paint.get("line-trim-color").toPremultipliedRenderColor(M?null:o.lut).toArray01(),u_emissive_strength:o.paint.get("line-emissive-strength"),u_zbias_factor:F,u_tile_to_meter:We(r.tileID.canonical,0),u_ground_shadow_factor:E}},s.e3=on,s.e4=dy,s.e5=he,s.e6=o8,s.e7=b1,s.e8=RR,s.e9=dh,s.eA=Co,s.eB=oh,s.eC=function(a,r,o,u,h,g,_,b,T,E,A,R,M,F,B,W){var q=new P(16);return q[0]=a,q[1]=r,q[2]=o,q[3]=u,q[4]=h,q[5]=g,q[6]=_,q[7]=b,q[8]=T,q[9]=E,q[10]=A,q[11]=R,q[12]=M,q[13]=F,q[14]=B,q[15]=W,q},s.eD=U,s.eE=Df,s.eF=Im,s.eG=class{constructor(){this._updateTime=0,this._sourceIds=[],this._activeRegions=[],this._prevRegions=[],this._globalClipBounds={min:new xt(1/0,1/0),max:new xt(-1/0,-1/0)}}clear(){this._activeRegions.length>0&&++this._updateTime,this._activeRegions=[],this._prevRegions=[]}get updateTime(){return this._updateTime}getReplacementRegionsForTile(a,r=!1){const o=gR(new xt(0,0),new xt(zt,zt),a),u=[];if(r&&!GS(o,this._globalClipBounds))return u;for(const h of this._activeRegions){if(h.hiddenByOverlap||!GS(o,h))continue;const g=V8(h.min,h.max,a);u.push({min:g.min,max:g.max,sourceId:this._sourceIds[h.priority],footprint:h.footprint,footprintTileId:h.tileId,order:h.order,clipMask:h.clipMask,clipScope:h.clipScope})}return u}setSources(a){this._setSources(a.map((r=>({getSourceId:()=>r.cache.id,getFootprints:()=>{const o=[];for(const u of r.cache.getVisibleCoordinates()){const h=r.cache.getTile(u).buckets[r.layer];h&&h.updateFootprints(u.toUnwrapped(),o)}return o},getOrder:()=>r.order,getClipMask:()=>r.clipMask,getClipScope:()=>r.clipScope}))))}_addSource(a){const r=a.getFootprints();if(r.length===0)return;const o=a.getOrder(),u=a.getClipMask(),h=a.getClipScope();for(const g of r){if(!g.footprint)continue;const _=gR(g.footprint.min,g.footprint.max,g.id);this._activeRegions.push({min:_.min,max:_.max,hiddenByOverlap:!1,priority:this._sourceIds.length,tileId:g.id,footprint:g.footprint,order:o,clipMask:u,clipScope:h})}this._sourceIds.push(a.getSourceId())}_computeReplacement(){this._activeRegions.sort(((r,o)=>r.priority-o.priority||_1(r.min,o.min)||_1(r.max,o.max)||r.order-o.order||r.clipMask-o.clipMask||(function(u,h){const g=(_,b)=>_+b;return u.length-h.length||u.reduce(g,"").localeCompare(h.reduce(g,""))})(r.clipScope,o.clipScope)));let a=this._activeRegions.length!==this._prevRegions.length;if(!a){let r=0;for(;!a&&r!==this._activeRegions.length;){const o=this._activeRegions[r],u=this._prevRegions[r];a=o.priority!==u.priority||!mR(o,u)||o.order!==u.order||o.clipMask!==u.clipMask||!Da(o.clipScope,u.clipScope),++r}}if(a){++this._updateTime;for(const o of this._activeRegions)o.order!==_y&&(this._globalClipBounds.min.x=Math.min(this._globalClipBounds.min.x,o.min.x),this._globalClipBounds.min.y=Math.min(this._globalClipBounds.min.y,o.min.y),this._globalClipBounds.max.x=Math.max(this._globalClipBounds.max.x,o.max.x),this._globalClipBounds.max.y=Math.max(this._globalClipBounds.max.y,o.max.y));const r=o=>{const u=this._activeRegions;if(o>=u.length)return o;const h=u[o].priority;for(;o<u.length&&u[o].priority===h;)++o;return o};if(this._sourceIds.length>1){let o=0,u=r(o);for(;o!==u;){let h=o;const g=o;for(;h!==u;){const _=this._activeRegions[h];_.hiddenByOverlap=!1;for(let b=0;b<g;b++){const T=this._activeRegions[b];if(!T.hiddenByOverlap&&_.order===_y&&GS(_,T)&&(_.hiddenByOverlap=_R(_.footprint,_.tileId,T.footprint,T.tileId),_.hiddenByOverlap))break}++h}o=u,u=r(o)}}}}_setSources(a){[this._prevRegions,this._activeRegions]=[this._activeRegions,[]],this._sourceIds=[];for(let r=a.length-1;r>=0;r--)this._addSource(a[r]);this._computeReplacement()}},s.eH=_y,s.eI=class{constructor(a){this._createGrid(a),this._createPoles(a)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const a of this._poleSegments)a.destroy();for(const a of this._gridSegments)a.withSkirts.destroy(),a.withoutSkirts.destroy()}_fillGridMeshWithLods(a,r){const o=new Vc,u=new Mo,h=[],g=a+1+2,_=r[0]+1,b=r[0]+1+(1+r.length),T=(E,A,R)=>{let M=E===g-1?E-2:E===0?E:E-1;return M+=R?24575:0,[M,A]};for(let E=0;E<g;++E)o.emplaceBack(...T(E,0,!0));for(let E=0;E<_;++E)for(let A=0;A<g;++A)o.emplaceBack(...T(A,E,(A===0||A===g-1)&&!0));for(let E=0;E<r.length;++E){const A=r[E];for(let R=0;R<g;++R)o.emplaceBack(...T(R,A,!0))}for(let E=0;E<r.length;++E){const A=u.length,R=r[E]+1+2,M=new Mo;for(let W=0;W<R-1;W++){const q=W===R-2,K=q?g*(b-r.length+E-W):g;for(let ne=0;ne<g-1;ne++){const re=W*g+ne;W===0||q||ne===0||ne===g-2?(M.emplaceBack(re+1,re,re+K),M.emplaceBack(re+K,re+K+1,re+1)):(u.emplaceBack(re+1,re,re+K),u.emplaceBack(re+K,re+K+1,re+1))}}const F=Bi.simpleSegment(0,A,o.length,u.length-A);for(let W=0;W<M.uint16.length;W+=3)u.emplaceBack(M.uint16[W],M.uint16[W+1],M.uint16[W+2]);const B=Bi.simpleSegment(0,A,o.length,u.length-A);h.push({withoutSkirts:F,withSkirts:B})}return{vertices:o,indices:u,segments:h}}_createGrid(a){const r=this._fillGridMeshWithLods(S,I);this._gridSegments=r.segments,this._gridBuffer=a.createVertexBuffer(r.vertices,kP.members),this._gridIndexBuffer=a.createIndexBuffer(r.indices,!0)}_createPoles(a){const r=new Mo;for(let _=0;_<=S;_++)r.emplaceBack(0,_+1,_+2);this._poleIndexBuffer=a.createIndexBuffer(r,!0);const o=new Yu,u=new Yu,h=new Yu,g=new Yu;this._poleSegments=[];for(let _=0,b=0;_<y;_++){const T=360/(1<<_);o.emplaceBack(0,-p,0,.5,0),u.emplaceBack(0,-p,0,.5,1),h.emplaceBack(0,-p,0,.5,.5),g.emplaceBack(0,-p,0,.5,.5);for(let E=0;E<=S;E++){let A=E/S,R=0;const M=wn(0,T,A),[F,B,W]=N(u8,d8,M,p);o.emplaceBack(F,B,W,A,R),u.emplaceBack(F,B,W,A,1-R);const q=Fe(M);A=.5+.5*Math.sin(q),R=.5+.5*Math.cos(q),h.emplaceBack(F,B,W,A,R),g.emplaceBack(F,B,W,A,1-R)}this._poleSegments.push(Bi.simpleSegment(b,0,66,64)),b+=66}this._poleNorthVertexBuffer=a.createVertexBuffer(o,l1,!1),this._poleSouthVertexBuffer=a.createVertexBuffer(u,l1,!1),this._texturedPoleNorthVertexBuffer=a.createVertexBuffer(h,l1,!1),this._texturedPoleSouthVertexBuffer=a.createVertexBuffer(g,l1,!1)}getGridBuffers(a,r){return[this._gridBuffer,this._gridIndexBuffer,r?this._gridSegments[a].withSkirts:this._gridSegments[a].withoutSkirts]}getPoleBuffers(a,r){return[r?this._texturedPoleNorthVertexBuffer:this._poleNorthVertexBuffer,r?this._texturedPoleSouthVertexBuffer:this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[a]]}},s.eJ=fR,s.eK=Ie,s.eL=function(){return!!document.fullscreenElement||!!document.webkitFullscreenElement},s.eM=xe,s.eN=st,s.eO=function(a,r,o){return a[0]=r[0]/o[0],a[1]=r[1]/o[1],a[2]=r[2]/o[2],a},s.eP=qt,s.eQ=z,s.eR=uo,s.eS=bn,s.eT=function([a,r,o]){const u=Math.hypot(a,r,o),h=Math.atan2(a,o),g=.5*Math.PI-Math.acos(-r/u);return new H(Y(h),Y(g))},s.eU=cn,s.eV=oE,s.eW=function(a){const r=a.navigator?a.navigator.userAgent:null;return!!(function(o){if(di==null){const u=o.navigator?o.navigator.userAgent:null;di=!!o.safari||!(!u||!(/\b(iPad|iPhone|iPod)\b/.test(u)||u.match("Safari")&&!u.match("Chrome")))}return di})(a)&&!(!r||!(r.match("Version/15.4")||r.match("Version/15.5")||r.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/)))},s.eX=function(a,r){ys=a,Ds=r},s.eY=LS,s.eZ=BP,s.e_=function(a){const r=[0,0,0],o=de(new Float64Array(16));return Be(o,a.pixelMatrix,a.globeMatrix),vn(r,r,o),new xt(r[0],r[1])},s.ea=450,s.eb=7,s.ec=Le,s.ed=function(a,r){if(a===r){var o=r[1],u=r[2],h=r[3],g=r[6],_=r[7],b=r[11];a[1]=r[4],a[2]=r[8],a[3]=r[12],a[4]=o,a[6]=r[9],a[7]=r[13],a[8]=u,a[9]=g,a[11]=r[14],a[12]=h,a[13]=_,a[14]=b}else a[0]=r[0],a[1]=r[4],a[2]=r[8],a[3]=r[12],a[4]=r[1],a[5]=r[5],a[6]=r[9],a[7]=r[13],a[8]=r[2],a[9]=r[6],a[10]=r[10],a[11]=r[14],a[12]=r[3],a[13]=r[7],a[14]=r[11],a[15]=r[15];return a},s.ee=D7,s.ef=gr,s.eg=ah,s.eh=256,s.ei=MS,s.ej=Bs,s.ek=Mt,s.el=function(a,r){return a[0]=r[0],a[1]=r[1],a[2]=r[2],a[3]=r[4],a[4]=r[5],a[5]=r[6],a[6]=r[8],a[7]=r[9],a[8]=r[10],a},s.em=Yu,s.en=iy,s.eo=M_,s.ep=function(a,r,o,u,h){return be((a-r)/(o-r)*(h-u)+u,u,h)},s.eq=dr,s.er=function(a,r){var o=r[0],u=r[1],h=r[2],g=r[3],_=r[4],b=r[5],T=r[6],E=r[7],A=r[8],R=A*_-b*E,M=-A*g+b*T,F=E*g-_*T,B=o*R+u*M+h*F;return B?(a[0]=R*(B=1/B),a[1]=(-A*u+h*E)*B,a[2]=(b*u-h*_)*B,a[3]=M*B,a[4]=(A*o-h*T)*B,a[5]=(-b*o+h*g)*B,a[6]=F*B,a[7]=(-E*o+u*T)*B,a[8]=(_*o-u*g)*B,a):null},s.es=2,s.et=Gi,s.eu=sE,s.ev=[1,1,1],s.ew=Km,s.ex=Rn,s.ey=function(a,r,o,u){var h=r[0],g=r[1],_=r[2],b=r[3];return a[0]=h+u*(o[0]-h),a[1]=g+u*(o[1]-g),a[2]=_+u*(o[2]-_),a[3]=b+u*(o[3]-b),a},s.ez=Um,s.f=function(a){return btoa(encodeURIComponent(a).replace(/%([0-9A-F]{2})/g,((r,o)=>String.fromCharCode(+("0x"+o)))))},s.f0=function(){w1().acquire(YS)},s.f1=ym,s.f2=function(a,r,o=!1){if(ws===Xs.deferred||ws===Xs.loading||ws===Xs.loaded)throw new Error("setRTLTextPlugin cannot be called multiple times.");Bc=Ms.resolveURL(a),ws=Xs.deferred,G_=r,H_(),o||ju()},s.f3=function(a){Nm=Ms.resolveURL(a),Vm||(Vm=new Bm(w1(),new xl)),Vm.broadcast("setMeshoptUrl",Nm)},s.f4=jR,s.f5=function(a){QS=Ms.resolveURL(a),Vm||(Vm=new Bm(w1(),new xl)),Vm.broadcast("setDracoUrl",QS)},s.f6=UR,s.f7=wy,s.f8=function(a){const r=mf();if(!r)return;const o=r.delete(li);a&&o.then((()=>a())).catch(a)},s.f9=Hf,s.fA=function(a){Tu(),ts?.then((r=>{r.keys().then((o=>{for(let u=0;u<o.length-a;u++)r.delete(o[u]).catch((h=>cr(h.message)))})).catch((o=>cr(o.message)))})).catch((r=>cr(r.message)))},s.fa=Wt,s.fb=uh,s.fc=oc,s.fd=pO,s.fe=mO,s.ff=hk,s.fg=qn,s.fh="hd_road_elevation",s.fi=ki,s.fj=zn,s.fk=td,s.fl=bE,s.fm=Kf,s.fn=function(a,r,o,u,h,g,_,b=1,T,E,A){a.createArrays(),a.tilePixelRatio=zt/(512*a.overscaling),a.compareText={},a.iconsNeedLinear=!1;const R=a.layers[0].layout,M=a.layers[0]._unevaluatedLayout._values,F={};F.scaleFactor=b,F.textSizeScaleRange=R.get("text-size-scale-range"),F.iconSizeScaleRange=R.get("icon-size-scale-range");const[B,W]=F.textSizeScaleRange,[q,K]=F.iconSizeScaleRange;F.textScaleFactor=be(F.scaleFactor,B,W),F.iconScaleFactor=be(F.scaleFactor,q,K);const ne=M["text-size"],re=M["icon-size"];if(a.textSizeData.kind==="composite"){const{minZoom:De,maxZoom:ut}=a.textSizeData;F.compositeTextSizes=[ne.possiblyEvaluate(new pi(De,{worldview:A}),g),ne.possiblyEvaluate(new pi(ut,{worldview:A}),g)]}if(a.iconSizeData.kind==="composite"){const{minZoom:De,maxZoom:ut}=a.iconSizeData;F.compositeIconSizes=[re.possiblyEvaluate(new pi(De,{worldview:A}),g),re.possiblyEvaluate(new pi(ut,{worldview:A}),g)]}F.layoutTextSize=ne.possiblyEvaluate(new pi(_+1,{worldview:A}),g),F.layoutIconSize=re.possiblyEvaluate(new pi(_+1,{worldview:A}),g),F.textMaxSize=ne.possiblyEvaluate(new pi(18,{worldview:A}),g);const oe=R.get("symbol-placement"),ye=R.get("text-rotation-alignment")==="map"&&oe!=="point",ve=R.get("text-size");let Ce=!1;const Oe=[];for(const De of a.features){const ut=R.get("text-font").evaluate(De,{},g).join(","),Ue=ve.evaluate(De,{},g)*F.textScaleFactor,ht=F.layoutTextSize.evaluate(De,{},g)*F.textScaleFactor,wt=F.layoutIconSize.evaluate(De,{},g)*F.iconScaleFactor,mt={horizontal:{},vertical:void 0},yt=De.text;let Et,lt=[0,0];if(yt){const tn=yt.toString(),An=R.get("text-letter-spacing").evaluate(De,{},g)*Zo,Nn=R.get("text-line-height").evaluate(De,{},g)*Zo,er=Fb(tn)?An:0,Un=R.get("text-anchor").evaluate(De,{},g),Xt=R.get("text-variable-anchor");if(!Xt){const et=R.get("text-radial-offset").evaluate(De,{},g);if(et)lt=Yk(Un,[et*Zo,wE]);else{const ct=R.get("text-offset").evaluate(De,{},g);lt=[ct[0]*Zo,ct[1]*Zo]}}let Vn=ye?"center":R.get("text-justify").evaluate(De,{},g);const br=oe==="point",ae=br?R.get("text-max-width").evaluate(De,{},g)*Zo:1/0,le=et=>{a.allowVerticalPlacement&&j_(tn)&&(mt.vertical=_E(yt,r,o,h,ut,ae,Nn,Un,et,er,lt,wa.vertical,!0,ht,Ue,T))};if(!ye&&Xt){const et=Vn==="auto"?Xt.map((Nt=>TE(Nt))):[Vn];let ct=!1;for(let Nt=0;Nt<et.length;Nt++){const Bt=et[Nt];if(!mt.horizontal[Bt])if(ct)mt.horizontal[Bt]=mt.horizontal[0];else{const Kt=_E(yt,r,o,h,ut,ae,Nn,"center",Bt,er,lt,wa.horizontal,!1,ht,Ue,T);Kt&&(mt.horizontal[Bt]=Kt,ct=Kt.positionedLines.length===1)}}le("left")}else{if(Vn==="auto"&&(Vn=TE(Un)),br||R.get("text-writing-mode").indexOf("horizontal")>=0||!j_(tn)){const et=_E(yt,r,o,h,ut,ae,Nn,Un,Vn,er,lt,wa.horizontal,!1,ht,Ue,T);et&&(mt.horizontal[Vn]=et)}le(br?"left":Vn)}}let vt,rt,Xe,Ct,Tt,hn,Ht=!1;const Jt=R.get("icon-text-fit").evaluate(De,{},g);if(De.icon&&De.icon.hasPrimary()){const tn=Qk(De.icon,a.iconSizeData,M["icon-size"],g,a.zoom,De,T,F.iconScaleFactor,A);vt=tn.iconPrimary,Xe=tn.iconSecondary;const An=vt.toString();if(rt=u.get(An),rt&&(Tt=R.get("icon-offset").evaluate(De,{},g),hn=R.get("icon-anchor").evaluate(De,{},g),Et=u7(h.get(An),Xe?h.get(Xe.toString()):void 0,Tt,hn),Ht=rt.sdf,a.sdfIcons===void 0?a.sdfIcons=rt.sdf:a.sdfIcons!==rt.sdf&&cr("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(rt.pixelRatio!==a.pixelRatio||R.get("icon-rotate").constantOr(1)!==0)&&(a.iconsNeedLinear=!0)),Xe){const Nn=Xe.toString();Ct=u.get(Nn)}}Ce=Ce||!(!De.icon||!De.icon.hasSecondary());const Dt=SE(mt.horizontal)||mt.vertical;a.iconsInText||(a.iconsInText=!!Dt&&Dt.iconsInText);const dn=ht*F.textScaleFactor/Zo,{defaultShapedIcon:Fn,verticallyShapedIcon:Vt}=b7(a,Et,R,De,g,mt,dn,Tt,Jt);Jt!=="none"&&Et&&(Lk(Et)||zk(Et))&&(D1(0,rt,vt,Et,Fn,Jt,E,u,h),D1(0,Ct,Xe,Et,Fn,Jt,E,u,h),Vt&&(D1(0,rt,vt,Et,Vt,Jt,E,u,h),D1(0,Ct,Xe,Et,Vt,Jt,E,u,h))),Et=Fn,Oe.push({feature:De,shapedTextOrientations:mt,shapedText:Dt,shapedIcon:Et,iconPrimary:vt,iconSecondary:Xe,iconOffset:Tt,iconAnchor:hn,verticallyShapedIcon:Vt,layoutTextSize:ht,layoutIconSize:wt,textOffset:lt,isSDFIcon:Ht,iconTextFit:Jt})}return{featureData:Oe,sizes:F,hasAnySecondaryIcon:Ce,textAlongLine:ye,symbolPlacement:oe}},s.fo=Hk,s.fp=function(a,r,o,u,h,g,_,b,T,E){const{featureData:A,hasAnySecondaryIcon:R,sizes:M,textAlongLine:F,symbolPlacement:B}=r;for(const W of A){const{shapedIcon:q,verticallyShapedIcon:K,feature:ne,shapedTextOrientations:re,shapedText:oe,layoutTextSize:ye,textOffset:ve,isSDFIcon:Ce,iconPrimary:Oe,iconSecondary:De,iconTextFit:ut,iconOffset:Ue}=W;e3(q,E.iconPositions,Oe,De),e3(K,E.iconPositions,Oe,De),v7(re,E.iconPositions),y7(Oe,De,E.iconPositions),(oe||q)&&x7(a,ne,re,q,K,T,M,ye,0,ve,Ce,u,h,_,b,R,ut,Ue,F,B)}o&&a.generateCollisionDebugBuffers(g,a.collisionBoxArray,M.textScaleFactor)},s.fq=Ln,s.fr=ex,s.fs=bt,s.ft=function(a){let r=0;if(new Uint32Array(a,0,1)[0]!==HR){const o=new Uint32Array(a,0,7),[,,u,h,g,_]=o;r=o.byteLength+h+g+_+g,(u!==a.byteLength||r>=a.byteLength)&&cr("Invalid b3dm header information.")}return ZR(a,r)},s.fu=function(a,r){const o=rk(a);for(const u of o){for(const h of u.meshes)_$(h);u.lights&&(u.lightMeshIndex=u.meshes.length,u.meshes.push(y$(u.lights,r)))}return o},s.fv=K1,s.fw=Zr,s.fx=VR,s.fy=El,s.fz=Xs,s.g=function(a,r){return sr(Object.assign(a,{method:"GET"}),r)},s.h=function(a){return a.indexOf("mapbox:")===0},s.i=function(a){return Ho.API_STYLE_REGEX.test(a)&&!pf(a)},s.j=Hl,s.k=Su,s.l=function(a){return decodeURIComponent(atob(a).split("").map((r=>"%"+("00"+r.charCodeAt(0).toString(16)).slice(-2))).join(""))},s.m=function(a,r){return sr(Object.assign(a,{type:"json"}),r)},s.n=La,s.o=Ms,s.p=function(a,r){return sr(Object.assign(a,{method:"POST"}),r)},s.q=rs,s.r=pa,s.s=function(a){try{const r=self[a];return r.setItem("_mapbox_test_",1),r.removeItem("_mapbox_test_"),!0}catch{return!1}},s.t=function(){return JS||(JS=new Hf),JS},s.u=function(){return(function a(r){return r?(r^Math.random()*(16>>r/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,a)})()},s.v=function(a){return!!a&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(a)},s.w=cr,s.x=NE,s.y=bl,s.z=qs})),f(["./shared"],(function(s){function C(Fe){const Y=Fe?Fe.url.toString():void 0;return Y?performance.getEntriesByName(Y):[]}function P(Fe){if(typeof Fe=="number"||typeof Fe=="boolean"||typeof Fe=="string"||Fe==null)return JSON.stringify(Fe);if(Array.isArray(Fe)){let Q="[";for(const ce of Fe)Q+=`${P(ce)},`;return`${Q}]`}let Y="{";for(const Q of Object.keys(Fe).sort())Y+=`${Q}:${P(Fe[Q])},`;return`${Y}}`}function L(Fe){let Y="";for(const Q of s.bx)Y+=`/${P(Fe[Q])}`;return Y}class ${constructor(Y){this.keyCache={},this._layers={},this._layerConfigs={},Y&&this.replace(Y)}replace(Y,Q){this._layerConfigs={},this._layers={},this.update(Y,[],Q)}update(Y,Q,ce){this._options=ce;for(const xe of Y)this._layerConfigs[xe.id]=xe,(this._layers[xe.id]=s.dq(xe,this.scope,null,this._options)).compileFilter(ce),this.keyCache[xe.id]&&delete this.keyCache[xe.id];for(const xe of Q)delete this.keyCache[xe],delete this._layerConfigs[xe],delete this._layers[xe];this.familiesBySource={};const Ie=(function(xe,be){const tt={};for(let nt=0;nt<xe.length;nt++){const Rt=xe[nt];let gt=be&&be[Rt.id];gt||(Rt.type==="symbol"?gt=Rt.id:(gt=L(Rt),Rt.type==="line"&&Rt.paint&&(function xn(zn){return typeof zn=="string"&&zn==="line-progress"||(Array.isArray(zn)?zn.some(xn):!(!zn||typeof zn!="object")&&Object.values(zn).some(xn))})(Rt.paint["line-width"])&&(gt+=`/${P(Rt.paint["line-width"])}`))),be&&(be[Rt.id]=gt);let on=tt[gt];on||(on=tt[gt]=[]),on.push(Rt)}const ze=[];for(const nt in tt)ze.push(tt[nt]);return ze})(Object.values(this._layerConfigs),this.keyCache);for(const xe of Ie){const be=xe.map((on=>this._layers[on.id])),tt=be[0];if(tt.visibility==="none")continue;const ze=tt.source||"";let nt=this.familiesBySource[ze];nt||(nt=this.familiesBySource[ze]={});const Rt=tt.sourceLayer||"_geojsonTileLayer";let gt=nt[Rt];gt||(gt=nt[Rt]=[]),gt.push(be)}}}const V=1*s.fc;class j{constructor(Y){const Q={},ce=[];for(const tt in Y){const ze=Y[tt],nt=Q[tt]={};for(const Rt in ze.glyphs){const gt=ze.glyphs[+Rt];if(!gt||gt.bitmap.width===0||gt.bitmap.height===0)continue;const on=gt.metrics.localGlyph?V:1,xn={x:0,y:0,w:gt.bitmap.width+2*on,h:gt.bitmap.height+2*on};ce.push(xn),nt[Rt]=xn}}const{w:Ie,h:xe}=s.G(ce),be=new s.fb({width:Ie||1,height:xe||1});for(const tt in Y){const ze=Y[tt];for(const nt in ze.glyphs){const Rt=ze.glyphs[+nt];if(!Rt||Rt.bitmap.width===0||Rt.bitmap.height===0)continue;const gt=Q[tt][nt],on=Rt.metrics.localGlyph?V:1;s.fb.copy(Rt.bitmap,be,{x:0,y:0},{x:gt.x+on,y:gt.y+on},Rt.bitmap)}}this.image=be,this.positions=Q}}s.fa(j,"GlyphAtlas");class ue{constructor(Y){this.tileID=new s.aO(Y.tileID.overscaledZ,Y.tileID.wrap,Y.tileID.canonical.z,Y.tileID.canonical.x,Y.tileID.canonical.y),this.tileZoom=Y.tileZoom,this.uid=Y.uid,this.zoom=Y.zoom,this.lut=Y.lut,this.canonical=Y.tileID.canonical,this.pixelRatio=Y.pixelRatio,this.tileSize=Y.tileSize,this.source=Y.source,this.scope=Y.scope,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=Y.showCollisionBoxes,this.collectResourceTiming=!!Y.request&&Y.request.collectResourceTiming,this.promoteId=Y.promoteId,this.isSymbolTile=Y.isSymbolTile,this.tileTransform=s.aZ(Y.tileID.canonical,Y.projection),this.projection=Y.projection,this.worldview=Y.worldview,this.localizableLayerIds=Y.localizableLayerIds,this.brightness=Y.brightness,this.extraShadowCaster=!!Y.extraShadowCaster,this.tessellationStep=Y.tessellationStep,this.scaleFactor=Y.scaleFactor,this.worldview=Y.worldview}parse(Y,Q,ce,Ie,xe,be){this.status="parsing",this.data=Y,this.collisionBoxArray=new s.b3;const tt=new s.fd(Object.keys(Y.layers).sort()),ze=new s.fe(this.tileID,this.promoteId);ze.bucketLayerIDs=[];const nt={},Rt=new s.ff(256,256),gt={featureIndex:ze,iconDependencies:new Map,patternDependencies:new Map,glyphDependencies:{},lineAtlas:Rt,availableImages:ce,brightness:this.brightness,scaleFactor:this.scaleFactor,elevationFeatures:void 0},on=[],xn=Q.familiesBySource[this.source];for(const lr in xn){const Yn=Y.layers[lr];if(!Yn)continue;let fr=!1,ti=!1,cr=!1;for(const Zr of xn[lr])Zr[0].type==="symbol"?fr=!0:ti=!0,Zr[0].is3D()&&Zr[0].type!=="model"&&(cr=!0);if(this.extraShadowCaster&&!cr||this.isSymbolTile===!0&&!fr||this.isSymbolTile===!1&&!ti)continue;Yn.version===1&&s.w(`Vector tile source "${this.source}" layer "${lr}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const Hi=tt.encode(lr),to=[];let fo=!1;for(let Zr=0,Sr=0;Zr<Yn.length;Zr++){const di=Yn.feature(Zr),Ri=ze.getId(di,lr);if(this.localizableLayerIds&&this.localizableLayerIds.has(lr)){const hi=di.properties?di.properties.worldview:null;if(this.worldview&&typeof hi=="string")if(hi==="all")di.properties.$localized=!0;else{if(!hi.split(",").includes(this.worldview))continue;di.properties.$localized=!0,di.properties.worldview=this.worldview}}!fo&&di.properties&&di.properties.hasOwnProperty(s.fg)&&(fo=!0),to.push({feature:di,id:Ri,index:Sr,sourceLayerIndex:Hi}),Sr++}fo&&!gt.elevationFeatures&&Y.layers.hasOwnProperty(s.fh)&&(gt.elevationFeatures=s.fi.parseFrom(Y.layers[s.fh],this.canonical));for(const Zr of xn[lr]){const Sr=Zr[0];if(this.extraShadowCaster&&(!Sr.is3D()||Sr.type==="model")||this.isSymbolTile!==void 0&&Sr.type==="symbol"!==this.isSymbolTile||Sr.minzoom&&this.zoom<Math.floor(Sr.minzoom)||Sr.maxzoom&&this.zoom>=Sr.maxzoom||Sr.visibility==="none")continue;de(Zr,this.zoom,gt.brightness,ce,this.worldview);const di=nt[Sr.id]=Sr.createBucket({index:ze.bucketLayerIDs.length,layers:Zr,zoom:this.zoom,lut:this.lut,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Hi,sourceID:this.source,projection:this.projection.spec,tessellationStep:this.tessellationStep,styleDefinedModelURLs:Ie,worldview:this.worldview});ze.bucketLayerIDs.push(Zr.map((hi=>s.B(hi.id,hi.scope))));let Ri=di.prepare?di.prepare():null;Ri!=null?(Ri=Ri.then((()=>di.populate(to,gt,this.tileID.canonical,this.tileTransform))),on.push(Ri)):di.populate(to,gt,this.tileID.canonical,this.tileTransform)}}const zn=()=>{let lr,Yn,fr,ti,cr,Hi;Rt.trim();const to={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},fo=()=>{if(lr)return this.status="done",be(lr);if(this.extraShadowCaster)this.status="done",be(null,{buckets:Object.values(nt).filter((Sr=>!Sr.isEmpty())),featureIndex:ze,collisionBoxArray:null,glyphAtlasImage:null,lineAtlas:null,imageAtlas:null,brightness:gt.brightness,glyphMap:null,iconMap:null,glyphPositions:null});else if(Yn&&fr&&ti){const Sr=new j(Yn),di=new Map;for(const[Bo,Xo]of fr.entries()){const{imagePosition:_s}=s.fl(Bo,Xo,s.fm);di.set(Bo,_s)}const Ri={};for(const Bo in nt){const Xo=nt[Bo];Xo instanceof s.b4&&(de(Xo.layers,this.zoom,gt.brightness,ce,this.worldview),Ri[Bo]=s.fn(Xo,Yn,Sr.positions,fr,di,this.tileID.canonical,this.tileZoom,this.scaleFactor,this.pixelRatio,cr,this.worldview))}const hi={iconsPending:!0,patternsPending:!0};this.rasterizeIfNeeded(xe,fr,cr,(()=>{hi.iconsPending=!1,Zr(Ri,Sr,hi)})),this.rasterizeIfNeeded(xe,ti,Hi,(()=>{hi.patternsPending=!1,Zr(Ri,Sr,hi)}))}},Zr=(Sr,di,Ri,hi)=>{if(Ri.iconsPending||Ri.patternsPending)return;const Bo=new s.fo(fr,ti,this.lut);for(const Xo in nt){const _s=nt[Xo];if(Xo in Sr)s.fp(_s,Sr[Xo],this.showCollisionBoxes,ce,this.tileID.canonical,this.tileZoom,this.projection,this.brightness,fr,Bo);else if(_s.hasPattern&&(_s instanceof s.ba||_s instanceof s.bb||_s instanceof s.e7)){de(_s.layers,this.zoom,gt.brightness,ce,this.worldview);const ha=Object.fromEntries(Bo.patternPositions);_s.addFeatures(gt,this.tileID.canonical,ha,ce,this.tileTransform,this.brightness)}}this.status="done",be(null,{buckets:Object.values(nt).filter((Xo=>!Xo.isEmpty())),featureIndex:ze,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:di.image,lineAtlas:Rt,imageAtlas:Bo,brightness:gt.brightness})};if(!this.extraShadowCaster){const Sr=s.fj(gt.glyphDependencies,(hi=>Object.keys(hi).map(Number)));Object.keys(Sr).length?xe.send("getGlyphs",{uid:this.uid,stacks:Sr},((hi,Bo)=>{lr||(lr=hi,Yn=Bo,fo())}),void 0,!1,to):Yn={};const di=Array.from(gt.iconDependencies.keys()).map((hi=>s.I.parse(hi)));di.length?xe.send("getImages",{images:di,source:this.source,scope:this.scope,tileID:this.tileID,type:"icons"},((hi,Bo)=>{lr||(lr=hi,fr=new Map,cr=this.updateImageMapAndGetImageTaskQueue(fr,Bo,gt.iconDependencies),fo())}),void 0,!1,to):(fr=new Map,cr=new Map);const Ri=Array.from(gt.patternDependencies.keys()).map((hi=>s.I.parse(hi)));Ri.length?xe.send("getImages",{images:Ri,source:this.source,scope:this.scope,tileID:this.tileID,type:"patterns"},((hi,Bo)=>{lr||(lr=hi,ti=new Map,Hi=this.updateImageMapAndGetImageTaskQueue(ti,Bo,gt.patternDependencies),fo())}),void 0,!1,to):(ti=new Map,Hi=new Map)}if(gt.elevationFeatures&&gt.elevationFeatures.length>0){const Sr=[];for(const Ri of Object.values(nt))if(Ri instanceof s.bb){const hi=Ri.getUnevaluatedPortalGraph();hi&&Sr.push(hi)}const di=s.fk.evaluate(Sr);for(const Ri of Object.values(nt))if(Ri instanceof s.bb){const hi=Y.layers[tt.decode(Ri.sourceLayerIndex)];Ri.setEvaluatedPortalGraph(di,hi,this.tileID.canonical,gt.availableImages,gt.brightness)}}fo()};on.length>0?Promise.allSettled(on).then(zn).catch(be):zn()}rasterizeIfNeeded(Y,Q,ce,Ie){Array.from(Q.values()).some((xe=>xe.usvg))?this.rasterize(Y,Q,ce,Ie):Ie()}updateImageMapAndGetImageTaskQueue(Y,Q,ce){const Ie=new Map;for(const xe of Q.keys()){const be=ce.get(xe)||[];for(const tt of be){const ze=tt.toString(),nt=Q.get(tt.id.toString());nt.usvg?Ie.has(ze)||(Ie.set(ze,tt),Y.set(ze,Object.assign({},nt))):Y.set(ze,nt)}}return Ie}rasterize(Y,Q,ce,Ie){this.rasterizeTask=Y.send("rasterizeImages",{scope:this.scope,tasks:ce},((xe,be)=>{if(!xe)for(const[tt,ze]of be.entries()){const nt=Object.assign(Q.get(tt),{data:ze});Q.set(tt,nt)}Ie()}))}cancelRasterize(){this.rasterizeTask&&this.rasterizeTask.cancel()}}function de(Fe,Y,Q,ce,Ie){const xe=new s.ac(Y,{brightness:Q,worldview:Ie});for(const be of Fe)be.recalculate(xe,ce)}class Te extends s.E{constructor(Y,Q,ce,Ie,xe,be,tt){super(),this.actor=Y,this.layerIndex=Q,this.availableImages=ce,this.availableModels=Ie,this.loadVectorData=be||s.aL,this.loading={},this.loaded={},this.deduped=new s.aK(Y.scheduler),this.isSpriteLoaded=xe,this.scheduler=Y.scheduler,this.brightness=tt}loadTile(Y,Q){const ce=Y.uid,Ie=Y&&Y.request,xe=Ie&&Ie.collectResourceTiming,be=this.loading[ce]=new ue(Y);be.abort=this.loadVectorData(Y,((tt,ze)=>{const nt=!this.loading[ce];if(delete this.loading[ce],be.cancelRasterize(),nt||tt||!ze)return be.status="done",nt||(this.loaded[ce]=be),Q(tt);const Rt=ze.rawData,gt={};ze.expires&&(gt.expires=ze.expires),ze.cacheControl&&(gt.cacheControl=ze.cacheControl),be.vectorTile=ze.vectorTile||new s.fq(new s.bt(Rt));const on=()=>{be.parse(be.vectorTile,this.layerIndex,this.availableImages,this.availableModels,this.actor,((xn,zn)=>{if(xn||!zn)return Q(xn);const lr={};if(xe){const Yn=C(Ie);Yn.length>0&&(lr.resourceTiming=JSON.parse(JSON.stringify(Yn)))}Q(null,Object.assign({rawTileData:Rt.slice(0)},zn,gt,lr))}))};this.isSpriteLoaded?on():this.once("isSpriteLoaded",(()=>{this.scheduler?this.scheduler.add(on,{type:"parseTile",isSymbolTile:Y.isSymbolTile,zoom:Y.tileZoom}):on()})),this.loaded=this.loaded||{},this.loaded[ce]=be}))}reloadTile(Y,Q){const ce=this.loaded,Ie=Y.uid;if(ce&&ce[Ie]){const xe=ce[Ie];xe.scaleFactor=Y.scaleFactor,xe.showCollisionBoxes=Y.showCollisionBoxes,xe.projection=Y.projection,xe.brightness=Y.brightness,xe.tileTransform=s.aZ(Y.tileID.canonical,Y.projection),xe.extraShadowCaster=Y.extraShadowCaster,xe.lut=Y.lut,xe.worldview=Y.worldview;const be=(tt,ze)=>{const nt=xe.reloadCallback;nt&&(delete xe.reloadCallback,xe.parse(xe.vectorTile,this.layerIndex,this.availableImages,this.availableModels,this.actor,nt)),Q(tt,ze)};xe.status==="parsing"?xe.reloadCallback=be:xe.status==="done"&&(xe.vectorTile?xe.parse(xe.vectorTile,this.layerIndex,this.availableImages,this.availableModels,this.actor,be):be())}else Q(null,void 0)}abortTile(Y,Q){const ce=Y.uid,Ie=this.loading[ce];Ie&&(Ie.abort&&Ie.abort(),delete this.loading[ce]),Q()}removeTile(Y,Q){const ce=this.loaded,Ie=Y.uid;ce&&ce[Ie]&&delete ce[Ie],Q()}}class Be{loadTile(Y,Q){const{uid:ce,encoding:Ie,rawImageData:xe,padding:be}=Y,tt=ImageBitmap&&xe instanceof ImageBitmap?this.getImageData(xe,be):xe;Q(null,new s.fr(ce,tt,Ie,be<1))}reloadTile(Y,Q){Q(null,null)}abortTile(Y,Q){Q()}removeTile(Y,Q){Q()}getImageData(Y,Q){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(Y.width,Y.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=Y.width,this.offscreenCanvas.height=Y.height,this.offscreenCanvasContext.drawImage(Y,0,0,Y.width,Y.height);const ce=this.offscreenCanvasContext.getImageData(-Q,-Q,Y.width+2*Q,Y.height+2*Q);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),ce}}s.bs.setPbf(s.bt);class Ge{constructor(Y){this._mrt=new s.bs(Y.partial?30:1/0),this._isHeaderLoaded=!1,this.uid=Y.uid,this.tileID=Y.tileID,this.source=Y.source}parse(Y,Q){const ce=this._mrt;this.status="parsing",this._entireBuffer=Y;try{ce.parseHeader(Y),this._isHeaderLoaded=!0;const Ie=[];for(const xe in ce.layers){const be=ce.getLayer(xe),tt=be.getDataRange(be.getBandList()),ze=ce.createDecodingTask(tt),nt=Y.slice(tt.firstByte,tt.lastByte+1),Rt=s.bs.performDecoding(nt,ze).then((gt=>ze.complete(null,gt))).catch((gt=>ze.complete(gt,null)));Ie.push(Rt)}Promise.allSettled(Ie).then((()=>Q(null,ce))).catch((xe=>Q(xe)))}catch(Ie){Q(Ie)}}}class Ye{constructor(Y){this.actor=Y,this.loading={},this.loaded={}}loadTile(Y,Q){const ce=Y.uid,Ie=Y.request,xe=this.loading[ce]=new Ge(Y),{cancel:be}=s.bu(Ie,((tt,ze,nt,Rt)=>{const gt=!this.loading[ce];if(delete this.loading[ce],gt||tt||!ze)return xe.status="done",gt||(this.loaded[ce]=xe),Q(tt);xe.parse(ze,((on,xn)=>{if(on||!xn)return Q(on);Q(null,xn,nt,Rt)})),this.loaded[ce]=xe}));xe.abort=be}reloadTile(Y,Q){Q(null,void 0)}abortTile(Y,Q){const ce=Y.uid,Ie=this.loading[ce];Ie&&(Ie.abort&&Ie.abort(),delete this.loading[ce]),Q()}removeTile(Y,Q){const ce=Y.uid;this.loaded[ce]&&delete this.loaded[ce],Q()}decodeRasterArray(Y,Q){s.bs.performDecoding(Y.buffer,Y.task).then((ce=>Q(null,ce))).catch((ce=>Q(ce)))}}const Ne=s.fs.prototype.toGeoJSON;class Mt{constructor(Y){this._feature=Y,this.extent=s.al,this.type=Y.type,this.properties=Y.tags,"id"in Y&&!isNaN(Y.id)&&(this.id=parseInt(Y.id,10))}loadGeometry(){if(this._feature.type===1){const Y=[];for(const Q of this._feature.geometry)Y.push([new s.P(Q[0],Q[1])]);return Y}{const Y=[];for(const Q of this._feature.geometry){const ce=[];for(const Ie of Q)ce.push(new s.P(Ie[0],Ie[1]));Y.push(ce)}return Y}}toGeoJSON(Y,Q,ce){return Ne.call(this,Y,Q,ce)}}class kt{constructor(Y,Q){this.name=Y,this.extent=s.al,this.length=Q.length,this._jsonFeatures=Q}feature(Y){return new Mt(this._jsonFeatures[Y])}}class Pe{constructor(Y){this.layers={},this.extent=s.al;for(const Q of Object.keys(Y))this.layers[Q]=new kt(Q,Y[Q])}}const we=64/4096,Se=128;class je{constructor(){this.features=new Map}clear(){this.features.clear()}load(Y=[],Q){for(const ce of Y){const Ie=ce.id;if(Ie==null)continue;let xe=this.features.get(Ie);xe&&this.updateCache(xe,Q),ce.geometry?(xe=Ve(ce),this.updateCache(xe,Q),this.features.set(Ie,xe)):this.features.delete(Ie),this.updateCache(xe,Q)}}updateCache(Y,Q){for(const{canonical:ce,uid:Ie}of Object.values(Q)){const{z:xe,x:be,y:tt}=ce;Re(Y,Math.pow(2,xe),be,tt)&&delete Q[Ie]}}getTile(Y,Q,ce){const Ie=Math.pow(2,Y),xe=[];for(const be of this.features.values())Re(be,Ie,Q,ce)&&xe.push(mn(be,Ie,Q,ce));return{features:xe}}getFeatures(){return[...this.features.values()]}}function Re({minX:Fe,minY:Y,maxX:Q,maxY:ce},Ie,xe,be){return Fe<(xe+1+we)/Ie&&Y<(be+1+we)/Ie&&Q>(xe-we)/Ie&&ce>(be-we)/Ie}function Ve(Fe){const{id:Y,geometry:Q,properties:ce}=Fe;if(!Q)return;if(Q.type==="GeometryCollection")throw new Error("GeometryCollection not supported in dynamic mode.");const{type:Ie,coordinates:xe}=Q,be={id:Y,type:1,geometry:[],tags:ce,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0},tt=be.geometry;if(Ie==="Point")ke(xe,tt,be);else if(Ie==="MultiPoint")for(const ze of xe)ke(ze,tt,be);else if(Ie==="LineString")be.type=2,Mn(xe,tt,be);else if(Ie==="MultiLineString")be.type=2,bn(xe,tt,be);else if(Ie==="Polygon")be.type=3,bn(xe,tt,be,!0);else{if(Ie!=="MultiPolygon")throw new Error("Input data is not a valid GeoJSON object.");be.type=3;for(const ze of xe)bn(ze,tt,be,!0)}return be}function ke([Fe,Y],Q,ce){const Ie=s.aF(Fe);let xe=s.aJ(Y);xe=xe<0?0:xe>1?1:xe,Q.push(Ie,xe),ce.minX=Math.min(ce.minX,Ie),ce.minY=Math.min(ce.minY,xe),ce.maxX=Math.max(ce.maxX,Ie),ce.maxY=Math.max(ce.maxY,xe)}function Mn(Fe,Y,Q,ce=!1,Ie=!1){const xe=[];for(const be of Fe)ke(be,xe,Q);Y.push(xe),ce&&(function(be,tt){let ze=0;for(let nt=0,Rt=be.length,gt=Rt-2;nt<Rt;gt=nt,nt+=2)ze+=(be[nt]-be[gt])*(be[nt+1]+be[gt+1]);if(ze>0===tt)for(let nt=0,Rt=be.length;nt<Rt/2;nt+=2){const gt=be[nt],on=be[nt+1];be[nt]=be[Rt-2-nt],be[nt+1]=be[Rt-1-nt],be[Rt-2-nt]=gt,be[Rt-1-nt]=on}})(xe,Ie)}function bn(Fe,Y,Q,ce=!1){for(let Ie=0;Ie<Fe.length;Ie++)Mn(Fe[Ie],Y,Q,ce,Ie===0)}function mn(Fe,Y,Q,ce){const{id:Ie,type:xe,geometry:be,tags:tt}=Fe,ze=[];if(xe===1)(function(nt,Rt,gt,on,xn){for(let zn=0;zn<nt.length;zn+=2){const lr=Math.round(s.al*(nt[zn+0]*Rt-gt)),Yn=Math.round(s.al*(nt[zn+1]*Rt-on));xn.push([lr,Yn])}})(be,Y,Q,ce,ze);else for(const nt of be)Sn(nt,Y,Q,ce,ze);return{id:Ie,type:xe,geometry:ze,tags:tt}}function Sn(Fe,Y,Q,ce,Ie){const xe=-Se,be=s.al+Se;let tt;for(let ze=0;ze<Fe.length-2;ze+=2){let nt=Math.round(s.al*(Fe[ze+0]*Y-Q)),Rt=Math.round(s.al*(Fe[ze+1]*Y-ce)),gt=Math.round(s.al*(Fe[ze+2]*Y-Q)),on=Math.round(s.al*(Fe[ze+3]*Y-ce));const xn=gt-nt,zn=on-Rt;nt<xe&&gt<xe||(nt<xe?(Rt+=Math.round(zn*((xe-nt)/xn)),nt=xe):gt<xe&&(on=Rt+Math.round(zn*((xe-nt)/xn)),gt=xe),Rt<xe&&on<xe||(Rt<xe?(nt+=Math.round(xn*((xe-Rt)/zn)),Rt=xe):on<xe&&(gt=nt+Math.round(xn*((xe-Rt)/zn)),on=xe),nt>=be&&gt>=be||(nt>=be?(Rt+=Math.round(zn*((be-nt)/xn)),nt=be):gt>=be&&(on=Rt+Math.round(zn*((be-nt)/xn)),gt=be),Rt>=be&&on>=be||(Rt>=be?(nt+=Math.round(xn*((be-Rt)/zn)),Rt=be):on>=be&&(gt=nt+Math.round(xn*((be-Rt)/zn)),on=be),tt&&nt===tt[tt.length-1][0]&&Rt===tt[tt.length-1][1]||(tt=[[nt,Rt]],Ie.push(tt)),tt.push([gt,on])))))}}function ar({name:Fe,features:Y},Q){Q.writeStringField(1,Fe),Q.writeVarintField(5,s.al);const ce=new Map,Ie=new Map,xe={keys:ce,values:Ie,feature:null};for(const be of Y)xe.feature=be,Q.writeMessage(2,Br,xe);for(const be of ce.keys())Q.writeStringField(3,be);for(const be of Ie.keys())Q.writeMessage(4,uo,be)}function Br(Fe,Y){const Q=Fe.feature;Q.id!==void 0&&Number.isSafeInteger(+Q.id)&&Y.writeVarintField(1,+Q.id),Q.tags&&Y.writeMessage(2,ei,Fe),Y.writeVarintField(3,Q.type),Y.writeMessage(4,oi,Q)}function ei({keys:Fe,values:Y,feature:Q},ce){for(const Ie of Object.keys(Q.tags)){let xe=Q.tags[Ie];if(xe===null)continue;let be=Fe.get(Ie);be===void 0&&(be=Fe.size,Fe.set(Ie,be)),ce.writeVarint(be);const tt=typeof xe;tt!=="string"&&tt!=="boolean"&&tt!=="number"&&(xe=JSON.stringify(xe));let ze=Y.get(xe);ze===void 0&&(ze=Y.size,Y.set(xe,ze)),ce.writeVarint(ze)}}function or(Fe,Y){return(Y<<3)+(7&Fe)}function vr(Fe){return Fe<<1^Fe>>31}function oi(Fe,Y){const{geometry:Q,type:ce}=Fe;let Ie=0,xe=0;if(ce===1){Y.writeVarint(or(1,Q.length));for(const be of Q){const tt=be[0]-Ie,ze=be[1]-xe;Y.writeVarint(vr(tt)),Y.writeVarint(vr(ze)),Ie+=tt,xe+=ze}}else for(const be of Q){Y.writeVarint(or(1,1));const tt=be.length-(ce===3?1:0);for(let ze=0;ze<tt;ze++){ze===1&&Y.writeVarint(or(2,tt-1));const nt=be[ze][0]-Ie,Rt=be[ze][1]-xe;Y.writeVarint(vr(nt)),Y.writeVarint(vr(Rt)),Ie+=nt,xe+=Rt}ce===3&&Y.writeVarint(or(7,1))}}function uo(Fe,Y){const Q=typeof Fe;Q==="string"?Y.writeStringField(1,Fe):Q==="boolean"?Y.writeBooleanField(7,Fe):Q==="number"&&(Fe%1!=0?Y.writeDoubleField(3,Fe):Fe<0?Y.writeSVarintField(6,Fe):Y.writeVarintField(5,Fe))}const Gi={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:Fe=>Fe},ur=Math.fround||(Ot=new Float32Array(1),Fe=>(Ot[0]=+Fe,Ot[0]));var Ot;const ln=3,yn=5,vn=6;class Nr{constructor(Y){this.options=Object.assign(Object.create(Gi),Y),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(Y){const{log:Q,minZoom:ce,maxZoom:Ie}=this.options;Q&&console.time("total time");const xe=`prepare ${Y.length} points`;Q&&console.time(xe),this.points=Y;const be=[];for(let ze=0;ze<Y.length;ze++){const nt=Y[ze];if(!nt.geometry)continue;const[Rt,gt]=nt.geometry.coordinates,on=ur(dt(Rt)),xn=ur(Lt(gt));be.push(on,xn,1/0,ze,-1,1),this.options.reduce&&be.push(0)}let tt=this.trees[Ie+1]=this._createTree(be);Q&&console.timeEnd(xe);for(let ze=Ie;ze>=ce;ze--){const nt=+Date.now();tt=this.trees[ze]=this._createTree(this._cluster(tt,ze)),Q&&console.log("z%d: %d clusters in %dms",ze,tt.numItems,+Date.now()-nt)}return Q&&console.timeEnd("total time"),this}getClusters(Y,Q){let ce=((Y[0]+180)%360+360)%360-180;const Ie=Math.max(-90,Math.min(90,Y[1]));let xe=Y[2]===180?180:((Y[2]+180)%360+360)%360-180;const be=Math.max(-90,Math.min(90,Y[3]));if(Y[2]-Y[0]>=360)ce=-180,xe=180;else if(ce>xe){const gt=this.getClusters([ce,Ie,180,be],Q),on=this.getClusters([-180,Ie,xe,be],Q);return gt.concat(on)}const tt=this.trees[this._limitZoom(Q)],ze=tt.range(dt(ce),Lt(be),dt(xe),Lt(Ie)),nt=tt.data,Rt=[];for(const gt of ze){const on=this.stride*gt;Rt.push(nt[on+yn]>1?He(nt,on,this.clusterProps):this.points[nt[on+ln]])}return Rt}getChildren(Y){const Q=this._getOriginId(Y),ce=this._getOriginZoom(Y),Ie="No cluster with the specified id.",xe=this.trees[ce];if(!xe)throw new Error(Ie);const be=xe.data;if(Q*this.stride>=be.length)throw new Error(Ie);const tt=this.options.radius/(this.options.extent*Math.pow(2,ce-1)),ze=xe.within(be[Q*this.stride],be[Q*this.stride+1],tt),nt=[];for(const Rt of ze){const gt=Rt*this.stride;be[gt+4]===Y&&nt.push(be[gt+yn]>1?He(be,gt,this.clusterProps):this.points[be[gt+ln]])}if(nt.length===0)throw new Error(Ie);return nt}getLeaves(Y,Q,ce){const Ie=[];return this._appendLeaves(Ie,Y,Q=Q||10,ce=ce||0,0),Ie}getTile(Y,Q,ce){const Ie=this.trees[this._limitZoom(Y)],xe=Math.pow(2,Y),{extent:be,radius:tt}=this.options,ze=tt/be,nt=(ce-ze)/xe,Rt=(ce+1+ze)/xe,gt={features:[]};return this._addTileFeatures(Ie.range((Q-ze)/xe,nt,(Q+1+ze)/xe,Rt),Ie.data,Q,ce,xe,gt),Q===0&&this._addTileFeatures(Ie.range(1-ze/xe,nt,1,Rt),Ie.data,xe,ce,xe,gt),Q===xe-1&&this._addTileFeatures(Ie.range(0,nt,ze/xe,Rt),Ie.data,-1,ce,xe,gt),gt.features.length?gt:null}getClusterExpansionZoom(Y){let Q=this._getOriginZoom(Y)-1;for(;Q<=this.options.maxZoom;){const ce=this.getChildren(Y);if(Q++,ce.length!==1)break;Y=ce[0].properties.cluster_id}return Q}_appendLeaves(Y,Q,ce,Ie,xe){const be=this.getChildren(Q);for(const tt of be){const ze=tt.properties;if(ze&&ze.cluster?xe+ze.point_count<=Ie?xe+=ze.point_count:xe=this._appendLeaves(Y,ze.cluster_id,ce,Ie,xe):xe<Ie?xe++:Y.push(tt),Y.length===ce)break}return xe}_createTree(Y){const Q=new s.c3(Y.length/this.stride|0,this.options.nodeSize,Float32Array);for(let ce=0;ce<Y.length;ce+=this.stride)Q.add(Y[ce],Y[ce+1]);return Q.finish(),Q.data=Y,Q}_addTileFeatures(Y,Q,ce,Ie,xe,be){for(const tt of Y){const ze=tt*this.stride,nt=Q[ze+yn]>1;let Rt,gt,on;if(nt)Rt=Qe(Q,ze,this.clusterProps),gt=Q[ze],on=Q[ze+1];else{const lr=this.points[Q[ze+ln]];Rt=lr.properties;const[Yn,fr]=lr.geometry.coordinates;gt=dt(Yn),on=Lt(fr)}const xn={type:1,geometry:[[Math.round(this.options.extent*(gt*xe-ce)),Math.round(this.options.extent*(on*xe-Ie))]],tags:Rt};let zn;zn=nt||this.options.generateId?Q[ze+ln]:this.points[Q[ze+ln]].id,zn!==void 0&&(xn.id=zn),be.features.push(xn)}}_limitZoom(Y){return Math.max(this.options.minZoom,Math.min(Math.floor(+Y),this.options.maxZoom+1))}_cluster(Y,Q){const{radius:ce,extent:Ie,reduce:xe,minPoints:be}=this.options,tt=ce/(Ie*Math.pow(2,Q)),ze=Y.data,nt=[],Rt=this.stride;for(let gt=0;gt<ze.length;gt+=Rt){if(ze[gt+2]<=Q)continue;ze[gt+2]=Q;const on=ze[gt],xn=ze[gt+1],zn=Y.within(ze[gt],ze[gt+1],tt),lr=ze[gt+yn];let Yn=lr;for(const fr of zn){const ti=fr*Rt;ze[ti+2]>Q&&(Yn+=ze[ti+yn])}if(Yn>lr&&Yn>=be){let fr,ti=on*lr,cr=xn*lr,Hi=-1;const to=(gt/Rt<<5)+(Q+1)+this.points.length;for(const fo of zn){const Zr=fo*Rt;if(ze[Zr+2]<=Q)continue;ze[Zr+2]=Q;const Sr=ze[Zr+yn];ti+=ze[Zr]*Sr,cr+=ze[Zr+1]*Sr,ze[Zr+4]=to,xe&&(fr||(fr=this._map(ze,gt,!0),Hi=this.clusterProps.length,this.clusterProps.push(fr)),xe(fr,this._map(ze,Zr)))}ze[gt+4]=to,nt.push(ti/Yn,cr/Yn,1/0,to,-1,Yn),xe&&nt.push(Hi)}else{for(let fr=0;fr<Rt;fr++)nt.push(ze[gt+fr]);if(Yn>1)for(const fr of zn){const ti=fr*Rt;if(!(ze[ti+2]<=Q)){ze[ti+2]=Q;for(let cr=0;cr<Rt;cr++)nt.push(ze[ti+cr])}}}}return nt}_getOriginId(Y){return Y-this.points.length>>5}_getOriginZoom(Y){return(Y-this.points.length)%32}_map(Y,Q,ce){if(Y[Q+yn]>1){const be=this.clusterProps[Y[Q+vn]];return ce?Object.assign({},be):be}const Ie=this.points[Y[Q+ln]].properties,xe=this.options.map(Ie);return ce&&xe===Ie?Object.assign({},xe):xe}}function He(Fe,Y,Q){return{type:"Feature",id:Fe[Y+ln],properties:Qe(Fe,Y,Q),geometry:{type:"Point",coordinates:[(ce=Fe[Y],360*(ce-.5)),qt(Fe[Y+1])]}};var ce}function Qe(Fe,Y,Q){const ce=Fe[Y+yn],Ie=ce>=1e4?`${Math.round(ce/1e3)}k`:ce>=1e3?Math.round(ce/100)/10+"k":ce,xe=Fe[Y+vn],be=xe===-1?{}:Object.assign({},Q[xe]);return Object.assign(be,{cluster:!0,cluster_id:Fe[Y+ln],point_count:ce,point_count_abbreviated:Ie})}function dt(Fe){return Fe/360+.5}function Lt(Fe){const Y=Math.sin(Fe*Math.PI/180),Q=.5-.25*Math.log((1+Y)/(1-Y))/Math.PI;return Q<0?0:Q>1?1:Q}function qt(Fe){const Y=(180-360*Fe)*Math.PI/180;return 360*Math.atan(Math.exp(Y))/Math.PI-90}function jt(Fe,Y,Q,ce){let Ie=ce;const xe=Y+(Q-Y>>1);let be,tt=Q-Y;const ze=Fe[Y],nt=Fe[Y+1],Rt=Fe[Q],gt=Fe[Q+1];for(let on=Y+3;on<Q;on+=3){const xn=Rn(Fe[on],Fe[on+1],ze,nt,Rt,gt);if(xn>Ie)be=on,Ie=xn;else if(xn===Ie){const zn=Math.abs(on-xe);zn<tt&&(be=on,tt=zn)}}Ie>ce&&(be-Y>3&&jt(Fe,Y,be,ce),Fe[be+2]=Ie,Q-be>3&&jt(Fe,be,Q,ce))}function Rn(Fe,Y,Q,ce,Ie,xe){let be=Ie-Q,tt=xe-ce;if(be!==0||tt!==0){const ze=((Fe-Q)*be+(Y-ce)*tt)/(be*be+tt*tt);ze>1?(Q=Ie,ce=xe):ze>0&&(Q+=be*ze,ce+=tt*ze)}return be=Fe-Q,tt=Y-ce,be*be+tt*tt}function fn(Fe,Y,Q,ce){const Ie={id:Fe??null,type:Y,geometry:Q,tags:ce,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(Y==="Point"||Y==="MultiPoint"||Y==="LineString")cn(Ie,Q);else if(Y==="Polygon")cn(Ie,Q[0]);else if(Y==="MultiLineString")for(const xe of Q)cn(Ie,xe);else if(Y==="MultiPolygon")for(const xe of Q)cn(Ie,xe[0]);return Ie}function cn(Fe,Y){for(let Q=0;Q<Y.length;Q+=3)Fe.minX=Math.min(Fe.minX,Y[Q]),Fe.minY=Math.min(Fe.minY,Y[Q+1]),Fe.maxX=Math.max(Fe.maxX,Y[Q]),Fe.maxY=Math.max(Fe.maxY,Y[Q+1])}function Zt(Fe,Y,Q,ce){if(!Y.geometry)return;const Ie=Y.geometry.coordinates;if(Ie&&Ie.length===0)return;const xe=Y.geometry.type,be=Math.pow(Q.tolerance/((1<<Q.maxZoom)*Q.extent),2);let tt=[],ze=Y.id;if(Q.promoteId?ze=Y.properties[Q.promoteId]:Q.generateId&&(ze=ce||0),xe==="Point")Xn(Ie,tt);else if(xe==="MultiPoint")for(const nt of Ie)Xn(nt,tt);else if(xe==="LineString")En(Ie,tt,be,!1);else if(xe==="MultiLineString"){if(Q.lineMetrics){for(const nt of Ie)tt=[],En(nt,tt,be,!1),Fe.push(fn(ze,"LineString",tt,Y.properties));return}jn(Ie,tt,be,!1)}else if(xe==="Polygon")jn(Ie,tt,be,!0);else{if(xe!=="MultiPolygon"){if(xe==="GeometryCollection"){for(const nt of Y.geometry.geometries)Zt(Fe,{id:ze,geometry:nt,properties:Y.properties},Q,ce);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const nt of Ie){const Rt=[];jn(nt,Rt,be,!0),tt.push(Rt)}}Fe.push(fn(ze,xe,tt,Y.properties))}function Xn(Fe,Y){Y.push(dr(Fe[0]),Gn(Fe[1]),0)}function En(Fe,Y,Q,ce){let Ie,xe,be=0;for(let ze=0;ze<Fe.length;ze++){const nt=dr(Fe[ze][0]),Rt=Gn(Fe[ze][1]);Y.push(nt,Rt,0),ze>0&&(be+=ce?(Ie*Rt-nt*xe)/2:Math.sqrt(Math.pow(nt-Ie,2)+Math.pow(Rt-xe,2))),Ie=nt,xe=Rt}const tt=Y.length-3;Y[2]=1,jt(Y,0,tt,Q),Y[tt+2]=1,Y.size=Math.abs(be),Y.start=0,Y.end=Y.size}function jn(Fe,Y,Q,ce){for(let Ie=0;Ie<Fe.length;Ie++){const xe=[];En(Fe[Ie],xe,Q,ce),Y.push(xe)}}function dr(Fe){return Fe/360+.5}function Gn(Fe){const Y=Math.sin(Fe*Math.PI/180),Q=.5-.25*Math.log((1+Y)/(1-Y))/Math.PI;return Q<0?0:Q>1?1:Q}function hr(Fe,Y,Q,ce,Ie,xe,be,tt){if(ce/=Y,xe>=(Q/=Y)&&be<ce)return Fe;if(be<Q||xe>=ce)return null;const ze=[];for(const nt of Fe){const Rt=nt.geometry;let gt=nt.type;const on=Ie===0?nt.minX:nt.minY,xn=Ie===0?nt.maxX:nt.maxY;if(on>=Q&&xn<ce){ze.push(nt);continue}if(xn<Q||on>=ce)continue;let zn=[];if(gt==="Point"||gt==="MultiPoint")Yr(Rt,zn,Q,ce,Ie);else if(gt==="LineString")ho(Rt,zn,Q,ce,Ie,!1,tt.lineMetrics);else if(gt==="MultiLineString")Vi(Rt,zn,Q,ce,Ie,!1);else if(gt==="Polygon")Vi(Rt,zn,Q,ce,Ie,!0);else if(gt==="MultiPolygon")for(const lr of Rt){const Yn=[];Vi(lr,Yn,Q,ce,Ie,!0),Yn.length&&zn.push(Yn)}if(zn.length){if(tt.lineMetrics&&gt==="LineString"){for(const lr of zn)ze.push(fn(nt.id,gt,lr,nt.tags));continue}gt!=="LineString"&&gt!=="MultiLineString"||(zn.length===1?(gt="LineString",zn=zn[0]):gt="MultiLineString"),gt!=="Point"&&gt!=="MultiPoint"||(gt=zn.length===3?"Point":"MultiPoint"),ze.push(fn(nt.id,gt,zn,nt.tags))}}return ze.length?ze:null}function Yr(Fe,Y,Q,ce,Ie){for(let xe=0;xe<Fe.length;xe+=3){const be=Fe[xe+Ie];be>=Q&&be<=ce&&oo(Y,Fe[xe],Fe[xe+1],Fe[xe+2])}}function ho(Fe,Y,Q,ce,Ie,xe,be){let tt=So(Fe);const ze=Ie===0?Hs:Ws;let nt,Rt,gt=Fe.start;for(let Yn=0;Yn<Fe.length-3;Yn+=3){const fr=Fe[Yn],ti=Fe[Yn+1],cr=Fe[Yn+2],Hi=Fe[Yn+3],to=Fe[Yn+4],fo=Ie===0?fr:ti,Zr=Ie===0?Hi:to;let Sr=!1;be&&(nt=Math.sqrt(Math.pow(fr-Hi,2)+Math.pow(ti-to,2))),fo<Q?Zr>Q&&(Rt=ze(tt,fr,ti,Hi,to,Q),be&&(tt.start=gt+nt*Rt)):fo>ce?Zr<ce&&(Rt=ze(tt,fr,ti,Hi,to,ce),be&&(tt.start=gt+nt*Rt)):oo(tt,fr,ti,cr),Zr<Q&&fo>=Q&&(Rt=ze(tt,fr,ti,Hi,to,Q),Sr=!0),Zr>ce&&fo<=ce&&(Rt=ze(tt,fr,ti,Hi,to,ce),Sr=!0),!xe&&Sr&&(be&&(tt.end=gt+nt*Rt),Y.push(tt),tt=So(Fe)),be&&(gt+=nt)}let on=Fe.length-3;const xn=Fe[on],zn=Fe[on+1],lr=Ie===0?xn:zn;lr>=Q&&lr<=ce&&oo(tt,xn,zn,Fe[on+2]),on=tt.length-3,xe&&on>=3&&(tt[on]!==tt[0]||tt[on+1]!==tt[1])&&oo(tt,tt[0],tt[1],tt[2]),tt.length&&Y.push(tt)}function So(Fe){const Y=[];return Y.size=Fe.size,Y.start=Fe.start,Y.end=Fe.end,Y}function Vi(Fe,Y,Q,ce,Ie,xe){for(const be of Fe)ho(be,Y,Q,ce,Ie,xe,!1)}function oo(Fe,Y,Q,ce){Fe.push(Y,Q,ce)}function Hs(Fe,Y,Q,ce,Ie,xe){const be=(xe-Y)/(ce-Y);return oo(Fe,xe,Q+(Ie-Q)*be,1),be}function Ws(Fe,Y,Q,ce,Ie,xe){const be=(xe-Q)/(Ie-Q);return oo(Fe,Y+(ce-Y)*be,xe,1),be}function so(Fe,Y){const Q=[];for(let ce=0;ce<Fe.length;ce++){const Ie=Fe[ce],xe=Ie.type;let be;if(xe==="Point"||xe==="MultiPoint"||xe==="LineString")be=Fo(Ie.geometry,Y);else if(xe==="MultiLineString"||xe==="Polygon"){be=[];for(const tt of Ie.geometry)be.push(Fo(tt,Y))}else if(xe==="MultiPolygon"){be=[];for(const tt of Ie.geometry){const ze=[];for(const nt of tt)ze.push(Fo(nt,Y));be.push(ze)}}Q.push(fn(Ie.id,xe,be,Ie.tags))}return Q}function Fo(Fe,Y){const Q=[];Q.size=Fe.size,Fe.start!==void 0&&(Q.start=Fe.start,Q.end=Fe.end);for(let ce=0;ce<Fe.length;ce+=3)Q.push(Fe[ce]+Y,Fe[ce+1],Fe[ce+2]);return Q}function Ma(Fe,Y){if(Fe.transformed)return Fe;const Q=1<<Fe.z,ce=Fe.x,Ie=Fe.y;for(const xe of Fe.features){const be=xe.geometry,tt=xe.type;if(xe.geometry=[],tt===1)for(let ze=0;ze<be.length;ze+=2)xe.geometry.push(ai(be[ze],be[ze+1],Y,Q,ce,Ie));else for(let ze=0;ze<be.length;ze++){const nt=[];for(let Rt=0;Rt<be[ze].length;Rt+=2)nt.push(ai(be[ze][Rt],be[ze][Rt+1],Y,Q,ce,Ie));xe.geometry.push(nt)}}return Fe.transformed=!0,Fe}function ai(Fe,Y,Q,ce,Ie,xe){return[Math.round(Q*(Fe*ce-Ie)),Math.round(Q*(Y*ce-xe))]}function ko(Fe,Y,Q,ce,Ie){const xe=Y===Ie.maxZoom?0:Ie.tolerance/((1<<Y)*Ie.extent),be={features:[],numPoints:0,numSimplified:0,numFeatures:Fe.length,source:null,x:Q,y:ce,z:Y,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const tt of Fe)bc(be,tt,xe,Ie);return be}function bc(Fe,Y,Q,ce){const Ie=Y.geometry,xe=Y.type,be=[];if(Fe.minX=Math.min(Fe.minX,Y.minX),Fe.minY=Math.min(Fe.minY,Y.minY),Fe.maxX=Math.max(Fe.maxX,Y.maxX),Fe.maxY=Math.max(Fe.maxY,Y.maxY),xe==="Point"||xe==="MultiPoint")for(let tt=0;tt<Ie.length;tt+=3)be.push(Ie[tt],Ie[tt+1]),Fe.numPoints++,Fe.numSimplified++;else if(xe==="LineString")ua(be,Ie,Fe,Q,!1,!1);else if(xe==="MultiLineString"||xe==="Polygon")for(let tt=0;tt<Ie.length;tt++)ua(be,Ie[tt],Fe,Q,xe==="Polygon",tt===0);else if(xe==="MultiPolygon")for(let tt=0;tt<Ie.length;tt++){const ze=Ie[tt];for(let nt=0;nt<ze.length;nt++)ua(be,ze[nt],Fe,Q,!0,nt===0)}if(be.length){let tt=Y.tags||null;if(xe==="LineString"&&ce.lineMetrics){tt={};for(const nt in Y.tags)tt[nt]=Y.tags[nt];tt.mapbox_clip_start=Ie.start/Ie.size,tt.mapbox_clip_end=Ie.end/Ie.size}const ze={geometry:be,type:xe==="Polygon"||xe==="MultiPolygon"?3:xe==="LineString"||xe==="MultiLineString"?2:1,tags:tt};Y.id!==null&&(ze.id=Y.id),Fe.features.push(ze)}}function ua(Fe,Y,Q,ce,Ie,xe){const be=ce*ce;if(ce>0&&Y.size<(Ie?be:ce))return void(Q.numPoints+=Y.length/3);const tt=[];for(let ze=0;ze<Y.length;ze+=3)(ce===0||Y[ze+2]>be)&&(Q.numSimplified++,tt.push(Y[ze],Y[ze+1])),Q.numPoints++;Ie&&(function(ze,nt){let Rt=0;for(let gt=0,on=ze.length,xn=on-2;gt<on;xn=gt,gt+=2)Rt+=(ze[gt]-ze[xn])*(ze[gt+1]+ze[xn+1]);if(Rt>0===nt)for(let gt=0,on=ze.length;gt<on/2;gt+=2){const xn=ze[gt],zn=ze[gt+1];ze[gt]=ze[on-2-gt],ze[gt+1]=ze[on-1-gt],ze[on-2-gt]=xn,ze[on-1-gt]=zn}})(tt,xe),Fe.push(tt)}const Os={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class Ul{constructor(Y,Q){const ce=(Q=this.options=(function(xe,be){for(const tt in be)xe[tt]=be[tt];return xe})(Object.create(Os),Q)).debug;if(ce&&console.time("preprocess data"),Q.maxZoom<0||Q.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(Q.promoteId&&Q.generateId)throw new Error("promoteId and generateId cannot be used together.");let Ie=(function(xe,be){const tt=[];if(xe.type==="FeatureCollection")for(let ze=0;ze<xe.features.length;ze++)Zt(tt,xe.features[ze],be,ze);else Zt(tt,xe.type==="Feature"?xe:{geometry:xe},be);return tt})(Y,Q);this.tiles={},this.tileCoords=[],ce&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",Q.indexMaxZoom,Q.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),Ie=(function(xe,be){const tt=be.buffer/be.extent;let ze=xe;const nt=hr(xe,1,-1-tt,tt,0,-1,2,be),Rt=hr(xe,1,1-tt,2+tt,0,-1,2,be);return(nt||Rt)&&(ze=hr(xe,1,-tt,1+tt,0,-1,2,be)||[],nt&&(ze=so(nt,1).concat(ze)),Rt&&(ze=ze.concat(so(Rt,-1)))),ze})(Ie,Q),Ie.length&&this.splitTile(Ie,0,0,0),ce&&(Ie.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(Y,Q,ce,Ie,xe,be,tt){const ze=[Y,Q,ce,Ie],nt=this.options,Rt=nt.debug;for(;ze.length;){Ie=ze.pop(),ce=ze.pop(),Q=ze.pop(),Y=ze.pop();const gt=1<<Q,on=da(Q,ce,Ie);let xn=this.tiles[on];if(!xn&&(Rt>1&&console.time("creation"),xn=this.tiles[on]=ko(Y,Q,ce,Ie,nt),this.tileCoords.push({z:Q,x:ce,y:Ie}),Rt)){Rt>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",Q,ce,Ie,xn.numFeatures,xn.numPoints,xn.numSimplified),console.timeEnd("creation"));const Sr=`z${Q}`;this.stats[Sr]=(this.stats[Sr]||0)+1,this.total++}if(xn.source=Y,xe==null){if(Q===nt.indexMaxZoom||xn.numPoints<=nt.indexMaxPoints)continue}else{if(Q===nt.maxZoom||Q===xe)continue;if(xe!=null){const Sr=xe-Q;if(ce!==be>>Sr||Ie!==tt>>Sr)continue}}if(xn.source=null,Y.length===0)continue;Rt>1&&console.time("clipping");const zn=.5*nt.buffer/nt.extent,lr=.5-zn,Yn=.5+zn,fr=1+zn;let ti=null,cr=null,Hi=null,to=null,fo=hr(Y,gt,ce-zn,ce+Yn,0,xn.minX,xn.maxX,nt),Zr=hr(Y,gt,ce+lr,ce+fr,0,xn.minX,xn.maxX,nt);Y=null,fo&&(ti=hr(fo,gt,Ie-zn,Ie+Yn,1,xn.minY,xn.maxY,nt),cr=hr(fo,gt,Ie+lr,Ie+fr,1,xn.minY,xn.maxY,nt),fo=null),Zr&&(Hi=hr(Zr,gt,Ie-zn,Ie+Yn,1,xn.minY,xn.maxY,nt),to=hr(Zr,gt,Ie+lr,Ie+fr,1,xn.minY,xn.maxY,nt),Zr=null),Rt>1&&console.timeEnd("clipping"),ze.push(ti||[],Q+1,2*ce,2*Ie),ze.push(cr||[],Q+1,2*ce,2*Ie+1),ze.push(Hi||[],Q+1,2*ce+1,2*Ie),ze.push(to||[],Q+1,2*ce+1,2*Ie+1)}}getTile(Y,Q,ce){Y=+Y,Q=+Q,ce=+ce;const Ie=this.options,{extent:xe,debug:be}=Ie;if(Y<0||Y>24)return null;const tt=1<<Y,ze=da(Y,Q=Q+tt&tt-1,ce);if(this.tiles[ze])return Ma(this.tiles[ze],xe);be>1&&console.log("drilling down to z%d-%d-%d",Y,Q,ce);let nt,Rt=Y,gt=Q,on=ce;for(;!nt&&Rt>0;)Rt--,gt>>=1,on>>=1,nt=this.tiles[da(Rt,gt,on)];return nt&&nt.source?(be>1&&(console.log("found parent tile z%d-%d-%d",Rt,gt,on),console.time("drilling down")),this.splitTile(nt.source,Rt,gt,on,Y,Q,ce),be>1&&console.timeEnd("drilling down"),this.tiles[ze]?Ma(this.tiles[ze],xe):null):null}}function da(Fe,Y,Q){return 32*((1<<Fe)*Q+Y)+Fe}function xu(Fe,Y){const Q=Fe.tileID.canonical;if(!this._geoJSONIndex)return void Y(null,null);const ce=this._geoJSONIndex.getTile(Q.z,Q.x,Q.y);if(!ce)return void Y(null,null);const Ie=nt=>nt.tags&&"3d_elevation_id"in nt.tags&&"source"in nt.tags&&nt.tags.source==="elevation",xe=ce.features.filter((nt=>Ie(nt)));let be={_geojsonTileLayer:ce.features};xe.length>0&&(be={_geojsonTileLayer:ce.features.filter((nt=>!Ie(nt))),hd_road_elevation:xe});const tt=new Pe(be),ze=(function(nt){const Rt=new s.bt;for(const gt of Object.keys(nt))Rt.writeMessage(3,ar,{name:gt,features:nt[gt]});return Rt.finish()})(be).buffer;Y(null,{vectorTile:tt,rawData:ze})}class xt extends Te{constructor(Y,Q,ce,Ie,xe,be,tt){super(Y,Q,ce,Ie,xe,xu,tt),be&&(this.loadGeoJSON=be),this._dynamicIndex=new je}loadData(Y,Q){const ce=Y&&Y.request,Ie=ce&&ce.collectResourceTiming;this._geoJSONIndex=null,this.loadGeoJSON(Y,((xe,be)=>{if(xe||!be)return Q(xe);if(typeof be!="object")return Q(new Error(`Input data given to '${Y.source}' is not a valid GeoJSON object.`));{try{if(Y.filter){const ze=s.U(Y.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(ze.result==="error")throw new Error(ze.value.map((nt=>`${nt.key}: ${nt.message}`)).join(", "));be.features=be.features.filter((nt=>ze.value.evaluate({zoom:0},nt)))}Y.dynamic?(be.type==="Feature"&&(be={type:"FeatureCollection",features:[be]}),Y.append||(this._dynamicIndex.clear(),this.loaded={}),this._dynamicIndex.load(be.features,this.loaded),Y.cluster&&(be.features=this._dynamicIndex.getFeatures())):this.loaded={},this._geoJSONIndex=Y.cluster?new Nr((function({superclusterOptions:ze,clusterProperties:nt}){if(!nt||!ze)return ze;const Rt={},gt={},on={accumulated:null,zoom:0},xn={properties:null},zn=Object.keys(nt);for(const lr of zn){const[Yn,fr]=nt[lr],ti=s.U(fr),cr=s.U(typeof Yn=="string"?[Yn,["accumulated"],["get",lr]]:Yn);Rt[lr]=ti.value,gt[lr]=cr.value}return ze.map=lr=>{xn.properties=lr;const Yn={};for(const fr of zn)Yn[fr]=Rt[fr].evaluate(on,xn);return Yn},ze.reduce=(lr,Yn)=>{xn.properties=Yn;for(const fr of zn)on.accumulated=lr[fr],lr[fr]=gt[fr].evaluate(on,xn)},ze})(Y)).load(be.features):Y.dynamic?this._dynamicIndex:(function(ze,nt){return new Ul(ze,nt)})(be,Y.geojsonVtOptions)}catch(ze){return Q(ze)}const tt={};if(Ie){const ze=C(ce);ze&&(tt.resourceTiming={},tt.resourceTiming[Y.source]=JSON.parse(JSON.stringify(ze)))}Q(null,tt)}}))}reloadTile(Y,Q){const ce=this.loaded;return ce&&ce[Y.uid]?Y.partial?Q(null,void 0):super.reloadTile(Y,Q):this.loadTile(Y,Q)}loadGeoJSON(Y,Q){if(Y.request)s.m(Y.request,Q);else{if(typeof Y.data!="string")return Q(new Error(`Input data given to '${Y.source}' is not a valid GeoJSON object.`));setTimeout((()=>{try{return Q(null,JSON.parse(Y.data))}catch{return Q(new Error(`Input data given to '${Y.source}' is not a valid GeoJSON object.`))}}),0)}}getClusterExpansionZoom(Y,Q){try{Q(null,this._geoJSONIndex.getClusterExpansionZoom(Y.clusterId))}catch(ce){Q(ce)}}getClusterChildren(Y,Q){try{Q(null,this._geoJSONIndex.getChildren(Y.clusterId))}catch(ce){Q(ce)}}getClusterLeaves(Y,Q){try{Q(null,this._geoJSONIndex.getLeaves(Y.clusterId,Y.limit,Y.offset))}catch(ce){Q(ce)}}}class Da{constructor(Y,Q,ce){this.tileID=new s.aO(Y.tileID.overscaledZ,Y.tileID.wrap,Y.tileID.canonical.z,Y.tileID.canonical.x,Y.tileID.canonical.y),this.tileZoom=Y.tileZoom,this.uid=Y.uid,this.zoom=Y.zoom,this.canonical=Y.tileID.canonical,this.pixelRatio=Y.pixelRatio,this.tileSize=Y.tileSize,this.source=Y.source,this.overscaling=this.tileID.overscaleFactor(),this.projection=Y.projection,this.brightness=Q,this.worldview=ce}parse(Y,Q,ce,Ie){this.status="parsing";const xe=new s.aO(ce.tileID.overscaledZ,ce.tileID.wrap,ce.tileID.canonical.z,ce.tileID.canonical.x,ce.tileID.canonical.y),be=[],tt=Q.familiesBySource[ce.source],ze=new s.fe(xe,ce.promoteId);ze.bucketLayerIDs=[],ze.is3DTile=!0,s.ft(Y).then((nt=>{if(!nt)return Ie(new Error("Could not parse tile"));const Rt=nt.json.extensionsUsed&&nt.json.extensionsUsed.includes("MAPBOX_mesh_features")||nt.json.asset.extras&&nt.json.asset.extras.MAPBOX_mesh_features,gt=nt.json.extensionsUsed&&nt.json.extensionsUsed.includes("EXT_meshopt_compression"),on=new s.ac(this.zoom,{brightness:this.brightness,worldview:this.worldview});for(const xn in tt)for(const zn of tt[xn]){const lr=zn[0];ze.bucketLayerIDs.push(zn.map((ti=>s.B(ti.id,ti.scope)))),lr.recalculate(on,[]);const Yn=s.fu(nt,1/s.d6(ce.tileID.canonical)),fr=new s.fv(zn,Yn,xe,Rt,gt,this.brightness,ze,this.worldview);Rt||(fr.needsUpload=!0),be.push(fr),fr.evaluate(lr)}this.status="done",Ie(null,{buckets:be,featureIndex:ze,collisionBoxArray:null,glyphAtlasImage:null,lineAtlas:null,imageAtlas:null,brightness:null})})).catch((nt=>Ie(new Error(nt.message))))}}class jl{constructor(Y,Q,ce,Ie,xe,be,tt,ze){this.actor=Y,this.layerIndex=Q,this.availableImages=ce,this.availableModels=Ie,this.brightness=tt,this.loading={},this.loaded={},this.worldview=ze}loadTile(Y,Q){const ce=Y.uid,Ie=this.loading[ce]=new Da(Y,this.brightness,this.worldview);s.bu(Y.request,((xe,be)=>{const tt=!this.loading[ce];return delete this.loading[ce],tt||xe?(Ie.status="done",tt||(this.loaded[ce]=Ie),Q(xe)):be&&be.byteLength!==0?void Ie.parse(be,this.layerIndex,Y,((ze,nt)=>{Ie.status="done",this.loaded=this.loaded||{},this.loaded[ce]=Ie,ze||!nt?Q(ze):Q(null,nt)})):(Ie.status="done",this.loaded[ce]=Ie,Q())}))}reloadTile(Y,Q){const ce=this.loaded,Ie=Y.uid;if(ce&&ce[Ie]){const xe=ce[Ie];xe.projection=Y.projection,xe.brightness=Y.brightness;const be=(tt,ze)=>{xe.reloadCallback&&(delete xe.reloadCallback,this.loadTile(Y,Q)),Q(tt,ze)};xe.status==="parsing"?xe.reloadCallback=be:xe.status==="done"&&this.loadTile(Y,Q)}}abortTile(Y,Q){const ce=Y.uid;this.loading[ce]&&delete this.loading[ce],Q()}removeTile(Y,Q){const ce=this.loaded,Ie=Y.uid;ce&&ce[Ie]&&delete ce[Ie],Q()}}class Gl{constructor(Y){this.self=Y,this.actor=new s.fx(Y,this),this.layerIndexes={},this.availableImages={},this.availableModels={},this.isSpriteLoaded={},this.imageRasterizer=new s.x,this.rtlPluginParsingListeners=[],this.projections={},this.defaultProjection=s.cl({name:"mercator"}),this.workerSourceTypes={vector:Te,geojson:xt,"raster-dem":Be,"raster-array":Ye,"batched-model":jl},this.workerSources={},this.self.registerWorkerSource=(Q,ce)=>{if(this.workerSourceTypes[Q])throw new Error(`Worker source with name "${Q}" already registered.`);this.workerSourceTypes[Q]=ce},this.self.registerRTLTextPlugin=Q=>{if(s.fy.isParsed())throw new Error("RTL text plugin already registered.");s.fy.setState({pluginStatus:s.fz.parsed,pluginURL:s.fy.getPluginURL()}),s.fy.applyArabicShaping=Q.applyArabicShaping,s.fy.processBidirectionalText=Q.processBidirectionalText,s.fy.processStyledBidirectionalText=Q.processStyledBidirectionalText;for(const ce of this.rtlPluginParsingListeners)ce(null,!0);this.rtlPluginParsingListeners=[]}}clearCaches(Y,Q,ce){delete this.layerIndexes[Y],delete this.availableImages[Y],delete this.availableModels[Y],delete this.workerSources[Y],ce()}checkIfReady(Y,Q,ce){ce()}setReferrer(Y,Q){this.referrer=Q}spriteLoaded(Y,Q){this.isSpriteLoaded[Y]||(this.isSpriteLoaded[Y]={});const{scope:ce,isLoaded:Ie}=Q;if(this.isSpriteLoaded[Y][ce]=Ie,this.workerSources[Y]&&this.workerSources[Y][ce])for(const xe in this.workerSources[Y][ce]){const be=this.workerSources[Y][ce][xe];for(const tt in be){const ze=be[tt];ze instanceof Te&&(ze.isSpriteLoaded=Ie,ze.fire(new s.z("isSpriteLoaded")))}}}setImages(Y,Q,ce){this.availableImages[Y]||(this.availableImages[Y]={});const{scope:Ie,images:xe}=Q;if(this.availableImages[Y][Ie]=xe,this.workerSources[Y]&&this.workerSources[Y][Ie]){for(const be in this.workerSources[Y][Ie]){const tt=this.workerSources[Y][Ie][be];for(const ze in tt)tt[ze].availableImages=xe}ce()}else ce()}setModels(Y,{scope:Q,models:ce},Ie){if(this.availableModels[Y]||(this.availableModels[Y]={}),this.availableModels[Y][Q]=ce,this.workerSources[Y]&&this.workerSources[Y][Q]){for(const xe in this.workerSources[Y][Q]){const be=this.workerSources[Y][Q][xe];for(const tt in be)be[tt].availableModels=ce}Ie()}else Ie()}setProjection(Y,Q){this.projections[Y]=s.cl(Q)}setBrightness(Y,Q,ce){this.brightness=Q,ce()}setWorldview(Y,Q,ce){this.worldview=Q,ce()}setLayers(Y,Q,ce){this.getLayerIndex(Y,Q.scope).replace(Q.layers,Q.options),ce()}updateLayers(Y,Q,ce){this.getLayerIndex(Y,Q.scope).update(Q.layers,Q.removedIds,Q.options),ce()}loadTile(Y,Q,ce){Q.projection=this.projections[Y]||this.defaultProjection,this.getWorkerSource(Y,Q.type,Q.source,Q.scope).loadTile(Q,ce)}decodeRasterArray(Y,Q,ce){this.getWorkerSource(Y,Q.type,Q.source,Q.scope).decodeRasterArray(Q,ce)}reloadTile(Y,Q,ce){Q.projection=this.projections[Y]||this.defaultProjection,this.getWorkerSource(Y,Q.type,Q.source,Q.scope).reloadTile(Q,ce)}abortTile(Y,Q,ce){this.getWorkerSource(Y,Q.type,Q.source,Q.scope).abortTile(Q,ce)}removeTile(Y,Q,ce){this.getWorkerSource(Y,Q.type,Q.source,Q.scope).removeTile(Q,ce)}removeSource(Y,Q,ce){if(!(this.workerSources[Y]&&this.workerSources[Y][Q.scope]&&this.workerSources[Y][Q.scope][Q.type]&&this.workerSources[Y][Q.scope][Q.type][Q.source]))return;const Ie=this.workerSources[Y][Q.scope][Q.type][Q.source];delete this.workerSources[Y][Q.scope][Q.type][Q.source],Ie.removeSource!==void 0?Ie.removeSource(Q,ce):ce()}loadWorkerSource(Y,Q,ce){try{this.self.importScripts(Q.url),ce()}catch(Ie){ce(Ie.toString())}}syncRTLPluginState(Y,Q,ce){if(s.fy.isParsed())ce(null,!0);else if(s.fy.isParsing())this.rtlPluginParsingListeners.push(ce);else try{s.fy.setState(Q);const Ie=s.fy.getPluginURL();!s.fy.isLoaded()||s.fy.isParsed()||s.fy.isParsing()||Ie==null||(s.fy.setState({pluginStatus:s.fz.parsing,pluginURL:s.fy.getPluginURL()}),this.self.importScripts(Ie),s.fy.isParsed()?ce(null,!0):this.rtlPluginParsingListeners.push(ce))}catch(Ie){ce(Ie.toString())}}setDracoUrl(Y,Q){this.dracoUrl=Q}getAvailableImages(Y,Q){this.availableImages[Y]||(this.availableImages[Y]={});let ce=this.availableImages[Y][Q];return ce||(ce=[]),ce}getAvailableModels(Y,Q){this.availableModels[Y]||(this.availableModels[Y]={});let ce=this.availableModels[Y][Q];return ce||(ce={}),ce}getLayerIndex(Y,Q){this.layerIndexes[Y]||(this.layerIndexes[Y]={});let ce=this.layerIndexes[Y][Q];return ce||(ce=this.layerIndexes[Y][Q]=new $,ce.scope=Q),ce}getWorkerSource(Y,Q,ce,Ie){const xe=this.workerSources;return xe[Y]||(xe[Y]={}),xe[Y][Ie]||(xe[Y][Ie]={}),xe[Y][Ie][Q]||(xe[Y][Ie][Q]={}),this.isSpriteLoaded[Y]||(this.isSpriteLoaded[Y]={}),xe[Y][Ie][Q][ce]||(xe[Y][Ie][Q][ce]=new this.workerSourceTypes[Q]({send:(be,tt,ze,nt,Rt,gt)=>this.actor.send(be,tt,ze,Y,Rt,gt),scheduler:this.actor.scheduler},this.getLayerIndex(Y,Ie),this.getAvailableImages(Y,Ie),this.getAvailableModels(Y,Ie),this.isSpriteLoaded[Y][Ie],void 0,this.brightness,this.worldview)),xe[Y][Ie][Q][ce]}rasterizeImagesWorker(Y,Q,ce){const Ie=new Map;for(const[xe,{image:be,imageVariant:tt}]of Q.tasks.entries()){const ze=this.imageRasterizer.rasterize(tt,be,Q.scope,Y);Ie.set(xe,ze)}ce(void 0,Ie)}removeRasterizedImages(Y,Q,ce){this.imageRasterizer.removeImagesFromCacheByIds(Q.imageIds,Q.scope,Y),ce()}enforceCacheSizeLimit(Y,Q){s.fA(Q)}getWorkerPerformanceMetrics(Y,Q,ce){ce(void 0,void 0)}}return s.fw(self)&&(self.worker=new Gl(self)),Gl})),f(["./shared"],(function(s){var C="3.15.0";const P={create:"create",load:"load",fullLoad:"fullLoad"},L={mark(m){performance.mark(m)},measure(m,i,c){performance.measure(m,i,c)}};function $(m){const i=m.name.split("?")[0];return s.a(i)&&i.includes("mapbox-gl.js")?"javascript":s.a(i)&&i.includes("mapbox-gl.css")?"css":s.b(i)?"fontRange":s.c(i)?"sprite":s.i(i)?"style":s.d(i)?"tilejson":"other"}var V,j={},ue=(function(){if(V)return j;function m(p){return!i(p)}function i(p){return typeof window>"u"||typeof document>"u"?"not a browser":(function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var v,w,S=new Blob([""],{type:"text/javascript"}),I=URL.createObjectURL(S);try{w=new Worker(I),v=!0}catch{v=!1}return w&&w.terminate(),URL.revokeObjectURL(I),v})()?(function(){var v=document.createElement("canvas");v.width=v.height=1;var w=v.getContext("2d");if(!w)return!1;var S=w.getImageData(0,0,1,1);return S&&S.width===v.width})()?(c[y=p&&p.failIfMajorPerformanceCaveat]===void 0&&(c[y]=(function(v){var w,S=(function(I){var O=document.createElement("canvas"),D=Object.create(m.webGLContextAttributes);return D.failIfMajorPerformanceCaveat=I,O.getContext("webgl2",D)})(v);if(!S)return!1;try{w=S.createShader(S.VERTEX_SHADER)}catch{return!1}return!(!w||S.isContextLost())&&(S.shaderSource(w,"void main() {}"),S.compileShader(w),S.getShaderParameter(w,S.COMPILE_STATUS)===!0)})(y)),c[y]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL2 support"):"insufficient Canvas/getImageData support":"insufficient worker support";var y}V=1,j.supported=m,j.notSupportedReason=i;var c={};return m.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0},j})();function de(m,i,c){const p=document.createElement(m);return i!=null&&(p.className=i),c&&c.appendChild(p),p}function Te(m,i,c){const p=document.createElementNS("http://www.w3.org/2000/svg",m);for(const y of Object.keys(i))p.setAttributeNS(null,y,String(i[y]));return c&&c.appendChild(p),p}const Be=typeof document<"u"?document.documentElement&&document.documentElement.style:null,Ge=Be&&Be.userSelect!==void 0?"userSelect":"WebkitUserSelect";let Ye;function Ne(){Be&&Ge&&(Ye=Be[Ge],Be[Ge]="none")}function Mt(){Be&&Ge&&(Be[Ge]=Ye)}function kt(m){m.preventDefault(),m.stopPropagation(),window.removeEventListener("click",kt,!0)}function Pe(){window.addEventListener("click",kt,!0),window.setTimeout((()=>{window.removeEventListener("click",kt,!0)}),0)}function we(m,i){const c=m.getBoundingClientRect();return Re(m,c,i)}function Se(m,i){const c=m.getBoundingClientRect(),p=[];for(let y=0;y<i.length;y++)p.push(Re(m,c,i[y]));return p}function je(m){return/firefox/i.test(navigator.userAgent)&&/macintosh/i.test(navigator.userAgent)&&m.button===2&&m.ctrlKey?0:m.button}function Re(m,i,c){const p=m.offsetWidth===i.width?1:m.offsetWidth/i.width;return new s.P((c.clientX-i.left)*p,(c.clientY-i.top)*p)}const Ve="01",ke="NO_ACCESS_TOKEN";class Mn{constructor(i,c,p){this._transformRequestFn=i,this._customAccessToken=c,this._silenceAuthErrors=!!p,this._createSkuToken()}_createSkuToken(){const i=(function(){let c="";for(let p=0;p<10;p++)c+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",Ve,c].join(""),tokenExpiresAt:Date.now()+432e5}})();this._skuToken=i.token,this._skuTokenExpiresAt=i.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(i,c){return this._transformRequestFn&&this._transformRequestFn(i,c)||{url:i}}normalizeStyleURL(i,c){if(!s.h(i))return i;const p=mn(i);return p.params.push(`sdk=js-${C}`),p.path=`/styles/v1${p.path}`,this._makeAPIURL(p,this._customAccessToken||c)}normalizeGlyphsURL(i,c){if(!s.h(i))return i;const p=mn(i);return p.path=`/fonts/v1${p.path}`,this._makeAPIURL(p,this._customAccessToken||c)}normalizeModelURL(i,c){if(!s.h(i))return i;const p=mn(i);return p.path=`/models/v1${p.path}`,this._makeAPIURL(p,this._customAccessToken||c)}normalizeSourceURL(i,c,p,y){if(!s.h(i))return i;const v=mn(i);return v.path=`/v4/${v.authority}.json`,v.params.push("secure"),p&&v.params.push(`language=${p}`),y&&v.params.push(`worldview=${y}`),this._makeAPIURL(v,this._customAccessToken||c)}normalizeIconsetURL(i,c){const p=mn(i);return s.h(i)?(p.path=`/styles/v1${p.path}/iconset.pbf`,this._makeAPIURL(p,this._customAccessToken||c)):Sn(p)}normalizeSpriteURL(i,c,p,y){const v=mn(i);return s.h(i)?(v.path=`/styles/v1${v.path}/sprite${c}${p}`,this._makeAPIURL(v,this._customAccessToken||y)):(v.path+=`${c}${p}`,Sn(v))}normalizeTileURL(i,c,p){if(this._isSkuTokenExpired()&&this._createSkuToken(),i&&!s.h(i))return i;const y=mn(i);y.path=y.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${c||p&&y.authority!=="raster"&&p===512?"@2x":""}${s.k.supported?".webp":"$1"}`),y.authority==="raster"?y.path=`/${s.e.RASTER_URL_PREFIX}${y.path}`:y.authority==="rasterarrays"?y.path=`/${s.e.RASTERARRAYS_URL_PREFIX}${y.path}`:y.authority==="3dtiles"?y.path=`/${s.e.TILES3D_URL_PREFIX}${y.path}`:(y.path=y.path.replace(/^.+\/v4\//,"/"),y.path=`/${s.e.TILE_URL_VERSION}${y.path}`);const v=this._customAccessToken||(function(w){for(const S of w){const I=S.match(/^access_token=(.*)$/);if(I)return I[1]}return null})(y.params)||s.e.ACCESS_TOKEN;return s.e.REQUIRE_ACCESS_TOKEN&&v&&this._skuToken&&y.params.push(`sku=${this._skuToken}`),this._makeAPIURL(y,v)}canonicalizeTileURL(i,c){const p=mn(i);if(!p.path.match(/^(\/v4\/|\/(raster|rasterarrays)\/v1\/)/)||!p.path.match(/\.[\w]+$/))return i;let y="mapbox://";p.path.match(/^\/raster\/v1\//)?y+=`raster/${p.path.replace(`/${s.e.RASTER_URL_PREFIX}/`,"")}`:p.path.match(/^\/rasterarrays\/v1\//)?y+=`rasterarrays/${p.path.replace(`/${s.e.RASTERARRAYS_URL_PREFIX}/`,"")}`:y+=`tiles/${p.path.replace(`/${s.e.TILE_URL_VERSION}/`,"")}`;let v=p.params;return c&&(v=v.filter((w=>!w.match(/^access_token=/)))),v.length&&(y+=`?${v.join("&")}`),y}canonicalizeTileset(i,c){const p=!!c&&s.h(c),y=[];for(const v of i.tiles||[])s.j(v)?y.push(this.canonicalizeTileURL(v,p)):y.push(v);return y}_makeAPIURL(i,c){const p="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",y=mn(s.e.API_URL);if(i.protocol=y.protocol,i.authority=y.authority,i.protocol==="http"){const v=i.params.indexOf("secure");v>=0&&i.params.splice(v,1)}if(y.path!=="/"&&(i.path=`${y.path}${i.path}`),!s.e.REQUIRE_ACCESS_TOKEN)return Sn(i);if(c=c||s.e.ACCESS_TOKEN,!this._silenceAuthErrors){if(!c)throw new Error(`An API access token is required to use Mapbox GL. ${p}`);if(c[0]==="s")throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${p}`)}return i.params=i.params.filter((v=>v.indexOf("access_token")===-1)),i.params.push(`access_token=${c||""}`),Sn(i)}}const bn=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function mn(m){const i=m.match(bn);if(!i)throw new Error("Unable to parse URL object");return{protocol:i[1],authority:i[2],path:i[3]||"/",params:i[4]?i[4].split("&"):[]}}function Sn(m){const i=m.params.length?`?${m.params.join("&")}`:"";return`${m.protocol}://${m.authority}${m.path}${i}`}const ar="mapbox.eventData";function Br(m){if(!m)return null;const i=m.split(".");if(!i||i.length!==3)return null;try{return JSON.parse(s.l(i[1]))}catch{return null}}class ei{constructor(i){this.type=i,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(i){const c=Br(s.e.ACCESS_TOKEN);let p="";return p=c&&c.u?s.f(c.u):s.e.ACCESS_TOKEN||"",i?`${ar}.${i}:${p}`:`${ar}:${p}`}fetchEventData(){const i=s.s("localStorage"),c=this.getStorageKey(),p=this.getStorageKey("uuid");if(i)try{const y=localStorage.getItem(c);y&&(this.eventData=JSON.parse(y));const v=localStorage.getItem(p);v&&(this.anonId=v)}catch{s.w("Unable to read from LocalStorage")}}saveEventData(){const i=s.s("localStorage"),c=this.getStorageKey(),p=this.getStorageKey("uuid"),y=this.anonId;if(i&&y)try{localStorage.setItem(p,y),Object.keys(this.eventData).length>=1&&localStorage.setItem(c,JSON.stringify(this.eventData))}catch{s.w("Unable to write to LocalStorage")}}processRequests(i){}postEvent(i,c,p,y){if(!s.e.EVENTS_URL)return;const v=mn(s.e.EVENTS_URL);v.params.push(`access_token=${y||s.e.ACCESS_TOKEN||""}`);const w={event:this.type,created:new Date(i).toISOString()},S=c?Object.assign(w,c):w,I={url:Sn(v),headers:{"Content-Type":"text/plain"},body:JSON.stringify([S])};this.pendingRequest=s.p(I,(O=>{this.pendingRequest=null,p(O),this.saveEventData(),this.processRequests(y)}))}queueRequest(i,c){this.queue.push(i),this.processRequests(c)}}const or=new class extends ei{constructor(m){super("appUserTurnstile"),this._customAccessToken=m}postTurnstileEvent(m,i){s.e.EVENTS_URL&&s.e.ACCESS_TOKEN&&Array.isArray(m)&&m.some((c=>s.h(c)||s.j(c)))&&this.queueRequest(Date.now(),i)}processRequests(m){if(this.pendingRequest||this.queue.length===0)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const i=Br(s.e.ACCESS_TOKEN),c=i?i.u:s.e.ACCESS_TOKEN;let p=c!==this.eventData.tokenU;s.v(this.anonId)||(this.anonId=s.u(),p=!0);const y=this.queue.shift();if(this.eventData.lastSuccess){const v=new Date(this.eventData.lastSuccess),w=new Date(y),S=(y-this.eventData.lastSuccess)/864e5;p=p||S>=1||S<-1||v.getDate()!==w.getDate()}else p=!0;p?this.postEvent(y,{sdkIdentifier:"mapbox-gl-js",sdkVersion:C,skuId:Ve,"enabled.telemetry":!1,userId:this.anonId},(v=>{v||(this.eventData.lastSuccess=y,this.eventData.tokenU=c)}),m):this.processRequests()}},vr=or.postTurnstileEvent.bind(or),oi=new class extends ei{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(m,i,c,p){this.skuToken=i,this.errorCb=p,s.e.EVENTS_URL&&(c||s.e.ACCESS_TOKEN?this.queueRequest({id:m,timestamp:Date.now()},c):this.errorCb(new Error(ke)))}processRequests(m){if(this.pendingRequest||this.queue.length===0)return;const{id:i,timestamp:c}=this.queue.shift();i&&this.success[i]||(this.anonId||this.fetchEventData(),s.v(this.anonId)||(this.anonId=s.u()),this.postEvent(c,{sdkIdentifier:"mapbox-gl-js",sdkVersion:C,skuId:Ve,skuToken:this.skuToken,userId:this.anonId},(p=>{p?this.errorCb(p):i&&(this.success[i]=!0)}),m))}remove(){this.errorCb=null}},uo=oi.postMapLoadEvent.bind(oi),Gi=new class extends ei{constructor(){super("style.load"),this.eventIdPerMapInstanceMap=new Map,this.mapInstanceIdMap=new WeakMap}getMapInstanceId(m){let i=this.mapInstanceIdMap.get(m);return i||(i=s.u(),this.mapInstanceIdMap.set(m,i)),i}getEventId(m){const i=this.eventIdPerMapInstanceMap.get(m)||0;return this.eventIdPerMapInstanceMap.set(m,i+1),i}postStyleLoadEvent(m,i){const{map:c,style:p,importedStyles:y}=i;if(!s.e.EVENTS_URL||!m&&!s.e.ACCESS_TOKEN)return;const v=this.getMapInstanceId(c),w={mapInstanceId:v,eventId:this.getEventId(v),style:p};y.length&&(w.importedStyles=y),this.queueRequest({timestamp:Date.now(),payload:w},m)}processRequests(m){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:i,payload:c}=this.queue.shift();this.postEvent(i,c,(()=>{}),m)}},ur=Gi.postStyleLoadEvent.bind(Gi),Ot=new class extends ei{constructor(){super("gljs.performance")}postPerformanceEvent(m,i){s.e.EVENTS_URL&&(m||s.e.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:i},m)}processRequests(m){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:i,performanceData:c}=this.queue.shift(),p=(function(y){const v=performance.getEntriesByType("resource"),w=performance.getEntriesByType("mark"),S=(function(U){const G={};if(U){for(const H in U)if(H!=="other")for(const J of U[H]){const Z=`${H}ResolveRangeMin`,ee=`${H}ResolveRangeMax`,ie=`${H}RequestCount`,se=`${H}RequestCachedCount`;G[Z]=Math.min(G[Z]||1/0,J.startTime),G[ee]=Math.max(G[ee]||-1/0,J.responseEnd);const me=fe=>{G[fe]===void 0&&(G[fe]=0),++G[fe]};J.transferSize!==void 0&&J.transferSize===0&&me(se),me(ie)}}return G})((function(U,G){const H={};if(U)for(const J of U){const Z=G(J);H[Z]===void 0&&(H[Z]=[]),H[Z].push(J)}return H})(v,$)),I=window.devicePixelRatio,O=navigator.connection||navigator.mozConnection||navigator.webkitConnection,D=O?O.effectiveType:void 0,N={counters:[],metadata:[],attributes:[]},z=(U,G,H)=>{H!=null&&U.push({name:G,value:H.toString()})};for(const U in S)z(N.counters,U,S[U]);if(y.interactionRange[0]!==1/0&&y.interactionRange[1]!==-1/0&&(z(N.counters,"interactionRangeMin",y.interactionRange[0]),z(N.counters,"interactionRangeMax",y.interactionRange[1])),w)for(const U of Object.keys(P)){const G=P[U],H=w.find((J=>J.name===G));H&&z(N.counters,G,H.startTime)}return z(N.counters,"visibilityHidden",y.visibilityHidden),z(N.attributes,"style",(function(U){if(U)for(const G of U){const H=G.name.split("?")[0];if(s.i(H)){const J=H.split("/").slice(-2);if(J.length===2)return`mapbox://styles/${J[0]}/${J[1]}`}}})(v)),z(N.attributes,"terrainEnabled",y.terrainEnabled?"true":"false"),z(N.attributes,"fogEnabled",y.fogEnabled?"true":"false"),z(N.attributes,"projection",y.projection),z(N.attributes,"zoom",y.zoom),z(N.metadata,"devicePixelRatio",I),z(N.metadata,"connectionEffectiveType",D),z(N.metadata,"navigatorUserAgent",navigator.userAgent),z(N.metadata,"screenWidth",window.screen.width),z(N.metadata,"screenHeight",window.screen.height),z(N.metadata,"windowWidth",window.innerWidth),z(N.metadata,"windowHeight",window.innerHeight),z(N.metadata,"mapWidth",y.width/I),z(N.metadata,"mapHeight",y.height/I),z(N.metadata,"webglRenderer",y.renderer),z(N.metadata,"webglVendor",y.vendor),z(N.metadata,"sdkVersion",C),z(N.metadata,"sdkIdentifier","mapbox-gl-js"),N})(c);for(const y of p.metadata);for(const y of p.counters);for(const y of p.attributes);this.postEvent(i,p,(()=>{}),m)}},ln=Ot.postPerformanceEvent.bind(Ot),yn=new class extends ei{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(m,i,c,p){if(!s.e.API_URL||!s.e.SESSION_PATH)return;const y=mn(s.e.API_URL+s.e.SESSION_PATH);y.params.push(`sku=${i||""}`),y.params.push(`access_token=${p||s.e.ACCESS_TOKEN||""}`);const v={url:Sn(y),headers:{"Content-Type":"text/plain"}};this.pendingRequest=s.g(v,(w=>{this.pendingRequest=null,c(w),this.saveEventData(),this.processRequests(p)}))}getSessionAPI(m,i,c,p){this.skuToken=i,this.errorCb=p,s.e.SESSION_PATH&&s.e.API_URL&&(c||s.e.ACCESS_TOKEN?this.queueRequest({id:m,timestamp:Date.now()},c):this.errorCb(new Error(ke)))}processRequests(m){if(this.pendingRequest||this.queue.length===0)return;const{id:i,timestamp:c}=this.queue.shift();i&&this.success[i]||this.getSession(c,this.skuToken,(p=>{p?this.errorCb(p):i&&(this.success[i]=!0)}),m)}remove(){this.errorCb=null}},vn=yn.getSessionAPI.bind(yn),Nr=new Set;function He(m,i){i?Nr.add(m):Nr.delete(m)}class Qe{constructor(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSourceCaches={},this._updatedPaintProps=new Set,this._updatedImages={}}isDirty(){return this._changed}setDirty(){this._changed=!0}getUpdatedSourceCaches(){return this._updatedSourceCaches}updateSourceCache(i,c){this._updatedSourceCaches[i]=c,this.setDirty()}discardSourceCacheUpdate(i){delete this._updatedSourceCaches[i]}updateLayer(i){const c=i.scope;this._updatedLayers[c]=this._updatedLayers[c]||new Set,this._updatedLayers[c].add(i.id),this.setDirty()}removeLayer(i){const c=i.scope;this._removedLayers[c]=this._removedLayers[c]||{},this._updatedLayers[c]=this._updatedLayers[c]||new Set,this._removedLayers[c][i.id]=i,this._updatedLayers[c].delete(i.id),this._updatedPaintProps.delete(i.fqid),this.setDirty()}getRemovedLayer(i){return this._removedLayers[i.scope]?this._removedLayers[i.scope][i.id]:null}discardLayerRemoval(i){this._removedLayers[i.scope]&&delete this._removedLayers[i.scope][i.id]}getLayerUpdatesByScope(){const i={};for(const c in this._updatedLayers)i[c]=i[c]||{},i[c].updatedIds=Array.from(this._updatedLayers[c].values());for(const c in this._removedLayers)i[c]=i[c]||{},i[c].removedIds=Object.keys(this._removedLayers[c]);return i}getUpdatedPaintProperties(){return this._updatedPaintProps}updatePaintProperties(i){this._updatedPaintProps.add(i.fqid),this.setDirty()}getUpdatedImages(i){return this._updatedImages[i]?Array.from(this._updatedImages[i].values()):[]}updateImage(i,c){this._updatedImages[c]=this._updatedImages[c]||new Set,this._updatedImages[c].add(s.I.toString(i)),this.setDirty()}resetUpdatedImages(i){this._updatedImages[i]&&this._updatedImages[i].clear()}reset(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSourceCaches={},this._updatedPaintProps.clear(),this._updatedImages={}}}function dt(m){const{userImage:i}=m;return!!(i&&i.render&&i.render())&&(m.data.replace(new Uint8Array(i.data.buffer)),!0)}class Lt extends s.E{constructor(i){super(),this.imageProviders=new Map,this.images=new Map,this.updatedImages=new Map,this.callbackDispatchedThisFrame=new Map,this.loaded=new Map,this.requestors=[],this.patterns=new Map,this.patternsInFlight=new Set,this.atlasImage=new Map,this.atlasTexture=new Map,this.dirty=!0,this.spriteFormat=i,i!=="raster"&&s.r()&&(this.imageRasterizerDispatcher=new s.D(s.t(),this,"Image Rasterizer Worker",1))}addScope(i){this.loaded.set(i,!1),this.imageProviders.set(i,new Map),this.images.set(i,new Map),this.updatedImages.set(i,new Set),this.callbackDispatchedThisFrame.set(i,new Set),this.patterns.set(i,new Map),this.atlasImage.set(i,new s.q({width:1,height:1}))}removeScope(i){this.loaded.delete(i),this.imageProviders.delete(i),this.images.delete(i),this.updatedImages.delete(i),this.callbackDispatchedThisFrame.delete(i),this.patterns.delete(i),this.atlasImage.delete(i);const c=this.atlasTexture.get(i);c&&(c.destroy(),this.atlasTexture.delete(i))}addImageProvider(i,c){this.imageProviders.has(c)||this.imageProviders.set(c,new Map),this.imageProviders.get(c).set(i.id,i)}removeImageProvider(i,c){this.imageProviders.has(c)&&this.imageProviders.get(c).delete(i)}getPendingImageProviders(){const i=[];for(const c of this.imageProviders.values())for(const p of c.values())p.hasPendingRequests()&&i.push(p);return i}get imageRasterizer(){return this._imageRasterizer||(this._imageRasterizer=new s.x),this._imageRasterizer}isLoaded(){for(const i of this.loaded.keys())if(!this.loaded.get(i))return!1;return!0}setLoaded(i,c){if(this.loaded.get(c)!==i&&(this.loaded.set(c,i),i)){for(const{ids:p,callback:y}of this.requestors)this._notify(p,c,y);this.requestors=[]}}hasImage(i,c){return!!this.getImage(i,c)}getImage(i,c){return this.images.get(c).get(i.toString())}addImage(i,c,p){this._validate(i,p)&&this.images.get(c).set(i.toString(),p)}_validate(i,c){let p=!0;return this._validateStretch(c.stretchX,c.data&&c.data.width)||(this.fire(new s.y(new Error(`Image "${i.name}" has invalid "stretchX" value`))),p=!1),this._validateStretch(c.stretchY,c.data&&c.data.height)||(this.fire(new s.y(new Error(`Image "${i.name}" has invalid "stretchY" value`))),p=!1),this._validateContent(c.content,c)||(this.fire(new s.y(new Error(`Image "${i.name}" has invalid "content" value`))),p=!1),p}_validateStretch(i,c){if(!i)return!0;let p=0;for(const y of i){if(y[0]<p||y[1]<y[0]||c<y[1])return!1;p=y[1]}return!0}_validateContent(i,c){return i?i.length!==4||!c.usvg&&(i[0]<0||c.data.width<i[0]||i[1]<0||c.data.height<i[1]||i[2]<0||c.data.width<i[2]||i[3]<0||c.data.height<i[3])?!1:!(i[2]<i[0]||i[3]<i[1]):!0}updateImage(i,c,p){const y=this.images.get(c).get(i.toString());p.version=y.version+1,this.images.get(c).set(i.toString(),p),this.updatedImages.get(c).add(i),this.removeFromImageRasterizerCache(i,c)}clearUpdatedImages(i){this.updatedImages.get(i).clear()}removeFromImageRasterizerCache(i,c){this.spriteFormat!=="raster"&&(s.r()?this.imageRasterizerDispatcher.getActor().send("removeRasterizedImages",{imageIds:[i],scope:c}):this.imageRasterizer.removeImagesFromCacheByIds([i],c))}removeImage(i,c){const p=this.images.get(c),y=p.get(i.toString());p.delete(i.toString()),this.patterns.get(c).delete(i.toString()),this.removeFromImageRasterizerCache(i,c),y.userImage&&y.userImage.onRemove&&y.userImage.onRemove()}listImages(i){return Array.from(this.images.get(i).keys()).map((c=>s.I.from(c)))}getImages(i,c,p){const y=[],v=[],w=this.imageProviders.get(c);for(const D of i){if(!D.iconsetId){y.push(D);continue}const N=w.get(D.iconsetId);N&&(this.getImage(D,c)?v.push(D):N.addPendingRequest(D))}if(y.length===0)return void this._notify(v,c,p);let S=!0;const I=!!this.loaded.get(c),O=this.images.get(c);if(!I)for(const D of y)O.has(D.toString())||(S=!1);I||S?this._notify(y,c,p):this.requestors.push({ids:y,scope:c,callback:p})}rasterizeImages(i,c){const p=new Map,{tasks:y,scope:v}=i;for(const[w,S]of y.entries()){const I=this.getImage(S.id,v);I&&p.set(w,{image:I,imageVariant:S})}this._rasterizeImages(v,p,c)}_rasterizeImages(i,c,p){if(s.r())this.imageRasterizerDispatcher.getActor().send("rasterizeImagesWorker",{tasks:c,scope:i},p);else{const y=new Map;for(const[v,{image:w,imageVariant:S}]of c.entries())y.set(v,this.imageRasterizer.rasterize(S,w,i,0));p(void 0,y)}}getUpdatedImages(i){return this.updatedImages.get(i)||new Set}_notify(i,c,p){const y=this.images.get(c),v=new Map;for(const w of i){if(!y.get(w.toString())){if(w.iconsetId)continue;this.fire(new s.z("styleimagemissing",{id:w.name}))}const S=y.get(w.toString());if(!S){s.w(`Image "${w.name}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`);continue}const I={data:S.usvg?null:S.data.clone(),pixelRatio:S.pixelRatio,sdf:S.sdf,usvg:S.usvg,version:S.version,stretchX:S.stretchX,stretchY:S.stretchY,content:S.content,hasRenderCallback:!!(S.userImage&&S.userImage.render)};S.usvg&&Object.assign(I,{width:S.icon.usvg_tree.width,height:S.icon.usvg_tree.height}),v.set(s.I.toString(w),I)}p(null,v)}getPixelSize(i){const{width:c,height:p}=this.atlasImage.get(i);return{width:c,height:p}}getPattern(i,c,p){const y=i.toString(),v=this.patterns.get(c),w=v.get(y),S=this.getImage(i,c);if(!S)return null;if(w){if(w.position.version===S.version)return w.position;w.position.version=S.version}else{if(S.usvg&&!S.data){const I=this.getPatternInFlightId(y,c);if(this.patternsInFlight.has(I))return null;this.patternsInFlight.add(I);const O=new s.A(i).scaleSelf(s.o.devicePixelRatio),D=new Map([[O.toString(),{image:S,imageVariant:O}]]);return this._rasterizeImages(c,D,((N,z)=>this.storePatternImage(O,c,S,p,z))),null}this.storePattern(i,c,S)}return this._updatePatternAtlas(c,p),v.get(y).position}getPatternInFlightId(i,c){return s.B(i,c)}hasPatternsInFlight(){return this.patternsInFlight.size!==0}storePatternImage(i,c,p,y,v){const w=i.toString(),S=v?v.get(w):void 0;S&&(p.data=S,this.storePattern(i.id,c,p),this._updatePatternAtlas(c,y),this.patternsInFlight.delete(this.getPatternInFlightId(i.id.toString(),c)))}storePattern(i,c,p){const y={w:p.data.width+2*s.C,h:p.data.height+2*s.C,x:0,y:0},v=new s.F(y,p,s.C);this.patterns.get(c).set(i.toString(),{bin:y,position:v})}destroyAtlasTextures(){for(const i of this.atlasTexture.values())i&&i.destroy();this.atlasTexture.clear()}bind(i,c){const p=i.gl;let y=this.atlasTexture.get(c);y?this.dirty&&(y.update(this.atlasImage.get(c)),this.dirty=!1):(y=new s.T(i,this.atlasImage.get(c),p.RGBA8),this.atlasTexture.set(c,y)),y.bind(p.LINEAR,p.CLAMP_TO_EDGE)}_updatePatternAtlas(i,c){const p=this.patterns.get(i),y=Array.from(p.values()).map((({bin:O})=>O)),{w:v,h:w}=s.G(y),S=this.atlasImage.get(i);S.resize({width:v||1,height:w||1});const I=this.images.get(i);for(const[O,{bin:D,position:N}]of p.entries()){let z=N.padding;const U=D.x+z,G=D.y+z,H=I.get(O).data,J=H.width,Z=H.height;z=z>1?z-1:z,s.q.copy(H,S,{x:0,y:0},{x:U,y:G},{width:J,height:Z},c),s.q.copy(H,S,{x:0,y:Z-z},{x:U,y:G-z},{width:J,height:z},c),s.q.copy(H,S,{x:0,y:0},{x:U,y:G+Z},{width:J,height:z},c),s.q.copy(H,S,{x:J-z,y:0},{x:U-z,y:G},{width:z,height:Z},c),s.q.copy(H,S,{x:0,y:0},{x:U+J,y:G},{width:z,height:Z},c),s.q.copy(H,S,{x:J-z,y:Z-z},{x:U-z,y:G-z},{width:z,height:z},c),s.q.copy(H,S,{x:0,y:Z-z},{x:U+J,y:G-z},{width:z,height:z},c),s.q.copy(H,S,{x:0,y:0},{x:U+J,y:G+Z},{width:z,height:z},c),s.q.copy(H,S,{x:J-z,y:0},{x:U-z,y:G+Z},{width:z,height:z},c)}this.dirty=!0}beginFrame(){for(const i of this.images.keys())this.callbackDispatchedThisFrame.set(i,new Set)}dispatchRenderCallbacks(i,c){const p=this.images.get(c);for(const y of i){if(this.callbackDispatchedThisFrame.get(c).has(y.toString()))continue;this.callbackDispatchedThisFrame.get(c).add(y.toString());const v=p.get(y.toString());dt(v)&&this.updateImage(y,c,v)}}destroy(){this.imageRasterizerDispatcher&&this.imageRasterizerDispatcher.remove()}}function qt(m){const i=m.value,c=m.valueSpec,p=m.style,y=m.styleSpec,v=m.key,w=m.arrayElementValidator||ai;if(!Array.isArray(i))return[new s.V(v,i,`array expected, ${s.K(i)} found`)];if(c.length&&i.length!==c.length)return[new s.V(v,i,`array length ${c.length} expected, length ${i.length} found`)];if(c["min-length"]&&i.length<c["min-length"])return[new s.V(v,i,`array length at least ${c["min-length"]} expected, length ${i.length} found`)];let S={type:c.value,values:c.values,minimum:c.minimum,maximum:c.maximum,function:void 0};y.$version<7&&(S.function=c.function),s.H(c.value)&&(S=c.value);let I=[];for(let O=0;O<i.length;O++)I=I.concat(w({array:i,arrayIndex:O,value:i[O],valueSpec:S,style:p,styleSpec:y,key:`${v}[${O}]`},!0));return I}function jt(m){const i=m.key,c=m.value,p=m.valueSpec;if(!s.L(c))return[new s.V(i,c,`number expected, ${s.K(c)} found`)];if(c!=c)return[new s.V(i,c,"number expected, NaN found")];if("minimum"in p){let y=p.minimum;if(Array.isArray(p.minimum)&&(y=p.minimum[m.arrayIndex]),c<y)return[new s.V(i,c,`${c} is less than the minimum value ${y}`)]}if("maximum"in p){let y=p.maximum;if(Array.isArray(p.maximum)&&(y=p.maximum[m.arrayIndex]),c>y)return[new s.V(i,c,`${c} is greater than the maximum value ${y}`)]}return[]}function Rn(m){const i=m.key,c=m.value;if(!s.H(c))return[new s.V(i,c,`object expected, ${s.K(c)} found`)];const p=m.valueSpec,y=s.J(c.type);let v,w,S,I={};const O=y!=="categorical"&&c.property===void 0,D=!O,N=(function(H){const J=H.stops;return Array.isArray(J)&&Array.isArray(J[0])&&s.H(J[0][0])})(c),z=ko({key:m.key,value:m.value,valueSpec:m.styleSpec.function,style:m.style,styleSpec:m.styleSpec,objectElementValidators:{stops:function(H){if(y==="identity")return[new s.V(H.key,H.value,'identity function may not have a "stops" property')];let J=[];const Z=H.value;return J=J.concat(qt({key:H.key,value:Z,valueSpec:H.valueSpec,style:H.style,styleSpec:H.styleSpec,arrayElementValidator:U})),Array.isArray(Z)&&Z.length===0&&J.push(new s.V(H.key,Z,"array must have at least one stop")),J},default:function(H){return ai({key:H.key,value:H.value,valueSpec:p,style:H.style,styleSpec:H.styleSpec})}}});return y==="identity"&&O&&z.push(new s.V(m.key,m.value,'missing required property "property"')),y==="identity"||c.stops||z.push(new s.V(m.key,m.value,'missing required property "stops"')),y==="exponential"&&p.expression&&!s.M(p)&&z.push(new s.V(m.key,m.value,"exponential functions not supported")),m.styleSpec.$version>=8&&(D&&!s.N(p)?z.push(new s.V(m.key,m.value,"property functions not supported")):O&&!s.O(p)&&z.push(new s.V(m.key,m.value,"zoom functions not supported"))),y!=="categorical"&&!N||c.property!==void 0||z.push(new s.V(m.key,m.value,'"property" property is required')),z;function U(H){let J=[];const Z=H.value,ee=H.key;if(!Array.isArray(Z))return[new s.V(ee,Z,`array expected, ${s.K(Z)} found`)];if(Z.length!==2)return[new s.V(ee,Z,`array length 2 expected, length ${Z.length} found`)];if(N){if(!s.H(Z[0]))return[new s.V(ee,Z,`object expected, ${s.K(Z[0])} found`)];const ie=Z[0];if(ie.zoom===void 0)return[new s.V(ee,Z,"object stop key must have zoom")];if(ie.value===void 0)return[new s.V(ee,Z,"object stop key must have value")];const se=s.J(ie.zoom);if(typeof se!="number")return[new s.V(ee,ie.zoom,"stop zoom values must be numbers")];if(S&&S>se)return[new s.V(ee,ie.zoom,"stop zoom values must appear in ascending order")];se!==S&&(S=se,w=void 0,I={}),J=J.concat(ko({key:`${ee}[0]`,value:Z[0],valueSpec:{zoom:{}},style:H.style,styleSpec:H.styleSpec,objectElementValidators:{zoom:jt,value:G}}))}else J=J.concat(G({key:`${ee}[0]`,value:Z[0],style:H.style,styleSpec:H.styleSpec},Z));return s.Q(s.S(Z[1]))?J.concat([new s.V(`${ee}[1]`,Z[1],"expressions are not allowed in function stops.")]):J.concat(ai({key:`${ee}[1]`,value:Z[1],valueSpec:p,style:H.style,styleSpec:H.styleSpec}))}function G(H,J){const Z=s.K(H.value),ee=s.J(H.value),ie=H.value!==null?H.value:J;if(v){if(Z!==v)return[new s.V(H.key,ie,`${Z} stop domain type must match previous stop domain type ${v}`)]}else v=Z;if(Z!=="number"&&Z!=="string"&&Z!=="boolean"&&typeof ee!="number"&&typeof ee!="string"&&typeof ee!="boolean")return[new s.V(H.key,ie,"stop domain value must be a number, string, or boolean")];if(Z!=="number"&&y!=="categorical"){let se=`number expected, ${Z} found`;return s.N(p)&&y===void 0&&(se+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new s.V(H.key,ie,se)]}return y!=="categorical"||Z!=="number"||typeof ee=="number"&&isFinite(ee)&&Math.floor(ee)===ee?y!=="categorical"&&Z==="number"&&typeof ee=="number"&&typeof w=="number"&&w!==void 0&&ee<w?[new s.V(H.key,ie,"stop domain values must appear in ascending order")]:(w=ee,y==="categorical"&&ee in I?[new s.V(H.key,ie,"stop domain values must be unique")]:(I[ee]=!0,[])):[new s.V(H.key,ie,`integer expected, found ${String(ee)}`)]}}function fn(m){const i=(m.expressionContext==="property"?s.W:s.U)(s.S(m.value),m.valueSpec);if(i.result==="error")return i.value.map((p=>new s.V(`${m.key}${p.key}`,m.value,p.message)));const c=i.value.expression||i.value._styleExpression.expression;if(m.expressionContext==="property"&&m.propertyKey==="text-font"&&!c.outputDefined())return[new s.V(m.key,m.value,`Invalid data expression for "${m.propertyKey}". Output values must be contained as literals within the expression.`)];if(m.expressionContext==="property"&&m.propertyType==="layout"&&!s.Z(c))return[new s.V(m.key,m.value,'"feature-state" data expressions are not supported with layout properties.')];if(m.expressionContext==="filter")return cn(c,m);if(m.expressionContext==="appearance")return Zt(c,m);if(m.expressionContext&&m.expressionContext.indexOf("cluster")===0){if(!s.X(c,["zoom","feature-state"]))return[new s.V(m.key,m.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(m.expressionContext==="cluster-initial"&&!s.Y(c))return[new s.V(m.key,m.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function cn(m,i){const c=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(i.valueSpec&&i.valueSpec.expression)for(const y of i.valueSpec.expression.parameters)c.delete(y);if(c.size===0)return[];const p=[];return m instanceof s._&&c.has(m.name)?[new s.V(i.key,i.value,`["${m.name}"] expression is not supported in a filter for a ${i.object.type} layer with id: ${i.object.id}`)]:(m.eachChild((y=>{p.push(...cn(y,i))})),p)}function Zt(m,i){const c=new Set;if(i.valueSpec&&i.valueSpec.expression)for(const y of i.valueSpec.expression.parameters)c.add(y);if(c.size===0)return[];const p=[];return m instanceof s._&&!c.has(m.name)?[new s.V(i.key,i.value,`["${m.name}"] is not an allowed parameter`)]:(m.eachChild((y=>{p.push(...Zt(y,i))})),p)}function Xn(m){const i=m.key,c=m.value,p=m.valueSpec,y=[];return Array.isArray(p.values)?p.values.indexOf(s.J(c))===-1&&y.push(new s.V(i,c,`expected one of [${p.values.join(", ")}], ${JSON.stringify(c)} found`)):Object.keys(p.values).indexOf(s.J(c))===-1&&y.push(new s.V(i,c,`expected one of [${Object.keys(p.values).join(", ")}], ${JSON.stringify(c)} found`)),y}function En(m){return s.a2(s.S(m.value))?fn(Object.assign({},m,{expressionContext:"filter",valueSpec:m.styleSpec[`filter_${m.layerType||"fill"}`]})):jn(m)}function jn(m){const i=m.value,c=m.key;if(!Array.isArray(i))return[new s.V(c,i,`array expected, ${s.K(i)} found`)];if(i.length<1)return[new s.V(c,i,"filter array must have at least 1 element")];const p=m.styleSpec;let y=Xn({key:`${c}[0]`,value:i[0],valueSpec:p.filter_operator});switch(s.J(i[0])){case"<":case"<=":case">":case">=":i.length>=2&&s.J(i[1])==="$type"&&y.push(new s.V(c,i,`"$type" cannot be use with operator "${i[0]}"`));case"==":case"!=":i.length!==3&&y.push(new s.V(c,i,`filter array for operator "${i[0]}" must have 3 elements`));case"in":case"!in":i.length>=2&&(s.a0(i[1])||y.push(new s.V(`${c}[1]`,i[1],`string expected, ${s.K(i[1])} found`)));for(let v=2;v<i.length;v++)s.J(i[1])==="$type"?y=y.concat(Xn({key:`${c}[${v}]`,value:i[v],valueSpec:p.geometry_type})):s.a0(i[v])||s.L(i[v])||s.$(i[v])||y.push(new s.V(`${c}[${v}]`,i[v],`string, number, or boolean expected, ${s.K(i[v])} found.`));break;case"any":case"all":case"none":for(let v=1;v<i.length;v++)y=y.concat(jn({key:`${c}[${v}]`,value:i[v],style:m.style,styleSpec:m.styleSpec}));break;case"has":case"!has":i.length!==2?y.push(new s.V(c,i,`filter array for "${i[0]}" operator must have 2 elements`)):s.a0(i[1])||y.push(new s.V(`${c}[1]`,i[1],`string expected, ${s.K(i[1])} found`))}return y}function dr(m,i){const c=m.key,p=m.style,y=m.layer,v=m.styleSpec,w=m.value,S=m.objectKey,I=v[`${i}_${m.layerType}`];if(!I)return[];const O=S.match(/^(.*)-use-theme$/);if(O&&I[O[1]])return s.Q(w)?[].concat(ai({key:m.key,value:w,valueSpec:{type:"string",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},style:p,styleSpec:v,expressionContext:"property",propertyType:i,propertyKey:S})):ai({key:c,value:w,valueSpec:{type:"string"},style:p,styleSpec:v});const D=S.match(/^(.*)-transition$/);if(i==="paint"&&D&&I[D[1]]&&I[D[1]].transition)return ai({key:c,value:w,valueSpec:v.transition,style:p,styleSpec:v});const N=m.valueSpec||I[S];if(!N)return[new s.a3(c,w,`unknown property "${S}"`)];let z;if(s.a0(w)&&s.N(N)&&!N.tokens&&(z=/^{([^}]+)}$/.exec(w))){const G=`\`{ "type": "identity", "property": ${z?JSON.stringify(z[1]):'"_"'} }\``;return[new s.V(c,w,`"${S}" does not support interpolation syntax
Use an identity property function instead: ${G}.`)]}const U=[];if(m.layerType==="symbol")S!=="text-field"||!p||p.glyphs||p.imports||U.push(new s.V(c,w,'use of "text-field" requires a style "glyphs" property')),S==="text-font"&&s.a4(s.S(w))&&s.J(w.type)==="identity"&&U.push(new s.V(c,w,'"text-font" does not support identity functions'));else if(m.layerType==="model"&&i==="paint"&&y&&y.layout&&y.layout.hasOwnProperty("model-id")&&s.N(N)&&(s.a5(N)||s.O(N))){const G=s.W(s.S(w),N),H=G.value.expression||G.value._styleExpression.expression;H&&!s.X(H,["measure-light"])&&(S==="model-emissive-strength"&&s.Y(H)&&s.Z(H)||U.push(new s.V(c,w,`${S} does not support measure-light expressions when the model layer source is vector tile or GeoJSON.`)))}return U.concat(ai({key:m.key,value:w,valueSpec:N,style:p,styleSpec:v,expressionContext:"property",propertyType:i,propertyKey:S}))}function Gn(m){return dr(m,"paint")}function hr(m){return dr(m,"layout")}function Yr(m){let i=[];const c=m.value,p=m.key,y=m.style,v=m.styleSpec;if(!s.H(c))return[new s.V(p,c,"object expected")];c.type||c.ref||i.push(new s.V(p,c,'either "type" or "ref" is required'));let w=s.J(c.type);const S=s.J(c.ref);if(c.id){const I=s.J(c.id);for(let O=0;O<m.arrayIndex;O++){const D=y.layers[O];s.J(D.id)===I&&i.push(new s.V(p,c.id,`duplicate layer id "${I}", previously used at line ${D.id.__line__}`))}}if("ref"in c){let I;["type","source","source-layer","filter","layout"].forEach((O=>{O in c&&i.push(new s.V(p,c[O],`"${O}" is prohibited for ref layers`))})),y.layers.forEach((O=>{s.J(O.id)===S&&(I=O)})),I?I.ref?i.push(new s.V(p,c.ref,"ref cannot reference another ref layer")):w=s.J(I.type):typeof S=="string"&&i.push(new s.V(p,c.ref,`ref layer "${S}" not found`))}else if(w!=="background"&&w!=="sky"&&w!=="slot")if(c.source)if(s.a0(c.source)){const I=y.sources&&y.sources[c.source],O=I&&s.J(I.type);I?O==="vector"&&w==="raster"?i.push(new s.V(p,c.source,`layer "${c.id}" requires a raster source`)):O==="raster"&&w!=="raster"?i.push(new s.V(p,c.source,`layer "${c.id}" requires a vector source`)):O!=="vector"||c["source-layer"]?O==="raster-dem"&&w!=="hillshade"?i.push(new s.V(p,c.source,"raster-dem source can only be used with layer type 'hillshade'.")):O!=="raster-array"||["raster","raster-particle"].includes(w)?w==="line"&&c.paint&&(c.paint["line-gradient"]||c.paint["line-trim-offset"])&&O==="geojson"&&!I.lineMetrics?i.push(new s.V(p,c,`layer "${c.id}" specifies a line-gradient, which requires the GeoJSON source to have \`lineMetrics\` enabled.`)):w==="raster-particle"&&O!=="raster-array"&&i.push(new s.V(p,c.source,`layer "${c.id}" requires a 'raster-array' source.`)):i.push(new s.V(p,c.source,"raster-array source can only be used with layer type 'raster'.")):i.push(new s.V(p,c,`layer "${c.id}" must specify a "source-layer"`)):i.push(new s.V(p,c.source,`source "${c.source}" not found`))}else i.push(new s.V(`${p}.source`,c.source,'"source" must be a string'));else i.push(new s.V(p,c,'missing required property "source"'));return i=i.concat(ko({key:p,value:c,valueSpec:v.layer,style:m.style,styleSpec:m.styleSpec,objectElementValidators:{"*":()=>[],type:()=>ai({key:`${p}.type`,value:c.type,valueSpec:v.layer.type,style:m.style,styleSpec:m.styleSpec,object:c,objectKey:"type"}),filter:I=>En(Object.assign({layerType:w},I)),layout:I=>ko({layer:c,key:I.key,value:I.value,valueSpec:{},style:I.style,styleSpec:I.styleSpec,objectElementValidators:{"*":O=>hr(Object.assign({layerType:w},O))}}),paint:I=>ko({layer:c,key:I.key,value:I.value,valueSpec:{},style:I.style,styleSpec:I.styleSpec,objectElementValidators:{"*":O=>Gn(Object.assign({layerType:w,layer:c},O))}}),appearances(I){const O=qt({key:I.key,value:I.value,valueSpec:I.valueSpec,style:I.style,styleSpec:I.styleSpec,arrayElementValidator:z=>(function(U){const{key:G,layer:H,layerType:J}=U,Z=s.J(U.value),ee=s.J(Z.name),ie=s.J(Z.condition),se=ko({key:G,value:Z,valueSpec:U.styleSpec.appearance,style:U.style,styleSpec:U.styleSpec,objectElementValidators:{condition:me=>(function(fe){const ge=[];return ge.push(...fn({key:fe.key,value:fe.object.condition,valueSpec:s.a6.appearance.condition,expressionContext:"appearance"})),ge})(Object.assign({layer:H,layerType:J},me)),properties:me=>(function(fe){const ge=[],{styleSpec:pe,layer:he,layerType:_e}=fe,Ke=pe[`paint_${_e}`],Le=pe[`layout_${_e}`],st=fe.object[fe.objectKey];for(const We in st){const it=We in Ke?"paint":We in Le?"layout":void 0;if(!it){ge.push(new s.V(fe.key,We,`unknown property "${We}" for layer type "${_e}"`));continue}const Pt=Object.assign({},fe,{key:`${fe.key}.${We}`,object:st,objectKey:We,layer:he,layerType:_e,value:st[We],valueSpec:it==="paint"?Ke[We]:Le[We]});ge.push(...dr(Pt,it))}return ge})(Object.assign({layer:H,layerType:J},me))}});return ee==="hidden"||ie||se.push(new s.V(U.key,"name",'Appearance with name different than "hidden" must have a condition')),se})(Object.assign({layerType:w,layer:c},z))}),D=Array.isArray(I.value)?I.value:[],N=new Set;return D.forEach(((z,U)=>{const G=s.J(z.name);if(G)if(N.has(G)){const H=s.J(c.id);O.push(new s.V(I.key,G,`Duplicated appearance name "${G}" for layer "${H}"`))}else N.add(G)})),O}}})),i}function ho({key:m,value:i}){return s.a0(i)?[]:[new s.V(m,i,`string expected, ${s.K(i)} found`)]}const So={promoteId:function m({key:i,value:c}){if(s.a0(c))return ho({key:i,value:c});if(Array.isArray(c)){const y=[],v=s.S(c),w=s.U(v);return w.result==="error"&&w.value.forEach((S=>{y.push(new s.V(`${i}${S.key}`,null,`${S.message}`))})),s.X(w.value.expression,["zoom","heatmap-density","line-progress","raster-value","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center","measure-light","raster-particle-speed"])||y.push(new s.V(`${i}`,null,"promoteId expression should be only feature dependent")),y}if(!s.H(c))return[new s.V(i,c,`string, expression or object expected, "${s.K(c)}" found`)];const p=[];for(const y in c)p.push(...m({key:`${i}.${y}`,value:c[y]}));return p}};function Vi(m){const i=m.value,c=m.key,p=m.styleSpec,y=m.style;if(!s.H(i))return[new s.V(c,i,`object expected, ${s.K(i)} found`)];if(!("type"in i))return[new s.V(c,i,'"type" is required')];const v=s.J(i.type);let w=[];switch(["vector","raster","raster-dem","raster-array"].includes(v)&&("url"in i||"tiles"in i||w.push(new s.a3(c,i,'Either "url" or "tiles" is required.'))),v){case"vector":case"raster":case"raster-dem":case"raster-array":return w=w.concat(ko({key:c,value:i,valueSpec:p[`source_${v.replace("-","_")}`],style:m.style,styleSpec:p,objectElementValidators:So})),w;case"geojson":if(w=ko({key:c,value:i,valueSpec:p.source_geojson,style:y,styleSpec:p,objectElementValidators:So}),"cluster"in i&&"clusterProperties"in i){if(!s.H(i.clusterProperties))return[new s.V(`${c}.clusterProperties`,i,`object expected, ${s.K(i)} found`)];for(const S in i.clusterProperties){const I=i.clusterProperties[S];if(!Array.isArray(I))return[new s.V(`${c}.clusterProperties.${S}`,I,"array expected")];const[O,D]=I,N=typeof O=="string"?[O,["accumulated"],["get",S]]:O;w.push(...fn({key:`${c}.${S}.map`,value:D,expressionContext:"cluster-map"})),w.push(...fn({key:`${c}.${S}.reduce`,value:N,expressionContext:"cluster-reduce"}))}}return w;case"video":return ko({key:c,value:i,valueSpec:p.source_video,style:y,styleSpec:p});case"image":return ko({key:c,value:i,valueSpec:p.source_image,style:y,styleSpec:p});case"canvas":return[new s.V(c,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Xn({key:`${c}.type`,value:i.type,valueSpec:{values:oo(p)}})}}function oo(m){return m.source.reduce(((i,c)=>{const p=m[c];return p.type.type==="enum"&&(i=i.concat(Object.keys(p.type.values))),i}),[])}function Hs(m){const i=m.value,c=m.styleSpec,p=c.light,y=m.style;if(i===void 0)return[];if(!s.H(i))return[new s.V("light",i,`object expected, ${s.K(i)} found`)];let v=[];for(const w in i){const S=w.match(/^(.*)-transition$/),I=w.match(/^(.*)-use-theme$/);v=v.concat(I&&p[I[1]]?ai({key:w,value:i[w],valueSpec:{type:"string"},style:y,styleSpec:c}):S&&p[S[1]]&&p[S[1]].transition?ai({key:w,value:i[w],valueSpec:c.transition,style:y,styleSpec:c}):p[w]?ai({key:w,value:i[w],valueSpec:p[w],style:y,styleSpec:c}):[new s.V(w,i[w],`unknown property "${w}"`)])}return v}function Ws(m){const i=m.value;if(!i)return[];const c=m.key;if(!s.H(i))return[new s.V(c,i,`object expected, ${s.K(i)} found`)];let p=[];const y=m.styleSpec,v=y["light-3d"],w=m.style,S=m.style.lights;for(const D of["type","id"])if(!(D in i))return p=p.concat([new s.V(c,i,`missing property "${D}"`)]),p;if(!s.a0(i.type))return p=p.concat([new s.V(`${c}.type`,i.type,"string expected")]),p;if(S)for(let D=0;D<m.arrayIndex;D++){const N=s.J(i.type),z=S[D];s.J(z.type)===N&&p.push(new s.V(c,i.id,`duplicate light type "${i.type}", previously defined at line ${z.id.__line__}`))}const I=`properties_light_${i.type}`;if(!(I in y))return p=p.concat([new s.V(`${c}.type`,i,`Invalid light type ${i.type}`)]),p;const O=y[I];for(const D in i)if(D==="properties"){const N=i[D];if(!s.H(N))return p=p.concat([new s.V("properties",N,`object expected, ${s.K(N)} found`)]),p;for(const z in N){const U=z.match(/^(.*)-transition$/),G=z.match(/^(.*)-use-theme$/);p=p.concat(G&&O[G[1]]?ai({key:D,value:N[z],valueSpec:{type:"string"},style:w,styleSpec:y}):U&&O[U[1]]&&O[U[1]].transition?ai({key:D,value:i[D],valueSpec:y.transition,style:w,styleSpec:y}):O[z]?ai({key:z,value:N[z],valueSpec:O[z],style:w,styleSpec:y}):[new s.a3(m.key,N[z],`unknown property "${z}"`)])}}else p=p.concat(v[D]?ai({key:D,value:i[D],valueSpec:v[D],style:w,styleSpec:y}):[new s.a3(D,i[D],`unknown property "${D}"`)]);return p}function so(m){const i=m.value,c=m.key,p=m.style,y=m.styleSpec,v=y.terrain;if(i==null)return[];if(!s.H(i))return[new s.V("terrain",i,`object expected, ${s.K(i)} found`)];let w=[];for(const S in i){const I=S.match(/^(.*)-transition$/),O=S.match(/^(.*)-use-theme$/);w=w.concat(O&&v[O[1]]?ai({key:S,value:i[S],valueSpec:{type:"string"},style:p,styleSpec:y}):I&&v[I[1]]&&v[I[1]].transition?ai({key:S,value:i[S],valueSpec:y.transition,style:p,styleSpec:y}):v[S]?ai({key:S,value:i[S],valueSpec:v[S],style:p,styleSpec:y}):[new s.a3(S,i[S],`unknown property "${S}"`)])}if(i.source)if(s.a0(i.source)){const S=p.sources&&p.sources[i.source],I=S&&s.J(S.type);S?I!=="raster-dem"&&w.push(new s.V(`${c}.source`,i.source,`terrain cannot be used with a source of type ${I}, it only be used with a "raster-dem" source type`)):w.push(new s.V(`${c}.source`,i.source,`source "${i.source}" not found`))}else w.push(new s.V(`${c}.source`,i.source,"source must be a string"));else w.push(new s.V(c,i,'terrain is missing required property "source"'));return w}function Fo(m){const i=m.value,c=m.style,p=m.styleSpec,y=p.fog;if(i===void 0)return[];if(!s.H(i))return[new s.V("fog",i,`object expected, ${s.K(i)} found`)];let v=[];for(const w in i){const S=w.match(/^(.*)-transition$/),I=w.match(/^(.*)-use-theme$/);v=v.concat(I&&y[I[1]]?ai({key:w,value:i[w],valueSpec:{type:"string"},style:c,styleSpec:p}):S&&y[S[1]]&&y[S[1]].transition?ai({key:w,value:i[w],valueSpec:p.transition,style:c,styleSpec:p}):y[w]?ai({key:w,value:i[w],valueSpec:y[w],style:c,styleSpec:p}):[new s.a3(w,i[w],`unknown property "${w}"`)])}return v}const Ma={"*":()=>[],array:qt,boolean:function(m){const i=m.value,c=m.key;return s.$(i)?[]:[new s.V(c,i,`boolean expected, ${s.K(i)} found`)]},number:jt,color:function({key:m,value:i}){return s.a0(i)?s.a1.parseCSSColor(i)===null?[new s.V(m,i,`color expected, "${i}" found`)]:[]:[new s.V(m,i,`color expected, ${s.K(i)} found`)]},enum:Xn,filter:En,function:Rn,layer:Yr,object:ko,source:Vi,model:s.a7,light:Hs,"light-3d":Ws,terrain:so,fog:Fo,string:ho,formatted:function(m){return ho(m).length===0?[]:fn(m)},resolvedImage:function(m){return ho(m).length===0?[]:fn(m)},projection:function(m){const i=m.value,c=m.styleSpec,p=c.projection,y=m.style;if(s.H(i)){let v=[];for(const w in i)v=v.concat(ai({key:w,value:i[w],valueSpec:p[w],style:y,styleSpec:c}));return v}return s.a0(i)?[]:[new s.V("projection",i,`object or string expected, ${s.K(i)} found`)]},import:function(m){const i=m.key,{value:c,styleSpec:p}=m;if(!s.H(c))return[new s.V(i,c,"import must be an object")];const{data:y,...v}=c;Object.defineProperty(v,"__line__",{value:c.__line__,enumerable:!1});let w=ko(Object.assign({},m,{value:v,valueSpec:p.import}));return s.J(v.id)===""&&w.push(new s.V(`${m.key}.id`,v,"import id can't be an empty string")),y&&(w=w.concat(ua(y,p,{key:`${m.key}.data`}))),w},iconset:function(m){const i=m.value,c=m.key,p=m.styleSpec,y=m.style;if(!s.H(i))return[new s.V(c,i,"object expected")];if(!i.type)return[new s.V(c,i,'"type" is required')];const v=s.J(i.type);let w=[];if(w=w.concat(ko({key:c,value:i,valueSpec:p[`iconset_${v}`],style:y,styleSpec:p})),(function(S,I){return!(S!=="source"||!I.source)})(v,i)){const S=y.sources&&y.sources[i.source],I=S&&s.J(S.type);S?I!=="raster-array"&&w.push(new s.V(c,i.source,`iconset cannot be used with a source of type ${String(I)}, it only be used with a "raster-array" source type`)):w.push(new s.V(c,i.source,`source "${i.source}" not found`))}return w}};function ai(m,i=!1){const c=m.value,p=m.valueSpec,y=m.styleSpec;if(p.expression){if(s.a4(s.J(c)))return Rn(m);if(s.Q(s.S(c)))return fn(m)}if(p.type&&Ma[p.type]){const v=Ma[p.type](m);return i===!0&&v.length>0&&Array.isArray(m.value)?fn(m):v}return ko(Object.assign({},m,{valueSpec:p.type?y[p.type]:p}))}function ko(m){const i=m.key,c=m.value,p=m.valueSpec||{},y=m.objectElementValidators||{},v=m.style,w=m.styleSpec;if(!s.H(c))return[new s.V(i,c,`object expected, ${s.K(c)} found`)];let S=[];for(const I in c){const O=I.split(".")[0];let D;y[O]?D=y[O]:p[O]?D=ai:y["*"]?D=y["*"]:p["*"]&&(D=ai),D?S=S.concat(D({key:(i&&`${i}.`)+I,value:c[I],valueSpec:p[O]||p["*"],style:v,styleSpec:w,object:c,objectKey:I},c)):S.push(new s.a3(i,c[I],`unknown property "${I}"`))}for(const I in p)y[I]||p[I].required&&p[I].default===void 0&&c[I]===void 0&&S.push(new s.V(i,c,`missing required property "${I}"`));return S}function bc({key:m,value:i}){const c=ho({key:m,value:i});if(c.length)return c;const p=i;return p.indexOf("{fontstack}")===-1&&c.push(new s.V(m,i,'"glyphs" url must include a "{fontstack}" token')),p.indexOf("{range}")===-1&&c.push(new s.V(m,i,'"glyphs" url must include a "{range}" token')),c}function ua(m,i=s.a6,c={}){return ko({key:c.key||"",value:m,valueSpec:Object.assign(i.$root,{"*":{type:"*"}}),styleSpec:i,style:m,objectElementValidators:{glyphs:bc}})}function Os(m,i=s.a6){return xe(ua(m,i))}const Ul=m=>xe(Vi(m)),da=m=>xe(Hs(m)),xu=m=>xe(Ws(m)),xt=m=>xe(so(m)),Da=m=>xe(Fo(m)),jl=m=>xe((function(i){const c=i.value,p=i.style,y=i.styleSpec,v=y.snow;if(c===void 0)return[];if(!s.H(c))return[new s.V("snow",c,`object expected, ${s.K(c)} found`)];let w=[];for(const S in c){const I=S.match(/^(.*)-transition$/);w=w.concat(I&&v[I[1]]&&v[I[1]].transition?ai({key:S,value:c[S],valueSpec:y.transition,style:p,styleSpec:y}):v[S]?ai({key:S,value:c[S],valueSpec:v[S],style:p,styleSpec:y}):[new s.a3(S,c[S],`unknown property "${S}"`)])}return w})(m)),Gl=m=>xe((function(i){const c=i.value,p=i.style,y=i.styleSpec,v=y.rain;if(c===void 0)return[];if(!s.H(c))return[new s.V("rain",c,`object expected, ${s.K(c)} found`)];let w=[];for(const S in c){const I=S.match(/^(.*)-transition$/);w=w.concat(I&&v[I[1]]&&v[I[1]].transition?ai({key:S,value:c[S],valueSpec:y.transition,style:p,styleSpec:y}):v[S]?ai({key:S,value:c[S],valueSpec:v[S],style:p,styleSpec:y}):[new s.a3(S,c[S],`unknown property "${S}"`)])}return w})(m)),Fe=m=>xe(Yr(m)),Y=m=>xe(En(m)),Q=m=>xe(Gn(m)),ce=m=>xe(hr(m)),Ie=m=>xe(s.a7(m));function xe(m){return m.slice().sort(((i,c)=>i.line&&c.line?i.line-c.line:0))}function be(m,i){let c=!1;if(i&&i.length)for(const p of i)p instanceof s.a3?s.w(p.message):(m.fire(new s.y(new Error(p.message))),c=!0);return c}let tt;class ze extends s.E{constructor(i,c="flat"){super(),this._transitionable=new s.a8(tt||(tt=new s.a9({anchor:new s.aa(s.a6.light.anchor),position:new s.ab(s.a6.light.position),color:new s.aa(s.a6.light.color),intensity:new s.aa(s.a6.light.intensity)}))),this.setLight(i,c),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(i,c,p={}){this._validate(da,i,p)||(this._transitionable.setTransitionOrValue(i),this.id=c)}updateTransitions(i){this._transitioning=this._transitionable.transitioned(i,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(i){this.properties=this._transitioning.possiblyEvaluate(i)}_validate(i,c,p){return(!p||p.validate!==!1)&&be(this,i.call(Os,Object.assign({value:c,style:{glyphs:!0,sprite:!0},styleSpec:s.a6})))}}let nt=class extends s.E{constructor(m,i,c,p,y){super(),this.scope=c,this._transitionable=new s.a8(new s.a9({source:new s.aa(s.a6.terrain.source),exaggeration:new s.aa(s.a6.terrain.exaggeration)}),c,p),this._transitionable.setTransitionOrValue(m,p),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=i,this.worldview=y}get(){return this._transitionable.serialize()}set(m,i){this._transitionable.setTransitionOrValue(m,i)}updateTransitions(m){this._transitioning=this._transitionable.transitioned(m,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(m){this.properties=this._transitioning.possiblyEvaluate(m)}getExaggeration(m){return this._transitioning.possiblyEvaluate(new s.ac(m,{worldview:this.worldview})).get("exaggeration")}getAttenuationRange(){if(!this.isZoomDependent())return null;const m=this._transitionable._values.exaggeration;if(!m)return null;const i=m.value.expression;if(!i)return null;let c=-1,p=-1,y=1;for(const v of i.zoomStops)y=i.evaluate(new s.ac(v,{worldview:this.worldview})),y>.01?(c=v,p=-1):p=v;return y<.01&&c>0&&p>c?[c,p]:null}isZoomDependent(){const m=this._transitionable._values.exaggeration;return m!=null&&m.value!=null&&m.value.expression!=null&&m.value.expression instanceof s.ad}};const Rt=45,gt=65,on=.05;function xn(m,i,c,p){const y=s.ah(Rt,gt,c),[v,w]=zn(m,p);let S=1-Math.min(1,Math.exp((i-v)/(w-v)*-6));return S*=S*S,S=Math.min(1,1.00747*S),S*y*m.alpha}function zn(m,i){const c=.5/Math.tan(.5*i);return[m.range[0]+c,m.range[1]+c]}function lr(m,i,c,p,y){const v=s.af([],[i,c,p],y.mercatorFogMatrix);return xn(m,s.ag(v),y.pitch,y._fov)}function Yn(m,i,c,p,y,v,w){const S=[[c,p,0],[y,p,0],[y,v,0],[c,v,0]];let I=Number.MAX_VALUE,O=-Number.MAX_VALUE;for(const D of S){const N=s.af([],D,i),z=s.ag(N);I=Math.min(I,z),O=Math.max(O,z)}return[xn(m,I,w.pitch,w._fov),xn(m,O,w.pitch,w._fov)]}class fr extends s.E{constructor(i,c,p,y){super();const v=new s.a9({range:new s.aa(s.a6.fog.range),color:new s.aa(s.a6.fog.color),"color-use-theme":new s.aa({type:"string","property-type":"data-constant",default:"default"}),"high-color":new s.aa(s.a6.fog["high-color"]),"high-color-use-theme":new s.aa({type:"string","property-type":"data-constant",default:"default"}),"space-color":new s.aa(s.a6.fog["space-color"]),"space-color-use-theme":new s.aa({type:"string","property-type":"data-constant",default:"default"}),"horizon-blend":new s.aa(s.a6.fog["horizon-blend"]),"star-intensity":new s.aa(s.a6.fog["star-intensity"]),"vertical-range":new s.aa(s.a6.fog["vertical-range"])});this._transitionable=new s.a8(v,p,new Map(y)),this.set(i,y),this._transitioning=this._transitionable.untransitioned(),this._transform=c,this.properties=new s.ai(v),this.scope=p}get state(){const i=this._transform,c=i.projection.name==="globe",p=s.aj(i.zoom),y=this.properties.get("range"),v=[.5,3];return{range:c?[s.ak(v[0],y[0],p),s.ak(v[1],y[1],p)]:y,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(i,c,p={}){if(this._validate(Da,i,p))return;const y=Object.assign({},i);for(const v of Object.keys(s.a6.fog))y[v]===void 0&&(y[v]=s.a6.fog[v].default);this._options=y,this._transitionable.setTransitionOrValue(this._options,c)}getOpacity(i){if(!this._transform.projection.supportsFog)return 0;const c=this.properties&&this.properties.get("color")||1;return(this._transform.projection.name==="globe"?1:s.ah(Rt,gt,i))*c.a}getOpacityAtLatLng(i,c){return this._transform.projection.supportsFog?(function(p,y,v){const w=s.ae.fromLngLat(y),S=v.elevation?v.elevation.getAtPointOrZero(w):0;return lr(p,w.x,w.y,S,v)})(this.state,i,c):0}getOpacityForTile(i){if(!this._transform.projection.supportsFog)return[1,1];const c=this._transform.calculateFogTileMatrix(i.toUnwrapped());return Yn(this.state,c,0,0,s.al,s.al,this._transform)}getOpacityForBounds(i,c,p,y,v){return this._transform.projection.supportsFog?Yn(this.state,i,c,p,y,v,this._transform):[1,1]}getFovAdjustedRange(i){return this._transform.projection.supportsFog?zn(this.state,i):[0,1]}isVisibleOnFrustum(i){if(!this._transform.projection.supportsFog)return!1;const c=[4,5,6,7];for(const p of c){const y=i.points[p];let v;if(y[2]>=0)v=y;else{const w=i.points[p-4];v=s.am(w,y,w[2]/(w[2]-y[2]))}if(lr(this.state,v[0],v[1],0,this._transform)>=on)return!0}return!1}updateConfig(i){this._transitionable.setTransitionOrValue(this._options,new Map(i))}updateTransitions(i){this._transitioning=this._transitionable.transitioned(i,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(i){this.properties=this._transitioning.possiblyEvaluate(i)}_validate(i,c,p){return(!p||p.validate!==!1)&&be(this,i.call(Os,Object.assign({value:c,style:{glyphs:!0,sprite:!0},styleSpec:s.a6})))}}let ti,cr,Hi,to,fo=class extends s.E{constructor(m,i,c,p){super();const y=ti||(ti=new s.a9({density:new s.aa(s.a6.snow.density),intensity:new s.aa(s.a6.snow.intensity),color:new s.aa(s.a6.snow.color),opacity:new s.aa(s.a6.snow.opacity),vignette:new s.aa(s.a6.snow.vignette),"vignette-color":new s.aa(s.a6.snow["vignette-color"]),"center-thinning":new s.aa(s.a6.snow["center-thinning"]),direction:new s.aa(s.a6.snow.direction),"flake-size":new s.aa(s.a6.snow["flake-size"])}));this._transitionable=new s.a8(y,c,new Map(p)),this.set(m,p),this._transitioning=this._transitionable.untransitioned(),this.properties=new s.ai(y),this.scope=c}get state(){const m=this.properties.get("opacity"),i=this.properties.get("color"),c=this.properties.get("direction"),p=s.an(c[0]),y=-Math.max(s.an(c[1]),.01),v=[Math.cos(p)*Math.cos(y),Math.sin(p)*Math.cos(y),Math.sin(y)],w=this.properties.get("vignette"),S=this.properties.get("vignette-color");return S.a=w,{density:this.properties.get("density"),intensity:this.properties.get("intensity"),color:new s.ao(i.r,i.g,i.b,i.a*m),direction:v,centerThinning:this.properties.get("center-thinning"),flakeSize:this.properties.get("flake-size"),vignetteColor:S}}get(){return this._transitionable.serialize()}set(m,i,c={}){if(this._validate(jl,m,c))return;const p=Object.assign({},m);for(const y of Object.keys(s.a6.snow))p[y]===void 0&&(p[y]=s.a6.snow[y].default);this._options=p,this._transitionable.setTransitionOrValue(this._options,i)}updateConfig(m){this._transitionable.setTransitionOrValue(this._options,new Map(m))}updateTransitions(m){this._transitioning=this._transitionable.transitioned(m,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(m){this.properties=this._transitioning.possiblyEvaluate(m)}_validate(m,i,c){return(!c||c.validate!==!1)&&be(this,m.call(Os,Object.assign({value:i,style:{glyphs:!0,sprite:!0},styleSpec:s.a6})))}},Zr=class extends s.E{constructor(m,i,c,p){super();const y=cr||(cr=new s.a9({density:new s.aa(s.a6.rain.density),intensity:new s.aa(s.a6.rain.intensity),color:new s.aa(s.a6.rain.color),opacity:new s.aa(s.a6.rain.opacity),vignette:new s.aa(s.a6.rain.vignette),"vignette-color":new s.aa(s.a6.rain["vignette-color"]),"center-thinning":new s.aa(s.a6.rain["center-thinning"]),direction:new s.aa(s.a6.rain.direction),"droplet-size":new s.aa(s.a6.rain["droplet-size"]),"distortion-strength":new s.aa(s.a6.rain["distortion-strength"])}));this._transitionable=new s.a8(y,c,new Map(p)),this.set(m,p),this._transitioning=this._transitionable.untransitioned(),this.properties=new s.ai(y),this.scope=c}get state(){const m=this.properties.get("opacity"),i=this.properties.get("color"),c=this.properties.get("direction"),p=s.an(c[0]),y=-Math.max(s.an(c[1]),.01),v=[Math.cos(p)*Math.cos(y),Math.sin(p)*Math.cos(y),Math.sin(y)],w=this.properties.get("vignette-color");return w.a=this.properties.get("vignette"),{density:this.properties.get("density"),intensity:this.properties.get("intensity"),color:new s.ao(i.r,i.g,i.b,i.a*m),direction:v,centerThinning:this.properties.get("center-thinning"),dropletSize:this.properties.get("droplet-size"),distortionStrength:this.properties.get("distortion-strength"),vignetteColor:w}}get(){return this._transitionable.serialize()}set(m,i,c={}){if(this._validate(Gl,m,c))return;const p=Object.assign({},m);for(const y of Object.keys(s.a6.rain))p[y]===void 0&&(p[y]=s.a6.rain[y].default);this._options=p,this._transitionable.setTransitionOrValue(this._options,i)}updateConfig(m){this._transitionable.setTransitionOrValue(this._options,new Map(m))}updateTransitions(m){this._transitioning=this._transitionable.transitioned(m,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(m){this.properties=this._transitioning.possiblyEvaluate(m)}_validate(m,i,c){return(!c||c.validate!==!1)&&be(this,m.call(Os,Object.assign({value:i,style:{glyphs:!0,sprite:!0},styleSpec:s.a6})))}};class Sr extends s.E{constructor(i,c,p,y){super(),this.scope=p,this._options=i,this.properties=new s.ai(c),this._transitionable=new s.a8(c,p,new Map(y)),this._transitionable.setTransitionOrValue(i.properties),this._transitioning=this._transitionable.untransitioned()}updateConfig(i){this._transitionable.setTransitionOrValue(this._options.properties,new Map(i))}updateTransitions(i){this._transitioning=this._transitionable.transitioned(i,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(i){this.properties=this._transitioning.possiblyEvaluate(i)}get(){return this._options.properties=this._transitionable.serialize(),this._options}set(i,c){this._options=i,this._transitionable.setTransitionOrValue(i.properties,c)}shadowsEnabled(){return!!this.properties&&this.properties.get("cast-shadows")===!0}}class di{constructor(i,c,p){this.screenBounds=i,this.cameraPoint=p.getCameraPoint(),this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=c,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,p)}static createFromScreenPoints(i,c){let p,y;if(i instanceof s.P||typeof i[0]=="number"){const v=s.P.convert(i);p=[v],y=c.isPointAboveHorizon(v)}else{const v=s.P.convert(i[0]),w=s.P.convert(i[1]),S=v.add(w)._div(2);p=[v,w],y=s.aq(v,w).every((I=>c.isPointAboveHorizon(I)))&&c.isPointAboveHorizon(S)}return new di(p,y,c)}isPointQuery(){return this.screenBounds.length===1}bufferedScreenGeometry(i){return s.aq(this.screenBounds[0],this.screenBounds.length===1?this.screenBounds[0]:this.screenBounds[1],i)}bufferedCameraGeometry(i){const c=this.screenBounds[0],p=this.screenBounds.length===1?this.screenBounds[0].add(new s.P(1,1)):this.screenBounds[1],y=s.aq(c,p,0,!1);return this.cameraPoint.y>p.y&&(this.cameraPoint.x>c.x&&this.cameraPoint.x<p.x?y.splice(3,0,this.cameraPoint):this.cameraPoint.x>=p.x?y[2]=this.cameraPoint:this.cameraPoint.x<=c.x&&(y[3]=this.cameraPoint)),s.ar(y,i)}bufferedCameraGeometryGlobe(i){const c=this.screenBounds[0],p=this.screenBounds.length===1?this.screenBounds[0].add(new s.P(1,1)):this.screenBounds[1],y=s.aq(c,p,i),v=this.cameraPoint.clone();switch(3*((v.y>c.y)+(v.y>p.y))+((v.x>c.x)+(v.x>p.x))){case 0:y[0]=v,y[4]=v.clone();break;case 1:y.splice(1,0,v);break;case 2:y[1]=v;break;case 3:y.splice(4,0,v);break;case 5:y.splice(2,0,v);break;case 6:y[3]=v;break;case 7:y.splice(3,0,v);break;case 8:y[2]=v}return y}containsTile(i,c,p,y=0){const v=i.queryPadding/c._pixelsPerMercatorPixel+1,w=p?this._bufferedCameraMercator(v,c):this._bufferedScreenMercator(v,c);let S=i.tileID.wrap+(w.unwrapped?y:0);const I=w.polygon.map((J=>s.as(i.tileTransform,J,S)));if(!s.at(I,0,0,s.al,s.al))return;S=i.tileID.wrap+(this.screenGeometryMercator.unwrapped?y:0);const O=this.screenGeometryMercator.polygon.map((J=>s.au(i.tileTransform,J,S))),D=O.map((J=>new s.P(J[0],J[1]))),N=c.getFreeCameraOptions().position||new s.ae(0,0,0),z=s.au(i.tileTransform,N,S),U=O.map((J=>{const Z=s.av(J,J,z);return s.aw(Z,Z),new s.ax(z,Z)})),G=s.ay(i,1,c.zoom)*c._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:D,tilespaceRays:U,bufferedTilespaceGeometry:I,bufferedTilespaceBounds:(H=s.az(I),H.min.x=s.aA(H.min.x,0,s.al),H.min.y=s.aA(H.min.y,0,s.al),H.max.x=s.aA(H.max.x,0,s.al),H.max.y=s.aA(H.max.y,0,s.al),H),tile:i,tileID:i.tileID,pixelToTileUnitsFactor:G};var H}_bufferedScreenMercator(i,c){const p=Bo(i);if(this._screenRaycastCache[p])return this._screenRaycastCache[p];{let y;return y=c.projection.name==="globe"?this._projectAndResample(this.bufferedScreenGeometry(i),c):{polygon:this.bufferedScreenGeometry(i).map((v=>c.pointCoordinate3D(v))),unwrapped:!0},this._screenRaycastCache[p]=y,y}}_bufferedCameraMercator(i,c){const p=Bo(i);if(this._cameraRaycastCache[p])return this._cameraRaycastCache[p];{let y;return y=c.projection.name==="globe"?this._projectAndResample(this.bufferedCameraGeometryGlobe(i),c):{polygon:this.bufferedCameraGeometry(i).map((v=>c.pointCoordinate3D(v))),unwrapped:!0},this._cameraRaycastCache[p]=y,y}}_projectAndResample(i,c){const p=(function(v,w){const S=s.aB([],w.pixelMatrix,w.globeMatrix),I=[0,-s.aD,0,1],O=[0,s.aD,0,1],D=[0,0,0,1];s.aC(I,I,S),s.aC(O,O,S),s.aC(D,D,S);const N=new s.P(I[0]/I[3],I[1]/I[3]),z=new s.P(O[0]/O[3],O[1]/O[3]),U=s.aE(v,N)&&I[3]<D[3],G=s.aE(v,z)&&O[3]<D[3];if(!U&&!G)return null;const H=(function(ge,pe,he){for(let _e=1;_e<ge.length;_e++){const Ke=hi(pe.pointCoordinate3D(ge[_e-1]).x),Le=hi(pe.pointCoordinate3D(ge[_e]).x);if(he<0){if(Ke<Le)return{idx:_e,t:-Ke/(Le-1-Ke)}}else if(Le<Ke)return{idx:_e,t:(1-Ke)/(Le+1-Ke)}}return null})(v,w,U?-1:1);if(!H)return null;const{idx:J,t:Z}=H;let ee=J>1?Ri(v.slice(0,J),w):[],ie=J<v.length?Ri(v.slice(J),w):[];ee=ee.map((ge=>new s.P(hi(ge.x),ge.y))),ie=ie.map((ge=>new s.P(hi(ge.x),ge.y)));const se=[...ee];se.length===0&&se.push(ie[ie.length-1]);const me=s.ak(se[se.length-1].y,(ie.length===0?ee[0]:ie[0]).y,Z);let fe;return fe=U?[new s.P(0,me),new s.P(0,0),new s.P(1,0),new s.P(1,me)]:[new s.P(1,me),new s.P(1,1),new s.P(0,1),new s.P(0,me)],se.push(...fe),ie.length===0?se.push(ee[0]):se.push(...ie),{polygon:se.map((ge=>new s.ae(ge.x,ge.y))),unwrapped:!1}})(i,c);if(p)return p;const y=(function(v,w){let S=!1,I=-1/0,O=0;for(let N=0;N<v.length-1;N++)v[N].x>I&&(I=v[N].x,O=N);for(let N=0;N<v.length-1;N++){const z=(O+N)%(v.length-1),U=v[z],G=v[z+1];Math.abs(U.x-G.x)>.5&&(U.x<G.x?(U.x+=1,z===0&&(v[v.length-1].x+=1)):(G.x+=1,z+1===v.length-1&&(v[0].x+=1)),S=!0)}const D=s.aF(w.center.lng);return S&&D<Math.abs(D-1)&&v.forEach((N=>{N.x-=1})),{polygon:v,unwrapped:S}})(Ri(i,c).map((v=>new s.P(hi(v.x),v.y))),c);return{polygon:y.polygon.map((v=>new s.ae(v.x,v.y))),unwrapped:y.unwrapped}}}function Ri(m,i){return s.aG(m,(c=>{const p=i.pointCoordinate3D(c);c.x=p.x,c.y=p.y}),1/256)}function hi(m){return m<0?1+m%1:m%1}function Bo(m){return 100*m|0}function Xo(m,i,c,p,y){const v=function(S,I){if(S)return y(S);if(I){if(m.url&&I.tiles&&m.tiles&&delete m.tiles,I.variants){if(!Array.isArray(I.variants))return y(new Error("variants must be an array"));for(const D of I.variants){if(D==null||typeof D!="object"||D.constructor!==Object)return y(new Error("variant must be an object"));if(!Array.isArray(D.capabilities))return y(new Error("capabilities must be an array"));if(D.capabilities.length===1&&D.capabilities[0]==="meshopt"){I=Object.assign(I,D);break}}}const O=s.aH(Object.assign({},I,m),["tilejson","tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","extra_bounds","scheme","tileSize","encoding","vector_layers","raster_layers","worldview_options","worldview_default","worldview"]);O.tiles=i.canonicalizeTileset(O,m.url),y(null,O)}},w=(function(S,I,O){if(!S)return null;if(!I&&!O)return S;O=O||S.worldview_default;const D=Object.values(S.language||{});if(D.length===0)return null;const N=Object.values(S.worldview||{});if(N.length===0)return null;const z=D.every((G=>G===I)),U=N.every((G=>G===O));return z&&U?S:I in(S.language_options||{})||O in(S.worldview_options||{})?null:S.language_options&&S.worldview_options?S:null})(m.data,c,p);return w?s.o.frame((()=>v(null,w))):m.url?s.m(i.transformRequest(i.normalizeSourceURL(m.url,null,c,p),s.R.Source),v):s.o.frame((()=>{const{data:S,...I}=m;v(null,I)}))}function _s(m,i){const c=Math.pow(2,i.z),p=Math.floor(s.aF(m.getWest())*c),y=Math.floor(s.aJ(m.getNorth())*c),v=Math.ceil(s.aF(m.getEast())*c),w=Math.ceil(s.aJ(m.getSouth())*c);return i.x>=p&&i.x<v&&i.y>=y&&i.y<w}class ha{constructor(i,c,p){this.bounds=i?s.aI.convert(this.validateBounds(i)):null,this.minzoom=c||0,this.maxzoom=p||24}validateBounds(i){return Array.isArray(i)&&i.length===4?[Math.max(-180,i[0]),Math.max(-90,i[1]),Math.min(180,i[2]),Math.min(90,i[3])]:[-180,-90,180,90]}addExtraBounds(i){if(i){this.extraBounds||(this.extraBounds=[]);for(const c of i)this.extraBounds.push(s.aI.convert(this.validateBounds(c)))}}contains(i){if(i.z>this.maxzoom||i.z<this.minzoom||this.bounds&&!_s(this.bounds,i))return!1;if(!this.extraBounds)return!0;for(const c of this.extraBounds)if(_s(c,i))return!0;return!1}static fromTileJSON(i){if(!i.bounds&&!i.extra_bounds)return null;const c=new ha(i.bounds,i.minzoom,i.maxzoom);return c.addExtraBounds(i.extra_bounds),c}}class Ho extends s.E{constructor(i,c,p,y){if(super(),this.id=i,this.dispatcher=p,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,Object.assign(this,s.aH(c,["url","scheme","tileSize","promoteId"])),this._options=Object.assign({type:"vector"},c),this._collectResourceTiming=!!c.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(y),this._tileWorkers={},this._deduped=new s.aK}load(i){this._loaded=!1,this.fire(new s.z("dataloading",{dataType:"source"}));const c=Array.isArray(this.map._language)?this.map._language.join():this.map._language,p=this.map.getWorldview();this._tileJSONRequest=Xo(this._options,this.map._requestManager,c,p,((y,v)=>{if(this._tileJSONRequest=null,this._loaded=!0,y)c&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${c}`),p&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${p}`),this.fire(new s.y(y));else if(v){if(Object.assign(this,v),this.hasWorldviews=!!v.worldview_options,v.worldview_default&&(this.worldviewDefault=v.worldview_default),v.vector_layers){this.vectorLayers=v.vector_layers,this.vectorLayerIds=[],this.localizableLayerIds=new Set;for(const w of v.vector_layers)this.vectorLayerIds.push(w.id),v.worldview&&v.worldview[w.source]&&this.localizableLayerIds.add(w.id)}this.tileBounds=ha.fromTileJSON(v),vr(v.tiles,this.map._requestManager._customAccessToken),this.fire(new s.z("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new s.z("data",{dataType:"source",sourceDataType:"content"}))}i&&i(y)}))}loaded(){return this._loaded}hasTile(i){return!this.tileBounds||this.tileBounds.contains(i.canonical)}onAdd(i){this.map=i,this.load()}reload(){this.cancelTileJSONRequest();const i=s.B(this.id,this.scope);this.load((()=>this.map.style.clearSource(i)))}setTiles(i){return this._options.tiles=i,this.reload(),this}setUrl(i){return this.url=i,this._options.url=i,this.reload(),this}onRemove(i){this.cancelTileJSONRequest()}serialize(){return Object.assign({},this._options)}loadTile(i,c){const p=i.tileID.canonical.url(this.tiles,this.scheme),y=this.map._requestManager.normalizeTileURL(p),v=this.map._requestManager.transformRequest(y,s.R.Tile),w=this.map.style?this.map.style.getLut(this.scope):null,S=w?{image:w.image.clone()}:null,I={request:v,data:void 0,uid:i.uid,tileID:i.tileID,tileZoom:i.tileZoom,zoom:i.tileID.overscaledZ,maxZoom:this.maxzoom,lut:S,tileSize:this.tileSize*i.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,pixelRatio:s.o.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:i.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0,extraShadowCaster:i.isExtraShadowCaster,tessellationStep:this.map._tessellationStep,scaleFactor:this.map.getScaleFactor(),worldview:this.map.getWorldview()||this.worldviewDefault};if(this.hasWorldviews&&s.h(p)&&(I.localizableLayerIds=this.localizableLayerIds),I.request.collectResourceTiming=this._collectResourceTiming,i.actor&&i.state!=="expired")i.state==="loading"?i.reloadCallback=c:i.request=i.actor.send("reloadTile",I,O.bind(this));else if(i.actor=this._tileWorkers[y]=this._tileWorkers[y]||this.dispatcher.getActor(),this.dispatcher.ready)i.request=i.actor.send("loadTile",I,O.bind(this),void 0,!0);else{const D=s.aL.call({deduped:this._deduped},I,((N,z)=>{N||!z?O.call(this,N):(I.data={cacheControl:z.cacheControl,expires:z.expires,rawData:z.rawData.slice(0)},i.actor&&i.actor.send("loadTile",I,O.bind(this),void 0,!0))}),!0);i.request={cancel:D}}function O(D,N){return delete i.request,i.aborted?c(null):D&&D.status!==404?c(D):(N&&N.resourceTiming&&(i.resourceTiming=N.resourceTiming),this.map._refreshExpiredTiles&&N&&i.setExpiryData(N),i.loadVectorData(N,this.map.painter),s.aM(this.dispatcher),c(null),void(i.reloadCallback&&(this.loadTile(i,i.reloadCallback),i.reloadCallback=null)))}}abortTile(i){i.request&&(i.request.cancel(),delete i.request),i.actor&&i.actor.send("abortTile",{uid:i.uid,type:this.type,source:this.id,scope:this.scope})}unloadTile(i,c){i.actor&&i.actor.send("removeTile",{uid:i.uid,type:this.type,source:this.id,scope:this.scope}),i.destroy()}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class Hl extends s.E{constructor(i,c,p,y){super(),this.id=i,this.dispatcher=p,this.setEventedParent(y),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=Object.assign({type:"raster"},c),Object.assign(this,s.aH(c,["url","scheme","tileSize"]))}load(i){this._loaded=!1,this.fire(new s.z("dataloading",{dataType:"source"}));const c=this.map.getWorldview();this._tileJSONRequest=Xo(this._options,this.map._requestManager,null,c,((p,y)=>{this._tileJSONRequest=null,this._loaded=!0,p?this.fire(new s.y(p)):y&&(Object.assign(this,y),y.raster_layers&&(this.rasterLayers=y.raster_layers,this.rasterLayerIds=this.rasterLayers.map((v=>v.id))),this.tileBounds=ha.fromTileJSON(y),vr(y.tiles),this.fire(new s.z("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new s.z("data",{dataType:"source",sourceDataType:"content"}))),i&&i(p)}))}loaded(){return this._loaded}onAdd(i){this.map=i,this.load()}reload(){this.cancelTileJSONRequest();const i=s.B(this.id,this.scope);this.load((()=>this.map.style.clearSource(i)))}setTiles(i){return this._options.tiles=i,this.reload(),this}setUrl(i){return this.url=i,this._options.url=i,this.reload(),this}onRemove(i){this.cancelTileJSONRequest()}serialize(){return Object.assign({},this._options)}hasTile(i){return!this.tileBounds||this.tileBounds.contains(i.canonical)}loadTile(i,c){const p=s.o.devicePixelRatio>=2,y=this.map._requestManager.normalizeTileURL(i.tileID.canonical.url(this.tiles,this.scheme),p,this.tileSize);i.request=s.n(this.map._requestManager.transformRequest(y,s.R.Tile),((v,w,S,I)=>(delete i.request,i.aborted?(i.state="unloaded",c(null)):v?(i.state="errored",c(v)):w?(this.map._refreshExpiredTiles&&i.setExpiryData({cacheControl:S,expires:I}),i.setTexture(w,this.map.painter),i.state="loaded",s.aM(this.dispatcher),void c(null)):c(null))))}abortTile(i,c){i.request&&(i.request.cancel(),delete i.request),c&&c()}unloadTile(i,c){i.texture&&i.texture instanceof s.T?(i.destroy(!0),i.texture&&i.texture instanceof s.T&&this.map.painter.saveTileTexture(i.texture)):i.destroy(),c&&c()}hasTransition(){return!1}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}function pf([m,i],c,p,{scaled:y=!0}={}){const{tileSize:v,buffer:w}=p,{x:S,y:I,z:O}=c;if(!isFinite(S)||!isFinite(I)||!isFinite(O))throw new Error("Invalid MRT header");const D=2**O,N=D*s.aF(m),z=D*s.aJ(i);return(function([U,G],H,{scaled:J=!0}={}){if(!H)throw new Error("bandView is undefined");const{data:Z,tileSize:ee,buffer:ie,offset:se,scale:me,dimension:fe}=H;if(U<-ie||U>ee+ie||G<-ie||G>ee+ie)throw new Error(`Point (${U}, ${G}) out of bounds for tileSize=${ee}, buffer=${ie}`);const ge=(G+ie)*(ee+2*ie)+(U+ie);if(new Uint32Array(Z.buffer)[ge]===4294967295)return null;let pe=[];pe=J?[]:new H.data.constructor(fe);for(let he=0;he<fe;he++)pe[he]=Math.round(1e12*(Z[fe*ge+he]*me+se))/1e12;return pe})([Math.min(Math.max(-w,Math.floor((N-S)*v)),v-1+w),Math.min(Math.max(-w,Math.floor((z-I)*v)),v-1+w)],p,{scaled:y})}class gl extends Hl{constructor(i,c,p,y){super(i,c,p,y),this.type="raster-array",this.maxzoom=22,this.partial=!0,this._loadTilePending={},this._loadTileLoaded={},this._options=Object.assign({type:"raster-array"},c)}triggerRepaint(i){const c=this.map.painter._terrain,p=this.map.style.getSourceCache(this.id);c&&c.enabled&&p&&c._clearRenderCacheForTile(p.id,i.tileID),this.map.triggerRepaint()}loadTile(i,c){const p=this.map._requestManager.normalizeTileURL(i.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize),y=this.map._requestManager.transformRequest(p,s.R.Tile),v={request:y,uid:i.uid,tileID:i.tileID,type:this.type,source:this.id,scope:this.scope,partial:this.partial};i.source=this.id,i.scope=this.scope,i.requestParams=y,i.actor||(i.actor=this.dispatcher.getActor());const w=(S,I,O,D)=>{if(delete i.request,i.aborted)return i.state="unloaded",c(null);if(S)return S.name==="AbortError"?void 0:(i.state="errored",c(S));if(this.map._refreshExpiredTiles&&I&&i.setExpiryData({cacheControl:O,expires:D}),this.partial&&i.state!=="expired")i.state="empty";else if(!this.partial){if(!I)return c(null);i.state="loaded",i._isHeaderLoaded=!0,i._mrt=I}c(null)};i.request=this.partial?i.fetchHeader(void 0,w.bind(this)):i.actor.send("loadTile",v,w.bind(this),void 0,!0)}abortTile(i){i.request&&(i.request.cancel(),delete i.request),i.actor&&i.actor.send("abortTile",{uid:i.uid,type:this.type,source:this.id,scope:this.scope})}unloadTile(i,c){const p=i.texturePerLayer;if(i.flushAllQueues(),p.size){i.destroy(!0);for(const y of p.values())this.map.painter.saveTileTexture(y)}else i.destroy()}prepareTile(i,c,p,y){i._isHeaderLoaded&&(i.state!=="empty"&&(i.state="reloading"),i.fetchBandForRender(c,p,y,((v,w)=>{if(v)return i.state="errored",this.fire(new s.y(v)),void this.triggerRepaint(i);w&&(i._isHeaderLoaded=!0,i.setTexturePerLayer(p,w,this.map.painter),i.state="loaded",this.triggerRepaint(i))})))}getInitialBand(i){if(!this.rasterLayers)return 0;const c=this.rasterLayers.find((({id:v})=>v===i)),p=c&&c.fields,y=p&&p.bands&&p.bands;return y?y[0]:0}getTextureDescriptor(i,c,p){if(!i)return;const y=c.sourceLayer||this.rasterLayerIds&&this.rasterLayerIds[0];if(!y)return;let v=null;c instanceof s.aP?v=c.paint.get("raster-array-band"):c instanceof s.aQ&&(v=c.paint.get("raster-particle-array-band"));const w=v||this.getInitialBand(y);if(w==null)return;if(!i.textureDescriptorPerLayer.get(c.id))return void this.prepareTile(i,y,c.id,w);if(i.updateNeeded(c.id,w)&&!p)return;const S=i.textureDescriptorPerLayer.get(c.id);return Object.assign({},S,{texture:i.texturePerLayer.get(c.id)})}getImages(i,c){const p=new Map;for(const y of i)for(const v of c){const[w,S]=v.split("/"),I=y.getLayer(w);if(!I||!I.hasBand(S)||!I.hasDataForBand(S))continue;const{bytes:O,tileSize:D,buffer:N}=I.getBandView(S),z=D+2*N,U={data:new s.q({width:z,height:z},O),pixelRatio:2,sdf:!1,usvg:!1,version:0};p.set(v,U)}return p}queryRasterArrayValueByBandId(i,c,p){const y=c._mrt;return new Promise((v=>{const w={},S=new Set;for(const[I,O]of Object.entries(y.layers)){if(p.layerName&&I!==p.layerName)continue;const D={};w[I]=D;for(const{bands:N}of O.dataIndex)for(const z of N)p.bands&&!p.bands.includes(z)||(S.add(s.B(I,z)),c.fetchBand(I,null,z,(U=>{s.o.frame((()=>{D[z]=U?null:pf([i.lng,i.lat],y,O.getBandView(z)),S.delete(s.B(I,z)),S.size===0&&v(w)}))}),!1))}S.size===0&&v(w)}))}_loadTileForQuery(i,c){if(this._loadTileLoaded[i.uid])return void c(null,i._mrt);if(this._loadTilePending[i.uid])return void this._loadTilePending[i.uid].push(c);this._loadTilePending[i.uid]=[c];const p=this.map._requestManager.normalizeTileURL(i.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize),y=this.map._requestManager.transformRequest(p,s.R.Tile);i.actor.send("loadTile",{request:y,uid:i.uid,tileID:i.tileID,type:this.type,source:this.id,scope:this.scope,partial:!1},((v,w,S,I)=>v?(this._loadTilePending[i.uid].forEach((O=>O(v,null))),void delete this._loadTilePending[i.uid]):w?(this.map._refreshExpiredTiles&&w&&i.setExpiryData({cacheControl:S,expires:I}),i._mrt=w,i._isHeaderLoaded=!0,i.state="loaded",this._loadTilePending[i.uid].forEach((O=>O(null,w))),this._loadTileLoaded[i.uid]=!0,void delete this._loadTilePending[i.uid]):(this._loadTilePending[i.uid].forEach((O=>O(null,null))),void delete this._loadTilePending[i.uid])),void 0,!0)}queryRasterArrayValueByAllBands(i,c,p){return new Promise(((y,v)=>{this._loadTileForQuery(c,((w,S)=>{w?v(w):y(S?this.queryRasterArrayValueByBandId(i,c,p):null)}))}))}queryRasterArrayValue(i,c){const p=s.aR.convert(i),y=this.findLoadedParent(p);return y&&y._mrt?c.bands||!this.partial?this.queryRasterArrayValueByBandId(p,y,c):this.queryRasterArrayValueByAllBands(p,y,c):Promise.resolve(null)}findLoadedParent(i){const c=s.ae.fromLngLat(i,this.map.transform.tileSize),p=this.maxzoom+1,y=1<<p,v=Math.floor(c.x),w=Math.floor((c.x-v)*y),S=Math.floor(c.y*y),I=this.map.style.getSourceCache(this.id),O=new s.aO(p,v,p,w,S);return I.findLoadedParent(O,this.minzoom)}}const xc={vector:Ho,raster:Hl,"raster-dem":class extends Hl{constructor(m,i,c,p){super(m,i,c,p),this.type="raster-dem",this.maxzoom=22,this._options=Object.assign({type:"raster-dem"},i),this.encoding=i.encoding||"mapbox"}loadTile(m,i){const c=this.map._requestManager.normalizeTileURL(m.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function p(y,v){y&&(m.state="errored",i(y)),v&&(m.dem=v,m.dem.onDeserialize(),m.needsHillshadePrepare=!0,m.needsDEMTextureUpload=!0,m.state="loaded",i(null))}m.request=s.n(this.map._requestManager.transformRequest(c,s.R.Tile),(function(y,v,w,S){if(delete m.request,m.aborted)m.state="unloaded",i(null);else if(y)m.state="errored",i(y);else if(v){this.map._refreshExpiredTiles&&m.setExpiryData({cacheControl:w,expires:S});const I=ImageBitmap&&v instanceof ImageBitmap&&s.r(),O=1-(v.width-s.aN(v.width))/2;O<1||m.neighboringTiles||(m.neighboringTiles=this._getNeighboringTiles(m.tileID));const D=I?v:s.o.getImageData(v,O),N={uid:m.uid,tileID:m.tileID,source:this.id,type:this.type,scope:this.scope,rawImageData:D,encoding:this.encoding,padding:O};m.actor&&m.state!=="expired"||(m.actor=this.dispatcher.getActor(),m.actor.send("loadTile",N,p.bind(this),void 0,!0))}}).bind(this))}_getNeighboringTiles(m){const i=m.canonical,c=Math.pow(2,i.z),p=(i.x-1+c)%c,y=i.x===0?m.wrap-1:m.wrap,v=(i.x+1+c)%c,w=i.x+1===c?m.wrap+1:m.wrap,S={};return S[new s.aO(m.overscaledZ,y,i.z,p,i.y).key]={backfilled:!1},S[new s.aO(m.overscaledZ,w,i.z,v,i.y).key]={backfilled:!1},i.y>0&&(S[new s.aO(m.overscaledZ,y,i.z,p,i.y-1).key]={backfilled:!1},S[new s.aO(m.overscaledZ,m.wrap,i.z,i.x,i.y-1).key]={backfilled:!1},S[new s.aO(m.overscaledZ,w,i.z,v,i.y-1).key]={backfilled:!1}),i.y+1<c&&(S[new s.aO(m.overscaledZ,y,i.z,p,i.y+1).key]={backfilled:!1},S[new s.aO(m.overscaledZ,m.wrap,i.z,i.x,i.y+1).key]={backfilled:!1},S[new s.aO(m.overscaledZ,w,i.z,v,i.y+1).key]={backfilled:!1}),S}},"raster-array":gl,geojson:class extends s.E{constructor(m,i,c,p){super(),this.id=m,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=c.getActor(),this.setEventedParent(p),this._data=i.data,this._options=Object.assign({},i),this._collectResourceTiming=i.collectResourceTiming,i.maxzoom!==void 0&&(this.maxzoom=i.maxzoom),i.minzoom!==void 0&&(this.minzoom=i.minzoom),i.type&&(this.type=i.type),i.attribution&&(this.attribution=i.attribution),this.promoteId=i.promoteId;const y=s.al/this.tileSize;this.workerOptions=Object.assign({source:this.id,scope:this.scope,cluster:i.cluster||!1,geojsonVtOptions:{buffer:(i.buffer!==void 0?i.buffer:128)*y,tolerance:(i.tolerance!==void 0?i.tolerance:.375)*y,extent:s.al,maxZoom:this.maxzoom,lineMetrics:i.lineMetrics||!1,generateId:i.generateId||!1},superclusterOptions:{maxZoom:i.clusterMaxZoom!==void 0?i.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,i.clusterMinPoints||2),extent:s.al,radius:(i.clusterRadius!==void 0?i.clusterRadius:50)*y,log:!1,generateId:i.generateId||!1},clusterProperties:i.clusterProperties,filter:i.filter,dynamic:i.dynamic},i.workerOptions)}onAdd(m){this.map=m,this.setData(this._data)}setData(m){return this._data=m,this._updateWorkerData(),this}updateData(m){if(!this._options.dynamic)return this.fire(new s.y(new Error("Can't call updateData on a GeoJSON source with dynamic set to false.")));if(typeof m!="string"&&(m.type==="Feature"&&(m={type:"FeatureCollection",features:[m]}),m.type!=="FeatureCollection"))return this.fire(new s.y(new Error("Data to update should be a feature or a feature collection.")));if(this._coalesce&&typeof m!="string"&&typeof this._data!="string"&&this._data.type==="FeatureCollection"){const i=new Map;for(const c of this._data.features)i.set(c.id,c);for(const c of m.features)i.set(c.id,c);this._data.features=[...i.values()]}else this._data=m;return this._updateWorkerData(!0),this}getClusterExpansionZoom(m,i){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:m,source:this.id,scope:this.scope},i),this}getClusterChildren(m,i){return this.actor.send("geojson.getClusterChildren",{clusterId:m,source:this.id,scope:this.scope},i),this}getClusterLeaves(m,i,c,p){return this.actor.send("geojson.getClusterLeaves",{source:this.id,scope:this.scope,clusterId:m,limit:i,offset:c},p),this}_updateWorkerData(m=!1){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new s.z("dataloading",{dataType:"source"})),this._loaded=!1;const i=Object.assign({append:m},this.workerOptions);i.scope=this.scope;const c=this._data;typeof c=="string"?(i.request=this.map._requestManager.transformRequest(s.o.resolveURL(c),s.R.Source),i.request.collectResourceTiming=this._collectResourceTiming):i.data=JSON.stringify(c),this._pendingLoad=this.actor.send(`${this.type}.loadData`,i,((p,y)=>{if(this._loaded=!0,this._pendingLoad=null,p)this.fire(new s.y(p));else{const v={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&y&&y.resourceTiming&&y.resourceTiming[this.id]&&(v.resourceTiming=y.resourceTiming[this.id]),m&&(this._partialReload=!0),this.fire(new s.z("data",v)),this._partialReload=!1,this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(m),this._coalesce=!1)}))}loaded(){return this._loaded}reload(){const m=s.B(this.id,this.scope);this.map.style.clearSource(m),this._updateWorkerData()}loadTile(m,i){const c=m.actor?"reloadTile":"loadTile";m.actor=this.actor;const p=this.map.style?this.map.style.getLut(this.scope):null,y=p?{image:p.image.clone()}:null,v=this._partialReload,w={type:this.type,uid:m.uid,tileID:m.tileID,tileZoom:m.tileZoom,zoom:m.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,lut:y,scope:this.scope,pixelRatio:s.o.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,brightness:this.map.style&&this.map.style.getBrightness()||0,extraShadowCaster:m.isExtraShadowCaster,scaleFactor:this.map.getScaleFactor(),partial:v,worldview:this.map.getWorldview()};m.request=this.actor.send(c,w,((S,I)=>v&&!I?(m.state="loaded",i(null)):(delete m.request,m.destroy(),m.aborted?i(null):S?i(S):(m.loadVectorData(I,this.map.painter,c==="reloadTile"),i(null)))),void 0,c==="loadTile")}abortTile(m){m.request&&(m.request.cancel(),delete m.request),m.aborted=!0}unloadTile(m,i){this.actor.send("removeTile",{uid:m.uid,type:this.type,source:this.id,scope:this.scope}),m.destroy()}onRemove(m){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return Object.assign({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends s.aS{constructor(m,i,c,p){super(m,i,c,p),this.roundZoom=!0,this.type="video",this.options=i}load(){this._loaded=!1;const m=this.options;this.urls=[];for(const i of m.urls)this.urls.push(this.map._requestManager.transformRequest(i,s.R.Source).url);s.aT(this.urls,((i,c)=>{this._loaded=!0,i?this.fire(new s.y(i)):c&&(this.video=c,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",(()=>{this.map.triggerRepaint()})),this.map&&this.video.play(),this._finishLoading())}))}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(m){if(this.video){const i=this.video.seekable;m<i.start(0)||m>i.end(0)?this.fire(new s.y(new s.V(`sources.${this.id}`,null,`Playback for this video can be set only between the ${i.start(0)} and ${i.end(0)}-second mark.`))):this.video.currentTime=m}}getVideo(){return this.video}onAdd(m){this.map||(this.map=m,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const m=this.map.painter.context,i=m.gl;this.texture?this.video.paused||(this.texture.bind(i.LINEAR,i.CLAMP_TO_EDGE),i.texSubImage2D(i.TEXTURE_2D,0,0,0,i.RGBA,i.UNSIGNED_BYTE,this.video)):(this.texture=new s.T(m,this.video,i.RGBA8),this.texture.bind(i.LINEAR,i.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(m)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:s.aS,model:class extends s.E{constructor(m,i,c,p){super(),this.id=m,this.type="model",this.models=[],this._loaded=!1,this._options=i}load(){const m=[];for(const i in this._options.models){const c=this._options.models[i],p=s.aV(this.map._requestManager.transformRequest(c.uri,s.R.Model).url).then((y=>{if(!y)return;const v=s.aW(y),w=new s.aX(i,c.position,c.orientation,v);w.computeBoundsAndApplyParent(),this.models.push(w)})).catch((y=>{this.fire(new s.y(new Error(`Could not load model ${i} from ${c.uri}: ${y.message}`)))}));m.push(p)}Promise.allSettled(m).then((()=>{this._loaded=!0,this.fire(new s.z("data",{dataType:"source",sourceDataType:"metadata"}))})).catch((i=>{this._loaded=!0,this.fire(new s.y(new Error(`Could not load models: ${i.message}`)))}))}onAdd(m){this.map=m,this.load()}hasTransition(){return!1}loaded(){return this._loaded}getModels(){return this.models}loadTile(m,i){}serialize(){return this._options}},"batched-model":class extends s.E{constructor(m,i,c,p){super(),this.type="batched-model",this.id=m,this.tileSize=512,this._options=i,this.tiles=this._options.tiles,this.maxzoom=i.maxzoom||19,this.minzoom=i.minzoom||0,this.roundZoom=!0,this.usedInConflation=!0,this.dispatcher=c,this.reparseOverscaled=!1,this.scheme="xyz",this._loaded=!1,this.setEventedParent(p)}onAdd(m){this.map=m,this.load()}reload(){this.cancelTileJSONRequest();const m=s.B(this.id,this.scope);this.load((()=>this.map.style.clearSource(m)))}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}load(m){this._loaded=!1,this.fire(new s.z("dataloading",{dataType:"source"}));const i=Array.isArray(this.map._language)?this.map._language.join():this.map._language,c=this.map.getWorldview();this._tileJSONRequest=Xo(this._options,this.map._requestManager,i,c,((p,y)=>{this._tileJSONRequest=null,this._loaded=!0,p?(i&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${i}`),c&&c.length!==2&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${c}`),this.fire(new s.y(p))):y&&(Object.assign(this,y),y.bounds&&(this.tileBounds=new ha(y.bounds,this.minzoom,this.maxzoom)),vr(y.tiles,this.map._requestManager._customAccessToken),this.fire(new s.z("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new s.z("data",{dataType:"source",sourceDataType:"content"}))),m&&m(p)}))}hasTransition(){return!1}hasTile(m){return!this.tileBounds||this.tileBounds.contains(m.canonical)}loaded(){return this._loaded}loadTile(m,i){const c=this.map._requestManager.normalizeTileURL(m.tileID.canonical.url(this.tiles,this.scheme)),p={request:this.map._requestManager.transformRequest(c,s.R.Tile),data:void 0,uid:m.uid,tileID:m.tileID,tileZoom:m.tileZoom,zoom:m.tileID.overscaledZ,tileSize:this.tileSize*m.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,showCollisionBoxes:this.map.showCollisionBoxes,isSymbolTile:m.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0,pixelRatio:s.o.devicePixelRatio,promoteId:this.promoteId};if(m.actor&&m.state!=="expired")if(m.state==="loading")m.reloadCallback=i;else{if(m.buckets){const v=Object.values(m.buckets);for(const w of v)w.dirty=!0;return void(m.state="loaded")}m.request=m.actor.send("reloadTile",p,y.bind(this))}else m.actor=this.dispatcher.getActor(),m.request=m.actor.send("loadTile",p,y.bind(this),void 0,!0);function y(v,w){return m.aborted?i(null):v&&v.status!==404?i(v):(this.map._refreshExpiredTiles&&w&&m.setExpiryData(w),m.loadModelData(w,this.map.painter),m.state="loaded",void i(null))}}serialize(){return Object.assign({},this._options)}},canvas:class extends s.aS{constructor(m,i,c,p){super(m,i,c,p),i.coordinates?Array.isArray(i.coordinates)&&i.coordinates.length===4&&!i.coordinates.some((y=>!Array.isArray(y)||y.length!==2||y.some((v=>typeof v!="number"))))||this.fire(new s.y(new s.V(`sources.${m}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new s.y(new s.V(`sources.${m}`,null,'missing required property "coordinates"'))),i.animate&&typeof i.animate!="boolean"&&this.fire(new s.y(new s.V(`sources.${m}`,null,'optional "animate" property must be a boolean value'))),i.canvas?typeof i.canvas=="string"||i.canvas instanceof HTMLCanvasElement||this.fire(new s.y(new s.V(`sources.${m}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new s.y(new s.V(`sources.${m}`,null,'missing required property "canvas"'))),this.options=i,this.animate=i.animate===void 0||i.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new s.y(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(m){this.map=m,this.load(),this.canvas&&this.animate&&this.play()}onRemove(m){this.pause()}prepare(){let m=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,m=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,m=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const i=this.map.painter.context;this.texture?!m&&!this._playing||this.texture instanceof s.aU||this.texture.update(this.canvas,{premultiply:!0}):this.texture=new s.T(i,this.canvas,i.gl.RGBA8,{premultiply:!0}),this._prepareData(i)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const m of[this.canvas.width,this.canvas.height])if(isNaN(m)||m<=0)return!0;return!1}},custom:class extends s.E{constructor(m,i,c,p){super(),this.id=m,this.type="custom",this._dataType="raster",this._dispatcher=c,this._implementation=i,this.setEventedParent(p),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new s.y(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new s.y(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new ha(this._implementation.bounds,this.minzoom,this.maxzoom)),i.update=this._update.bind(this),i.clearTiles=this._clearTiles.bind(this),i.coveringTiles=this._coveringTiles.bind(this),Object.assign(this,s.aH(i,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return s.aH(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new s.z("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new s.z("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(m){this.map=m,this._loaded=!1,this.fire(new s.z("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(m),this.load()}onRemove(m){this._implementation.onRemove&&this._implementation.onRemove(m)}hasTile(m){if(this._implementation.hasTile){const{x:i,y:c,z:p}=m.canonical;return this._implementation.hasTile({x:i,y:c,z:p})}return!this.tileBounds||this.tileBounds.contains(m.canonical)}loadTile(m,i){const{x:c,y:p,z:y}=m.tileID.canonical,v=new AbortController;m.request=Promise.resolve(this._implementation.loadTile({x:c,y:p,z:y},{signal:v.signal})).then((function(w){return delete m.request,m.aborted?(m.state="unloaded",i(null)):w===void 0?(m.state="errored",i(null)):w===null?(this.loadTileData(m,{width:this.tileSize,height:this.tileSize,data:null}),m.state="loaded",i(null)):(function(S){return S instanceof ImageData||S instanceof HTMLCanvasElement||S instanceof ImageBitmap||S instanceof HTMLImageElement})(w)?(this.loadTileData(m,w),m.state="loaded",void i(null)):(m.state="errored",i(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`)))}).bind(this)).catch((w=>{w.name!=="AbortError"&&(m.state="errored",i(w))})),m.request.cancel=()=>v.abort()}loadTileData(m,i){m.setTexture(i,this.map.painter)}unloadTile(m,i){if(m.texture&&m.texture instanceof s.T?(m.destroy(!0),m.texture&&m.texture instanceof s.T&&this.map.painter.saveTileTexture(m.texture)):m.destroy(),this._implementation.unloadTile){const{x:c,y:p,z:y}=m.tileID.canonical;this._implementation.unloadTile({x:c,y:p,z:y})}i&&i()}abortTile(m,i){m.request&&m.request.cancel&&(m.request.cancel(),delete m.request),i&&i()}hasTransition(){return!1}_coveringTiles(){return this.map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map((m=>({x:m.canonical.x,y:m.canonical.y,z:m.canonical.z})))}_clearTiles(){const m=s.B(this.id,this.scope);this.map.style.clearSource(m)}_update(){this.fire(new s.z("data",{dataType:"source",sourceDataType:"content"}))}}},wc=function(m,i,c,p){const y=new xc[i.type](m,i,c,p);if(y.id!==m)throw new Error(`Expected Source id to be ${m} instead of ${y.id}`);return s.aY(["load","abort","unload","serialize","prepare"],y),y};function Tc(m,i,c=""){return`${c}:${i.id||""}:${i.layer.id}:${(function(p){if("layerId"in p)return`layer:${p.layerId}`;{const{featuresetId:y,importId:v}=p;return`featureset:${y}${v?`:import:${v}`:""}`}})(m.target)}`}function _l(m,i,c,p=""){if(m.uniqueFeatureID){const y=Tc(m,i,p);if(c.has(y))return!0;c.add(y)}return!1}function fa(m,i,c,p,y=!1){const v=i.sourceCache.transform,w=i.sourceCache.tilesIn(m,i.has3DLayers,y);w.sort(Sc);const S=[];for(const I of w){const O=I.tile.queryRenderedFeatures(i,I,c,p,v,y);Object.keys(O).length&&S.push({wrappedTileID:I.tile.tileID.wrapped().key,queryResults:O})}return S.length===0?{}:(function(I){const O={},D={};for(const N of I){const z=N.queryResults,U=N.wrappedTileID,G=D[U]=D[U]||{};for(const H in z){const J=z[H],Z=G[H]=G[H]||{},ee=O[H]=O[H]||[];for(const ie of J)Z[ie.featureIndex]||(Z[ie.featureIndex]=!0,ee.push(ie))}}return O})(S)}function pa(m,i,c,p,y,v){const w={},S=p.queryRenderedSymbols(m),I=[];for(const O of Object.keys(S).map(Number))I.push(y[O]);I.sort(Sc);for(const O of I){const D=O.featureIndex.lookupSymbolFeatures(S[O.bucketInstanceId],O.bucketIndex,O.sourceLayerIndex,i,c,v);for(const N in D){const z=w[N]=w[N]||[],U=D[N];U.sort(((G,H)=>{const J=O.featureSortOrder;if(J){const Z=J.indexOf(G.featureIndex);return J.indexOf(H.featureIndex)-Z}return H.featureIndex-G.featureIndex}));for(const G of U)z.push(G)}}return w}function Ms(m,i){const c=m.getRenderableIds().map((v=>m.getTileByID(v))),p=[],y={};for(let v=0;v<c.length;v++){const w=c[v],S=w.tileID.canonical.key;y[S]||(y[S]=!0,w.querySourceFeatures(p,i))}return p}function Sc(m,i){const c=m.tileID,p=i.tileID;return c.overscaledZ-p.overscaledZ||c.canonical.y-p.canonical.y||c.wrap-p.wrap||c.canonical.x-p.canonical.x}function wu(m,i){const c={};if(!i)return c;for(const p of m){const y=p.layerIds.map((v=>i.getLayer(v))).filter(Boolean);if(y.length!==0){p.layers=y,p.stateDependentLayerIds&&(p.stateDependentLayers=p.stateDependentLayerIds.map((v=>y.filter((w=>w.id===v))[0])));for(const v of y)c[v.fqid]=p}}return c}const li=32,ys=33,Ds=new Uint16Array(8184);for(let m=0;m<2046;m++){let i=m+2,c=0,p=0,y=0,v=0,w=0,S=0;for(1&i?y=v=w=li:c=p=S=li;(i>>=1)>1;){const O=c+y>>1,D=p+v>>1;1&i?(y=c,v=p,c=w,p=S):(c=y,p=v,y=w,v=S),w=O,S=D}const I=4*m;Ds[I+0]=c,Ds[I+1]=p,Ds[I+2]=y,Ds[I+3]=v}const cs=new Uint16Array(2178),ts=new Uint8Array(1089),yl=new Uint16Array(1089);function mf(m){return m===0?-.03125:m===32?.03125:0}const Tu={type:2,extent:s.al,loadGeometry:()=>[[new s.P(0,0),new s.P(s.al+1,0),new s.P(s.al+1,s.al+1),new s.P(0,s.al+1),new s.P(0,0)]]};class vl{constructor(i,c,p,y,v,w){this.tileID=i,this.uid=s.b2(),this.uses=0,this.tileSize=c,this.tileZoom=p,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=v,y&&y.style&&(this._lastUpdatedBrightness=y.style.getBrightness()),this.expiredRequestCount=0,this.state="loading",y&&y.transform&&(this.projection=y.transform.projection),this.worldview=w}registerFadeDuration(i){const c=i+this.timeAdded;c<s.o.now()||this.fadeEndTime&&c<this.fadeEndTime||(this.fadeEndTime=c)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}get tileTransform(){return this._tileTransform||(this._tileTransform=s.aZ(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(i,c,p){if(this.unloadVectorData(),this.state="loaded",i){i.featureIndex&&(this.latestFeatureIndex=i.featureIndex,i.rawTileData?(this.latestRawTileData=i.rawTileData,this.latestFeatureIndex.rawTileData=i.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=i.collisionBoxArray,this.buckets=wu(i.buckets,c.style),this.hasSymbolBuckets=!1;for(const y in this.buckets){const v=this.buckets[y];if(v instanceof s.b4){if(this.hasSymbolBuckets=!0,!p)break;v.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const y in this.buckets){const v=this.buckets[y];if(v instanceof s.b4&&v.hasRTLText){this.hasRTLText=!0,s.b5();break}}this.queryPadding=0;for(const y in this.buckets){const v=this.buckets[y],w=c.style.getOwnLayer(y);if(!w)continue;const S=w.queryRadius(v);this.queryPadding=Math.max(this.queryPadding,S)}i.imageAtlas&&(this.imageAtlas=i.imageAtlas),i.glyphAtlasImage&&(this.glyphAtlasImage=i.glyphAtlasImage),i.lineAtlas&&(this.lineAtlas=i.lineAtlas),this._lastUpdatedBrightness=i.brightness}else this.collisionBoxArray=new s.b3}unloadVectorData(){if(this.hasData()){for(const i in this.buckets)this.buckets[i].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}loadModelData(i,c,p){i&&(i.resourceTiming&&(this.resourceTiming=i.resourceTiming),this.buckets=Object.assign({},this.buckets,wu(i.buckets,c.style)),i.featureIndex&&(this.latestFeatureIndex=i.featureIndex))}getBucket(i){return this.buckets[i.fqid]}upload(i){for(const y in this.buckets){const v=this.buckets[y];v.uploadPending()&&v.upload(i)}const c=i.gl,p=this.imageAtlas;p&&!p.uploaded&&(this.imageAtlasTexture=new s.T(i,p.image,c.RGBA8,{useMipmap:!!p.patternPositions.size}),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new s.T(i,this.glyphAtlasImage,c.R8),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new s.T(i,this.lineAtlas.image,c.R8),this.lineAtlas.uploaded=!0)}prepare(i,c,p){if(this.imageAtlas&&this.imageAtlasTexture&&this.imageAtlas.patchUpdatedImages(i,this.imageAtlasTexture,p),!c||!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData)return;const y=c.style.getBrightness();(this._lastUpdatedBrightness||y)&&(this._lastUpdatedBrightness&&y&&Math.abs(this._lastUpdatedBrightness-y)<.001||(this.updateBuckets(c,this._lastUpdatedBrightness!==y),this._lastUpdatedBrightness=y))}queryRenderedFeatures(i,c,p,y,v,w){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData&&!this.latestFeatureIndex.is3DTile)return{};const S=(function(I,O){const D=s.bq([],[.5*I.width,.5*-I.height,1]);return s.br(D,D,[1,-1,0]),s.aB(D,D,I.calculateProjMatrix(O.toUnwrapped())),Float32Array.from(D)})(v,this.tileID);return this.latestFeatureIndex.query(i,{tilespaceGeometry:c,pixelPosMatrix:S,transform:y,availableImages:p,tileTransform:this.tileTransform,worldview:this.worldview})}querySourceFeatures(i,c){const p=this.latestFeatureIndex;if(!p||!p.rawTileData)return;const y=p.loadVTLayers(),v=c?c.sourceLayer:"",w=y._geojsonTileLayer||y[v];if(!w)return;const S=s.b6(c&&c.filter),{z:I,x:O,y:D}=this.tileID.canonical,N={z:I,x:O,y:D};for(let z=0;z<w.length;z++){const U=w.feature(z);if(S.needGeometry){const J=s.b7(U,!0);if(!S.filter(new s.ac(this.tileID.overscaledZ,{worldview:this.worldview}),J,this.tileID.canonical))continue}else if(!S.filter(new s.ac(this.tileID.overscaledZ,{worldview:this.worldview}),U))continue;const G=p.getId(U,v),H=new s.b8(U,I,O,D,G);H.tile=N,i.push(H)}}loaded(){return this.state==="loaded"||this.state==="errored"}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return!!this.imageAtlas&&!!this.imageAtlas.patternPositions.size}setExpiryData(i){const c=this.expirationTime;if(i.cacheControl){const p=s.b9(i.cacheControl);p["max-age"]&&(this.expirationTime=Date.now()+1e3*p["max-age"])}else i.expires&&(this.expirationTime=new Date(i.expires).getTime());if(this.expirationTime){const p=Date.now();let y=!1;if(this.expirationTime>p)y=!1;else if(c)if(this.expirationTime<c)y=!0;else{const v=this.expirationTime-c;v?this.expirationTime=p+Math.max(v,3e4):y=!0}else y=!0;y?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}refreshFeatureState(i){this.latestFeatureIndex&&(this.latestFeatureIndex.rawTileData||this.latestFeatureIndex.is3DTile)&&i&&this.updateBuckets(i)}updateBuckets(i,c){if(!this.latestFeatureIndex||!i.style)return;const p=this.latestFeatureIndex.loadVTLayers(),y=i.style.listImages(),v=i.style.getBrightness();for(const w in this.buckets){if(!i.style.hasLayer(w))continue;const S=this.buckets[w],I=S.layers[0],O=I.sourceLayer||"_geojsonTileLayer",D=p[O],N=i.style.getLayerSourceCache(I);let z={};N&&(z=N._state.getState(O,void 0));const U=this.imageAtlas?Object.fromEntries(this.imageAtlas.patternPositions):{},G=Object.keys(z).length>0&&!c;(G&&S.stateDependentLayers.length!==0||c)&&S.update(z,D,y,U,G?S.stateDependentLayers:S.layers,c,v),(S instanceof s.ba||S instanceof s.bb)&&i._terrain&&i._terrain.enabled&&N&&S.uploadPending()&&i._terrain._clearRenderCacheForTile(N.id,this.tileID);const H=i&&i.style&&i.style.getOwnLayer(w);H&&(this.queryPadding=Math.max(this.queryPadding,H.queryRadius(S)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<s.o.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(i){this.symbolFadeHoldUntil=s.o.now()+i}setTexture(i,c){const p=c.context,y=p.gl;this.texture=this.texture||c.getTileTexture(i.width),this.texture&&this.texture instanceof s.T?this.texture.update(i):(this.texture=new s.T(p,i,y.RGBA8,{useMipmap:!0}),this.texture.bind(y.LINEAR,y.CLAMP_TO_EDGE))}setDependencies(i,c){const p={};for(const y of c)p[y]=!0;this.dependencies[i]=p}hasDependency(i,c){for(const p of i){const y=this.dependencies[p];if(y){for(const v of c)if(y[v])return!0}}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(i,c){if(!c||c.name==="mercator"||this._tileDebugBuffer)return;const p=s.bc(Tu,this.tileID.canonical,this.tileTransform)[0],y=new s.bd,v=new s.be;for(let w=0;w<p.length;w++){const{x:S,y:I}=p[w];y.emplaceBack(S,I),v.emplaceBack(w)}v.emplaceBack(0),this._tileDebugIndexBuffer=i.createIndexBuffer(v),this._tileDebugBuffer=i.createVertexBuffer(y,s.bf.members),this._tileDebugSegments=s.bg.simpleSegment(0,0,y.length,v.length)}_makeTileBoundsBuffers(i,c){if(this._tileBoundsBuffer||!c||c.name==="mercator")return;const p=s.bc(Tu,this.tileID.canonical,this.tileTransform)[0];let y,v;if(this.isRaster){const w=(function(S,I){const O=s.aZ(S,I),D=Math.pow(2,S.z);for(let J=0;J<ys;J++)for(let Z=0;Z<ys;Z++){const ee=s.a_((S.x+(Z+mf(Z))/li)/D),ie=s.a$((S.y+(J+mf(J))/li)/D),se=I.project(ee,ie),me=J*ys+Z;cs[2*me+0]=Math.round((se.x*O.scale-O.x)*s.al),cs[2*me+1]=Math.round((se.y*O.scale-O.y)*s.al)}ts.fill(0),yl.fill(0);for(let J=2045;J>=0;J--){const Z=4*J,ee=Ds[Z+0],ie=Ds[Z+1],se=Ds[Z+2],me=Ds[Z+3],fe=ee+se>>1,ge=ie+me>>1,pe=fe+ge-ie,he=ge+ee-fe,_e=ie*ys+ee,Ke=me*ys+se,Le=ge*ys+fe,st=Math.hypot((cs[2*_e+0]+cs[2*Ke+0])/2-cs[2*Le+0],(cs[2*_e+1]+cs[2*Ke+1])/2-cs[2*Le+1])>=16;ts[Le]=ts[Le]||(st?1:0),J<1022&&(ts[Le]=ts[Le]||ts[(ie+he>>1)*ys+(ee+pe>>1)]||ts[(me+he>>1)*ys+(se+pe>>1)])}const N=new s.b0,z=new s.b1;let U=0;function G(J,Z){const ee=Z*ys+J;return yl[ee]===0&&(N.emplaceBack(cs[2*ee+0],cs[2*ee+1],J*s.al/li,Z*s.al/li),yl[ee]=++U),yl[ee]-1}function H(J,Z,ee,ie,se,me){const fe=J+ee>>1,ge=Z+ie>>1;if(Math.abs(J-se)+Math.abs(Z-me)>1&&ts[ge*ys+fe])H(se,me,J,Z,fe,ge),H(ee,ie,se,me,fe,ge);else{const pe=G(J,Z),he=G(ee,ie),_e=G(se,me);z.emplaceBack(pe,he,_e)}}return H(0,0,li,li,li,0),H(li,li,0,0,0,li),{vertices:N,indices:z}})(this.tileID.canonical,c);y=w.vertices,v=w.indices}else{y=new s.b0,v=new s.b1;for(const{x:S,y:I}of p)y.emplaceBack(S,I,0,0);const w=s.bh(y.int16.subarray(0,4*y.length),void 0,4);for(let S=0;S<w.length;S+=3)v.emplaceBack(w[S],w[S+1],w[S+2])}this._tileBoundsBuffer=i.createVertexBuffer(y,s.bi.members),this._tileBoundsIndexBuffer=i.createIndexBuffer(v),this._tileBoundsSegments=s.bg.simpleSegment(0,0,y.length,v.length)}_makeGlobeTileDebugBuffers(i,c){const p=c.projection;if(!p||p.name!=="globe"||c.freezeTileCoverage)return;const y=this.tileID.canonical,v=s.bj(y,c),w=s.bk(v),S=s.aj(c.zoom);let I;S>0&&(I=s.bl(new Float64Array(16),c.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(i,y,c,w,I,S),this._makeGlobeTileDebugTextBuffer(i,y,c,w,I,S)}_globePoint(i,c,p,y,v,w,S){let I=s.bm(i,c,p);if(w){const O=1<<p.z,D=s.aF(y.center.lng),N=s.aJ(y.center.lat),z=(p.x+.5)/O-D;let U=0;z>.5?U=-1:z<-.5&&(U=1);let G=(i/s.al+p.x)/O+U,H=(c/s.al+p.y)/O;G=(G-D)*y._pixelsPerMercatorPixel+D,H=(H-N)*y._pixelsPerMercatorPixel+N;const J=[G*y.worldSize,H*y.worldSize,0];s.af(J,J,w),I=s.bn(I,J,S)}return s.af(I,I,v)}_makeGlobeTileDebugBorderBuffer(i,c,p,y,v,w){const S=new s.bd,I=new s.be,O=new s.bo,D=(z,U,G,H,J)=>{const Z=(G-z)/(J-1),ee=(H-U)/(J-1),ie=S.length;for(let se=0;se<J;se++){const me=z+se*Z,fe=U+se*ee;S.emplaceBack(me,fe);const ge=this._globePoint(me,fe,c,p,y,v,w);O.emplaceBack(ge[0],ge[1],ge[2]),I.emplaceBack(ie+se)}},N=s.al;D(0,0,N,0,16),D(N,0,N,N,16),D(N,N,0,N,16),D(0,N,0,0,16),this._tileDebugIndexBuffer=i.createIndexBuffer(I),this._tileDebugBuffer=i.createVertexBuffer(S,s.bf.members),this._globeTileDebugBorderBuffer=i.createVertexBuffer(O,s.bp.members),this._tileDebugSegments=s.bg.simpleSegment(0,0,S.length,I.length)}_makeGlobeTileDebugTextBuffer(i,c,p,y,v,w){const S=s.al/4,I=new s.bd,O=new s.b1,D=new s.bo,N=25;O.reserve(32),I.reserve(N),D.reserve(N);const z=(U,G)=>N*U+G;for(let U=0;U<N;U++){const G=U*S;for(let H=0;H<N;H++){const J=H*S;I.emplaceBack(J,G);const Z=this._globePoint(J,G,c,p,y,v,w);D.emplaceBack(Z[0],Z[1],Z[2])}}for(let U=0;U<4;U++)for(let G=0;G<4;G++){const H=z(U,G),J=z(U,G+1),Z=z(U+1,G),ee=z(U+1,G+1);O.emplaceBack(H,J,Z),O.emplaceBack(Z,J,ee)}this._tileDebugTextIndexBuffer=i.createIndexBuffer(O),this._tileDebugTextBuffer=i.createVertexBuffer(I,s.bf.members),this._globeTileDebugTextBuffer=i.createVertexBuffer(D,s.bp.members),this._tileDebugTextSegments=s.bg.simpleSegment(0,0,N,32)}destroy(i=!1){for(const c in this.buckets)this.buckets[c].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&(this.imageAtlasTexture.destroy(),delete this.imageAtlasTexture),this.glyphAtlasTexture&&(this.glyphAtlasTexture.destroy(),delete this.glyphAtlasTexture),this.lineAtlasTexture&&(this.lineAtlasTexture.destroy(),delete this.lineAtlasTexture),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),!i&&this.texture&&this.texture instanceof s.T&&(this.texture.destroy(),delete this.texture),this.hillshadeFBO&&(this.hillshadeFBO.destroy(),delete this.hillshadeFBO),this.dem&&delete this.dem,this.neighboringTiles&&delete this.neighboringTiles,this.demTexture&&(this.demTexture.destroy(),delete this.demTexture),this.rasterParticleState&&(this.rasterParticleState.destroy(),delete this.rasterParticleState),this.latestFeatureIndex=null,this.state="unloaded"}}s.bs.setPbf(s.bt);class Su extends vl{constructor(i,c,p,y,v){super(i,c,p,y,v),this._workQueuePerLayer=new Map,this._fetchQueuePerLayer=new Map,this._taskQueue=new Map,this._isHeaderLoaded=!1,this.textureDescriptorPerLayer=new Map,this.texturePerLayer=new Map}getLayers(){return this._mrt?Object.values(this._mrt.layers):[]}getLayer(i){return this._mrt&&this._mrt.getLayer(i)}setTexturePerLayer(i,c,p){const y=p.context,v=y.gl;let w=this.texturePerLayer.get(i)||p.getTileTexture(c.width);w&&w instanceof s.T?w.update(c,{premultiply:!1}):w=new s.T(y,c,v.RGBA8,{premultiply:!1}),this.texturePerLayer.has(i)||this.texturePerLayer.set(i,w)}flushQueues(i){const c=this._workQueuePerLayer.get(i)||[],p=this._fetchQueuePerLayer.get(i)||[];for(;c.length;)c.pop()();for(;p.length;)p.pop()()}flushAllQueues(){for(const i of this._workQueuePerLayer.keys()){const c=this._workQueuePerLayer.get(i)||[];for(;c.length;)c.pop()()}for(const i of this._fetchQueuePerLayer.keys()){const c=this._fetchQueuePerLayer.get(i)||[];for(;c.length;)c.pop()()}}fetchHeader(i=16384,c){const p=this._mrt=new s.bs(30),y=Object.assign({},this.requestParams,{headers:{Range:"bytes=0-"+(i-1)}});return this.entireBuffer=null,this.request=s.bu(y,((v,w,S,I)=>{if(v)c(v);else try{const O=p.getHeaderLength(w);if(O>i)return void(this.request=this.fetchHeader(O,c));p.parseHeader(w),this._isHeaderLoaded=!0;let D=0;for(const N of Object.values(p.layers))D=Math.max(D,N.dataIndex[N.dataIndex.length-1].lastByte);w.byteLength>=D&&(this.entireBuffer=w),c(null,this.entireBuffer||w,S,I)}catch(O){c(O)}})),this.request}fetchBandForRender(i,c,p,y){this.fetchBand(i,c,p,(v=>{if(v)return void y(v);this.updateTextureDescriptor(i,c,p);const w=this.textureDescriptorPerLayer.get(c);y(null,w?w.img:null)}))}fetchBand(i,c,p,y,v=!0){const w=this._mrt;if(!this._isHeaderLoaded||!w)return void y(new Error("Tile header is not ready"));const S=this.actor;if(!S)return void y(new Error("Can't fetch tile band without an actor"));let I;const O=s.B(String(p),s.B(this.tileID.key,i));let D=this._taskQueue.get(O);D?D.add(y):(D=new Set,D.add(y),this._taskQueue.set(O,D));const N=(H,J)=>{I.complete(H,J),H?y(H):(D.values().forEach((Z=>Z(null,J))),this._taskQueue.delete(O))},z=(H,J)=>{if(H)return y(H);const Z=S.send("decodeRasterArray",{type:"raster-array",source:this.source,scope:this.scope,tileID:this.tileID,uid:this.uid,buffer:J,task:I},N,void 0,!0);if(c!==null){const ee=this._workQueuePerLayer.get(c)||[];ee.push((()=>{Z&&Z.cancel(),I.cancel()})),this._workQueuePerLayer.has(c)||this._workQueuePerLayer.set(c,ee)}};let U;try{U=w.getLayer(i)}catch(H){if(this.state==="reloading")return;throw H}if(!U)return void y(new Error(`Unknown sourceLayer "${i}"`));if(U.hasDataForBand(p))return D.values().forEach((H=>H(null,null))),void this._taskQueue.delete(O);const G=U.getDataRange([p]);if(I=w.createDecodingTask(G),!I||I.tasks.length)if(c!==null&&this.flushQueues(c),this.entireBuffer)z(null,this.entireBuffer.slice(G.firstByte,G.lastByte+1));else{const H=Object.assign({},this.requestParams,{headers:{Range:`bytes=${G.firstByte}-${G.lastByte}`}}),J=s.bu(H,z);if(c!==null){const Z=this._fetchQueuePerLayer.get(c)||[];Z.push((()=>{J.cancel(),I.cancel()})),this._fetchQueuePerLayer.has(c)||this._fetchQueuePerLayer.set(c,Z)}}}updateNeeded(i,c){return(!this.textureDescriptorPerLayer.get(i)||this.textureDescriptorPerLayer.get(i).band!==c||this.refreshedUponExpiration)&&this.state!=="errored"}updateTextureDescriptor(i,c,p){if(!this._mrt)return;const y=this._mrt.getLayer(i);if(!y||!y.hasBand(p)||!y.hasDataForBand(p))return;const{bytes:v,tileSize:w,buffer:S,offset:I,scale:O}=y.getBandView(p),D=w+2*S,N=new s.q({width:D,height:D},v),z=this.texturePerLayer.get(c);z&&z instanceof s.T&&z.update(N,{premultiply:!1}),this.textureDescriptorPerLayer.set(c,{layer:i,band:p,img:N,buffer:S,offset:I,tileSize:w,format:y.pixelFormat,mix:[O,256*O,65536*O,16777216*O]})}destroy(i=!1){if(super.destroy(i),delete this._mrt,!i)for(const c of this.texturePerLayer.values())c&&c instanceof s.T&&c.destroy();this.texturePerLayer.clear(),this.textureDescriptorPerLayer.clear(),this.fbo&&(this.fbo.destroy(),delete this.fbo),delete this.request,delete this.requestParams,this._isHeaderLoaded=!1}}class qa{constructor(i,c){this.max=i,this.onRemove=c,this.reset()}reset(){for(const i in this.data)for(const c of this.data[i])c.timeout&&clearTimeout(c.timeout),this.onRemove(c.value);return this.data={},this.order=[],this}add(i,c,p){const y=i.wrapped().key;this.data[y]===void 0&&(this.data[y]=[]);const v={value:c,timeout:void 0};if(p!==void 0&&(v.timeout=setTimeout((()=>{this.remove(i,v)}),p)),this.data[y].push(v),this.order.push(y),this.order.length>this.max){const w=this._getAndRemoveByKey(this.order[0]);w&&this.onRemove(w)}return this}has(i){return i.wrapped().key in this.data}getAndRemove(i){return this.has(i)?this._getAndRemoveByKey(i.wrapped().key):null}_getAndRemoveByKey(i){const c=this.data[i].shift();return c.timeout&&clearTimeout(c.timeout),this.data[i].length===0&&delete this.data[i],this.order.splice(this.order.indexOf(i),1),c.value}getByKey(i){const c=this.data[i];return c?c[0].value:null}get(i){return this.has(i)?this.data[i.wrapped().key][0].value:null}remove(i,c){if(!this.has(i))return this;const p=i.wrapped().key,y=c===void 0?0:this.data[p].indexOf(c),v=this.data[p][y];return this.data[p].splice(y,1),v.timeout&&clearTimeout(v.timeout),this.data[p].length===0&&delete this.data[p],this.onRemove(v.value),this.order.splice(this.order.indexOf(p),1),this}setMaxSize(i){for(this.max=i;this.order.length>this.max;){const c=this._getAndRemoveByKey(this.order[0]);c&&this.onRemove(c)}return this}filter(i){const c=[];for(const p in this.data)for(const y of this.data[p])i(y.value)||c.push(y);for(const p of c)this.remove(p.value.tileID,p)}}class Ls{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(i,c,p){const y=String(c);if(this.stateChanges[i]=this.stateChanges[i]||{},this.stateChanges[i][y]=this.stateChanges[i][y]||{},Object.assign(this.stateChanges[i][y],p),this.deletedStates[i]===null){this.deletedStates[i]={};for(const v in this.state[i])v!==y&&(this.deletedStates[i][v]=null)}else if(this.deletedStates[i]&&this.deletedStates[i][y]===null){this.deletedStates[i][y]={};for(const v in this.state[i][y])p[v]||(this.deletedStates[i][y][v]=null)}else for(const v in p)this.deletedStates[i]&&this.deletedStates[i][y]&&this.deletedStates[i][y][v]===null&&delete this.deletedStates[i][y][v]}removeFeatureState(i,c,p){if(this.deletedStates[i]===null)return;const y=String(c);if(this.deletedStates[i]=this.deletedStates[i]||{},p&&c!==void 0)this.deletedStates[i][y]!==null&&(this.deletedStates[i][y]=this.deletedStates[i][y]||{},this.deletedStates[i][y][p]=null);else if(c!==void 0)if(this.stateChanges[i]&&this.stateChanges[i][y])for(p in this.deletedStates[i][y]={},this.stateChanges[i][y])this.deletedStates[i][y][p]=null;else this.deletedStates[i][y]=null;else this.deletedStates[i]=null}getState(i,c){const p=this.state[i]||{},y=this.stateChanges[i]||{},v=this.deletedStates[i];if(v===null)return{};if(c!==void 0){const S=String(c),I=Object.assign({},p[S],y[S]);if(v){const O=v[c];if(O===null)return{};for(const D in O)delete I[D]}return I}const w=Object.assign({},p,y);if(v)for(const S in v)delete w[S];return w}initializeTileState(i,c){i.refreshFeatureState(c)}coalesceChanges(i,c){const p={};for(const y in this.stateChanges){this.state[y]=this.state[y]||{};const v={};for(const w in this.stateChanges[y])this.state[y][w]||(this.state[y][w]={}),Object.assign(this.state[y][w],this.stateChanges[y][w]),v[w]=this.state[y][w];p[y]=v}for(const y in this.deletedStates){this.state[y]=this.state[y]||{};const v={};if(this.deletedStates[y]===null)for(const w in this.state[y])v[w]={},this.state[y][w]={};else for(const w in this.deletedStates[y]){if(this.deletedStates[y][w]===null)this.state[y][w]={};else if(this.state[y][w])for(const S of Object.keys(this.deletedStates[y][w]))delete this.state[y][w][S];v[w]=this.state[y][w]}p[y]=p[y]||{},Object.assign(p[y],v)}if(this.stateChanges={},this.deletedStates={},Object.keys(p).length!==0)for(const y in i)i[y].refreshFeatureState(c)}}class vs extends s.E{constructor(i,c,p){super(),this.id=i,this._onlySymbols=p,c.on("data",(y=>{y.dataType==="source"&&y.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&y.dataType==="source"&&y.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform))})),c.on("error",(()=>{this._sourceErrored=!0})),this._source=c,this._tiles={},this._cache=new qa(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=c.minTileCacheSize,this._maxTileCacheSize=c.maxTileCacheSize,this._loadedParentTiles={},this.castsShadows=!1,this.tileCoverLift=0,this._coveredTiles={},this._shadowCasterTiles={},this._state=new Ls,this._isRaster=this._source.type==="raster"||this._source.type==="raster-dem"||this._source.type==="raster-array"||this._source.type==="custom"&&this._source._dataType==="raster"}onAdd(i){this.map=i,this._minTileCacheSize=this._minTileCacheSize===void 0&&i?i._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=this._maxTileCacheSize===void 0&&i?i._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const i in this._tiles)if(!this._tiles[i].loaded())return!1;return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const i=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,i&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(i,c){return i.isSymbolTile=this._onlySymbols,i.isExtraShadowCaster=this._shadowCasterTiles[i.tileID.key],this._source.loadTile(i,c)}_unloadTile(i){if(this._source.unloadTile)return this._source.unloadTile(i)}_abortTile(i){if(this._source.abortTile)return this._source.abortTile(i)}serialize(){return this._source.serialize()}prepare(i){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const c in this._tiles){const p=this._tiles[c];p.upload(i),p.prepare(this.map.style.imageManager,this.map?this.map.painter:null,this._source.scope)}}getIds(){return Object.values(this._tiles).map((i=>i.tileID)).sort(kd).map((i=>i.key))}getRenderableIds(i,c){const p=[];for(const y in this._tiles)this._isIdRenderable(+y,i,c)&&p.push(this._tiles[y]);return i?p.sort(((y,v)=>{const w=y.tileID,S=v.tileID,I=new s.P(w.canonical.x,w.canonical.y)._rotate(this.transform.angle),O=new s.P(S.canonical.x,S.canonical.y)._rotate(this.transform.angle);return w.overscaledZ-S.overscaledZ||O.y-I.y||O.x-I.x})).map((y=>y.tileID.key)):p.map((y=>y.tileID)).sort(kd).map((y=>y.key))}hasRenderableParent(i){const c=this.findLoadedParent(i,0);return!!c&&this._isIdRenderable(c.tileID.key)}_isIdRenderable(i,c,p){return this._tiles[i]&&this._tiles[i].hasData()&&!this._coveredTiles[i]&&(c||!this._tiles[i].holdingForFade())&&(p||!this._shadowCasterTiles[i])}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const i in this._tiles)this._tiles[i].state!=="errored"&&this._reloadTile(+i,"reloading")}}_reloadTile(i,c){const p=this._tiles[i];p&&(p.state!=="loading"&&(p.state=c),this._loadTile(p,this._tileLoaded.bind(this,p,i,c)))}_tileLoaded(i,c,p,y){if(y)if(i.state="errored",y.status!==404)this._source.fire(new s.y(y,{tile:i}));else{if(this._source.fire(new s.z("data",{dataType:"source",sourceDataType:"error",sourceId:this._source.id,tile:i})),!(i.tileID.key in this._loadedParentTiles))return;if(this._source.type==="raster-dem"&&this.usedForTerrain&&this.map.painter.terrain){const v=this.map.painter.terrain;this.update(this.transform,v.getScaledDemTileSize(),!0),v.resetTileLookupCache(this.id)}else this.update(this.transform)}else i.timeAdded=s.o.now(),p==="expired"&&(i.refreshedUponExpiration=!0),this._setTileReloadTimer(c,i),this._source.type==="raster-dem"&&i.dem&&this._backfillDEM(i),this._state.initializeTileState(i,this.map?this.map.painter:null),this._source.fire(new s.z("data",{dataType:"source",tile:i,coord:i.tileID,sourceCacheId:this.id}))}_backfillDEM(i){const c=this.getRenderableIds();for(let y=0;y<c.length;y++){const v=c[y];if(i.neighboringTiles&&i.neighboringTiles[v]){const w=this.getTileByID(v);p(i,w),p(w,i)}}function p(y,v){if(!y.dem||y.dem.borderReady)return;y.needsHillshadePrepare=!0,y.needsDEMTextureUpload=!0;let w=v.tileID.canonical.x-y.tileID.canonical.x;const S=v.tileID.canonical.y-y.tileID.canonical.y,I=Math.pow(2,y.tileID.canonical.z),O=v.tileID.key;w===0&&S===0||Math.abs(S)>1||(Math.abs(w)>1&&(Math.abs(w+I)===1?w+=I:Math.abs(w-I)===1&&(w-=I)),v.dem&&y.dem&&(y.dem.backfillBorder(v.dem,w,S),y.neighboringTiles&&y.neighboringTiles[O]&&(y.neighboringTiles[O].backfilled=!0)))}}getTile(i){return this.getTileByID(i.key)}getTileByID(i){return this._tiles[i]}_retainLoadedChildren(i,c,p,y){for(const v in this._tiles){let w=this._tiles[v];if(y[v]||!w.hasData()||w.tileID.overscaledZ<=c||w.tileID.overscaledZ>p)continue;let S=w.tileID;for(;w&&w.tileID.overscaledZ>c+1;){const O=w.tileID.scaledTo(w.tileID.overscaledZ-1);w=this._tiles[O.key],w&&w.hasData()&&(S=O)}let I=S;for(;I.overscaledZ>c;)if(I=I.scaledTo(I.overscaledZ-1),i[I.key]){y[S.key]=S;break}}}findLoadedParent(i,c){if(i.key in this._loadedParentTiles){const p=this._loadedParentTiles[i.key];return p&&p.tileID.overscaledZ>=c?p:null}for(let p=i.overscaledZ-1;p>=c;p--){const y=i.scaledTo(p),v=this._getLoadedTile(y);if(v)return v}}_getLoadedTile(i){const c=this._tiles[i.key];return c&&c.hasData()?c:this._cache.getByKey(this._source.reparseOverscaled?i.wrapped().key:i.canonical.key)}updateCacheSize(i,c){c=c||this._source.tileSize;const p=Math.ceil(i.width/c)+1,y=Math.ceil(i.height/c)+1,v=Math.floor(p*y*5),w=typeof this._minTileCacheSize=="number"?Math.max(this._minTileCacheSize,v):v,S=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,w):w;this._cache.setMaxSize(S)}handleWrapJump(i){const c=Math.round((i-(this._prevLng===void 0?i:this._prevLng))/360);if(this._prevLng=i,c){const p={};for(const y in this._tiles){const v=this._tiles[y];v.tileID=v.tileID.unwrapTo(v.tileID.wrap+c),p[v.tileID.key]=v}this._tiles=p;for(const y in this._timers)clearTimeout(this._timers[y]),delete this._timers[y];for(const y in this._tiles)this._setTileReloadTimer(+y,this._tiles[y])}}update(i,c,p,y,v){if(this.transform=i,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!p)return;this.updateCacheSize(i,c),this.transform.projection.name!=="globe"&&this.handleWrapJump(this.transform.center.lng),this._shadowCasterTiles={},this._coveredTiles={};const w=this._source.type==="batched-model";let S,I=this._source.maxzoom;const O=this.map&&this.map.painter?this.map.painter._terrain:null;if(O&&O.sourceCache===this&&O.attenuationRange()){const z=O.attenuationRange()[0],U=Math.floor(z)-Math.log2(O.getDemUpscale());I>U&&(I=U)}if(this.used||this.usedForTerrain){if(this._source.tileID)S=i.getVisibleUnwrappedCoordinates(this._source.tileID).map((z=>new s.aO(z.canonical.z,z.wrap,z.canonical.z,z.canonical.x,z.canonical.y)));else if(this.tileCoverLift!==0){const z=i.clone();z.tileCoverLift=this.tileCoverLift,S=z.coveringTiles({tileSize:c||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:I,roundZoom:this._source.roundZoom&&!p,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain,calculateQuadrantVisibility:w}),this._source.minzoom<=1&&i.projection.name==="globe"&&(S.push(new s.aO(1,0,1,0,0)),S.push(new s.aO(1,0,1,1,0)),S.push(new s.aO(1,0,1,0,1)),S.push(new s.aO(1,0,1,1,1)))}else if(S=i.coveringTiles({tileSize:c||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:I,roundZoom:this._source.roundZoom&&!p,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain,calculateQuadrantVisibility:w}),this._source.hasTile){const z=this._source.hasTile.bind(this._source);S=S.filter((U=>z(U)))}}else S=[];if(S.length>0&&this.transform.projection.name!=="globe"&&!this.usedForTerrain&&!Eu(this._source.type)){const z=i.coveringZoomLevel({tileSize:c||this._source.tileSize,roundZoom:this._source.roundZoom&&!p}),U=Math.min(z,this._source.maxzoom);if(w){const G=i.extendTileCover(S,U);for(const H of G)S.push(H)}else if(v){const G=i.extendTileCoverToNearPlane(S,this.transform.getFrustum(U),U);for(const H of G)S.push(H)}else if(this.castsShadows&&y){const G=i.extendTileCover(S,U,y);for(const H of G)this._shadowCasterTiles[H.key]=!0,S.push(H)}}const D=this._updateRetainedTiles(S);if(Eu(this._source.type)&&S.length!==0){const z={},U={},G=Object.keys(D);for(const J of G){const Z=D[J],ee=this._tiles[J];if(!ee||ee.fadeEndTime&&ee.fadeEndTime<=s.o.now())continue;const ie=this.findLoadedParent(Z,Math.max(Z.overscaledZ-vs.maxOverzooming,this._source.minzoom));ie&&(this._addTile(ie.tileID),z[ie.tileID.key]=ie.tileID),U[J]=Z}const H=S[S.length-1].overscaledZ;for(const J in this._tiles){const Z=this._tiles[J];if(D[J]||!Z.hasData())continue;let ee=Z.tileID;for(;ee.overscaledZ>H;){ee=ee.scaledTo(ee.overscaledZ-1);const ie=this._tiles[ee.key];if(ie&&ie.hasData()&&U[ee.key]){D[J]=Z.tileID;break}}}for(const J in z)D[J]||(this._coveredTiles[J]=!0,D[J]=z[J])}for(const z in D)this._tiles[z].clearFadeHold();const N=s.bv(this._tiles,D);for(const z of N){const U=this._tiles[z];U.hasSymbolBuckets&&!U.holdingForFade()?U.setHoldDuration(this.map._fadeDuration):U.hasSymbolBuckets&&!U.symbolFadeFinished()||this._removeTile(+z)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const i in this._tiles)this._tiles[i].holdingForFade()&&this._removeTile(+i)}_updateRetainedTiles(i){const c={};if(i.length===0)return c;const p={},y=i.reduce(((O,D)=>Math.min(O,D.overscaledZ)),1/0),v=i[0].overscaledZ,w=Math.max(v-vs.maxOverzooming,this._source.minzoom),S=Math.max(v+vs.maxUnderzooming,this._source.minzoom),I={};for(const O of i){const D=this._addTile(O);c[O.key]=O,D.hasData()||y<this._source.maxzoom&&(I[O.key]=O)}this._retainLoadedChildren(I,y,S,c);for(const O of i){let D=this._tiles[O.key];if(D.hasData())continue;if(O.canonical.z>=this._source.maxzoom){const z=O.children(this._source.maxzoom)[0],U=this.getTile(z);if(U&&U.hasData()){c[z.key]=z;continue}}else{const z=O.children(this._source.maxzoom);if(c[z[0].key]&&c[z[1].key]&&c[z[2].key]&&c[z[3].key])continue}let N=D.wasRequested();for(let z=O.overscaledZ-1;z>=w;--z){const U=O.scaledTo(z);if(p[U.key]||(p[U.key]=!0,D=this.getTile(U),!D&&N&&(D=this._addTile(U)),D&&(c[U.key]=U,N=D.wasRequested(),D.hasData())))break}}return c}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const i in this._tiles){const c=[];let p,y=this._tiles[i].tileID;for(;y.overscaledZ>0;){if(y.key in this._loadedParentTiles){p=this._loadedParentTiles[y.key];break}c.push(y.key);const v=y.scaledTo(y.overscaledZ-1);if(p=this._getLoadedTile(v),p)break;y=v}for(const v of c)this._loadedParentTiles[v]=p}}_addTile(i){let c=this._tiles[i.key];if(c)return c.isExtraShadowCaster!==!0||this._shadowCasterTiles[i.key]||this._reloadTile(i.key,"reloading"),c;c=this._cache.getAndRemove(i),c&&(this._setTileReloadTimer(i.key,c),c.tileID=i,this._state.initializeTileState(c,this.map?this.map.painter:null),this._cacheTimers[i.key]&&(clearTimeout(this._cacheTimers[i.key]),delete this._cacheTimers[i.key],this._setTileReloadTimer(i.key,c)));const p=!!c;if(!p){const y=this.map?this.map.painter:null,v=this._source.tileSize*i.overscaleFactor();c=this._source.type==="raster-array"?new Su(i,v,this.transform.tileZoom,y,this._isRaster):new vl(i,v,this.transform.tileZoom,y,this._isRaster,this._source.worldview),this._loadTile(c,this._tileLoaded.bind(this,c,i.key,c.state))}return c.uses++,this._tiles[i.key]=c,p||this._source.fire(new s.z("dataloading",{tile:c,coord:c.tileID,dataType:"source"})),c}_setTileReloadTimer(i,c){i in this._timers&&(clearTimeout(this._timers[i]),delete this._timers[i]);const p=c.getExpiryTimeout();p&&(this._timers[i]=setTimeout((()=>{this._reloadTile(i,"expired"),delete this._timers[i]}),p))}_removeTile(i){const c=this._tiles[i];c&&(c.uses--,delete this._tiles[i],this._timers[i]&&(clearTimeout(this._timers[i]),delete this._timers[i]),c.uses>0||(c.hasData()&&c.state!=="reloading"||c.state==="empty"?this._cache.add(c.tileID,c,c.getExpiryTimeout()):(c.aborted=!0,this._abortTile(c),this._unloadTile(c))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const i in this._tiles)this._removeTile(+i);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(i,c,p){const y=[],v=this.transform;if(!v)return y;const w=v.projection.name==="globe",S=s.aF(v.center.lng);for(const I in this._tiles){const O=this._tiles[I];if(p&&O.clearQueryDebugViz(),O.holdingForFade())continue;let D;if(w){const N=O.tileID.canonical;if(N.z===0){const z=[Math.abs(s.aA(S,...ma(N,-1))-S),Math.abs(s.aA(S,...ma(N,1))-S)];D=[0,2*z.indexOf(Math.min(...z))-1]}else{const z=[Math.abs(s.aA(S,...ma(N,-1))-S),Math.abs(s.aA(S,...ma(N,0))-S),Math.abs(s.aA(S,...ma(N,1))-S)];D=[z.indexOf(Math.min(...z))-1]}}else D=[0];for(const N of D){const z=i.containsTile(O,v,c,N);z&&y.push(z)}}return y}getShadowCasterCoordinates(){return this._getRenderableCoordinates(!1,!0)}getVisibleCoordinates(i){return this._getRenderableCoordinates(i)}_getRenderableCoordinates(i,c){const p=this.getRenderableIds(i,c).map((v=>this._tiles[v].tileID)),y=this.transform.projection.name==="globe";for(const v of p)v.projMatrix=this.transform.calculateProjMatrix(v.toUnwrapped()),v.expandedProjMatrix=y?this.transform.calculateProjMatrix(v.toUnwrapped(),!1,!0):v.projMatrix;return p}sortCoordinatesByDistance(i){const c=i.slice(),p=this.transform._camera.position,y=this.transform._camera.forward(),v={};for(const w of c){const S=1/(1<<w.canonical.z);v[w.key]=((w.canonical.x+.5)*S+w.wrap-p[0])*y[0]+((w.canonical.y+.5)*S-p[1])*y[1]-p[2]*y[2]}return c.sort(((w,S)=>v[w.key]-v[S.key])),c}hasTransition(){if(this._source.hasTransition())return!0;if(Eu(this._source.type))for(const i in this._tiles){const c=this._tiles[i];if(c.fadeEndTime!==void 0&&c.fadeEndTime>=s.o.now())return!0}return!1}setFeatureState(i,c,p){this._state.updateState(i=i||"_geojsonTileLayer",c,p)}removeFeatureState(i,c,p){this._state.removeFeatureState(i=i||"_geojsonTileLayer",c,p)}getFeatureState(i,c){return this._state.getState(i=i||"_geojsonTileLayer",c)}setDependencies(i,c,p){const y=this._tiles[i];y&&y.setDependencies(c,p)}reloadTilesForDependencies(i,c){for(const p in this._tiles)this._tiles[p].hasDependency(i,c)&&this._reloadTile(+p,"reloading");this._cache.filter((p=>!p.hasDependency(i,c)))}_preloadTiles(i,c){if(!this._sourceLoaded){const I=()=>{this._sourceLoaded&&(this._source.off("data",I),this._preloadTiles(i,c))};return void this._source.on("data",I)}const p=new Map,y=Array.isArray(i)?i:[i],v=this.map.painter.terrain,w=this.usedForTerrain&&v?v.getScaledDemTileSize():this._source.tileSize;for(const I of y){const O=I.coveringTiles({tileSize:w,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const D of O)p.set(D.key,D);this.usedForTerrain&&I.updateElevation(!1)}const S=Array.from(p.values());s.bw(S,((I,O)=>{const D=new vl(I,this._source.tileSize*I.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster,this._source.worldview);this._loadTile(D,(N=>{this._source.type==="raster-dem"&&D.dem&&this._backfillDEM(D),O(N,D)}))}),c)}}function kd(m,i){const c=Math.abs(2*m.wrap)-+(m.wrap<0),p=Math.abs(2*i.wrap)-+(i.wrap<0);return m.overscaledZ-i.overscaledZ||p-c||i.canonical.y-m.canonical.y||i.canonical.x-m.canonical.x}function Eu(m){return m==="raster"||m==="image"||m==="video"||m==="custom"}function ma(m,i){const c=1<<m.z;return[m.x/c+i,(m.x+1)/c+i]}vs.maxOverzooming=10,vs.maxUnderzooming=3;class Od{constructor(i){this.style=i,this.layersGotHidden=!1,this.layers=[]}processLayersChanged(){this.layers=[];const i=!1,c=!1;for(const p in this.style._mergedLayers){const y=this.style._mergedLayers[p];if(y.type==="fill-extrusion"||y.type==="building")this.layers.push({layer:y,visible:i,visibilityChanged:c});else if(y.type==="model"){const v=this.style.getLayerSource(y);v&&v.type==="batched-model"&&this.layers.push({layer:y,visible:i,visibilityChanged:c})}}}onNewFrame(i){this.layersGotHidden=!1;for(const c of this.layers){const p=c.layer;let y=!1;p.type==="fill-extrusion"?y=!p.isHidden(i)&&p.paint.get("fill-extrusion-opacity")>0:p.type==="building"?y=!p.isHidden(i)&&p.paint.get("building-opacity")>0:p.type==="model"&&(y=!p.isHidden(i)&&p.paint.get("model-opacity").constantOr(1)>0),this.layersGotHidden=this.layersGotHidden||!y&&c.visible,c.visible=y}}updateZOffset(i,c){this.currentBuildingBuckets=[];for(const y of this.layers){const v=y.layer,w=this.style.getLayerSourceCache(v);let S=1;v.type==="fill-extrusion"?S=y.visible?v.paint.get("fill-extrusion-vertical-scale"):0:v.type==="building"&&(S=y.visible?v.paint.get("building-vertical-scale"):0);let I=w?w.getTile(c):null;if(!I&&w)for(const O in w._tiles){const D=w._tiles[O];if(c.canonical.isChildOf(D.tileID.canonical)){I=D;break}}this.currentBuildingBuckets.push({bucket:I?I.getBucket(v):null,tileID:I?I.tileID:c,verticalScale:S})}i.hasAnyZOffset=!1;let p=!1;for(let y=0;y<i.symbolInstances.length;y++){const v=i.symbolInstances.get(y),w=v.zOffset,S=this._getHeightAtTileOffset(c,v.tileAnchorX,v.tileAnchorY);v.zOffset=S!==Number.NEGATIVE_INFINITY?S:w,p||w===v.zOffset||(p=!0),i.hasAnyZOffset||v.zOffset===0||(i.hasAnyZOffset=!0)}p&&(i.zOffsetBuffersNeedUpload=!0,i.zOffsetSortDirty=!0)}_mapCoordToOverlappingTile(i,c,p,y){let v=c,w=p;if(i.canonical.z!==y.canonical.z){const S=y.canonical,I=1/(1<<i.canonical.z-S.z);v=(c+i.canonical.x*s.al)*I-S.x*s.al|0,w=(p+i.canonical.y*s.al)*I-S.y*s.al|0}return{tileX:v,tileY:w}}_getHeightAtTileOffset(i,c,p){let y,v;for(let w=0;w<this.layers.length;++w){const S=this.layers[w].layer;if(S.type!=="fill-extrusion"&&S.type!=="building")continue;const{bucket:I,tileID:O,verticalScale:D}=this.currentBuildingBuckets[w];if(!I)continue;const{tileX:N,tileY:z}=this._mapCoordToOverlappingTile(i,c,p,O),U=I.getHeightAtTileCoord(N,z);U&&U.height!==void 0&&(U.hidden?y=U.height:v=Math.max(U.height*D,v||0))}if(v!==void 0)return v;for(let w=0;w<this.layers.length;++w){const S=this.layers[w];if(S.layer.type!=="model"||!S.visible)continue;const{bucket:I,tileID:O}=this.currentBuildingBuckets[w];if(!I)continue;const{tileX:D,tileY:N}=this._mapCoordToOverlappingTile(i,c,p,O),z=I.getHeightAtTileCoord(D,N);if(z&&!z.hidden)return z.height===void 0&&y!==void 0?Math.min(z.maxHeight,y)*z.verticalScale:z.height?z.height*z.verticalScale:Number.NEGATIVE_INFINITY}return this.layersGotHidden?0:Number.NEGATIVE_INFINITY}}function gf(m,i){const c={};for(const p in m)p!=="ref"&&(c[p]=m[p]);return s.bx.forEach((p=>{p in i&&(c[p]=i[p])})),c}function Md(m){m=m.slice();const i=Object.create(null);for(let c=0;c<m.length;c++)i[m[c].id]=m[c];for(let c=0;c<m.length;c++)"ref"in m[c]&&(m[c]=gf(m[c],i[m[c].ref]));return m}const sr={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setSlot:"setSlot",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setSnow:"setSnow",setRain:"setRain",setCamera:"setCamera",setLights:"setLights",setProjection:"setProjection",addImport:"addImport",removeImport:"removeImport",updateImport:"updateImport",addIconset:"addIconset",removeIconset:"removeIconset"};function Ec(m,i,c){c.push({command:sr.addSource,args:[m,i[m]]})}function Dp(m,i,c){i.push({command:sr.removeSource,args:[m]}),c[m]=!0}function Cu(m,i,c,p){Dp(m,c,p),Ec(m,i,c)}function Wl(m,i,c){let p;for(p in m[c])if(m[c].hasOwnProperty(p)&&p!=="data"&&!s.by(m[c][p],i[c][p]))return!1;for(p in i[c])if(i[c].hasOwnProperty(p)&&p!=="data"&&!s.by(m[c][p],i[c][p]))return!1;return!0}function Ka(m,i,c,p,y,v){let w;for(w in i=i||{},m=m||{})m.hasOwnProperty(w)&&(s.by(m[w],i[w])||c.push({command:v,args:[p,w,i[w],y]}));for(w in i)i.hasOwnProperty(w)&&!m.hasOwnProperty(w)&&(s.by(m[w],i[w])||c.push({command:v,args:[p,w,i[w],y]}))}function La(m){return m.id}function Za(m,i){return m[i.id]=i,m}function Iu(m,i,c){const p=i.createTileMatrix(m,m.worldSize,c.toUnwrapped());return s.aB(new Float32Array(16),m.projMatrix,p)}function Dd(m,i,c){if(i.projection.name===c.projection.name)return m.projMatrix;const p=c.clone();return p.setProjection(i.projection),Iu(p,i.getProjection(),m)}function Ji(m,i,c){return i.name===c.projection.name?m.projMatrix:Iu(c,i,m)}class Lp{constructor(i,c){this.reset(i,c)}reset(i,c){this.points=i||[],this._distances=[0];for(let p=1;p<this.points.length;p++)this._distances[p]=this._distances[p-1]+this.points[p].dist(this.points[p-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(c||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(i){if(this.points.length===1)return this.points[0];i=s.aA(i,0,1);let c=1,p=this._distances[c];const y=i*this.paddedLength+this.padding;for(;p<y&&c<this._distances.length;)p=this._distances[++c];const v=c-1,w=this._distances[v],S=p-w,I=S>0?(y-w)/S:0;return this.points[v].mult(1-I).add(this.points[c].mult(I))}}class _f{constructor(i,c,p){const y=this.boxCells=[],v=this.circleCells=[];this.xCellCount=Math.ceil(i/p),this.yCellCount=Math.ceil(c/p);for(let w=0;w<this.xCellCount*this.yCellCount;w++)y.push([]),v.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=i,this.height=c,this.xScale=this.xCellCount/i,this.yScale=this.yCellCount/c,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(i,c,p,y,v){this._forEachCell(c,p,y,v,this._insertBoxCell,this.boxUid++),this.boxKeys.push(i),this.bboxes.push(c),this.bboxes.push(p),this.bboxes.push(y),this.bboxes.push(v)}insertCircle(i,c,p,y){this._forEachCell(c-y,p-y,c+y,p+y,this._insertCircleCell,this.circleUid++),this.circleKeys.push(i),this.circles.push(c),this.circles.push(p),this.circles.push(y)}_insertBoxCell(i,c,p,y,v,w){this.boxCells[v].push(w)}_insertCircleCell(i,c,p,y,v,w){this.circleCells[v].push(w)}_query(i,c,p,y,v,w){if(p<0||i>this.width||y<0||c>this.height)return!v&&[];const S=[];if(i<=0&&c<=0&&this.width<=p&&this.height<=y){if(v)return!0;for(let I=0;I<this.boxKeys.length;I++)S.push({key:this.boxKeys[I],x1:this.bboxes[4*I],y1:this.bboxes[4*I+1],x2:this.bboxes[4*I+2],y2:this.bboxes[4*I+3]});for(let I=0;I<this.circleKeys.length;I++){const O=this.circles[3*I],D=this.circles[3*I+1],N=this.circles[3*I+2];S.push({key:this.circleKeys[I],x1:O-N,y1:D-N,x2:O+N,y2:D+N})}return w?S.filter(w):S}return this._forEachCell(i,c,p,y,this._queryCell,S,{hitTest:v,seenUids:{box:{},circle:{}}},w),v?S.length>0:S}_queryCircle(i,c,p,y,v){const w=i-p,S=i+p,I=c-p,O=c+p;if(S<0||w>this.width||O<0||I>this.height)return!y&&[];const D=[];return this._forEachCell(w,I,S,O,this._queryCellCircle,D,{hitTest:y,circle:{x:i,y:c,radius:p},seenUids:{box:{},circle:{}}},v),y?D.length>0:D}query(i,c,p,y,v){return this._query(i,c,p,y,!1,v)}hitTest(i,c,p,y,v){return this._query(i,c,p,y,!0,v)}hitTestCircle(i,c,p,y){return this._queryCircle(i,c,p,!0,y)}_queryCell(i,c,p,y,v,w,S,I){const O=S.seenUids,D=this.boxCells[v];if(D!==null){const z=this.bboxes;for(const U of D)if(!O.box[U]){O.box[U]=!0;const G=4*U;if(i<=z[G+2]&&c<=z[G+3]&&p>=z[G+0]&&y>=z[G+1]&&(!I||I(this.boxKeys[U]))){if(S.hitTest)return w.push(!0),!0;w.push({key:this.boxKeys[U],x1:z[G],y1:z[G+1],x2:z[G+2],y2:z[G+3]})}}}const N=this.circleCells[v];if(N!==null){const z=this.circles;for(const U of N)if(!O.circle[U]){O.circle[U]=!0;const G=3*U;if(this._circleAndRectCollide(z[G],z[G+1],z[G+2],i,c,p,y)&&(!I||I(this.circleKeys[U]))){if(S.hitTest)return w.push(!0),!0;{const H=z[G],J=z[G+1],Z=z[G+2];w.push({key:this.circleKeys[U],x1:H-Z,y1:J-Z,x2:H+Z,y2:J+Z})}}}}}_queryCellCircle(i,c,p,y,v,w,S,I){const O=S.circle,D=S.seenUids,N=this.boxCells[v];if(N!==null){const U=this.bboxes;for(const G of N)if(!D.box[G]){D.box[G]=!0;const H=4*G;if(this._circleAndRectCollide(O.x,O.y,O.radius,U[H+0],U[H+1],U[H+2],U[H+3])&&(!I||I(this.boxKeys[G])))return w.push(!0),!0}}const z=this.circleCells[v];if(z!==null){const U=this.circles;for(const G of z)if(!D.circle[G]){D.circle[G]=!0;const H=3*G;if(this._circlesCollide(U[H],U[H+1],U[H+2],O.x,O.y,O.radius)&&(!I||I(this.circleKeys[G])))return w.push(!0),!0}}}_forEachCell(i,c,p,y,v,w,S,I){const O=this._convertToXCellCoord(i),D=this._convertToYCellCoord(c),N=this._convertToXCellCoord(p),z=this._convertToYCellCoord(y);for(let U=O;U<=N;U++)for(let G=D;G<=z;G++)if(v.call(this,i,c,p,y,this.xCellCount*G+U,w,S,I))return}_convertToXCellCoord(i){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(i*this.xScale)))}_convertToYCellCoord(i){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(i*this.yScale)))}_circlesCollide(i,c,p,y,v,w){const S=y-i,I=v-c,O=p+w;return O*O>S*S+I*I}_circleAndRectCollide(i,c,p,y,v,w,S){const I=(w-y)/2,O=Math.abs(i-(y+I));if(O>I+p)return!1;const D=(S-v)/2,N=Math.abs(c-(v+D));if(N>D+p)return!1;if(O<=I||N<=D)return!0;const z=O-I,U=N-D;return z*z+U*U<=p*p}}const ql={unknown:0,flipRequired:1,flipNotRequired:2},Au=Math.tan(85*Math.PI/180);function qs(m,i,c,p,y,v,w){const S=s.bC();if(c)if(v.name==="globe"){const I=s.bD(y,i);s.aB(S,S,I)}else{const I=s.bE([],w);S[0]=I[0],S[1]=I[1],S[4]=I[2],S[5]=I[3],p||s.bB(S,S,y.angle)}else s.aB(S,y.labelPlaneMatrix,m);return S}function bl(m,i,c,p,y,v,w){const S=qs(m,i,c,p,y,v,w);return v.name==="globe"&&c||(S[2]=S[6]=S[10]=S[14]=0),S}function Pu(m,i,c,p,y,v,w){if(c){if(v.name==="globe"){const S=qs(m,i,c,p,y,v,w);return s.bl(S,S),s.aB(S,m,S),S}{const S=s.bz(m),I=s.bA([]);return I[0]=w[0],I[1]=w[1],I[4]=w[2],I[5]=w[3],s.aB(S,S,I),p||s.bB(S,S,-y.angle),S}}return y.glCoordMatrix}function Oo(m,i,c,p){const y=[m,i,c,1];c?s.aC(y,y,p):Zl(y,y,p);const v=y[3];return y[0]/=v,y[1]/=v,y[2]/=v,y}function xl(m,i){return Math.min(.5+m/i*.5,1.5)}function zs(m,i){const c=m[0]/m[3],p=m[1]/m[3];return c>=-i[0]&&c<=i[0]&&p>=-i[1]&&p<=i[1]}function Kl(m,i,c,p,y,v,w,S,I,O){const D=c.transform,N=p?m.textSizeData:m.iconSizeData,z=s.bK(N,c.transform.zoom),U=D.projection.name==="globe",G=[256/c.width*2+1,256/c.height*2+1],H=p?m.text.dynamicLayoutVertexArray:m.icon.dynamicLayoutVertexArray;H.clear();let J=null;U&&(J=p?m.text.globeExtVertexArray:m.icon.globeExtVertexArray);const Z=m.lineVertexArray,ee=p?m.text.placedSymbolArray:m.icon.placedSymbolArray,ie=c.transform.width/c.transform.height;let se,me=!1;for(let fe=0;fe<ee.length;fe++){const ge=ee.get(fe),{numGlyphs:pe,writingMode:he}=ge;if(he!==s.bL.vertical||me||se===s.bL.horizontal||(me=!0),se=he,(ge.hidden||he===s.bL.vertical)&&!me){wn(pe,H);continue}me=!1;const _e=new s.P(ge.tileAnchorX,ge.tileAnchorY);let{x:Ke,y:Le,z:st}=D.projection.projectTilePoint(_e.x,_e.y,O.canonical);if(I){const[bt,un,en]=I(_e);Ke+=bt,Le+=un,st+=en}const We=[Ke,Le,st,1];if(s.aC(We,We,i),!zs(We,G)){wn(pe,H);continue}const it=We[3],Pt=xl(c.transform.getCameraToCenterDistance(D.projection),it),qe=s.bM(N,z,ge),Ae=w?qe/Pt:qe*Pt,at=Oo(Ke,Le,st,y);if(at[3]<=0){wn(pe,H);continue}let Je={};const _t=s.an(m.layers[0].layout.get("text-max-angle")),At=Math.cos(_t),Ut=w?null:I,St=Pr(ge,Ae,!1,S,i,y,v,m.glyphOffsetArray,Z,H,J,at,_e,Je,ie,Ut,D.projection,O,w,At);me=St.useVertical,Ut&&St.needsFlipping&&(Je={}),(St.notEnoughRoom||me||St.needsFlipping&&Pr(ge,Ae,!0,S,i,y,v,m.glyphOffsetArray,Z,H,J,at,_e,Je,ie,Ut,D.projection,O,w,At).notEnoughRoom)&&wn(pe,H)}p?(m.text.dynamicLayoutVertexBuffer.updateData(H),J&&m.text.globeExtVertexBuffer&&m.text.globeExtVertexBuffer.updateData(J)):(m.icon.dynamicLayoutVertexBuffer.updateData(H),J&&m.icon.globeExtVertexBuffer&&m.icon.globeExtVertexBuffer.updateData(J))}function Ru(m,i,c,p,y,v,w,S,I,O,D,N,z,U,G,H,J){const{lineStartIndex:Z,glyphStartIndex:ee,segment:ie}=S,se=ee+S.numGlyphs,me=Z+S.lineLength,fe=i.getoffsetX(ee),ge=i.getoffsetX(se-1),pe=zd(m*fe,c,p,y,v,w,ie,Z,me,I,O,D,N,z,!0,U,G,H,J);if(!pe)return null;const he=zd(m*ge,c,p,y,v,w,ie,Z,me,I,O,D,N,z,!0,U,G,H,J);return he?{first:pe,last:he}:null}function ku(m,i,c,p){return m===s.bL.horizontal&&Math.abs(p)>Math.abs(c)?{useVertical:!0}:m===s.bL.vertical?p>0?{needsFlipping:!0}:null:i!==ql.unknown&&(function(y,v){return y===0||Math.abs(v/y)>Au})(c,p)?i===ql.flipRequired?{needsFlipping:!0}:null:c<0?{needsFlipping:!0}:null}function Pr(m,i,c,p,y,v,w,S,I,O,D,N,z,U,G,H,J,Z,ee,ie){const se=i/24,me=m.lineOffsetX*se,fe=m.lineOffsetY*se,{lineStartIndex:ge,glyphStartIndex:pe,numGlyphs:he,segment:_e,writingMode:Ke,flipState:Le}=m,st=ge+m.lineLength,We=it=>{if(D){const[at,Je,_t]=it.up,At=O.length;s.bN(D,At+0,at,Je,_t),s.bN(D,At+1,at,Je,_t),s.bN(D,At+2,at,Je,_t),s.bN(D,At+3,at,Je,_t)}const[Pt,qe,Ae]=it.point;s.bO(O,Pt,qe,Ae,it.angle)};if(he>1){const it=Ru(se,S,me,fe,c,N,z,m,I,v,U,H,!1,J,Z,ee,ie);if(!it)return{notEnoughRoom:!0};if(p&&!c){let[Pt,qe,Ae]=it.first.point,[at,Je,_t]=it.last.point;[Pt,qe]=Oo(Pt,qe,Ae,w),[at,Je]=Oo(at,Je,_t,w);const At=ku(Ke,Le,(at-Pt)*G,Je-qe);if(m.flipState=At&&At.needsFlipping?ql.flipRequired:ql.flipNotRequired,At)return At}We(it.first);for(let Pt=pe+1;Pt<pe+he-1;Pt++){const qe=zd(se*S.getoffsetX(Pt),me,fe,c,N,z,_e,ge,st,I,v,U,H,!1,!1,J,Z,ee,ie);if(!qe)return O.length-=4*(Pt-pe),{notEnoughRoom:!0};We(qe)}We(it.last)}else{if(p&&!c){const Pt=Oo(z.x,z.y,0,y),qe=ge+_e+1,Ae=new s.P(I.getx(qe),I.gety(qe)),at=Oo(Ae.x,Ae.y,0,y),Je=at[3]>0?at:Ou(z,Ae,Pt,1,y,void 0,J,Z.canonical),_t=ku(Ke,Le,(Je[0]-Pt[0])*G,Je[1]-Pt[1]);if(m.flipState=_t&&_t.needsFlipping?ql.flipRequired:ql.flipNotRequired,_t)return _t}const it=zd(se*S.getoffsetX(pe),me,fe,c,N,z,_e,ge,st,I,v,U,H,!1,!1,J,Z,ee,ie);if(!it)return{notEnoughRoom:!0};We(it)}return{}}function Ld(m,i,c,p,y){const{x:v,y:w,z:S}=p.projectTilePoint(m.x,m.y,i);if(!y)return Oo(v,w,S,c);const[I,O,D]=y(m);return Oo(v+I,w+O,S+D,c)}function Ou(m,i,c,p,y,v,w,S){const I=Ld(m.sub(i)._unit()._add(m),S,y,w,v);return s.av(I,c,I),s.aw(I,I),s.bH(I,c,I,p)}function zd(m,i,c,p,y,v,w,S,I,O,D,N,z,U,G,H,J,Z,ee){const ie=p?m-i:m+i;let se=ie>0?1:-1,me=0;p&&(se*=-1,me=Math.PI),se<0&&(me+=Math.PI);let fe=S+w+(se>0?0:1)|0,ge=y,pe=y,he=0,_e=0;const Ke=Math.abs(ie),Le=[],st=[];let We=v,it=We,Pt=s.bF([]);const qe=()=>Ou(it,We,pe,Ke-he+1,D,z,H,J.canonical);for(;he+_e<=Ke;){if(fe+=se,fe<S||fe>=I)return null;if(pe=ge,it=We,Le.push(pe),U&&st.push(it),We=new s.P(O.getx(fe),O.gety(fe)),ge=N[fe],!ge){const en=Ld(We,J.canonical,D,H,z);ge=en[3]>0?N[fe]=en:qe()}he+=_e;const bt=s.av([],ge,pe),un=s.bG(pe,ge);if(c&&un>0&&_e>0&&s.bJ(Pt,bt)/(_e*un)<ee)return null;_e=un,Pt=bt}G&&z&&(N[fe]&&(ge=qe(),_e=s.bG(pe,ge),Pt=s.av([],ge,pe)),N[fe]=ge);const Ae=(Ke-he)/_e,at=We.sub(it)._mult(Ae)._add(it),Je=s.bH([],pe,Pt,Ae);let _t=[0,0,1],At=Pt[0],Ut=Pt[1];if(Z&&(_t=H.upVector(J.canonical,at.x,at.y),_t[0]!==0||_t[1]!==0||_t[2]!==1)){const bt=[_t[2],0,-_t[0]],un=s.bI([],_t,bt);s.aw(bt,bt),s.aw(un,un),At=s.bJ(Pt,bt),Ut=s.bJ(Pt,un)}if(c){const bt=s.bI([],_t,Pt);s.aw(bt,bt),s.bH(Je,Je,bt,c*se)}const St=me+Math.atan2(Ut,At);return Le.push(Je),U&&st.push(at),{point:Je,angle:St,path:Le,tilePath:st,up:_t}}function wn(m,i){const c=i.length,p=c+4*m;i.resize(p),i.float32.fill(-1/0,4*c,4*p)}function Zl(m,i,c){const p=i[0],y=i[1];return m[0]=c[0]*p+c[4]*y+c[12],m[1]=c[1]*p+c[5]*y+c[13],m[3]=c[3]*p+c[7]*y+c[15],m}const bs=100;class Ks{constructor(i,c,p=new _f(i.width+200,i.height+200,25),y=new _f(i.width+200,i.height+200,25)){this.transform=i,this.grid=p,this.ignoredGrid=y,this.pitchfactor=Math.cos(i._pitch)*i.cameraToCenterDistance,this.screenRightBoundary=i.width+bs,this.screenBottomBoundary=i.height+bs,this.gridRightBoundary=i.width+200,this.gridBottomBoundary=i.height+200,this.fogState=c}placeCollisionBox(i,c,p,y,v,w,S,I,O,D,N){let z=p.projectedAnchorX,U=p.projectedAnchorY,G=p.projectedAnchorZ;const H=p.tileAnchorX,J=p.tileAnchorY,Z=p.elevation,ee=p.tileID,ie=i.getProjection();if(Z&&ee){const[st,We,it]=ie.upVector(ee.canonical,p.tileAnchorX,p.tileAnchorY),Pt=ie.upVectorScale(ee.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;z+=st*Z*Pt,U+=We*Z*Pt,G+=it*Z*Pt}const se=i.projection.name==="globe",me=i.projection.name==="globe"?s.aj(this.transform.zoom):0;if(ee&&se&&me<1&&!w){const st=1<<ee.canonical.z,We=s.bP(H,J);s.bQ(We,We,1/s.al),s.bR(We,We,s.bP(ee.canonical.x,ee.canonical.y)),s.bQ(We,We,1/st),s.bS(We,We,s.bP(y[0],y[1])),We[0]=s.bT(We[0],-.5,.5),s.bQ(We,We,s.al);const it=s.bU(We[0],We[1],s.al/(2*Math.PI),1);s.aC(it,it,v),z=s.ak(z,it[0],me),U=s.ak(U,it[1],me),G=s.ak(G,it[2],me)}const fe=this.projectAndGetPerspectiveRatio(D,z,U,G,p.tileID,ie.name==="globe"||!!Z||this.transform.pitch>0,ie),ge=O*fe.perspectiveRatio,pe=(p.x1*c+S.x-p.padding)*ge+fe.point.x,he=(p.y1*c+S.y-p.padding)*ge+fe.point.y,_e=(p.x2*c+S.x+p.padding)*ge+fe.point.x,Ke=(p.y2*c+S.y+p.padding)*ge+fe.point.y,Le=fe.perspectiveRatio<=.55||fe.occluded;return!this.isInsideGrid(pe,he,_e,Ke)||!I&&this.grid.hitTest(pe,he,_e,Ke,N)||Le?{box:[],offscreen:!1,occluded:fe.occluded}:{box:[pe,he,_e,Ke],offscreen:this.isOffscreen(pe,he,_e,Ke),occluded:!1}}placeCollisionCircles(i,c,p,y,v,w,S,I,O,D,N,z,U,G,H){const J=[],Z=this.transform.elevation,ee=i.getProjection(),ie=Z?Z.getAtTileOffsetFunc(H,this.transform.center.lat,this.transform.worldSize,ee):null,se=new s.P(p.tileAnchorX,p.tileAnchorY);let{x:me,y:fe,z:ge}=ee.projectTilePoint(se.x,se.y,H.canonical);if(ie){const[_t,At,Ut]=ie(se);me+=_t,fe+=At,ge+=Ut}const pe=ee.name==="globe",he=this.projectAndGetPerspectiveRatio(S,me,fe,ge,H,pe||!!Z||this.transform.pitch>0,ee),{perspectiveRatio:_e}=he,Ke=(N?w/_e:w*_e)/s.bX,Le=Oo(me,fe,ge,I),st=p.lineOffsetX*Ke,We=p.lineOffsetY*Ke,it=s.an(i.layers[0].layout.get("text-max-angle")),Pt=Math.cos(it),qe=he.signedDistanceFromCamera>0?Ru(Ke,v,st,We,!1,Le,se,p,y,I,{},Z&&!N?ie:null,N&&!!Z,ee,H,N,Pt):null;let Ae=!1,at=!1,Je=!0;if(qe&&!he.occluded){const _t=.5*U*_e+G,At=new s.P(-100,-100),Ut=new s.P(this.screenRightBoundary,this.screenBottomBoundary),St=new Lp,{first:bt,last:un}=qe,en=bt.path.length;let an=[];for(let Hn=en-1;Hn>=1;Hn--)an.push(bt.path[Hn]);for(let Hn=1;Hn<un.path.length;Hn++)an.push(un.path[Hn]);const Qt=2.5*_t;O&&(an=an.map((([Hn,qn,Wr],Bn)=>(ie&&!pe&&(Wr=ie(Bn<en-1?bt.tilePath[en-1-Bn]:un.tilePath[Bn-en+2])[2]),Oo(Hn,qn,Wr,O)))),an.some((Hn=>Hn[3]<=0))&&(an=[]));let Ln=[];if(an.length>0){let Hn=1/0,qn=-1/0,Wr=1/0,Bn=-1/0;for(const Or of an)Hn=Math.min(Hn,Or[0]),Wr=Math.min(Wr,Or[1]),qn=Math.max(qn,Or[0]),Bn=Math.max(Bn,Or[1]);qn>=At.x&&Hn<=Ut.x&&Bn>=At.y&&Wr<=Ut.y&&(Ln=[an.map((Or=>new s.P(Or[0],Or[1])))],(Hn<At.x||qn>Ut.x||Wr<At.y||Bn>Ut.y)&&(Ln=s.bV(Ln,At.x,At.y,Ut.x,Ut.y)))}for(const Hn of Ln){St.reset(Hn,.25*_t);let qn=0;qn=St.length<=.5*_t?1:Math.ceil(St.paddedLength/Qt)+1;for(let Wr=0;Wr<qn;Wr++){const Bn=Wr/Math.max(qn-1,1),Or=St.lerp(Bn),Gr=Or.x+bs,Ti=Or.y+bs;J.push(Gr,Ti,_t,0);const Wn=Gr-_t,Lr=Ti-_t,Mr=Gr+_t,$r=Ti+_t;if(Je=Je&&this.isOffscreen(Wn,Lr,Mr,$r),at=at||this.isInsideGrid(Wn,Lr,Mr,$r),!c&&this.grid.hitTestCircle(Gr,Ti,_t,z)&&(Ae=!0,!D))return{circles:[],offscreen:!1,collisionDetected:Ae,occluded:!1}}}}return{circles:!D&&Ae||!at?[]:J,offscreen:Je,collisionDetected:Ae,occluded:he.occluded}}queryRenderedSymbols(i){if(i.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const c=[];let p=1/0,y=1/0,v=-1/0,w=-1/0;for(const D of i){const N=new s.P(D.x+bs,D.y+bs);p=Math.min(p,N.x),y=Math.min(y,N.y),v=Math.max(v,N.x),w=Math.max(w,N.y),c.push(N)}const S=this.grid.query(p,y,v,w).concat(this.ignoredGrid.query(p,y,v,w)),I={},O={};for(const D of S){const N=D.key;if(I[N.bucketInstanceId]===void 0&&(I[N.bucketInstanceId]={}),I[N.bucketInstanceId][N.featureIndex])continue;const z=[new s.P(D.x1,D.y1),new s.P(D.x2,D.y1),new s.P(D.x2,D.y2),new s.P(D.x1,D.y2)];s.bW(c,z)&&(I[N.bucketInstanceId][N.featureIndex]=!0,O[N.bucketInstanceId]===void 0&&(O[N.bucketInstanceId]=[]),O[N.bucketInstanceId].push(N.featureIndex))}return O}insertCollisionBox(i,c,p,y,v){(c?this.ignoredGrid:this.grid).insert({bucketInstanceId:p,featureIndex:y,collisionGroupID:v},i[0],i[1],i[2],i[3])}insertCollisionCircles(i,c,p,y,v){const w=c?this.ignoredGrid:this.grid,S={bucketInstanceId:p,featureIndex:y,collisionGroupID:v};for(let I=0;I<i.length;I+=4)w.insertCircle(S,i[I],i[I+1],i[I+2])}projectAndGetPerspectiveRatio(i,c,p,y,v,w,S){const I=[c,p,y,1];let O=!1;y||this.transform.pitch>0?(s.aC(I,I,i),this.fogState&&v&&S.name!=="globe"&&(O=(function(z,U,G,H,J,Z){const ee=Z.calculateFogTileMatrix(J),ie=[U,G,H];return s.af(ie,ie,ee),xn(z,s.ag(ie),Z.pitch,Z._fov)})(this.fogState,c,p,y,v.toUnwrapped(),this.transform)>.9)):Zl(I,I,i);const D=I[3];return{point:new s.P((I[0]/D+1)/2*this.transform.width+bs,(-I[1]/D+1)/2*this.transform.height+bs),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(S)/D*.5,1.5),signedDistanceFromCamera:D,occluded:w&&I[2]>D||O}}isOffscreen(i,c,p,y){return p<bs||i>=this.screenRightBoundary||y<bs||c>this.screenBottomBoundary}isInsideGrid(i,c,p,y){return p>=0&&i<this.gridRightBoundary&&y>=0&&c<this.gridBottomBoundary}getViewportMatrix(){const i=s.bA([]);return s.br(i,i,[-100,-100,0]),i}}class Cc{constructor(i,c,p,y){this.opacity=i?Math.max(0,Math.min(1,i.opacity+(i.placed?c:-c))):y&&p?1:0,this.placed=p}isHidden(){return this.opacity===0&&!this.placed}}class Zs{constructor(i,c,p,y,v,w=!1){this.text=new Cc(i?i.text:null,c,p,v),this.icon=new Cc(i?i.icon:null,c,y,v),this.clipped=w}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class sn{constructor(i,c,p,y=!1){this.text=i,this.icon=c,this.skipFade=p,this.clipped=y}}class Rr{constructor(){this.invProjMatrix=s.bC(),this.viewportMatrix=s.bC(),this.circles=[]}}class Vr{constructor(i,c,p,y,v){this.bucketInstanceId=i,this.featureIndex=c,this.sourceLayerIndex=p,this.bucketIndex=y,this.tileID=v}}class us{constructor(i){this.crossSourceCollisions=i,this.maxGroupID=0,this.collisionGroups={}}get(i){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[i]){const c=++this.maxGroupID;this.collisionGroups[i]={ID:c,predicate:p=>p.collisionGroupID===c}}return this.collisionGroups[i]}}function Fs(m,i,c,p,y){const{horizontalAlign:v,verticalAlign:w}=s.c0(m),S=-(v-.5)*i,I=-(w-.5)*c,O=s.c1(m,p);return new s.P(S+O[0]*y,I+O[1]*y)}function kr(m,i,c,p,y){const v=new s.P(m,i);return c&&v._rotate(p?y:-y),v}class Mu{constructor(i,c,p,y,v,w){this.transform=i.clone(),this.projection=i.projection.name,this.collisionIndex=new Ks(this.transform,v),this.buildingIndex=w,this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=c,this.retainedQueryData={},this.collisionGroups=new us(p),this.collisionCircleArrays={},this.prevPlacement=y,y&&(y.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(i,c,p,y,v=1){const w=p.getBucket(c),S=p.latestFeatureIndex;if(!w||!S||c.fqid!==w.layerIds[0])return;const I=w.layers[0].layout,O=w.layers[0].paint,D=p.collisionBoxArray,N=Math.pow(2,this.transform.zoom-p.tileID.overscaledZ),z=p.tileSize/s.al,U=p.tileID.toUnwrapped();this.transform.setProjection(w.projection);const G=(H=p.tileID,J=w.getProjection(),Z=this.transform,J.name===this.projection?Z.calculateProjMatrix(H.toUnwrapped()):Iu(Z,J,H));var H,J,Z;const ee=I.get("text-pitch-alignment")==="map",ie=I.get("text-rotation-alignment")==="map";c.compileFilter(c.options);const se=c.dynamicFilter(),me=c.dynamicFilterNeedsFeature(),fe=this.transform.calculatePixelsToTileUnitsMatrix(p),ge=bl(G,p.tileID.canonical,ee,ie,this.transform,w.getProjection(),fe);let pe=null;const he=w.getProjection().createInversionMatrix(this.transform,p.tileID.canonical);if(ee){const Ae=Pu(G,p.tileID.canonical,ee,ie,this.transform,w.getProjection(),fe);pe=s.aB([],this.transform.labelPlaneMatrix,Ae)}let _e=null;se&&p.latestFeatureIndex&&(_e={unwrappedTileID:U,dynamicFilter:se,dynamicFilterNeedsFeature:me}),this.retainedQueryData[w.bucketInstanceId]=new Vr(w.bucketInstanceId,S,w.sourceLayerIndex,w.index,p.tileID);const[Ke,Le]=w.layers[0].layout.get("text-size-scale-range"),st=s.aA(v,Ke,Le),[We,it]=I.get("icon-size-scale-range"),Pt=s.aA(v,We,it),qe={bucket:w,layout:I,paint:O,posMatrix:G,invMatrix:he,mercatorCenter:[s.aF(this.transform.center.lng),s.aJ(this.transform.center.lat)],textLabelPlaneMatrix:ge,labelToScreenMatrix:pe,clippingData:_e,scale:N,textPixelRatio:z,holdingForFade:p.holdingForFade(),collisionBoxArray:D,partiallyEvaluatedTextSize:s.bK(w.textSizeData,this.transform.zoom,st),partiallyEvaluatedIconSize:s.bK(w.iconSizeData,this.transform.zoom,Pt),collisionGroup:this.collisionGroups.get(w.sourceID),latestFeatureIndex:p.latestFeatureIndex};if(y)for(const Ae of w.sortKeyRanges){const{sortKey:at,symbolInstanceStart:Je,symbolInstanceEnd:_t}=Ae;i.push({sortKey:at,symbolInstanceStart:Je,symbolInstanceEnd:_t,parameters:qe})}else i.push({symbolInstanceStart:0,symbolInstanceEnd:w.symbolInstances.length,parameters:qe})}attemptAnchorPlacement(i,c,p,y,v,w,S,I,O,D,N,z,U,G,H,J,Z,ee,ie,se,me){const{textOffset0:fe,textOffset1:ge,crossTileID:pe}=H,he=[fe,ge],_e=Fs(i,w,S,he,I),Ke=this.collisionIndex.placeCollisionBox(Z,I,c,p,y,v,kr(_e.x,_e.y,O,D,this.transform.angle),G,N,z,U.predicate);if(ie){const Le=Z.getSymbolInstanceIconSize(me,this.transform.zoom,H.placedIconSymbolIndex);if(this.collisionIndex.placeCollisionBox(Z,Le,ie,p,y,v,kr(_e.x,_e.y,O,D,this.transform.angle),G,N,z,U.predicate).box.length===0)return}if(Ke.box.length>0){let Le;return this.prevPlacement&&this.prevPlacement.variableOffsets[pe]&&this.prevPlacement.placements[pe]&&this.prevPlacement.placements[pe].text&&(Le=this.prevPlacement.variableOffsets[pe].anchor),this.variableOffsets[pe]={textOffset:he,width:w,height:S,anchor:i,textScale:I,prevAnchor:Le},this.markUsedJustification(Z,i,H,ee),Z.allowVerticalPlacement&&(this.markUsedOrientation(Z,ee,H),this.placedOrientations[pe]=ee),{shift:_e,placedGlyphBoxes:Ke}}}placeLayerBucketPart(i,c,p,y,v=1){const{bucket:w,layout:S,paint:I,posMatrix:O,textLabelPlaneMatrix:D,labelToScreenMatrix:N,clippingData:z,textPixelRatio:U,mercatorCenter:G,invMatrix:H,holdingForFade:J,collisionBoxArray:Z,partiallyEvaluatedTextSize:ee,partiallyEvaluatedIconSize:ie,collisionGroup:se,latestFeatureIndex:me}=i.parameters,fe=S.get("text-optional"),ge=S.get("icon-optional"),pe=S.get("text-allow-overlap"),he=S.get("icon-allow-overlap"),_e=S.get("text-rotation-alignment")==="map",Ke=S.get("icon-rotation-alignment")==="map",Le=S.get("text-pitch-alignment")==="map",st=I.get("symbol-z-offset"),We=S.get("symbol-elevation-reference")==="sea",it=S.get("symbol-placement"),[Pt,qe]=S.get("text-size-scale-range"),[Ae,at]=S.get("icon-size-scale-range"),Je=s.aA(v,Pt,qe),_t=s.aA(v,Ae,at),At=S.get("text-variable-anchor"),Ut=_e&&it!=="point",St=Ke&&it!=="point",bt=At&&w.hasTextData(),un=w.hasIconTextFit()&&bt&&w.hasIconData();this.transform.setProjection(w.projection);const en=bt||Ut,an=St||un;let Qt=pe&&(he||!w.hasIconData()||ge),Ln=he&&(pe||!w.hasTextData()||fe);const Hn=!st.isConstant();!w.collisionArrays&&Z&&w.deserializeCollisionBoxes(Z),p&&y&&w.updateCollisionDebugBuffers(this.transform.zoom,Z,Je,_t);const qn=(Bn,Or,Gr)=>{const{crossTileID:Ti,numVerticalGlyphVertices:Wn}=Bn;let Lr=null;if(z&&z.dynamicFilterNeedsFeature||Hn){const eo=this.retainedQueryData[w.bucketInstanceId];Lr=me.loadFeature({featureIndex:Bn.featureIndex,bucketIndex:eo.bucketIndex,sourceLayerIndex:eo.sourceLayerIndex,layoutVertexArrayOffset:0})}if(z&&!(0,z.dynamicFilter)({zoom:this.transform.zoom,pitch:this.transform.pitch},Lr,this.retainedQueryData[w.bucketInstanceId].tileID.canonical,new s.P(Bn.tileAnchorX,Bn.tileAnchorY),this.transform.calculateDistanceTileData(z.unwrappedTileID)))return this.placements[Ti]=new sn(!1,!1,!1,!0),void c.add(Ti);const Mr=st.evaluate(Lr,{});if(c.has(Ti))return;if(J)return void(this.placements[Ti]=new sn(!1,!1,!1));let $r=!1,Ei=!1,no=!0,Vo=!1,Ci=!1,Kn=null,kn={box:null,offscreen:null,occluded:null},qr={box:null},qi=null,ki=null,yo=null,Ko=0,va=0,ba=0;Gr.textFeatureIndex?Ko=Gr.textFeatureIndex:Bn.useRuntimeCollisionCircles&&(Ko=Bn.featureIndex),Gr.verticalTextFeatureIndex&&(va=Gr.verticalTextFeatureIndex);const Ys=eo=>{eo.tileID=this.retainedQueryData[w.bucketInstanceId].tileID;const ro=this.transform.elevation;eo.elevation=We?Mr:Mr+(ro?ro.getAtTileOffset(eo.tileID,eo.tileAnchorX,eo.tileAnchorY):0),eo.elevation+=Bn.zOffset},Js=Gr.textBox;if(Js){Ys(Js);const eo=Oi=>{let Io=s.bL.horizontal;if(w.allowVerticalPlacement&&!Oi&&this.prevPlacement){const $o=this.prevPlacement.placedOrientations[Ti];$o&&(this.placedOrientations[Ti]=$o,Io=$o,this.markUsedOrientation(w,Io,Bn))}return Io},ro=(Oi,Io)=>{if(w.allowVerticalPlacement&&Wn>0&&Gr.verticalTextBox){for(const $o of w.writingModes)if($o===s.bL.vertical?(kn=Io(),qr=kn):kn=Oi(),kn&&kn.box&&kn.box.length)break}else kn=Oi()};if(At){let Oi=At;if(this.prevPlacement&&this.prevPlacement.variableOffsets[Ti]){const mo=this.prevPlacement.variableOffsets[Ti];Oi.indexOf(mo.anchor)>0&&(Oi=Oi.filter((ns=>ns!==mo.anchor)),Oi.unshift(mo.anchor))}const Io=(mo,ns,Al)=>{const tc=w.getSymbolInstanceTextSize(ee,Bn,this.transform.zoom,Or),rl=(mo.x2-mo.x1)*tc+2*mo.padding,Gc=(mo.y2-mo.y1)*tc+2*mo.padding,Hc=Bn.hasIconTextFit&&!he?ns:null;Hc&&Ys(Hc);let Pl={box:[],offscreen:!1,occluded:!1};const lh=pe?2*Oi.length:Oi.length;for(let nc=0;nc<lh;++nc){const Rl=this.attemptAnchorPlacement(Oi[nc%Oi.length],mo,G,H,en,rl,Gc,tc,_e,Le,U,O,se,nc>=Oi.length,Bn,Or,w,Al,Hc,ee,ie);if(Rl&&(Pl=Rl.placedGlyphBoxes,Pl&&Pl.box&&Pl.box.length)){$r=!0,Kn=Rl.shift;break}}return Pl};ro((()=>Io(Js,Gr.iconBox,s.bL.horizontal)),(()=>{const mo=Gr.verticalTextBox;return mo&&Ys(mo),w.allowVerticalPlacement&&!(kn&&kn.box&&kn.box.length)&&Wn>0&&mo?Io(mo,Gr.verticalIconBox,s.bL.vertical):{box:null,offscreen:null,occluded:null}})),kn&&($r=kn.box,no=kn.offscreen,Vo=kn.occluded);const $o=eo(!(!kn||!kn.box));if(!$r&&this.prevPlacement){const mo=this.prevPlacement.variableOffsets[Ti];mo&&(this.variableOffsets[Ti]=mo,this.markUsedJustification(w,mo.anchor,Bn,$o))}}else{const Oi=(Io,$o)=>{const mo=w.getSymbolInstanceTextSize(ee,Bn,this.transform.zoom,Or),ns=this.collisionIndex.placeCollisionBox(w,mo,Io,G,H,en,new s.P(0,0),pe,U,O,se.predicate);return ns&&ns.box&&ns.box.length&&(this.markUsedOrientation(w,$o,Bn),this.placedOrientations[Ti]=$o),ns};ro((()=>Oi(Js,s.bL.horizontal)),(()=>{const Io=Gr.verticalTextBox;return w.allowVerticalPlacement&&Wn>0&&Io?(Ys(Io),Oi(Io,s.bL.vertical)):{box:null,offscreen:null,occluded:null}})),eo(!!(kn&&kn.box&&kn.box.length))}}if(qi=kn,$r=qi&&qi.box&&qi.box.length>0,no=qi&&qi.offscreen,Vo=qi&&qi.occluded,Bn.useRuntimeCollisionCircles){const eo=w.text.placedSymbolArray.get(Bn.centerJustifiedTextSymbolIndex>=0?Bn.centerJustifiedTextSymbolIndex:Bn.verticalPlacedTextSymbolIndex),ro=s.bM(w.textSizeData,ee,eo),Oi=S.get("text-padding");ki=this.collisionIndex.placeCollisionCircles(w,pe,eo,w.lineVertexArray,w.glyphOffsetArray,ro,O,D,N,p,Le,se.predicate,Bn.collisionCircleDiameter*ro/s.bX,Oi,this.retainedQueryData[w.bucketInstanceId].tileID),$r=pe||ki.circles.length>0&&!ki.collisionDetected,no=no&&ki.offscreen,Vo=ki.occluded}if(Gr.iconFeatureIndex&&(ba=Gr.iconFeatureIndex),Gr.iconBox){const eo=ro=>{Ys(ro);const Oi=Bn.hasIconTextFit&&Kn?kr(Kn.x,Kn.y,_e,Le,this.transform.angle):new s.P(0,0),Io=w.getSymbolInstanceIconSize(ie,this.transform.zoom,Bn.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(w,Io,ro,G,H,an,Oi,he,U,O,se.predicate)};qr&&qr.box&&qr.box.length&&Gr.verticalIconBox?(yo=eo(Gr.verticalIconBox),Ei=yo.box.length>0):(yo=eo(Gr.iconBox),Ei=yo.box.length>0),no=no&&yo.offscreen,Ci=yo.occluded}const Ts=fe||Bn.numHorizontalGlyphVertices===0&&Wn===0,Ba=ge||Bn.numIconVertices===0;if(Ts||Ba?Ba?Ts||(Ei=Ei&&$r):$r=Ei&&$r:Ei=$r=Ei&&$r,$r&&qi&&qi.box&&this.collisionIndex.insertCollisionBox(qi.box,S.get("text-ignore-placement"),w.bucketInstanceId,qr&&qr.box&&va?va:Ko,se.ID),Ei&&yo&&this.collisionIndex.insertCollisionBox(yo.box,S.get("icon-ignore-placement"),w.bucketInstanceId,ba,se.ID),ki&&($r&&this.collisionIndex.insertCollisionCircles(ki.circles,S.get("text-ignore-placement"),w.bucketInstanceId,Ko,se.ID),p)){const eo=w.bucketInstanceId;let ro=this.collisionCircleArrays[eo];ro===void 0&&(ro=this.collisionCircleArrays[eo]=new Rr);for(let Oi=0;Oi<ki.circles.length;Oi+=4)ro.circles.push(ki.circles[Oi+0]),ro.circles.push(ki.circles[Oi+1]),ro.circles.push(ki.circles[Oi+2]),ro.circles.push(ki.collisionDetected?1:0)}const nl=w.projection.name!=="globe";Qt=Qt&&(nl||!Vo),Ln=Ln&&(nl||!Ci),this.placements[Ti]=new sn($r||Qt,Ei||Ln,no||w.justReloaded),c.add(Ti)},Wr=this.retainedQueryData[w.bucketInstanceId].tileID;if(w.elevationType==="offset"&&this.buildingIndex&&this.buildingIndex.updateZOffset(w,Wr),w.elevationType==="road"&&w.updateRoadElevation(Wr.canonical),w.updateZOffset(),w.sortFeaturesByY){const Bn=w.getSortedSymbolIndexes(this.transform.angle);for(let Or=Bn.length-1;Or>=0;--Or){const Gr=Bn[Or];qn(w.symbolInstances.get(Gr),Gr,w.collisionArrays[Gr])}w.hasAnyZOffset&&s.w(`${w.layerIds[0]} layer symbol-z-elevate: symbols are not sorted by elevation if symbol-z-order is evaluated to viewport-y`)}else if(w.hasAnyZOffset){const Bn=w.getSortedIndexesByZOffset();for(let Or=0;Or<Bn.length;++Or){const Gr=Bn[Or];qn(w.symbolInstances.get(Gr),Gr,w.collisionArrays[Gr])}}else for(let Bn=i.symbolInstanceStart;Bn<i.symbolInstanceEnd;Bn++)qn(w.symbolInstances.get(Bn),Bn,w.collisionArrays[Bn]);if(p&&w.bucketInstanceId in this.collisionCircleArrays){const Bn=this.collisionCircleArrays[w.bucketInstanceId];s.bl(Bn.invProjMatrix,O),Bn.viewportMatrix=this.collisionIndex.getViewportMatrix()}w.justReloaded=!1}markUsedJustification(i,c,p,y){const{leftJustifiedTextSymbolIndex:v,centerJustifiedTextSymbolIndex:w,rightJustifiedTextSymbolIndex:S,verticalPlacedTextSymbolIndex:I,crossTileID:O}=p,D=s.c2(c),N=y===s.bL.vertical?I:D==="left"?v:D==="center"?w:D==="right"?S:-1;v>=0&&(i.text.placedSymbolArray.get(v).crossTileID=N>=0&&v!==N?0:O),w>=0&&(i.text.placedSymbolArray.get(w).crossTileID=N>=0&&w!==N?0:O),S>=0&&(i.text.placedSymbolArray.get(S).crossTileID=N>=0&&S!==N?0:O),I>=0&&(i.text.placedSymbolArray.get(I).crossTileID=N>=0&&I!==N?0:O)}markUsedOrientation(i,c,p){const y=c===s.bL.horizontal||c===s.bL.horizontalOnly?c:0,v=c===s.bL.vertical?c:0,{leftJustifiedTextSymbolIndex:w,centerJustifiedTextSymbolIndex:S,rightJustifiedTextSymbolIndex:I,verticalPlacedTextSymbolIndex:O}=p,D=i.text.placedSymbolArray;w>=0&&(D.get(w).placedOrientation=y),S>=0&&(D.get(S).placedOrientation=y),I>=0&&(D.get(I).placedOrientation=y),O>=0&&(D.get(O).placedOrientation=v)}commit(i){this.commitTime=i,this.zoomAtLastRecencyCheck=this.transform.zoom;const c=this.prevPlacement;let p=!1;this.prevZoomAdjustment=c?c.zoomAdjustment(this.transform.zoom):0;const y=c?c.symbolFadeChange(i):1,v=c?c.opacities:{},w=c?c.variableOffsets:{},S=c?c.placedOrientations:{};for(const I in this.placements){const O=this.placements[I],D=v[I];D?(this.opacities[I]=new Zs(D,y,O.text,O.icon,null,O.clipped),p=p||O.text!==D.text.placed||O.icon!==D.icon.placed):(this.opacities[I]=new Zs(null,y,O.text,O.icon,O.skipFade,O.clipped),p=p||O.text||O.icon)}for(const I in v){const O=v[I];if(!this.opacities[I]){const D=new Zs(O,y,!1,!1);D.isHidden()||(this.opacities[I]=D,p=p||O.text.placed||O.icon.placed)}}for(const I in w)this.variableOffsets[I]||!this.opacities[I]||this.opacities[I].isHidden()||(this.variableOffsets[I]=w[I]);for(const I in S)this.placedOrientations[I]||!this.opacities[I]||this.opacities[I].isHidden()||(this.placedOrientations[I]=S[I]);p?this.lastPlacementChangeTime=i:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=c?c.lastPlacementChangeTime:i)}updateLayerOpacities(i,c,p,y){const v=new Set;for(const w of c){const S=w.getBucket(i);S&&w.latestFeatureIndex&&i.fqid===S.layerIds[0]&&(this.updateBucketOpacities(S,v,w,w.collisionBoxArray,p,y,w.tileID,i.scope),S.elevationType==="offset"&&this.buildingIndex&&this.buildingIndex.updateZOffset(S,w.tileID),S.elevationType==="road"&&S.updateRoadElevation(w.tileID.canonical),S.updateZOffset())}}updateBucketOpacities(i,c,p,y,v,w,S,I){i.hasTextData()&&i.text.opacityVertexArray.clear(),i.hasIconData()&&i.icon.opacityVertexArray.clear(),i.hasIconCollisionBoxData()&&i.iconCollisionBox.collisionVertexArray.clear(),i.hasTextCollisionBoxData()&&i.textCollisionBox.collisionVertexArray.clear();const O=i.layers[0].layout,D=i.layers[0].paint,N=!!i.layers[0].dynamicFilter(),z=new Zs(null,0,!1,!1,!0),U=O.get("text-allow-overlap"),G=O.get("icon-allow-overlap"),H=O.get("text-variable-anchor"),J=O.get("text-rotation-alignment")==="map",Z=O.get("text-pitch-alignment")==="map",ee=D.get("symbol-z-offset"),ie=O.get("symbol-elevation-reference")==="sea",se=!ee.isConstant(),me=new Zs(null,0,U&&(G||!i.hasIconData()||O.get("icon-optional")),G&&(U||!i.hasTextData()||O.get("text-optional")),!0);!i.collisionArrays&&y&&(i.hasIconCollisionBoxData()||i.hasTextCollisionBoxData())&&i.deserializeCollisionBoxes(y);const fe=(pe,he,_e)=>{for(let Ke=0;Ke<he/4;Ke++)pe.opacityVertexArray.emplaceBack(_e)};let ge=0;w&&i.updateReplacement(S,w);for(let pe=0;pe<i.symbolInstances.length;pe++){const he=i.symbolInstances.get(pe),{numHorizontalGlyphVertices:_e,numVerticalGlyphVertices:Ke,crossTileID:Le,numIconVertices:st,tileAnchorX:We,tileAnchorY:it}=he;let Pt=null;const qe=this.retainedQueryData[i.bucketInstanceId];se&&he&&qe&&(Pt=p.latestFeatureIndex.loadFeature({featureIndex:he.featureIndex,bucketIndex:qe.bucketIndex,sourceLayerIndex:qe.sourceLayerIndex,layoutVertexArrayOffset:0}));const Ae=ee.evaluate(Pt,{}),at=c.has(Le);let Je=this.opacities[Le];at?Je=z:Je||(Je=me,this.opacities[Le]=Je),c.add(Le);const _t=_e>0||Ke>0,At=st>0,Ut=this.placedOrientations[Le],St=Ut===s.bL.vertical,bt=Ut===s.bL.horizontal||Ut===s.bL.horizontalOnly;!_t&&!At||Je.isHidden()||ge++;let un=!1;if((_t||At)&&w)for(const en of i.activeReplacements){if(s.bY(en,v,s.bZ.Symbol,I)||en.min.x>We||We>en.max.x||en.min.y>it||it>en.max.y)continue;const an=s.b_(We,it,S.canonical,en.footprintTileId.canonical);if(un=s.b$(an,en.footprint),un)break}if(_t){const en=un?te:X(Je.text);fe(i.text,_e,St?te:en),fe(i.text,Ke,bt?te:en);const an=Je.text.isHidden(),{leftJustifiedTextSymbolIndex:Qt,centerJustifiedTextSymbolIndex:Ln,rightJustifiedTextSymbolIndex:Hn,verticalPlacedTextSymbolIndex:qn}=he,Wr=i.text.placedSymbolArray,Bn=an||St?1:0;Qt>=0&&(Wr.get(Qt).hidden=Bn),Ln>=0&&(Wr.get(Ln).hidden=Bn),Hn>=0&&(Wr.get(Hn).hidden=Bn),qn>=0&&(Wr.get(qn).hidden=an||bt?1:0);const Or=this.variableOffsets[Le];Or&&this.markUsedJustification(i,Or.anchor,he,Ut);const Gr=this.placedOrientations[Le];Gr&&(this.markUsedJustification(i,"left",he,Gr),this.markUsedOrientation(i,Gr,he))}if(At){const en=un?te:X(Je.icon),{placedIconSymbolIndex:an,verticalPlacedIconSymbolIndex:Qt}=he,Ln=i.icon.placedSymbolArray,Hn=Je.icon.isHidden()?1:0;an>=0&&(fe(i.icon,st,St?te:en),Ln.get(an).hidden=Hn),Qt>=0&&(fe(i.icon,he.numVerticalIconVertices,bt?te:en),Ln.get(Qt).hidden=Hn)}if(i.hasIconCollisionBoxData()||i.hasTextCollisionBoxData()){const en=i.collisionArrays[pe];if(en){let an=new s.P(0,0),Qt=!0;if(en.textBox||en.verticalTextBox){if(H){const Hn=this.variableOffsets[Le];Hn?(an=Fs(Hn.anchor,Hn.width,Hn.height,Hn.textOffset,Hn.textScale),J&&an._rotate(Z?this.transform.angle:-this.transform.angle)):Qt=!1}N&&(Qt=!Je.clipped),en.textBox&&Xa(i.textCollisionBox.collisionVertexArray,Je.text.placed,!Qt||St,Ae,ie,an.x,an.y),en.verticalTextBox&&Xa(i.textCollisionBox.collisionVertexArray,Je.text.placed,!Qt||bt,Ae,ie,an.x,an.y)}const Ln=Qt&&!!(!bt&&en.verticalIconBox);en.iconBox&&Xa(i.iconCollisionBox.collisionVertexArray,Je.icon.placed,Ln,Ae,ie,he.hasIconTextFit?an.x:0,he.hasIconTextFit?an.y:0),en.verticalIconBox&&Xa(i.iconCollisionBox.collisionVertexArray,Je.icon.placed,!Ln,Ae,ie,he.hasIconTextFit?an.x:0,he.hasIconTextFit?an.y:0)}}}if(i.fullyClipped=ge===0,i.sortFeatures(this.transform.angle),this.retainedQueryData[i.bucketInstanceId]&&(this.retainedQueryData[i.bucketInstanceId].featureSortOrder=i.featureSortOrder),i.hasTextData()&&i.text.opacityVertexBuffer&&i.text.opacityVertexBuffer.updateData(i.text.opacityVertexArray),i.hasIconData()&&i.icon.opacityVertexBuffer&&i.icon.opacityVertexBuffer.updateData(i.icon.opacityVertexArray),i.hasIconCollisionBoxData()&&i.iconCollisionBox.collisionVertexBuffer&&i.iconCollisionBox.collisionVertexBuffer.updateData(i.iconCollisionBox.collisionVertexArray),i.hasTextCollisionBoxData()&&i.textCollisionBox.collisionVertexBuffer&&i.textCollisionBox.collisionVertexBuffer.updateData(i.textCollisionBox.collisionVertexArray),i.bucketInstanceId in this.collisionCircleArrays){const pe=this.collisionCircleArrays[i.bucketInstanceId];i.placementInvProjMatrix=pe.invProjMatrix,i.placementViewportMatrix=pe.viewportMatrix,i.collisionCircleArray=pe.circles,delete this.collisionCircleArrays[i.bucketInstanceId]}}symbolFadeChange(i){return this.fadeDuration===0?1:(i-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(i){return Math.max(0,(this.transform.zoom-i)/1.5)}hasTransitions(i){return this.stale||i-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(i,c){const p=this.zoomAtLastRecencyCheck===c?1-this.zoomAdjustment(c):1;return this.zoomAtLastRecencyCheck=c,this.commitTime+this.fadeDuration*p>i}setStale(){this.stale=!0}}function Xa(m,i,c,p,y,v,w){m.emplaceBack(i?1:0,c?1:0,v||0,w||0,p,y?1:0),m.emplaceBack(i?1:0,c?1:0,v||0,w||0,p,y?1:0),m.emplaceBack(i?1:0,c?1:0,v||0,w||0,p,y?1:0),m.emplaceBack(i?1:0,c?1:0,v||0,w||0,p,y?1:0)}const Ic=Math.pow(2,25),No=Math.pow(2,24),fi=Math.pow(2,17),zp=Math.pow(2,16),Ac=Math.pow(2,9),wl=Math.pow(2,8),k=Math.pow(2,1);function X(m){if(m.opacity===0&&!m.placed)return 0;if(m.opacity===1&&m.placed)return 4294967295;const i=m.placed?1:0,c=Math.floor(127*m.opacity);return c*Ic+i*No+c*fi+i*zp+c*Ac+i*wl+c*k+i}const te=0;class Ee{constructor(i){this._sortAcrossTiles=i.layout.get("symbol-z-order")!=="viewport-y"&&i.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs=new Set,this._bucketParts=[]}continuePlacement(i,c,p,y,v,w){const S=this._bucketParts;for(;this._currentTileIndex<i.length;)if(c.getBucketParts(S,y,i[this._currentTileIndex],this._sortAcrossTiles,w),this._currentTileIndex++,v())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,S.sort(((I,O)=>I.sortKey-O.sortKey)));this._currentPartIndex<S.length;){const I=S[this._currentPartIndex];if(c.placeLayerBucketPart(I,this._seenCrossTileIDs,p,I.symbolInstanceStart===0,w),this._currentPartIndex++,v())return!0}return!1}}class pt{constructor(i,c,p,y,v,w,S,I,O){this.placement=new Mu(i,v,w,S,I,O),this._currentPlacementIndex=c.length-1,this._forceFullPlacement=p,this._showCollisionBoxes=y,this._done=!1}isDone(){return this._done}continuePlacement(i,c,p,y,v){const w=s.o.now(),S=()=>{const I=s.o.now()-w;return!this._forceFullPlacement&&I>2};for(;this._currentPlacementIndex>=0;){const I=c[i[this._currentPlacementIndex]],O=this.placement.collisionIndex.transform.zoom;if(I.type==="symbol"&&(!I.minzoom||I.minzoom<=O)&&(!I.maxzoom||I.maxzoom>O)){const D=I,N=D.layout.get("symbol-z-elevate"),z=D.layout.get("symbol-sort-key").constantOr(1)!==void 0,U=D.layout.get("symbol-z-order"),G=U==="viewport-y"||U==="auto"&&!(U!=="viewport-y"&&z),H=D.layout.get("text-allow-overlap")||D.layout.get("icon-allow-overlap")||D.layout.get("text-ignore-placement")||D.layout.get("icon-ignore-placement"),J=G&&H,Z=this._inProgressLayer=this._inProgressLayer||new Ee(D),ee=s.B(I.source,I.scope);if(Z.continuePlacement(N||J?y[ee]:p[ee],this.placement,this._showCollisionBoxes,I,S,v))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(i){return this.placement.commit(i),this.placement}}const Ft=512/s.al/2;class gn{constructor(i,c,p){this.tileID=i,this.bucketInstanceId=p,this.index=new s.c3(c.length,16,Int32Array),this.keys=[],this.crossTileIDs=[];const y=i.canonical.x*s.al,v=i.canonical.y*s.al;for(let w=0;w<c.length;w++){const{key:S,crossTileID:I,tileAnchorX:O,tileAnchorY:D}=c.get(w),N=Math.floor((y+O)*Ft),z=Math.floor((v+D)*Ft);this.index.add(N,z),this.keys.push(S),this.crossTileIDs.push(I)}this.index.finish()}findMatches(i,c,p){const y=this.tileID.canonical.z<c.canonical.z?1:Math.pow(2,this.tileID.canonical.z-c.canonical.z),v=Ft/Math.pow(2,c.canonical.z-this.tileID.canonical.z),w=c.canonical.x*s.al,S=c.canonical.y*s.al;for(let I=0;I<i.length;I++){const O=i.get(I);if(O.crossTileID)continue;const{key:D,tileAnchorX:N,tileAnchorY:z}=O,U=Math.floor((w+N)*v),G=Math.floor((S+z)*v),H=this.index.range(U-y,G-y,U+y,G+y).sort(((J,Z)=>J-Z));for(const J of H){const Z=this.crossTileIDs[J];if(this.keys[J]===D&&!p.has(Z)){p.add(Z),O.crossTileID=Z;break}}}}}class Qi{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Eo{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(i){const c=Math.round((i-this.lng)/360);if(c!==0)for(const p in this.indexes){const y=this.indexes[p],v={};for(const w in y){const S=y[w];S.tileID=S.tileID.unwrapTo(S.tileID.wrap+c),v[S.tileID.key]=S}this.indexes[p]=v}this.lng=i}addBucket(i,c,p){if(this.indexes[i.overscaledZ]&&this.indexes[i.overscaledZ][i.key]){if(this.indexes[i.overscaledZ][i.key].bucketInstanceId===c.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(i.overscaledZ,this.indexes[i.overscaledZ][i.key])}for(let v=0;v<c.symbolInstances.length;v++)c.symbolInstances.get(v).crossTileID=0;this.usedCrossTileIDs[i.overscaledZ]||(this.usedCrossTileIDs[i.overscaledZ]=new Set);const y=this.usedCrossTileIDs[i.overscaledZ];for(const v in this.indexes){const w=this.indexes[v];if(Number(v)>i.overscaledZ)for(const S in w){const I=w[S];I.tileID.isChildOf(i)&&I.findMatches(c.symbolInstances,i,y)}else{const S=w[i.scaledTo(Number(v)).key];S&&S.findMatches(c.symbolInstances,i,y)}}for(let v=0;v<c.symbolInstances.length;v++){const w=c.symbolInstances.get(v);w.crossTileID||(w.crossTileID=p.generate(),y.add(w.crossTileID))}return this.indexes[i.overscaledZ]===void 0&&(this.indexes[i.overscaledZ]={}),this.indexes[i.overscaledZ][i.key]=new gn(i,c.symbolInstances,c.bucketInstanceId),!0}removeBucketCrossTileIDs(i,c){for(const p of c.crossTileIDs)this.usedCrossTileIDs[i].delete(p)}removeStaleBuckets(i){let c=!1;for(const p in this.indexes){const y=this.indexes[p];for(const v in y)i[y[v].bucketInstanceId]||(this.removeBucketCrossTileIDs(p,y[v]),delete y[v],c=!0)}return c}}class yr{constructor(){this.layerIndexes={},this.crossTileIDs=new Qi,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(i,c,p,y){let v=this.layerIndexes[i.fqid];v===void 0&&(v=this.layerIndexes[i.fqid]=new Eo);let w=!1;const S={};y.name!=="globe"&&v.handleWrapJump(p);for(const I of c){const O=I.getBucket(i);O&&i.fqid===O.layerIds[0]&&(O.bucketInstanceId||(O.bucketInstanceId=++this.maxBucketInstanceId),v.addBucket(I.tileID,O,this.crossTileIDs)&&(w=!0),S[O.bucketInstanceId]=!0)}return v.removeStaleBuckets(S)&&(w=!0),w}pruneUnusedLayers(i){const c={};i.forEach((p=>{c[p]=!0}));for(const p in this.layerIndexes)c[p]||delete this.layerIndexes[p]}}const $i=771;class In{constructor(i,c,p,y){this.blendFunction=i,this.blendColor=c.toNonPremultipliedRenderColor(null),this.mask=p,this.blendEquation=y}}In.Replace=[1,0,1,0],In.disabled=new In(In.Replace,s.ao.transparent,[!1,!1,!1,!1]),In.unblended=new In(In.Replace,s.ao.transparent,[!0,!0,!0,!0]),In.alphaBlended=new In([1,$i,1,$i],s.ao.transparent,[!0,!0,!0,!0]),In.alphaBlendedNonPremultiplied=new In([770,$i,770,$i],s.ao.transparent,[!0,!0,!0,!0]),In.multiply=new In([774,0,774,0],s.ao.transparent,[!0,!0,!0,!0]);class Gt{constructor(i,c,p){this.func=i,this.mask=c,this.range=p}}Gt.ReadOnly=!1,Gt.ReadWrite=!0,Gt.disabled=new Gt(519,Gt.ReadOnly,[0,1]);const ds=7680;class Tn{constructor(i,c,p,y,v,w){this.test=i,this.ref=c,this.mask=p,this.fail=y,this.depthFail=v,this.pass=w}}Tn.disabled=new Tn({func:519,mask:0},0,0,ds,ds,ds);const Ya=1029,Fd=2305;class Dn{constructor(i,c,p){this.enable=i,this.mode=c,this.frontFace=p}}function d_(m,i){const c=s.c9(m,3);s.cb(m,i),s.cf(m,3,c)}function yf(m,i){const c=s.c6([]);return s.c7(c,c,-i),s.c8(c,c,-m),c}function vf(m,i){const c=[m[0],m[1],0],p=[i[0],i[1],0];if(s.ag(c)>=1e-15){const w=s.aw([],c);s.c4(p,w,s.bJ(p,w)),i[0]=p[0],i[1]=p[1]}const y=s.bI([],i,m);if(s.c5(y)<1e-15)return null;const v=Math.atan2(-y[1],y[0]);return yf(Math.atan2(Math.sqrt(m[0]*m[0]+m[1]*m[1]),-m[2]),v)}Dn.disabled=new Dn(!1,Ya,Fd),Dn.backCCW=new Dn(!0,Ya,Fd),Dn.backCW=new Dn(!0,Ya,2304),Dn.frontCW=new Dn(!0,1028,2304),Dn.frontCCW=new Dn(!0,1028,Fd);class h_{constructor(i,c){this.position=i,this.orientation=c}get position(){return this._position}set position(i){if(i){const c=i instanceof s.ae?i:new s.ae(i[0],i[1],i[2]);this._renderWorldCopies&&(c.x=s.bT(c.x,0,1)),this._position=c}else this._position=null}lookAtPoint(i,c){if(this.orientation=null,!this.position)return;const p=this.position,y=this._elevation?this._elevation.getAtPointOrZero(s.ae.fromLngLat(i)):0,v=s.ae.fromLngLat(i,y),w=[v.x-p.x,v.y-p.y,v.z-p.z];c||(c=[0,0,1]),c[2]=Math.abs(c[2]),this.orientation=vf(w,c)}setPitchBearing(i,c){this.orientation=yf(s.an(i),s.an(-c))}}class Fp{constructor(i,c){this._transform=s.bA([]),this.orientation=c,this.position=i}get mercatorPosition(){const i=this.position;return new s.ae(i[0],i[1],i[2])}get position(){const i=s.c9(this._transform,3);return[i[0],i[1],i[2]]}set position(i){var c;i&&s.cf(this._transform,3,[(c=i)[0],c[1],c[2],1])}get orientation(){return this._orientation}set orientation(i){this._orientation=i||s.c6([]),i&&d_(this._transform,this._orientation)}getPitchBearing(){const i=this.forward(),c=this.right();return{bearing:Math.atan2(-c[1],c[0]),pitch:Math.atan2(Math.sqrt(i[0]*i[0]+i[1]*i[1]),-i[2])}}setPitchBearing(i,c){this._orientation=yf(i,c),d_(this._transform,this._orientation)}forward(){const i=s.c9(this._transform,2);return[-i[0],-i[1],-i[2]]}up(){const i=s.c9(this._transform,1);return[-i[0],-i[1],-i[2]]}right(){const i=s.c9(this._transform,0);return[i[0],i[1],i[2]]}getCameraToWorld(i,c){const p=new Float64Array(16);return s.bl(p,this.getWorldToCamera(i,c)),p}getCameraToWorldMercator(){return this._transform}getWorldToCameraPosition(i,c,p){const y=this.position;s.c4(y,y,-i);const v=new Float64Array(16);return s.bq(v,[p,p,p]),s.br(v,v,y),v[10]*=c,v}getWorldToCamera(i,c){const p=new Float64Array(16),y=new Float64Array(4),v=this.position;return s.ca(y,this._orientation),s.c4(v,v,-i),s.cb(p,y),s.br(p,p,v),p[1]*=-1,p[5]*=-1,p[9]*=-1,p[13]*=-1,p[8]*=c,p[9]*=c,p[10]*=c,p[11]*=c,p}getCameraToClipPerspective(i,c,p,y){const v=new Float64Array(16);return s.cc(v,i,c,p,y),v}getCameraToClipOrthographic(i,c,p,y,v,w){const S=new Float64Array(16);return s.cd(S,i,c,p,y,v,w),S}getDistanceToElevation(i,c=!1){const p=i===0?0:s.ce(i,c?s.a$(this.position[1]):this.position[1]),y=this.forward();return(p-this.position[2])/y[2]}clone(){return new Fp([...this.position],[...this.orientation])}}const _o={BaseColor:5,MetallicRoughness:6,Normal:7,Occlusion:8,Emission:9,LUT:10,ShadowMap0:11};class f_{constructor(i=0,c=0,p=0,y=0){if(isNaN(i)||i<0||isNaN(c)||c<0||isNaN(p)||p<0||isNaN(y)||y<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=i,this.bottom=c,this.left=p,this.right=y}interpolate(i,c,p){return c.top!=null&&i.top!=null&&(this.top=s.ak(i.top,c.top,p)),c.bottom!=null&&i.bottom!=null&&(this.bottom=s.ak(i.bottom,c.bottom,p)),c.left!=null&&i.left!=null&&(this.left=s.ak(i.left,c.left,p)),c.right!=null&&i.right!=null&&(this.right=s.ak(i.right,c.right,p)),this}getCenter(i,c){const p=s.aA((this.left+i-this.right)/2,0,i),y=s.aA((this.top+c-this.bottom)/2,0,c);return new s.P(p,y)}equals(i){return this.top===i.top&&this.bottom===i.bottom&&this.left===i.left&&this.right===i.right}clone(){return new f_(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}const Xl=15;class xs{constructor(i,c,p,y,v,w,S){this.tileSize=512,this._renderWorldCopies=v===void 0||v,this._minZoom=i||0,this._maxZoom=c||22,this._minPitch=p??0,this._maxPitch=y??60,this.setProjection(w),this.setMaxBounds(S),this.width=0,this.height=0,this._center=new s.aR(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new f_,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._expandedProjMatrixCache={},this._distanceTileDataCache={},this._camera=new Fp,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._tileCoverLift=0,this.freezeTileCoverage=!1,this._horizonShift=.1,this._orthographicProjectionAtLowPitch=!1,this._allowWorldUnderZoom=!1}clone(){const i=new xs(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection(),this.maxBounds);return i._elevation=this._elevation,i._centerAltitude=this._centerAltitude,i._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,i.tileSize=this.tileSize,i.mercatorFromTransition=this.mercatorFromTransition,i.width=this.width,i.height=this.height,i.cameraElevationReference=this.cameraElevationReference,i._center=this._center,i._setZoom(this.zoom),i._seaLevelZoom=this._seaLevelZoom,i.angle=this.angle,i._fov=this._fov,i._pitch=this._pitch,i._nearZ=this._nearZ,i._farZ=this._farZ,i._averageElevation=this._averageElevation,i._orthographicProjectionAtLowPitch=this._orthographicProjectionAtLowPitch,i._unmodified=this._unmodified,i._edgeInsets=this._edgeInsets.clone(),i._camera=this._camera.clone(),i._calcMatrices(),i.freezeTileCoverage=this.freezeTileCoverage,i.frustumCorners=this.frustumCorners,i._allowWorldUnderZoom=this._allowWorldUnderZoom,i}get isOrthographic(){return this.projection.name!=="globe"&&this._orthographicProjectionAtLowPitch&&this.pitch<Xl}get elevation(){return this._elevation}set elevation(i){this._elevation!==i&&(this._elevation=i,this._updateCameraOnTerrain(),this._calcMatrices())}get depthOcclusionForSymbolsAndCircles(){return this.projection.name!=="globe"&&!this.isOrthographic}updateElevation(i,c=!1){const p=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(this._seaLevelZoom==null||p)&&this._updateCameraOnTerrain(),(i||p)&&this._constrainCamera(c),this._calcMatrices()}getProjection(){return s.aH(this.projection,["name","center","parallels"])}setProjection(i){this.projectionOptions=i||{name:"mercator"};const c=this.projection?this.getProjection():void 0;this.projection=s.cl(this.projectionOptions);const p=this.getProjection(),y=!s.by(c,p);return y&&this._calcMatrices(),this.mercatorFromTransition=!1,y}setOrthographicProjectionAtLowPitch(i){return this._orthographicProjectionAtLowPitch!==i&&(this._orthographicProjectionAtLowPitch=i,this._calcMatrices(),!0)}setMercatorFromTransition(){const i=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=s.cl({name:"mercator"});const c=i!==this.projection.name;return c&&this._calcMatrices(),c}get minZoom(){return this._minZoom}set minZoom(i){this._minZoom!==i&&(this._minZoom=i,this.zoom=Math.max(this.zoom,i))}get maxZoom(){return this._maxZoom}set maxZoom(i){this._maxZoom!==i&&(this._maxZoom=i,this.zoom=Math.min(this.zoom,i))}get minPitch(){return this._minPitch}set minPitch(i){this._minPitch!==i&&(this._minPitch=i,this.pitch=Math.max(this.pitch,i))}get maxPitch(){return this._maxPitch}set maxPitch(i){this._maxPitch!==i&&(this._maxPitch=i,this.pitch=Math.min(this.pitch,i))}get renderWorldCopies(){return this._renderWorldCopies&&this.projection.supportsWorldCopies===!0}set renderWorldCopies(i){i===void 0?i=!0:i===null&&(i=!1),this._renderWorldCopies=i}get worldSize(){return this.tileSize*this.scale}get cameraWorldSizeForFog(){const i=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(i))}get cameraWorldSize(){const i=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(i))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return s.ce(1,this.center.lat)*this.cameraWorldSizeForFog}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new s.P(this.width,this.height)}get bearing(){return s.bT(this.rotation,-180,180)}set bearing(i){this.rotation=i}get rotation(){return-this.angle/Math.PI*180}set rotation(i){const c=-i*Math.PI/180;this.angle!==c&&(this._unmodified=!1,this.angle=c,this._calcMatrices(),this.rotationMatrix=s.cm(),s.cn(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(i){const c=s.aA(i,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==c&&(this._unmodified=!1,this._pitch=c,this._calcMatrices())}get aspect(){return this.width/this.height}get fov(){return this._fov/Math.PI*180}set fov(i){i=Math.max(.01,Math.min(60,i)),this._fov!==i&&(this._unmodified=!1,this._fov=s.an(i),this._calcMatrices())}get fovX(){return this._fov}get fovY(){const i=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/i)}get averageElevation(){return this._averageElevation}set averageElevation(i){this._averageElevation=i,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(i){const c=Math.min(Math.max(i,this.minZoom),this.maxZoom);this._zoom!==c&&(this._unmodified=!1,this._setZoom(c),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(i){this._zoom=i,this.scale=this.zoomScale(i),this.tileZoom=Math.floor(i),this.zoomFraction=i-this.tileZoom}get tileCoverLift(){return this._tileCoverLift}set tileCoverLift(i){this._tileCoverLift!==i&&(this._tileCoverLift=i)}_updateCameraOnTerrain(){const i=this.elevation?this.elevation.getAtPoint(this.locationCoordinate(this.center),Number.NEGATIVE_INFINITY):Number.NEGATIVE_INFINITY,c=this.elevation&&i===Number.NEGATIVE_INFINITY&&this.elevation.visibleDemTiles.length>0&&this.elevation.exaggeration()>0&&this._centerAltitudeValidForExaggeration;if(!this._elevation||i===Number.NEGATIVE_INFINITY&&(!c||!this._centerAltitude))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const p=this._elevation;c||this._centerAltitude&&this._centerAltitudeValidForExaggeration&&p.exaggeration()&&this._centerAltitudeValidForExaggeration!==p.exaggeration()?(this._centerAltitude=this._centerAltitude/this._centerAltitudeValidForExaggeration*p.exaggeration(),this._centerAltitudeValidForExaggeration=p.exaggeration()):(this._centerAltitude=i||0,this._centerAltitudeValidForExaggeration=p.exaggeration()),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){if(this._centerAltitudeValidForExaggeration===void 0)return;const i=Math.max(0,(this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize);this._seaLevelZoom=this._zoomFromMercatorZ(i)}sampleAverageElevation(){if(!this._elevation)return 0;const i=this._elevation,c=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],p=this.horizonLineFromTop();let y=0,v=0;for(let w=0;w<c.length;w++){const S=new s.P(c[w][0]*this.width,p+c[w][1]*(this.height-p)),I=i.pointCoordinate(S);if(!I)continue;const O=1/Math.hypot(I[0]-this._camera.position[0],I[1]-this._camera.position[1]);y+=I[3]*O,v+=O}return v===0?NaN:y/v}get center(){return this._center}set center(i){i.lat===this._center.lat&&i.lng===this._center.lng||(this._unmodified=!1,this._center=i,this._terrainEnabled()&&(this.cameraElevationReference==="ground"?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(this._seaLevelZoom==null||!this._elevation)return;const i=this._seaLevelZoom,c=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),p=this.pixelsPerMeter/this.worldSize*c,y=this._mercatorZfromZoom(i),v=this._mercatorZfromZoom(this._maxZoom),w=Math.max(y-p,v);this._setZoom(this._zoomFromMercatorZ(w))}get padding(){return this._edgeInsets.toJSON()}set padding(i){this._edgeInsets.equals(i)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,i,1),this._calcMatrices())}computeZoomRelativeTo(i){const c=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,i.toAltitude()));let p;p=i.z<this._camera.position[2]?[c.x,c.y,c.z]:[i.x,i.y,i.z];const y=s.ag(s.av([],this._camera.position,p));return s.aA(this._zoomFromMercatorZ(y),this._minZoom,this._maxZoom)}setFreeCameraOptions(i){if(!this.height||!i.position&&!i.orientation)return;this._updateCameraState();let c=!1;if(i.orientation&&!s.co(i.orientation,this._camera.orientation)&&(c=this._setCameraOrientation(i.orientation)),i.position){const p=[i.position.x,i.position.y,i.position.z];s.cp(p,this._camera.position)||(this._setCameraPosition(p),c=!0)}c&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const i=this._camera.position,c=new h_;return c.position=new s.ae(i[0],i[1],i[2]),c.orientation=this._camera.orientation,c._elevation=this.elevation,c._renderWorldCopies=this.renderWorldCopies,c}_setCameraOrientation(i){if(!s.cq(i))return!1;s.cr(i,i);const c=s.cs([],[0,0,-1],i),p=s.cs([],[0,-1,0],i);if(p[2]<0)return!1;const y=vf(c,p);return!!y&&(this._camera.orientation=y,!0)}_setCameraPosition(i){const c=this.zoomScale(this.minZoom)*this.tileSize,p=this.zoomScale(this.maxZoom)*this.tileSize,y=this.cameraToCenterDistance;i[2]=s.aA(i[2],y/p,y/c),this._camera.position=i}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(i){return this._edgeInsets.equals(i)}interpolatePadding(i,c,p){this._unmodified=!1,this._edgeInsets.interpolate(i,c,p),this._constrain(),this._calcMatrices()}coveringZoomLevel(i){const c=(i.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/i.tileSize));return Math.max(0,c)}getVisibleUnwrappedCoordinates(i){const c=[new s.ct(0,i)];if(this.renderWorldCopies){const p=this.pointCoordinate(new s.P(0,0)),y=this.pointCoordinate(new s.P(this.width,0)),v=this.pointCoordinate(new s.P(this.width,this.height)),w=this.pointCoordinate(new s.P(0,this.height)),S=Math.floor(Math.min(p.x,y.x,v.x,w.x)),I=Math.floor(Math.max(p.x,y.x,v.x,w.x)),O=1;for(let D=S-O;D<=I+O;D++)D!==0&&c.push(new s.ct(D,i))}return c}isLODDisabled(i){return(!i||this.pitch<=60)&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace}extendTileCover(i,c,p){let y=[];const v=p!=null,w=!v;if(w&&this.zoom<c||v&&p[0]===0&&p[1]===0)return y;const S=new Set,I=(D,N,z,U,G)=>{const H=s.cX(N,D,z,U,G);S.has(H)||(y.push(new s.aO(D,N,z,U,G)),S.add(H))};for(let D=0;D<i.length;D++){const N=i[D];if(w&&N.canonical.z!==c)continue;const z=N.canonical,U=N.overscaledZ,G=N.wrap,H=1<<z.z,J=z.x+1<H,Z=z.x>0,ee=z.y+1<H,ie=z.y>0,se=N.wrap-(Z?0:1),me=N.wrap+(J?0:1),fe=Z?z.x-1:H-1,ge=J?z.x+1:0;if(v)p[0]<0?(I(U,me,z.z,ge,z.y),p[1]<0&&ee&&(I(U,G,z.z,z.x,z.y+1),I(U,me,z.z,ge,z.y+1)),p[1]>0&&ie&&(I(U,G,z.z,z.x,z.y-1),I(U,me,z.z,ge,z.y-1))):p[0]>0?(I(U,se,z.z,fe,z.y),p[1]<0&&ee&&(I(U,G,z.z,z.x,z.y+1),I(U,se,z.z,fe,z.y+1)),p[1]>0&&ie&&(I(U,G,z.z,z.x,z.y-1),I(U,se,z.z,fe,z.y-1))):p[1]<0&&ee?I(U,G,z.z,z.x,z.y+1):ie&&I(U,G,z.z,z.x,z.y-1);else{const pe=N.visibleQuadrants;1&pe&&(I(U,se,z.z,fe,z.y),ie&&(I(U,G,z.z,z.x,z.y-1),I(U,se,z.z,fe,z.y-1))),2&pe&&(I(U,me,z.z,ge,z.y),ie&&(I(U,G,z.z,z.x,z.y-1),I(U,me,z.z,ge,z.y-1))),4&pe&&(I(U,se,z.z,fe,z.y),ee&&(I(U,G,z.z,z.x,z.y+1),I(U,se,z.z,fe,z.y+1))),8&pe&&(I(U,me,z.z,ge,z.y),ee&&(I(U,G,z.z,z.x,z.y+1),I(U,me,z.z,ge,z.y+1)))}}const O=[];for(const D of y)y.some((N=>D.isChildOf(N)))||O.push(D);if(y=O.filter((D=>!i.some((N=>!!(D.overscaledZ<c&&N.isChildOf(D))||D.equals(N)||D.isChildOf(N))))),w){const D=1<<c,N=this.projection.name==="globe"?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),z=[D*N.x,D*N.y],U=4,G=U*U;y=y.filter((H=>{const J=H.canonical.x+.5-z[0],Z=H.canonical.y+.5-z[1];return J*J+Z*Z<G}))}return y}extendTileCoverToNearPlane(i,c,p){const y=[],v=new Set;for(const ee of i)v.add(ee.key);const w=(ee,ie,se,me,fe)=>{const ge=s.cX(ie,ee,se,me,fe);v.has(ge)||(y.push(new s.aO(ee,ie,se,me,fe)),v.add(ge))},S=i.reduce(((ee,ie)=>Math.max(ee,ie.overscaledZ)),p),I=1<<p,O=[new s.P(0,0),new s.P(s.al,0),new s.P(s.al,s.al),new s.P(0,s.al)],D=new s.P(0,0),N=new s.P(0,0),z=(ee,ie)=>{const se=Math.floor(ee[0]),me=Math.floor(ee[1]),fe=(ee[0]-se)*s.al,ge=(ee[1]-me)*s.al,pe=Math.floor(ie[0]),he=Math.floor(ie[1]),_e=(ie[0]-pe)*s.al,Ke=(ie[1]-he)*s.al;for(let Le=-1;Le<=1;Le++){const st=se+Le;if(!(st<0||st>=I)){D.x=fe-Le*s.al,N.x=_e-(st-pe)*s.al;for(let We=-1;We<=1;We++){const it=me+We;D.y=ge-We*s.al,N.y=Ke-(it-he)*s.al,s.cY(D,N,O)&&w(S,0,p,st,it)}}}},U=c.points,G=U[s.cu],H=U[s.cv],J=this._projectToGround(G,U[s.cw]),Z=this._projectToGround(H,U[s.cx]);return z(G,J),z(H,Z),y}_projectToGround(i,c){return s.cy(s.cz(),i,c,i[2]/(i[2]-c[2]))}coveringTiles(i){let c=this.coveringZoomLevel(i);const p=c,y=this.elevation&&this.elevation.exaggeration(),v=y&&!i.isTerrainDEM,w=this.projection.name==="mercator";if(i.minzoom!==void 0&&c<i.minzoom)return[];i.maxzoom!==void 0&&c>i.maxzoom&&(c=i.maxzoom);const S=this.locationCoordinate(this.center),I=this.center.lat,O=1<<c,D=[O*S.x,O*S.y,0],N=this.projection.name==="globe",z=!N,U=s.cA.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,c,z),G=N?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),H=O*s.ce(1,this.center.lat),J=this._camera.position[2]/s.ce(1,this.center.lat),Z=[O*G.x,O*G.y,J*(z?1:H)],ee=N||y,ie=this.cameraToCenterDistance/i.tileSize*(i.roundZoom?1:.502),se=this.isLODDisabled(!0)?c:0;let me;if(this._elevation&&i.isTerrainDEM)me=1e4*this._elevation.exaggeration();else if(this._elevation){const Ae=this._elevation.getMinMaxForVisibleTiles();me=Ae?Ae.max:this._centerAltitude}else me=this._centerAltitude;const fe=i.isTerrainDEM?-me:this._elevation?this._elevation.getMinElevationBelowMSL():0,ge=this.projection.isReprojectedInTileSpace?s.cB(this):1,pe=Ae=>{const Je=new s.ae(Ae.x+25e-6,Ae.y,Ae.z),_t=new s.ae(Ae.x,Ae.y+25e-6,Ae.z),At=Ae.toLngLat(),Ut=Je.toLngLat(),St=_t.toLngLat(),bt=this.locationCoordinate(At),un=this.locationCoordinate(Ut),en=this.locationCoordinate(St),an=Math.hypot(un.x-bt.x,un.y-bt.y),Qt=Math.hypot(en.x-bt.x,en.y-bt.y);return Math.sqrt(an*Qt)*ge/25e-6},he=Ae=>{const at=me,Je=fe;return{aabb:s.cE(this,O,0,0,0,Ae,Je,at,this.projection),zoom:0,x:0,y:0,minZ:Je,maxZ:at,wrap:Ae,fullyVisible:!1}},_e=[];let Ke=[];const Le=c,st=i.reparseOverscaled?p:c,We=(J-this._centerAltitude)*H,it=Ae=>{if(!this._elevation||!Ae.tileID||!w)return;const at=this._elevation.getMinMaxForTile(Ae.tileID),Je=Ae.aabb;at?(Je.min[2]=at.min,Je.max[2]=at.max,Je.center[2]=(Je.min[2]+Je.max[2])/2):(Ae.shouldSplit=qe(Ae),Ae.shouldSplit||(Je.min[2]=Je.max[2]=Je.center[2]=this._centerAltitude))},Pt=(Ae,at)=>{if(.707*at<Ae)return 1;const Je=at/Ae;return Je/(1.4144271570014144+(Math.pow(1.1,Je-1.4144271570014144+1)-1)/(1.1-1)-1)},qe=Ae=>{if(Ae.zoom<se)return!0;if(Ae.zoom===Le)return!1;if(Ae.shouldSplit!=null)return Ae.shouldSplit;const at=Ae.aabb.distanceX(Z),Je=Ae.aabb.distanceY(Z);let _t=We,At=1;if(N){_t=Ae.aabb.distanceZ(Z);const Qt=Math.pow(2,Ae.zoom),Ln=s.a$((Ae.y+1)/Qt),Hn=s.a$(Ae.y/Qt),qn=Math.min(Math.max(I,Ln),Hn),Wr=s.d0(qn)/s.d0(I);if(At=qn===I?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,Wr/this._mercatorScaleRatio),this.zoom<=s.cZ&&Ae.zoom===Le-1&&Wr>=.9)return!0}else if(v&&(_t=Ae.aabb.distanceZ(Z)*H),this.projection.isReprojectedInTileSpace&&p<=5){const Qt=Math.pow(2,Ae.zoom),Ln=pe(new s.ae((Ae.x+.5)/Qt,(Ae.y+.5)/Qt));At=Ln>.85?1:Ln}if(!w){const Qt=Math.sqrt(at*at+Je*Je+_t*_t);let Ln=(1<<Le-Ae.zoom)*ie*At;return Ln*=Pt(Math.max(_t,We),Qt),Qt<Ln}let Ut=Number.MAX_VALUE,St=0;const bt=Ae.aabb.getCorners(),un=[];for(const Qt of bt){s.av(un,Qt,Z),N||(v?un[2]*=H:un[2]=We);const Ln=s.bJ(un,this._camera.forward());Ln<Ut&&(Ut=Ln,St=Math.abs(un[2]))}let en=(1<<Le-Ae.zoom)*ie*At;if(en*=Pt(Math.max(St,We),Ut),Ut<en)return!0;const an=Ae.aabb.closestPoint(D);return an[0]===D[0]&&an[1]===D[1]};if(this.renderWorldCopies)for(let Ae=1;Ae<=3;Ae++)_e.push(he(-Ae)),_e.push(he(Ae));for(_e.push(he(0));_e.length>0;){const Ae=_e.pop(),at=Ae.x,Je=Ae.y;let _t=Ae.fullyVisible;const At=()=>this.projection.name==="globe"&&(Ae.y===0||Ae.y===(1<<Ae.zoom)-1);if(!_t){let Ut=ee?Ae.aabb.intersects(U):Ae.aabb.intersectsFlat(U);if(Ut===0&&At()){const St=new s.cC(Ae.zoom,at,Je);Ut=s.cD(this,O,St,!0).intersects(U)}if(Ut===0)continue;_t=Ut===2}if(Ae.zoom!==Le&&qe(Ae))for(let Ut=0;Ut<4;Ut++){const St=(at<<1)+Ut%2,bt=(Je<<1)+(Ut>>1),un={aabb:w?Ae.aabb.quadrant(Ut):s.cE(this,O,Ae.zoom+1,St,bt,Ae.wrap,Ae.minZ,Ae.maxZ,this.projection),zoom:Ae.zoom+1,x:St,y:bt,wrap:Ae.wrap,fullyVisible:_t,tileID:void 0,shouldSplit:void 0,minZ:Ae.minZ,maxZ:Ae.maxZ};v&&!N&&(un.tileID=new s.aO(Ae.zoom+1===Le?st:Ae.zoom+1,Ae.wrap,Ae.zoom+1,St,bt),it(un)),_e.push(un)}else{const Ut=Ae.zoom===Le?st:Ae.zoom;if(i.minzoom&&i.minzoom>Ut)continue;let St=0;if(!_t){let an=ee?Ae.aabb.intersectsPrecise(U):Ae.aabb.intersectsPreciseFlat(U);if(an===0&&At()){const Qt=new s.cC(Ae.zoom,at,Je);an=s.cD(this,O,Qt,!0).intersectsPrecise(U)}if(an===0)continue;if(i.calculateQuadrantVisibility)if(U.containsPoint(Ae.aabb.center))St=15;else for(let Qt=0;Qt<4;Qt++)Ae.aabb.quadrant(Qt).intersects(U)!==0&&(St|=1<<Qt)}const bt=D[0]-(.5+at+(Ae.wrap<<Ae.zoom))*(1<<c-Ae.zoom),un=D[1]-.5-Je,en=Ae.tileID?Ae.tileID:new s.aO(Ut,Ae.wrap,Ae.zoom,at,Je);i.calculateQuadrantVisibility&&(en.visibleQuadrants=St),Ke.push({tileID:en,distanceSq:bt*bt+un*un})}}if(this.fogCullDistSq){const Ae=this.fogCullDistSq,at=this.horizonLineFromTop();Ke=Ke.filter((Je=>{const _t=[0,0,0,1],At=[s.al,s.al,0,1],Ut=this.calculateFogTileMatrix(Je.tileID.toUnwrapped());s.aC(_t,_t,Ut),s.aC(At,At,Ut);const St=s.cF([],_t,At),bt=s.cG([],_t,At),un=s.c_(St,bt);if(un===0)return!0;let en=!1;const an=this._elevation;if(an&&un>Ae&&at!==0){const Qt=this.calculateProjMatrix(Je.tileID.toUnwrapped());let Ln;i.isTerrainDEM||(Ln=an.getMinMaxForTile(Je.tileID)),Ln||(Ln={min:fe,max:me});const Hn=s.cH(this.rotation),qn=[Hn[0]*s.al,Hn[1]*s.al,Ln.max];s.af(qn,qn,Qt),en=(1-qn[1])*this.height*.5<at}return un<Ae||en}))}return Ke.sort(((Ae,at)=>Ae.distanceSq-at.distanceSq)).map((Ae=>Ae.tileID))}resize(i,c){this.width=i,this.height=c,this.pixelsToGLUnits=[2/i,-2/c],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(i){return Math.pow(2,i)}scaleZoom(i){return Math.log2(i)}project(i){const c=s.aA(i.lat,-s.cI,s.cI),p=this.projection.project(i.lng,c);return new s.P(p.x*this.worldSize,p.y*this.worldSize)}unproject(i){return this.projection.unproject(i.x/this.worldSize,i.y/this.worldSize)}get point(){return this.project(this.center)}get pointMerc(){return this.point._div(this.worldSize)}get pixelsPerMeterRatio(){return this.pixelsPerMeter/s.ce(1,this.center.lat)/this.worldSize}setLocationAtPoint(i,c){let p,y;const v=this.centerPoint;if(this.projection.name==="globe"){const S=this.worldSize;p=(c.x-v.x)/S,y=(c.y-v.y)/S}else{const S=this.pointCoordinate(c),I=this.pointCoordinate(v);p=S.x-I.x,y=S.y-I.y}const w=this.locationCoordinate(i);this.setLocation(new s.ae(w.x-p,w.y-y))}setLocation(i){this.center=this.coordinateLocation(i),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(i,c){return this.projection.locationPoint(this,i,c)}locationPoint3D(i,c){return this.projection.locationPoint(this,i,c,!0)}pointLocation(i){return this.coordinateLocation(this.pointCoordinate(i))}pointLocation3D(i,c){return this.coordinateLocation(this.pointCoordinate3D(i,c))}locationCoordinate(i,c){const p=c?s.ce(c,i.lat):void 0,y=this.projection.project(i.lng,i.lat);return new s.ae(y.x,y.y,p)}coordinateLocation(i){return this.projection.unproject(i.x,i.y)}pointRayIntersection(i,c){const p=c??this._centerAltitude,y=[i.x,i.y,0,1],v=[i.x,i.y,1,1];s.aC(y,y,this.pixelMatrixInverse),s.aC(v,v,this.pixelMatrixInverse);const w=v[3];s.cJ(y,y,1/y[3]),s.cJ(v,v,1/w);const S=y[2],I=v[2];return{p0:y,p1:v,t:S===I?0:(p-S)/(I-S)}}screenPointToMercatorRay(i){const c=[i.x,i.y,0,1],p=[i.x,i.y,1,1];return s.aC(c,c,this.pixelMatrixInverse),s.aC(p,p,this.pixelMatrixInverse),s.cJ(c,c,1/c[3]),s.cJ(p,p,1/p[3]),c[2]=s.ce(c[2],this._center.lat)*this.worldSize,p[2]=s.ce(p[2],this._center.lat)*this.worldSize,s.cJ(c,c,1/this.worldSize),s.cJ(p,p,1/this.worldSize),new s.ax([c[0],c[1],c[2]],s.aw([],s.av([],p,c)))}rayIntersectionCoordinate(i){const{p0:c,p1:p,t:y}=i,v=s.ce(c[2],this._center.lat),w=s.ce(p[2],this._center.lat);return new s.ae(s.ak(c[0],p[0],y)/this.worldSize,s.ak(c[1],p[1],y)/this.worldSize,s.ak(v,w,y))}pointCoordinate(i,c=this._centerAltitude){return this.projection.pointCoordinate(this,i.x,i.y,c)}pointCoordinate3D(i,c){if(!this.elevation)return this.pointCoordinate(i,c);let p=this.projection.pointCoordinate3D(this,i.x,i.y);if(p)return new s.ae(p[0],p[1],p[2]);let y=0,v=this.horizonLineFromTop();if(i.y>v)return this.pointCoordinate(i,c);const w=.02*v,S=i.clone();for(let I=0;I<10&&v-y>w;I++){S.y=s.ak(y,v,.66);const O=this.projection.pointCoordinate3D(this,S.x,S.y);O?(v=S.y,p=O):y=S.y}return p?new s.ae(p[0],p[1],p[2]):this.pointCoordinate(i)}isPointAboveHorizon(i){return this.projection.isPointAboveHorizon(this,i)}isPointOnSurface(i){if(i.y<0||i.y>this.height||i.x<0||i.x>this.width)return!1;if(this.elevation||this.zoom>=s.cK)return!this.isPointAboveHorizon(i);const c=this.pointCoordinate(i);return c.y>=0&&c.y<=1}_coordinatePoint(i,c){const p=c&&this.elevation?this.elevation.getAtPointOrZero(i,this._centerAltitude):this._centerAltitude,y=[i.x*this.worldSize,i.y*this.worldSize,p+i.toAltitude(),1];return s.aC(y,y,this.pixelMatrix),y[3]>0?new s.P(y[0]/y[3],y[1]/y[3]):new s.P(Number.MAX_VALUE,Number.MAX_VALUE)}_getBoundsNonRectangular(){const{top:i,left:c}=this._edgeInsets,p=this.height-this._edgeInsets.bottom,y=this.width-this._edgeInsets.right,v=this.pointLocation3D(new s.P(c,i)),w=this.pointLocation3D(new s.P(y,i)),S=this.pointLocation3D(new s.P(y,p)),I=this.pointLocation3D(new s.P(c,p));let O=Math.min(v.lng,w.lng,S.lng,I.lng),D=Math.max(v.lng,w.lng,S.lng,I.lng),N=Math.min(v.lat,w.lat,S.lat,I.lat),z=Math.max(v.lat,w.lat,S.lat,I.lat);const U=Math.pow(2,-this.zoom)/16*270,G=this.projection.name==="globe"?1:4,H=(J,Z,ee,ie,se)=>{const me=(J+ee)/2,fe=(Z+ie)/2,ge=new s.P(me,fe),{lng:pe,lat:he}=this.pointLocation3D(ge),_e=Math.max(0,O-pe,N-he,pe-D,he-z);O=Math.min(O,pe),D=Math.max(D,pe),N=Math.min(N,he),z=Math.max(z,he),(se<G||_e>U)&&(H(J,Z,me,fe,se+1),H(me,fe,ee,ie,se+1))};if(H(c,i,y,i,1),H(y,i,y,p,1),H(y,p,c,p,1),H(c,p,c,i,1),this.projection.name==="globe"){const[J,Z]=s.cL(this);J?(z=90,D=180,O=-180):Z&&(N=-90,D=180,O=-180)}return new s.aI(new s.aR(O,N),new s.aR(D,z))}_getBoundsRectangular(i,c){const{top:p,left:y}=this._edgeInsets,v=this.height-this._edgeInsets.bottom,w=this.width-this._edgeInsets.right,S=new s.P(y,p),I=new s.P(w,p),O=new s.P(w,v),D=new s.P(y,v);let N=this.pointCoordinate(S,i),z=this.pointCoordinate(I,i);const U=this.pointCoordinate(O,c),G=this.pointCoordinate(D,c),H=(J,Z)=>(Z.y-J.y)/(Z.x-J.x);return N.y>1&&z.y>=0?N=new s.ae((1-G.y)/H(G,N)+G.x,1):N.y<0&&z.y<=1&&(N=new s.ae(-G.y/H(G,N)+G.x,0)),z.y>1&&N.y>=0?z=new s.ae((1-U.y)/H(U,z)+U.x,1):z.y<0&&N.y<=1&&(z=new s.ae(-U.y/H(U,z)+U.x,0)),new s.aI().extend(this.coordinateLocation(N)).extend(this.coordinateLocation(z)).extend(this.coordinateLocation(G)).extend(this.coordinateLocation(U))}_getBoundsRectangularTerrain(){const i=this.elevation;if(!i.visibleDemTiles.length||i.isUsingMockSource())return this._getBoundsRectangular(0,0);const c=i.visibleDemTiles.reduce(((p,y)=>{if(y.dem){const v=y.dem.tree;p.min=Math.min(p.min,v.minimums[0]),p.max=Math.max(p.max,v.maximums[0])}return p}),{min:Number.MAX_VALUE,max:0});return this._getBoundsRectangular(c.min*i.exaggeration(),c.max*i.exaggeration())}getBounds(){return this.projection.name==="mercator"||this.projection.name==="equirectangular"?this._terrainEnabled()?this._getBoundsRectangularTerrain():this._getBoundsRectangular(0,0):this._getBoundsNonRectangular()}horizonLineFromTop(i=!0){const c=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))-this.centerOffset.y,p=this.height/2-c*(1-this._horizonShift);return i?Math.max(0,p):p}getMaxBounds(){return this.maxBounds}setMaxBounds(i){this.maxBounds=i,this.minLat=-s.cI,this.maxLat=s.cI,this.minLng=-180,this.maxLng=180,i&&(this.minLat=i.getSouth(),this.maxLat=i.getNorth(),this.minLng=i.getWest(),this.maxLng=i.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=s.aF(this.minLng)*this.tileSize,this.worldMaxX=s.aF(this.maxLng)*this.tileSize,this.worldMinY=s.aJ(this.maxLat)*this.tileSize,this.worldMaxY=s.aJ(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(i,c){return this.projection.createTileMatrix(this,c,i)}calculateDistanceTileData(i){const c=i.key,p=this._distanceTileDataCache;if(p[c])return p[c];const y=i.canonical,v=1/this.height,w=this.cameraWorldSize,S=w/this.zoomScale(y.z),I=(y.x+Math.pow(2,y.z)*i.wrap)*S,O=y.y*S,D=this.point;D.x*=w/this.worldSize,D.y*=w/this.worldSize;const N=this.angle,z=Math.sin(-N),U=-Math.cos(-N);return p[c]={bearing:[z,U],center:[(D.x-I)*v,(D.y-O)*v],scale:S/s.al*v},p[c]}calculateFogTileMatrix(i){const c=i.key,p=this._fogTileMatrixCache;if(p[c])return p[c];const y=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,i);return s.aB(y,this.worldToFogMatrix,y),p[c]=new Float32Array(y),p[c]}calculateProjMatrix(i,c=!1,p=!1){const y=i.key;let v;if(v=p?this._expandedProjMatrixCache:c?this._alignedProjMatrixCache:this._projMatrixCache,v[y])return v[y];const w=this.calculatePosMatrix(i,this.worldSize);let S;return S=this.projection.isReprojectedInTileSpace?this.mercatorMatrix:p?this.expandedFarZProjMatrix:c?this.alignedProjMatrix:this.projMatrix,s.aB(w,S,w),v[y]=new Float32Array(w),v[y]}calculatePixelsToTileUnitsMatrix(i){const c=i.tileID.key,p=this._pixelsToTileUnitsCache;if(p[c])return p[c];const y=s.cM(i,this);return p[c]=y,p[c]}customLayerMatrix(){return this.mercatorMatrix.slice()}globeToMercatorMatrix(){if(this.projection.name==="globe"){const i=1/this.worldSize,c=s.bq([],[i,i,i]);return s.aB(c,c,this.globeMatrix),c}}recenterOnTerrain(){if(!this._elevation||this.projection.name==="globe")return;const i=this._elevation;this._updateCameraState();const c=s.ce(1,this._center.lat)*this.worldSize,p=this._computeCameraPosition(c),y=this._camera.forward(),v=s.ce(1,this._center.lat);p[2]/=v,y[2]/=v,s.aw(y,y);const w=i.raycast(p,y,i.exaggeration());if(w){const S=s.bH([],p,y,w),I=new s.ae(S[0],S[1],s.ce(S[2],s.a$(S[1]))),O=(I.z+s.ag([I.x-p[0],I.y-p[1],I.z-p[2]*v]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(O),this._centerAltitude=I.toAltitude(),this._center=this.coordinateLocation(I),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCamera(i=!1){if(!this._elevation)return;const c=this._elevation,p=s.ce(1,this._center.lat)*this.worldSize,y=this._computeCameraPosition(p),v=c.getAtPointOrZero(new s.ae(...y)),w=this.pixelsPerMeter/this.worldSize*v,S=this._minimumHeightOverTerrain(),I=y[2]-w;if(I<=S)if(I<0||i){const O=this.locationCoordinate(this._center,this._centerAltitude),D=[y[0],y[1],O.z-y[2]],N=s.ag(D);D[2]-=(S-I)/this._pixelsPerMercatorPixel;const z=s.ag(D);if(z===0)return;s.c4(D,D,N/z*this._pixelsPerMercatorPixel),this._camera.position=[y[0],y[1],O.z*this._pixelsPerMercatorPixel-D[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const i=this.projection.name==="globe"||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||i){const z=this.center;return z.lat=s.aA(z.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!i)&&(z.lng=s.aA(z.lng,this.minLng,this.maxLng)),this.center=z,void(this._constraining=!1)}const c=this._unmodified,{x:p,y}=this.point;let v=0,w=p,S=y;const I=this.width/2,O=this.height/2,D=this.worldMinY*this.scale,N=this.worldMaxY*this.scale;if(y-O<D&&(S=D+O),y+O>N&&(S=N-O),N-D<this.height&&(v=Math.max(v,this.height/(N-D)),S=(N+D)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const z=this.worldMinX*this.scale,U=this.worldMaxX*this.scale,G=this.worldSize/2-(z+U)/2;w=(p+G+this.worldSize)%this.worldSize-G,w-I<z&&(w=z+I),w+I>U&&(w=U-I),U-z<this.width&&(v=Math.max(v,this.width/(U-z)),w=(U+z)/2)}w===p&&S===y||this._allowWorldUnderZoom||(this.center=this.unproject(new s.P(w,S))),v&&!this._allowWorldUnderZoom&&(this.zoom+=this.scaleZoom(v)),this._constrainCamera(),this._unmodified=c,this._constraining=!1}_minZoomForBounds(){let i=Math.max(0,this.scaleZoom(Math.max(0,this.height)/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(i=Math.max(i,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),i}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const i=this.centerOffset,c=this.projection.name==="globe",p=this.pixelsPerMeter;this.projection.name==="globe"&&(this._mercatorScaleRatio=s.ce(1,this.center.lat)/s.ce(1,s.d1));const y=s.cN(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,y),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const v=this.projection.zAxisUnit==="meters"?p:1,w=this._camera.getWorldToCamera(this.worldSize,v);let S;const I=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);if(I[8]=2*-i.x/this.width,I[9]=2*i.y/this.height,this.isOrthographic){let he=.5*this.height/Math.tan(this._fov/2)*1*Math.tan(.5*this._fov),_e=he*this.aspect,Ke=-_e,Le=-he;_e-=i.x,Ke-=i.x,he+=i.y,Le+=i.y,S=this._camera.getCameraToClipOrthographic(Ke,_e,Le,he,this._nearZ,this._farZ),((st,We,it,Pt)=>{for(let qe=0;qe<16;qe++)st[qe]=s.ak(We[qe],it[qe],Pt)})(S,S,I,s.c$(this.pitch>=Xl?1:this.pitch/Xl))}else S=I;const O=s.cO([],I,w);let D=s.cO([],S,w);if(this.projection.isReprojectedInTileSpace){const he=this.locationCoordinate(this.center),_e=s.bA([]);s.br(_e,_e,[he.x*this.worldSize,he.y*this.worldSize,0]),s.aB(_e,_e,s.cP(this)),s.br(_e,_e,[-he.x*this.worldSize,-he.y*this.worldSize,0]),s.aB(D,D,_e),s.aB(O,O,_e),this.inverseAdjustmentMatrix=s.cQ(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];if(this.mercatorMatrix=s.cR([],D,[this.worldSize,this.worldSize,this.worldSize/v,1]),this.projMatrix=D,this.invProjMatrix=s.bl(new Float64Array(16),this.projMatrix),c){const he=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,1/0);he[8]=2*-i.x/this.width,he[9]=2*i.y/this.height,this.expandedFarZProjMatrix=s.cO([],he,w)}else this.expandedFarZProjMatrix=this.projMatrix;const N=s.bl([],S);this.frustumCorners=s.cS.fromInvProjectionMatrix(N,this.horizonLineFromTop(),this.height),this.cameraFrustum=s.cA.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,0,!c);const z=new Float32Array(16);s.bA(z),s.cR(z,z,[1,-1,1]),s.cT(z,z,this._pitch),s.bB(z,z,this.angle);const U=s.cc(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ);this.starsProjMatrix=s.bz(U);const G=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;U[8]=2*-i.x/this.width,U[9]=2*(i.y+G)/this.height,this.skyboxMatrix=s.aB(z,U,z);const H=this.point,J=H.x,Z=H.y,ee=this.width%2/2,ie=this.height%2/2,se=Math.cos(this.angle),me=Math.sin(this.angle),fe=J-Math.round(J)+se*ee+me*ie,ge=Z-Math.round(Z)+se*ie+me*ee,pe=new Float64Array(D);if(s.br(pe,pe,[fe>.5?fe-1:fe,ge>.5?ge-1:ge,0]),this.alignedProjMatrix=pe,D=s.bC(),s.cR(D,D,[this.width/2,-this.height/2,1]),s.br(D,D,[1,-1,0]),this.labelPlaneMatrix=D,D=s.bC(),s.cR(D,D,[1,-1,1]),s.br(D,D,[-1,-1,0]),s.cR(D,D,[2/this.width,2/this.height,1]),this.glCoordMatrix=D,this.pixelMatrix=s.aB(new Float64Array(16),this.labelPlaneMatrix,O),this._calcFogMatrices(),this._distanceTileDataCache={},D=s.bl(new Float64Array(16),this.pixelMatrix),!D)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=D,this.projection.name==="globe"||this.mercatorFromTransition){this.globeMatrix=s.cU(this);const he=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=s.af(he,he,w),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=D;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={},this._expandedProjMatrixCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const i=this.cameraWorldSizeForFog,c=this.cameraPixelsPerMeter,p=this._camera.position,y=1/this.height/this._pixelsPerMercatorPixel,v=[i,i,c];s.c4(v,v,y),s.c4(p,p,-1),s.cV(p,p,v);const w=s.bC();s.br(w,w,p),s.cR(w,w,v),this.mercatorFogMatrix=w,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(i,c,y)}_computeCameraPosition(i){const c=(i=i||this.pixelsPerMeter)/this.pixelsPerMeter,p=this._camera.forward(),y=this.point,v=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*c-i/this.worldSize*this._centerAltitude;return[y.x/this.worldSize-p[0]*v,y.y/this.worldSize-p[1]*v,i/this.worldSize*this._centerAltitude-p[2]*v]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(i){const c=this._maxCameraBoundsDistance()*Math.cos(this._pitch),p=this._camera.position[2],y=i[2];let v=1;this.projection.wrap&&(this.center=this.center.wrap()),y>0&&(v=Math.min((c-p)/y,1)),this._camera.position=s.bH([],this._camera.position,i,v),this._updateStateFromCamera()}_updateStateFromCamera(){const i=this._camera.position,c=this._camera.forward(),{pitch:p,bearing:y}=this._camera.getPitchBearing(),v=s.ce(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,w=this._mercatorZfromZoom(this._maxZoom)*Math.cos(s.an(this._maxPitch)),S=Math.max((i[2]-v)/Math.cos(p),w),I=this._zoomFromMercatorZ(S);s.bH(i,i,c,S),this._pitch=s.aA(p,s.an(this.minPitch),s.an(this.maxPitch)),this.angle=s.bT(y,-Math.PI,Math.PI),this._setZoom(s.aA(I,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new s.ae(i[0],i[1],i[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(i){return Math.pow(2,i)*this.tileSize}_mercatorZfromZoom(i){return this.cameraToCenterDistance/this._worldSizeFromZoom(i)}_minimumHeightOverTerrain(){const i=Math.min(this._seaLevelZoom!=null?this._seaLevelZoom:this._zoom,this._maxZoom)+4;return this._mercatorZfromZoom(i)}_zoomFromMercatorZ(i){return this.scaleZoom(this.cameraToCenterDistance/(Math.max(0,i)*this.tileSize))}zoomFromMercatorZAdjusted(i){let c=0,p=s.cK,y=0,v=1/0;for(;p-c>1e-6&&p>c;){const w=c+.5*(p-c),S=this.tileSize*Math.pow(2,w),I=this.getCameraToCenterDistance(this.projection,w,S),O=this.scaleZoom(I/(Math.max(0,i)*this.tileSize)),D=Math.abs(w-O);D<v&&(v=D,y=w),w<O?c=w:p=w}return y}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(s.w("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(i,c){const p=Math.min(i.x,c.x),y=Math.max(i.x,c.x),v=Math.min(i.y,c.y),w=Math.max(i.y,c.y);if(v<this.horizonLineFromTop(!1))return!0;if(this.projection.name!=="mercator")return!1;const S=[new s.P(p,v),new s.P(y,w),new s.P(p,w),new s.P(y,v)],I=this.renderWorldCopies?-3:0,O=this.renderWorldCopies?4:1;for(const D of S){const N=this.pointRayIntersection(D);if(N.t<0)return!0;const z=this.rayIntersectionCoordinate(N);if(z.x<I||z.y<0||z.x>O||z.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+s.cW(this.fovAboveCenter)>88||this.anyCornerOffEdge(new s.P(0,0),new s.P(this.width,this.height))}zoomDeltaToMovement(i,c){const p=s.ag(s.av([],this._camera.position,i)),y=this._zoomFromMercatorZ(p)+c;return p-this._mercatorZfromZoom(y)}getCameraPoint(){if(this.projection.name==="globe"){const i=(function([c,p,y],v){const w=[c,p,y,1];s.aC(w,w,v);const S=w[3]=Math.max(w[3],1e-6);return w[0]/=S,w[1]/=S,w[2]/=S,w})([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new s.P(i[0],i[1])}{const i=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new s.P(0,i))}}getCameraToCenterDistance(i,c=this.zoom,p=this.worldSize){const y=s.cN(i,c,this.width,this.height,1024),v=i.pixelSpaceConversion(this.center.lat,p,y);let w=.5/Math.tan(.5*this._fov)*this.height*v;return this.isOrthographic&&(w=s.ak(1,w,s.c$(this.pitch>=Xl?1:this.pitch/Xl))),w}getWorldToCameraMatrix(){const i=this._camera.getWorldToCamera(this.worldSize,this.projection.zAxisUnit==="meters"?this.pixelsPerMeter:1);return this.projection.name==="globe"&&s.aB(i,i,this.globeMatrix),i}getFrustum(i){return s.cA.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,i,this.projection.zAxisUnit==="meters")}}const Pc=(m,i)=>{if(i>0&&m.terrain&&s.w("Cutoff is currently disabled on terrain"),i<=0||m.terrain)return{shouldRenderCutoff:!1,uniformValues:{u_cutoff_params:[0,0,0,1]}};const c=m.transform,p=Math.max(Math.abs(c._zoom-(m.minCutoffZoom-1)),1),y=c.isLODDisabled(!1)?s.ah(60,45,c.pitch):s.ah(30,15,c.pitch),v=c._farZ-c._nearZ,w=i*c.height,S=((1-(I=y))*c.cameraToCenterDistance+I*(c._farZ+w))*p;var I;return{shouldRenderCutoff:y<1,uniformValues:{u_cutoff_params:[c._nearZ,c._farZ,(S-c._nearZ)/v,(S-w-c._nearZ)/v]}}},Yo={cascadeCount:2,normalOffset:3,shadowMapResolution:2048};class gb{constructor(i,c){this.aabb=i,this.lastCascade=c}}class bf{add(i,c){const p=this.receivers[i.key];p!==void 0?(p.aabb.min[0]=Math.min(p.aabb.min[0],c.min[0]),p.aabb.min[1]=Math.min(p.aabb.min[1],c.min[1]),p.aabb.min[2]=Math.min(p.aabb.min[2],c.min[2]),p.aabb.max[0]=Math.max(p.aabb.max[0],c.max[0]),p.aabb.max[1]=Math.max(p.aabb.max[1],c.max[1]),p.aabb.max[2]=Math.max(p.aabb.max[2],c.max[2])):this.receivers[i.key]=new gb(c,null)}clear(){this.receivers={}}get(i){return this.receivers[i.key]}computeRequiredCascades(i,c,p){const y=s.d8.fromPoints(i.points);let v=0;for(const w in this.receivers){const S=this.receivers[w];if(!S||!y.intersectsAabb(S.aabb))continue;S.aabb.min=y.closestPoint(S.aabb.min),S.aabb.max=y.closestPoint(S.aabb.max);const I=S.aabb.getCorners();for(let O=0;O<p.length;O++){let D=!0;for(const N of I){const z=[N[0]*c,N[1]*c,N[2]];if(s.af(z,z,p[O].matrix),z[0]<-1||z[0]>1||z[1]<-1||z[1]>1){D=!1;break}}if(S.lastCascade=O,v=Math.max(v,O),D)break}}return v+1}}class ZT{constructor(i){this.painter=i,this._enabled=!1,this._shadowLayerCount=0,this._numCascadesToRender=0,this._cascades=[],this._groundShadowTiles=[],this._receivers=new bf,this._depthMode=new Gt(i.context.gl.LEQUAL,Gt.ReadWrite,[0,1]),this._uniformValues={u_light_matrix_0:new Float32Array(16),u_light_matrix_1:new Float32Array(16),u_shadow_intensity:0,u_fade_range:[0,0],u_shadow_normal_offset:[1,1,1],u_shadow_texel_size:1,u_shadow_map_resolution:1,u_shadow_direction:[0,0,1],u_shadow_bias:[36e-5,.0012,.012],u_shadowmap_0:0,u_shadowmap_1:0},this._forceDisable=!1,this.useNormalOffset=!1,i.tp.registerParameter(this,["Shadows"],"_forceDisable",{label:"forceDisable"},(()=>{this.painter.style.map.triggerRepaint()})),i.tp.registerParameter(Yo,["Shadows"],"cascadeCount",{min:1,max:2,step:1}),i.tp.registerParameter(Yo,["Shadows"],"normalOffset",{min:0,max:10,step:.05}),i.tp.registerParameter(Yo,["Shadows"],"shadowMapResolution",{min:32,max:2048,step:32}),i.tp.registerBinding(this,["Shadows"],"_numCascadesToRender",{readonly:!0,label:"numCascadesToRender"})}destroy(){for(const i of this._cascades)i.texture.destroy(),i.framebuffer.destroy();this._cascades=[]}updateShadowParameters(i,c){const p=this.painter;if(this._enabled=!1,this._shadowLayerCount=0,this._receivers.clear(),!c||!c.properties)return;const y=c.properties.get("shadow-intensity");if(!c.shadowsEnabled()||y<=0||(this._shadowLayerCount=p.style.order.reduce(((G,H)=>{const J=p.style._mergedLayers[H];return G+(J.hasShadowPass()&&!J.isHidden(i.zoom)?1:0)}),0),this._enabled=this._shadowLayerCount>0,!this.enabled))return;const v=p.context,w=Yo.shadowMapResolution,S=Yo.shadowMapResolution;if(this._cascades.length===0||Yo.shadowMapResolution!==this._cascades[0].texture.size[0]){this._cascades=[];for(let G=0;G<Yo.cascadeCount;++G){const H=p._shadowMapDebug,J=v.gl,Z=v.createFramebuffer(w,S,H,"texture"),ee=new s.T(v,{width:w,height:S,data:null},J.DEPTH_COMPONENT16);if(Z.depthAttachment.set(ee.texture),H){const ie=new s.T(v,{width:w,height:S,data:null},J.RGBA8);Z.colorAttachment.set(ie.texture)}this._cascades.push({framebuffer:Z,texture:ee,matrix:[],far:0,boundingSphereRadius:0,frustum:new s.cA,scale:0})}}this.shadowDirection=Bd(c);let I=0;if(i.elevation){const G=i.elevation,H=[1e4,-1e4];G.visibleDemTiles.filter((J=>J.dem)).forEach((J=>{const Z=J.dem.tree;H[0]=Math.min(H[0],Z.minimums[0]),H[1]=Math.max(H[1],Z.maximums[0])})),H[0]!==1e4&&(I=(H[1]-H[0])*G.exaggeration())}const O=1.5*i.cameraToCenterDistance,D=3*O,N=new Float64Array(16);for(let G=0;G<this._cascades.length;++G){const H=this._cascades[G];let J=i.height/50,Z=1;Yo.cascadeCount===1?Z=D:G===0?Z=O:(J=O,Z=D);const[ee,ie]=XT(i,this.shadowDirection,J,Z,Yo.shadowMapResolution,I);H.scale=i.scale,H.matrix=ee,H.boundingSphereRadius=ie,s.bl(N,H.matrix),H.frustum=s.cA.fromInvProjectionMatrix(N,1,0,!0),H.far=Z}const z=this._cascades.length-1;this._uniformValues.u_fade_range=[.75*this._cascades[z].far,this._cascades[z].far],this._uniformValues.u_shadow_intensity=y,this._uniformValues.u_shadow_direction=[this.shadowDirection[0],this.shadowDirection[1],this.shadowDirection[2]],this._uniformValues.u_shadow_texel_size=1/Yo.shadowMapResolution,this._uniformValues.u_shadow_map_resolution=Yo.shadowMapResolution,this._uniformValues.u_shadowmap_0=_o.ShadowMap0,this._uniformValues.u_shadowmap_1=_o.ShadowMap0+1,this._groundShadowTiles=p.transform.coveringTiles({tileSize:512,renderWorldCopies:!0});const U=p.transform.elevation;for(const G of this._groundShadowTiles){let H={min:0,max:0};if(U){const J=U.getMinMaxForTile(G);J&&(H=J)}this.addShadowReceiver(G.toUnwrapped(),H.min,H.max)}}get enabled(){return this._enabled&&!this._forceDisable}set enabled(i){this._enabled=i}drawShadowPass(i,c){if(!this.enabled)return;const p=this.painter,y=p.context;this._numCascadesToRender=this._receivers.computeRequiredCascades(p.transform.getFrustum(0),p.transform.worldSize,this._cascades),y.viewport.set([0,0,Yo.shadowMapResolution,Yo.shadowMapResolution]);for(let v=0;v<this._numCascadesToRender;++v){p.currentShadowCascade=v,y.bindFramebuffer.set(this._cascades[v].framebuffer.framebuffer),y.clear({color:s.ao.white,depth:1});for(const w of i.order){const S=i._mergedLayers[w];if(!S.hasShadowPass()||S.isHidden(p.transform.zoom))continue;const I=i.getLayerSourceCache(S),O=I?c[I.id]:void 0;(S.type==="model"||O&&O.length)&&p.renderLayer(p,I,S,O)}}p.currentShadowCascade=0}drawGroundShadows(){if(!this.enabled)return;const i=this.painter,c=i.style,p=i.context,y=p.gl,v=c.directionalLight,w=c.ambientLight;if(!v||!w)return;const S=[],I=Pc(i,i.longestCutoffRange);I.shouldRenderCutoff&&S.push("RENDER_CUTOFF"),S.push("RENDER_SHADOWS","DEPTH_TEXTURE"),this.useNormalOffset&&S.push("NORMAL_OFFSET");const O=Ja(c,v,w),D=new Gt(y.LEQUAL,Gt.ReadOnly,i.depthRangeFor3D),N=new Tn({func:y.EQUAL,mask:255},0,255,y.KEEP,y.KEEP,y.KEEP);for(const z of this._groundShadowTiles){const U=z.toUnwrapped(),G=i.isTileAffectedByFog(z),H=i.getOrCreateProgram("groundShadow",{defines:S,overrideFog:G});this.setupShadows(U,H),i.uploadCommonUniforms(p,H,U,null,I);const J={u_matrix:i.transform.calculateProjMatrix(U),u_ground_shadow_factor:O};H.draw(i,y.TRIANGLES,D,N,In.multiply,Dn.disabled,J,"ground_shadow",i.tileExtentBuffer,i.quadTriangleIndexBuffer,i.tileExtentSegments,null,i.transform.zoom,null,null)}}getShadowPassColorMode(){return this.painter._shadowMapDebug?In.unblended:In.disabled}getShadowPassDepthMode(){return this._depthMode}getShadowCastingLayerCount(){return this._shadowLayerCount}calculateShadowPassMatrixFromTile(i){const c=this.painter.transform,p=c.calculatePosMatrix(i,c.worldSize);return s.aB(p,this._cascades[this.painter.currentShadowCascade].matrix,p),Float32Array.from(p)}calculateShadowPassMatrixFromMatrix(i){return s.aB(i,this._cascades[this.painter.currentShadowCascade].matrix,i),Float32Array.from(i)}setupShadows(i,c,p){if(!this.enabled)return;const y=this.painter.transform,v=this.painter.context,w=v.gl,S=this._uniformValues,I=new Float64Array(16),O=y.calculatePosMatrix(i,y.worldSize);for(let D=0;D<this._cascades.length;D++)s.aB(I,this._cascades[D].matrix,O),S[D===0?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(I),v.activeTexture.set(w.TEXTURE0+_o.ShadowMap0+D),this._cascades[D].texture.bindExtraParam(w.LINEAR,w.LINEAR,w.CLAMP_TO_EDGE,w.CLAMP_TO_EDGE,w.GREATER);if(this.useNormalOffset=!!p,this.useNormalOffset){const D=s.d6(i.canonical),N=2/y.tileSize*s.al/Yo.shadowMapResolution,z=N*this._cascades[0].boundingSphereRadius,U=N*this._cascades[this._cascades.length-1].boundingSphereRadius,G=(p==="vector-tile"?1:3)*(function(H,J,Z,ee,ie){const se=s.aA((H-22)/-22,0,1);return .125*(1-se)+4*se})(y.zoom);S.u_shadow_normal_offset=[D,z*G,U*G],S.u_shadow_bias=[1e-4,.0012,.012]}else S.u_shadow_bias=[36e-5,.0012,.012];c.setShadowUniformValues(v,S)}setupShadowsFromMatrix(i,c,p=!1){if(!this.enabled)return;const y=this.painter.context,v=y.gl,w=this._uniformValues,S=new Float64Array(16);for(let I=0;I<Yo.cascadeCount;I++)s.aB(S,this._cascades[I].matrix,i),w[I===0?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(S),y.activeTexture.set(v.TEXTURE0+_o.ShadowMap0+I),this._cascades[I].texture.bindExtraParam(v.LINEAR,v.LINEAR,v.CLAMP_TO_EDGE,v.CLAMP_TO_EDGE,v.GREATER);if(this.useNormalOffset=p,p){const I=Yo.normalOffset;w.u_shadow_normal_offset=[1,I,I],w.u_shadow_bias=[6e-5,.0012,.012]}else w.u_shadow_bias=[36e-5,.0012,.012];c.setShadowUniformValues(y,w)}getShadowUniformValues(){return this._uniformValues}getCurrentCascadeFrustum(){return this._cascades[this.painter.currentShadowCascade].frustum}computeSimplifiedTileShadowVolume(i,c,p,y){if(y[2]>=0)return{};const v=(function(I,O,D){const N=D/(1<<I.canonical.z);return new s.d8([I.canonical.x*N+I.wrap*D,I.canonical.y*N+I.wrap*D,0],[(I.canonical.x+1)*N+I.wrap*D,(I.canonical.y+1)*N+I.wrap*D,O])})(i,c,p).getCorners(),w=c/-y[2];y[0]<0?(s.d7(v[0],v[0],[y[0]*w,0,0]),s.d7(v[3],v[3],[y[0]*w,0,0])):y[0]>0&&(s.d7(v[1],v[1],[y[0]*w,0,0]),s.d7(v[2],v[2],[y[0]*w,0,0])),y[1]<0?(s.d7(v[0],v[0],[0,y[1]*w,0]),s.d7(v[1],v[1],[0,y[1]*w,0])):y[1]>0&&(s.d7(v[2],v[2],[0,y[1]*w,0]),s.d7(v[3],v[3],[0,y[1]*w,0]));const S={};return S.vertices=v,S.planes=[Bp(v[1],v[0],v[4]),Bp(v[2],v[1],v[5]),Bp(v[3],v[2],v[6]),Bp(v[0],v[3],v[7])],S}addShadowReceiver(i,c,p){this._receivers.add(i,s.d8.fromTileIdAndHeight(i,c,p))}getMaxCascadeForTile(i){const c=this._receivers.get(i);return c&&c.lastCascade?c.lastCascade:0}}function Bp(m,i,c){const p=s.av([],c,i),y=s.av([],m,i),v=s.bI([],p,y),w=s.ag(v);return w===0?[0,0,1,0]:(s.c4(v,v,1/w),[v[0],v[1],v[2],-s.bJ(v,i)])}function Bd(m){const i=m.properties.get("direction"),c=s.d3(i.x,i.y,i.z);c[2]=s.aA(c[2],0,75);const p=s.d5([c[0],c[1],c[2]]);return s.d4(p.x,p.y,p.z)}function Ja(m,i,c){const p=i.properties.get("color-use-theme")==="none",y=i.properties.get("color"),v=i.properties.get("intensity"),w=i.properties.get("direction"),S=[w.x,w.y,w.z],I=c.properties.get("color-use-theme")==="none",O=c.properties.get("color"),D=c.properties.get("intensity"),N=Math.max(s.bJ([0,0,1],S),0),z=[0,0,0];s.c4(z,O.toPremultipliedRenderColor(I?null:m.getLut(i.scope)).toArray01Linear().slice(0,3),D);const U=[0,0,0];return s.c4(U,y.toPremultipliedRenderColor(p?null:m.getLut(c.scope)).toArray01Linear().slice(0,3),N*v),s.da([z[0]>0?z[0]/(z[0]+U[0]):0,z[1]>0?z[1]/(z[1]+U[1]):0,z[2]>0?z[2]/(z[2]+U[2]):0])}function XT(m,i,c,p,y,v){const w=m.zoom,S=m.scale,I=m.worldSize,O=1/I,D=m.aspect,N=Math.sqrt(1+D*D)*Math.tan(.5*m.fovX),z=N*N,U=p-c,G=p+c;let H,J;z>U/G?(H=p,J=p*N):(H=.5*G*(1+z),J=.5*Math.sqrt(U*U+2*(p*p+c*c)*z+G*G*z*z));const Z=m.projection.pixelsPerMeter(m.center.lat,I),ee=m._camera.getCameraToWorldMercator(),ie=[0,0,-H*O];s.af(ie,ie,ee);let se=J*O;const me=m._edgeInsets;if(!(me.left===0&&me.top===0&&me.right===0&&me.bottom===0||me.left===me.right&&me.top===me.bottom)){const _t=m._camera.getWorldToCamera(m.worldSize,m.projection.zAxisUnit==="meters"?Z:1),At=m._camera.getCameraToClipPerspective(m._fov,m.width/m.height,c,p);At[8]=2*-m.centerOffset.x/m.width,At[9]=2*m.centerOffset.y/m.height;const Ut=new Float64Array(16);s.cO(Ut,At,_t);const St=new Float64Array(16);s.bl(St,Ut);const bt=s.cA.fromInvProjectionMatrix(St,I,w,!0);for(const un of bt.points){const en=((fe=un)[0]/=S,fe[1]/=S,fe[2]=s.ce(fe[2],m._center.lat),fe);se=Math.max(se,s.c5(s.d9([],ie,en)))}}var fe;se*=y/(y-1);const ge=Math.acos(i[2]),pe=Math.atan2(-i[0],-i[1]),he=new Fp;he.position=ie,he.setPitchBearing(ge,pe);const _e=he.getWorldToCamera(I,Z),Ke=se*I,Le=Math.min(m._mercatorZfromZoom(17)*I*-2,-2*Ke),st=he.getCameraToClipOrthographic(-Ke,Ke,-Ke,Ke,Le,(Ke+v*Z)/i[2]),We=new Float64Array(16);s.aB(We,st,_e);const it=s.d4(Math.floor(1e6*ie[0])/1e6*I,Math.floor(1e6*ie[1])/1e6*I,0),Pt=.5*y,qe=[0,0,0];s.af(qe,it,We),s.c4(qe,qe,Pt);const Ae=[Math.floor(qe[0]),Math.floor(qe[1]),Math.floor(qe[2])],at=[0,0,0];s.av(at,qe,Ae),s.c4(at,at,-1/Pt);const Je=new Float64Array(16);return s.bA(Je),s.br(Je,Je,at),s.aB(We,Je,We),[We,Ke]}class Nd extends s.E{constructor(i){super(),this.requestManager=i,this.models={"":{}},this.modelUris={"":{}},this.modelByURL={},this.numModelsLoading={}}loadModel(i,c){return s.aV(this.requestManager.transformRequest(c,s.R.Model).url).then((p=>{if(!p)return;const y=s.aW(p),v=new s.aX(i,void 0,void 0,y);return v.computeBoundsAndApplyParent(),v})).catch((p=>{if(p&&p.status===404)return null;this.fire(new s.y(new Error(`Could not load model ${i} from ${c}: ${p.message}`)))}))}load(i,c,p={forceReload:!1}){this.models[c]||(this.models[c]={});const y=Object.keys(i),v=[],w=[];for(const S of y){const I=i[S];this.hasURLBeenRequested(I)&&!p.forceReload||(this.modelByURL[I]={modelId:S,scope:c},v.push(this.loadModel(S,I)),w.push(S)),this.models[c][S]||(this.models[c][S]={model:null,numReferences:1})}this.numModelsLoading[c]=(this.numModelsLoading[c]||0)+w.length,Promise.allSettled(v).then((S=>{for(let I=0;I<S.length;I++){const{status:O}=S[I];if(O==="rejected")continue;const{value:D}=S[I];this.models[c][w[I]]||(this.models[c][w[I]]={model:null,numReferences:1}),this.models[c][w[I]].model=D}this.numModelsLoading[c]-=w.length,this.fire(new s.z("data",{dataType:"style"}))})).catch((S=>{this.fire(new s.y(new Error(`Could not load models: ${S.message}`)))}))}isLoaded(){for(const i in this.numModelsLoading)if(this.numModelsLoading[i]>0)return!1;return!0}hasModel(i,c,p={exactIdMatch:!1}){return!!(p.exactIdMatch?this.getModel(i,c):this.getModelByURL(this.modelUris[c][i]))}getModel(i,c){return this.models[c]||(this.models[c]={}),this.models[c][i]?this.models[c][i].model:void 0}getModelByURL(i){if(!i)return null;const c=this.modelByURL[i];return c?this.models[c.scope][c.modelId].model:null}hasModelBeenAdded(i,c){return this.models[c]&&this.models[c][i]!==void 0}getModelURIs(i){return this.modelUris[i]||{}}addModel(i,c,p){this.models[p]||(this.models[p]={}),this.modelUris[p]||(this.modelUris[p]={});const y=this.requestManager.normalizeModelURL(c);if((this.hasModel(i,p,{exactIdMatch:!0})||this.hasModelBeenAdded(i,p))&&this.modelUris[p][i]===y)this.models[p][i].numReferences++;else if(this.hasURLBeenRequested(y)){const{scope:v,modelId:w}=this.modelByURL[y];this.models[v][w].numReferences++}else this.modelUris[p][i]=y,this.load({[i]:this.modelUris[p][i]},p)}addModelURLs(i,c){this.models[c]||(this.models[c]={}),this.modelUris[c]||(this.modelUris[c]={});const p=this.modelUris[c];for(const y in i)p[y]=this.requestManager.normalizeModelURL(i[y])}reloadModels(i){this.load(this.modelUris[i],i,{forceReload:!0})}addModelsFromBucket(i,c){this.models[c]||(this.models[c]={}),this.modelUris[c]||(this.modelUris[c]={});const p={};for(const y of i)this.hasModel(y,c,{exactIdMatch:!0})||this.hasURLBeenRequested(y)?this.models[c][y].numReferences++:this.modelUris[c][y]&&!this.hasURLBeenRequested(y)?p[y]=this.modelUris[c][y]:!this.hasURLBeenRequested(y)&&s.db(y,!1)&&(this.modelUris[c][y]=this.requestManager.normalizeModelURL(y),p[y]=this.modelUris[c][y]);this.load(p,c)}hasURLBeenRequested(i){return this.modelByURL[i]!==void 0}removeModel(i,c,p=!1,y=!1){if(this.models[c]&&this.models[c][i]&&(this.models[c][i].numReferences--,this.models[c][i].numReferences===0||y)){const v=this.modelUris[c][i];p||delete this.modelUris[c][i],delete this.modelByURL[v];const w=this.models[c][i].model;if(!w)return;delete this.models[c][i],w.destroy()}}destroy(){for(const i of Object.keys(this.models))for(const c of Object.keys(this.models[i])){const p=this.models[i][c].model;delete this.models[i][c],p&&p.destroy()}this.models={"":{}},this.modelUris={"":{}},this.modelByURL={},this.numModelsLoading={}}listModels(i){return this.models[i]||(this.models[i]={}),Object.keys(this.models[i])}upload(i,c){this.models[c]||(this.models[c]={});for(const p in this.models[c])this.models[c][p].model&&this.models[c][p].model.upload(i.context)}}const _b=new s.a9({data:new s.aa(s.a6.colorTheme.data)});function Np(m){if(!m.metadata||!m.metadata.content_area)return;const i=s.o.devicePixelRatio,{left:c,top:p,width:y,height:v}=m.metadata.content_area,w=c*i,S=p*i;return[w,S,w+y*i,S+v*i]}function Vp(m){if(m)return m.map((([i,c])=>[i*s.o.devicePixelRatio,c*s.o.devicePixelRatio]))}class Rc{constructor(i,c,p){this.id=i,this.scope=c,this.sourceCache=p,this.pendingRequests=new Set,this.missingRequests=new Set}addPendingRequest(i){this.missingRequests.has(i.name)||this.pendingRequests.has(i.name)||this.pendingRequests.add(i.name)}hasPendingRequests(){return this.pendingRequests.size>0}resolvePendingRequests(){const i=new Map;if(!this.sourceCache.loaded())return i;const c=this.sourceCache.getVisibleCoordinates();if(c.length===0)return i;const p=this.sourceCache.getSource();if(!(p instanceof gl))return i;const y=c.map((w=>this.sourceCache.getTile(w))),v=p.getImages(y,Array.from(this.pendingRequests));for(const[w,S]of v)i.set(s.I.from({name:w,iconsetId:this.id}),S),this.pendingRequests.delete(w);for(const w of this.pendingRequests)this.missingRequests.add(w);return this.pendingRequests.clear(),i}}const Du=(m,i)=>be(m,i&&i.filter((c=>c.identifier!=="source.canvas"))),YT=s.aH(sr,["addLayer","removeLayer","setLights","setPaintProperty","setLayoutProperty","setSlot","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setSnow","setRain","setProjection","setCamera","addImport","removeImport","updateImport","addIconset","removeIconset"]),JT=s.aH(sr,["setCenter","setZoom","setBearing","setPitch"]),$p=new Set(["background","sky","slot","custom"]),yb={version:8,layers:[],sources:{}},Up={duration:300,delay:0};class za extends s.E{constructor(i,c={}){super(),this.map=i,this.scope=c.scope||"",this.globalId=null,this.fragments=[],this.importDepth=c.importDepth||0,this.importsCache=c.importsCache||new Map,this.resolvedImports=c.resolvedImports||new Set,this.transition=Object.assign({},Up),this._buildingIndex=new Od(this),this.crossTileSymbolIndex=new yr,this._mergedOrder=[],this._drapedFirstOrder=[],this._mergedLayers={},this._mergedSourceCaches={},this._mergedOtherSourceCaches={},this._mergedSymbolSourceCaches={},this._clipLayerPresent=!1,this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this._changes=c.styleChanges||new Qe,this.dispatcher=c.dispatcher?c.dispatcher:new s.D(s.dd(),this),c.imageManager?this.imageManager=c.imageManager:(this.imageManager=new Lt(this.map._spriteFormat),this.imageManager.setEventedParent(this)),this.imageManager.addScope(this.scope),this.glyphManager=c.glyphManager?c.glyphManager:new s.de(i._requestManager,c.localFontFamily?s.df.all:c.localIdeographFontFamily?s.df.ideographs:s.df.none,c.localFontFamily||c.localIdeographFontFamily),c.modelManager?this.modelManager=c.modelManager:(this.modelManager=new Nd(i._requestManager),this.modelManager.setEventedParent(this)),this._layers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this._loaded=!1,this._precompileDone=!1,this._shouldPrecompile=!1,this._availableImages=[],this._availableModels={},this._order=[],this._markersNeedUpdate=!1,this.options=c.configOptions?c.configOptions:new Map,this._configDependentLayers=c.configDependentLayers?c.configDependentLayers:new Set,this._config=c.config,this._styleColorTheme={lut:null,lutLoading:!1,lutLoadingCorrelationID:0,colorTheme:null,colorThemeOverride:c.colorThemeOverride},this._styleColorThemeForScope={},this._initialConfig=c.initialConfig,this.dispatcher.broadcast("setReferrer",s.dg());const p=this;this._rtlTextPluginCallback=za.registerForPluginStateChange((y=>{p.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:y.pluginStatus,pluginURL:y.pluginURL},((v,w)=>{if(s.dh(v),w&&w.every((S=>S)))for(const S in p._sourceCaches){const I=p._sourceCaches[S],O=I.getSource().type;O!=="vector"&&O!=="geojson"||I.reload()}}))})),this.on("data",(y=>{if(y.dataType!=="source"||y.sourceDataType!=="metadata")return;const v=this.getOwnSource(y.sourceId);if(v&&v.vectorLayerIds)for(const w in this._layers){const S=this._layers[w];S.source===v.id&&this._validateLayer(S)}}))}load(i){return i?(typeof i=="string"?this.loadURL(i):this.loadJSON(i),this):this}_getGlobalId(i){if(!i)return null;if(typeof i=="string"){if(s.h(i))return i;const c=s.di(i);if(!c.startsWith("http"))try{return new URL(c,location.href).toString()}catch{return c}return c}return`json://${s.dj(JSON.stringify(i))}`}_diffStyle(i,c,p){this.globalId=this._getGlobalId(i);const y=(v,w)=>{try{w(null,this.setState(v,p))}catch(S){w(S,!1)}};if(typeof i=="string"){const v=this.map._requestManager.normalizeStyleURL(i),w=this.map._requestManager.transformRequest(v,s.R.Style);s.m(w,((S,I)=>{S?this.fire(new s.y(S)):I&&y(I,c)}))}else typeof i=="object"&&y(i,c)}loadURL(i,c={}){this.fire(new s.z("dataloading",{dataType:"style"}));const p=typeof c.validate=="boolean"?c.validate:!s.h(i);this.globalId=this._getGlobalId(i),i=this.map._requestManager.normalizeStyleURL(i,c.accessToken),this.resolvedImports.add(i);const y=this.importsCache.get(i);if(y)return this._load(y,p);const v=this.map._requestManager.transformRequest(i,s.R.Style);this._request=s.m(v,((w,S)=>{if(this._request=null,w)this.fire(new s.y(w));else if(S)return this.importsCache.set(i,S),this._load(S,p)}))}loadJSON(i,c={}){this.fire(new s.z("dataloading",{dataType:"style"})),this.globalId=this._getGlobalId(i),this._request=s.o.frame((()=>{this._request=null,this._load(i,c.validate!==!1)}))}loadEmpty(){this.fire(new s.z("dataloading",{dataType:"style"})),this._load(yb,!1)}_loadImports(i,c,p){if(this.importDepth>=4)return s.w("Style doesn't support nesting deeper than 5"),Promise.resolve();const y=[];for(const v of i){const w=this._createFragmentStyle(v),S=new Promise((D=>{w.once("style.import.load",D),w.once("error",D)})).then((()=>this.mergeAll()));if(y.push(S),this.resolvedImports.has(v.url)){w.loadEmpty();continue}const I=v.data||this.importsCache.get(v.url);I?(w.loadJSON(I,{validate:c}),this._isInternalStyle(I)&&(w.globalId=null)):v.url?w.loadURL(v.url,{validate:c}):w.loadEmpty();const O={style:w,id:v.id,config:v.config};if(p){const D=this.fragments.findIndex((({id:N})=>N===p));this.fragments=this.fragments.slice(0,D).concat(O).concat(this.fragments.slice(D))}else this.fragments.push(O)}return Promise.allSettled(y)}getImportGlobalIds(i=this,c=new Set){for(const p of i.fragments)p.style.globalId&&c.add(p.style.globalId),this.getImportGlobalIds(p.style,c);return[...c.values()]}_createFragmentStyle(i){const c=this.scope?s.B(i.id,this.scope):i.id;let p;const y=this._initialConfig&&this._initialConfig[c];(i.config||y)&&(p=Object.assign({},i.config,y));const v=new za(this.map,{scope:c,styleChanges:this._changes,importDepth:this.importDepth+1,importsCache:this.importsCache,resolvedImports:new Set(this.resolvedImports),dispatcher:this.dispatcher,imageManager:this.imageManager,glyphManager:this.glyphManager,modelManager:this.modelManager,config:p,configOptions:this.options,colorThemeOverride:i["color-theme"],configDependentLayers:this._configDependentLayers});return v.setEventedParent(this.map,{style:v}),v}_reloadImports(){this.mergeAll(),this._updateMapProjection(),this.updateConfigDependencies(),this.map._triggerCameraUpdate(this.camera),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options}),this._shouldPrecompile=this.map._precompilePrograms&&this.isRootStyle()}_isInternalStyle(i){return this.isRootStyle()&&(i.fragment||!!i.schema&&i.fragment!==!1)}_load(i,c){if(this._isInternalStyle(i)){const v=Object.assign({},yb,{imports:[{id:"basemap",data:i,url:""}]});return void this._load(v,c)}if(this.updateConfig(this._config,i.schema),c&&Du(this,Os(i)))return;this._loaded=!0,this.stylesheet=s.dk(i);const p=()=>{for(const I in i.sources)this.addSource(I,i.sources[I],{validate:!1,isInitialLoad:!0});if(i.iconsets)for(const I in i.iconsets)this.addIconset(I,i.iconsets[I]);i.sprite?this._loadIconset(i.sprite):(this.imageManager.setLoaded(!0,this.scope),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0})),!this.glyphManager.url&&i.glyphs&&this.glyphManager.setURL(i.glyphs);const v=Md(this.stylesheet.layers);if(this._order=v.map((I=>I.id)),this.stylesheet.light&&s.w("The `light` root property is deprecated, prefer using `lights` with `flat` light type instead."),this.stylesheet.lights)if(this.stylesheet.lights.length===1&&this.stylesheet.lights[0].type==="flat"){const I=this.stylesheet.lights[0];this.light=new ze(I.properties,I.id)}else this.setLights(this.stylesheet.lights);this.light||(this.light=new ze(this.stylesheet.light)),this._layers={};for(const I of v){const O=s.dq(I,this.scope,this._styleColorTheme.lut,this.options);O.configDependencies.size!==0&&this._configDependentLayers.add(O.fqid),O.setEventedParent(this,{layer:{id:O.id}}),this._layers[O.id]=O;const D=this.getOwnLayerSourceCache(O),N=!!this.directionalLight&&this.directionalLight.shadowsEnabled();D&&O.canCastShadows()&&N&&(D.castsShadows=!0)}this.stylesheet.featuresets&&this.setFeaturesetSelectors(this.stylesheet.featuresets),this.stylesheet.models&&this.addModelURLs(this.stylesheet.models);const w=this.stylesheet.terrain;w&&(this.checkCanvasFingerprintNoise(),this.disableElevatedTerrain||this.terrainSetForDrapingOnly()||this._createTerrain(w,1)),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this.stylesheet.snow&&this._createSnow(this.stylesheet.snow),this.stylesheet.rain&&this._createRain(this.stylesheet.rain),this.stylesheet.transition&&this.setTransition(this.stylesheet.transition),this.fire(new s.z("data",{dataType:"style"}));const S=this.isRootStyle();i.imports?this._loadImports(i.imports,c).then((()=>{this._reloadImports(),this.fire(new s.z(S?"style.load":"style.import.load"))})).catch((I=>{this.fire(new s.y(new Error("Failed to load imports",I))),this.fire(new s.z(S?"style.load":"style.import.load"))})):(this._reloadImports(),this.fire(new s.z(S?"style.load":"style.import.load")))};this._styleColorTheme.colorTheme=this.stylesheet["color-theme"];const y=this._styleColorTheme.colorThemeOverride?this._styleColorTheme.colorThemeOverride:this._styleColorTheme.colorTheme;if(y){const v=this._evaluateColorThemeData(y);this._loadColorTheme(v).then((()=>{p()})).catch((w=>{s.w(`Couldn't load color theme from the stylesheet: ${w}`),p()}))}else this._styleColorTheme.lut=null,p()}isRootStyle(){return this.importDepth===0}mergeAll(){let i,c,p,y,v,w,S,I,O,D;const N={};this.terrain&&this.terrain.scope!==this.scope&&delete this.terrain,this.forEachFragmentStyle((z=>{if(z.stylesheet){if(z.light!=null&&(i=z.light),z.stylesheet.lights)for(const U of z.stylesheet.lights)U.type==="ambient"&&z.ambientLight!=null&&(c=z.ambientLight),U.type==="directional"&&z.directionalLight!=null&&(p=z.directionalLight);y=this._prioritizeTerrain(y,z.terrain,z.stylesheet.terrain),z.stylesheet.fog&&z.fog!=null&&(v=z.fog),z.stylesheet.snow&&z.snow!=null&&(w=z.snow),z.stylesheet.rain&&z.rain!=null&&(S=z.rain),z.stylesheet.camera!=null&&(D=z.stylesheet.camera),z.stylesheet.projection!=null&&(I=z.stylesheet.projection),z.stylesheet.transition!=null&&(O=z.stylesheet.transition),N[z.scope]=z._styleColorTheme}})),this.light=i,this.ambientLight=c,this.directionalLight=p,this.fog=v,this.snow=w,this.rain=S,this._styleColorThemeForScope=N,y===null?delete this.terrain:this.terrain=y,this.camera=D||{"camera-projection":"perspective"},this.projection=I||{name:"mercator"},this.transition=Object.assign({},Up,O),this.mergeSources(),this.mergeLayers()}forEachFragmentStyle(i){const c=p=>{for(const y of p.fragments)c(y.style);i(p)};c(this)}_prioritizeTerrain(i,c,p){const y=i&&i.drapeRenderMode===0;return p===null?c&&c.drapeRenderMode===0?c:y?i:null:c!=null&&(!i||y||c&&c.drapeRenderMode===1)?c:i}mergeTerrain(){let i;this.terrain&&this.terrain.scope!==this.scope&&delete this.terrain,this.forEachFragmentStyle((c=>{i=this._prioritizeTerrain(i,c.terrain,c.stylesheet.terrain)})),i===null?delete this.terrain:this.terrain=i}mergeProjection(){let i;this.forEachFragmentStyle((c=>{c.stylesheet.projection!=null&&(i=c.stylesheet.projection)})),this.projection=i||{name:"mercator"}}mergeSources(){const i={},c={},p={};this.forEachFragmentStyle((y=>{for(const v in y._sourceCaches){const w=s.B(v,y.scope);i[w]=y._sourceCaches[v]}for(const v in y._otherSourceCaches){const w=s.B(v,y.scope);c[w]=y._otherSourceCaches[v]}for(const v in y._symbolSourceCaches){const w=s.B(v,y.scope);p[w]=y._symbolSourceCaches[v]}})),this._mergedSourceCaches=i,this._mergedOtherSourceCaches=c,this._mergedSymbolSourceCaches=p}mergeLayers(){const i={},c=[],p={};this._mergedSlots=[],this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this.forEachFragmentStyle((w=>{for(const S of w._order){const I=w._layers[S];if(I.type==="slot"){const O=s.dl(S);if(i[O])continue;i[O]=[]}I.slot&&i[I.slot]?i[I.slot].push(I):c.push(I)}})),this._mergedOrder=[];let y=-1;const v=(w=[])=>{for(const S of w)if(S.type==="slot"){const I=s.dl(S.id);i[I]&&v(i[I]),this._mergedSlots.push(I)}else{const I=s.B(S.id,S.scope);this._mergedOrder.push(I),p[I]=S,S.is3D(!!this.terrain)&&(this._has3DLayers=!0,y=this._mergedOrder.length-1),S.type==="circle"&&(this._hasCircleLayers=!0),S.type==="symbol"&&(this._hasSymbolLayers=!0),S.type==="clip"&&(this._clipLayerPresent=!0)}};if(v(c),this._has3DLayers){const w={};for(let S=0;S<this._mergedOrder.length;++S){const I=this._mergedOrder[S];w[I]=S===y?1:S<y?p[I].hasOcclusionOpacityProperties?2:0:4}this._mergedOrder.sort(((S,I)=>w[S]-w[I]))}this._mergedLayers=p,this.updateDrapeFirstLayers(),this._buildingIndex.processLayersChanged()}terrainSetForDrapingOnly(){return!!this.terrain&&this.terrain.drapeRenderMode===0}getCamera(){return this.stylesheet.camera}setCamera(i){return this.stylesheet.camera=Object.assign({},this.stylesheet.camera,i),this.camera=this.stylesheet.camera,this}_evaluateColorThemeData(i){return i.data?(function(c,p,y,v){const w=Object.assign({},p);for(const I of Object.keys(s.a6.colorTheme))w[I]===void 0&&(w[I]=s.a6.colorTheme[I].default);const S=new s.a8(_b,c,new Map(y));return S.setTransitionOrValue(w,y),S.untransitioned().possiblyEvaluate(new s.ac(0,{worldview:void 0}))})(this.scope,i,this.options).get("data"):null}_loadColorTheme(i){this._styleColorTheme.lutLoading=!0,this._styleColorTheme.lutLoadingCorrelationID+=1;const c=this._styleColorTheme.lutLoadingCorrelationID;return new Promise(((p,y)=>{const v="data:image/png;base64,";if(!i||i.length===0)return this._styleColorTheme.lut=null,this._styleColorTheme.lutLoading=!1,void p();let w=i;w.startsWith(v)||(w=v+w);const S=s.I.from("mapbox-reserved-lut"),I=new Image;I.src=w,I.onerror=()=>{this._styleColorTheme.lutLoading=!1,y(new Error("Failed to load image data"))},I.onload=()=>{if(this._styleColorTheme.lutLoadingCorrelationID!==c)return void p();this._styleColorTheme.lutLoading=!1;const{width:O,height:D,data:N}=s.o.getImageData(I);if(D>32)return void y(new Error("The height of the image must be less than or equal to 32 pixels."));if(O!==D*D)return void y(new Error("The width of the image must be equal to the height squared."));this.getImage(S)&&this.removeImage(S),this.addImage(S,{data:new s.q({width:O,height:D},N),pixelRatio:1,sdf:!1,usvg:!1,version:0});const z=this.imageManager.getImage(S,this.scope);z?(this._styleColorTheme.lut={image:z.data,data:i},p()):y(new Error("Missing LUT image."))}}))}getLut(i){const c=this._styleColorThemeForScope[i];return c?c.lut:null}setProjection(i){i?this.stylesheet.projection=i:delete this.stylesheet.projection,this.mergeProjection(),this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?(this.getTerrain()||this.stylesheet.terrain)&&!this.disableElevatedTerrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null,0))}_updateMapProjection(){this.isRootStyle()&&(this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.projection))}_loadSprite(i){this._spriteRequest=(function(c,p,y){let v,w,S;const I=s.o.devicePixelRatio>1?"@2x":"";let O=s.m(p.transformRequest(p.normalizeSpriteURL(c,I,".json"),s.R.SpriteJSON),((z,U)=>{O=null,S||(S=z,v=U,N())})),D=s.n(p.transformRequest(p.normalizeSpriteURL(c,I,".png"),s.R.SpriteImage),((z,U)=>{D=null,S||(S=z,w=U,N())}));function N(){if(S)y(S);else if(v&&w){const z=s.o.getImageData(w),U={};for(const G in v){const{width:H,height:J,x:Z,y:ee,sdf:ie,pixelRatio:se,stretchX:me,stretchY:fe,content:ge}=v[G],pe=new s.q({width:H,height:J});s.q.copy(z,pe,{x:Z,y:ee},{x:0,y:0},{width:H,height:J},null),U[G]={data:pe,pixelRatio:se!==void 0?se:1,sdf:ie!==void 0&&ie,stretchX:me,stretchY:fe,content:ge,usvg:!1,version:0}}y(null,U)}}return{cancel(){O&&(O.cancel(),O=null),D&&(D.cancel(),D=null)}}})(i,this.map._requestManager,((c,p)=>{if(this._spriteRequest=null,c)this.fire(new s.y(c));else if(p){const y=new Map;for(const v in p)y.set(s.I.from(v),p[v]);this.addImages(y)}this.imageManager.setLoaded(!0,this.scope),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0}),this.fire(new s.z("data",{dataType:"style"}))}))}addIconset(i,c){if(c.type==="sprite")return void this._loadSprite(c.url);const p=this.getOwnSourceCache(c.source);if(!p)return void this.fire(new s.y(new Error(`Source "${c.source}" as specified by iconset "${i}" does not exist and cannot be used as an iconset source`)));const y=p.getSource();if(y.type!=="raster-array")return void this.fire(new s.y(new Error(`Source "${c.source}" as specified by iconset "${i}" is not a "raster-array" source and cannot be used as an iconset source`)));y.partial=!1;const v=new Rc(i,this.scope,p);this.imageManager.addImageProvider(v,this.scope)}removeIconset(i){this.imageManager.removeImageProvider(i,this.scope)}_loadIconset(i){if(!s.h(i)&&this.map._spriteFormat!=="icon_set"||this.map._spriteFormat==="raster")return void this._loadSprite(i);const c=this.map._spriteFormat==="auto";var p,y;this._spriteRequest=(y=(v,w)=>{if(this._spriteRequest=null,v)c?this._loadSprite(i):this.fire(new s.y(v));else if(w){const S=new Map;for(const I in w)S.set(s.I.from(I),w[I]);this.addImages(S)}this.imageManager.setLoaded(!0,this.scope),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0}),this.fire(new s.z("data",{dataType:"style"}))},s.bu((p=this.map._requestManager).transformRequest(p.normalizeIconsetURL(i),s.R.Iconset),((v,w)=>{if(v)return void y(v);const S={},I=s.dc(new s.bt(w));for(const O of I.icons){const D={version:1,pixelRatio:s.o.devicePixelRatio,content:Np(O),stretchX:O.metadata?Vp(O.metadata.stretch_x_areas):void 0,stretchY:O.metadata?Vp(O.metadata.stretch_y_areas):void 0,sdf:!1,usvg:!0,icon:O};S[O.name]=D}y(null,S)})))}_validateLayer(i){const c=this.getOwnSource(i.source);if(!c)return;const p=i.sourceLayer;p&&(c.type==="geojson"||c.vectorLayerIds&&c.vectorLayerIds.indexOf(p)===-1)&&this.fire(new s.y(new Error(`Source layer "${p}" does not exist on source "${c.id}" as specified by style layer "${i.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._changes.getUpdatedSourceCaches()).length)return!1;for(const i in this._sourceCaches)if(!this._sourceCaches[i].loaded())return!1;if(!this.imageManager.isLoaded()||this.imageManager.hasPatternsInFlight()||!this.modelManager.isLoaded()||this._styleColorTheme.lutLoading)return!1;for(const{style:i}of this.fragments)if(!i.loaded())return!1;return!0}_serializeImports(){if(this.stylesheet.imports)return this.stylesheet.imports.map(((i,c)=>{const p=this.fragments[c];return p&&p.style&&(i.data=p.style.serialize()),i}))}_serializeSources(){const i={};for(const c in this._sourceCaches){const p=this._sourceCaches[c].getSource();i[p.id]||(i[p.id]=p.serialize())}return i}_serializeLayers(i){const c=[];for(const p of i){const y=this._layers[p];y&&y.type!=="custom"&&c.push(y.serialize())}return c}hasLightTransitions(){return!(!this.light||!this.light.hasTransition())||!(!this.ambientLight||!this.ambientLight.hasTransition())||!(!this.directionalLight||!this.directionalLight.hasTransition())}hasFogTransition(){return!!this.fog&&this.fog.hasTransition()}hasSnowTransition(){return!!this.snow&&this.snow.hasTransition()}hasRainTransition(){return!!this.rain&&this.rain.hasTransition()}hasTransitions(){if(this.hasLightTransitions()||this.hasFogTransition()||this.hasSnowTransition()||this.hasRainTransition())return!0;for(const i in this._sourceCaches)if(this._sourceCaches[i].hasTransition())return!0;for(const i in this._layers)if(this._layers[i].hasTransition())return!0;return!1}get order(){return this.terrain?this._drapedFirstOrder:this._mergedOrder}_getOrder(i){return i?this.order:this._mergedOrder}isLayerDraped(i){return!!this.terrain&&i.isDraped(this.getLayerSourceCache(i))}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}_checkLayer(i){const c=this.getOwnLayer(i);if(c)return c;this.fire(new s.y(new Error(`The layer '${i}' does not exist in the map's style.`)))}_checkSource(i){const c=this.getOwnSource(i);if(c)return c;this.fire(new s.y(new Error(`The source '${i}' does not exist in the map's style.`)))}precompilePrograms(i,c){const p=this.map.painter;if(p)for(let y=i.minzoom||0;y<(i.maxzoom||25.5);y++){const v=i.getProgramIds();if(v)for(const w of v){const S=i.getDefaultProgramParams(w,c.zoom,this._styleColorTheme.lut);S&&(p.style=this,this.fog&&(p._fogVisible=!0,S.overrideFog=!0,p.getOrCreateProgram(w,S)),p._fogVisible=!1,S.overrideFog=!1,p.getOrCreateProgram(w,S),(this.stylesheet.terrain||this.stylesheet.projection&&this.stylesheet.projection.name==="globe")&&(S.overrideRtt=!0,p.getOrCreateProgram(w,S)))}}}update(i){if(!this._loaded)return;this.ambientLight&&this.ambientLight.recalculate(i),this.directionalLight&&this.directionalLight.recalculate(i);const c=this.calculateLightsBrightness();i.brightness=c||0,c!==this._brightness&&(this._brightness=c,this.dispatcher.broadcast("setBrightness",c)),i.worldview!==this._worldview&&(this._worldview=i.worldview,this.dispatcher.broadcast("setWorldview",this._worldview));const p=this._changes.isDirty();let y=!1;if(this._changes.isDirty()){const S=this._changes.getLayerUpdatesByScope();for(const I in S){const{updatedIds:O,removedIds:D}=S[I];(O||D)&&(this._updateWorkerLayers(I,O,D),y=!0)}this.updateSourceCaches(),this._updateTilesForChangedImages(),this.updateLayers(i),this.light&&this.light.updateTransitions(i),this.ambientLight&&this.ambientLight.updateTransitions(i),this.directionalLight&&this.directionalLight.updateTransitions(i),this.fog&&this.fog.updateTransitions(i),this.snow&&this.snow.updateTransitions(i),this.rain&&this.rain.updateTransitions(i),this._changes.reset()}const v={};for(const S in this._mergedSourceCaches){const I=this._mergedSourceCaches[S];v[S]=I.used,I.used=!1,I.tileCoverLift=0}for(const S of this._mergedOrder){const I=this._mergedLayers[S];if(I.recalculate(i,this._availableImages),!I.isHidden(i.zoom)){const O=this.getLayerSourceCache(I);O&&(O.used=!0,O.tileCoverLift=Math.max(O.tileCoverLift,I.tileCoverLift()))}!this._precompileDone&&this._shouldPrecompile&&("requestIdleCallback"in window?requestIdleCallback((()=>{this.precompilePrograms(I,i)})):this.precompilePrograms(I,i))}this._shouldPrecompile&&(this._precompileDone=!0),this.terrain&&y&&this.mergeLayers();const w=this.imageManager.getPendingImageProviders();for(const S of w)S.sourceCache.used=!0;for(const S in v){const I=this._mergedSourceCaches[S];v[S]!==I.used&&I.getSource().fire(new s.z("data",{sourceDataType:"visibility",dataType:"source",sourceId:I.getSource().id}))}this.light&&this.light.recalculate(i),this.terrain&&this.terrain.recalculate(i),this.fog&&this.fog.recalculate(i),this.snow&&this.snow.recalculate(i),this.rain&&this.rain.recalculate(i),this.z=i.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),this.imageManager.clearUpdatedImages(this.scope),p&&this.fire(new s.z("data",{dataType:"style"}))}updateImageProviders(){const i=this.imageManager.getPendingImageProviders();for(const c of i){const p=c.resolvePendingRequests(),y=this.getFragmentStyle(c.scope);y&&y.addImages(p)}}_updateTilesForChangedImages(){const i={};for(const c in this._mergedSourceCaches){const p=this._mergedSourceCaches[c].getSource().scope;i[p]=i[p]||this._changes.getUpdatedImages(p),i[p].length!==0&&this._mergedSourceCaches[c].reloadTilesForDependencies(["icons","patterns"],i[p])}for(const c in i)this._changes.resetUpdatedImages(c)}_updateWorkerLayers(i,c,p){const y=this.getFragmentStyle(i);y&&this.dispatcher.broadcast("updateLayers",{layers:c?y._serializeLayers(c):[],scope:i,removedIds:p||[],options:y.options})}setState(i,c){if(this._checkLoaded(),Du(this,Os(i)))return!1;(i=s.dk(i)).layers=Md(i.layers);const p=(function(w,S){if(!w)return[{command:sr.setStyle,args:[S]}];let I=[];try{if(!s.by(w.version,S.version))return[{command:sr.setStyle,args:[S]}];if(s.by(w.center,S.center)||I.push({command:sr.setCenter,args:[S.center]}),s.by(w.zoom,S.zoom)||I.push({command:sr.setZoom,args:[S.zoom]}),s.by(w.bearing,S.bearing)||I.push({command:sr.setBearing,args:[S.bearing]}),s.by(w.pitch,S.pitch)||I.push({command:sr.setPitch,args:[S.pitch]}),s.by(w.sprite,S.sprite)||I.push({command:sr.setSprite,args:[S.sprite]}),s.by(w.glyphs,S.glyphs)||I.push({command:sr.setGlyphs,args:[S.glyphs]}),s.by(w.imports,S.imports)||(function(U=[],G=[],H){G=G||[];const J=(U=U||[]).map(La),Z=G.map(La),ee=U.reduce(Za,{}),ie=G.reduce(Za,{}),se=J.slice();let me,fe,ge,pe;for(me=0,fe=0;me<J.length;me++)ge=J[me],ie.hasOwnProperty(ge)?fe++:(H.push({command:sr.removeImport,args:[ge]}),se.splice(se.indexOf(ge,fe),1));for(me=0,fe=0;me<Z.length;me++)ge=Z[Z.length-1-me],se[se.length-1-me]!==ge&&(ee.hasOwnProperty(ge)?(H.push({command:sr.removeImport,args:[ge]}),se.splice(se.lastIndexOf(ge,se.length-fe),1)):fe++,pe=se[se.length-me],H.push({command:sr.addImport,args:[ie[ge],pe]}),se.splice(se.length-me,0,ge));for(const he of G){const _e=ee[he.id];_e&&(delete _e.data,s.by(_e,he)||H.push({command:sr.updateImport,args:[he.id,he]}))}})(w.imports,S.imports,I),s.by(w.transition,S.transition)||I.push({command:sr.setTransition,args:[S.transition]}),s.by(w.light,S.light)||I.push({command:sr.setLight,args:[S.light]}),s.by(w.fog,S.fog)||I.push({command:sr.setFog,args:[S.fog]}),s.by(w.snow,S.snow)||I.push({command:sr.setSnow,args:[S.snow]}),s.by(w.rain,S.rain)||I.push({command:sr.setRain,args:[S.rain]}),s.by(w.projection,S.projection)||I.push({command:sr.setProjection,args:[S.projection]}),s.by(w.lights,S.lights)||I.push({command:sr.setLights,args:[S.lights]}),s.by(w.camera,S.camera)||I.push({command:sr.setCamera,args:[S.camera]}),s.by(w.iconsets,S.iconsets)||(function(U,G,H){let J;for(J in G=G||{},U=U||{})U.hasOwnProperty(J)&&(G.hasOwnProperty(J)||H.push({command:sr.removeIconset,args:[J]}));for(J in G){if(!G.hasOwnProperty(J))continue;const Z=G[J];U.hasOwnProperty(J)?s.by(U[J],Z)||(H.push({command:sr.removeIconset,args:[J]}),H.push({command:sr.addIconset,args:[J,Z]})):H.push({command:sr.addIconset,args:[J,Z]})}})(w.iconsets,S.iconsets,I),!s.by(w["color-theme"],S["color-theme"]))return[{command:sr.setStyle,args:[S]}];const O={},D=[];(function(U,G,H,J){let Z;for(Z in G=G||{},U=U||{})U.hasOwnProperty(Z)&&(G.hasOwnProperty(Z)||Dp(Z,H,J));for(Z in G){if(!G.hasOwnProperty(Z))continue;const ee=G[Z];U.hasOwnProperty(Z)?s.by(U[Z],ee)||(U[Z].type==="geojson"&&ee.type==="geojson"&&Wl(U,G,Z)?H.push({command:sr.setGeoJSONSourceData,args:[Z,ee.data]}):Cu(Z,G,H,J)):Ec(Z,G,H)}})(w.sources,S.sources,D,O);const N=[];w.layers&&w.layers.forEach((U=>{U.source&&O[U.source]?I.push({command:sr.removeLayer,args:[U.id]}):N.push(U)}));let z=w.terrain;z&&O[z.source]&&(I.push({command:sr.setTerrain,args:[void 0]}),z=void 0),I=I.concat(D),s.by(z,S.terrain)||I.push({command:sr.setTerrain,args:[S.terrain]}),(function(U,G,H){G=G||[];const J=(U=U||[]).map(La),Z=G.map(La),ee=U.reduce(Za,{}),ie=G.reduce(Za,{}),se=J.slice(),me=Object.create(null);let fe,ge,pe,he,_e,Ke,Le;for(fe=0,ge=0;fe<J.length;fe++)pe=J[fe],ie.hasOwnProperty(pe)?ge++:(H.push({command:sr.removeLayer,args:[pe]}),se.splice(se.indexOf(pe,ge),1));for(fe=0,ge=0;fe<Z.length;fe++)pe=Z[Z.length-1-fe],se[se.length-1-fe]!==pe&&(ee.hasOwnProperty(pe)?(H.push({command:sr.removeLayer,args:[pe]}),se.splice(se.lastIndexOf(pe,se.length-ge),1)):ge++,Ke=se[se.length-fe],H.push({command:sr.addLayer,args:[ie[pe],Ke]}),se.splice(se.length-fe,0,pe),me[pe]=!0);for(fe=0;fe<Z.length;fe++)if(pe=Z[fe],he=ee[pe],_e=ie[pe],!me[pe]&&!s.by(he,_e))if(s.by(he.source,_e.source)&&s.by(he["source-layer"],_e["source-layer"])&&s.by(he.type,_e.type)){for(Le in Ka(he.layout,_e.layout,H,pe,null,sr.setLayoutProperty),Ka(he.paint,_e.paint,H,pe,null,sr.setPaintProperty),s.by(he.slot,_e.slot)||H.push({command:sr.setSlot,args:[pe,_e.slot]}),s.by(he.filter,_e.filter)||H.push({command:sr.setFilter,args:[pe,_e.filter]}),s.by(he.minzoom,_e.minzoom)&&s.by(he.maxzoom,_e.maxzoom)||H.push({command:sr.setLayerZoomRange,args:[pe,_e.minzoom,_e.maxzoom]}),he)he.hasOwnProperty(Le)&&Le!=="layout"&&Le!=="paint"&&Le!=="filter"&&Le!=="metadata"&&Le!=="minzoom"&&Le!=="maxzoom"&&Le!=="slot"&&(Le.indexOf("paint.")===0?Ka(he[Le],_e[Le],H,pe,Le.slice(6),sr.setPaintProperty):s.by(he[Le],_e[Le])||H.push({command:sr.setLayerProperty,args:[pe,Le,_e[Le]]}));for(Le in _e)_e.hasOwnProperty(Le)&&!he.hasOwnProperty(Le)&&Le!=="layout"&&Le!=="paint"&&Le!=="filter"&&Le!=="metadata"&&Le!=="minzoom"&&Le!=="maxzoom"&&Le!=="slot"&&(Le.indexOf("paint.")===0?Ka(he[Le],_e[Le],H,pe,Le.slice(6),sr.setPaintProperty):s.by(he[Le],_e[Le])||H.push({command:sr.setLayerProperty,args:[pe,Le,_e[Le]]}))}else H.push({command:sr.removeLayer,args:[pe]}),Ke=se[se.lastIndexOf(pe)+1],H.push({command:sr.addLayer,args:[_e,Ke]})})(N,S.layers,I)}catch(O){console.warn("Unable to compute style diff:",O),I=[{command:sr.setStyle,args:[S]}]}return I})(this.serialize(),i).filter((w=>!(w.command in JT)));if(p.length===0)return!1;const y=p.filter((w=>!(w.command in YT)));if(y.length>0)throw new Error(`Unimplemented: ${y.map((w=>w.command)).join(", ")}.`);const v=[];return p.forEach((w=>{v.push(this[w.command](...w.args))})),c&&Promise.all(v).then(c).catch(c),this.stylesheet=i,this.mergeAll(),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options}),!0}_updateWorkerImages(){this._availableImages=this.imageManager.listImages(this.scope),this.dispatcher.broadcast("setImages",{scope:this.scope,images:this._availableImages})}_updateWorkerModels(){this._availableModels=this.modelManager.getModelURIs(this.scope),this.dispatcher.broadcast("setModels",{scope:this.scope,models:this._availableModels})}addImages(i){if(i.size===0)return this;for(const[c,p]of i.entries()){if(this.getImage(c))return this.fire(new s.y(new Error(`An image with the name "${c.name}" already exists.`)));this.imageManager.addImage(c,this.scope,p),this._changes.updateImage(c,this.scope)}return this._updateWorkerImages(),this.fire(new s.z("data",{dataType:"style"})),this}addImage(i,c){return this.getImage(i)?this.fire(new s.y(new Error(`An image with the name "${i.name}" already exists.`))):(this.imageManager.addImage(i,this.scope,c),this._changes.updateImage(i,this.scope),this._updateWorkerImages(),this.fire(new s.z("data",{dataType:"style"})),this)}updateImage(i,c,p=!1){this.imageManager.updateImage(i,this.scope,c),p&&(this._changes.updateImage(i,this.scope),this._updateWorkerImages(),this.fire(new s.z("data",{dataType:"style"})))}getImage(i){return this.imageManager.getImage(i,this.scope)}removeImage(i){return this.getImage(i)?(this.imageManager.removeImage(i,this.scope),this._changes.updateImage(i,this.scope),this._updateWorkerImages(),this.fire(new s.z("data",{dataType:"style"})),this):this.fire(new s.y(new Error("No image with this name exists.")))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addModelURLs(i){return this.modelManager.addModelURLs(i,this.scope),this._updateWorkerModels(),this.fire(new s.z("data",{dataType:"style"})),this}addModel(i,c,p={}){return this._checkLoaded(),this._validate(Ie,`models.${i}`,c,null,p)||(this.modelManager.addModel(i,c,this.scope),this.fire(new s.z("data",{dataType:"style"}))),this}hasModel(i){return this.modelManager.hasModel(i,this.scope)}removeModel(i){return this.hasModel(i)?(this.modelManager.removeModel(i,this.scope,!1,!0),this.fire(new s.z("data",{dataType:"style"})),this):this.fire(new s.y(new Error("No model with this ID exists.")))}listModels(){return this._checkLoaded(),this.modelManager.listModels(this.scope)}addSource(i,c,p={}){if(this._checkLoaded(),this.getOwnSource(i)!==void 0)throw new Error(`There is already a source with ID "${i}".`);if(!c.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(c).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(c.type)>=0&&this._validate(Ul,`sources.${i}`,c,null,p))return;this.map&&this.map._collectResourceTiming&&(c.collectResourceTiming=!0);const y=wc(i,c,this.dispatcher,this);y.scope=this.scope,y.setEventedParent(this,(()=>({isSourceLoaded:this._isSourceCacheLoaded(y.id),source:y.serialize(),sourceId:y.id})));const v=w=>{const S=(w?"symbol:":"other:")+y.id,I=s.B(S,this.scope),O=this._sourceCaches[S]=new vs(I,y,w);(w?this._symbolSourceCaches:this._otherSourceCaches)[y.id]=O,O.onAdd(this.map)};v(!1),c.type!=="vector"&&c.type!=="geojson"||v(!0),y.onAdd&&y.onAdd(this.map),p.isInitialLoad||(this.mergeSources(),this._changes.setDirty())}removeSource(i){this._checkLoaded();const c=this.getOwnSource(i);if(!c)throw new Error("There is no source with this ID");for(const y in this._layers)if(this._layers[y].source===i)return this.fire(new s.y(new Error(`Source "${i}" cannot be removed while layer "${y}" is using it.`)));if(this.terrain&&this.terrain.scope===this.scope&&this.terrain.get().source===i)return this.fire(new s.y(new Error(`Source "${i}" cannot be removed while terrain is using it.`)));if(this.stylesheet.iconsets){const y=Object.entries(this.stylesheet.iconsets).find((([v,w])=>w.type==="source"&&w.source===i));if(y)return this.fire(new s.y(new Error(`Source "${i}" cannot be removed while iconset "${y[0]}" is using it.`)))}const p=this.getOwnSourceCaches(i);for(const y of p){const v=s.dl(y.id);delete this._sourceCaches[v],this._changes.discardSourceCacheUpdate(y.id),y.fire(new s.z("data",{sourceDataType:"metadata",dataType:"source",sourceId:y.getSource().id})),y.setEventedParent(null),y.clearTiles()}return delete this._otherSourceCaches[i],delete this._symbolSourceCaches[i],this.mergeSources(),c.setEventedParent(null),c.onRemove&&c.onRemove(this.map),this._changes.setDirty(),this}setGeoJSONSourceData(i,c){this._checkLoaded(),this.getOwnSource(i).setData(c),this._changes.setDirty()}getOwnSource(i){const c=this.getOwnSourceCache(i);return c&&c.getSource()}getOwnSources(){const i=[];for(const c in this._otherSourceCaches){const p=this.getOwnSourceCache(c);p&&i.push(p.getSource())}return i}areTilesLoaded(){const i=this._mergedSourceCaches;for(const c in i){const p=i[c]._tiles;for(const y in p){const v=p[y];if(v.state!=="loaded"&&v.state!=="errored")return!1}}return!0}setLights(i){if(this._checkLoaded(),!i)return delete this.ambientLight,void delete this.directionalLight;const c=this._getTransitionParameters();for(const v of i){if(this._validate(xu,"lights",v))return;switch(v.type){case"ambient":if(this.ambientLight){const w=this.ambientLight;w.set(v),w.updateTransitions(c)}else this.ambientLight=new Sr(v,Hi||(Hi=new s.a9({color:new s.aa(s.a6.properties_light_ambient.color),"color-use-theme":new s.aa({type:"string",default:"default","property-type":"data-constant"}),intensity:new s.aa(s.a6.properties_light_ambient.intensity)})),this.scope,this.options);break;case"directional":if(this.directionalLight){const w=this.directionalLight;w.set(v),w.updateTransitions(c)}else this.directionalLight=new Sr(v,to||(to=new s.a9({direction:new s.ap(s.a6.properties_light_directional.direction),color:new s.aa(s.a6.properties_light_directional.color),"color-use-theme":new s.aa({type:"string",default:"default","property-type":"data-constant"}),intensity:new s.aa(s.a6.properties_light_directional.intensity),"cast-shadows":new s.aa(s.a6.properties_light_directional["cast-shadows"]),"shadow-quality":new s.aa(s.a6.properties_light_directional["shadow-quality"]),"shadow-intensity":new s.aa(s.a6.properties_light_directional["shadow-intensity"])})),this.scope,this.options)}}const p=Object.assign(c,{worldview:this.map.getWorldview()}),y=new s.ac(this.z||0,p);this.ambientLight&&this.ambientLight.recalculate(y),this.directionalLight&&this.directionalLight.recalculate(y),this._brightness=this.calculateLightsBrightness(),this.dispatcher.broadcast("setBrightness",this._brightness)}calculateLightsBrightness(){const i=this.directionalLight,c=this.ambientLight;if(!i||!c)return;const p=z=>.2126*(z[0]<=.03928?z[0]/12.92:Math.pow((z[0]+.055)/1.055,2.4))+.7152*(z[1]<=.03928?z[1]/12.92:Math.pow((z[1]+.055)/1.055,2.4))+.0722*(z[2]<=.03928?z[2]/12.92:Math.pow((z[2]+.055)/1.055,2.4)),y=i.properties.get("color").toNonPremultipliedRenderColor(null).toArray01(),v=i.properties.get("intensity"),w=i.properties.get("direction"),S=1-s.d3(w.x,w.y,w.z)[2]/90,I=p(y)*v*S,O=c.properties.get("color").toNonPremultipliedRenderColor(null).toArray01(),D=c.properties.get("intensity"),N=p(O)*D;return Number(((I+N)/2).toFixed(6))}getBrightness(){return this._brightness}getLights(){if(!this.enable3dLights())return null;const i=[];return this.directionalLight&&i.push(this.directionalLight.get()),this.ambientLight&&i.push(this.ambientLight.get()),i}enable3dLights(){return!!this.ambientLight&&!!this.directionalLight}getFragmentStyle(i){if(i==null||i===""&&this.isRootStyle())return this;if(s.dm(i)){const c=s.dn(i),p=this.fragments.find((({id:v})=>v===c));if(!p)return;const y=s.dl(i);return p.style.getFragmentStyle(y)}{const c=this.fragments.find((({id:p})=>p===i));return c?c.style:void 0}}setFeaturesetSelectors(i){if(!i)return;const c={},p=(y,v="")=>`${y}::${v}`;this._featuresetSelectors={};for(const y in i){const v=this._featuresetSelectors[y]=[];for(const w of i[y].selectors){if(w.featureNamespace){const I=this.getOwnLayer(w.layer);if(!I){s.w(`Layer is undefined for selector: ${w.layer}`);continue}const O=p(I.source,I.sourceLayer);if(O in c&&c[O]!==w.featureNamespace){s.w(`"featureNamespace ${w.featureNamespace} of featureset ${y}'s selector is not associated to the same source, skip this selector`);continue}c[O]=w.featureNamespace}let S;if(w.properties)for(const I in w.properties){const O=s.U(w.properties[I]);O.result==="success"&&(S=S||{},S[I]=O.value)}v.push({layerId:w.layer,namespace:w.featureNamespace,properties:S,uniqueFeatureID:w._uniqueFeatureID})}}}getFeaturesetDescriptors(i){const c=this.getFragmentStyle(i);if(!c||!c.stylesheet.featuresets)return[];const p=[];for(const y in c.stylesheet.featuresets)p.push({featuresetId:y,importId:c.scope?c.scope:void 0});return p}getFeaturesetLayers(i,c){const p=this.getFragmentStyle(c),y=p.stylesheet.featuresets;if(!y||!y[i])return this.fire(new s.y(new Error(`The featureset '${i}' does not exist in the map's style and cannot be queried.`))),[];const v=[];for(const w of y[i].selectors){const S=p.getOwnLayer(w.layer);S&&v.push(S)}return v}getConfigProperty(i,c){const p=this.getFragmentStyle(i);if(!p)return null;const y=s.B(c,p.scope),v=p.options.get(y),w=v?v.value||v.default:null;return w?w.serialize():null}setConfigProperty(i,c,p){const y=this.getFragmentStyle(i);if(!y)return;const v=y.stylesheet.schema;if(!v||!v[c])return;const w=s.U(p);if(w.result!=="success")return void Du(this,w.value);const S=w.value.expression,I=s.B(c,y.scope),O=y.options.get(I);if(!O)return;let D;const{minValue:N,maxValue:z,stepValue:U,type:G,values:H}=v[c],J=s.U(v[c].default);J.result==="success"&&(D=J.value.expression),D?(this.options.set(I,Object.assign({},O,{value:S,default:D,minValue:N,maxValue:z,stepValue:U,type:G,values:H})),this.updateConfigDependencies(c)):this.fire(new s.y(new Error(`No schema defined for the config option "${c}" in the "${i}" fragment.`)))}getConfig(i){const c=this.getFragmentStyle(i);if(!c)return null;const p=c.stylesheet.schema;if(!p)return null;const y={};for(const v in p){const w=s.B(v,c.scope),S=c.options.get(w),I=S?S.value||S.default:null;y[v]=I?I.serialize():null}return y}setConfig(i,c){const p=this.getFragmentStyle(i);p&&(p.updateConfig(c,p.stylesheet.schema),this.updateConfigDependencies())}getSchema(i){const c=this.getFragmentStyle(i);return c?c.stylesheet.schema:null}setSchema(i,c){const p=this.getFragmentStyle(i);p&&(p.stylesheet.schema=c,p.updateConfig(p._config,c),this.updateConfigDependencies())}updateConfig(i,c){if(this._config=i,i||c)if(c)for(const p in c){let y,v;const w=s.U(c[p].default);if(w.result==="success"&&(y=w.value.expression),i&&i[p]!==void 0){const z=s.U(i[p]);z.result==="success"&&(v=z.value.expression)}const{minValue:S,maxValue:I,stepValue:O,type:D,values:N}=c[p];if(y){const z=s.B(p,this.scope);this.options.set(z,{default:y,value:v,minValue:S,maxValue:I,stepValue:O,type:D,values:N})}else this.fire(new s.y(new Error(`No schema defined for config option "${p}".`)))}else this.fire(new s.y(new Error("Attempting to set config for a style without schema.")))}updateConfigDependencies(i){for(const c of this._configDependentLayers){const p=this.getLayer(c);if(p){if(i&&!p.configDependencies.has(i))continue;p.possiblyEvaluateVisibility(),this._updateLayer(p)}}this.ambientLight&&this.ambientLight.updateConfig(this.options),this.directionalLight&&this.directionalLight.updateConfig(this.options),this.fog&&this.fog.updateConfig(this.options),this.snow&&this.snow.updateConfig(this.options),this.rain&&this.rain.updateConfig(this.options),this.forEachFragmentStyle((c=>{const p=c._styleColorTheme.colorThemeOverride?c._styleColorTheme.colorThemeOverride:c._styleColorTheme.colorTheme;if(p){const y=c._evaluateColorThemeData(p);(!c._styleColorTheme.lut&&y!==""||c._styleColorTheme.lut&&y!==c._styleColorTheme.lut.data)&&c.setColorTheme(p)}})),this._changes.setDirty()}addLayer(i,c,p={}){this._checkLoaded();const y=i.id;if(this._layers[y])return void this.fire(new s.y(new Error(`Layer with id "${y}" already exists on this map`)));let v;if(i.type==="custom"){if(Du(this,s.dp(i)))return;v=s.dq(i,this.scope,this._styleColorTheme.lut,this.options)}else{if(typeof i.source=="object"&&(this.addSource(y,i.source),i=s.dk(i),i=Object.assign(i,{source:y})),this._validate(Fe,`layers.${y}`,i,{arrayIndex:-1},p))return;v=s.dq(i,this.scope,this._styleColorTheme.lut,this.options),this._validateLayer(v),v.setEventedParent(this,{layer:{id:y}})}v.configDependencies.size!==0&&this._configDependentLayers.add(v.fqid);let w=this._order.length;if(c){const D=this._order.indexOf(c);if(D===-1)return void this.fire(new s.y(new Error(`Layer with id "${c}" does not exist on this map.`)));v.slot===this._layers[c].slot?w=D:s.w(`Layer with id "${c}" has a different slot. Layers can only be rearranged within the same slot.`)}this._order.splice(w,0,y),this._layerOrderChanged=!0,this._layers[y]=v;const S=this.getOwnLayerSourceCache(v),I=!!this.directionalLight&&this.directionalLight.shadowsEnabled();S&&v.canCastShadows()&&I&&(S.castsShadows=!0);const O=this._changes.getRemovedLayer(v);if(O&&v.source&&S&&v.type!=="custom"){this._changes.discardLayerRemoval(v);const D=s.B(v.source,v.scope);O.type!==v.type?this._changes.updateSourceCache(D,"clear"):(this._changes.updateSourceCache(D,"reload"),S.pause())}this._updateLayer(v),v.onAdd&&v.onAdd(this.map),v.scope=this.scope,this.mergeLayers()}moveLayer(i,c){this._checkLoaded();const p=this._checkLayer(i);if(!p||i===c)return;const y=this._order.indexOf(i);this._order.splice(y,1);let v=this._order.length;if(c){const w=this._order.indexOf(c);if(w===-1)return void this.fire(new s.y(new Error(`Layer with id "${c}" does not exist on this map.`)));p.slot===this._layers[c].slot?v=w:s.w(`Layer with id "${c}" has a different slot. Layers can only be rearranged within the same slot.`)}this._order.splice(v,0,i),this._changes.setDirty(),this._layerOrderChanged=!0,this.mergeLayers()}removeLayer(i){this._checkLoaded();const c=this._checkLayer(i);if(!c)return;c.setEventedParent(null);const p=this._order.indexOf(i);this._order.splice(p,1),delete this._layers[i],this._changes.setDirty(),this._layerOrderChanged=!0,this._configDependentLayers.delete(c.fqid),this._changes.removeLayer(c);const y=this.getOwnLayerSourceCache(c);if(y&&y.castsShadows){let v=!1;for(const w in this._layers)if(this._layers[w].source===c.source&&this._layers[w].canCastShadows()){v=!0;break}y.castsShadows=v}c.onRemove&&c.onRemove(this.map),this.mergeLayers()}getOwnLayer(i){return this._layers[i]}hasLayer(i){return i in this._mergedLayers}hasLayerType(i){for(const c in this._layers)if(this._layers[c].type===i)return!0;return!1}setLayerZoomRange(i,c,p){this._checkLoaded();const y=this._checkLayer(i);y&&(y.minzoom===c&&y.maxzoom===p||(c!=null&&(y.minzoom=c),p!=null&&(y.maxzoom=p),this._updateLayer(y)))}getSlots(){return this._checkLoaded(),this._mergedSlots}setSlot(i,c){this._checkLoaded();const p=this._checkLayer(i);p&&p.slot!==c&&(p.slot=c,this._updateLayer(p))}setFilter(i,c,p={}){this._checkLoaded();const y=this._checkLayer(i);if(y&&!s.by(y.filter,c))return c==null?(y.filter=void 0,void this._updateLayer(y)):void(this._validate(Y,`layers.${y.id}.filter`,c,{layerType:y.type},p)||(y.filter=s.dk(c),this._updateLayer(y)))}getFilter(i){const c=this._checkLayer(i);if(c)return s.dk(c.filter)}setLayoutProperty(i,c,p,y={}){this._checkLoaded();const v=this._checkLayer(i);if(v&&!s.by(v.getLayoutProperty(c),p)){if(p!=null&&(!y||y.validate!==!1)&&Du(v,ce.call(Os,{key:`layers.${i}.layout.${c}`,layerType:v.type,objectKey:c,value:p,styleSpec:s.a6,style:{glyphs:!0,sprite:!0}})))return;v.setLayoutProperty(c,p),v.configDependencies.size!==0&&this._configDependentLayers.add(v.fqid),this._updateLayer(v)}}getLayoutProperty(i,c){const p=this._checkLayer(i);if(p)return p.getLayoutProperty(c)}setPaintProperty(i,c,p,y={}){this._checkLoaded();const v=this._checkLayer(i);if(!v||s.by(v.getPaintProperty(c),p)||p!=null&&(!y||y.validate!==!1)&&Du(v,Q.call(Os,{key:`layers.${i}.paint.${c}`,layerType:v.type,objectKey:c,value:p,styleSpec:s.a6})))return;const w=v.setPaintProperty(c,p);v.configDependencies.size!==0&&this._configDependentLayers.add(v.fqid),w&&this._updateLayer(v),this._changes.updatePaintProperties(v)}getPaintProperty(i,c){const p=this._checkLayer(i);if(p)return p.getPaintProperty(c)}setFeatureState(i,c){if(this._checkLoaded(),"target"in i){if("featuresetId"in i.target){const{featuresetId:I,importId:O}=i.target,D=this.getFragmentStyle(O),N=D.getFeaturesetLayers(I);for(const{source:z,sourceLayer:U}of N)D.setFeatureState({id:i.id,source:z,sourceLayer:U},c)}else if("layerId"in i.target){const{layerId:I}=i.target,O=this.getLayer(I);this.setFeatureState({id:i.id,source:O.source,sourceLayer:O.sourceLayer},c)}return}const p=i.source,y=i.sourceLayer,v=this._checkSource(p);if(!v)return;const w=v.type;if(w==="geojson"&&y)return void this.fire(new s.y(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if(w==="vector"&&!y)return void this.fire(new s.y(new Error("The sourceLayer parameter must be provided for vector source types.")));i.id===void 0&&this.fire(new s.y(new Error("The feature id parameter must be provided.")));const S=this.getOwnSourceCaches(p);for(const I of S)I.setFeatureState(y,i.id,c)}removeFeatureState(i,c){if(this._checkLoaded(),"target"in i){if("featuresetId"in i.target){const{featuresetId:I,importId:O}=i.target,D=this.getFragmentStyle(O),N=D.getFeaturesetLayers(I);for(const{source:z,sourceLayer:U}of N)D.removeFeatureState({id:i.id,source:z,sourceLayer:U},c)}else if("layerId"in i.target){const{layerId:I}=i.target,O=this.getLayer(I);this.removeFeatureState({id:i.id,source:O.source,sourceLayer:O.sourceLayer},c)}return}const p=i.source,y=this._checkSource(p);if(!y)return;const v=y.type,w=v==="vector"?i.sourceLayer:void 0;if(v==="vector"&&!w)return void this.fire(new s.y(new Error("The sourceLayer parameter must be provided for vector source types.")));if(c&&typeof i.id!="string"&&typeof i.id!="number")return void this.fire(new s.y(new Error("A feature id is required to remove its specific state property.")));const S=this.getOwnSourceCaches(p);for(const I of S)I.removeFeatureState(w,i.id,c)}getFeatureState(i){if(this._checkLoaded(),"target"in i){let v;if("featuresetId"in i.target){const{featuresetId:w,importId:S}=i.target,I=this.getFragmentStyle(S),O=I.getFeaturesetLayers(w);for(const{source:D,sourceLayer:N}of O){const z=I.getFeatureState({id:i.id,source:D,sourceLayer:N});if(z&&!v)v=z;else if(!s.by(v,z))return void this.fire(new s.y(new Error("The same feature id exists in multiple sources in the featureset, but their feature states are not consistent through the sources.")))}}else if("layerId"in i.target){const{layerId:w}=i.target,S=this.getLayer(w);v=this.getFeatureState({id:i.id,source:S.source,sourceLayer:S.sourceLayer})}return v}const c=i.source,p=i.sourceLayer,y=this._checkSource(c);if(y){if(y.type!=="vector"||p)return i.id===void 0&&this.fire(new s.y(new Error("The feature id parameter must be provided."))),this.getOwnSourceCaches(c)[0].getFeatureState(p,i.id);this.fire(new s.y(new Error("The sourceLayer parameter must be provided for vector source types.")))}}setTransition(i){return this.stylesheet.transition=Object.assign({},this.stylesheet.transition,i),this.transition=this.stylesheet.transition,this}getTransition(){return Object.assign({},this.stylesheet.transition)}serialize(){this._checkLoaded();const i=this.getTerrain(),c=i&&this.terrain&&this.terrain.scope===this.scope?i:this.stylesheet.terrain;return s.dr({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,fragment:this.stylesheet.fragment,iconsets:this.stylesheet.iconsets,imports:this._serializeImports(),schema:this.stylesheet.schema,camera:this.stylesheet.camera,light:this.stylesheet.light,lights:this.stylesheet.lights,terrain:c,fog:this.stylesheet.fog,snow:this.stylesheet.snow,rain:this.stylesheet.rain,center:this.stylesheet.center,"color-theme":this.stylesheet["color-theme"],zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:this._serializeSources(),layers:this._serializeLayers(this._order)},(p=>p!==void 0))}_updateFilteredLayers(i){for(const c of Object.values(this._mergedLayers))i(c)&&this._updateLayer(c)}_updateLayer(i){this._changes.updateLayer(i);const c=this.getLayerSourceCache(i),p=s.B(i.source,i.scope),y=this._changes.getUpdatedSourceCaches();i.source&&!y[p]&&c&&c.getSource().type!=="raster"&&(this._changes.updateSourceCache(p,"reload"),c.pause()),i.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(i){const c=S=>this._mergedLayers[S].is3D(!!this.terrain),p=this.order,y={},v=[];for(let S=p.length-1;S>=0;S--){const I=p[S];if(c(I)){y[I]=S;for(const O of i){const D=O[I];if(D)for(const N of D)v.push(N)}}}v.sort(((S,I)=>I.intersectionZ-S.intersectionZ));const w=[];for(let S=p.length-1;S>=0;S--){const I=p[S];if(c(I))for(let O=v.length-1;O>=0;O--){const D=v[O].feature;if(D.layer&&y[D.layer.id]<S)break;w.push(D),v.pop()}else for(const O of i){const D=O[I];if(D)for(const N of D)w.push(N.feature)}}return w}queryRasterValue(i,c,p){const y=this.getOwnSource(i);return y?y.type!=="raster-array"?(this.fire(new s.y(new Error('queryRasterValue support only "raster-array" sources.'))),Promise.resolve(null)):y.queryRasterArrayValue(c,p):(this.fire(new s.y(new Error(`Source with id "${i}" does not exist in the style.`))),Promise.resolve(null))}queryRenderedFeatures(i,c,p){let y;c&&!Array.isArray(c)&&c.filter&&(this._validate(Y,"queryRenderedFeatures.filter",c.filter,null,c),y=s.b6(c.filter));const v={},w=D=>{if($p.has(D.type))return;const N=this.getOwnLayerSourceCache(D),z=v[N.id]=v[N.id]||{sourceCache:N,layers:{},has3DLayers:!1};D.is3D(!!this.terrain)&&(z.has3DLayers=!0),z.layers[D.fqid]=z.layers[D.fqid]||{styleLayer:D,targets:[]},z.layers[D.fqid].targets.push({filter:y})};if(c&&c.layers){if(!Array.isArray(c.layers))return this.fire(new s.y(new Error("parameters.layers must be an Array."))),[];for(const D of c.layers){const N=this._layers[D];if(!N)return this.fire(new s.y(new Error(`The layer '${D}' does not exist in the map's style and cannot be queried for features.`))),[];w(N)}}else for(const D in this._layers)w(this._layers[D]);const S=this._queryRenderedFeatures(i,v,p),I=this._flattenAndSortRenderedFeatures(S),O=[];for(const D of I)s.ds(D.layer.id)===this.scope&&O.push(D);return O}queryRenderedFeatureset(i,c,p){let y;c&&!Array.isArray(c)&&c.filter&&(this._validate(Y,"queryRenderedFeatures.filter",c.filter,null,c),y=s.b6(c.filter));const v="mock",w=[];if(c&&c.target)w.push(Object.assign({},c,{targetId:v,filter:y}));else{const D=this.getFeaturesetDescriptors();for(const N of D)w.push({targetId:v,filter:y,target:N});for(const{style:N}of this.fragments){const z=N.getFeaturesetDescriptors();for(const U of z)w.push({targetId:v,filter:y,target:U})}}const S=this.queryRenderedTargets(i,w,p),I=[],O=new Set;for(const D of S)for(const N of D.variants[v])_l(N,D,O)||I.push(new s.dt(D,N));return I}queryRenderedTargets(i,c,p){const y={},v=(S,I,O,D)=>{const N=y[I.id]=y[I.id]||{sourceCache:I,layers:{},has3DLayers:!1};if(N.layers[S.fqid]=N.layers[S.fqid]||{styleLayer:S,targets:[]},S.is3D(!!this.terrain)&&(N.has3DLayers=!0),!D)return O.uniqueFeatureID=!1,void N.layers[S.fqid].targets.push(O);N.layers[S.fqid].targets.push(Object.assign({},O,{namespace:D.namespace,properties:D.properties,uniqueFeatureID:D.uniqueFeatureID}))};for(const S of c)if("featuresetId"in S.target){const{featuresetId:I,importId:O}=S.target,D=this.getFragmentStyle(O);if(!D||!D._featuresetSelectors)continue;const N=D._featuresetSelectors[I];if(!N){this.fire(new s.y(new Error(`The featureset '${I}' does not exist in the map's style and cannot be queried for features.`)));continue}for(const z of N){const U=D.getOwnLayer(z.layerId);U&&!$p.has(U.type)&&v(U,D.getOwnLayerSourceCache(U),S,z)}}else if("layerId"in S.target){const{layerId:I}=S.target,O=this.getLayer(I);if(!O||$p.has(O.type))continue;v(O,this.getLayerSourceCache(O),S)}const w=this._queryRenderedFeatures(i,y,p);return this._flattenAndSortRenderedFeatures(w)}_queryRenderedFeatures(i,c,p){const y=[],v=!!this.map._showQueryGeometry,w=di.createFromScreenPoints(i,p);for(const S in c){const I=fa(w,c[S],this._availableImages,p,v);Object.keys(I).length&&y.push(I)}if(this.placement)for(const S in c){if(!c[S].sourceCache._onlySymbols)continue;const I=pa(w.screenGeometry,c[S],this._availableImages,this.placement.collisionIndex,this.placement.retainedQueryData,this.map.getWorldview());Object.keys(I).length&&y.push(I)}return y}querySourceFeatures(i,c){const p=c&&c.filter;p&&this._validate(Y,"querySourceFeatures.filter",p,null,c);let y=[];const v=this.getOwnSourceCaches(i);for(const w of v)y=y.concat(Ms(w,c));return y}addSourceType(i,c,p){return za.getSourceType(i)?p(new Error(`A source type called "${i}" already exists.`)):(za.setSourceType(i,c),c.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:i,url:c.workerSourceURL},p):p(null,null))}getFlatLight(){return this.light.getLight()}setFlatLight(i,c,p={}){this._checkLoaded();const y=this.light.getLight();let v=!1;for(const S in i)if(!s.by(i[S],y[S])){v=!0;break}if(!v)return;const w=this._getTransitionParameters();this.light.setLight(i,c,p),this.light.updateTransitions(w)}getTerrain(){return this.terrain&&this.terrain.drapeRenderMode===1?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}checkCanvasFingerprintNoise(){this.disableElevatedTerrain===void 0&&(this.disableElevatedTerrain=s.o.hasCanvasFingerprintNoise(),this.disableElevatedTerrain&&s.w("Terrain and hillshade are disabled because of Canvas2D limitations when fingerprinting protection is enabled (e.g. in private browsing mode)."))}setTerrain(i,c=1){if(this._checkLoaded(),!i)return this.terrainSetForDrapingOnly()||(delete this.terrain,this.map.transform.projection.requiresDraping&&this.setTerrainForDraping()),c===0&&delete this.terrain,i===null?this.stylesheet.terrain=null:delete this.stylesheet.terrain,this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);this.checkCanvasFingerprintNoise();let p=i;const y=i.source==null;if(c===1){if(this.disableElevatedTerrain)return;if(typeof p.source=="object"){const S="terrain-dem-src";this.addSource(S,p.source),p=s.dk(p),p=Object.assign(p,{source:S})}const v=Object.assign({},p),w={};if(this.terrain&&y){v.source=this.terrain.get().source;const S=this.terrain?this.getFragmentStyle(this.terrain.scope):null;S&&(w.style=S.serialize())}if(this._validate(xt,"terrain",v,w))return}if(!this.terrain||this.terrain.scope!==this.scope&&!y||this.terrain&&c!==this.terrain.drapeRenderMode){if(!p)return;this._createTerrain(p,c),this.fire(new s.z("data",{dataType:"style"}))}else{const v=this.terrain,w=v.get();for(const S of Object.keys(s.a6.terrain))!p.hasOwnProperty(S)&&s.a6.terrain[S].default&&(p[S]=s.a6.terrain[S].default);for(const S in i)if(!s.by(i[S],w[S])){v.set(i,this.options),this.stylesheet.terrain=i;const I=this._getTransitionParameters({duration:0});v.updateTransitions(I),this.fire(new s.z("data",{dataType:"style"}));break}}this.mergeTerrain(),this.updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(i){const c=this.fog=new fr(i,this.map.transform,this.scope,this.options);this.stylesheet.fog=c.get();const p=this._getTransitionParameters({duration:0});c.updateTransitions(p)}_createSnow(i){const c=this.snow=new fo(i,this.map.transform,this.scope,this.options);this.stylesheet.snow=c.get();const p=this._getTransitionParameters({duration:0});c.updateTransitions(p)}_createRain(i){const c=this.rain=new Zr(i,this.map.transform,this.scope,this.options);this.stylesheet.rain=c.get();const p=this._getTransitionParameters({duration:0});c.updateTransitions(p)}_updateMarkersOpacity(){this.map._markers.length!==0&&this.map._requestDomTask((()=>{for(const i of this.map._markers)i._evaluateOpacity()}))}getFog(){return this.fog?this.fog.get():null}setFog(i){if(this._checkLoaded(),!i)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const c=this.fog;if(!s.by(c.get(),i)){c.set(i,this.options),this.stylesheet.fog=c.get();const p=this._getTransitionParameters({duration:0});c.updateTransitions(p)}}else this._createFog(i);this._markersNeedUpdate=!0}getSnow(){return this.snow?this.snow.get():null}setSnow(i){if(this._checkLoaded(),!i)return delete this.snow,void delete this.stylesheet.snow;if(this.snow){const c=this.snow;if(!s.by(c.get(),i)){c.set(i,this.options),this.stylesheet.snow=c.get();const p=this._getTransitionParameters({duration:0});c.updateTransitions(p)}}else this._createSnow(i);this._markersNeedUpdate=!0}getRain(){return this.rain?this.rain.get():null}setRain(i){if(this._checkLoaded(),!i)return delete this.rain,void delete this.stylesheet.rain;if(this.rain){const c=this.rain;if(!s.by(c.get(),i)){c.set(i,this.options),this.stylesheet.rain=c.get();const p=this._getTransitionParameters({duration:0});c.updateTransitions(p)}}else this._createRain(i);this._markersNeedUpdate=!0}_reloadColorTheme(){const i=()=>{for(const y in this._layers)this._layers[y].lut=this._styleColorTheme.lut;for(const y in this._sourceCaches)this._sourceCaches[y].clearTiles()},c=this._styleColorTheme.colorThemeOverride?this._styleColorTheme.colorThemeOverride:this._styleColorTheme.colorTheme;if(!c)return this._styleColorTheme.lut=null,void i();const p=this._evaluateColorThemeData(c);this._loadColorTheme(p).then((()=>{this.fire(new s.z("colorthemeset")),i()})).catch((y=>{s.w(`Couldn't set color theme: ${y}`)}))}setColorTheme(i){this._checkLoaded(),this._styleColorTheme.colorThemeOverride&&s.w("Note: setColorTheme is called on a style with a color-theme override, the passed color-theme won't be visible."),this._styleColorTheme.colorTheme=i,this._reloadColorTheme()}setImportColorTheme(i,c){const p=this.getFragmentStyle(i);p&&(p._styleColorTheme.colorThemeOverride=c,p._reloadColorTheme())}_getTransitionParameters(i){return{now:s.o.now(),transition:Object.assign(this.transition,i)}}updateDrapeFirstLayers(){if(!this.terrain)return;const i=[],c=[];for(const p of this._mergedOrder)this.isLayerDraped(this._mergedLayers[p])?i.push(p):c.push(p);this._drapedFirstOrder=[],this._drapedFirstOrder.push(...i),this._drapedFirstOrder.push(...c)}_createTerrain(i,c){const p=this.terrain=new nt(i,c,this.scope,this.options,this.map.getWorldview());c===1&&(this.stylesheet.terrain=i),this.mergeTerrain(),this.updateDrapeFirstLayers(),this._force3DLayerUpdate();const y=this._getTransitionParameters({duration:0});p.updateTransitions(y)}_force3DLayerUpdate(){for(const i in this._layers){const c=this._layers[i];c.type==="fill-extrusion"&&this._updateLayer(c)}}_forceSymbolLayerUpdate(){for(const i in this._layers){const c=this._layers[i];c.type==="symbol"&&this._updateLayer(c)}}_validate(i,c,p,y,v={}){if(v&&v.validate===!1)return!1;const w=Object.assign({},this.serialize());return Du(this,i.call(Os,Object.assign({key:c,style:w,value:p,styleSpec:s.a6},y)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),s.du.off("pluginStateChange",this._rtlTextPluginCallback);for(const i in this._mergedLayers)this._mergedLayers[i].setEventedParent(null);for(const i in this._mergedSourceCaches)this._mergedSourceCaches[i].clearTiles(),this._mergedSourceCaches[i].setEventedParent(null);this.imageManager.removeScope(this.scope),this.setEventedParent(null),delete this.fog,delete this.snow,delete this.rain,delete this.terrain,delete this.ambientLight,delete this.directionalLight,this.isRootStyle()&&(this.imageManager.setEventedParent(null),this.imageManager.destroy(),this.modelManager.setEventedParent(null),this.modelManager.destroy(),this.dispatcher.remove())}clearSource(i){const c=this.getSourceCaches(i);for(const p of c)p.clearTiles()}clearSources(){for(const i in this._mergedSourceCaches)this._mergedSourceCaches[i].clearTiles()}clearLayers(){for(const i in this._mergedLayers){const c=this._mergedLayers[i];c._clear&&c._clear()}}reloadSource(i){const c=this.getSourceCaches(i);for(const p of c)p.resume(),p.reload()}reloadSources(){for(const i of this.getSources())i.reload&&i.reload()}reloadModels(){this.modelManager.reloadModels(""),this.forEachFragmentStyle((i=>{i.modelManager.reloadModels(i.scope)}))}updateSources(i){let c;this.directionalLight&&(c=Bd(this.directionalLight));const p=new Set;for(const y in this._mergedLayers){const v=this._mergedLayers[y];v.hasElevation()&&!p.has(v.source)&&p.add(v.source)}for(const y in this._mergedSourceCaches){const v=this._mergedSourceCaches[y],w=p.has(v._source.id);v.update(i,void 0,void 0,c,w)}}_generateCollisionBoxes(){for(const i in this._sourceCaches){const c=this._sourceCaches[i];c.resume(),c.reload()}}_updatePlacement(i,c,p,y,v,w,S=!1){let I=!1,O=!1;const D={},N={};for(const z of this._mergedOrder){const U=this._mergedLayers[z];if(U.type!=="symbol")continue;const G=s.B(U.source,U.scope);let H=D[G];if(!H){const Z=this.getLayerSourceCache(U);if(!Z)continue;const ee=Z.getRenderableIds(!0).map((ie=>Z.getTileByID(ie)));N[G]=ee.slice(),H=D[G]=ee.sort(((ie,se)=>se.tileID.overscaledZ-ie.tileID.overscaledZ||(ie.tileID.isLessThan(se.tileID)?-1:1)))}const J=this.crossTileSymbolIndex.addLayer(U,H,c.center.lng,c.projection);I=I||J}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._mergedOrder),S=S||this._layerOrderChanged||y===0,this._layerOrderChanged&&this.fire(new s.z("neworder")),(S||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(s.o.now(),c.zoom))&&(this.pauseablePlacement=new pt(c,this._mergedOrder,S,p,y,v,this.placement,this.fog&&c.projection.supportsFog?this.fog.state:null,this._buildingIndex),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._mergedOrder,this._mergedLayers,D,N,this.map.painter.scaleFactor),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(s.o.now()),O=!0),I&&this.pauseablePlacement.placement.setStale()),O||I){this._buildingIndex.onNewFrame(c.zoom);for(let z=0;z<this._mergedOrder.length;z++){const U=this._mergedLayers[this._mergedOrder[z]];if(U.type!=="symbol")continue;const G=this.isLayerClipped(U);this.placement.updateLayerOpacities(U,D[s.B(U.source,U.scope)],z,G?w:null)}}return{needsRerender:!this.pauseablePlacement.isDone()||this.placement.hasTransitions(s.o.now())}}_releaseSymbolFadeTiles(){for(const i in this._sourceCaches)this._sourceCaches[i].releaseSymbolFadeTiles()}addImport(i,c){this._checkLoaded();const p=this.stylesheet.imports=this.stylesheet.imports||[];if(p.findIndex((({id:v})=>v===i.id))!==-1)return void this.fire(new s.y(new Error(`Import with id '${i.id}' already exists in the map's style.`)));if(!c)return p.push(i),this._loadImports([i],!0);const y=p.findIndex((({id:v})=>v===c));return y===-1&&this.fire(new s.y(new Error(`Import with id "${c}" does not exist on this map.`))),this.stylesheet.imports=p.slice(0,y).concat(i).concat(p.slice(y)),this._loadImports([i],!0,c)}updateImport(i,c){this._checkLoaded();const p=this.stylesheet.imports||[],y=this.getImportIndex(i);return y===-1?this:typeof c=="string"?(this.setImportUrl(i,c),this):(c.url&&c.url!==p[y].url&&this.setImportUrl(i,c.url),s.by(c.config,p[y].config)||this.setImportConfig(i,c.config,c.data.schema),s.by(c.data,p[y].data)||this.setImportData(i,c.data),this)}moveImport(i,c){this._checkLoaded();let p=this.stylesheet.imports||[];const y=this.getImportIndex(i);if(y===-1)return this;const v=this.getImportIndex(c);if(v===-1)return this;const w=p[y],S=this.fragments[y];return p=p.filter((({id:I})=>I!==i)),this.fragments=this.fragments.filter((({id:I})=>I!==i)),this.stylesheet.imports=p.slice(0,v).concat(w).concat(p.slice(v)),this.fragments=this.fragments.slice(0,v).concat(S).concat(this.fragments.slice(v)),this.mergeLayers(),this}setImportUrl(i,c){this._checkLoaded();const p=this.stylesheet.imports||[],y=this.getImportIndex(i);if(y===-1)return this;p[y].url=c;const v=this.fragments[y];return v.style=this._createFragmentStyle(p[y]),v.style.on("style.import.load",(()=>this.mergeAll())),v.style.loadURL(c),this}setImportData(i,c){this._checkLoaded();const p=this.getImportIndex(i),y=this.stylesheet.imports||[];return p===-1?this:c?(this.fragments[p].style.setState(c),this._reloadImports(),this):(delete y[p].data,this.setImportUrl(i,y[p].url))}setImportConfig(i,c,p){this._checkLoaded();const y=this.getImportIndex(i),v=this.stylesheet.imports||[];if(y===-1)return this;c?v[y].config=c:delete v[y].config;const w=this.fragments[y];p&&w.style.stylesheet&&(w.style.stylesheet.schema=p);const S=w.style.stylesheet&&w.style.stylesheet.schema;return w.config=c,w.style.updateConfig(c,S),this.updateConfigDependencies(),this}removeImport(i){this._checkLoaded();const c=this.stylesheet.imports||[],p=this.getImportIndex(i);p!==-1&&(c.splice(p,1),this.fragments[p].style._remove(),this.fragments.splice(p,1),this._reloadImports())}getImportIndex(i){const c=(this.stylesheet.imports||[]).findIndex((p=>p.id===i));return c===-1&&this.fire(new s.y(new Error(`Import '${i}' does not exist in the map's style and cannot be updated.`))),c}getLayer(i){return this._mergedLayers[i]}getSources(){const i=[];for(const c in this._mergedOtherSourceCaches){const p=this._mergedOtherSourceCaches[c];p&&i.push(p.getSource())}return i}getSource(i,c){const p=this.getSourceCache(i,c);return p&&p.getSource()}getLayerSource(i){const c=this.getLayerSourceCache(i);return c&&c.getSource()}getSourceCache(i,c){const p=s.B(i,c);return this._mergedOtherSourceCaches[p]}getLayerSourceCache(i){const c=s.B(i.source,i.scope);return i.type==="symbol"?this._mergedSymbolSourceCaches[c]:this._mergedOtherSourceCaches[c]}getSourceCaches(i){if(i==null)return Object.values(this._mergedSourceCaches);const c=[];return this._mergedOtherSourceCaches[i]&&c.push(this._mergedOtherSourceCaches[i]),this._mergedSymbolSourceCaches[i]&&c.push(this._mergedSymbolSourceCaches[i]),c}updateSourceCaches(){const i=this._changes.getUpdatedSourceCaches();for(const c in i){const p=i[c];p==="reload"?this.reloadSource(c):p==="clear"&&this.clearSource(c)}}updateLayers(i){const c=this._changes.getUpdatedPaintProperties();for(const p of c){const y=this.getLayer(p);y&&y.updateTransitions(i)}}getGlyphsUrl(){return this.stylesheet.glyphs}setGlyphsUrl(i){this.stylesheet.glyphs=i,this.glyphManager.setURL(i)}getImages(i,c,p){this.imageManager.getImages(c.images,c.scope,p),this._updateTilesForChangedImages();const y=w=>{if(w){const S=c.images.map((I=>s.I.toString(I)));w.setDependencies(c.tileID.key,c.type,S)}},v=s.B(c.source,c.scope);y(this._mergedOtherSourceCaches[v]),y(this._mergedSymbolSourceCaches[v]),c.images.some((w=>w.iconsetId))&&this.fire(new s.z("data",{dataType:"style"}))}rasterizeImages(i,c,p){this.imageManager.rasterizeImages(c,p)}getGlyphs(i,c,p){this.glyphManager.getGlyphs(c.stacks,p)}getResource(i,c,p){return s.dv(c,p)}getOwnSourceCache(i){return this._otherSourceCaches[i]}getOwnLayerSourceCache(i){return i.type==="symbol"?this._symbolSourceCaches[i.source]:this._otherSourceCaches[i.source]}getOwnSourceCaches(i){const c=[];return this._otherSourceCaches[i]&&c.push(this._otherSourceCaches[i]),this._symbolSourceCaches[i]&&c.push(this._symbolSourceCaches[i]),c}_isSourceCacheLoaded(i){const c=this.getOwnSourceCaches(i);return c.length===0?(this.fire(new s.y(new Error(`There is no source with ID '${i}'`))),!1):c.every((p=>p.loaded()))}has3DLayers(){return this._has3DLayers}hasSymbolLayers(){return this._hasSymbolLayers}hasCircleLayers(){return this._hasCircleLayers}isLayerClipped(i,c){if(!this._clipLayerPresent&&i.type!=="fill-extrusion"&&i.type!=="building")return!1;const p=i.type==="fill-extrusion"&&(i.sourceLayer==="building"||i.sourceLayer==="procedural_buildings"),y=i.type==="building";if(i.is3D(!!this.terrain)){if(p||y||c&&c.type==="batched-model"||i.type==="model")return!0}else if(i.type==="symbol")return!0;return!1}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.fragments.forEach((i=>{i.style._remove()})),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}za.getSourceType=function(m){return xc[m]},za.setSourceType=function(m,i){xc[m]=i},za.registerForPluginStateChange=s.dw;class vb{execute(i){const c=this._makeBuildingsQueryArea(i),p=this._makeFloorsQueryArea(i),y=i.queryRenderedFeatures(c).reduce(((O,D)=>{const N=D.properties.id;return D.properties.type!=="building"||O.some((z=>z.properties.id===N))||O.push(D),O}),[]),v=i.queryRenderedFeatures(p).reduce(((O,D)=>{const N=D.properties.id;return D.properties.type!=="floor"||O.some((z=>z.properties.id===N))||O.push(D),O}),[]),w=[i.getCenter().lng,i.getCenter().lat],S=this._findBuildingAtCenter(w,y),I=y.length>0?y[0]:null;return{floors:v.map((O=>({id:O.properties.id,name:O.properties.name,isDefault:O.properties.is_default,zIndex:O.properties.z_index,connectedFloorIds:O.properties.connected_floor_ids,conflictedFloorIds:O.properties.conflicted_floor_ids,buildingIds:O.properties.building_ids}))),building:S?{id:S.properties.id,name:S.properties.name}:{id:I.properties.id,name:I.properties.name}}}_makeBuildingsQueryArea(i){const c=i.transform.width,p=i.transform.height,y=Math.min(c,p)*(1/8),v=.5*(c-y),w=.5*(p-y);return[new s.P(v,w),new s.P(v+y,w+y)]}_makeFloorsQueryArea(i){const c=i.transform.width,p=i.transform.height;return[new s.P(0,0),new s.P(c,p)]}_findBuildingAtCenter(i,c){for(const p of c)if(p.geometry.type==="Polygon"&&this._pointInPolygon(i,p.geometry.coordinates[0]))return p;return null}_pointInPolygon(i,c){let p=!1;for(let y=0,v=c.length-1;y<c.length;v=y++){const w=c[y][0],S=c[y][1],I=c[v][1];S>i[1]!=I>i[1]&&i[0]<(c[v][0]-w)*(i[1]-S)/(I-S)+w&&(p=!p)}return p}}class bb{constructor(){this._floors=new Map,this._buildings=new Map}append(i){const c=i.building;let p=!1;if(c){const y=c.id;y&&(this._buildings.set(y,c),p||this._buildings.has(y)||(p=!0))}return i.floors.forEach((y=>{const v=y.id;p||this._floors.has(v)||(p=!0),this._floors.set(v,y)})),p}clear(){this._floors.clear(),this._buildings.clear()}getFloors(i=null){const c=Array.from(this._floors.values());return i?c.filter((p=>{const y=p.buildingIds;return!!y&&y.split(";").includes(i)})):c}}class xb{constructor(){this._selectedFloorId=null,this._selectedBuildingId=null,this._lastActiveFloors=[],this._featuresStorage=new bb}setIndoorData(i){const c=this._featuresStorage.append(i);return this._selectedBuildingId=i.building?i.building.id:null,c}setFloorId(i){const c=this._selectedFloorId!==i;return c&&(this._selectedFloorId=i),c}getCurrentBuildingSelection(){if(!this._selectedBuildingId)return{selectedFloorId:null,floors:[]};const i=this._featuresStorage.getFloors(this._selectedBuildingId),c=this.getActiveFloors().find((p=>{const y=p.buildingIds;if(!y)return!1;const v=y.split(";");return!!this._selectedBuildingId&&v.includes(this._selectedBuildingId)}));return{selectedFloorId:c?c.id:null,floors:i}}getActiveFloors(i=!1){const c=this._featuresStorage.getFloors(),p=c.find((I=>I.id===this._selectedFloorId)),y=c.filter((I=>I.isDefault===!0));let v=[];if(p)return v=this._calculateCurrentActiveFloors(c,p,y,i),v;if(y.length===0){const I=this._featuresStorage.getFloors(this._selectedBuildingId);v=I.length>0?[I[0]]:[]}else v=y;const w=this._getNonConflictingLastActiveFloors(v),S=[...v,...w];return this._lastActiveFloors=S,S}hasBuildingChanged(i){return this._selectedBuildingId!==(i.building?i.building.id:null)}hasActiveBuilding(){return this._selectedBuildingId!==null}isEmpty(){return this._selectedFloorId===null&&this._selectedBuildingId===null&&this._lastActiveFloors.length===0}_calculateCurrentActiveFloors(i,c,p,y){if(!c)return this._getNonConflictingDefaultFloors(this._lastActiveFloors,p);const v=this._getConnectedFloors(c,i);return y?this._buildExplicitSelectionFloors(c,v,p):this._buildImplicitSelectionFloors(v,p)}_getConnectedFloors(i,c){const p=i.connectedFloorIds;if(!p)return[];const y=new Set(p.split(";"));return c.filter((v=>y.has(v.id)))}_buildExplicitSelectionFloors(i,c,p){const y=[i,...c],v=this._getNonConflictingLastActiveFloors(y),w=[...y,...v],S=this._deduplicateFloors(w),I=this._getConflictingFloorIdsFrom(S),O=p.filter((N=>!I.has(N.id))),D=[...S,...O];return this._lastActiveFloors=D,D}_buildImplicitSelectionFloors(i,c){const p=this._getConflictingFloorIdsFrom(this._lastActiveFloors),y=c.filter((w=>!p.has(w.id))),v=this._deduplicateFloors([...this._lastActiveFloors,...y]);return this._lastActiveFloors=v,v}_getNonConflictingDefaultFloors(i,c){const p=this._getConflictingFloorIdsFrom(i),y=c.filter((w=>!p.has(w.id))),v=this._deduplicateFloors([...i,...y]);return this._lastActiveFloors=v,v}_deduplicateFloors(i){const c=new Set;return i.filter((p=>{const y=p.id;return!c.has(y)&&(c.add(y),!0)}))}_getConflictingFloorIdsFrom(i){const c=new Set;return i.forEach((p=>{const y=p.conflictedFloorIds;y&&y.split(";").forEach((v=>c.add(v)))})),c}_getNonConflictingLastActiveFloors(i){if(!this._lastActiveFloors||this._lastActiveFloors.length===0)return[];const c=new Set(i.map((y=>y.id))),p=this._getConflictingFloorIdsFrom(i);return this._lastActiveFloors.filter((y=>{const v=y.id;return!c.has(v)&&!p.has(v)}))}_isFloorConflicted(i,c){const p=i.id;return c.some((y=>{const v=y.conflictedFloorIds;return!!v&&v.split(";").includes(p)}))}reset(){this._selectedFloorId=null,this._selectedBuildingId=null,this._lastActiveFloors=[],this._featuresStorage.clear()}}class Lu extends s.E{constructor(i){super(),s.aY(["_onLoad","_onMove"],this),this._map=i,this._floorSelectionState=new xb,this._queryIndoor(),this._map.on("load",this._onLoad),this._map.on("move",this._onMove)}destroy(){this._map.off("load",this._onLoad),this._map.off("move",this._onMove),this._map=null,this._floorSelectionState=null}selectFloor(i){this._floorSelectionState.setFloorId(i)&&this._updateIndoorConfig(!0)}_onLoad(){this._map.style.forEachFragmentStyle((i=>{i.stylesheet.indoor&&(this._indoorDataQuery?this.fire(new s.y(new Error("Multiple indoor map styles detected, simultaneous usage is not allowed currently."))):(this._scope=i.scope,this._indoorDataQuery=new vb))})),this._map._addIndoorControl(),this._queryIndoor()}_onMove(){this._queryIndoor()}_queryIndoor(){if(!this._indoorDataQuery||!this._map.isStyleLoaded())return;if(this._map.transform.zoom<15)return void this._clearIndoorData();const i=this._indoorDataQuery.execute(this._map);if(!i||i.floors.length===0||this._map.transform.zoom<16)this._clearIndoorData();else if(this._floorSelectionState.hasBuildingChanged(i)){if(!i.building&&this._floorSelectionState.getActiveFloors().length<=0)return void this._clearIndoorData();this._setIndoorData(i),i.building&&this._updateIndoorSelector()}else this._setIndoorData(i)}_setIndoorData(i){this._floorSelectionState.setIndoorData(i)&&this._updateIndoorConfig()}_clearIndoorData(){this._floorSelectionState.isEmpty()||(this._floorSelectionState.reset(),this._updateIndoorSelector(),this._map.setConfigProperty(this._scope,"activeFloors",["literal",[]]))}_updateIndoorSelector(){const i=this._floorSelectionState.getCurrentBuildingSelection(),c=i.floors.map((p=>({id:p.id,name:p.name,shortName:p.zIndex.toString(),levelOrder:p.zIndex})));this.fire(new s.z("indoorupdate",{selectedFloorId:i.selectedFloorId,floors:c}))}_updateIndoorConfig(i=!1){const c=this._floorSelectionState.getActiveFloors(i).map((p=>p.id))||[];this._map.setConfigProperty(this._scope,"activeFloors",["literal",c])}}var xf=`
#define EPSILON 0.0000001
#define PI 3.141592653589793
#ifdef RENDER_CUTOFF
float cutoff_opacity(vec4 cutoff_params,float depth) {float near=cutoff_params.x;float far=cutoff_params.y;float cutoffStart=cutoff_params.z;float cutoffEnd=cutoff_params.w;float linearDepth=(depth-near)/(far-near);return clamp((linearDepth-cutoffStart)/(cutoffEnd-cutoffStart),0.0,1.0);}
#endif`,p_=`
out vec4 glFragColor;highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}
#ifdef INDICATOR_CUTOUT
uniform vec3 u_indicator_cutout_centers;uniform vec4 u_indicator_cutout_params;
#endif
vec4 applyCutout(vec4 color,float height) {
#ifdef INDICATOR_CUTOUT
float verticalFadeRange=u_indicator_cutout_centers.z*0.25;float holeMinOpacity=mix(1.0,u_indicator_cutout_params.x,smoothstep(u_indicator_cutout_centers.z,u_indicator_cutout_centers.z+verticalFadeRange,height));float holeRadius=max(u_indicator_cutout_params.y,0.0);float holeAspectRatio=u_indicator_cutout_params.z;float fadeStart=u_indicator_cutout_params.w;float distA=distance(vec2(gl_FragCoord.x,gl_FragCoord.y*holeAspectRatio),vec2(u_indicator_cutout_centers[0],u_indicator_cutout_centers[1]*holeAspectRatio));return color*min(smoothstep(fadeStart,holeRadius,distA)+holeMinOpacity,1.0);
#else
return color;
#endif
}
#ifdef DEBUG_WIREFRAME
#define HANDLE_WIREFRAME_DEBUG \\
glFragColor=vec4(0.7,0.0,0.0,0.7); \\
gl_FragDepth=gl_FragCoord.z-0.0001;
#else
#define HANDLE_WIREFRAME_DEBUG
#endif
#ifdef RENDER_CUTOFF
uniform highp vec4 u_cutoff_params;in float v_cutoff_opacity;
#endif
vec4 textureLodCustom(sampler2D image,highp vec2 pos,highp vec2 lod_coord) {highp vec2 size=vec2(textureSize(image,0));highp vec2 dx=dFdx(lod_coord.xy*size);highp vec2 dy=dFdy(lod_coord.xy*size);highp float delta_max_sqr=max(dot(dx,dx),dot(dy,dy));highp float lod=0.5*log2(delta_max_sqr);return textureLod(image,pos,lod);}vec4 applyLUT(highp sampler3D lut,vec4 col) {vec3 size=vec3(textureSize(lut,0));vec3 uvw=(col.rbg*float(size-1.0)+0.5)/size;return vec4(texture(lut,uvw).rgb*col.a,col.a);}vec3 applyLUT(highp sampler3D lut,vec3 col) {return applyLUT(lut,vec4(col,1.0)).rgb;}`,m_=`
#define EXTENT 8192.0
#define RAD_TO_DEG 180.0/PI
#define DEG_TO_RAD PI/180.0
#define GLOBE_RADIUS EXTENT/PI/2.0
float wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}
#ifdef PROJECTION_GLOBE_VIEW
vec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {
#ifndef PROJECTED_POS_ON_VIEWPORT
float tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;
#else
return vec3(0.0);
#endif
}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(
unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const vec2 units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (units_to_pixels*pos+offset)/pattern_size;}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {return get_pattern_pos(pixel_coord_upper,pixel_coord_lower,pattern_size,vec2(tile_units_to_pixels),pos);}float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(PI/4.0+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}
#ifdef RENDER_CUTOFF
uniform vec4 u_cutoff_params;out float v_cutoff_opacity;
#endif
const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);const float skirtOffset=24575.0;vec3 decomposeToPosAndSkirt(vec2 posWithComposedSkirt)
{float skirt=float(posWithComposedSkirt.x >=skirtOffset);vec2 pos=posWithComposedSkirt-vec2(skirt*skirtOffset,0.0);return vec3(pos,skirt);}`,Vd="in highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;out highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",$d=`
#define ELEVATION_SCALE 7.0
#define ELEVATION_OFFSET 450.0
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(
mix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}
#else
vec3 elevationVector(vec2 pos) { return vec3(0,0,1); }
#endif
#ifdef TERRAIN
uniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float currentElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem,pos).r;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=texture(u_dem,pos).r;float tr=texture(u_dem,pos+vec2(dd,0)).r;float bl=texture(u_dem,pos+vec2(0,dd)).r;float br=texture(u_dem,pos+vec2(dd,dd)).r;return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}float prevElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem_prev,pos).r;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=texture(u_dem_prev,pos).r;float tr=texture(u_dem_prev,pos+vec2(dd,0)).r;float bl=texture(u_dem_prev,pos+vec2(0,dd)).r;float br=texture(u_dem_prev,pos+vec2(dd,dd)).r;return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}
#ifdef TERRAIN_VERTEX_MORPHING
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
float nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}
#else
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
return currentElevation(apos);}
#endif
vec4 fourSample(vec2 pos,vec2 off) {float tl=texture(u_dem,pos).r;float tr=texture(u_dem,pos+vec2(off.x,0.0)).r;float bl=texture(u_dem,pos+vec2(0.0,off.y)).r;float br=texture(u_dem,pos+off).r;return vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}
#else
float elevation(vec2 pos) { return 0.0; }
#endif
#ifdef DEPTH_OCCLUSION
uniform highp sampler2D u_depth;uniform highp vec2 u_depth_size_inv;uniform highp vec2 u_depth_range_unpack;uniform highp float u_occluder_half_size;uniform highp float u_occlusion_depth_offset;
#ifdef DEPTH_D24
float unpack_depth(float depth) {return depth*u_depth_range_unpack.x+u_depth_range_unpack.y;}vec4 unpack_depth4(vec4 depth) {return depth*u_depth_range_unpack.x+vec4(u_depth_range_unpack.y);}
#else
highp float unpack_depth_rgba(vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}
#endif
bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;
#ifdef DEPTH_D24
float depth=unpack_depth(texture(u_depth,(coord.xy+1.0)*0.5).r);
#else
float depth=unpack_depth_rgba(texture(u_depth,(coord.xy+1.0)*0.5));
#endif
return coord.z+u_occlusion_depth_offset > depth;}highp vec4 getCornerDepths(vec2 coord) {highp vec3 df=vec3(u_occluder_half_size*u_depth_size_inv,0.0);highp vec2 uv=0.5*coord.xy+0.5;
#ifdef DEPTH_D24
highp vec4 depth=vec4(
texture(u_depth,uv-df.xz).r,texture(u_depth,uv+df.xz).r,texture(u_depth,uv-df.zy).r,texture(u_depth,uv+df.zy).r
);depth=unpack_depth4(depth);
#else
highp vec4 depth=vec4(
unpack_depth_rgba(texture(u_depth,uv-df.xz)),unpack_depth_rgba(texture(u_depth,uv+df.xz)),unpack_depth_rgba(texture(u_depth,uv-df.zy)),unpack_depth_rgba(texture(u_depth,uv+df.zy))
);
#endif
return depth;}highp float occlusionFadeMultiSample(vec4 frag) {highp vec3 coord=frag.xyz/frag.w;highp vec2 uv=0.5*coord.xy+0.5;int NX=3;int NY=4;highp vec2 df=u_occluder_half_size*u_depth_size_inv;highp vec2 oneStep=2.0*u_occluder_half_size*u_depth_size_inv/vec2(NX-1,NY-1);highp float res=0.0;for (int y=0; y < NY;++y) {for (int x=0; x < NX;++x) {
#ifdef DEPTH_D24
highp float depth=unpack_depth(texture(u_depth,uv-df+vec2(float(x)*oneStep.x,float(y)*oneStep.y)).r);
#else
highp float depth=unpack_depth_rgba(texture(u_depth,uv-df+vec2(float(x)*oneStep.x,float(y)*oneStep.y)));
#endif
res+=1.0-clamp(300.0*(coord.z+u_occlusion_depth_offset-depth),0.0,1.0);}}res=clamp(2.0*res/float(NX*NY)-0.5,0.0,1.0);return res;}highp float occlusionFade(vec4 frag) {highp vec3 coord=frag.xyz/frag.w;highp vec4 depth=getCornerDepths(coord.xy);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z+u_occlusion_depth_offset)-depth),0.0,1.0));}
#else
bool isOccluded(vec4 frag) { return false; }highp float occlusionFade(vec4 frag) { return 1.0; }highp float occlusionFadeMultiSample(vec4 frag) { return 1.0; }
#endif//DEPTH_OCCLUSION`,g_=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;out vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}
#endif`,jp=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump vec2 u_fog_vertical_limit;uniform mediump float u_fog_temporal_offset;in vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;
#ifdef FLIP_Y
uv.y=1.0-uv.y;
#endif
highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos,float opacity_limit) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,min(opacity,opacity_limit));}vec3 fog_apply(vec3 color,vec3 pos) {return fog_apply(color,pos,1.0);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec4 fog_apply_premultiplied(vec4 color,vec3 pos,float heightMeters) {float verticalProgress=(u_fog_vertical_limit.x > 0.0 || u_fog_vertical_limit.y > 0.0) ? smoothstep(u_fog_vertical_limit.x,u_fog_vertical_limit.y,heightMeters) : 0.0;float opacityLimit=1.0-smoothstep(0.9,1.0,fog_opacity(pos));return mix(fog_apply_premultiplied(color,pos),color,min(verticalProgress,opacityLimit));}vec3 fog_dither(vec3 color) {return color;}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}
#endif`,ga=`#ifdef RASTER_ARRAY
uniform highp sampler2D u_image0;uniform sampler2D u_image1;const vec4 NODATA=vec4(1);ivec4 _raTexLinearCoord(highp vec2 texCoord,highp vec2 texResolution,out highp vec2 fxy) {texCoord=texCoord*texResolution-0.5;fxy=fract(texCoord);texCoord-=fxy;return ivec4(texCoord.xxyy+vec2(1.5,0.5).xyxy);}vec2 _raTexLinearMix(highp vec2 fxy,highp vec4 colorMix,highp float colorOffset,highp vec4 t00,highp vec4 t10,highp vec4 t01,highp vec4 t11) {vec2 c00=t00==NODATA ? vec2(0) : vec2(colorOffset+dot(t00,colorMix),1);vec2 c10=t10==NODATA ? vec2(0) : vec2(colorOffset+dot(t10,colorMix),1);vec2 c01=t01==NODATA ? vec2(0) : vec2(colorOffset+dot(t01,colorMix),1);vec2 c11=t11==NODATA ? vec2(0) : vec2(colorOffset+dot(t11,colorMix),1);return mix(mix(c01,c11,fxy.x),mix(c00,c10,fxy.x),fxy.y);}vec2 raTexture2D_image0_linear(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec2 fxy;ivec4 c=_raTexLinearCoord(texCoord,texResolution,fxy);return _raTexLinearMix(fxy,colorMix,colorOffset,texelFetch(u_image0,c.yz,0),texelFetch(u_image0,c.xz,0),texelFetch(u_image0,c.yw,0),texelFetch(u_image0,c.xw,0)
);}vec2 raTexture2D_image1_linear(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec2 fxy;ivec4 c=_raTexLinearCoord(texCoord,texResolution,fxy);return _raTexLinearMix(fxy,colorMix,colorOffset,texelFetch(u_image1,c.yz,0),texelFetch(u_image1,c.xz,0),texelFetch(u_image1,c.yw,0),texelFetch(u_image1,c.xw,0)
);}vec2 raTexture2D_image0_nearest(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec4 t=texelFetch(u_image0,ivec2(texCoord*texResolution),0);return t==NODATA ? vec2(0) : vec2(colorOffset+dot(t,colorMix),1);}vec2 raTexture2D_image1_nearest(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec4 t=texelFetch(u_image1,ivec2(texCoord*texResolution),0);return t==NODATA ? vec2(0) : vec2(colorOffset+dot(t,colorMix),1);}
#endif`,Gp=`#ifdef RASTER_ARRAY
uniform sampler2D u_velocity;uniform mediump vec2 u_velocity_res;uniform mediump float u_max_speed;const vec4 NO_DATA=vec4(1);const vec2 INVALID_VELOCITY=vec2(-1);uniform highp vec2 u_uv_offset;uniform highp float u_data_offset;uniform highp vec2 u_data_scale;ivec4 rasterArrayLinearCoord(highp vec2 texCoord,highp vec2 texResolution,out highp vec2 fxy) {texCoord=texCoord*texResolution-0.5;fxy=fract(texCoord);texCoord-=fxy;return ivec4(texCoord.xxyy+vec2(1.5,0.5).xyxy);}highp vec2 lookup_velocity(highp vec2 uv) {uv=u_uv_offset.x+u_uv_offset.y*uv;highp vec2 fxy;ivec4 c=rasterArrayLinearCoord(uv,u_velocity_res,fxy);highp vec4 tl=texelFetch(u_velocity,c.yz,0);highp vec4 tr=texelFetch(u_velocity,c.xz,0);highp vec4 bl=texelFetch(u_velocity,c.yw,0);highp vec4 br=texelFetch(u_velocity,c.xw,0);if (tl==NO_DATA) {return INVALID_VELOCITY;}if (tr==NO_DATA) {return INVALID_VELOCITY;}if (bl==NO_DATA) {return INVALID_VELOCITY;}if (br==NO_DATA) {return INVALID_VELOCITY;}highp vec4 t=mix(mix(bl,br,fxy.x),mix(tl,tr,fxy.x),fxy.y);highp vec2 velocity=u_data_offset+vec2(dot(t.rg,u_data_scale),dot(t.ba,u_data_scale));velocity.y=-velocity.y;velocity/=max(u_max_speed,length(velocity));return velocity;}
#endif
uniform highp float u_particle_pos_scale;uniform highp vec2 u_particle_pos_offset;highp vec4 pack_pos_to_rgba(highp vec2 p) {highp vec2 v=(p+u_particle_pos_offset)/u_particle_pos_scale;highp vec4 r=vec4(v.x,fract(v.x*255.0),v.y,fract(v.y*255.0));return vec4(r.x-r.y/255.0,r.y,r.z-r.w/255.0,r.w);}highp vec2 unpack_pos_from_rgba(highp vec4 v) {v=floor(v*255.0+0.5)/255.0;highp vec2 p=vec2(v.x+(v.y/255.0),v.z+(v.w/255.0));return u_particle_pos_scale*p-u_particle_pos_offset;}`,zt=`#ifdef RENDER_SHADOWS
uniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_normal_offset;vec3 shadow_normal_offset(vec3 normal) {float tileInMeters=u_shadow_normal_offset[0];vec3 n=vec3(-normal.xy,tileInMeters*normal.z);float dotScale=min(1.0-dot(normal,u_shadow_direction),1.0)*0.5+0.5;return n*dotScale;}vec3 shadow_normal_offset_model(vec3 normal) {vec3 transformed_normal=vec3(-normal.xy,normal.z);float NDotL=dot(normalize(transformed_normal),u_shadow_direction);float dotScale=min(1.0-NDotL,1.0)*0.5+0.5;return normal*dotScale;}float shadow_normal_offset_multiplier0() {return u_shadow_normal_offset[1];}float shadow_normal_offset_multiplier1() {return u_shadow_normal_offset[2];}
#endif//RENDER_SHADOWS`,__=`#ifdef RENDER_SHADOWS
precision highp sampler2DShadow;uniform sampler2DShadow u_shadowmap_0;uniform sampler2DShadow u_shadowmap_1;uniform float u_shadow_intensity;uniform float u_shadow_map_resolution;uniform float u_shadow_texel_size;uniform highp vec3 u_shadow_normal_offset;uniform vec2 u_fade_range;uniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_bias;float shadow_sample(sampler2DShadow shadowmap,highp vec3 pos,highp float bias) {
#ifdef CLIP_ZERO_TO_ONE
highp vec3 coord=vec3(pos.xy*0.5+0.5,pos.z-bias);
#else
highp vec3 coord=vec3(pos.xy*0.5+0.5,pos.z*0.5+0.5-bias);
#endif
return texture(shadowmap,coord);}float shadow_occlusion(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth,highp float bias) {light_view_pos0.xyz/=light_view_pos0.w;
#ifdef SHADOWS_SINGLE_CASCADE
vec2 abs_bounds=abs(light_view_pos0.xy);if (abs_bounds.x >=1.0 || abs_bounds.y >=1.0) {return 0.0;}return shadow_sample(u_shadowmap_0,light_view_pos0.xyz,bias);
#else
light_view_pos1.xyz/=light_view_pos1.w;vec4 abs_bounds=abs(vec4(light_view_pos0.xy,light_view_pos1.xy));if (abs_bounds.x < 1.0 && abs_bounds.y < 1.0) {return shadow_sample(u_shadowmap_0,light_view_pos0.xyz,bias);}if (abs_bounds.z >=1.0 || abs_bounds.w >=1.0) {return 0.0;}float occlusion1=shadow_sample(u_shadowmap_1,light_view_pos1.xyz,bias);return clamp(mix(occlusion1,0.0,smoothstep(u_fade_range.x,u_fade_range.y,view_depth)),0.0,1.0);
#endif
}highp float calculate_shadow_bias(float NDotL) {
#ifdef NORMAL_OFFSET
return 0.5*u_shadow_bias.x;
#else
return 0.5*(u_shadow_bias.x+clamp(u_shadow_bias.y*tan(acos(NDotL)),0.0,u_shadow_bias.z));
#endif
}float shadowed_light_factor_normal(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=calculate_shadow_bias(NDotL);float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor_normal_opacity(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth,float shadow_opacity) {float NDotL=dot(N,u_shadow_direction);float bias=calculate_shadow_bias(NDotL);float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias)*shadow_opacity;return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor_normal_unbiased(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}highp vec2 compute_receiver_plane_depth_bias(highp vec3 pos_dx,highp vec3 pos_dy)
{highp vec2 biasUV=vec2(
pos_dy.y*pos_dx.z-pos_dx.y*pos_dy.z,pos_dx.x*pos_dy.z-pos_dy.x*pos_dx.z);biasUV*=1.0/((pos_dx.x*pos_dy.y)-(pos_dx.y*pos_dy.x));return biasUV;}float shadowed_light_factor_plane_bias(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {highp vec3 light_view_pos0_xyz=light_view_pos0.xyz/light_view_pos0.w*0.5+0.5;highp vec3 light_view_pos0_ddx=dFdx(light_view_pos0_xyz);highp vec3 light_view_pos0_ddy=dFdy(light_view_pos0_xyz);highp vec2 plane_depth_bias=compute_receiver_plane_depth_bias(light_view_pos0_ddx,light_view_pos0_ddy);highp float bias=dot(vec2(u_shadow_texel_size,u_shadow_texel_size),plane_depth_bias)+0.0001;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return 1.0-(u_shadow_intensity*occlusion);}float shadowed_light_factor(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return 1.0-(u_shadow_intensity*occlusion);}float shadow_occlusion(float ndotl,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=calculate_shadow_bias(ndotl);return shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);}
#endif`;const Ud=[];Fa(xf,Ud),Fa(m_,Ud),Fa(p_,Ud);const jd={"_prelude_fog.vertex.glsl":g_,"_prelude_terrain.vertex.glsl":$d,"_prelude_shadow.vertex.glsl":zt,"_prelude_fog.fragment.glsl":jp,"_prelude_shadow.fragment.glsl":__,"_prelude_lighting.glsl":`
#ifdef LIGHTING_3D_MODE
uniform mediump vec3 u_lighting_ambient_color;uniform mediump vec3 u_lighting_directional_dir;uniform mediump vec3 u_lighting_directional_color;uniform mediump vec3 u_ground_radiance;float calculate_ambient_directional_factor(vec3 normal) {float NdotL=dot(normal,u_lighting_directional_dir);const float factor_reduction_max=0.3;float dir_luminance=dot(u_lighting_directional_color,vec3(0.2126,0.7152,0.0722));float directional_factor_min=1.0-factor_reduction_max*min(dir_luminance,1.0);float ambient_directional_factor=mix(directional_factor_min,1.0,min((NdotL+1.0),1.0));const float vertical_factor_min=0.92;float vertical_factor=mix(vertical_factor_min,1.0,normal.z*0.5+0.5);return vertical_factor*ambient_directional_factor;}vec3 linearProduct(vec3 srgbIn,vec3 k) {return srgbIn*pow(k,vec3(1./2.2));}vec3 apply_lighting(vec3 color,vec3 normal,float dir_factor) {float ambient_directional_factor=calculate_ambient_directional_factor(normal);vec3 ambient_contrib=ambient_directional_factor*u_lighting_ambient_color;vec3 directional_contrib=u_lighting_directional_color*dir_factor;return linearProduct(color,ambient_contrib+directional_contrib);}vec4 apply_lighting(vec4 color,vec3 normal,float dir_factor) {return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting(vec3 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return apply_lighting(color.rgb,normal,dir_factor);}vec4 apply_lighting(vec4 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting_ground(vec3 color) {return color*u_ground_radiance;}vec4 apply_lighting_ground(vec4 color) {return vec4(apply_lighting_ground(color.rgb),color.a);}float calculate_NdotL(vec3 normal) {const float ext=0.70710678118;return (clamp(dot(normal,u_lighting_directional_dir),-ext,1.0)+ext)/(1.0+ext);}vec4 apply_lighting_with_emission_ground(vec4 color,float emissive_strength) {return mix(apply_lighting_ground(color),color,emissive_strength);}vec3 compute_flood_lighting(vec3 flood_light_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=flood_light_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);float occlusion_ramp=smoothstep(0.0,0.2,1.0-occlusion);return mix(fully_occluded_color,flood_light_color,occlusion_ramp);}vec3 compute_emissive_draped(vec3 unlit_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=unlit_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);return mix(fully_occluded_color,unlit_color,1.0-occlusion);}
#endif//LIGHTING_3D_MODE`,"_prelude_raster_array.glsl":ga,"_prelude_raster_particle.glsl":Gp},wf={};mr("",$d),mr(jp,g_),mr(__,zt),mr(ga,""),mr(Gp,"");const Tf=mr(p_,m_),Tl=xf;var Hp={background:mr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec4 u_color;uniform float u_opacity;
#ifdef LIGHTING_3D_MODE
in vec4 v_color;
#endif
void main() {vec4 out_color;
#ifdef LIGHTING_3D_MODE
out_color=v_color;
#else
out_color=u_color;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_lighting.glsl"
in vec2 a_pos;uniform mat4 u_matrix;
#ifdef LIGHTING_3D_MODE
uniform mediump vec4 u_color;out vec4 v_color;uniform float u_emissive_strength;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef LIGHTING_3D_MODE
v_color=apply_lighting_with_emission_ground(u_color,u_emissive_strength);
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),backgroundPattern:mr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform float u_emissive_strength;uniform sampler2D u_image;in highp vec2 v_pos;void main() {highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=textureLodCustom(u_image,pos,v_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec2 u_pattern_units_to_pixels;in vec2 a_pos;out highp vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_pattern_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),building:mr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
const float window_depth=0.5;const float ao_radius=0.2;in vec4 v_color;in highp vec3 v_normal;in highp vec3 v_pos;
#ifdef BUILDING_FAUX_FACADE
in lowp float v_faux_facade;in highp float v_faux_facade_ed;in highp vec2 v_faux_facade_window;in highp vec2 v_faux_facade_floor;in highp vec2 v_faux_facade_range;in highp float v_aspect;in highp vec3 v_tbn_0;in highp vec3 v_tbn_1;in highp vec3 v_tbn_2;in highp vec4 v_faux_color_emissive;uniform float u_faux_facade_ao_intensity;
#endif
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in float v_depth_shadows;
#endif
uniform lowp float u_opacity;uniform vec3 u_camera_pos;uniform highp float u_tile_to_meter;uniform float u_facade_emissive_chance;vec3 linearTosRGB(in vec3 color) {return pow(color,vec3(1./2.2));}
#ifdef BUILDING_FAUX_FACADE
float hash12(in vec2 p) {vec3 p3 =fract(vec3(p.xyx)*0.1031);p3+=dot(p3,p3.yzx+33.33);return fract((p3.x+p3.y)*p3.z);}float min3(in vec3 v) {return min(min(v.x,v.y),v.z);}vec2 get_uv_mask_id(in vec2 q,out float mask,out vec2 id) {vec2 p=q;mask=step(v_faux_facade_range.x,p.y)*step(p.y,v_faux_facade_range.y);p.y=p.y-v_faux_facade_range.x;vec2 uv=modf(p/v_faux_facade_floor,id);vec4 d=(v_faux_facade_floor.xyxy+vec4(-v_faux_facade_window,v_faux_facade_window))*0.5;vec4 edge=d/v_faux_facade_floor.xyxy;vec2 m=step(edge.xy,uv)*step(uv,edge.zw);mask*=m.x*m.y;uv-=vec2(0.5);uv*=vec2(0.5)/(vec2(0.5)-edge.xy);uv+=vec2(0.5);return uv;}float ray_unit_box(in vec3 ray_o,in vec3 ray_d,in vec3 bmin,in vec3 bmax) {vec3 planes=mix(bmin,bmax,step(0.0,ray_d));vec3 t=(planes-ray_o)/ray_d;return min3(t);}float get_emissive(in vec2 id) {if (u_facade_emissive_chance > 0.0) {return (step(hash12(id),u_facade_emissive_chance)+0.05)*v_faux_color_emissive.a;}return 0.0;}vec3 get_shade_info(in vec3 v,in vec3 v_normalized,in vec3 color,in vec2 id,in mat3 tbn,inout vec3 out_normal,inout float out_emissive) {vec3 out_color=color;vec3 abs_v=abs(v_normalized);bool x_major=abs_v.x >=abs_v.y && abs_v.x >=abs_v.z;bool y_major=abs_v.y >=abs_v.x && abs_v.y >=abs_v.z;bool z_major=abs_v.z >=abs_v.x && abs_v.z >=abs_v.y;
#if 0
if (x_major) {out_color=v.x > 0.0 ? vec3(1.0,0.0,0.0) : vec3(0.0,1.0,1.0);} else if (y_major) {out_color=v.y > 0.0 ? vec3(0.0,1.0,0.0) : vec3(1.0,0.0,1.0);} else if (z_major) {out_color=v.z > 0.0 ? vec3(0.0,0.0,1.0) : vec3(1.0,1.0,0.0);}out_emissive=1.0;
#else
if (x_major) {out_normal=sign(v.x)*tbn[0];} else if (y_major) {out_normal=vec3(0.0,0.0,-sign(v.y));} else if (z_major) {out_color=v_faux_color_emissive.rgb;out_emissive=v.z <=0.0 ? get_emissive(id) : out_emissive;}float ao=1.0;if (u_faux_facade_ao_intensity > 0.0) {vec4 ao_range=v_faux_facade_window.xxyy*0.5-vec4(0,ao_radius,0,ao_radius);vec2 ao_range_z=vec2(window_depth*0.5)-vec2(0.0,ao_radius);if (x_major || y_major) {ao*=smoothstep(-ao_range_z.x,-ao_range_z.y,v.z);} else if (z_major) {ao*=smoothstep(-ao_range.x,-ao_range.y,v.x)*(1.0-smoothstep(ao_range.y,ao_range.x,v.x));ao*=smoothstep(-ao_range.z,-ao_range.w,v.y)*(1.0-smoothstep(ao_range.w,ao_range.z,v.y));}ao=mix(1.0,min(1.0,ao+0.25),u_faux_facade_ao_intensity);}out_color*=ao;
#endif
return out_color;}
#endif
vec3 apply_lighting_linear(in vec3 color,in vec3 normal,in float dir_factor) {float ambient_directional_factor=calculate_ambient_directional_factor(normal);vec3 ambient_contrib=ambient_directional_factor*u_lighting_ambient_color;vec3 directional_contrib=u_lighting_directional_color*dir_factor;return color*(ambient_contrib+directional_contrib);}void main() {vec3 normal=normalize(v_normal);vec3 base_color=v_color.rgb;float emissive=v_color.a;
#ifdef BUILDING_FAUX_FACADE
if (v_faux_facade > 0.0) {mat3 tbn=mat3(v_tbn_0,v_tbn_1,v_tbn_2);vec3 v=vec3(v_pos.xy,v_pos.z/u_tile_to_meter)-u_camera_pos;vec3 view_tangent=transpose(tbn)*v;vec2 q=vec2(v_faux_facade_ed,v_pos.z);float mask=0.0;vec2 id=vec2(0.0);vec2 uv=get_uv_mask_id(q,mask,id);uv*=v_faux_facade_window;vec3 bmin=vec3(0.0,0.0,-window_depth);vec3 bmax=bmin+vec3(v_faux_facade_window,window_depth);vec3 ray_o=vec3(uv,0.0);vec3 ray_d=normalize(view_tangent);float t_min=ray_unit_box(ray_o,ray_d,bmin,bmax);vec3 hit=ray_o+t_min*ray_d;vec3 r=vec3(v_faux_facade_window,-window_depth);hit-=r*0.5;vec3 normalized=hit/r;vec3 out_normal=normal;float out_emissive=emissive;vec3 room_color=get_shade_info(hit,normalized,base_color,id,tbn,out_normal,out_emissive);base_color=mix(base_color,room_color,mask);normal=mix(normal,out_normal,mask);emissive=mix(emissive,out_emissive,mask);}
#endif
vec4 color=vec4(base_color,1.0);vec3 xy_flipped_normal=vec3(-normal.xy,normal.z);float shadowed_lighting_factor=0.0;
#ifdef RENDER_SHADOWS
shadowed_lighting_factor=shadowed_light_factor_normal(xy_flipped_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
shadowed_lighting_factor=dot(normal,u_lighting_directional_dir);
#endif
color.rgb=apply_lighting_linear(color.rgb,xy_flipped_normal,shadowed_lighting_factor);color.rgb=mix(color.rgb,base_color.rgb,emissive);
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos,v_pos.z));
#endif
color.rgb=linearTosRGB(color.rgb);color*=u_opacity;
#ifdef INDICATOR_CUTOUT
color=applyCutout(color,v_pos.z);
#endif
glFragColor=color; 
#ifdef DEBUG_SHOW_NORMALS
color.rgb=xy_flipped_normal*0.5+vec3(0.5,0.5,0.5);color.a=1.0;glFragColor=color;
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec3 a_pos_3f;in vec3 a_normal_3;in vec3 a_centroid_3;in vec4 a_faux_facade_data;in vec2 a_faux_facade_vertical_range;uniform mat4 u_matrix;uniform mat4 u_normal_matrix;uniform highp float u_tile_to_meter;out vec4 v_color;out vec3 v_normal;out highp vec3 v_pos;
#ifdef BUILDING_FAUX_FACADE
out lowp float v_faux_facade;out highp float v_faux_facade_ed;out highp vec2 v_faux_facade_window;out highp vec2 v_faux_facade_floor;out highp vec2 v_faux_facade_range;out highp float v_aspect;out highp vec3 v_tbn_0;out highp vec3 v_tbn_1;out highp vec3 v_tbn_2;out highp vec4 v_faux_color_emissive;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out float v_depth_shadows;
#endif
const float MAX_UINT_16=65535.0;const float MAX_INT_16=32767.0;const float MAX_UINT_8=255.0;const float TWO_POW_8=256.0;vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}
#ifdef BUILDING_FAUX_FACADE
mat3 get_tbn(in vec3 normal) {const vec3 bitangent=vec3(0.0,0.0,1.0);vec3 tangent=normalize(vec3(normal.y,-normal.x,0.0));return mat3(tangent,bitangent,normal);}
#endif
#pragma mapbox: define-attribute-vertex-shader-only highp vec2 part_color_emissive
#pragma mapbox: define-attribute-vertex-shader-only highp vec2 faux_facade_color_emissive
void main() {
#pragma mapbox: initialize-attribute-custom highp vec2 part_color_emissive
#pragma mapbox: initialize-attribute-custom highp vec2 faux_facade_color_emissive
vec4 color_emissive=decode_color(part_color_emissive);v_color=vec4(sRGBToLinear(color_emissive.rgb),color_emissive.a);vec3 a_normal_3f=a_normal_3/MAX_INT_16;v_normal=vec3(u_normal_matrix*vec4(a_normal_3f,0.0));float hidden=0.0;
#ifdef BUILDING_FAUX_FACADE
v_faux_facade=a_faux_facade_data.x;if (v_faux_facade > 0.0) {v_faux_facade_ed=a_faux_facade_data.x *u_tile_to_meter;float window_x_perc=floor(a_faux_facade_data.y/TWO_POW_8);float window_y_perc=a_faux_facade_data.y-TWO_POW_8*window_x_perc;vec2 window_perc=vec2(window_x_perc,window_y_perc)/MAX_UINT_8;v_faux_facade_floor=(a_faux_facade_data.zw/MAX_UINT_16*EXTENT)*u_tile_to_meter;v_faux_facade_window=window_perc*v_faux_facade_floor;v_faux_facade_range=(a_faux_facade_vertical_range/MAX_UINT_16*EXTENT)*u_tile_to_meter;v_aspect=v_faux_facade_window.x/v_faux_facade_window.y;mat3 tbn=get_tbn(normalize(v_normal));v_tbn_0=tbn[0];v_tbn_1=tbn[1];v_tbn_2=tbn[2];v_faux_color_emissive=decode_color(faux_facade_color_emissive);v_faux_color_emissive.rgb=sRGBToLinear(v_faux_color_emissive.rgb);}
#endif
v_pos=a_pos_3f;
#ifdef RENDER_CUTOFF
vec4 ground=u_matrix*vec4(a_centroid_3,1.0);v_cutoff_opacity=cutoff_opacity(u_cutoff_params,ground.z);hidden=float(v_cutoff_opacity==0.0);v_pos.z*=v_cutoff_opacity;
#endif
#ifdef RENDER_SHADOWS
vec3 shadow_pos=v_pos;
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset_model(v_normal);shadow_pos+=offset*shadow_normal_offset_multiplier0();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shadow_pos,1.0);v_pos_light_view_1=u_light_matrix_1*vec4(shadow_pos,1.0);v_depth_shadows=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(v_pos);
#endif
gl_Position=mix(u_matrix*vec4(v_pos,1),AWAY,hidden);}`),buildingBloom:mr(`in vec4 v_color_emissive;
#pragma mapbox: define-attribute highp vec4 bloom_attenuation
#pragma mapbox: initialize-attribute highp vec4 bloom_attenuation
float saturate(float val) {return clamp(val,0.0,1.0);}void main() {float emission=v_color_emissive.a;float opacity=1.0;
#ifdef HAS_ATTRIBUTE_a_bloom_attenuation
float distance=length(vec2(1.3*max(0.0,abs(bloom_attenuation.x)-bloom_attenuation.z),bloom_attenuation.y));distance+= mix(0.5,0.0,clamp(emission-1.0,0.0,1.0));opacity*=saturate(1.0-distance*distance);
#endif
glFragColor=vec4(v_color_emissive.rgb,1.0)*opacity;}`,`in vec3 a_pos_3f;
#pragma mapbox: define-attribute-vertex-shader-only highp vec2 part_color_emissive
#pragma mapbox: define-attribute highp vec4 bloom_attenuation
out vec4 v_color_emissive;uniform mat4 u_matrix;vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}void main() {
#pragma mapbox: initialize-attribute-custom highp vec2 part_color_emissive
#pragma mapbox: initialize-attribute highp vec4 bloom_attenuation
#ifdef HAS_ATTRIBUTE_a_part_color_emissive
vec4 color_emissive=decode_color(part_color_emissive);float part_emissive=color_emissive.a*5.0;v_color_emissive=vec4(sRGBToLinear(color_emissive.rgb),part_emissive);
#else
v_color_emissive=vec4(1.0);
#endif
gl_Position=u_matrix*vec4(a_pos_3f,1.0);}`),buildingDepth:mr(`in highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
glFragColor=pack_depth(v_depth);
#endif
}`,"in vec3 a_pos_3f;uniform mat4 u_matrix;out highp float v_depth;void main() {gl_Position=u_matrix*vec4(a_pos_3f,1.0);v_depth=gl_Position.z/gl_Position.w;}"),circle:mr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
in vec3 v_data;in float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
uniform float u_emissive_strength;void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float blur_positive=blur < 0.0 ? 0.0 : 1.0;lowp float antialiasblur=v_data.z;float extrude_length=length(extrude)+antialiasblur*(1.0-blur_positive);float antialiased_blur=-max(abs(blur),antialiasblur);float antialiase_blur_opacity=smoothstep(0.0,antialiasblur,extrude_length-1.0);float opacity_t=blur_positive==1.0 ? 
smoothstep(0.0,-antialiased_blur,1.0-extrude_length) : 
smoothstep(antialiased_blur,0.0,extrude_length-1.0)-antialiase_blur_opacity;float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(
antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)
);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_apply_premultiplied(out_color,v_fog_pos);
#endif
glFragColor=out_color*(v_visibility*opacity_t);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define NUM_VISIBILITY_RINGS 2
#define INV_SQRT2 0.70710678
#define ELEVATION_BIAS 0.0001
#define NUM_SAMPLES_PER_RING 16
uniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
#ifdef ELEVATED_ROADS
in float a_circle_z_offset;
#endif
out vec3 v_data;out float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
vec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {
#if defined(TERRAIN)
return elevation(pos)+ELEVATION_BIAS;
#else
return 0.0;
#endif
}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);
#ifdef PITCH_WITH_MAP
#ifdef PROJECTION_GLOBE_VIEW
return u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );
#else
return u_matrix*( world_center+vec4(sample_offset,0,0) );
#endif
#else
return projected_center+vec4(sample_offset,0,0);
#endif
}float get_sample_step() {
#ifdef PITCH_WITH_MAP
return 2.0*PI/float(NUM_SAMPLES_PER_RING);
#else
return PI/float(NUM_SAMPLES_PER_RING);
#endif
}void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);
#else 
surface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);
#endif
#ifdef ELEVATED_ROADS
world_center.z+=a_circle_z_offset+ELEVATION_BIAS;
#endif
vec4 projected_center=u_matrix*world_center;float view_scale=0.0;
#ifdef PITCH_WITH_MAP
#ifdef SCALE_WITH_MAP
view_scale=1.0;
#else
view_scale=projected_center.w/u_camera_to_center_distance;
#endif
#else
#ifdef SCALE_WITH_MAP
view_scale=u_camera_to_center_distance;
#else
view_scale=projected_center.w;
#endif
#endif
gl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;
#ifdef TERRAIN
float step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;
#ifdef PITCH_WITH_MAP
float cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;
#else
occlusion_world_center=world_center;occlusion_projected_center=projected_center;
#endif
for(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);
#else
visibility=1.0;
#endif
#ifdef PROJECTION_GLOBE_VIEW
visibility=1.0;
#endif
v_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);
#ifdef FOG
v_fog_pos=fog_position(world_center.xyz);
#endif
}`),clippingMask:mr("void main() {glFragColor=vec4(1.0);}","in vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:mr(`#include "_prelude_fog.fragment.glsl"
uniform highp float u_intensity;in vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);glFragColor=vec4(val,1.0,1.0,1.0);
#ifdef FOG
if (u_is_globe==0) {glFragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
out vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#else
pos=vec3(tilePos+extrude,elevation(tilePos));
#endif
gl_Position=u_matrix*vec4(pos,1);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),heatmapTexture:mr(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));glFragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(0.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,"in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:mr("in float v_placed;in float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);glFragColor =mix(red,blue,step(0.5,v_placed))*0.5;glFragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}",`#include "_prelude_terrain.vertex.glsl"
in vec3 a_pos;in vec2 a_anchor_pos;in vec2 a_extrude;in vec2 a_placed;in vec2 a_shift;in vec2 a_elevation_from_sea;in float a_size_scale;in vec2 a_padding;in float a_auto_z_offset;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform float u_zoom_transition;
#endif
out float v_placed;out float v_notUsed;void main() {float feature_elevation=a_elevation_from_sea.x+a_auto_z_offset;float terrain_elevation=(a_elevation_from_sea.y==1.0 ? 0.0 : elevation(a_anchor_pos));vec3 proj_pos=a_pos+elevationVector(a_anchor_pos)*(feature_elevation+terrain_elevation);
#ifdef PROJECTION_GLOBE_VIEW
#ifndef PROJECTED_POS_ON_VIEWPORT
vec3 globe_pos=proj_pos;vec3 mercator_pos=mercator_tile_position(u_inv_rot_matrix,a_anchor_pos,u_tile_id,u_merc_center);proj_pos=mix_globe_mercator(globe_pos,mercator_pos,u_zoom_transition);
#endif
#endif
vec4 projectedPoint=u_matrix*vec4(proj_pos,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}`),collisionCircle:mr("in float v_radius;in vec2 v_extrude;in float v_perspective_ratio;in float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);glFragColor=color*alpha*opacity_t;}",`in vec2 a_pos_2f;in float a_radius;in vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;out float v_radius;out vec2 v_extrude;out float v_perspective_ratio;out float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(
mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}`),debug:mr("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);glFragColor=mix(u_color,overlay_color,overlay_color.a);}",`#include "_prelude_terrain.vertex.glsl"
in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;
#endif
out vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
gl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);
#else
gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);
#endif
}`),elevatedStructuresDepth:mr(`void main() {
#ifndef DEPTH_TEXTURE
glFragColor=vec4(0.);
#endif
}`,"in vec2 a_pos;in float a_height;uniform mat4 u_matrix;uniform float u_depth_bias;void main() {gl_Position=u_matrix*vec4(a_pos,a_height,1);gl_Position.z=gl_Position.z+u_depth_bias;}"),elevatedStructuresDepthReconstruct:mr(`#ifdef DEPTH_RECONSTRUCTION
in float v_height;
#endif
void main() {
#ifdef DEPTH_RECONSTRUCTION
if (v_height >=0.0)
discard;
#else
#ifdef FEATURE_CUTOUT
apply_feature_cutout(vec4(0.0,0.0,0.0,1.0),gl_FragCoord);
#endif
#endif
glFragColor=vec4(1.0,0.0,0.0,1.0);}`,`in vec2 a_pos;in float a_height;uniform mat4 u_matrix;uniform vec3 u_camera_pos;uniform highp float u_depth_bias;uniform lowp float u_height_scale;uniform lowp float u_reset_depth;
#ifdef DEPTH_RECONSTRUCTION
out float v_height;
#endif
void main() {vec3 vpos=vec3(a_pos,a_height*u_height_scale);
#ifdef DEPTH_RECONSTRUCTION
if (u_camera_pos.z > vpos.z) {vpos-=(u_camera_pos-vpos)*(vpos.z/(u_camera_pos.z-vpos.z));}v_height=a_height;
#endif
gl_Position=u_matrix*vec4(vpos,1);gl_Position.z=u_reset_depth==1.0 ? gl_Position.w : gl_Position.z+u_depth_bias;}`),elevatedStructures:mr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
in vec3 v_normal;in float v_height;
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in float v_depth;
#endif
vec3 linearTosRGB(vec3 color) {return pow(color,vec3(1./2.2));}vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}vec3 compute_view_dependent_emissive_color(float ndotl,float emissive_strength,vec3 color)
{color=sRGBToLinear(color);color=color*(ndotl+(1.0-min(ndotl*57.29,1.0))*emissive_strength);color=linearTosRGB(color.rgb);return color;}uniform float u_emissive_strength;
#pragma mapbox: define highp vec4 structure_color
void main() {
#pragma mapbox: initialize highp vec4 structure_color
vec3 color=structure_color.xyz;
#ifdef LIGHTING_3D_MODE
vec3 normal=normalize(v_normal);vec3 transformed_normal=vec3(-normal.xy,normal.z);float ndotl=calculate_NdotL(transformed_normal);float emissive_strength=u_emissive_strength;emissive_strength=0.0;vec3 emissive_color=compute_view_dependent_emissive_color(ndotl,emissive_strength,color.xyz);
#ifdef RENDER_SHADOWS
float shadowed_lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth);color.rgb=apply_lighting(color.rgb,transformed_normal,shadowed_lighting_factor);
#else
color=apply_lighting(color,transformed_normal);
#endif
color=mix(color,emissive_color,emissive_strength);if (v_height < 0.0) {float penetration=max(v_height+7.5,0.0);float occlusion=1.0-1.0/PI*acos(1.0-penetration/4.0);color=color*(1.0-pow(occlusion,2.0)*0.3);}
#endif
#ifdef FOG
color=fog_apply(color,v_fog_pos);
#endif
vec4 out_color=vec4(color,1.0);
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color,v_height);
#endif
#ifdef FEATURE_CUTOUT
out_color=apply_feature_cutout(out_color,gl_FragCoord);
#endif
glFragColor=out_color;HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec2 a_pos;in float a_height;in vec3 a_pos_normal_3;uniform mat4 u_matrix;out vec3 v_normal;out float v_height;
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out float v_depth;
#endif
#pragma mapbox: define highp vec4 structure_color
void main() {
#pragma mapbox: initialize highp vec4 structure_color
v_normal=a_pos_normal_3/16384.0;v_height=a_height;vec3 pos=vec3(a_pos,a_height);gl_Position=u_matrix*vec4(pos,1);
#ifdef RENDER_SHADOWS
vec3 shd_pos0=pos;vec3 shd_pos1=pos;
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(-v_normal.xy,v_normal.z));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fill:mr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
#ifdef ELEVATED_ROADS
in highp float v_road_z_offset;
#endif
#ifdef INDICATOR_CUTOUT
in highp float v_z_offset;
#endif
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
vec4 out_color=color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
out_color*=opacity;
#ifdef INDICATOR_CUTOUT
if (v_z_offset >=0.0) {out_color=applyCutout(out_color,v_z_offset);}
#endif
#ifdef FEATURE_CUTOUT
out_color=apply_feature_cutout(out_color,gl_FragCoord);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;out highp float v_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
#ifdef INDICATOR_CUTOUT
out highp float v_z_offset;
#endif
uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp float z_offset
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;v_road_z_offset=z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#ifdef INDICATOR_CUTOUT
v_z_offset=z_offset;
#endif
}`),fillOutline:mr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
in highp vec2 v_pos;uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
#ifdef FEATURE_CUTOUT
out_color=apply_feature_cutout(out_color,gl_FragCoord);
#endif
glFragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
uniform mat4 u_matrix;uniform vec2 u_world;out highp vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp float z_offset
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);
#ifdef FLIP_Y
v_pos=(vec2(gl_Position.x,-gl_Position.y)/gl_Position.w+1.0)/2.0*u_world;
#else
v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#endif
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutlinePattern:mr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;
#ifdef FILL_PATTERN_TRANSITION
uniform float u_pattern_transition;
#endif
uniform float u_emissive_strength;
#ifdef APPLY_LUT_ON_GPU
uniform highp sampler3D u_lutTexture;
#endif
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
in highp vec2 v_pos;in highp vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef APPLY_LUT_ON_GPU
out_color=applyLUT(u_lutTexture,out_color);
#endif
#ifdef FILL_PATTERN_TRANSITION
vec2 pattern_b_tl=pattern_b.xy;vec2 pattern_b_br=pattern_b.zw;highp vec2 pos_b=mix(pattern_b_tl/u_texsize,pattern_b_br/u_texsize,imagecoord);vec4 color_b=textureLodCustom(u_image,pos_b,lod_pos);out_color=out_color*(1.0-u_pattern_transition)+color_b*u_pattern_transition;
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FEATURE_CUTOUT
out_color=apply_feature_cutout(out_color,gl_FragCoord);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
out highp vec2 v_pos;out highp vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
#pragma mapbox: define lowp float pixel_ratio
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
#pragma mapbox: initialize lowp float pixel_ratio
#pragma mapbox: initialize highp float z_offset
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);
#ifdef FLIP_Y
v_pos_world=(vec2(gl_Position.x,-gl_Position.y)/gl_Position.w+1.0)/2.0*u_world;
#else
v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#endif
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillPattern:mr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;
#ifdef FILL_PATTERN_TRANSITION
uniform float u_pattern_transition;
#endif
in highp vec2 v_pos;uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
#ifdef ELEVATED_ROADS
in highp float v_road_z_offset;
#endif
#ifdef APPLY_LUT_ON_GPU
uniform highp sampler3D u_lutTexture;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef APPLY_LUT_ON_GPU
out_color=applyLUT(u_lutTexture,out_color);
#endif
#ifdef FILL_PATTERN_TRANSITION
vec2 pattern_b_tl=pattern_b.xy;vec2 pattern_b_br=pattern_b.zw;highp vec2 pos_b=mix(pattern_b_tl/u_texsize,pattern_b_br/u_texsize,imagecoord);vec4 color_b=textureLodCustom(u_image,pos_b,lod_pos);out_color=out_color*(1.0-u_pattern_transition)+color_b*u_pattern_transition;
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);
#ifdef ELEVATED_ROADS
out_color.rgb*=mix(v_road_z_offset !=0.0 ? u_ground_shadow_factor : vec3(1.0),vec3(1.0),light);
#else
out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#endif
#ifdef FEATURE_CUTOUT
out_color=apply_feature_cutout(out_color,gl_FragCoord);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;out highp float v_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
out highp vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
#pragma mapbox: define lowp float pixel_ratio
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
#pragma mapbox: initialize highp float z_offset
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;v_road_z_offset=z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillExtrusion:mr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
in vec4 v_color;in vec4 v_flat;
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;
#endif
uniform lowp float u_opacity;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;in vec2 v_ao;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
in vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
in highp vec3 v_normal;
#endif
uniform vec3 u_flood_light_color;uniform highp float u_vertical_scale;uniform float u_flood_light_intensity;uniform vec3 u_ground_shadow_factor;
#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)
in float v_flood_radius;in float v_has_floodlight;
#endif
in float v_height;
#pragma mapbox: define highp float emissive_strength
void main() {
#pragma mapbox: initialize highp float emissive_strength
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
vec3 normal=normalize(v_normal);
#endif
float z;vec4 color=v_color;
#ifdef ZERO_ROOF_RADIUS
z=float(normal.z > 0.00001);
#ifdef LIGHTING_3D_MODE
normal=mix(normal,vec3(0.0,0.0,1.0),z);
#else
color=mix(v_color,v_roof_color,z);
#endif
#endif
float h=max(0.0,v_height);float ao_shade=1.0;
#ifdef FAUX_AO
float intensity=u_ao[0];float h_floors=h/(u_ao[1]*u_vertical_scale);float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);ao_shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;
#ifdef ZERO_ROOF_RADIUS
concave*=(1.0-z);
#endif
float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);ao_shade*=mix(1.0,x_shade*x_shade*x_shade,concave);
#ifdef LIGHTING_3D_MODE
#ifdef FLOOD_LIGHT
color.rgb*=mix(ao_shade,1.0,v_has_floodlight);
#else
color.rgb*=ao_shade;
#endif
#else
color.rgb*=ao_shade;
#endif
#endif
#ifdef LIGHTING_3D_MODE
float flood_radiance=0.0;
#ifdef FLOOD_LIGHT
flood_radiance=(1.0-min(h/v_flood_radius,1.0))*u_flood_light_intensity*v_has_floodlight;
#endif
#ifdef RENDER_SHADOWS
#ifdef FLOOD_LIGHT
float ndotl_unclamped=dot(normal,u_shadow_direction);float ndotl=max(0.0,ndotl_unclamped);float occlusion=ndotl_unclamped < 0.0 ? 1.0 : shadow_occlusion(ndotl,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);vec3 litColor=apply_lighting(color.rgb,normal,(1.0-u_shadow_intensity*occlusion)*ndotl);vec3 floodLitColor=compute_flood_lighting(u_flood_light_color*u_opacity,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=mix(litColor,floodLitColor,flood_radiance);
#else
float shadowed_lighting_factor;
#ifdef RENDER_CUTOFF
shadowed_lighting_factor=shadowed_light_factor_normal_opacity(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w,v_cutoff_opacity);if (v_cutoff_opacity==0.0) {discard;}
#else
shadowed_lighting_factor=shadowed_light_factor_normal(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);
#endif
color.rgb=apply_lighting(color.rgb,normal,shadowed_lighting_factor);
#endif
#else
color.rgb=apply_lighting(color.rgb,normal);
#ifdef FLOOD_LIGHT
color.rgb=mix(color.rgb,u_flood_light_color*u_opacity,flood_radiance);
#endif
#endif
color.rgb=mix(color.rgb,v_flat.rgb,emissive_strength);color*=u_opacity;
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos,h));
#endif
#ifdef INDICATOR_CUTOUT
color=applyCutout(color,h);
#endif
#ifdef FEATURE_CUTOUT
color=apply_feature_cutout(color,gl_FragCoord);
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#include "_prelude_lighting.glsl"
uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;uniform float u_width_scale;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef RENDER_WALL_MODE
in vec3 a_join_normal_inside;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
#ifdef TERRAIN
uniform int u_height_type;uniform int u_base_type;
#endif
uniform highp float u_vertical_scale;out vec4 v_color;out vec4 v_flat;
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
out vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
out highp vec3 v_normal;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;out vec2 v_ao;
#endif
#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)
out float v_flood_radius;out float v_has_floodlight;
#endif
out float v_height;vec3 linearTosRGB(vec3 color) {return pow(color,vec3(1./2.2));}vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
#pragma mapbox: define highp float flood_light_wall_radius
#pragma mapbox: define highp float line_width
#pragma mapbox: define highp float emissive_strength
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize highp float flood_light_wall_radius
#pragma mapbox: initialize highp float line_width
#pragma mapbox: initialize highp float emissive_strength
base*=u_vertical_scale;height*=u_vertical_scale;vec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
v_normal=normal;
#endif
base=max(0.0,base);float attr_height=height;height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=0.0;float c_ele=0.0;vec3 pos;
#ifdef TERRAIN
bool is_flat_height=centroid_pos.x !=0.0 && u_height_type==1;bool is_flat_base=centroid_pos.x !=0.0 && u_base_type==1;ele=elevation(pos_nx.xy);c_ele=is_flat_height || is_flat_base ? (centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos)) : ele;float h_height=is_flat_height ? max(c_ele+height,ele+base+2.0) : ele+height;float h_base=is_flat_base ? max(c_ele+base,ele+base) : ele+(base==0.0 ?-5.0 : base);h=t > 0.0 ? max(h_base,h_height) : h_base;pos=vec3(pos_nx.xy,h);
#else
h=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float cutoff=1.0;vec3 scaled_pos=pos;
#ifdef RENDER_CUTOFF
vec3 centroid_random=vec3(centroid_pos.xy,centroid_pos.x+centroid_pos.y+1.0);vec3 ground_pos=centroid_pos.x==0.0 ? pos.xyz : (centroid_random/8.0);vec4 ground=u_matrix*vec4(ground_pos.xy,ele,1.0);
#ifdef CLIP_ZERO_TO_ONE
cutoff=cutoff_opacity(u_cutoff_params,ground.z*2.0-ground.w);
#else
cutoff=cutoff_opacity(u_cutoff_params,ground.z);
#endif
if (centroid_pos.y !=0.0 && centroid_pos.x !=0.0) {vec3 g=floor(ground_pos);vec3 mod_=centroid_random-g*8.0;float seed=min(1.0,0.1*(min(3.5,max(mod_.x+mod_.y,0.2*attr_height))*0.35+mod_.z));if (cutoff < 0.8-seed) {cutoff=0.0;}}float cutoff_scale=cutoff;v_cutoff_opacity=cutoff;scaled_pos.z=mix(c_ele,h,cutoff_scale);
#endif
float hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (cutoff==0.0 && centroid_pos.x !=0.0) || (color.a==0.0));
#ifdef RENDER_WALL_MODE
vec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);scaled_pos.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;scaled_pos.xy-=a_join_normal_inside.z*wall_offset*0.5;
#endif
gl_Position=mix(u_matrix*vec4(scaled_pos,1),AWAY,hidden);h=h-ele;v_height=h;
#ifdef RENDER_SHADOWS
vec3 shd_pos0=pos;vec3 shd_pos1=pos;
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(normal);shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);
#endif
float NdotL=0.0;float colorvalue=0.0;
#ifndef LIGHTING_3D_MODE
colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);if (normal.y !=0.0) {float r=0.84;r=mix(0.7,0.98,1.0-u_lightintensity);NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#endif
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec2(mix(concave,-concave,start),y_ground);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
#ifdef FLOOD_LIGHT
float is_wall=1.0-float(t > 0.0 && top_up_ny.y > 0.0);v_has_floodlight=float(flood_light_wall_radius > 0.0 && is_wall > 0.0);v_flood_radius=flood_light_wall_radius*u_vertical_scale;
#endif
v_color=vec4(color.rgb,1.0);float ndotl=calculate_NdotL(normal);v_flat.rgb=sRGBToLinear(color.rgb);v_flat.rgb=v_flat.rgb*(ndotl+(1.0-min(ndotl*57.29,1.0))*emissive_strength);v_flat=vec4(linearTosRGB(v_flat.rgb),1.0);
#else
v_color=vec4(0.0,0.0,0.0,1.0);v_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_color*=u_opacity;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
float roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color=vec4(0.0,0.0,0.0,1.0);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_roof_color*=u_opacity;
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),fillExtrusionDepth:mr(`in highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
glFragColor=pack_depth(v_depth);
#endif
}`,`#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;uniform float u_edge_radius;uniform float u_width_scale;uniform float u_vertical_scale;
#ifdef TERRAIN
uniform int u_height_type;uniform int u_base_type;
#endif
in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef RENDER_WALL_MODE
in vec3 a_join_normal_inside;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp float line_width
#pragma mapbox: define highp vec4 color
out highp float v_depth;void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp float line_width
#pragma mapbox: initialize highp vec4 color
base*=u_vertical_scale;height*=u_vertical_scale;vec3 pos_nx=floor(a_pos_normal_ed.xyz*0.5);mediump vec3 top_up_ny=a_pos_normal_ed.xyz-2.0*pos_nx;base=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
vec3 pos;
#ifdef TERRAIN
bool is_flat_height=centroid_pos.x !=0.0 && u_height_type==1;bool is_flat_base=centroid_pos.x !=0.0 && u_base_type==1;float ele=elevation(pos_nx.xy);float c_ele=is_flat_height || is_flat_base ? (centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos)) : ele;float h_height=is_flat_height ? max(c_ele+height,ele+base+2.0) : ele+height;float h_base=is_flat_base ? max(c_ele+base,ele+base) : ele+(base==0.0 ?-5.0 : base);float h=t > 0.0 ? max(h_base,h_height) : h_base;pos=vec3(pos_nx.xy,h);
#else
pos=vec3(pos_nx.xy,t > 0.0 ? height : base);
#endif
#ifdef RENDER_WALL_MODE
vec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);pos.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;pos.xy-=a_join_normal_inside.z*wall_offset*0.5;
#endif
float hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (color.a==0.0));gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);v_depth=gl_Position.z/gl_Position.w;}`),fillExtrusionPattern:mr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;
#ifdef FILL_EXTRUSION_PATTERN_TRANSITION
uniform float u_pattern_transition;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;in vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
in vec3 v_normal;
#endif
#ifdef APPLY_LUT_ON_GPU
uniform highp sampler3D u_lutTexture;
#endif
in highp vec2 v_pos;in vec4 v_lighting;uniform lowp float u_opacity;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define mediump vec4 pattern
#ifdef FILL_EXTRUSION_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
#pragma mapbox: define highp float pixel_ratio
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize mediump vec4 pattern
#ifdef FILL_EXTRUSION_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
#pragma mapbox: initialize highp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef APPLY_LUT_ON_GPU
out_color=applyLUT(u_lutTexture,out_color);
#endif
#ifdef FILL_EXTRUSION_PATTERN_TRANSITION
vec2 pattern_b_tl=pattern_b.xy;vec2 pattern_b_br=pattern_b.zw;highp vec2 pos_b=mix(pattern_b_tl/u_texsize,pattern_b_br/u_texsize,imagecoord);vec4 color_b=textureLodCustom(u_image,pos_b,lod_pos);out_color=out_color*(1.0-u_pattern_transition)+color_b*u_pattern_transition;
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color,normalize(v_normal))*u_opacity;
#else
out_color=out_color*v_lighting;
#endif
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color,height);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#include "_prelude_lighting.glsl"
uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_width_scale;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef RENDER_WALL_MODE
in vec3 a_join_normal_inside;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
#ifdef TERRAIN
uniform int u_height_type;uniform int u_base_type;
#endif
out highp vec2 v_pos;out vec4 v_lighting;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;out vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
out vec3 v_normal;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump vec4 pattern
#ifdef FILL_EXTRUSION_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
#pragma mapbox: define highp float pixel_ratio
#pragma mapbox: define highp float line_width
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump vec4 pattern
#ifdef FILL_EXTRUSION_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
#pragma mapbox: initialize highp float pixel_ratio
#pragma mapbox: initialize highp float line_width
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=z;vec3 p;float c_ele;
#ifdef TERRAIN
bool is_flat_height=centroid_pos.x !=0.0 && u_height_type==1;bool is_flat_base=centroid_pos.x !=0.0 && u_base_type==1;ele=elevation(pos_nx.xy);c_ele=is_flat_height || is_flat_base ? (centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos)) : ele;float h_height=is_flat_height ? max(c_ele+height,ele+base+2.0) : ele+height;float h_base=is_flat_base ? max(c_ele+base,ele+base) : ele+(base==0.0 ?-5.0 : base);h=t > 0.0 ? max(h_base,h_height) : h_base;p=vec3(pos_nx.xy,h);
#else
p=vec3(pos_nx.xy,z);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
#ifdef RENDER_WALL_MODE
vec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);p.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;p.xy-=a_join_normal_inside.z*wall_offset*0.5;
#endif
float hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (color.a==0.0));gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0
? pos_nx.xy
: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;
#ifdef LIGHTING_3D_MODE
NdotL=calculate_NdotL(normal);
#else
NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);
#endif
if (normal.y !=0.0) {float r=0.84;
#ifndef LIGHTING_3D_MODE
r=mix(0.7,0.98,1.0-u_lightintensity);
#endif
NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
v_normal=normal;
#else
v_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;
#endif
#ifdef FOG
v_fog_pos=fog_position(p);
#endif
}`),groundShadow:mr(`#include "_prelude_shadow.fragment.glsl"
precision highp float;uniform vec3 u_ground_shadow_factor;in vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;
#ifdef FOG
in float v_fog_opacity;
#endif
void main() {float light=shadowed_light_factor_plane_bias(v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);vec3 shadow=mix(u_ground_shadow_factor,vec3(1.0),light);
#ifdef RENDER_CUTOFF
shadow=mix(vec3(1.0),shadow,cutoff_opacity(u_cutoff_params,1.0/gl_FragCoord.w));
#endif
#ifdef FOG
shadow=mix(shadow,vec3(1.0),v_fog_opacity);
#endif
#ifdef INDICATOR_CUTOUT
shadow=mix(shadow,vec3(1.0),1.0-applyCutout(vec4(1.0),0.0).r);
#endif
glFragColor=vec4(shadow,1.0);}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;in vec2 a_pos;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;
#ifdef FOG
out float v_fog_opacity;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0.0,1.0);v_pos_light_view_0=u_light_matrix_0*vec4(a_pos,0.0,1.0);v_pos_light_view_1=u_light_matrix_1*vec4(a_pos,0.0,1.0);
#ifdef FOG
v_fog_pos=fog_position(a_pos);v_fog_opacity=fog(v_fog_pos);
#endif
}`),fillExtrusionGroundEffect:mr(`uniform highp float u_ao_pass;uniform highp float u_opacity;uniform highp float u_flood_light_intensity;uniform highp vec3 u_flood_light_color;uniform highp float u_attenuation;uniform sampler2D u_fb;uniform float u_fb_size;
#ifdef SDF_SUBPASS
in highp vec2 v_pos;in highp vec4 v_line_segment;in highp float v_flood_light_radius_tile;in highp vec2 v_ao;float line_df(highp vec2 a,highp vec2 b,highp vec2 p) {highp vec2 ba=b-a;highp vec2 pa=p-a;highp float r=clamp(dot(pa,ba)/dot(ba,ba),0.0,1.0);return length(pa-r*ba);}
#ifdef FOG
in highp float v_fog;
#endif
#endif
void main() {
#ifdef CLEAR_SUBPASS
vec4 color=vec4(1.0);
#ifdef CLEAR_FROM_TEXTURE
color=texture(u_fb,gl_FragCoord.xy/vec2(u_fb_size));
#endif
glFragColor=color;
#else
#ifdef SDF_SUBPASS
highp float d=line_df(v_line_segment.xy,v_line_segment.zw,v_pos);highp float effect_radius=mix(v_flood_light_radius_tile,v_ao.y,u_ao_pass);d/=effect_radius;d=min(d,1.0);d=1.0-pow(1.0-d,u_attenuation);highp float effect_intensity=mix(u_flood_light_intensity,v_ao.x,u_ao_pass);highp float fog=1.0;
#ifdef FOG
fog=v_fog;
#endif
#ifdef RENDER_CUTOFF
fog*=v_cutoff_opacity;
#endif
glFragColor=vec4(vec3(0.0),mix(1.0,d,effect_intensity*u_opacity*fog));
#else
vec4 color=mix(vec4(u_flood_light_color,1.0),vec4(vec3(0.0),1.0),u_ao_pass);
#ifdef OVERDRAW_INSPECTOR
color=vec4(1.0);
#endif
glFragColor=color;
#endif
HANDLE_WIREFRAME_DEBUG;
#endif
}`,`#include "_prelude_fog.vertex.glsl"
in highp vec4 a_pos_end;in highp float a_angular_offset_factor;in highp float a_hidden_by_landmark;
#ifdef SDF_SUBPASS
out highp vec2 v_pos;out highp vec4 v_line_segment;out highp float v_flood_light_radius_tile;out highp vec2 v_ao;
#ifdef FOG
out highp float v_fog;
#endif
#endif
uniform highp float u_flood_light_intensity;uniform highp mat4 u_matrix;uniform highp float u_ao_pass;uniform highp float u_meter_to_tile;uniform highp float u_edge_radius;uniform highp float u_dynamic_offset;uniform highp vec2 u_ao;
#pragma mapbox: define highp float flood_light_ground_radius
const float TANGENT_CUTOFF=4.0;const float NORM=32767.0;void main() {
#pragma mapbox: initialize highp float flood_light_ground_radius
vec2 p=a_pos_end.xy;vec2 q=floor(a_pos_end.zw*0.5);vec2 start_bottom=a_pos_end.zw-q*2.0;float fl_ground_radius=flood_light_ground_radius;fl_ground_radius=abs(flood_light_ground_radius);float direction=flood_light_ground_radius < 0.0 ?-1.0 : 1.0;float flood_radius_tile=fl_ground_radius*u_meter_to_tile;vec2 v=normalize(q-p);float ao_radius=u_ao.y/3.5;float effect_radius=mix(flood_radius_tile,ao_radius,u_ao_pass)+u_edge_radius;float angular_offset_factor=a_angular_offset_factor/NORM*TANGENT_CUTOFF;float angular_offset=direction*angular_offset_factor*effect_radius;float top=1.0-start_bottom.y;float side=(0.5-start_bottom.x)*2.0;vec2 extrusion_parallel=v*side*mix(u_dynamic_offset,angular_offset,top);vec2 perp=vec2(v.y,-v.x);vec2 extrusion_perp=direction*perp*effect_radius*top;vec3 pos=vec3(mix(q,p,start_bottom.x),0.0);pos.xy+=extrusion_parallel+extrusion_perp;
#ifdef SDF_SUBPASS
v_pos=pos.xy;v_line_segment=vec4(p,q)+perp.xyxy*u_edge_radius;v_flood_light_radius_tile=flood_radius_tile;v_ao=vec2(u_ao.x,ao_radius);
#ifdef FOG
v_fog_pos=fog_position(pos);v_fog=1.0-fog(v_fog_pos);
#endif
#endif
float hidden_by_landmark=0.0;
#ifdef HAS_CENTROID
hidden_by_landmark=a_hidden_by_landmark;
#endif
float isFloodlit=float(fl_ground_radius > 0.0 && u_flood_light_intensity > 0.0);float hidden=mix(1.0-isFloodlit,isFloodlit,u_ao_pass);hidden+=hidden_by_landmark;gl_Position=mix(u_matrix*vec4(pos,1.0),AWAY,float(hidden > 0.0));
#ifdef RENDER_CUTOFF
v_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);
#endif
}`),hillshadePrepare:mr(`precision highp float;uniform highp sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;float getElevation(vec2 coord) {return texture(u_image,coord).r/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(
(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)
)/pow(2.0,exaggeration+(19.2562-u_zoom));glFragColor=clamp(vec4(
deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:mr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;uniform float u_emissive_strength;void main() {vec4 pixel=texture(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);glFragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef LIGHTING_3D_MODE
glFragColor=apply_lighting_with_emission_ground(glFragColor,u_emissive_strength);
#endif
#ifdef FOG
glFragColor=fog_dither(fog_apply_premultiplied(glFragColor,v_fog_pos));
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),line:mr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform lowp float u_device_pixel_ratio;uniform highp float u_width_scale;uniform highp float u_floor_width_scale;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;uniform highp vec2 u_trim_fade_range;uniform lowp vec4 u_trim_color;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec3 v_uv;
#ifdef ELEVATED_ROADS
in highp float v_road_z_offset;
#endif
#ifdef RENDER_LINE_DASH
uniform sampler2D u_dash_image;in vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform sampler2D u_gradient_image;
#endif
#ifdef INDICATOR_CUTOUT
in highp float v_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
float luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}uniform float u_emissive_strength;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float border_width
#pragma mapbox: define lowp vec4 border_color
float linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float border_width
#pragma mapbox: initialize lowp vec4 border_color
float dist=length(v_normal)*v_width2.s;float blur2=(u_width_scale*blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);
#ifdef RENDER_LINE_DASH
float sdfdist=texture(u_dash_image,v_tex).r;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;float scaled_floorwidth=(floorwidth*u_floor_width_scale);alpha*=linearstep(0.5-sdfgamma/scaled_floorwidth,0.5+sdfgamma/scaled_floorwidth,sdfdist);
#endif
highp vec4 out_color;
#ifdef RENDER_LINE_GRADIENT
out_color=texture(u_gradient_image,v_uv.xy);
#else
out_color=color;
#endif
float trim_alpha=1.0;
#ifdef RENDER_LINE_TRIM_OFFSET
highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=v_uv[2];if (trim_end > trim_start) {highp float start_transition=max(0.0,min(1.0,(line_progress-trim_start)/max(u_trim_fade_range[0],1.0e-9)));highp float end_transition=max(0.0,min(1.0,(trim_end-line_progress)/max(u_trim_fade_range[1],1.0e-9)));highp float transition_factor=min(start_transition,end_transition);out_color=mix(out_color,u_trim_color,transition_factor);trim_alpha=1.0-transition_factor;}
#endif
if (u_alpha_discard_threshold !=0.0) {if (alpha < u_alpha_discard_threshold) {discard;}}
#ifdef RENDER_LINE_BORDER
float edgeBlur=((border_width*u_width_scale)+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);if (border_color.a==0.0) {float Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}} else {out_color=mix(border_color*trim_alpha,out_color,smoothAlpha);}}
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);
#ifdef ELEVATED_ROADS
out_color.rgb*=mix(v_road_z_offset !=0.0 ? u_ground_shadow_factor : vec3(1.0),vec3(1.0),light);
#else
out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
out_color*=(alpha*opacity);
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color,v_z_offset);
#endif
#ifdef FEATURE_CUTOUT
out_color=apply_feature_cutout(out_color,gl_FragCoord);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define EXTRUDE_SCALE 0.015873016
in vec2 a_pos_normal;in vec4 a_data;
#if defined(ELEVATED) || defined(ELEVATED_ROADS) || defined(VARIABLE_LINE_WIDTH)
in vec3 a_z_offset_width;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
in highp vec3 a_packed;
#endif
#ifdef RENDER_LINE_DASH
in float a_linesofar;
#endif
uniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;uniform float u_width_scale;uniform highp float u_floor_width_scale;
#ifdef ELEVATED
uniform lowp float u_zbias_factor;uniform lowp float u_tile_to_meter;float sample_elevation(vec2 apos) {
#ifdef ELEVATION_REFERENCE_SEA
return 0.0;
#else
return elevation(apos);
#endif
}
#endif
out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec3 v_uv;
#ifdef ELEVATED_ROADS
out highp float v_road_z_offset;
#endif
#ifdef RENDER_LINE_DASH
uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;out vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform float u_image_height;
#endif
#ifdef INDICATOR_CUTOUT
out highp float v_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float border_width
#pragma mapbox: define lowp vec4 border_color
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float border_width
#pragma mapbox: initialize lowp vec4 border_color
float a_z_offset;
#if defined(ELEVATED) || defined(ELEVATED_ROADS)
a_z_offset=a_z_offset_width.x;
#endif
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth;
#ifdef VARIABLE_LINE_WIDTH
float left=a_pos_normal.y-2.0*floor(a_pos_normal.y*0.5);halfwidth=(u_width_scale*(left==1.0 ? a_z_offset_width.y : a_z_offset_width.z))/2.0;
#else
halfwidth=(u_width_scale*width)/2.0;
#endif
offset=-1.0*offset*u_width_scale;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);float hidden=float(opacity==0.0);vec2 extrude=dist*u_pixels_to_tile_units;vec4 projected_extrude=u_matrix*vec4(extrude,0.0,0.0);vec2 projected_extrude_xy=projected_extrude.xy;
#ifdef ELEVATED_ROADS
v_road_z_offset=a_z_offset;gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,a_z_offset,1.0)+projected_extrude;
#else
#ifdef ELEVATED
vec2 offsetTile=offset2*u_pixels_to_tile_units;vec2 offset_pos=pos+offsetTile;float ele=0.0;
#ifdef CROSS_SLOPE_VERTICAL
float top=a_pos_normal.y-2.0*floor(a_pos_normal.y*0.5);float line_height=2.0*u_tile_to_meter*outset*top*u_pixels_to_tile_units[1][1]+a_z_offset;ele=sample_elevation(offset_pos)+line_height;projected_extrude=vec4(0);
#else
#ifdef CROSS_SLOPE_HORIZONTAL
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,max(ele1,ele2));ele=ele_max+a_z_offset;
#else
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,0.5*(ele1+ele2));ele=ele_max-ele0+ele1+a_z_offset;
#endif
#endif
gl_Position=u_matrix*vec4(offset_pos,ele,1.0)+projected_extrude;float z=clamp(gl_Position.z/gl_Position.w,0.5,1.0);float zbias=max(0.00005,(pow(z,0.8)-z)*u_zbias_factor*u_exaggeration);gl_Position.z-=(gl_Position.w*zbias);gl_Position=mix(gl_Position,AWAY,hidden);
#else
gl_Position=mix(u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude,AWAY,hidden);
#endif
#endif
#ifdef ELEVATED_ROADS
#ifdef RENDER_SHADOWS
vec3 shd_pos=vec3(pos+(offset2+dist)*u_pixels_to_tile_units,a_z_offset);vec3 shd_pos0=shd_pos;vec3 shd_pos1=shd_pos;
#ifdef NORMAL_OFFSET
vec3 shd_pos_offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=shd_pos_offset*shadow_normal_offset_multiplier0();shd_pos1+=shd_pos_offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#endif
#ifndef RENDER_TO_TEXTURE
float epsilon=0.0001;float extrude_length_without_perspective=max(length(dist),epsilon);float extrude_length_with_perspective=max(length(projected_extrude_xy/gl_Position.w*u_units_to_pixels),epsilon);v_gamma_scale=mix(extrude_length_without_perspective/extrude_length_with_perspective,1.0,step(0.01,blur));
#else
v_gamma_scale=1.0;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
highp float a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float line_progress=a_packed[2];
#ifdef RENDER_LINE_GRADIENT
highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec3(a_uv_x,a_split_index*texel_height-half_texel_height,line_progress);
#else
v_uv=vec3(a_uv_x,0.0,line_progress);
#endif
#endif
#ifdef RENDER_LINE_DASH
float scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/(floorwidth*u_floor_width_scale),(-normal.y*height+dash.x+0.5)/u_texsize.y);
#endif
v_width2=vec2(outset,inset);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
#ifdef INDICATOR_CUTOUT
v_z_offset=a_z_offset;
#endif
}`),linePattern:mr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform highp float u_device_pixel_ratio;uniform highp float u_width_scale;uniform highp float u_alpha_discard_threshold;uniform highp vec2 u_texsize;uniform highp float u_tile_units_to_pixels;uniform highp vec2 u_trim_offset;uniform highp vec2 u_trim_fade_range;uniform lowp vec4 u_trim_color;uniform sampler2D u_image;
#ifdef APPLY_LUT_ON_GPU
uniform highp sampler3D u_lutTexture;
#endif
#ifdef LINE_PATTERN_TRANSITION
uniform float u_pattern_transition;
#endif
in vec2 v_normal;in vec2 v_width2;in highp float v_linesofar;in float v_gamma_scale;in float v_width;
#ifdef RENDER_LINE_TRIM_OFFSET
in highp vec3 v_uv;
#endif
#ifdef ELEVATED_ROADS
in highp float v_road_z_offset;
#endif
#ifdef LINE_JOIN_NONE
in vec2 v_pattern_data;
#endif
#ifdef INDICATOR_CUTOUT
in highp float v_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
uniform float u_emissive_strength;
#pragma mapbox: define mediump vec4 pattern
#ifdef LINE_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
#pragma mapbox: define mediump float pixel_ratio
#pragma mapbox: define mediump float blur
#pragma mapbox: define mediump float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern
#ifdef LINE_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
#pragma mapbox: initialize mediump float pixel_ratio
#pragma mapbox: initialize mediump float blur
#pragma mapbox: initialize mediump float opacity
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;highp float pattern_size=display_size.x/u_tile_units_to_pixels;float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(u_width_scale*blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);highp float pattern_x=v_linesofar/pattern_size*aspect;highp float x=mod(pattern_x,1.0);highp float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;highp vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));highp vec2 lod_pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(pattern_x,y));vec4 color=textureLodCustom(u_image,pos,lod_pos);
#ifdef APPLY_LUT_ON_GPU
color=applyLUT(u_lutTexture,color);
#endif
#ifdef LINE_PATTERN_TRANSITION
vec2 pattern_b_tl=pattern_b.xy;vec2 pattern_b_br=pattern_b.zw;highp vec2 pos_b=mix(pattern_b_tl*texel_size-texel_size,pattern_b_br*texel_size+texel_size,vec2(x,y));vec4 color_b=textureLodCustom(u_image,pos_b,lod_pos);color=color*(1.0-u_pattern_transition)+color_b*u_pattern_transition;
#endif
#ifdef RENDER_LINE_TRIM_OFFSET
highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=v_uv[2];if (trim_end > trim_start) {highp float start_transition=max(0.0,min(1.0,(line_progress-trim_start)/max(u_trim_fade_range[0],1.0e-9)));highp float end_transition=max(0.0,min(1.0,(trim_end-line_progress)/max(u_trim_fade_range[1],1.0e-9)));highp float transition_factor=min(start_transition,end_transition);color=mix(color,color.a*u_trim_color,transition_factor);}
#endif
#ifdef LINE_JOIN_NONE
highp float pattern_len=pattern_size/aspect;highp float segment_phase=pattern_len-mod(v_linesofar-v_pattern_data.x+pattern_len,pattern_len);highp float visible_start=segment_phase-step(pattern_len*0.5,segment_phase)*pattern_len;highp float visible_end=floor((v_pattern_data.y-segment_phase)/pattern_len)*pattern_len+segment_phase;visible_end+=step(pattern_len*0.5,v_pattern_data.y-visible_end)*pattern_len;if (v_pattern_data.x < visible_start || v_pattern_data.x >=visible_end) {color=vec4(0.0);}
#endif
#ifdef LIGHTING_3D_MODE
color=apply_lighting_with_emission_ground(color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);
#ifdef ELEVATED_ROADS
color.rgb*=mix(v_road_z_offset !=0.0 ? u_ground_shadow_factor : vec3(1.0),vec3(1.0),light);
#else
color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
color*=(alpha*opacity);if (u_alpha_discard_threshold !=0.0) {if (color.a < u_alpha_discard_threshold) {discard;}}
#ifdef INDICATOR_CUTOUT
color=applyCutout(color,v_z_offset);
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;
#if defined(ELEVATED) || defined(ELEVATED_ROADS)
in vec3 a_z_offset_width;
#endif
#ifdef RENDER_LINE_TRIM_OFFSET
in highp vec3 a_packed;
#endif
in highp float a_linesofar;
#ifdef LINE_JOIN_NONE
in highp vec3 a_pattern_data;out vec2 v_pattern_data;
#endif
#ifdef INDICATOR_CUTOUT
out highp float v_z_offset;
#endif
uniform mat4 u_matrix;uniform float u_tile_units_to_pixels;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform float u_device_pixel_ratio;uniform float u_width_scale;uniform float u_floor_width_scale;
#ifdef ELEVATED
uniform lowp float u_zbias_factor;uniform lowp float u_tile_to_meter;float sample_elevation(vec2 apos) {
#ifdef ELEVATION_REFERENCE_SEA
return 0.0;
#else
return elevation(apos);
#endif
}
#endif
out vec2 v_normal;out vec2 v_width2;out highp float v_linesofar;out float v_gamma_scale;out float v_width;
#ifdef RENDER_LINE_TRIM_OFFSET
out highp vec3 v_uv;
#endif
#ifdef ELEVATED_ROADS
out highp float v_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
#pragma mapbox: define mediump float blur
#pragma mapbox: define mediump float opacity
#pragma mapbox: define mediump float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define mediump float floorwidth
#pragma mapbox: define mediump vec4 pattern
#ifdef LINE_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
#pragma mapbox: define mediump float pixel_ratio
void main() {
#pragma mapbox: initialize mediump float blur
#pragma mapbox: initialize mediump float opacity
#pragma mapbox: initialize mediump float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize mediump float floorwidth
#pragma mapbox: initialize mediump vec4 pattern
#ifdef LINE_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
#pragma mapbox: initialize mediump float pixel_ratio
float a_z_offset;
#if defined(ELEVATED) || defined(ELEVATED_ROADS)
a_z_offset=a_z_offset_width.x;
#endif
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=(u_width_scale*width)/2.0;offset=-1.0*offset*u_width_scale;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);vec2 dist=outset*a_extrude*scale;float u=0.5*a_direction;float t=1.0-abs(u);vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float hidden=float(opacity==0.0);vec2 extrude=dist*u_pixels_to_tile_units;vec4 projected_extrude=u_matrix*vec4(extrude,0.0,0.0);vec2 projected_extrude_xy=projected_extrude.xy;
#ifdef ELEVATED_ROADS
v_road_z_offset=a_z_offset;gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,a_z_offset,1.0)+projected_extrude;
#else
#ifdef ELEVATED
vec2 offsetTile=offset2*u_pixels_to_tile_units;vec2 offset_pos=pos+offsetTile;float ele=0.0;
#ifdef CROSS_SLOPE_VERTICAL
float top=a_pos_normal.y-2.0*floor(a_pos_normal.y*0.5);float line_height=2.0*u_tile_to_meter*outset*top*u_pixels_to_tile_units[1][1]+a_z_offset;ele=sample_elevation(offset_pos)+line_height;projected_extrude=vec4(0);
#else
#ifdef CROSS_SLOPE_HORIZONTAL
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,max(ele1,ele2));ele=ele_max+a_z_offset;
#else
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,0.5*(ele1+ele2));ele=ele_max-ele0+ele1+a_z_offset;
#endif
#endif
gl_Position=u_matrix*vec4(offset_pos,ele,1.0)+projected_extrude;float z=clamp(gl_Position.z/gl_Position.w,0.5,1.0);float zbias=max(0.00005,(pow(z,0.8)-z)*u_zbias_factor*u_exaggeration);gl_Position.z-=(gl_Position.w*zbias);gl_Position=mix(gl_Position,AWAY,hidden);
#else
gl_Position=mix(u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude,AWAY,hidden);
#endif
#endif
#ifdef ELEVATED_ROADS
#ifdef RENDER_SHADOWS
vec3 shd_pos=vec3(pos+(offset2+dist)*u_pixels_to_tile_units,a_z_offset);vec3 shd_pos0=shd_pos;vec3 shd_pos1=shd_pos;
#ifdef NORMAL_OFFSET
vec3 shd_pos_offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=shd_pos_offset*shadow_normal_offset_multiplier0();shd_pos1+=shd_pos_offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#endif
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude_xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=mix(extrude_length_without_perspective/extrude_length_with_perspective,1.0,step(0.01,blur));
#else
v_gamma_scale=1.0;
#endif
#ifdef RENDER_LINE_TRIM_OFFSET
highp float a_uv_x=a_packed[0];highp float line_progress=a_packed[2];v_uv=vec3(a_uv_x,0.0,line_progress);
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=(floorwidth*u_floor_width_scale);
#ifdef LINE_JOIN_NONE
v_width=(floorwidth*u_floor_width_scale)+ANTIALIASING;mediump float pixels_to_tile_units=1.0/u_tile_units_to_pixels;mediump float pixel_ratio_inverse=1.0/pixel_ratio;mediump float aspect=v_width/((pattern.w-pattern.y)*pixel_ratio_inverse);highp float subt_multiple=(pattern.z-pattern.x)*pixel_ratio_inverse*pixels_to_tile_units*aspect*32.0;highp float subt=floor(a_pattern_data.z/subt_multiple)*subt_multiple;float offset_sign=(fract(a_pattern_data.x)-0.5)*4.0;float line_progress_offset=offset_sign*v_width*0.5*pixels_to_tile_units;v_linesofar=(a_pattern_data.z-subt)+a_linesofar+line_progress_offset;v_pattern_data=vec2(a_pattern_data.x+line_progress_offset,a_pattern_data.y);
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
#ifdef INDICATOR_CUTOUT
v_z_offset=a_z_offset;
#endif
}`),raster:mr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_raster_array.glsl"
uniform float u_fade_t;uniform float u_opacity;uniform highp float u_raster_elevation;uniform highp float u_zoom_transition;in vec2 v_pos0;in vec2 v_pos1;in float v_depth;
#ifdef PROJECTION_GLOBE_VIEW
in float v_split_fade;
#endif
uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;uniform float u_emissive_strength;
#ifndef RASTER_ARRAY
uniform highp sampler2D u_image0;uniform sampler2D u_image1;
#endif
#ifdef RASTER_COLOR
uniform sampler2D u_color_ramp;uniform highp vec4 u_colorization_mix;uniform highp float u_colorization_offset;uniform vec2 u_texture_res;
#endif
void main() {vec4 color0,color1,color;vec2 value;
#ifdef RASTER_COLOR
#ifdef RASTER_ARRAY
#ifdef RASTER_ARRAY_LINEAR
value=mix(
raTexture2D_image0_linear(v_pos0,u_texture_res,u_colorization_mix,u_colorization_offset),raTexture2D_image1_linear(v_pos1,u_texture_res,u_colorization_mix,u_colorization_offset),u_fade_t
);
#else
value=mix(
raTexture2D_image0_nearest(v_pos0,u_texture_res,u_colorization_mix,u_colorization_offset),raTexture2D_image1_nearest(v_pos1,u_texture_res,u_colorization_mix,u_colorization_offset),u_fade_t
);
#endif
if (value.y > 0.0) value.x/=value.y;
#else
color=mix(texture(u_image0,v_pos0),texture(u_image1,v_pos1),u_fade_t);value=vec2(u_colorization_offset+dot(color.rgb,u_colorization_mix.rgb),color.a);
#endif
color=texture(u_color_ramp,vec2(value.x,0.5));if (color.a > 0.0) color.rgb/=color.a;color.a*=value.y;
#else
color0=texture(u_image0,v_pos0);color1=texture(u_image1,v_pos1);if (color0.a > 0.0) color0.rgb/=color0.a;if (color1.a > 0.0) color1.rgb/=color1.a;color=mix(color0,color1,u_fade_t);
#endif
color.a*=u_opacity;
#ifdef GLOBE_POLES
color.a*=1.0-smoothstep(0.0,0.05,u_zoom_transition);
#endif
vec3 rgb=color.rgb;rgb=vec3(
dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(vec4(out_color,1.0),u_emissive_strength).rgb;
#endif
#ifdef FOG
highp float fog_limit_high_meters=1000000.0;highp float fog_limit_low_meters=600000.0;float fog_limit=1.0-smoothstep(fog_limit_low_meters,fog_limit_high_meters,u_raster_elevation);out_color=fog_dither(fog_apply(out_color,v_fog_pos,fog_limit));
#endif
glFragColor=vec4(out_color*color.a,color.a);
#ifdef PROJECTION_GLOBE_VIEW
glFragColor*=mix(1.0,1.0-smoothstep(0.0,0.05,u_zoom_transition),smoothstep(0.8,0.9,v_split_fade));
#endif
#ifdef RENDER_CUTOFF
glFragColor=glFragColor*cutoff_opacity(u_cutoff_params,v_depth);
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform mat3 u_grid_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;uniform vec2 u_texture_offset;uniform float u_raster_elevation;uniform float u_zoom_transition;uniform vec2 u_merc_center;
#define GLOBE_UPSCALE GLOBE_RADIUS/6371008.8
#ifdef GLOBE_POLES
in vec3 a_globe_pos;in vec2 a_uv;
#else
in vec2 a_pos;in vec2 a_texture_pos;
#endif
out vec2 v_pos0;out vec2 v_pos1;out float v_depth;
#ifdef PROJECTION_GLOBE_VIEW
out float v_split_fade;
#endif
void main() {vec2 uv;
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;gl_Position=u_matrix*u_globe_matrix*vec4(globe_pos   ,1.0);uv=a_uv;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(a_globe_pos,1.0)).xyz);
#endif
#else
float w=1.0+dot(a_texture_pos,u_perspective_transform);uv=a_texture_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);vec3 globe_pos=latLngToECEF(latLng.xy);globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);float mercatorY=mercatorYfromLat(latLng[0]);float mercatorX=mercatorXfromLng(latLng[1]);    
v_split_fade=0.0;if (u_zoom_transition > 0.0) {vec2 merc_pos=vec2(mercatorX,mercatorY);merc_world_pos=vec4(merc_pos,u_raster_elevation,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;float opposite_merc_center=mod(u_merc_center.x+0.5,1.0);float dist_from_poles=(abs(mercatorY-0.5)*2.0);float range=0.1;v_split_fade=abs(opposite_merc_center-mercatorX);v_split_fade=clamp(1.0-v_split_fade,0.0,1.0);v_split_fade=max(smoothstep(1.0-range,1.0,dist_from_poles),max(smoothstep(1.0-range,1.0,v_split_fade),smoothstep(1.0-range,1.0,1.0-v_split_fade)));}float tiles=u_grid_matrix[0][2];if (tiles > 0.0) {float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];float uvY=mercatorY*tiles-idy;float uvX=mercatorX*tiles-idx;uv=vec2(uvX,uvY);}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition)*w,w);gl_Position=u_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
#else
gl_Position=u_matrix*vec4(a_pos*w,u_raster_elevation*w,w);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#endif
#endif
v_pos0=uv;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;v_pos0=u_texture_offset.x+u_texture_offset.y*v_pos0;v_pos1=u_texture_offset.x+u_texture_offset.y*v_pos1;
#ifdef RENDER_CUTOFF
v_depth=gl_Position.z;
#endif
}`),rasterParticle:mr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform float u_fade_t;uniform float u_opacity;uniform highp float u_raster_elevation;in vec2 v_pos0;in vec2 v_pos1;uniform sampler2D u_image0;uniform sampler2D u_image1;void main() {vec4 color0,color1,color;color0=texture(u_image0,v_pos0);color1=texture(u_image1,v_pos1);if (color0.a > 0.0) color0.rgb/=color0.a;if (color1.a > 0.0) color1.rgb/=color1.a;color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 out_color=color.rgb;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(vec4(out_color,1.0),0.0).rgb;
#endif
#ifdef FOG
highp float fog_limit_high_meters=1000000.0;highp float fog_limit_low_meters=600000.0;float fog_limit=1.0-smoothstep(fog_limit_low_meters,fog_limit_high_meters,u_raster_elevation);out_color=fog_dither(fog_apply(out_color,v_fog_pos,fog_limit));
#endif
glFragColor=vec4(out_color*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform mat3 u_grid_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_raster_elevation;uniform float u_zoom_transition;uniform vec2 u_merc_center;
#define GLOBE_UPSCALE GLOBE_RADIUS/6371008.8
in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {float w=1.0;vec2 uv;
#ifdef PROJECTION_GLOBE_VIEW
vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float mercatorX=mercatorXfromLng(latLng[1]);float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];float uvX=mercatorX*tiles-idx;float uvY=mercatorY*tiles-idy;uv=vec2(uvX,uvY);vec3 globe_pos=latLngToECEF(latLng.xy);globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {vec2 merc_pos=vec2(mercatorX,mercatorY);merc_world_pos=vec4(merc_pos,u_raster_elevation,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition)*w,w);gl_Position=u_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
#else
uv=a_texture_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*w,u_raster_elevation*w,w);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#endif
v_pos0=uv;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}`),rasterParticleDraw:mr("uniform sampler2D u_color_ramp;in float v_particle_speed;void main() {glFragColor=texture(u_color_ramp,vec2(v_particle_speed,0.5));}",`#include "_prelude_raster_particle.glsl"
in float a_index;uniform sampler2D u_particle_texture;uniform float u_particle_texture_side_len;uniform vec2 u_tile_offset;out float v_particle_speed;void main() {ivec2 pixel_coord=ivec2(
mod(a_index,u_particle_texture_side_len),a_index/u_particle_texture_side_len);vec4 pixel=texelFetch(u_particle_texture,pixel_coord,0);vec2 pos=unpack_pos_from_rgba(pixel)+u_tile_offset;vec2 tex_coord=fract(pos);vec2 velocity=lookup_velocity(tex_coord);if (velocity==INVALID_VELOCITY) {gl_Position=AWAY;v_particle_speed=0.0;} else {gl_Position=vec4(2.0*pos-1.0,0,1);v_particle_speed=length(velocity);}gl_PointSize=1.0;}`),rasterParticleTexture:mr("uniform sampler2D u_texture;uniform float u_opacity;in vec2 v_tex_pos;void main() {vec4 color=texture(u_texture,v_tex_pos);glFragColor=vec4(floor(255.0*color*u_opacity)/255.0);}","in vec2 a_pos;out vec2 v_tex_pos;void main() {vec2 uv=0.5*a_pos+vec2(0.5);v_tex_pos=uv;gl_Position=vec4(a_pos,0.0,1.0);}"),rasterParticleUpdate:mr(`#include "_prelude_raster_particle.glsl"
uniform sampler2D u_particle_texture;uniform mediump float u_particle_texture_side_len;uniform mediump float u_speed_factor;uniform highp float u_reset_rate;uniform highp float u_rand_seed;in highp vec2 v_tex_coord;vec2 linearstep(vec2 edge0,vec2 edge1,vec2 x) {return  clamp((x-edge0)/(edge1-edge0),vec2(0),vec2(1));}const highp vec3 rand_constants=vec3(12.9898,78.233,4375.85453);highp float rand(const highp vec2 co) {highp float t=dot(rand_constants.xy,co);return fract(sin(t)*(rand_constants.z+t));}void main() {ivec2 pixel_coord=ivec2(v_tex_coord*u_particle_texture_side_len);highp vec4 pixel=texelFetch(u_particle_texture,pixel_coord,0);highp vec2 pos=unpack_pos_from_rgba(pixel);highp vec2 velocity=lookup_velocity(clamp(pos,0.0,1.0));highp vec2 dp=velocity==INVALID_VELOCITY ? vec2(0) : velocity*u_speed_factor;pos=pos+dp;highp vec2 seed=(pos+v_tex_coord)*u_rand_seed;highp vec2 random_pos=vec2(rand(seed+1.3),rand(seed+2.1));highp vec2 persist_rate=pow(
linearstep(vec2(-u_particle_pos_offset),vec2(0),pos)*linearstep(vec2(1.0+u_particle_pos_offset),vec2(1),pos),vec2(4)
);highp vec2 per_frame_persist=pow(persist_rate,abs(dp)/u_particle_pos_offset);highp float drop_rate=1.0-per_frame_persist.x*per_frame_persist.y;drop_rate=any(greaterThanEqual(abs(pos-0.5),vec2(0.5+u_particle_pos_offset))) ? 1.0 : drop_rate;highp float drop=step(1.0-drop_rate-u_reset_rate,rand(seed));highp vec2 next_pos=mix(pos,random_pos,drop);glFragColor=pack_pos_to_rgba(next_pos);}`,"in vec2 a_pos;out vec2 v_tex_coord;void main() {v_tex_coord=0.5*(a_pos+vec2(1.0));gl_Position=vec4(a_pos,0.0,1.0);}"),symbol:mr(`#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;uniform bool u_is_halo;uniform lowp float u_scale_factor;
#ifdef ICON_TRANSITION
uniform float u_icon_transition;
#endif
#ifdef COLOR_ADJUSTMENT
uniform mat4 u_color_adj_mat;
#endif
#ifdef INDICATOR_CUTOUT
in highp float v_z_offset;
#else
#ifdef RENDER_SHADOWS
in highp float v_z_offset;
#endif
#endif
in vec2 v_tex_a;
#ifdef ICON_TRANSITION
in vec2 v_tex_b;
#endif
in float v_draw_halo;in vec3 v_gamma_scale_size_fade_opacity;
#ifdef RENDER_TEXT_AND_SYMBOL
in float is_sdf;in vec2 v_tex_a_icon;
#endif
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
#ifdef APPLY_LUT_ON_GPU
uniform highp sampler3D u_lutTexture;
#endif
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
vec4 out_color;float fade_opacity=v_gamma_scale_size_fade_opacity[2];
#ifdef RENDER_TEXT_AND_SYMBOL
if (is_sdf==ICON) {vec2 tex_icon=v_tex_a_icon;lowp float alpha=opacity*fade_opacity;glFragColor=texture(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
return;}
#endif
#ifdef RENDER_SDF
float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_gamma_scale_size_fade_opacity.x;float size=v_gamma_scale_size_fade_opacity.y;float fontScale=u_is_text ? size/24.0 : size;out_color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;bool draw_halo=v_draw_halo > 0.0;if (draw_halo) {out_color=halo_color;gamma=(halo_blur*u_scale_factor*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width*u_scale_factor/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,v_tex_a).r;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);out_color*=alpha;
#else
#ifdef ICON_TRANSITION
vec4 a=texture(u_texture,v_tex_a)*(1.0-u_icon_transition);vec4 b=texture(u_texture,v_tex_b)*u_icon_transition;out_color=(a+b);
#else
out_color=texture(u_texture,v_tex_a);
#endif
#ifdef APPLY_LUT_ON_GPU
out_color=applyLUT(u_lutTexture,out_color);
#endif
#ifdef COLOR_ADJUSTMENT
out_color=u_color_adj_mat*out_color;
#endif
#endif
out_color*=opacity*fade_opacity;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);
#ifdef TERRAIN
out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#else
out_color.rgb*=mix(v_z_offset !=0.0 ? u_ground_shadow_factor : vec3(1.0),vec3(1.0),light);
#endif
#endif
#endif
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color,v_z_offset);
#endif
#ifdef FEATURE_CUTOUT
out_color=apply_feature_cutout(out_color,gl_FragCoord);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec4 a_pos_offset;in vec4 a_tex_size;in vec4 a_pixeloffset;in vec4 a_projected_pos;in float a_fade_opacity;
#ifdef Z_OFFSET
in float a_auto_z_offset;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_globe_anchor;in vec3 a_globe_normal;
#endif
#ifdef ICON_TRANSITION
in vec2 a_texb;
#endif
#ifdef OCCLUSION_QUERIES
in float a_occlusion_query_opacity;
#endif
#ifdef ELEVATED_ROADS
in vec3 a_x_axis;in vec3 a_y_axis;uniform float u_normal_scale;
#endif
#ifdef INDICATOR_CUTOUT
out highp float v_z_offset;
#else
#ifdef RENDER_SHADOWS
out highp float v_z_offset;
#endif
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_elevation_from_sea;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;uniform bool u_is_halo;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
out vec2 v_tex_a;
#ifdef ICON_TRANSITION
out vec2 v_tex_b;
#endif
out float v_draw_halo;out vec3 v_gamma_scale_size_fade_opacity;
#ifdef RENDER_TEXT_AND_SYMBOL
out float is_sdf;out vec2 v_tex_a_icon;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
#pragma mapbox: define lowp float occlusion_opacity
#pragma mapbox: define lowp float z_offset
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
#pragma mapbox: initialize lowp float occlusion_opacity
#pragma mapbox: initialize lowp float z_offset
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;float e=u_elevation_from_sea ? z_offset : z_offset+elevation(tile_anchor);
#ifdef Z_OFFSET
e+=a_auto_z_offset;
#endif
vec3 h=elevationVector(tile_anchor)*e;float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;vec3 world_pos_globe;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos_globe=a_globe_anchor+h;world_pos=mix_globe_mercator(world_pos_globe,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;vec2 a;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);vec4 projected_point_globe=u_matrix*vec4(world_pos_globe,1);a=projected_point_globe.xy/projected_point_globe.w;
#else
offsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);a=projected_point.xy/projected_point.w;
#endif
vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
#ifdef PROJECTED_POS_ON_VIEWPORT
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xyz+h,1.0);
#else
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz,mercator_pos,u_zoom_transition)+h;projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);    
#endif
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
#ifdef Z_OFFSET
z+=u_pitch_with_map ? a_auto_z_offset+z_offset : 0.0;
#else
z+=u_pitch_with_map ? z_offset : 0.0;
#endif
float occlusion_fade=globe_occlusion_fade;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float out_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));
#ifdef DEPTH_OCCLUSION
float depth_occlusion=occlusionFadeMultiSample(projected_point);float depth_occlusion_multplier=mix(occlusion_opacity,1.0,depth_occlusion);out_fade_opacity*=depth_occlusion_multplier;
#endif
#ifdef OCCLUSION_QUERIES
float occludedFadeMultiplier=mix(occlusion_opacity,1.0,a_occlusion_query_opacity);out_fade_opacity*=occludedFadeMultiplier;
#endif
float alpha=opacity*out_fade_opacity;float hidden=float(alpha==0.0 || projected_point.w <=0.0 || occlusion_fade==0.0);vec3 pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);pos=projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y;
#else
#ifdef ELEVATED_ROADS
vec3 xAxis=vec3(a_x_axis.xy,a_x_axis.z*u_normal_scale);vec3 yAxis=vec3(a_y_axis.xy,a_y_axis.z*u_normal_scale);pos=projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y;
#else
pos=vec3(projected_pos.xy/projected_pos.w+offset,z);
#endif
#endif
gl_Position=mix(u_coord_matrix*vec4(pos,1.0),AWAY,hidden);float gamma_scale=gl_Position.w;v_draw_halo=(u_is_halo && float(gl_InstanceID)==0.0) ? 1.0 : 0.0;v_gamma_scale_size_fade_opacity=vec3(gamma_scale,size,out_fade_opacity);v_tex_a=a_tex/u_texsize;
#ifdef RENDER_TEXT_AND_SYMBOL
is_sdf=a_size[0]-2.0*a_size_min;v_tex_a_icon=a_tex/u_texsize_icon;
#endif
#ifdef ICON_TRANSITION
v_tex_b=a_texb/u_texsize;
#endif
#ifdef RENDER_SHADOWS
vec4 shd_pos=u_inv_matrix*vec4(pos,1.0);vec3 shd_pos0=shd_pos.xyz;vec3 shd_pos1=shd_pos.xyz;
#ifdef NORMAL_OFFSET
vec3 shd_pos_offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=shd_pos_offset*shadow_normal_offset_multiplier0();shd_pos1+=shd_pos_offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef INDICATOR_CUTOUT
v_z_offset=e;
#else
#ifdef RENDER_SHADOWS
v_z_offset=e;
#endif
#endif
}`),terrainRaster:mr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image0;in vec2 v_pos0;
#ifdef FOG
in float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
in vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;
#endif
uniform vec3 u_ground_shadow_factor;void main() {vec4 image_color=texture(u_image0,v_pos0);vec4 color;
#ifdef LIGHTING_3D_MODE
const vec3 normal=vec3(0.0,0.0,1.0);
#ifdef RENDER_SHADOWS
float cutoffOpacity=1.0;
#ifdef RENDER_CUTOFF
cutoffOpacity=cutoff_opacity(u_cutoff_params,1.0/gl_FragCoord.w);
#endif
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
vec3 unlit_base=image_color.rgb*(1.0-image_color.a);vec3 emissive_base=image_color.rgb*image_color.a;float ndotl=u_shadow_direction.z;float occlusion=ndotl < 0.0 ? 1.0 : shadow_occlusion(v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w,0.0);ndotl=max(0.0,ndotl);vec3 lit=apply_lighting(unlit_base,normal,mix(1.0,(1.0-(u_shadow_intensity*occlusion))*ndotl,cutoffOpacity));vec3 emissive=compute_emissive_draped(emissive_base,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=lit+emissive;color.a=1.0;
#else
float lighting_factor=shadowed_light_factor_normal_unbiased(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);color=apply_lighting(image_color,normal,mix(1.0,lighting_factor,cutoffOpacity));
#endif
#else
float lighting_factor=u_lighting_directional_dir.z;color=apply_lighting(image_color,normal,lighting_factor);
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
color.rgb=mix(color.rgb,image_color.rgb,image_color.a);color.a=1.0;
#endif
#endif
#else
color=image_color;
#endif
#ifdef FOG
#ifdef ZERO_EXAGGERATION
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#else
color=fog_dither(fog_apply_from_vert(color,v_fog_opacity));
#endif
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;uniform float u_skirt_height;in vec2 a_pos;out vec2 v_pos0;
#ifdef FOG
out float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;
#endif
void main() {vec3 decomposedPosAndSkirt=decomposeToPosAndSkirt(a_pos);float skirt=decomposedPosAndSkirt.z;vec2 decodedPos=decomposedPosAndSkirt.xy;float elevation=elevation(decodedPos)-skirt*u_skirt_height;v_pos0=decodedPos/8192.0;gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);
#ifdef FOG
#ifdef ZERO_EXAGGERATION
v_fog_pos=fog_position(decodedPos);
#else
v_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));
#endif
#endif
#ifdef RENDER_SHADOWS
vec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);
#endif
}`),terrainDepth:mr("precision highp float;in float v_depth;void main() {glFragColor=pack_depth(v_depth);}",`#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;in vec2 a_pos;out float v_depth;void main() {float elevation=elevation(a_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}`),skybox:mr(`#include "_prelude_fog.fragment.glsl"
in lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(
cos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=texture(u_cubemap,uv).rgb;
#ifdef FOG
sky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);
#endif
sky_color+=0.1*sun_disk(v_uv,u_sun_direction);glFragColor=vec4(sky_color*u_opacity,u_opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,Vd),skyboxGradient:mr(`#include "_prelude_fog.fragment.glsl"
in highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture(u_color_ramp,vec2(progress,0.5));
#ifdef FOG
color.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;
#endif
color*=u_opacity;glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,Vd),skyboxCapture:mr(`
in highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;precision highp float;
#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)
#define BETA_M                  vec3(21e-6,21e-6,21e-6)
#define MIE_G                   0.76
#define DENSITY_HEIGHT_SCALE_R  8000.0
#define DENSITY_HEIGHT_SCALE_M  1200.0
#define PLANET_RADIUS           6360e3
#define ATMOSPHERE_RADIUS       6420e3
#define SAMPLE_STEPS            10
#define DENSITY_STEPS           4
float ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;glFragColor=vec4(color,1.0);}`,"in highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;out highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:mr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image0;uniform float u_far_z_cutoff;in vec2 v_pos0;
#ifndef FOG
uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;
#endif
void main() {vec4 color;
#ifdef CUSTOM_ANTIALIASING
highp vec2 uv=gl_FragCoord.xy/u_viewport;
#ifdef FLIP_Y
uv.y=1.0-uv.y;
#endif
highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;highp float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);highp float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture(u_image0,v_pos0);
#ifdef LIGHTING_3D_MODE
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
raster=apply_lighting_with_emission_ground(raster,raster.a);color=vec4(clamp(raster.rgb,vec3(0),vec3(1))*antialias,antialias);
#else
raster=apply_lighting_ground(raster);color=vec4(raster.rgb*antialias,raster.a*antialias);
#endif
#else
color=vec4(raster.rgb*antialias,raster.a*antialias);
#endif
#else
color=texture(u_image0,v_pos0);
#ifdef LIGHTING_3D_MODE
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
color=apply_lighting_with_emission_ground(color,color.a);color.a=1.0;
#else
color=apply_lighting_ground(color);
#endif
#endif
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
color*=1.0-step(u_far_z_cutoff,1.0/gl_FragCoord.w);glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;uniform float u_skirt_height;
#ifdef GLOBE_POLES
in vec3 a_globe_pos;in vec2 a_uv;
#else
in vec2 a_pos;
#endif
out vec2 v_pos0;void main() {
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;vec2 uv=a_uv;
#else
float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);
#endif
v_pos0=uv;vec2 tile_pos=uv*EXTENT;vec3 globe_derived_up_vector=normalize(globe_pos)*u_tile_up_scale;
#ifdef GLOBE_POLES
vec3 up_vector=globe_derived_up_vector;
#else
vec3 up_vector=elevationVector(tile_pos);
#endif
float height=elevation(tile_pos);globe_pos+=up_vector*height;
#ifndef GLOBE_POLES
globe_pos-=globe_derived_up_vector*u_skirt_height*decomposed_pos_and_skirt.z;
#endif
#ifdef GLOBE_POLES
vec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);
#else
vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height-u_skirt_height*decomposed_pos_and_skirt.z,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);
#endif
gl_Position=u_proj_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
}`),globeAtmosphere:mr(`#include "_prelude_fog.fragment.glsl"
uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec4 u_atmosphere_fog_color;uniform vec4 u_high_color;uniform vec4 u_space_color;uniform float u_horizon_angle;in highp vec3 v_ray_dir;in highp vec3 v_horizon_dir;void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;
#ifdef PROJECTION_GLOBE_VIEW
globe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {
#ifdef ALPHA_PASS
glFragColor=vec4(0,0,0,0);return;
#else
#ifdef NATIVE
glFragColor=vec4(1,1,1,1);
#else
glFragColor=vec4(0,0,0,1);
#endif
return;
#endif
}
#endif
highp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?
0.0 : max(acos(clamp(dot(dir,horizon_dir),-1.0,1.0)),0.0);float horizon_angle;
#ifdef PROJECTION_GLOBE_VIEW
highp vec3 closest_point=globe_pos_dot_dir*dir;highp float closest_point_to_center=length(closest_point-u_globe_pos);highp float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?
PI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);
#else
horizon_angle=horizon_angle_mercator;
#endif
horizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_atmosphere_fog_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_atmosphere_fog_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;
#ifdef ALPHA_PASS
float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);glFragColor=vec4(1.0,1.0,1.0,a);
#else
vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c=c2;glFragColor=vec4(c*t,t);
#endif
}`,`in vec3 a_pos;in vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;out highp vec3 v_ray_dir;out highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(
mix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}`),model:mr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform float u_opacity;uniform vec3 u_lightcolor;uniform vec3 u_lightpos;uniform float u_lightintensity;uniform vec4 u_baseColorFactor;uniform vec4 u_emissiveFactor;uniform float u_metallicFactor;uniform float u_roughnessFactor;uniform float u_emissive_strength;in highp vec4 v_position_height;in lowp vec4 v_color_mix;
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in float v_depth_shadows;
#endif
#ifdef OCCLUSION_TEXTURE_TRANSFORM
uniform vec4 u_occlusionTextureTransform;
#endif
#pragma mapbox: define-attribute highp vec3 normal_3f
#pragma mapbox: define-attribute highp vec3 color_3f
#pragma mapbox: define-attribute highp vec4 color_4f
#pragma mapbox: define-attribute highp vec2 uv_2f
#pragma mapbox: initialize-attribute highp vec3 normal_3f
#pragma mapbox: initialize-attribute highp vec3 color_3f
#pragma mapbox: initialize-attribute highp vec4 color_4f
#pragma mapbox: initialize-attribute highp vec2 uv_2f
#ifdef HAS_ATTRIBUTE_a_pbr
in lowp vec4 v_roughness_metallic_emissive_alpha;in mediump vec4 v_height_based_emission_params;
#endif
#ifdef HAS_TEXTURE_u_baseColorTexture
uniform sampler2D u_baseColorTexture;uniform bool u_baseTextureIsAlpha;uniform bool u_alphaMask;uniform float u_alphaCutoff;
#endif
#ifdef HAS_TEXTURE_u_metallicRoughnessTexture
uniform sampler2D u_metallicRoughnessTexture;
#endif
#ifdef HAS_TEXTURE_u_occlusionTexture
uniform sampler2D u_occlusionTexture;uniform float u_aoIntensity;
#endif
#ifdef HAS_TEXTURE_u_normalTexture
uniform sampler2D u_normalTexture;
#endif
#ifdef HAS_TEXTURE_u_emissionTexture
uniform sampler2D u_emissionTexture;
#endif
#ifdef APPLY_LUT_ON_GPU
uniform highp sampler3D u_lutTexture;
#endif
#ifdef TERRAIN_FRAGMENT_OCCLUSION
in highp float v_depth;uniform highp sampler2D u_depthTexture;uniform highp vec2 u_inv_depth_size;uniform highp vec2 u_depth_range_unpack;
#ifdef DEPTH_D24
highp float unpack_depth(highp float depth) {return  depth*u_depth_range_unpack.x+u_depth_range_unpack.y;}
#else
highp float unpack_depth_rgba(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}
#endif
bool isOccluded() {highp vec2 coord=gl_FragCoord.xy*u_inv_depth_size;
#ifdef DEPTH_D24
highp float depth=unpack_depth(texture(u_depthTexture,coord).r);
#else
highp float depth=unpack_depth_rgba(texture(u_depthTexture,coord));
#endif
return v_depth > depth+0.0005;}
#endif
#define saturate(_x) clamp(_x,0.,1.)
vec3 linearTosRGB(vec3 color) {return pow(color,vec3(1./2.2));}vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}float calculate_NdotL(vec3 normal,vec3 lightDir) {const float ext=0.70710678118;return (clamp(dot(normal,lightDir),-ext,1.0)+ext)/(1.0+ext);}vec3 getDiffuseShadedColor(vec3 albedo,vec3 normal,vec3 lightDir,vec3 lightColor)
{
#ifdef LIGHTING_3D_MODE
vec3 transformed_normal=vec3(-normal.xy,normal.z);float lighting_factor;
#ifdef RENDER_SHADOWS
lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
lighting_factor=saturate(dot(transformed_normal,u_lighting_directional_dir));
#endif
return apply_lighting(albedo,transformed_normal,lighting_factor);
#else
vec3 n=normal;float colorvalue=((albedo.x*0.2126)+(albedo.y*0.7152))+(albedo.z*0.0722);vec3 c=vec3(0.03,0.03,0.03);float directional=clamp(dot(n,vec3(lightDir)),0.0,1.0);directional=mix(1.0-u_lightintensity,max((1.0-colorvalue)+u_lightintensity,1.0),directional);vec3 c3=c+clamp((albedo*directional)*lightColor,mix(vec3(0.0),vec3(0.3),vec3(1.0)-lightColor),vec3(1.0));return c3;
#endif
}vec4 getBaseColor() {vec4 albedo=u_baseColorFactor;
#ifdef HAS_ATTRIBUTE_a_color_3f
albedo*=vec4(color_3f,1.0);
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
#else
#ifdef HAS_ATTRIBUTE_a_color_4f
albedo*=color_4f;
#endif
#endif
#if defined (HAS_TEXTURE_u_baseColorTexture) && defined (HAS_ATTRIBUTE_a_uv_2f)
vec4 texColor=texture(u_baseColorTexture,uv_2f);if(u_alphaMask) {if (texColor.w < u_alphaCutoff) {discard;}}
#ifdef UNPREMULT_TEXTURE_IN_SHADER
if(texColor.w > 0.0) {texColor.rgb/=texColor.w;}texColor.w=1.0;
#endif
if(u_baseTextureIsAlpha) {if (texColor.r < 0.5) {discard;}} else {texColor.rgb=sRGBToLinear(texColor.rgb);albedo*=texColor;}
#endif
vec4 color=vec4(mix(albedo.rgb,v_color_mix.rgb,v_color_mix.a),albedo.a);
#ifdef APPLY_LUT_ON_GPU
color=applyLUT(u_lutTexture,color);
#endif
return color;}highp mat3 cotangentFrame(highp vec3 N,highp vec3 p,highp vec2 uv ) {
#ifdef HAS_TEXTURE_u_normalTexture
highp vec3 dp1=vec3(dFdx(p.x),dFdx(p.y),dFdx(p.z));highp vec3 dp2=vec3(dFdy(p.x),dFdy(p.y),dFdy(p.z));highp vec2 duv1=vec2(dFdx(uv.x),dFdx(uv.y));highp vec2 duv2=vec2(dFdy(uv.x),dFdy(uv.y));highp vec3 dp2perp=cross( dp2,N );highp vec3 dp1perp=cross( N,dp1 );highp vec3 T=dp2perp*duv1.x+dp1perp*duv2.x;highp vec3 B=dp2perp*duv1.y+dp1perp*duv2.y;
#ifdef FLIP_Y
T=-T;B=-B;
#endif
highp float lengthT=dot(T,T);highp float lengthB=dot(B,B);highp float maxLength=max(lengthT,lengthB);highp float invmax=inversesqrt( maxLength );highp mat3 res=mat3( T*invmax,B*invmax,N );return res;
#else
return mat3(1.0);
#endif
}highp vec3 getNormal(){highp vec3 n;
#ifdef HAS_ATTRIBUTE_a_normal_3f
n=normalize(normal_3f);
#else
highp vec3 fdx=vec3(dFdx(v_position_height.x),dFdx(v_position_height.y),dFdx(v_position_height.z));highp vec3 fdy=vec3(dFdy(v_position_height.x),dFdy(v_position_height.y),dFdy(v_position_height.z));
#ifdef FLIP_Y
n=normalize(cross(fdx,fdy));
#else
n=normalize(cross(fdx,fdy))*-1.0;
#endif
#endif
#if defined(HAS_TEXTURE_u_normalTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
vec3 nMap=texture( u_normalTexture,uv_2f).xyz;nMap=normalize(2.0*nMap-vec3(1.0));highp vec3 v=normalize(-v_position_height.xyz);highp mat3 TBN=cotangentFrame(n,v,uv_2f);n=normalize(TBN*nMap);
#endif
return n;}struct Material {float perceptualRoughness;float alphaRoughness;float metallic;vec3 f90;vec4 baseColor;vec3 diffuseColor;vec3 specularColor;highp vec3 normal;};Material getPBRMaterial() {Material mat;mat.baseColor=getBaseColor();mat.perceptualRoughness=u_roughnessFactor;mat.metallic=u_metallicFactor;
#ifdef HAS_ATTRIBUTE_a_pbr
mat.perceptualRoughness=v_roughness_metallic_emissive_alpha.x;mat.metallic=v_roughness_metallic_emissive_alpha.y;mat.baseColor.w*=v_roughness_metallic_emissive_alpha.w;
#endif
#if defined(HAS_TEXTURE_u_metallicRoughnessTexture) && defined(HAS_ATTRIBUTE_a_uv_2f) 
vec4 mrSample=texture(u_metallicRoughnessTexture,uv_2f);mat.perceptualRoughness*=mrSample.g;mat.metallic*=mrSample.b;
#endif
const float c_minRoughness=0.04;mat.perceptualRoughness=clamp(mat.perceptualRoughness,c_minRoughness,1.0);mat.metallic=saturate(mat.metallic);mat.alphaRoughness=mat.perceptualRoughness*mat.perceptualRoughness;const vec3 f0=vec3(0.04);mat.diffuseColor=mat.baseColor.rgb*(vec3(1.0)-f0);mat.diffuseColor*=1.0-mat.metallic;mat.specularColor=mix(f0,mat.baseColor.rgb,mat.metallic);highp float reflectance=max(max(mat.specularColor.r,mat.specularColor.g),mat.specularColor.b);highp float reflectance90=saturate(reflectance*25.0);mat.f90=vec3(reflectance90);mat.normal=getNormal();return mat;}float V_GGX(float NdotL,float NdotV,float roughness)
{float a2=roughness*roughness;float GGXV=NdotL*sqrt(NdotV*NdotV*(1.0-a2)+a2);float GGXL=NdotV*sqrt(NdotL*NdotL*(1.0-a2)+a2);return 0.5/(GGXV+GGXL);}float V_GGXFast(float NdotL,float NdotV,float roughness) {float a=roughness;float GGXV=NdotL*(NdotV*(1.0-a)+a);float GGXL=NdotV*(NdotL*(1.0-a)+a);return 0.5/(GGXV+GGXL);}vec3 F_Schlick(vec3 specularColor,vec3 f90,float VdotH)
{return specularColor+(f90-specularColor)*pow(clamp(1.0-VdotH,0.0,1.0),5.0);}vec3 F_SchlickFast(vec3 specularColor,float VdotH)
{float x=1.0-VdotH;float x4=x*x*x*x;return specularColor+(1.0-specularColor)*x4*x;}float D_GGX(highp float NdotH,float alphaRoughness)
{highp float a4=alphaRoughness*alphaRoughness;highp float f=(NdotH*a4-NdotH)*NdotH+1.0;return a4/(PI*f*f);}vec3 diffuseBurley(Material mat,float LdotH,float NdotL,float NdotV)
{float f90=2.0*LdotH*LdotH*mat.alphaRoughness-0.5;return (mat.diffuseColor/PI)*(1.0+f90*pow((1.0-NdotL),5.0))*(1.0+f90*pow((1.0-NdotV),5.0));}vec3 diffuseLambertian(Material mat)
{
#ifdef LIGHTING_3D_MODE
return mat.diffuseColor;
#else
return mat.diffuseColor/PI;
#endif
}vec3 EnvBRDFApprox(vec3 specularColor,float roughness,highp float NdotV)
{vec4 c0=vec4(-1,-0.0275,-0.572,0.022);vec4 c1=vec4(1,0.0425,1.04,-0.04);highp vec4 r=roughness*c0+c1;highp float a004=min(r.x*r.x,exp2(-9.28*NdotV))*r.x+r.y;vec2 AB=vec2(-1.04,1.04)*a004+r.zw;return specularColor*AB.x+AB.y;}vec3 computeIndirectLightContribution(Material mat,float NdotV,vec3 normal)
{vec3 env_light=vec3(0.65,0.65,0.65);
#ifdef LIGHTING_3D_MODE
float ambient_factor=calculate_ambient_directional_factor(normal);env_light=u_lighting_ambient_color*ambient_factor;
#endif
vec3 envBRDF=EnvBRDFApprox(mat.specularColor,mat.perceptualRoughness,NdotV);vec3 indirectSpecular= envBRDF*env_light;vec3 indirectDiffuse=mat.diffuseColor*env_light;return indirectSpecular+indirectDiffuse;}vec3 computeLightContribution(Material mat,vec3 lightPosition,vec3 lightColor)
{highp vec3 n=mat.normal;highp vec3 v=normalize(-v_position_height.xyz);highp vec3 l=normalize(lightPosition);highp vec3 h=normalize(v+l);float NdotV=clamp(abs(dot(n,v)),0.001,1.0);float NdotL=saturate(dot(n,l));highp float NdotH=saturate(dot(n,h));float VdotH=saturate(dot(v,h));vec3 f=F_SchlickFast(mat.specularColor,VdotH);float g=V_GGXFast(NdotL,NdotV,mat.alphaRoughness);float d=D_GGX(NdotH,mat.alphaRoughness);vec3 diffuseTerm=(1.0-f)*diffuseLambertian(mat);vec3 specularTerm=f*g*d;vec3 transformed_normal=vec3(-n.xy,n.z);float lighting_factor;
#ifdef RENDER_SHADOWS
lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
lighting_factor=NdotL;
#endif
vec3 directLightColor=(specularTerm+diffuseTerm)*lighting_factor*lightColor;vec3 indirectLightColor=computeIndirectLightContribution(mat,NdotV,transformed_normal);vec3 color=(saturate(directLightColor)+indirectLightColor);float intensityFactor=1.0;
#if !defined(LIGHTING_3D_MODE)
const vec3 luminosityFactor=vec3(0.2126,0.7152,0.0722);float luminance=dot(diffuseTerm,luminosityFactor);intensityFactor=mix((1.0-u_lightintensity),max((1.0-luminance+u_lightintensity),1.0),NdotL);
#endif
color*=intensityFactor;return color;}void main() {
#ifdef TERRAIN_FRAGMENT_OCCLUSION
if (isOccluded()) {discard;}
#endif
vec3 lightDir=u_lightpos;vec3 lightColor=u_lightcolor;
#ifdef LIGHTING_3D_MODE
lightDir=u_lighting_directional_dir;lightDir.xy=-lightDir.xy;lightColor=u_lighting_directional_color;
#endif
vec4 finalColor;
#ifdef DIFFUSE_SHADED
vec3 N=getNormal();vec3 baseColor=getBaseColor().rgb;vec3 diffuse=getDiffuseShadedColor(baseColor,N,lightDir,lightColor);
#ifdef HAS_TEXTURE_u_occlusionTexture
float ao=(texture(u_occlusionTexture,uv_2f).r-1.0)*u_aoIntensity+1.0;diffuse*=ao;
#endif
finalColor=vec4(mix(diffuse,baseColor,u_emissive_strength),1.0)*u_opacity;
#else
Material mat=getPBRMaterial();vec3 color=computeLightContribution(mat,lightDir,lightColor);float ao=1.0;
#if defined (HAS_TEXTURE_u_occlusionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
#ifdef OCCLUSION_TEXTURE_TRANSFORM
vec2 uv=uv_2f.xy*u_occlusionTextureTransform.zw+u_occlusionTextureTransform.xy;
#else
vec2 uv=uv_2f;
#endif
ao=(texture(u_occlusionTexture,uv).x-1.0)*u_aoIntensity+1.0;color*=ao;
#endif
vec4 emissive=u_emissiveFactor;
#if defined(HAS_TEXTURE_u_emissionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
emissive.rgb*=sRGBToLinear(texture(u_emissionTexture,uv_2f).rgb);
#endif
#ifdef APPLY_LUT_ON_GPU
float emissiveFactorLength=max(length(u_emissiveFactor.rgb),0.001);emissive.rgb=sRGBToLinear(applyLUT(u_lutTexture,linearTosRGB(emissive.rgb/emissiveFactorLength).rbg))*emissiveFactorLength;
#endif
color+=emissive.rgb;float opacity=mat.baseColor.w*u_opacity;
#ifdef HAS_ATTRIBUTE_a_pbr
float resEmission=v_roughness_metallic_emissive_alpha.z;resEmission*=v_height_based_emission_params.z+v_height_based_emission_params.w*pow(clamp(v_height_based_emission_params.x,0.0,1.0),v_height_based_emission_params.y);vec3 color_mix=v_color_mix.rgb;
#ifdef APPLY_LUT_ON_GPU
color_mix=applyLUT(u_lutTexture,color_mix);
#endif
color=mix(color,color_mix,min(1.0,resEmission));
#ifdef HAS_ATTRIBUTE_a_color_4f
float distance=length(vec2(1.3*max(0.0,abs(color_4f.x)-color_4f.z),color_4f.y));distance+= mix(0.5,0.0,clamp(resEmission-1.0,0.0,1.0));opacity*=v_roughness_metallic_emissive_alpha.w*saturate(1.0-distance*distance);
#endif
#endif
vec3 unlitColor=mat.baseColor.rgb*ao+emissive.rgb;color=mix(color,unlitColor,u_emissive_strength);color=linearTosRGB(color);color*=opacity;finalColor=vec4(color,opacity);
#endif
#ifdef FOG
finalColor=fog_dither(fog_apply_premultiplied(finalColor,v_fog_pos,v_position_height.w));
#endif
#ifdef RENDER_CUTOFF
finalColor*=v_cutoff_opacity;
#endif
#ifdef INDICATOR_CUTOUT
finalColor=applyCutout(finalColor,v_position_height.w);
#endif
#ifdef FEATURE_CUTOUT
finalColor=apply_feature_cutout(finalColor,gl_FragCoord);
#endif
glFragColor=finalColor;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec3 a_pos_3f;
#pragma mapbox: define-attribute highp vec3 normal_3f
#pragma mapbox: define-attribute highp vec2 uv_2f
#pragma mapbox: define-attribute highp vec3 color_3f
#pragma mapbox: define-attribute highp vec4 color_4f
#pragma mapbox: define-attribute-vertex-shader-only highp vec4 pbr
#pragma mapbox: define-attribute-vertex-shader-only highp vec3 heightBasedEmissiveStrength
uniform mat4 u_matrix;uniform mat4 u_node_matrix;uniform mat4 u_lighting_matrix;uniform vec3 u_camera_pos;uniform vec4 u_color_mix;
#ifdef INSTANCED_ARRAYS
in vec4 a_normal_matrix0;in vec4 a_normal_matrix1;in vec4 a_normal_matrix2;in vec4 a_normal_matrix3;
#else
uniform highp mat4 u_normal_matrix;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out float v_depth_shadows;
#endif
out vec4 v_position_height;out lowp vec4 v_color_mix;
#ifdef TERRAIN_FRAGMENT_OCCLUSION
out highp float v_depth;
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
out lowp vec4 v_roughness_metallic_emissive_alpha;out mediump vec4 v_height_based_emission_params;
#endif
vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}void main() {
#pragma mapbox: initialize-attribute highp vec3 normal_3f
#pragma mapbox: initialize-attribute highp vec2 uv_2f
#pragma mapbox: initialize-attribute highp vec3 color_3f
#pragma mapbox: initialize-attribute highp vec4 color_4f
#pragma mapbox: initialize-attribute-custom highp vec4 pbr
#pragma mapbox: initialize-attribute-custom highp vec3 heightBasedEmissiveStrength
highp mat4 normal_matrix;
#ifdef INSTANCED_ARRAYS
normal_matrix=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);
#else
normal_matrix=u_normal_matrix;
#endif
vec3 local_pos;mat3 rs;
#ifdef MODEL_POSITION_ON_GPU
vec3 pos_color=normal_matrix[0].xyz;vec4 translate=normal_matrix[1];vec3 pos_a=floor(pos_color);vec3 rgb=1.05*(pos_color-pos_a);float hidden=float(pos_a.x > EXTENT);float color_mix=pos_a.z/100.0;v_color_mix=vec4(sRGBToLinear(rgb),color_mix);float meter_to_tile=normal_matrix[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);rs[0].x=normal_matrix[1].w;rs[0].yz=normal_matrix[2].xy;rs[1].xy=normal_matrix[2].zw;rs[1].z=normal_matrix[3].x;rs[2].xyz=normal_matrix[3].yzw;vec4 pos_node=u_lighting_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;local_pos=pos.xyz;gl_Position=mix(u_matrix*pos,AWAY,hidden);pos.z*=meter_to_tile;v_position_height.xyz=pos.xyz-u_camera_pos;
#else
local_pos=a_pos_3f;gl_Position=u_matrix*vec4(a_pos_3f,1);v_position_height.xyz=vec3(u_lighting_matrix*vec4(a_pos_3f,1));v_color_mix=vec4(sRGBToLinear(u_color_mix.rgb),u_color_mix.a);
#endif
v_position_height.w=a_pos_3f.z;
#ifdef HAS_ATTRIBUTE_a_pbr
vec4 albedo_c=decode_color(pbr.xy);vec2 e_r_m=unpack_float(pbr.z);vec2 r_m= unpack_float(e_r_m.y*16.0);r_m.r=r_m.r*16.0;v_color_mix=vec4(albedo_c.rgb,1.0);v_roughness_metallic_emissive_alpha=vec4(vec3(r_m,e_r_m.x)/255.0,albedo_c.a);v_roughness_metallic_emissive_alpha.z*=2.0;float heightBasedRelativeIntepolation=a_pos_3f.z*heightBasedEmissiveStrength.x+heightBasedEmissiveStrength.y;v_height_based_emission_params.x=heightBasedRelativeIntepolation;v_height_based_emission_params.y=heightBasedEmissiveStrength.z;vec2 emissionMultiplierValues=unpack_float(pbr.w)/256.0;v_height_based_emission_params.z=emissionMultiplierValues.x;v_height_based_emission_params.w=emissionMultiplierValues.y-emissionMultiplierValues.x;
#endif
#ifdef FOG
v_fog_pos=fog_position(local_pos);
#endif
#ifdef RENDER_CUTOFF
v_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);
#endif
#ifdef TERRAIN_FRAGMENT_OCCLUSION
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef HAS_ATTRIBUTE_a_normal_3f
#ifdef MODEL_POSITION_ON_GPU
float x_squared_scale=dot(rs[0],rs[0]);float y_squared_scale=dot(rs[1],rs[1]);float z_squared_scale=dot(rs[2],rs[2]);vec3 squared_scale=vec3(x_squared_scale,y_squared_scale,z_squared_scale);normal_3f=rs*((u_lighting_matrix*vec4(normal_3f,0.0)).xyz/squared_scale);normal_3f=normalize(normal_3f);
#else
normal_3f=vec3(normal_matrix*vec4(normal_3f,0));
#endif
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
#ifdef HAS_ATTRIBUTE_a_color_4f
v_roughness_metallic_emissive_alpha.w=clamp(color_4f.a*v_roughness_metallic_emissive_alpha.w*(v_roughness_metallic_emissive_alpha.z-1.0),0.0,1.0);
#endif
#endif
#ifdef RENDER_SHADOWS
vec4 shadow_pos=u_node_matrix*vec4(local_pos,1.0);
#ifdef NORMAL_OFFSET
#ifdef HAS_ATTRIBUTE_a_normal_3f
#ifdef MODEL_POSITION_ON_GPU
vec3 offset=shadow_normal_offset(vec3(-normal_3f.xy,normal_3f.z));shadow_pos.xyz+=offset*shadow_normal_offset_multiplier0();
#else
vec3 offset=shadow_normal_offset_model(normal_3f);shadow_pos.xyz+=offset*shadow_normal_offset_multiplier0();
#endif
#endif
#endif
v_pos_light_view_0=u_light_matrix_0*shadow_pos;v_pos_light_view_1=u_light_matrix_1*shadow_pos;v_depth_shadows=gl_Position.w;
#endif
}`),modelDepth:mr(`in highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
glFragColor=pack_depth(v_depth);
#endif
}`,`in vec3 a_pos_3f;uniform mat4 u_matrix;out highp float v_depth;
#ifdef MODEL_POSITION_ON_GPU
#ifdef INSTANCED_ARRAYS
in vec4 a_normal_matrix0;in vec4 a_normal_matrix1;in vec4 a_normal_matrix2;in vec4 a_normal_matrix3;
#else
uniform highp mat4 u_instance;
#endif
uniform highp mat4 u_node_matrix;
#endif
void main() {
#ifdef MODEL_POSITION_ON_GPU
highp mat4 instance;
#ifdef INSTANCED_ARRAYS
instance=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);
#else
instance=u_instance;
#endif
vec3 pos_color=instance[0].xyz;vec4 translate=instance[1];vec3 pos_a=floor(pos_color);float hidden=float(pos_a.x > EXTENT);float meter_to_tile=instance[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);mat3 rs;rs[0].x=instance[1].w;rs[0].yz=instance[2].xy;rs[1].xy=instance[2].zw;rs[1].z=instance[3].x;rs[2].xyz=instance[3].yzw;vec4 pos_node=u_node_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;gl_Position=mix(u_matrix*pos,AWAY,hidden);
#else
gl_Position=u_matrix*vec4(a_pos_3f,1);
#endif
v_depth=gl_Position.z/gl_Position.w;}`),stars:mr(`in highp vec2 v_uv;in mediump float v_intensity;float shapeCircle(in vec2 uv)
{float beginFade=0.6;float lengthFromCenter=length(v_uv);return 1.0-clamp((lengthFromCenter-beginFade)/(1.0-beginFade),0.0,1.0);}void main() {float alpha=shapeCircle(v_uv);vec3 color=vec3(1.0,1.0,1.0);alpha*=v_intensity;glFragColor=vec4(color*alpha,alpha);HANDLE_WIREFRAME_DEBUG;}`,`
in vec3 a_pos_3f;in vec2 a_uv;in float a_size_scale;in float a_fade_opacity;uniform mat4 u_matrix;uniform vec3 u_up;uniform vec3 u_right;uniform float u_intensity_multiplier;out highp vec2 v_uv;out mediump float v_intensity;void main() {v_uv=a_uv;v_intensity=a_fade_opacity*u_intensity_multiplier;vec3 pos=a_pos_3f;pos+=a_uv.x*u_right*a_size_scale;pos+=a_uv.y*u_up*a_size_scale;gl_Position=u_matrix*vec4(pos,1.0);}`),snowParticle:mr("in highp vec2 uv;in highp float alphaMultiplier;uniform vec4 u_particleColor;uniform vec2 u_simpleShapeParameters;void main() {float t=clamp((length(uv)-u_simpleShapeParameters.x)/(1.0-u_simpleShapeParameters.x),0.0,1.0);float alpha=1.0-pow(t,pow(10.0,u_simpleShapeParameters.y));alpha*=alphaMultiplier;alpha*=u_particleColor.a;vec3 color=u_particleColor.rgb*alpha;glFragColor=vec4(color,alpha) ;HANDLE_WIREFRAME_DEBUG;}",`
in highp vec3 a_pos_3f;in highp vec2 a_uv;in highp vec4 a_snowParticleData;in highp vec4 a_snowParticleDataHorizontalOscillation;uniform mat4 u_modelview;uniform mat4 u_projection;uniform vec3 u_cam_pos;uniform vec2 u_screenSize;uniform float u_time;uniform float u_boxSize;uniform float u_velocityConeAperture; 
uniform float u_velocity;uniform vec3 u_direction;uniform float u_horizontalOscillationRadius; 
uniform float u_horizontalOscillationRate; 
uniform float u_billboardSize;uniform vec2 u_thinningCenterPos;uniform vec3 u_thinningShape;uniform float u_thinningAffectedRatio;uniform float u_thinningParticleOffset;out highp vec2 uv;out highp float alphaMultiplier;void main() {vec3 pos=a_pos_3f;float halfBoxSize=0.5*u_boxSize;pos.xyz*=halfBoxSize;pos+=u_cam_pos;float velocityConeApertureRad=radians(u_velocityConeAperture*0.5);float coneAnglePichRad=velocityConeApertureRad*a_snowParticleData.z;float coneAngleHeadingRad=a_snowParticleData.w*radians(360.0);vec3 localZ=normalize(u_direction);vec3 localX=normalize(cross(localZ,vec3(1,0,0)));vec3 localY=normalize(cross(localZ,localX));vec3 direction;direction.x=cos(coneAngleHeadingRad)*sin(coneAnglePichRad);direction.y=sin(coneAngleHeadingRad)*sin(coneAnglePichRad);direction.z=cos(coneAnglePichRad);direction=normalize(direction);vec3 simPosLocal=vec3(0,0,0);float velocityScale=(1.0+3.0*a_snowParticleData.y)*u_velocity;simPosLocal+=direction*velocityScale*u_time;float horizontalOscillationRadius=u_horizontalOscillationRadius*a_snowParticleDataHorizontalOscillation.x;float horizontalOscillationAngle=u_horizontalOscillationRate*u_time*(-1.0+2.0*a_snowParticleDataHorizontalOscillation.y);simPosLocal.xy+=horizontalOscillationRadius*vec2(cos(horizontalOscillationAngle),sin(horizontalOscillationAngle));vec3 simPos=localX*simPosLocal.x+
localY*simPosLocal.y+localZ*simPosLocal.z;pos+=simPos;pos=fract((pos+vec3(halfBoxSize))/vec3(u_boxSize))*u_boxSize-vec3(halfBoxSize);float clipZ=-u_cam_pos.z+pos.z;vec4 posView=u_modelview*vec4(pos,1.0);float size=u_billboardSize;alphaMultiplier=1.0;vec4 posScreen=u_projection*posView;posScreen/=posScreen.w;posScreen.xy=vec2(0.5)+posScreen.xy*0.5;posScreen.xy*=u_screenSize;vec2 thinningCenterPos=u_thinningCenterPos.xy;thinningCenterPos.y=u_screenSize.y-thinningCenterPos.y;float screenDist=length((thinningCenterPos-posScreen.xy)/(0.5*u_screenSize));screenDist+=a_snowParticleData.x*u_thinningParticleOffset;float scaleFactorMode=0.0;float thinningShapeDist=u_thinningShape.x+u_thinningShape.y;if (screenDist < thinningShapeDist) {float thinningFadeRatio=clamp((screenDist-u_thinningShape.x)/u_thinningShape.y,0.0,1.0);thinningFadeRatio=pow(thinningFadeRatio,u_thinningShape.z);if (a_snowParticleData.x < u_thinningAffectedRatio) {scaleFactorMode=1.0-thinningFadeRatio;alphaMultiplier=thinningFadeRatio;}}vec4 posScreen1=u_projection*vec4(posView.x-size,posView.yzw);posScreen1/=posScreen1.w;vec4 posScreen2=u_projection*vec4(posView.x+size,posView.yzw);posScreen2/=posScreen2.w;posScreen1.xy=vec2(0.5)+posScreen1.xy*0.5;posScreen1.xy*=u_screenSize;posScreen2.xy=vec2(0.5)+posScreen2.xy*0.5;posScreen2.xy*=u_screenSize;float screenLength=length(posScreen1.xy-posScreen2.xy);float screenEpsilon=3.0;float scaleFactor=1.0;if (screenLength < screenEpsilon) {scaleFactor=screenEpsilon/max(screenLength,0.01);scaleFactor=mix(scaleFactor,1.0,scaleFactorMode);}float screenEpsilon2=15.0;if (screenLength > screenEpsilon2) {scaleFactor=screenEpsilon2/max(screenLength,0.01);}size*=scaleFactor;vec2 right=size*vec2(1,0);vec2 up=size*vec2(0,1);posView.xy+=right*a_uv.x;posView.xy+=up*a_uv.y;uv=a_uv;gl_Position=u_projection*posView;}`),rainParticle:mr("in highp vec2 uv;in highp float particleRandomValue;uniform sampler2D u_texScreen;uniform float u_distortionStrength;uniform vec4 u_color;uniform vec2 u_thinningCenterPos;uniform vec3 u_thinningShape;uniform float u_thinningAffectedRatio;uniform float u_thinningParticleOffset;uniform float u_shapeDirectionalPower;uniform float u_mode;void main() {vec2 st=uv*0.5+vec2(0.5);vec2 uvm=uv;uvm.y=-1.0+2.0*pow(st.y,u_shapeDirectionalPower);float shape=clamp(1.0-length(uvm),0.0,1.0);float alpha=abs(shape)*u_color.a;vec2 screenSize=vec2(textureSize(u_texScreen,0));vec2 thinningCenterPos=u_thinningCenterPos.xy;thinningCenterPos.y=screenSize.y-thinningCenterPos.y;float screenDist=length((thinningCenterPos-gl_FragCoord.xy)/(0.5*screenSize));screenDist+=(0.5+0.5*particleRandomValue)*u_thinningParticleOffset;float thinningShapeDist=u_thinningShape.x+u_thinningShape.y;float thinningAlpha=1.0;if (screenDist < thinningShapeDist) {float thinningFadeRatio=clamp((screenDist-u_thinningShape.x)/u_thinningShape.y,0.0,1.0);thinningFadeRatio=pow(thinningFadeRatio,u_thinningShape.z);thinningAlpha*=thinningFadeRatio;}vec2 offsetXY=normalize(uvm)*abs(shape);vec2 stScreen=(gl_FragCoord.xy+offsetXY*u_distortionStrength*thinningAlpha)/screenSize;vec3 colorScreen=texture(u_texScreen,stScreen).rgb;alpha*=thinningAlpha;glFragColor=mix(vec4(colorScreen,1.0),vec4(u_color.rgb*alpha,alpha),u_mode);HANDLE_WIREFRAME_DEBUG;}",`
in highp vec3 a_pos_3f;in highp vec2 a_uv;in highp vec4 a_rainParticleData;uniform mat4 u_modelview;uniform mat4 u_projection;uniform vec3 u_cam_pos;uniform float u_time;uniform float u_boxSize;uniform float u_velocityConeAperture; 
uniform float u_velocity; 
uniform vec2 u_rainDropletSize;uniform vec3 u_rainDirection;out highp vec2 uv;out highp float particleRandomValue;void main() {vec3 pos=a_pos_3f;float halfBoxSize=0.5*u_boxSize;pos*=halfBoxSize; 
pos+=u_cam_pos;float velocityConeApertureRad=radians(u_velocityConeAperture*0.5);float coneAnglePichRad=velocityConeApertureRad*a_rainParticleData.z;float coneAngleHeadingRad=a_rainParticleData.w*radians(360.0);vec3 localZ=normalize(u_rainDirection);vec3 localX=normalize(cross(localZ,vec3(1,0,0)));vec3 localY=normalize(cross(localZ,localX));vec3 directionLocal;directionLocal.x=cos(coneAngleHeadingRad)*sin(coneAnglePichRad);directionLocal.y=sin(coneAngleHeadingRad)*sin(coneAnglePichRad);directionLocal.z=cos(coneAnglePichRad);directionLocal=normalize(directionLocal);vec3 directionWorld=localX*directionLocal.x+localY*directionLocal.y+localZ*directionLocal.z;float velocityScale=(1.0+3.0*a_rainParticleData.y)*u_velocity;vec3 simPosLocal=vec3(0,0,0);simPosLocal+=directionLocal*velocityScale*u_time;vec3 simPos=localX*simPosLocal.x+
localY*simPosLocal.y+localZ*simPosLocal.z;pos+=simPos;pos=fract((pos+vec3(halfBoxSize))/vec3(u_boxSize))*u_boxSize-vec3(halfBoxSize);vec4 posView=u_modelview*vec4(pos,1.0);vec3 directionView=normalize((u_modelview*vec4(directionWorld,0.0)).xyz);vec3 side=cross(directionView,normalize(posView.xyz));posView.xyz+=side*a_uv.x*u_rainDropletSize.x;posView.xyz+=directionView*a_uv.y*u_rainDropletSize.y;uv=a_uv;particleRandomValue=a_rainParticleData.x;gl_Position=u_projection*posView;}`),vignette:mr("uniform vec3 u_vignetteShape;uniform vec4 u_vignetteColor;in vec2 st;void main() {float screenDist=length(st);float alpha=clamp((screenDist-u_vignetteShape.x)/u_vignetteShape.y,0.0,1.0);alpha=pow(alpha,u_vignetteShape.z)*u_vignetteColor.a;vec3 color=u_vignetteColor.rgb;glFragColor=vec4(color*alpha,alpha) ;}","in vec2 a_pos_2f;out vec2 st;void main() {st=a_pos_2f;gl_Position=vec4(a_pos_2f,0,1);}"),occlusion:mr("uniform vec4 u_color;void main() {glFragColor=u_color;}",`#include "_prelude_terrain.vertex.glsl"
in highp vec2 a_offset_xy;uniform highp vec3 u_anchorPos;uniform mat4 u_matrix;uniform vec2 u_screenSizePx;uniform vec2 u_occluderSizePx;void main() {vec3 world_pos=u_anchorPos;
#ifdef TERRAIN
float e=elevation(world_pos.xy);world_pos.z+=e;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1.0);projected_point.xy+=projected_point.w*a_offset_xy*0.5*u_occluderSizePx/u_screenSizePx;gl_Position=projected_point;}`)};function Fa(m,i){const c=m.replace(/\s*\/\/[^\n]*\n/g,`
`).split(`
`);for(let p of c)if(p=p.trim(),p[0]==="#"&&p.includes("if")&&!p.includes("endif")){p=p.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const y=p.split(" ");for(const v of y)i.includes(v)||i.push(v)}}function mr(m,i){const c=/#include\s+"([^"]+)"/g,p=/#pragma mapbox: ([\w\-]+) ([\w]+) ([\w]+) ([\w]+)/g,y={},v=[],w=[];if(m=m.replace(c,((I,O)=>(w.push(O),""))),(i=i.replace(c,((I,O)=>(v.push(O),"")))).includes("flat out"))return void console.error('The usage of "flat" qualifier is disallowed, see: https://bugs.webkit.org/show_bug.cgi?id=268071');let S=[...Ud];Fa(m,S),Fa(i,S);for(const I of[...v,...w])jd[I]||console.error(`Undefined include: ${I}`),wf[I]||(wf[I]=[],Fa(jd[I],wf[I])),S=[...S,...wf[I]];return{fragmentSource:m=m.replace(p,((I,O,D,N,z)=>(y[z]=!0,O==="define"?`
#ifndef HAS_UNIFORM_u_${z}
in ${D} ${N} ${z};
#else
uniform ${D} ${N} u_${z};
#endif
`:O==="initialize"?`
#ifdef HAS_UNIFORM_u_${z}
    ${D} ${N} ${z} = u_${z};
#endif
`:O==="define-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${z}
    in ${D} ${N} ${z};
#endif
`:O==="initialize-attribute"?"":void 0))),vertexSource:i=i.replace(p,((I,O,D,N,z)=>{const U=N==="float"?"vec2":N,G=z.match(/color/)?"color":U;return O==="define-attribute-vertex-shader-only"?`
#ifdef HAS_ATTRIBUTE_a_${z}
in ${D} ${N} a_${z};
#endif
`:y[z]?O==="define"?`
#ifndef HAS_UNIFORM_u_${z}
uniform lowp float u_${z}_t;
in ${D} ${U} a_${z};
out ${D} ${N} ${z};
#else
uniform ${D} ${N} u_${z};
#endif
`:O==="initialize"?G==="vec4"?`
#ifndef HAS_UNIFORM_u_${z}
    ${z} = a_${z};
#else
    ${D} ${N} ${z} = u_${z};
#endif
`:`
#ifndef HAS_UNIFORM_u_${z}
    ${z} = unpack_mix_${G}(a_${z}, u_${z}_t);
#else
    ${D} ${N} ${z} = u_${z};
#endif
`:O==="define-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${z}
    in ${D} ${N} a_${z};
    out ${D} ${N} ${z};
#endif
`:O==="initialize-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${z}
    ${z} = a_${z};
#endif
`:void 0:O==="define"?`
#ifndef HAS_UNIFORM_u_${z}
uniform lowp float u_${z}_t;
in ${D} ${U} a_${z};
#else
uniform ${D} ${N} u_${z};
#endif
`:O==="define-instanced"?G==="mat4"?`
#ifdef INSTANCED_ARRAYS
in vec4 a_${z}0;
in vec4 a_${z}1;
in vec4 a_${z}2;
in vec4 a_${z}3;
#else
uniform ${D} ${N} u_${z};
#endif
`:`
#ifdef INSTANCED_ARRAYS
in ${D} ${U} a_${z};
#else
uniform ${D} ${N} u_${z};
#endif
`:O==="initialize-attribute-custom"?`
#ifdef HAS_ATTRIBUTE_a_${z}
    ${D} ${N} ${z} = a_${z};
#endif
`:G==="vec4"?`
#ifndef HAS_UNIFORM_u_${z}
    ${D} ${N} ${z} = a_${z};
#else
    ${D} ${N} ${z} = u_${z};
#endif
`:`
#ifndef HAS_UNIFORM_u_${z}
    ${D} ${N} ${z} = unpack_mix_${G}(a_${z}, u_${z}_t);
#else
    ${D} ${N} ${z} = u_${z};
#endif
`})),usedDefines:S,vertexIncludes:v,fragmentIncludes:w}}class Gd{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(i,c,p,y,v,w,S,I){this.context=i;let O=this.boundPaintVertexBuffers.length!==y.length;for(let N=0;!O&&N<y.length;N++)this.boundPaintVertexBuffers[N]!==y[N]&&(O=!0);let D=this.boundDynamicVertexBuffers.length!==S.length;for(let N=0;!D&&N<S.length;N++)this.boundDynamicVertexBuffers[N]!==S[N]&&(D=!0);if(!this.vao||this.boundProgram!==c||this.boundLayoutVertexBuffer!==p||O||D||this.boundIndexBuffer!==v||this.boundVertexOffset!==w)this.freshBind(c,p,y,v,w,S,I);else{i.bindVertexArrayOES.set(this.vao);for(const N of S)N&&(N.bind(),I&&N.instanceCount&&N.setVertexAttribDivisor(i.gl,c,I));v&&v.dynamicDraw&&v.bind()}}freshBind(i,c,p,y,v,w,S){const I=this.context,O=I.gl;this.vao&&this.destroy(),this.vao=I.gl.createVertexArray(),I.bindVertexArrayOES.set(this.vao),this.boundProgram=i,this.boundLayoutVertexBuffer=c,this.boundPaintVertexBuffers=p,this.boundIndexBuffer=y,this.boundVertexOffset=v,this.boundDynamicVertexBuffers=w,c.enableAttributes(O,i),c.bind(),c.setVertexAttribPointers(O,i,v);for(const D of p)D.enableAttributes(O,i),D.bind(),D.setVertexAttribPointers(O,i,v);for(const D of w)D&&(D.enableAttributes(O,i),D.bind(),D.setVertexAttribPointers(O,i,v),S&&D.instanceCount&&D.setVertexAttribDivisor(O,i,S));y&&y.bind()}destroy(){this.vao&&(this.context.gl.deleteVertexArray(this.vao),this.vao=null)}}function QT(m,i){const c=Math.pow(2,i.canonical.z),p=i.canonical.y;return[new s.ae(0,p/c).toLngLat().lat,new s.ae(0,(p+1)/c).toLngLat().lat]}function eS(m,i,c,p,y,v,w){const S=m.context,I=S.gl,O=c.hillshadeFBO;if(!O)return;m.prepareDrawTile();const D=m.isTileAffectedByFog(i),N=m.getOrCreateProgram("hillshade",{overrideFog:D});S.activeTexture.set(I.TEXTURE0),I.bindTexture(I.TEXTURE_2D,O.colorAttachment.get());const z=((J,Z,ee,ie)=>{const se=ee.paint.get("hillshade-shadow-color"),me=ee.paint.get("hillshade-shadow-color-use-theme").constantOr("default")==="none",fe=ee.paint.get("hillshade-highlight-color"),ge=ee.paint.get("hillshade-highlight-color-use-theme").constantOr("default")==="none",pe=ee.paint.get("hillshade-accent-color"),he=ee.paint.get("hillshade-accent-color-use-theme").constantOr("default")==="none",_e=ee.paint.get("hillshade-emissive-strength");let Ke=s.an(ee.paint.get("hillshade-illumination-direction"));if(ee.paint.get("hillshade-illumination-anchor")==="viewport")Ke-=J.transform.angle;else if(J.style&&J.style.enable3dLights()&&J.style.directionalLight){const st=J.style.directionalLight.properties.get("direction"),We=s.d3(st.x,st.y,st.z);Ke=s.an(We[1])}const Le=!J.options.moving;return{u_matrix:ie||J.transform.calculateProjMatrix(Z.tileID.toUnwrapped(),Le),u_image:0,u_latrange:QT(0,Z.tileID),u_light:[ee.paint.get("hillshade-exaggeration"),Ke],u_shadow:se.toPremultipliedRenderColor(me?null:ee.lut),u_highlight:fe.toPremultipliedRenderColor(ge?null:ee.lut),u_emissive_strength:_e,u_accent:pe.toPremultipliedRenderColor(he?null:ee.lut)}})(m,c,p,m.terrain?i.projMatrix:null);m.uploadCommonUniforms(S,N,i.toUnwrapped());const{tileBoundsBuffer:U,tileBoundsIndexBuffer:G,tileBoundsSegments:H}=m.getTileBoundsBuffers(c);N.draw(m,I.TRIANGLES,y,v,w,Dn.disabled,z,p.id,U,G,H)}function Wp(m,i,c){if(!i.needsDEMTextureUpload)return;const p=m.context,y=p.gl;p.pixelStoreUnpackPremultiplyAlpha.set(!1),i.demTexture=i.demTexture||m.getTileTexture(c.stride);const v=c.getPixels();i.demTexture?i.demTexture.update(v,{premultiply:!1}):i.demTexture=new s.T(p,v,y.R32F,{premultiply:!1}),i.needsDEMTextureUpload=!1}function tS(m,i,c){const p=m.context,y=p.gl;if(!i.dem)return;const v=i.dem;if(p.activeTexture.set(y.TEXTURE1),Wp(m,i,v),!i.demTexture)return;i.demTexture.bind(y.NEAREST,y.CLAMP_TO_EDGE);const w=v.dim;p.activeTexture.set(y.TEXTURE0);let S=i.hillshadeFBO;if(!S){const z=new s.T(p,{width:w,height:w,data:null},y.RGBA8);z.bind(y.LINEAR,y.CLAMP_TO_EDGE),S=i.hillshadeFBO=p.createFramebuffer(w,w,!0,"renderbuffer"),S.colorAttachment.set(z.texture)}p.bindFramebuffer.set(S.framebuffer),p.viewport.set([0,0,w,w]);const{tileBoundsBuffer:I,tileBoundsIndexBuffer:O,tileBoundsSegments:D}=m.getMercatorTileBoundsBuffers(),N=[];m.linearFloatFilteringSupported()&&N.push("TERRAIN_DEM_FLOAT_FORMAT"),m.getOrCreateProgram("hillshadePrepare",{defines:N}).draw(m,y.TRIANGLES,Gt.disabled,Tn.disabled,In.unblended,Dn.disabled,((z,U)=>{const G=U.stride,H=s.bC();return s.cd(H,0,s.al,-s.al,0,0,1),s.br(H,H,[0,-s.al,0]),{u_matrix:H,u_image:1,u_dimension:[G,G],u_zoom:z.overscaledZ}})(i.tileID,v),c.id,I,O,D),i.needsHillshadePrepare=!1}class Fi{constructor(i){this.gl=i.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(i){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class wb extends Fi{getDefault(){return s.ao.transparent.toNonPremultipliedRenderColor(null)}set(i){const c=this.current;(i.r!==c.r||i.g!==c.g||i.b!==c.b||i.a!==c.a||this.dirty)&&(this.gl.clearColor(i.r,i.g,i.b,i.a),this.current=i,this.dirty=!1)}}class y_ extends Fi{getDefault(){return 1}set(i){(i!==this.current||this.dirty)&&(this.gl.clearDepth(i),this.current=i,this.dirty=!1)}}class nS extends Fi{getDefault(){return 0}set(i){(i!==this.current||this.dirty)&&(this.gl.clearStencil(i),this.current=i,this.dirty=!1)}}class rS extends Fi{getDefault(){return[!0,!0,!0,!0]}set(i){const c=this.current;(i[0]!==c[0]||i[1]!==c[1]||i[2]!==c[2]||i[3]!==c[3]||this.dirty)&&(this.gl.colorMask(i[0],i[1],i[2],i[3]),this.current=i,this.dirty=!1)}}class iS extends Fi{getDefault(){return!0}set(i){(i!==this.current||this.dirty)&&(this.gl.depthMask(i),this.current=i,this.dirty=!1)}}class oS extends Fi{getDefault(){return 255}set(i){(i!==this.current||this.dirty)&&(this.gl.stencilMask(i),this.current=i,this.dirty=!1)}}class Tb extends Fi{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(i){const c=this.current;(i.func!==c.func||i.ref!==c.ref||i.mask!==c.mask||this.dirty)&&(this.gl.stencilFunc(i.func,i.ref,i.mask),this.current=i,this.dirty=!1)}}class sS extends Fi{getDefault(){const i=this.gl;return[i.KEEP,i.KEEP,i.KEEP]}set(i){const c=this.current;(i[0]!==c[0]||i[1]!==c[1]||i[2]!==c[2]||this.dirty)&&(this.gl.stencilOp(i[0],i[1],i[2]),this.current=i,this.dirty=!1)}}class qp extends Fi{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;const c=this.gl;i?c.enable(c.STENCIL_TEST):c.disable(c.STENCIL_TEST),this.current=i,this.dirty=!1}}class aS extends Fi{getDefault(){return[0,1]}set(i){const c=this.current;(i[0]!==c[0]||i[1]!==c[1]||this.dirty)&&(this.gl.depthRange(i[0],i[1]),this.current=i,this.dirty=!1)}}class Sb extends Fi{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;const c=this.gl;i?c.enable(c.DEPTH_TEST):c.disable(c.DEPTH_TEST),this.current=i,this.dirty=!1}}class v_ extends Fi{getDefault(){return this.gl.LESS}set(i){(i!==this.current||this.dirty)&&(this.gl.depthFunc(i),this.current=i,this.dirty=!1)}}class Kp extends Fi{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;const c=this.gl;i?c.enable(c.BLEND):c.disable(c.BLEND),this.current=i,this.dirty=!1}}class b_ extends Fi{getDefault(){const i=this.gl;return[i.ONE,i.ZERO,i.ONE,i.ZERO]}set(i){const c=this.current;(i[0]!==c[0]||i[1]!==c[1]||i[2]!==c[2]||i[3]!==c[3]||this.dirty)&&(this.gl.blendFuncSeparate(i[0],i[1],i[2],i[3]),this.current=i,this.dirty=!1)}}class zu extends Fi{getDefault(){return s.ao.transparent.toNonPremultipliedRenderColor(null)}set(i){const c=this.current;(i.r!==c.r||i.g!==c.g||i.b!==c.b||i.a!==c.a||this.dirty)&&(this.gl.blendColor(i.r,i.g,i.b,i.a),this.current=i,this.dirty=!1)}}class Hd extends Fi{getDefault(){return this.gl.FUNC_ADD}set(i){(i!==this.current||this.dirty)&&(this.gl.blendEquationSeparate(i,i),this.current=i,this.dirty=!1)}}class Zp extends Fi{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;const c=this.gl;i?c.enable(c.CULL_FACE):c.disable(c.CULL_FACE),this.current=i,this.dirty=!1}}class Xp extends Fi{getDefault(){return this.gl.BACK}set(i){(i!==this.current||this.dirty)&&(this.gl.cullFace(i),this.current=i,this.dirty=!1)}}class Wd extends Fi{getDefault(){return this.gl.CCW}set(i){(i!==this.current||this.dirty)&&(this.gl.frontFace(i),this.current=i,this.dirty=!1)}}let Eb=class extends Fi{getDefault(){return null}set(m){(m!==this.current||this.dirty)&&(this.gl.useProgram(m),this.current=m,this.dirty=!1)}};class x_ extends Fi{getDefault(){return this.gl.TEXTURE0}set(i){(i!==this.current||this.dirty)&&(this.gl.activeTexture(i),this.current=i,this.dirty=!1)}}class Cb extends Fi{getDefault(){const i=this.gl;return[0,0,i.drawingBufferWidth,i.drawingBufferHeight]}set(i){const c=this.current;(i[0]!==c[0]||i[1]!==c[1]||i[2]!==c[2]||i[3]!==c[3]||this.dirty)&&(this.gl.viewport(i[0],i[1],i[2],i[3]),this.current=i,this.dirty=!1)}}class qd extends Fi{getDefault(){return null}set(i){if(i===this.current&&!this.dirty)return;const c=this.gl;c.bindFramebuffer(c.FRAMEBUFFER,i),this.current=i,this.dirty=!1}}class Yp extends Fi{getDefault(){return null}set(i){if(i===this.current&&!this.dirty)return;const c=this.gl;c.bindRenderbuffer(c.RENDERBUFFER,i),this.current=i,this.dirty=!1}}class Jp extends Fi{getDefault(){return null}set(i){if(i===this.current&&!this.dirty)return;const c=this.gl;c.bindTexture(c.TEXTURE_2D,i),this.current=i,this.dirty=!1}}class w_ extends Fi{getDefault(){return null}set(i){if(i===this.current&&!this.dirty)return;const c=this.gl;c.bindBuffer(c.ARRAY_BUFFER,i),this.current=i,this.dirty=!1}}class Qp extends Fi{getDefault(){return null}set(i){const c=this.gl;c.bindBuffer(c.ELEMENT_ARRAY_BUFFER,i),this.current=i,this.dirty=!1}}class Sf extends Fi{getDefault(){return null}set(i){this.gl&&(i!==this.current||this.dirty)&&(this.gl.bindVertexArray(i),this.current=i,this.dirty=!1)}}class Ib extends Fi{getDefault(){return 4}set(i){if(i===this.current&&!this.dirty)return;const c=this.gl;c.pixelStorei(c.UNPACK_ALIGNMENT,i),this.current=i,this.dirty=!1}}class Ab extends Fi{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;const c=this.gl;c.pixelStorei(c.UNPACK_PREMULTIPLY_ALPHA_WEBGL,i),this.current=i,this.dirty=!1}}class Pb extends Fi{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;const c=this.gl;c.pixelStorei(c.UNPACK_FLIP_Y_WEBGL,i),this.current=i,this.dirty=!1}}class kc extends Fi{constructor(i,c){super(i),this.context=i,this.parent=c}getDefault(){return null}}class Rb extends kc{setDirty(){this.dirty=!0}set(i){if(i===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const c=this.gl;c.framebufferTexture2D(c.FRAMEBUFFER,c.COLOR_ATTACHMENT0,c.TEXTURE_2D,i,0),this.current=i,this.dirty=!1}}class kb extends kc{attachment(){return this.gl.DEPTH_ATTACHMENT}set(i){if(i===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const c=this.gl;c.framebufferRenderbuffer(c.FRAMEBUFFER,this.attachment(),c.RENDERBUFFER,i),this.current=i,this.dirty=!1}}class lS extends kc{attachment(){return this.gl.DEPTH_ATTACHMENT}set(i){if(i===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const c=this.gl;c.framebufferTexture2D(c.FRAMEBUFFER,this.attachment(),c.TEXTURE_2D,i,0),this.current=i,this.dirty=!1}}class cS extends kb{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}const T_=(m,i,c)=>({u_matrix:m,u_image0:0,u_skirt_height:i,u_ground_shadow_factor:c}),em=(m,i,c,p,y,v,w,S,I,O,D,N,z,U,G,H)=>({u_proj_matrix:Float32Array.from(m),u_globe_matrix:i,u_normalize_matrix:Float32Array.from(p),u_merc_matrix:c,u_zoom_transition:y,u_merc_center:v,u_image0:0,u_frustum_tl:w,u_frustum_tr:S,u_frustum_br:I,u_frustum_bl:O,u_globe_pos:D,u_globe_radius:N,u_viewport:z,u_grid_matrix:H?Float32Array.from(H):new Float32Array(9),u_skirt_height:U,u_far_z_cutoff:G});function tm(m,i){return m!=null&&i!=null&&!(!m.hasData()||!i.hasData())&&m.demTexture!=null&&i.demTexture!=null&&m.tileID.key!==i.tileID.key}const Oc=new class{constructor(){this.operations={}}newMorphing(m,i,c,p,y){if(m in this.operations){const v=this.operations[m];v.to.tileID.key!==c.tileID.key&&(v.queued=c)}else this.operations[m]={startTime:p,phase:0,duration:y,from:i,to:c,queued:null}}getMorphValuesForProxy(m){if(!(m in this.operations))return null;const i=this.operations[m];return{from:i.from,to:i.to,phase:i.phase}}update(m){for(const i in this.operations){const c=this.operations[i];for(c.phase=(m-c.startTime)/c.duration;c.phase>=1||!this._validOp(c);)if(!this._nextOp(c,m)){delete this.operations[i];break}}}_nextOp(m,i){return!!m.queued&&(m.from=m.to,m.to=m.queued,m.queued=null,m.phase=0,m.startTime=i,!0)}_validOp(m){return m.from.hasData()&&m.to.hasData()}},S_={0:null,1:"TERRAIN_VERTEX_MORPHING"};function E_(m,i,c){if(i===0)return 0;const p=i<1&&c===514?.25/i:1;return 6*Math.pow(1.5,22-m)*Math.max(i,1)*p}function uS(m,i){const c=1<<m.z;return!i&&(m.x===0||m.x===c-1)||m.y===0||m.y===c-1}const Fu=m=>({u_matrix:m});function Bu(m,i,c,p,y){if(y>0){const v=s.o.now(),w=(v-m.timeAdded)/y,S=i?(v-i.timeAdded)/y:-1,I=c.getSource(),O=p.coveringZoomLevel({tileSize:I.tileSize,roundZoom:I.roundZoom}),D=!i||Math.abs(i.tileID.overscaledZ-O)>Math.abs(m.tileID.overscaledZ-O),N=D&&m.refreshedUponExpiration?1:s.aA(D?w:1-S,0,1);return i?{opacity:1,mix:1-N,isFading:w<1}:{opacity:N,mix:0,isFading:w<1}}return{opacity:1,mix:0,isFading:!1}}class Ob extends vs{constructor(i){const c=wc("mock-dem",{type:"raster-dem",maxzoom:i.transform.maxZoom},i.style.dispatcher,i.style);super("mock-dem",c,!1),c.setEventedParent(this),this._sourceLoaded=!0}_loadTile(i,c){i.state="loaded",c(null)}}class _a extends vs{constructor(i){const c=wc("proxy",{type:"geojson",maxzoom:i.transform.maxZoom},i.style.dispatcher,i.style);super("proxy",c,!1),c.setEventedParent(this),this.map=this.getSource().map=i,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(i,c,p){if(i.freezeTileCoverage)return;this.transform=i;const y=i.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce(((v,w)=>{if(v[w.key]="",!this._tiles[w.key]){const S=new vl(w,this._source.tileSize*w.overscaleFactor(),i.tileZoom,void 0,void 0,this._source.worldview);S.state="loaded",this._tiles[w.key]=S}return v}),{});for(const v in this._tiles)v in y||(this.freeFBO(v),this._tiles[v].unloadVectorData(),delete this._tiles[v])}freeFBO(i){const c=this.proxyCachedFBO[i];if(c!==void 0){const p=Object.values(c);this.renderCachePool.push(...p),delete this.proxyCachedFBO[i]}}deallocRenderCache(){this.renderCache.forEach((i=>i.fb.destroy())),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class nm extends s.aO{constructor(i,c,p){super(i.overscaledZ,i.wrap,i.canonical.z,i.canonical.x,i.canonical.y),this.proxyTileKey=c,this.projMatrix=p}}class Ef extends s.dH{constructor(i,c){super(),this._debugParams={sortTilesHiZFirst:!0,disableRenderCache:!1},i.tp.registerParameter(this._debugParams,["Terrain"],"sortTilesHiZFirst",{},(()=>{this._style.map.triggerRepaint()})),i.tp.registerParameter(this._debugParams,["Terrain"],"disableRenderCache",{},(()=>{this._style.map.triggerRepaint()})),i.tp.registerButton(["Terrain"],"Invalidate Render Cache",(()=>{this.invalidateRenderCache=!0,this._style.map.triggerRepaint()})),this.painter=i,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[p,y,v]=(function(I){const O=new s.bd,D=new s.b1,N=131;O.reserve(17161),D.reserve(33800);const z=s.al/128,U=s.al+z/2,G=U+z;for(let J=-z;J<G;J+=z)for(let Z=-z;Z<G;Z+=z){const ee=Z<0||Z>U||J<0||J>U?24575:0,ie=s.aA(Math.round(Z),0,s.al),se=s.aA(Math.round(J),0,s.al);O.emplaceBack(ie+ee,se)}const H=(J,Z)=>{const ee=Z*N+J;D.emplaceBack(ee+1,ee,ee+N),D.emplaceBack(ee+N,ee+N+1,ee+1)};for(let J=1;J<129;J++)for(let Z=1;Z<129;Z++)H(Z,J);return[0,129].forEach((J=>{for(let Z=0;Z<130;Z++)H(Z,J),H(J,Z)})),[O,D,32768]})(),w=i.context;this.gridBuffer=w.createVertexBuffer(p,s.bf.members),this.gridIndexBuffer=w.createIndexBuffer(y),this.gridSegments=s.bg.simpleSegment(0,0,p.length,y.length),this.gridNoSkirtSegments=s.bg.simpleSegment(0,0,p.length,v),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new _a(c.map),this.orthoMatrix=s.bC(),s.cd(this.orthoMatrix,this.painter.transform.projection.name==="globe"?.015:0,s.al,0,s.al,0,1);const S=w.gl;this._overlapStencilMode=new Tn({func:S.GEQUAL,mask:255},0,255,S.KEEP,S.KEEP,S.REPLACE),this._previousZoom=i.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=c,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new Ob(c.map),this._pendingGroundEffectLayers=[]}set style(i){i.on("data",this._onStyleDataEvent.bind(this)),this._style=i,this._style.map.on("moveend",(()=>{this._clearLineLayersFromRenderCache()}))}update(i,c,p){if(i&&i.terrain){this._style!==i&&(this.style=i,this._evaluationZoom=void 0);const y=i.terrain.properties,v=i.terrain.drapeRenderMode===0,w=i.terrain.isZoomDependent();this._previousUpdateTimestamp=this.enabled?this._updateTimestamp:void 0,this._updateTimestamp=s.o.now();const S=i.terrain&&i.terrain.scope,I=y.get("source"),O=v?this._mockSourceCache:i.getSourceCache(I,S);if(!O)return void s.w(`Couldn't find terrain source "${I}".`);if(this.sourceCache=O,this._attenuationRange=i.terrain.getAttenuationRange(),this._exaggeration=w?this.calculateExaggeration(c):y.get("exaggeration"),!c.projection.requiresDraping&&w&&this._exaggeration===0)return void this._disable();this.enabled=!0;const D=()=>{this.sourceCache.used&&s.w(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.
This leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const N=this.getScaledDemTileSize();this.sourceCache.update(c,N,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,D(),this._initializing=!0),D(),c.updateElevation(!0,p),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(c),this._emptyDEMTextureDirty=!0,this._previousZoom=c.zoom}else this._disable()}calculateExaggeration(i){if(this._attenuationRange&&i.zoom>=Math.ceil(this._attenuationRange[1]))return this._style.terrain.getExaggeration(i.zoom);const c=this._previousCameraAltitude,p=i.getFreeCameraOptions().position.z/i.pixelsPerMeter*i.worldSize;this._previousCameraAltitude=p;const y=c!=null?p-c:Number.MAX_VALUE;if(Math.abs(y)<2)return this._exaggeration;const v=i.zoom,w=this._style.terrain;if(!this._previousUpdateTimestamp)return w.getExaggeration(v);let S=v-this._previousZoom;const I=this._previousUpdateTimestamp;let O=v;this._evaluationZoom!=null&&(O=this._evaluationZoom,Math.abs(v-O)>.5&&(S=.5*(v-O+S)),S*y<0&&(O+=S)),this._evaluationZoom=O;const D=w.getExaggeration(O),N=D===w.getExaggeration(Math.max(0,O-.1));if(N&&Math.abs(D-this._exaggeration)<.01)return D;let z=Math.min(.1,.00375*(this._updateTimestamp-I));return(N||D<.1||Math.abs(S)<1e-4)&&(z=Math.min(.2,4*z)),s.ak(this._exaggeration,D,z)}resetTileLookupCache(i){this._findCoveringTileCache[i]={}}attenuationRange(){return this._attenuationRange}getDemUpscale(){return this.proxySourceCache.getSource().tileSize/128}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_onStyleDataEvent(i){i.dataType==="source"&&i.coord?this._clearRenderCacheForTile(i.sourceCacheId,i.coord):i.dataType==="style"&&(this.invalidateRenderCache=!0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this._previousCameraAltitude=void 0)}_disable(){if(this.enabled&&(this.enabled=!1,this._emptyDEMTextureDirty=!0,this._sharedDepthStencil=void 0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const i in this._style._mergedSourceCaches)this._style._mergedSourceCaches[i].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this.pool.forEach((i=>i.fb.destroy())),this.pool=[],this.framebufferCopyTexture&&this.framebufferCopyTexture.destroy()}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this.enabled?this._exaggeration:0}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const i=2*this.proxySourceCache.getSource().tileSize;return[i,i]}set useVertexMorphing(i){this._useVertexMorphing=i}updateTileBinding(i){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const c=this.proxySourceCache,p=this.painter.transform;this._initializing&&(this._initializing=p._centerAltitude===0&&this.getAtPointOrZero(s.ae.fromLngLat(p.center),-1)===-1,this._emptyDEMTextureDirty=!this._initializing);const y=this.proxyCoords=c.getIds().map((I=>{const O=c.getTileByID(I).tileID;return O.projMatrix=p.calculateProjMatrix(O.toUnwrapped()),O}));(function(I,O){const D=O.transform.pointCoordinate(O.transform.getCameraPoint()),N=new s.P(D.x,D.y);I.sort(((z,U)=>{if(U.overscaledZ-z.overscaledZ)return U.overscaledZ-z.overscaledZ;const G=new s.P(z.canonical.x+(1<<z.canonical.z)*z.wrap,z.canonical.y),H=new s.P(U.canonical.x+(1<<U.canonical.z)*U.wrap,U.canonical.y),J=N.mult(1<<z.canonical.z);return J.x-=.5,J.y-=.5,J.distSqr(G)-J.distSqr(H)}))})(y,this.painter);const v=this.proxyToSource||{};this.proxyToSource={},y.forEach((I=>{this.proxyToSource[I.key]={}})),this.terrainTileForTile={};const w=this._style._mergedSourceCaches;for(const I in w){const O=w[I];if(!O.used||(O!==this.sourceCache&&this.resetTileLookupCache(O.id),this._setupProxiedCoordsForOrtho(O,i[I],v),O.usedForTerrain))continue;const D=i[I];O.getSource().reparseOverscaled&&this._assignTerrainTiles(D)}this.proxiedCoords[c.id]=y.map((I=>new nm(I,I.key,this.orthoMatrix))),this._assignTerrainTiles(y),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(v),this.renderingToTexture=!1;const S={};this._visibleDemTiles=[];for(const I of this.proxyCoords){const O=this.terrainTileForTile[I.key];if(!O)continue;const D=O.tileID.key;D in S||(this._visibleDemTiles.push(O),S[D]=D)}}_assignTerrainTiles(i){this._initializing||i.forEach((c=>{if(this.terrainTileForTile[c.key])return;const p=this._findTileCoveringTileID(c,this.sourceCache);p&&(this.terrainTileForTile[c.key]=p)}))}_prepareDEMTextures(){const i=this.painter.context,c=i.gl;for(const p in this.terrainTileForTile){const y=this.terrainTileForTile[p],v=y.dem;!v||y.demTexture&&!y.needsDEMTextureUpload||(i.activeTexture.set(c.TEXTURE1),Wp(this.painter,y,v))}}_prepareDemTileUniforms(i,c,p,y){if(!c||c.demTexture==null)return!1;const v=i.tileID.canonical,w=Math.pow(2,c.tileID.canonical.z-v.z),S=y||"";return p[`u_dem_tl${S}`]=[v.x*w%1,v.y*w%1],p[`u_dem_scale${S}`]=w,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}_getLoadedAreaMinimum(){if(!this.enabled)return 0;let i=0;const c=this._visibleDemTiles.reduce(((p,y)=>{if(!y.dem)return p;const v=y.dem.tree.minimums[0];return v>0&&i++,p+v}),0);return i?c/i:0}_updateEmptyDEMTexture(){const i=this.painter.context,c=i.gl;i.activeTexture.set(c.TEXTURE2);const p=this._getLoadedAreaMinimum(),y=new s.dI({width:1,height:1},new Float32Array([p]));this._emptyDEMTextureDirty=!1;let v=this._emptyDEMTexture;return v?v.update(y,{premultiply:!1}):v=this._emptyDEMTexture=new s.T(i,y,c.R32F,{premultiply:!1}),v}setupElevationDraw(i,c,p){const y=this.painter.context,v=y.gl,w={u_dem:2,u_dem_prev:4,u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_depth_range_unpack:[0,1],u_occluder_half_size:16,u_occlusion_depth_offset:-1e-4,u_exaggeration:0};w.u_exaggeration=this.exaggeration();let S=null,I=null,O=1;if(p&&p.morphing&&this._useVertexMorphing){const U=p.morphing.srcDemTile,G=p.morphing.dstDemTile;O=p.morphing.phase,U&&G&&(this._prepareDemTileUniforms(i,U,w,"_prev")&&(I=U),this._prepareDemTileUniforms(i,G,w)&&(S=G))}const D=U=>U&&U.demTexture&&this.painter.linearFloatFilteringSupported()?v.LINEAR:v.NEAREST;let N=null;var z;if(this.enabled?I&&S?(N=S.demTexture,y.activeTexture.set(v.TEXTURE4),I.demTexture.bind(D(I),v.CLAMP_TO_EDGE),w.u_dem_lerp=O):(S=this.terrainTileForTile[i.tileID.key],N=this._prepareDemTileUniforms(i,S,w)?S.demTexture:this.emptyDEMTexture):N=this.emptyDEMTexture,y.activeTexture.set(v.TEXTURE2),N&&(w.u_dem_size=(z=N).size[0]===1?1:z.size[0]-2,N.bind(D(S),v.CLAMP_TO_EDGE)),this.painter.setupDepthForOcclusion(p&&p.useDepthForOcclusion,c,w),p&&p.useMeterToDem&&S){const U=(1<<S.tileID.canonical.z)*s.ce(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;w.u_meter_to_dem=U}if(p&&p.labelPlaneMatrixInv&&(w.u_label_plane_matrix_inv=p.labelPlaneMatrixInv),c.setTerrainUniformValues(y,w),this.painter.transform.projection.name==="globe"){const U=this.globeUniformValues(this.painter.transform,i.tileID.canonical,p&&p.useDenormalizedUpVectorScale);c.setGlobeUniformValues(y,U)}}globeUniformValues(i,c,p){const y=i.projection;return{u_tile_tl_up:y.upVector(c,0,0),u_tile_tr_up:y.upVector(c,s.al,0),u_tile_br_up:y.upVector(c,s.al,s.al),u_tile_bl_up:y.upVector(c,0,s.al),u_tile_up_scale:p?s.dJ(1):y.upVectorScale(c,i.center.lat,i.worldSize).metersToTile}}renderToBackBuffer(i){const c=this.painter,p=this.painter.context;i.length!==0&&(p.bindFramebuffer.set(null),p.viewport.set([0,0,c.width,c.height]),c.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,(function(y,v,w,S,I){if(y.transform.projection.name==="globe")(function(O,D,N,z,U){const G=O.context,H=G.gl;let J,Z;const ee=O.transform,ie=s.dA(O,G,ee),se=(st,We)=>{if(Z===We)return;const it=[S_[We],"PROJECTION_GLOBE_VIEW"];ie&&it.push("CUSTOM_ANTIALIASING");const Pt=O.isTileAffectedByFog(st);J=O.getOrCreateProgram("globeRaster",{defines:it,overrideFog:Pt}),Z=We},me=O.colorModeForRenderPass(),fe=new Gt(H.LEQUAL,Gt.ReadWrite,O.depthRangeFor3D);Oc.update(U);const ge=s.dB(ee),pe=[s.aF(ee.center.lng),s.aJ(ee.center.lat)],he=O.globeSharedBuffers,_e=[ee.width*s.o.devicePixelRatio,ee.height*s.o.devicePixelRatio],Ke=Float32Array.from(ee.globeMatrix),Le={useDenormalizedUpVectorScale:!0};{const st=O.transform,We=E_(st.zoom,D.exaggeration(),D.sourceCache._source.tileSize);Z=-1;const it=H.TRIANGLES;for(const Pt of z){const qe=N.getTile(Pt),Ae=Tn.disabled,at=D.prevTerrainTileForTile[Pt.key],Je=D.terrainTileForTile[Pt.key];tm(at,Je)&&Oc.newMorphing(Pt.key,at,Je,U,250),G.activeTexture.set(H.TEXTURE0),qe.texture&&qe.texture.bind(H.LINEAR,H.CLAMP_TO_EDGE);const _t=Oc.getMorphValuesForProxy(Pt.key),At=_t?1:0;_t&&Object.assign(Le,{morphing:{srcDemTile:_t.from,dstDemTile:_t.to,phase:s.dz(_t.phase)}});const Ut=s.dC(Pt.canonical),St=s.dD(Ut.getCenter().lat),bt=s.dE(Pt.canonical,Ut,St,st.worldSize/st._pixelsPerMercatorPixel),un=s.bk(s.dF(Pt.canonical)),en=em(st.expandedFarZProjMatrix,Ke,ge,un,s.aj(st.zoom),pe,st.frustumCorners.TL,st.frustumCorners.TR,st.frustumCorners.BR,st.frustumCorners.BL,st.globeCenterInViewSpace,st.globeRadius,_e,We,st._farZ,bt);if(se(Pt,At),J&&(D.setupElevationDraw(qe,J,Le),O.uploadCommonUniforms(G,J,Pt.toUnwrapped()),he)){const[an,Qt,Ln]=he.getGridBuffers(St,We!==0);J.draw(O,it,fe,Ae,me,Dn.backCCW,en,"globe_raster",an,Qt,Ln)}}}if(he&&(O.renderDefaultNorthPole||O.renderDefaultSouthPole)){const st=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];ie&&st.push("CUSTOM_ANTIALIASING"),J=O.getOrCreateProgram("globeRaster",{defines:st});for(const We of z){const{x:it,y:Pt,z:qe}=We.canonical,Ae=Pt===0,at=Pt===(1<<qe)-1,[Je,_t,At,Ut]=he.getPoleBuffers(qe,!1);if(Ut&&(Ae||at)){const St=N.getTile(We);G.activeTexture.set(H.TEXTURE0),St.texture&&St.texture.bind(H.LINEAR,H.CLAMP_TO_EDGE);let bt=s.dG(qe,it,ee);const un=s.bk(s.dF(We.canonical)),en=(an,Qt)=>an.draw(O,H.TRIANGLES,fe,Tn.disabled,me,Dn.disabled,em(ee.expandedFarZProjMatrix,bt,bt,un,0,pe,ee.frustumCorners.TL,ee.frustumCorners.TR,ee.frustumCorners.BR,ee.frustumCorners.BL,ee.globeCenterInViewSpace,ee.globeRadius,_e,0,ee._farZ),"globe_pole_raster",Qt,At,Ut);D.setupElevationDraw(St,J,Le),O.uploadCommonUniforms(G,J,We.toUnwrapped()),Ae&&O.renderDefaultNorthPole&&en(J,Je),at&&O.renderDefaultSouthPole&&(bt=s.cR(s.bC(),bt,[1,-1,1]),en(J,_t))}}}})(y,v,w,S,I);else{const O=y.context,D=O.gl;let N,z;const U=y.shadowRenderer,G=Pc(y,y.longestCutoffRange),H=me=>{if(z===me)return;const fe=[];fe.push(S_[me]),G.shouldRenderCutoff&&fe.push("RENDER_CUTOFF"),U&&(fe.push("RENDER_SHADOWS","DEPTH_TEXTURE"),U.useNormalOffset&&fe.push("NORMAL_OFFSET")),N=y.getOrCreateProgram("terrainRaster",{defines:fe}),z=me},J=y.colorModeForRenderPass(),Z=new Gt(D.LEQUAL,Gt.ReadWrite,y.depthRangeFor3D);Oc.update(I);const ee=y.transform,ie=E_(ee.zoom,v.exaggeration(),v.sourceCache._source.tileSize);let se=[0,0,0];if(U){const me=y.style.directionalLight,fe=y.style.ambientLight;me&&fe&&(se=Ja(y.style,me,fe))}{z=-1;const me=D.TRIANGLES,[fe,ge]=[v.gridIndexBuffer,v.gridSegments];for(const pe of S){const he=w.getTile(pe),_e=Tn.disabled,Ke=v.prevTerrainTileForTile[pe.key],Le=v.terrainTileForTile[pe.key];tm(Ke,Le)&&Oc.newMorphing(pe.key,Ke,Le,I,250),O.activeTexture.set(D.TEXTURE0),he.texture&&he.texture.bind(D.LINEAR,D.CLAMP_TO_EDGE);const st=Oc.getMorphValuesForProxy(pe.key),We=st?1:0;let it;st&&(it={morphing:{srcDemTile:st.from,dstDemTile:st.to,phase:s.dz(st.phase)}});const Pt=T_(pe.projMatrix,uS(pe.canonical,ee.renderWorldCopies)?ie/10:ie,se);if(H(We),!N)continue;v.setupElevationDraw(he,N,it);const qe=pe.toUnwrapped();U&&U.setupShadows(qe,N),y.uploadCommonUniforms(O,N,qe,null,G),N.draw(y,me,Z,_e,J,Dn.backCCW,Pt,"terrain_raster",v.gridBuffer,fe,ge)}}}})(c,this,this.proxySourceCache,i,this._updateTimestamp),this.renderingToTexture=!0,c.gpuTimingDeferredRenderEnd(),i.splice(0,i.length))}renderBatch(i){if(this._drapedRenderBatches.length===0)return i+1;this.renderingToTexture=!0;const c=this.painter,p=this.painter.context,y=this.proxySourceCache,v=this.proxiedCoords[y.id],w=this._drapedRenderBatches.shift(),S=c.style.order,I=[];let O=0;for(const D of v){const N=y.getTileByID(D.proxyTileKey),z=y.proxyCachedFBO[D.key]?y.proxyCachedFBO[D.key][i]:void 0,U=z!==void 0?y.renderCache[z]:this.pool[O++],G=z!==void 0;if(N.texture=U.tex,G&&!U.dirty){I.push(N.tileID);continue}let H;p.bindFramebuffer.set(U.fb.framebuffer),this.renderedToTile=!1,U.dirty&&(p.clear({color:s.ao.transparent,stencil:0}),U.dirty=!1);for(let J=w.start;J<=w.end;++J){const Z=c.style._mergedLayers[S[J]];if(Z.isHidden(c.transform.zoom))continue;const ee=c.style.getLayerSourceCache(Z),ie=ee?this.proxyToSource[D.key][ee.id]:[D];if(!ie)continue;const se=ie;p.viewport.set([0,0,U.fb.width,U.fb.height]),H!==(ee?ee.id:null)&&(this._setupStencil(U,ie,Z,ee),H=ee?ee.id:null),c.renderLayer(c,ee,Z,se)}if(this._drapedRenderBatches.length===0)for(const J of this._pendingGroundEffectLayers){const Z=c.style._mergedLayers[S[J]];if(Z.isHidden(c.transform.zoom))continue;const ee=c.style.getLayerSourceCache(Z),ie=ee?this.proxyToSource[D.key][ee.id]:[D];if(!ie)continue;const se=ie;p.viewport.set([0,0,U.fb.width,U.fb.height]),H!==(ee?ee.id:null)&&(this._setupStencil(U,ie,Z,ee),H=ee?ee.id:null),c.renderLayer(c,ee,Z,se)}this.renderedToTile?(U.dirty=!0,I.push(N.tileID)):G||--O,O===5&&(O=0,this.renderToBackBuffer(I))}return this.renderToBackBuffer(I),this.renderingToTexture=!1,p.bindFramebuffer.set(null),p.viewport.set([0,0,c.width,c.height]),w.end+1}postRender(){}isLayerOrderingCorrect(i){const c=i.order.length;let p=-1,y=c;for(let v=0;v<c;++v)this._style.isLayerDraped(i._mergedLayers[i.order[v]])?p=Math.max(p,v):y=Math.min(y,v);return y>p}getMinElevationBelowMSL(){let i=0;return this._visibleDemTiles.filter((c=>c.dem)).forEach((c=>{i=Math.min(i,c.dem.tree.minimums[0])})),i===0?i:(i-30)*this._exaggeration}raycast(i,c,p){if(!this._visibleDemTiles)return null;const y=this._visibleDemTiles.filter((v=>v.dem)).map((v=>{const w=v.tileID,S=1<<w.overscaledZ,{x:I,y:O}=w.canonical,D=I/S,N=(I+1)/S,z=O/S,U=(O+1)/S;return{minx:D,miny:z,maxx:N,maxy:U,t:v.dem.tree.raycastRoot(D,z,N,U,i,c,p),tile:v}}));y.sort(((v,w)=>(v.t!==null?v.t:Number.MAX_VALUE)-(w.t!==null?w.t:Number.MAX_VALUE)));for(const v of y){if(v.t==null)return null;const w=v.tile.dem.tree.raycast(v.minx,v.miny,v.maxx,v.maxy,i,c,p);if(w!=null)return w}return null}_createFBO(){const i=this.painter.context,c=i.gl,p=this.drapeBufferSize;i.activeTexture.set(c.TEXTURE0);const y=new s.T(i,{width:p[0],height:p[1],data:null},c.RGBA8);y.bind(c.LINEAR,c.CLAMP_TO_EDGE);const v=i.createFramebuffer(p[0],p[1],!0,null);return v.colorAttachment.set(y.texture),v.depthAttachment=new cS(i,v.framebuffer),this._sharedDepthStencil===void 0?(this._sharedDepthStencil=i.createRenderbuffer(i.gl.DEPTH_STENCIL,p[0],p[1]),this._stencilRef=0,v.depthAttachment.set(this._sharedDepthStencil),i.clear({stencil:0})):v.depthAttachment.set(this._sharedDepthStencil),i.extTextureFilterAnisotropic&&c.texParameterf(c.TEXTURE_2D,i.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,i.extTextureFilterAnisotropicMax),{fb:v,tex:y,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._debugParams.disableRenderCache||this._style.hasLightTransitions())return!0;for(const i in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[i].hasTransition())return!0;return this._style.order.some((i=>{const c=this._style._mergedLayers[i],p=c.isHidden(this.painter.transform.zoom);return c.type==="hillshade"||c.type==="custom"?!p&&c.shouldRedrape():!p&&c.hasTransition()}))}_clearLineLayersFromRenderCache(){let i=!1;for(const p of this._style.getSources())if(p instanceof Ho){i=!0;break}if(!i)return;const c={};for(let p=0;p<this._style.order.length;++p){const y=this._style._mergedLayers[this._style.order[p]],v=this._style.getLayerSourceCache(y);if(v&&!c[v.id]&&!y.isHidden(this.painter.transform.zoom)&&y.type==="line"&&y.widthExpression()instanceof s.ad){c[v.id]=!0;for(const w of this.proxyCoords){const S=this.proxyToSource[w.key][v.id];if(S)for(const I of S)this._clearRenderCacheForTile(v.id,I)}}}}_clearRasterLayersFromRenderCache(){let i=!1;for(const p in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[p]._source instanceof Hl){i=!0;break}if(!i)return;const c={};for(let p=0;p<this._style.order.length;++p){const y=this._style._mergedLayers[this._style.order[p]],v=this._style.getLayerSourceCache(y);if(!v||c[v.id]||y.isHidden(this.painter.transform.zoom)||y.type!=="raster")continue;const w=y.paint.get("raster-fade-duration");for(const S of this.proxyCoords){const I=this.proxyToSource[S.key][v.id];if(I)for(const O of I){const D=Bu(v.getTile(O),v.findLoadedParent(O,0),v,this.painter.transform,w);(D.opacity!==1||D.mix!==0)&&this._clearRenderCacheForTile(v.id,O)}}}}_setupDrapedRenderBatches(){this._style.updateDrapeFirstLayers();const i=this._style.order,c=i.length;if(c===0)return;const p=[];this._pendingGroundEffectLayers=[];let y,v=0,w=this._style._mergedLayers[i[v]];for(;!this._style.isLayerDraped(w)&&w.isHidden(this.painter.transform.zoom)&&++v<c;)w=this._style._mergedLayers[i[v]];for(;v<c;++v){const S=this._style._mergedLayers[i[v]];S.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(S)?y===void 0&&(y=v):(S.type==="fill-extrusion"&&this._pendingGroundEffectLayers.push(v),y!==void 0&&(p.push({start:y,end:v-1}),y=void 0)))}if(y!==void 0&&p.push({start:y,end:v-1}),p.length!==0){const S=p[p.length-1];this._pendingGroundEffectLayers.every((I=>I>S.end))||s.w("fill-extrusion with flood lighting and/or ground ambient occlusion should be moved to be on top of all draped layers.")}this._drapedRenderBatches=p}_setupRenderCache(i){const c=this.proxySourceCache;if(this._shouldDisableRenderCache()||this.invalidateRenderCache){if(this.invalidateRenderCache=!1,c.renderCache.length>c.renderCachePool.length){const w=Object.values(c.proxyCachedFBO);c.proxyCachedFBO={};for(let S=0;S<w.length;++S){const I=Object.values(w[S]);c.renderCachePool.push(...I)}}return}this._clearRasterLayersFromRenderCache();const p=this.proxyCoords,y=this._tilesDirty;for(let w=p.length-1;w>=0;w--){const S=p[w];if(c.getTileByID(S.key),c.proxyCachedFBO[S.key]!==void 0){const I=i[S.key],O=this.proxyToSource[S.key];let D=0;for(const N in O){const z=O[N],U=I[N];if(!U||U.length!==z.length||z.some(((G,H)=>G!==U[H]||y[N]&&y[N].hasOwnProperty(G.key)))){D=-1;break}++D}for(const N in c.proxyCachedFBO[S.key])c.renderCache[c.proxyCachedFBO[S.key][N]].dirty=D<0||D!==Object.values(I).length}}const v=[...this._drapedRenderBatches];v.sort(((w,S)=>S.end-S.start-(w.end-w.start)));for(const w of v)for(const S of p){if(c.proxyCachedFBO[S.key])continue;let I=c.renderCachePool.pop();I===void 0&&c.renderCache.length<50&&(I=c.renderCache.length,c.renderCache.push(this._createFBO())),I!==void 0&&(c.proxyCachedFBO[S.key]={},c.proxyCachedFBO[S.key][w.start]=I,c.renderCache[I].dirty=!0)}this._tilesDirty={}}_setupStencil(i,c,p,y){if(!y||!this._sourceTilesOverlap[y.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const v=this.painter.context,w=v.gl;if(c.length<=1)return void(this._overlapStencilType=!1);let S;if(p.isTileClipped())S=c.length,this._overlapStencilMode.test={func:w.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(c[0].overscaledZ>c[c.length-1].overscaledZ))return void(this._overlapStencilType=!1);S=1,this._overlapStencilMode.test={func:w.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+S>255&&(v.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=S,this._overlapStencilMode.ref=this._stencilRef,p.isTileClipped()&&this._renderTileClippingMasks(c,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return this._overlapStencilType==="Clip"||this._overlapStencilType==="Mask"}stencilModeForRTTOverlap(i){return this.renderingToTexture&&this._overlapStencilType?(this._overlapStencilType==="Clip"&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[i.key]),this._overlapStencilMode):Tn.disabled}_renderTileClippingMasks(i,c){const p=this.painter,y=this.painter.context,v=y.gl;p._tileClippingMaskIDs={},y.setColorMode(In.disabled),y.setDepthMode(Gt.disabled);const w=p.getOrCreateProgram("clippingMask");for(const S of i){const I=p._tileClippingMaskIDs[S.key]=--c;w.draw(p,v.TRIANGLES,Gt.disabled,new Tn({func:v.ALWAYS,mask:0},I,255,v.KEEP,v.KEEP,v.REPLACE),In.disabled,Dn.disabled,Fu(S.projMatrix),"$clipping",p.tileExtentBuffer,p.quadTriangleIndexBuffer,p.tileExtentSegments)}}pointCoordinate(i){const c=this.painter.transform;if(i.x<0||i.x>c.width||i.y<0||i.y>c.height)return null;const p=[i.x,i.y,1,1];s.aC(p,p,c.pixelMatrixInverse),s.cJ(p,p,1/p[3]),p[0]/=c.worldSize,p[1]/=c.worldSize;const y=c._camera.position,v=s.ce(1,c.center.lat),w=[y[0],y[1],y[2]/v,0],S=s.d9([],p.slice(0,3),w);s.aw(S,S);const I=this.raycast(w,S,this._exaggeration);return I!==null&&I?(s.bH(w,w,S,I),w[3]=w[2],w[2]*=v,w):null}_setupProxiedCoordsForOrtho(i,c,p){if(i.getSource()instanceof s.aS)return this._setupProxiedCoordsForImageSource(i,c,p);this._findCoveringTileCache[i.id]=this._findCoveringTileCache[i.id]||{};const y=this.proxiedCoords[i.id]=[],v=this.proxyCoords;for(let I=0;I<v.length;I++){const O=v[I],D=this._findTileCoveringTileID(O,i);if(D){const N=this._createProxiedId(O,D,p[O.key]&&p[O.key][i.id]);y.push(N),this.proxyToSource[O.key][i.id]=[N]}}let w=!1;const S=new Set;for(let I=0;I<c.length;I++){const O=i.getTile(c[I]);if(!O||!O.hasData())continue;const D=this._findTileCoveringTileID(O.tileID,this.proxySourceCache);if(D&&D.tileID.canonical.z!==O.tileID.canonical.z){const N=this.proxyToSource[D.tileID.key][i.id],z=this._createProxiedId(D.tileID,O,p[D.tileID.key]&&p[D.tileID.key][i.id]);N?N.splice(N.length-1,0,z):this.proxyToSource[D.tileID.key][i.id]=[z];const U=this.proxyToSource[D.tileID.key][i.id];S.has(U)||S.add(U),y.push(z),w=!0}}if(this._sourceTilesOverlap[i.id]=w,w&&this._debugParams.sortTilesHiZFirst)for(const I of S)I.sort(((O,D)=>D.overscaledZ-O.overscaledZ))}_setupProxiedCoordsForImageSource(i,c,p){if(!i.getSource().loaded())return;const y=this.proxiedCoords[i.id]=[],v=this.proxyCoords,w=i.getSource(),S=w.tileID;if(!S)return;const I=new s.P(S.x,S.y)._div(1<<S.z),O=w.coordinates.map(s.ae.fromLngLat).reduce(((N,z)=>(N.min.x=Math.min(N.min.x,z.x-I.x),N.min.y=Math.min(N.min.y,z.y-I.y),N.max.x=Math.max(N.max.x,z.x-I.x),N.max.y=Math.max(N.max.y,z.y-I.y),N)),{min:new s.P(Number.MAX_VALUE,Number.MAX_VALUE),max:new s.P(-Number.MAX_VALUE,-Number.MAX_VALUE)}),D=(N,z)=>{const U=N.wrap+N.canonical.x/(1<<N.canonical.z),G=N.canonical.y/(1<<N.canonical.z),H=s.al/(1<<N.canonical.z),J=z.wrap+z.canonical.x/(1<<z.canonical.z),Z=z.canonical.y/(1<<z.canonical.z);return U+H<J+O.min.x||U>J+O.max.x||G+H<Z+O.min.y||G>Z+O.max.y};for(let N=0;N<v.length;N++){const z=v[N];for(let U=0;U<c.length;U++){const G=i.getTile(c[U]);if(!G||!G.hasData()||D(z,G.tileID))continue;const H=this._createProxiedId(z,G,p[z.key]&&p[z.key][i.id]),J=this.proxyToSource[z.key][i.id];J?J.push(H):this.proxyToSource[z.key][i.id]=[H],y.push(H)}}}_createProxiedId(i,c,p){let y=this.orthoMatrix;if(p){const v=p.find((w=>w.key===c.tileID.key));if(v)return v}if(c.tileID.key!==i.key){const v=i.canonical.z-c.tileID.canonical.z;let w,S,I;y=s.bC();const O=c.tileID.wrap-i.wrap<<i.overscaledZ;v>0?(w=s.al>>v,S=w*((c.tileID.canonical.x<<v)-i.canonical.x+O),I=w*((c.tileID.canonical.y<<v)-i.canonical.y)):(w=s.al<<-v,S=s.al*(c.tileID.canonical.x-(i.canonical.x+O<<-v)),I=s.al*(c.tileID.canonical.y-(i.canonical.y<<-v))),s.cd(y,0,w,0,w,0,1),s.br(y,y,[S,I,0])}return new nm(c.tileID,i.key,y)}_findTileCoveringTileID(i,c){let p=c.getTile(i);if(p&&p.hasData())return p;const y=this._findCoveringTileCache[c.id],v=y[i.key];if(p=v?c.getTileByID(v):null,p&&p.hasData()||v===null)return p;let w=p?p.tileID:i,S=w.overscaledZ;const I=c.getSource().minzoom,O=[];if(!v){const N=c.getSource().maxzoom;if(i.canonical.z>=N){const z=i.canonical.z-N;c.getSource().reparseOverscaled?(S=Math.max(i.canonical.z+2,c.transform.tileZoom),w=new s.aO(S,i.wrap,N,i.canonical.x>>z,i.canonical.y>>z)):z!==0&&(S=N,w=new s.aO(S,i.wrap,N,i.canonical.x>>z,i.canonical.y>>z))}w.key!==i.key&&(O.push(w.key),p=c.getTile(w))}const D=N=>{O.forEach((z=>{y[z]=N})),O.length=0};for(S-=1;S>=I&&(!p||!p.hasData());S--){p&&D(p.tileID.key);const N=w.calculateScaledKey(S);if(p=c.getTileByID(N),p&&p.hasData())break;const z=y[N];if(z===null)break;z===void 0?O.push(N):p=c.getTileByID(z)}return D(p?p.tileID.key:null),p&&p.hasData()?p:null}findDEMTileFor(i){return this.enabled?this._findTileCoveringTileID(i,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(i,c){let p=this._tilesDirty[i];p||(p=this._tilesDirty[i]={}),p[c.key]=!0}}function rm(m,i,c){const p=(function(S,I,O){const D=s.bJ(I,S),N=s.bJ(O,[.2126,.7152,.0722]),z=(G,H,J)=>(1-J)*G+J*H,U=z(1-.3*Math.min(N,1),1,Math.min(D+1,1));return z(.92,1,Math.asin(s.aA(I[2],-1,1))/Math.PI+.5)*U})(m,[0,0,1],i),y=[0,0,0];s.c4(y,c.slice(0,3),p);const v=[0,0,0];s.c4(v,i.slice(0,3),m[2]);const w=[0,0,0];return s.d7(w,y,v),s.da(w)}const C_=["fill","fillOutline","fillPattern","line","linePattern","background","backgroundPattern","hillshade","raster"],I_=["stars","rainParticle","snowParticle","fillExtrusion","fillExtrusionGroundEffect","elevatedStructures","model","symbol"];class im{static cacheKey(i,c,p,y){let v=`${c}${y?y.cacheKey:""}`;for(const w of p)i.usedDefines.includes(w)&&(v+=`/${w}`);return v}constructor(i,c,p,y,v,w){const S=i.gl;this.program=S.createProgram(),this.configuration=y,this.name=c,this.fixedDefines=[...w];let I=y?y.defines():[];I=I.concat(w.map((G=>`#define ${G}`)));const O=`#version 300 es
`;let D=O+I.concat("precision mediump float;",Tl,Tf.fragmentSource).join(`
`);for(const G of p.fragmentIncludes)D+=`
${jd[G]}`;D+=`
${p.fragmentSource}`;let N=O+I.concat("precision highp float;",Tl,Tf.vertexSource).join(`
`);for(const G of p.vertexIncludes)N+=`
${jd[G]}`;this.forceManualRenderingForInstanceIDShaders=i.forceManualRenderingForInstanceIDShaders&&p.vertexSource.indexOf("gl_InstanceID")!==-1,this.forceManualRenderingForInstanceIDShaders&&(N+=`
uniform int u_instanceID;
`),N+=`
${p.vertexSource}`,this.forceManualRenderingForInstanceIDShaders&&(N=N.replaceAll("gl_InstanceID","u_instanceID"));const z=S.createShader(S.FRAGMENT_SHADER);if(S.isContextLost())return void(this.failedToCreate=!0);S.shaderSource(z,D),S.compileShader(z),S.attachShader(this.program,z);const U=S.createShader(S.VERTEX_SHADER);S.isContextLost()?this.failedToCreate=!0:(S.shaderSource(U,N),S.compileShader(U),S.attachShader(this.program,U),this.attributes={},S.linkProgram(this.program),S.deleteShader(U),S.deleteShader(z),this.fixedUniforms=v(i),this.binderUniforms=y?y.getUniforms(i):[],this.forceManualRenderingForInstanceIDShaders&&(this.instancingUniforms=(G=>({u_instanceID:new s.cg(G)}))(i)),(w.includes("TERRAIN")||c.indexOf("symbol")!==-1||c.indexOf("circle")!==-1)&&(this.terrainUniforms=(G=>({u_dem:new s.cg(G),u_dem_prev:new s.cg(G),u_dem_tl:new s.cj(G),u_dem_scale:new s.ci(G),u_dem_tl_prev:new s.cj(G),u_dem_scale_prev:new s.ci(G),u_dem_size:new s.ci(G),u_dem_lerp:new s.ci(G),u_exaggeration:new s.ci(G),u_depth:new s.cg(G),u_depth_size_inv:new s.cj(G),u_depth_range_unpack:new s.cj(G),u_occluder_half_size:new s.ci(G),u_occlusion_depth_offset:new s.ci(G),u_meter_to_dem:new s.ci(G),u_label_plane_matrix_inv:new s.ck(G)}))(i)),w.includes("GLOBE")&&(this.globeUniforms=(G=>({u_tile_tl_up:new s.ch(G),u_tile_tr_up:new s.ch(G),u_tile_br_up:new s.ch(G),u_tile_bl_up:new s.ch(G),u_tile_up_scale:new s.ci(G)}))(i)),w.includes("FOG")&&(this.fogUniforms=(G=>({u_fog_matrix:new s.ck(G),u_fog_range:new s.cj(G),u_fog_color:new s.d2(G),u_fog_horizon_blend:new s.ci(G),u_fog_vertical_limit:new s.cj(G),u_fog_temporal_offset:new s.ci(G),u_frustum_tl:new s.ch(G),u_frustum_tr:new s.ch(G),u_frustum_br:new s.ch(G),u_frustum_bl:new s.ch(G),u_globe_pos:new s.ch(G),u_globe_radius:new s.ci(G),u_globe_transition:new s.ci(G),u_is_globe:new s.cg(G),u_viewport:new s.cj(G)}))(i)),w.includes("RENDER_CUTOFF")&&(this.cutoffUniforms=(G=>({u_cutoff_params:new s.d2(G)}))(i)),w.includes("LIGHTING_3D_MODE")&&(this.lightsUniforms=(G=>({u_lighting_ambient_color:new s.ch(G),u_lighting_directional_dir:new s.ch(G),u_lighting_directional_color:new s.ch(G),u_ground_radiance:new s.ch(G)}))(i)),w.includes("RENDER_SHADOWS")&&(this.shadowUniforms=(G=>({u_light_matrix_0:new s.ck(G),u_light_matrix_1:new s.ck(G),u_fade_range:new s.cj(G),u_shadow_normal_offset:new s.ch(G),u_shadow_intensity:new s.ci(G),u_shadow_texel_size:new s.ci(G),u_shadow_map_resolution:new s.ci(G),u_shadow_direction:new s.ch(G),u_shadow_bias:new s.ch(G),u_shadowmap_0:new s.cg(G),u_shadowmap_1:new s.cg(G)}))(i)))}getAttributeLocation(i,c){let p=this.attributes[c];return p===void 0&&(p=this.attributes[c]=i.getAttribLocation(this.program,c)),p}setTerrainUniformValues(i,c){if(!this.terrainUniforms)return;const p=this.terrainUniforms;if(!this.failedToCreate){i.program.set(this.program);for(const y in c)p[y]&&p[y].set(this.program,y,c[y])}}setGlobeUniformValues(i,c){if(!this.globeUniforms)return;const p=this.globeUniforms;if(!this.failedToCreate){i.program.set(this.program);for(const y in c)p[y]&&p[y].set(this.program,y,c[y])}}setFogUniformValues(i,c){if(!this.fogUniforms)return;const p=this.fogUniforms;if(!this.failedToCreate){i.program.set(this.program);for(const y in c)p[y].set(this.program,y,c[y])}}setCutoffUniformValues(i,c){if(!this.cutoffUniforms)return;const p=this.cutoffUniforms;if(!this.failedToCreate){i.program.set(this.program);for(const y in c)p[y].set(this.program,y,c[y])}}setLightsUniformValues(i,c){if(!this.lightsUniforms)return;const p=this.lightsUniforms;if(!this.failedToCreate){i.program.set(this.program);for(const y in c)p[y].set(this.program,y,c[y])}}setShadowUniformValues(i,c){if(this.failedToCreate||!this.shadowUniforms)return;const p=this.shadowUniforms;i.program.set(this.program);for(const y in c)p[y].set(this.program,y,c[y])}_drawDebugWireframe(i,c,p,y,v,w,S,I,O,D){const N=i.options.wireframe;if(N.terrain===!1&&N.layers2D===!1&&N.layers3D===!1)return;const z=i.context;if(!(!(!N.terrain||this.name!=="terrainRaster"&&this.name!=="globeRaster")||!(!N.layers2D||i._terrain&&i._terrain.renderingToTexture||!C_.includes(this.name))||!(!N.layers3D||!I_.includes(this.name))))return;const U=z.gl,G=i.wireframeDebugCache.getLinesFromTrianglesBuffer(i.frameCounter,v,z);if(!G)return;const H=[...this.fixedDefines];H.push("DEBUG_WIREFRAME");const J=i.getOrCreateProgram(this.name,{config:this.configuration,defines:H});z.program.set(J.program);const Z=(se,me,fe)=>{if(me[se]&&fe[se])for(const ge in me[se])fe[se][ge]&&fe[se][ge].set(fe.program,ge,me[se][ge].current)};O&&O.setUniforms(J.program,z,J.binderUniforms,S,{zoom:I}),Z("fixedUniforms",this,J),Z("terrainUniforms",this,J),Z("globeUniforms",this,J),Z("fogUniforms",this,J),Z("lightsUniforms",this,J),Z("shadowUniforms",this,J),G.bind(),z.setColorMode(new In([U.ONE,U.ONE_MINUS_SRC_ALPHA,U.ZERO,U.ONE],s.ao.transparent,[!0,!0,!0,!1])),z.setDepthMode(new Gt(c.func===U.LESS?U.LEQUAL:c.func,Gt.ReadOnly,c.range)),z.setStencilMode(Tn.disabled);const ee=3*w.primitiveLength*2,ie=3*w.primitiveOffset*2*2;if(this.forceManualRenderingForInstanceIDShaders){const se=D||1;for(let me=0;me<se;++me)J.instancingUniforms.u_instanceID.set(this.program,"u_instanceID",me),U.drawElements(U.LINES,ee,U.UNSIGNED_SHORT,ie)}else D&&D>1?U.drawElementsInstanced(U.LINES,ee,U.UNSIGNED_SHORT,ie,D):U.drawElements(U.LINES,ee,U.UNSIGNED_SHORT,ie);v.bind(),z.program.set(this.program),z.setDepthMode(c),z.setStencilMode(p),z.setColorMode(y)}checkUniforms(i,c,p){if(this.fixedDefines.includes(c)){for(const y of Object.keys(p))if(!p[y].initialized)throw new Error(`Program '${this.name}', from draw '${i}': uniform ${y} not set but required by ${c} being defined`)}}draw(i,c,p,y,v,w,S,I,O,D,N,z,U,G,H,J){const Z=i.context,ee=Z.gl;if(this.failedToCreate)return;Z.program.set(this.program),Z.setDepthMode(p),Z.setStencilMode(y),Z.setColorMode(v),Z.setCullFace(w);for(const me of Object.keys(this.fixedUniforms))this.fixedUniforms[me].set(this.program,me,S[me]);G&&G.setUniforms(this.program,Z,this.binderUniforms,z,{zoom:U});const ie={[ee.POINTS]:1,[ee.LINES]:2,[ee.TRIANGLES]:3,[ee.LINE_STRIP]:1}[c];this.checkUniforms(I,"RENDER_SHADOWS",this.shadowUniforms);const se=J&&J>0?1:void 0;for(const me of N.get()){const fe=me.vaos||(me.vaos={});if((fe[I]||(fe[I]=new Gd)).bind(Z,this,O,G?G.getPaintVertexBuffers():[],D,me.vertexOffset,H||[],se),this.forceManualRenderingForInstanceIDShaders){const ge=J||1;for(let pe=0;pe<ge;++pe)this.instancingUniforms.u_instanceID.set(this.program,"u_instanceID",pe),D?ee.drawElements(c,me.primitiveLength*ie,ee.UNSIGNED_SHORT,me.primitiveOffset*ie*2):ee.drawArrays(c,me.vertexOffset,me.vertexLength)}else J&&J>1?ee.drawElementsInstanced(c,me.primitiveLength*ie,ee.UNSIGNED_SHORT,me.primitiveOffset*ie*2,J):D?ee.drawElements(c,me.primitiveLength*ie,ee.UNSIGNED_SHORT,me.primitiveOffset*ie*2):ee.drawArrays(c,me.vertexOffset,me.vertexLength);c===ee.TRIANGLES&&D&&this._drawDebugWireframe(i,p,y,v,D,me,z,U,G,J)}}}function Cf(m,i,c=0){const p=Math.pow(2,i.tileID.overscaledZ),y=i.tileSize*Math.pow(2,m.transform.tileZoom)/p,v=y*(i.tileID.canonical.x+i.tileID.wrap*p),w=y*i.tileID.canonical.y;return{u_image:0,u_texsize:i.imageAtlasTexture?i.imageAtlasTexture.size:[0,0],u_tile_units_to_pixels:1/s.ay(i,1,m.transform.tileZoom),u_pixel_coord_upper:[v>>16,w>>16],u_pixel_coord_lower:[65535&v,65535&w],u_pattern_transition:c}}const Kd={terrain:0,flat:1},A_=s.bC(),If=(m,i,c,p,y,v,w,S,I,O,D,N,z,U,G,H,J,Z)=>{const ee=i.style.light,ie=ee.properties.get("position"),se=[ie.x,ie.y,ie.z],me=s.dL();ee.properties.get("anchor")==="viewport"&&(s.dM(me,-i.transform.angle),s.dN(se,se,me));const fe=ee.properties.get("color").toPremultipliedRenderColor(null),ge=i.transform,pe={u_matrix:m,u_lightpos:se,u_lightintensity:ee.properties.get("intensity"),u_lightcolor:[fe.r,fe.g,fe.b],u_vertical_gradient:+c,u_opacity:p,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:A_,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_height_type:Kd[O],u_base_type:Kd[D],u_ao:y,u_edge_radius:v,u_width_scale:w,u_flood_light_color:G,u_vertical_scale:H,u_flood_light_intensity:J,u_ground_shadow_factor:Z};return ge.projection.name==="globe"&&(pe.u_tile_id=[S.canonical.x,S.canonical.y,1<<S.canonical.z],pe.u_zoom_transition=N,pe.u_inv_rot_matrix=U,pe.u_merc_center=z,pe.u_up_dir=ge.projection.upVector(new s.cC(0,0,0),z[0]*s.al,z[1]*s.al),pe.u_height_lift=I),pe},P_=(m,i,c,p,y,v)=>({u_matrix:m,u_edge_radius:i,u_width_scale:c,u_vertical_scale:p,u_height_type:Kd[y],u_base_type:Kd[v]}),Mb=(m,i,c,p,y,v,w,S,I,O,D,N,z,U,G,H,J,Z)=>{const ee=If(m,i,c,p,y,v,w,S,O,D,N,z,U,G,H,J,1,[0,0,0]),ie={u_height_factor:-Math.pow(2,S.overscaledZ)/I.tileSize/8};return Object.assign(ee,Cf(i,I,Z),ie)},R_=(m,i,c)=>({u_matrix:m,u_emissive_strength:i,u_ground_shadow_factor:c}),Nu=(m,i,c,p,y,v=0)=>Object.assign(R_(m,i,y),Cf(c,p,v)),dS=(m,i,c,p)=>({u_matrix:m,u_world:c,u_emissive_strength:i,u_ground_shadow_factor:p}),hS=(m,i,c,p,y,v,w=0)=>Object.assign(Nu(m,i,c,p,v,w),{u_world:y}),fS=(m,i)=>({u_matrix:m,u_ground_shadow_factor:i}),om=(m,i,c,p,y)=>({u_matrix:m,u_camera_pos:[i[0],i[1],i[2]],u_depth_bias:c,u_height_scale:p,u_reset_depth:y}),pS=(m,i,c,p,y,v,w)=>({u_matrix:m,u_normal_matrix:i,u_opacity:c,u_faux_facade_ao_intensity:p,u_camera_pos:y,u_tile_to_meter:v,u_facade_emissive_chance:w}),mS=m=>({u_matrix:m}),k_=m=>({u_matrix:m}),O_=(m,i,c,p,y,v,w,S)=>{const I=s.al/v.tileSize;return{u_matrix:m,u_inv_rot_matrix:i,u_camera_to_center_distance:c.getCameraToCenterDistance(S),u_extrude_scale:[c.pixelsToGLUnits[0]/I,c.pixelsToGLUnits[1]/I],u_zoom_transition:p,u_tile_id:w,u_merc_center:y}},M_=(m,i,c=1)=>({u_matrix:m,u_color:i,u_overlay:0,u_overlay_scale:c}),Zd=s.bC(),Db=(m,i,c,p,y,v,w)=>{const S=m.transform,I=S.projection.name==="globe",O=I?s.dO(S.zoom,i.canonical)*S._pixelsPerMercatorPixel:s.ay(c,1,v),D={u_matrix:i.projMatrix,u_extrude_scale:O,u_intensity:w,u_inv_rot_matrix:Zd,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(I){D.u_inv_rot_matrix=p,D.u_merc_center=y,D.u_tile_id=[i.canonical.x,i.canonical.y,1<<i.canonical.z],D.u_zoom_transition=s.aj(S.zoom);const N=y[0]*s.al,z=y[1]*s.al;D.u_up_dir=S.projection.upVector(new s.cC(0,0,0),N,z)}return D};function D_(m,[i,c,p,y],[v,w]){if(v===w)return[0,0,0,0];const S=255*(m-1)/(m*(w-v));return[i*S,c*S,p*S,y*S]}function L_(m,i,[c,p]){return c===p?0:.5/m+(i-c)*(m-1)/(m*(p-c))}const sm=(m,i,c,p,y,v,w,S,I,O,D,N,z,U,G,H,J,Z,ee,ie,se)=>({u_matrix:m,u_normalize_matrix:i,u_globe_matrix:c,u_merc_matrix:p,u_grid_matrix:y,u_tl_parent:v,u_scale_parent:O,u_fade_t:D.mix,u_opacity:D.opacity*N.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:N.paint.get("raster-brightness-min"),u_brightness_high:N.paint.get("raster-brightness-max"),u_saturation_factor:s.dQ(N.paint.get("raster-saturation")),u_contrast_factor:s.dP(N.paint.get("raster-contrast")),u_spin_weights:Vu(N.paint.get("raster-hue-rotate")),u_perspective_transform:z,u_raster_elevation:U,u_zoom_transition:w,u_merc_center:S,u_cutoff_params:I,u_colorization_mix:D_(s.dR,H,Z),u_colorization_offset:L_(s.dR,J,Z),u_color_ramp:G,u_texture_offset:[ie/(ee+2*ie),ee/(ee+2*ie)],u_texture_res:[ee+2*ie,ee+2*ie],u_emissive_strength:se});function Vu(m){m*=Math.PI/180;const i=Math.sin(m),c=Math.cos(m);return[(2*c+1)/3,(-Math.sqrt(3)*i-c+1)/3,(Math.sqrt(3)*i-c+1)/3]}const $u=.05,Mc=(m,i,c,p,y,v,w,S,I,O,D,N)=>({u_matrix:m,u_normalize_matrix:i,u_globe_matrix:c,u_merc_matrix:p,u_grid_matrix:y,u_tl_parent:v,u_scale_parent:O,u_fade_t:D.mix,u_opacity:D.opacity,u_image0:0,u_image1:1,u_raster_elevation:N,u_zoom_transition:w,u_merc_center:S,u_cutoff_params:I}),z_=(m,i,c,p,y,v,w,S,I,O)=>({u_particle_texture:m,u_particle_texture_side_len:i,u_tile_offset:c,u_velocity:p,u_color_ramp:v,u_velocity_res:y,u_max_speed:w,u_uv_offset:S,u_data_scale:[255*I[0],255*I[1]],u_data_offset:O,u_particle_pos_scale:1.1,u_particle_pos_offset:[$u,$u]}),am=(m,i,c,p,y,v,w,S,I,O)=>({u_particle_texture:m,u_particle_texture_side_len:i,u_velocity:c,u_velocity_res:p,u_max_speed:y,u_speed_factor:v,u_reset_rate:w,u_rand_seed:Math.random(),u_uv_offset:S,u_data_scale:[255*I[0],255*I[1]],u_data_offset:O,u_particle_pos_scale:1.1,u_particle_pos_offset:[$u,$u]}),F_=s.bC(),B_=(m,i,c,p,y,v,w,S,I,O,D,N,z,U,G,H,J,Z,ee,ie,se,me,fe,ge)=>{const pe=y.transform,he={u_is_size_zoom_constant:+(m==="constant"||m==="source"),u_is_size_feature_constant:+(m==="constant"||m==="camera"),u_size_t:i?i.uSizeT:0,u_size:i?i.uSize:0,u_camera_to_center_distance:pe.getCameraToCenterDistance(ee),u_rotate_symbol:+c,u_aspect_ratio:pe.width/pe.height,u_fade_change:y.options.fadeDuration?y.symbolFadeChange:1,u_matrix:v,u_label_plane_matrix:w,u_coord_matrix:S,u_is_text:+O,u_elevation_from_sea:I?1:0,u_pitch_with_map:+p,u_texsize:D,u_texsize_icon:N,u_texture:0,u_texture_icon:1,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:F_,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:F_,u_up_vector:[0,-1,0],u_color_adj_mat:me,u_icon_transition:fe||0,u_gamma_scale:p?y.transform.getCameraToCenterDistance(ee)*Math.cos(y.terrain?0:y.transform._pitch):1,u_device_pixel_ratio:s.o.devicePixelRatio,u_is_halo:1,u_scale_factor:ge||1,u_ground_shadow_factor:ie,u_inv_matrix:s.bl(s.bC(),w),u_normal_scale:se,u_lutTexture:_o.LUT};return ee.name==="globe"&&(he.u_tile_id=[U.canonical.x,U.canonical.y,1<<U.canonical.z],he.u_zoom_transition=G,he.u_inv_rot_matrix=J,he.u_merc_center=H,he.u_camera_forward=pe._camera.forward(),he.u_ecef_origin=s.dS(pe.globeMatrix,U.toUnwrapped()),he.u_tile_matrix=Float32Array.from(pe.globeMatrix),he.u_up_vector=Z),he},lm=(m,i,c,p)=>({u_matrix:m,u_emissive_strength:i,u_opacity:c,u_color:p}),cm=(m,i,c,p,y,v,w,S,I)=>Object.assign((function(O,D,N,z,U,G){const{width:H,height:J}=z.imageManager.getPixelSize(D),Z=Math.pow(2,G.tileID.overscaledZ),ee=G.tileSize*Math.pow(2,z.transform.tileZoom)/Z,ie=ee*(G.tileID.canonical.x+G.tileID.wrap*Z),se=ee*G.tileID.canonical.y;return{u_image:0,u_pattern_tl:N.tl,u_pattern_br:N.br,u_texsize:[H,J],u_pattern_size:N.displaySize,u_pattern_units_to_pixels:U?[z.transform.width,-1*z.transform.height]:[1/s.ay(G,1,z.transform.tileZoom),1/s.ay(G,1,z.transform.tileZoom)],u_pixel_coord_upper:[ie>>16,se>>16],u_pixel_coord_lower:[65535&ie,65535&se]}})(0,v,w,p,S,I),{u_matrix:m,u_emissive_strength:i,u_opacity:c}),N_=new Float32Array(s.bA([])),um=(m,i,c,p,y,v,w,S,I,O,D,N,z,U=[0,0,0],G)=>{const H=y.style.light,J=H.properties.get("position"),Z=[-J.x,-J.y,J.z],ee=s.dL();H.properties.get("anchor")==="viewport"&&(s.dM(ee,-y.transform.angle),s.dN(Z,Z,ee));const ie=D.alphaMode==="MASK",se=H.properties.get("color").toNonPremultipliedRenderColor(null),me=z.paint.get("model-ambient-occlusion-intensity"),fe=z.paint.get("model-color").constantOr(s.ao.white).toNonPremultipliedRenderColor(null);return fe.a=z.paint.get("model-color-mix-intensity").constantOr(0),{u_matrix:m,u_lighting_matrix:i,u_normal_matrix:c,u_node_matrix:p||N_,u_lightpos:Z,u_lightintensity:H.properties.get("intensity"),u_lightcolor:[se.r,se.g,se.b],u_camera_pos:U,u_opacity:v,u_baseTextureIsAlpha:0,u_alphaMask:+ie,u_alphaCutoff:D.alphaCutoff,u_baseColorFactor:w.toNonPremultipliedRenderColor(null).toArray01(),u_emissiveFactor:S.toNonPremultipliedRenderColor(null).toArray01(),u_metallicFactor:I,u_roughnessFactor:O,u_baseColorTexture:_o.BaseColor,u_metallicRoughnessTexture:_o.MetallicRoughness,u_normalTexture:_o.Normal,u_occlusionTexture:_o.Occlusion,u_emissionTexture:_o.Emission,u_lutTexture:_o.LUT,u_color_mix:fe.toArray01(),u_aoIntensity:me,u_emissive_strength:N,u_occlusionTextureTransform:G||[0,0,0,0]}},Xd=(m,i=N_,c=N_)=>({u_matrix:m,u_instance:i,u_node_matrix:c}),gS={fillExtrusion:m=>({u_matrix:new s.ck(m),u_lightpos:new s.ch(m),u_lightintensity:new s.ci(m),u_lightcolor:new s.ch(m),u_vertical_gradient:new s.ci(m),u_opacity:new s.ci(m),u_edge_radius:new s.ci(m),u_width_scale:new s.ci(m),u_ao:new s.cj(m),u_height_type:new s.cg(m),u_base_type:new s.cg(m),u_tile_id:new s.ch(m),u_zoom_transition:new s.ci(m),u_inv_rot_matrix:new s.ck(m),u_merc_center:new s.cj(m),u_up_dir:new s.ch(m),u_height_lift:new s.ci(m),u_flood_light_color:new s.ch(m),u_vertical_scale:new s.ci(m),u_flood_light_intensity:new s.ci(m),u_ground_shadow_factor:new s.ch(m)}),fillExtrusionDepth:m=>({u_matrix:new s.ck(m),u_edge_radius:new s.ci(m),u_width_scale:new s.ci(m),u_vertical_scale:new s.ci(m),u_height_type:new s.cg(m),u_base_type:new s.cg(m)}),fillExtrusionPattern:m=>({u_matrix:new s.ck(m),u_lightpos:new s.ch(m),u_lightintensity:new s.ci(m),u_lightcolor:new s.ch(m),u_vertical_gradient:new s.ci(m),u_height_factor:new s.ci(m),u_edge_radius:new s.ci(m),u_width_scale:new s.ci(m),u_ao:new s.cj(m),u_height_type:new s.cg(m),u_base_type:new s.cg(m),u_tile_id:new s.ch(m),u_zoom_transition:new s.ci(m),u_inv_rot_matrix:new s.ck(m),u_merc_center:new s.cj(m),u_up_dir:new s.ch(m),u_height_lift:new s.ci(m),u_image:new s.cg(m),u_texsize:new s.cj(m),u_pixel_coord_upper:new s.cj(m),u_pixel_coord_lower:new s.cj(m),u_tile_units_to_pixels:new s.ci(m),u_opacity:new s.ci(m),u_pattern_transition:new s.ci(m)}),fillExtrusionGroundEffect:m=>({u_matrix:new s.ck(m),u_opacity:new s.ci(m),u_ao_pass:new s.ci(m),u_meter_to_tile:new s.ci(m),u_ao:new s.cj(m),u_flood_light_intensity:new s.ci(m),u_flood_light_color:new s.ch(m),u_attenuation:new s.ci(m),u_edge_radius:new s.ci(m),u_fb:new s.cg(m),u_fb_size:new s.ci(m),u_dynamic_offset:new s.ci(m)}),fill:m=>({u_matrix:new s.ck(m),u_emissive_strength:new s.ci(m),u_ground_shadow_factor:new s.ch(m)}),fillPattern:m=>({u_matrix:new s.ck(m),u_emissive_strength:new s.ci(m),u_image:new s.cg(m),u_texsize:new s.cj(m),u_pixel_coord_upper:new s.cj(m),u_pixel_coord_lower:new s.cj(m),u_tile_units_to_pixels:new s.ci(m),u_ground_shadow_factor:new s.ch(m),u_pattern_transition:new s.ci(m)}),fillOutline:m=>({u_matrix:new s.ck(m),u_emissive_strength:new s.ci(m),u_world:new s.cj(m),u_ground_shadow_factor:new s.ch(m)}),fillOutlinePattern:m=>({u_matrix:new s.ck(m),u_emissive_strength:new s.ci(m),u_world:new s.cj(m),u_image:new s.cg(m),u_texsize:new s.cj(m),u_pixel_coord_upper:new s.cj(m),u_pixel_coord_lower:new s.cj(m),u_tile_units_to_pixels:new s.ci(m),u_ground_shadow_factor:new s.ch(m),u_pattern_transition:new s.ci(m)}),building:m=>({u_matrix:new s.ck(m),u_normal_matrix:new s.ck(m),u_opacity:new s.ci(m),u_faux_facade_ao_intensity:new s.ci(m),u_camera_pos:new s.ch(m),u_tile_to_meter:new s.ci(m),u_facade_emissive_chance:new s.ci(m)}),buildingBloom:m=>({u_matrix:new s.ck(m)}),buildingDepth:m=>({u_matrix:new s.ck(m)}),elevatedStructuresDepth:m=>({u_matrix:new s.ck(m),u_depth_bias:new s.ci(m)}),elevatedStructures:m=>({u_matrix:new s.ck(m),u_ground_shadow_factor:new s.ch(m)}),elevatedStructuresDepthReconstruct:m=>({u_matrix:new s.ck(m),u_camera_pos:new s.ch(m),u_depth_bias:new s.ci(m),u_height_scale:new s.ci(m),u_reset_depth:new s.ci(m)}),circle:s.dV,collisionBox:m=>({u_matrix:new s.ck(m),u_inv_rot_matrix:new s.ck(m),u_camera_to_center_distance:new s.ci(m),u_extrude_scale:new s.cj(m),u_zoom_transition:new s.ci(m),u_merc_center:new s.cj(m),u_tile_id:new s.ch(m)}),collisionCircle:m=>({u_matrix:new s.ck(m),u_inv_matrix:new s.ck(m),u_camera_to_center_distance:new s.ci(m),u_viewport_size:new s.cj(m)}),debug:m=>({u_color:new s.dx(m),u_matrix:new s.ck(m),u_overlay:new s.cg(m),u_overlay_scale:new s.ci(m)}),clippingMask:m=>({u_matrix:new s.ck(m)}),heatmap:m=>({u_extrude_scale:new s.ci(m),u_intensity:new s.ci(m),u_matrix:new s.ck(m),u_inv_rot_matrix:new s.ck(m),u_merc_center:new s.cj(m),u_tile_id:new s.ch(m),u_zoom_transition:new s.ci(m),u_up_dir:new s.ch(m)}),heatmapTexture:m=>({u_image:new s.cg(m),u_color_ramp:new s.cg(m),u_opacity:new s.ci(m)}),hillshade:m=>({u_matrix:new s.ck(m),u_image:new s.cg(m),u_latrange:new s.cj(m),u_light:new s.cj(m),u_shadow:new s.dx(m),u_highlight:new s.dx(m),u_emissive_strength:new s.ci(m),u_accent:new s.dx(m)}),hillshadePrepare:m=>({u_matrix:new s.ck(m),u_image:new s.cg(m),u_dimension:new s.cj(m),u_zoom:new s.ci(m)}),line:s.dU,linePattern:s.dT,raster:m=>({u_matrix:new s.ck(m),u_normalize_matrix:new s.ck(m),u_globe_matrix:new s.ck(m),u_merc_matrix:new s.ck(m),u_grid_matrix:new s.dy(m),u_tl_parent:new s.cj(m),u_scale_parent:new s.ci(m),u_fade_t:new s.ci(m),u_opacity:new s.ci(m),u_image0:new s.cg(m),u_image1:new s.cg(m),u_brightness_low:new s.ci(m),u_brightness_high:new s.ci(m),u_saturation_factor:new s.ci(m),u_contrast_factor:new s.ci(m),u_spin_weights:new s.ch(m),u_perspective_transform:new s.cj(m),u_raster_elevation:new s.ci(m),u_zoom_transition:new s.ci(m),u_merc_center:new s.cj(m),u_cutoff_params:new s.d2(m),u_colorization_mix:new s.d2(m),u_colorization_offset:new s.ci(m),u_color_ramp:new s.cg(m),u_texture_offset:new s.cj(m),u_texture_res:new s.cj(m),u_emissive_strength:new s.ci(m)}),rasterParticle:m=>({u_matrix:new s.ck(m),u_normalize_matrix:new s.ck(m),u_globe_matrix:new s.ck(m),u_merc_matrix:new s.ck(m),u_grid_matrix:new s.dy(m),u_tl_parent:new s.cj(m),u_scale_parent:new s.ci(m),u_fade_t:new s.ci(m),u_opacity:new s.ci(m),u_image0:new s.cg(m),u_image1:new s.cg(m),u_raster_elevation:new s.ci(m),u_zoom_transition:new s.ci(m),u_merc_center:new s.cj(m),u_cutoff_params:new s.d2(m)}),rasterParticleTexture:m=>({u_texture:new s.cg(m),u_opacity:new s.ci(m)}),rasterParticleDraw:m=>({u_particle_texture:new s.cg(m),u_particle_texture_side_len:new s.ci(m),u_tile_offset:new s.cj(m),u_velocity:new s.cg(m),u_color_ramp:new s.cg(m),u_velocity_res:new s.cj(m),u_max_speed:new s.ci(m),u_uv_offset:new s.cj(m),u_data_scale:new s.cj(m),u_data_offset:new s.ci(m),u_particle_pos_scale:new s.ci(m),u_particle_pos_offset:new s.cj(m)}),rasterParticleUpdate:m=>({u_particle_texture:new s.cg(m),u_particle_texture_side_len:new s.ci(m),u_velocity:new s.cg(m),u_velocity_res:new s.cj(m),u_max_speed:new s.ci(m),u_speed_factor:new s.ci(m),u_reset_rate:new s.ci(m),u_rand_seed:new s.ci(m),u_uv_offset:new s.cj(m),u_data_scale:new s.cj(m),u_data_offset:new s.ci(m),u_particle_pos_scale:new s.ci(m),u_particle_pos_offset:new s.cj(m)}),symbol:m=>({u_is_size_zoom_constant:new s.cg(m),u_is_size_feature_constant:new s.cg(m),u_size_t:new s.ci(m),u_size:new s.ci(m),u_camera_to_center_distance:new s.ci(m),u_rotate_symbol:new s.cg(m),u_aspect_ratio:new s.ci(m),u_fade_change:new s.ci(m),u_matrix:new s.ck(m),u_label_plane_matrix:new s.ck(m),u_coord_matrix:new s.ck(m),u_is_text:new s.cg(m),u_elevation_from_sea:new s.cg(m),u_pitch_with_map:new s.cg(m),u_texsize:new s.cj(m),u_texsize_icon:new s.cj(m),u_texture:new s.cg(m),u_texture_icon:new s.cg(m),u_gamma_scale:new s.ci(m),u_device_pixel_ratio:new s.ci(m),u_tile_id:new s.ch(m),u_zoom_transition:new s.ci(m),u_inv_rot_matrix:new s.ck(m),u_merc_center:new s.cj(m),u_camera_forward:new s.ch(m),u_tile_matrix:new s.ck(m),u_up_vector:new s.ch(m),u_ecef_origin:new s.ch(m),u_is_halo:new s.cg(m),u_icon_transition:new s.ci(m),u_color_adj_mat:new s.ck(m),u_scale_factor:new s.ci(m),u_ground_shadow_factor:new s.ch(m),u_inv_matrix:new s.ck(m),u_normal_scale:new s.ci(m),u_lutTexture:new s.cg(m)}),background:m=>({u_matrix:new s.ck(m),u_emissive_strength:new s.ci(m),u_opacity:new s.ci(m),u_color:new s.dx(m)}),backgroundPattern:m=>({u_matrix:new s.ck(m),u_emissive_strength:new s.ci(m),u_opacity:new s.ci(m),u_image:new s.cg(m),u_pattern_tl:new s.cj(m),u_pattern_br:new s.cj(m),u_texsize:new s.cj(m),u_pattern_size:new s.cj(m),u_pixel_coord_upper:new s.cj(m),u_pixel_coord_lower:new s.cj(m),u_pattern_units_to_pixels:new s.cj(m)}),terrainRaster:m=>({u_matrix:new s.ck(m),u_image0:new s.cg(m),u_skirt_height:new s.ci(m),u_ground_shadow_factor:new s.ch(m)}),skybox:m=>({u_matrix:new s.ck(m),u_sun_direction:new s.ch(m),u_cubemap:new s.cg(m),u_opacity:new s.ci(m),u_temporal_offset:new s.ci(m)}),skyboxGradient:m=>({u_matrix:new s.ck(m),u_color_ramp:new s.cg(m),u_center_direction:new s.ch(m),u_radius:new s.ci(m),u_opacity:new s.ci(m),u_temporal_offset:new s.ci(m)}),skyboxCapture:m=>({u_matrix_3f:new s.dy(m),u_sun_direction:new s.ch(m),u_sun_intensity:new s.ci(m),u_color_tint_r:new s.d2(m),u_color_tint_m:new s.d2(m),u_luminance:new s.ci(m)}),globeRaster:m=>({u_proj_matrix:new s.ck(m),u_globe_matrix:new s.ck(m),u_normalize_matrix:new s.ck(m),u_merc_matrix:new s.ck(m),u_zoom_transition:new s.ci(m),u_merc_center:new s.cj(m),u_image0:new s.cg(m),u_grid_matrix:new s.dy(m),u_skirt_height:new s.ci(m),u_far_z_cutoff:new s.ci(m),u_frustum_tl:new s.ch(m),u_frustum_tr:new s.ch(m),u_frustum_br:new s.ch(m),u_frustum_bl:new s.ch(m),u_globe_pos:new s.ch(m),u_globe_radius:new s.ci(m),u_viewport:new s.cj(m)}),globeAtmosphere:m=>({u_frustum_tl:new s.ch(m),u_frustum_tr:new s.ch(m),u_frustum_br:new s.ch(m),u_frustum_bl:new s.ch(m),u_horizon:new s.ci(m),u_transition:new s.ci(m),u_fadeout_range:new s.ci(m),u_atmosphere_fog_color:new s.d2(m),u_high_color:new s.d2(m),u_space_color:new s.d2(m),u_temporal_offset:new s.ci(m),u_horizon_angle:new s.ci(m)}),model:m=>({u_matrix:new s.ck(m),u_lighting_matrix:new s.ck(m),u_normal_matrix:new s.ck(m),u_node_matrix:new s.ck(m),u_lightpos:new s.ch(m),u_lightintensity:new s.ci(m),u_lightcolor:new s.ch(m),u_camera_pos:new s.ch(m),u_opacity:new s.ci(m),u_baseColorFactor:new s.d2(m),u_emissiveFactor:new s.d2(m),u_metallicFactor:new s.ci(m),u_roughnessFactor:new s.ci(m),u_baseTextureIsAlpha:new s.cg(m),u_alphaMask:new s.cg(m),u_alphaCutoff:new s.ci(m),u_baseColorTexture:new s.cg(m),u_metallicRoughnessTexture:new s.cg(m),u_normalTexture:new s.cg(m),u_occlusionTexture:new s.cg(m),u_emissionTexture:new s.cg(m),u_lutTexture:new s.cg(m),u_color_mix:new s.d2(m),u_aoIntensity:new s.ci(m),u_emissive_strength:new s.ci(m),u_occlusionTextureTransform:new s.d2(m)}),modelDepth:m=>({u_matrix:new s.ck(m),u_instance:new s.ck(m),u_node_matrix:new s.ck(m)}),groundShadow:m=>({u_matrix:new s.ck(m),u_ground_shadow_factor:new s.ch(m)}),stars:m=>({u_matrix:new s.ck(m),u_up:new s.ch(m),u_right:new s.ch(m),u_intensity_multiplier:new s.ci(m)}),snowParticle:m=>({u_modelview:new s.ck(m),u_projection:new s.ck(m),u_time:new s.ci(m),u_cam_pos:new s.ch(m),u_velocityConeAperture:new s.ci(m),u_velocity:new s.ci(m),u_horizontalOscillationRadius:new s.ci(m),u_horizontalOscillationRate:new s.ci(m),u_boxSize:new s.ci(m),u_billboardSize:new s.ci(m),u_simpleShapeParameters:new s.cj(m),u_screenSize:new s.cj(m),u_thinningCenterPos:new s.cj(m),u_thinningShape:new s.ch(m),u_thinningAffectedRatio:new s.ci(m),u_thinningParticleOffset:new s.ci(m),u_particleColor:new s.d2(m),u_direction:new s.ch(m)}),rainParticle:m=>({u_modelview:new s.ck(m),u_projection:new s.ck(m),u_time:new s.ci(m),u_cam_pos:new s.ch(m),u_texScreen:new s.cg(m),u_velocityConeAperture:new s.ci(m),u_velocity:new s.ci(m),u_boxSize:new s.ci(m),u_rainDropletSize:new s.cj(m),u_distortionStrength:new s.ci(m),u_rainDirection:new s.ch(m),u_color:new s.d2(m),u_screenSize:new s.cj(m),u_thinningCenterPos:new s.cj(m),u_thinningShape:new s.ch(m),u_thinningAffectedRatio:new s.ci(m),u_thinningParticleOffset:new s.ci(m),u_shapeDirectionalPower:new s.ci(m),u_shapeNormalPower:new s.ci(m),u_mode:new s.ci(m)}),vignette:m=>({u_vignetteShape:new s.ch(m),u_vignetteColor:new s.d2(m)}),occlusion:m=>({u_matrix:new s.ck(m),u_anchorPos:new s.ch(m),u_screenSizePx:new s.cj(m),u_occluderSizePx:new s.cj(m),u_color:new s.d2(m)})};class Dc{constructor(i,c,p,y){this.id=Dc.uniqueIdxCounter,Dc.uniqueIdxCounter++,this.context=i;const v=i.gl;this.buffer=v.createBuffer(),this.dynamicDraw=!!p,this.context.unbindVAO(),i.bindElementBuffer.set(this.buffer),v.bufferData(v.ELEMENT_ARRAY_BUFFER,c.arrayBuffer,this.dynamicDraw?v.DYNAMIC_DRAW:v.STATIC_DRAW),this.dynamicDraw||y||c.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(i){this.id=Dc.uniqueIdxCounter,Dc.uniqueIdxCounter++;const c=this.context.gl;this.context.unbindVAO(),this.bind(),c.bufferSubData(c.ELEMENT_ARRAY_BUFFER,0,i.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}Dc.uniqueIdxCounter=0;const Lb={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class _S{constructor(i,c,p,y,v,w){this.length=c.length,this.attributes=p,this.itemSize=c.bytesPerElement,this.dynamicDraw=y,this.instanceCount=w,this.context=i;const S=i.gl;this.buffer=S.createBuffer(),i.bindVertexBuffer.set(this.buffer),S.bufferData(S.ARRAY_BUFFER,c.arrayBuffer,this.dynamicDraw?S.DYNAMIC_DRAW:S.STATIC_DRAW),this.dynamicDraw||v||c.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(i){const c=this.context.gl;this.bind(),c.bufferSubData(c.ARRAY_BUFFER,0,i.arrayBuffer)}enableAttributes(i,c){for(let p=0;p<this.attributes.length;p++){const y=c.getAttributeLocation(i,this.attributes[p].name);y!==-1&&i.enableVertexAttribArray(y)}}setVertexAttribPointers(i,c,p){for(let y=0;y<this.attributes.length;y++){const v=this.attributes[y],w=c.getAttributeLocation(i,v.name);w!==-1&&i.vertexAttribPointer(w,v.components,i[Lb[v.type]],!1,this.itemSize,v.offset+this.itemSize*(p||0))}}setVertexAttribDivisor(i,c,p){for(let y=0;y<this.attributes.length;y++){const v=c.getAttributeLocation(i,this.attributes[y].name);v!==-1&&this.instanceCount&&this.instanceCount>0&&i.vertexAttribDivisor(v,p)}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class dm{constructor(i,c,p,y,v){this.context=i,this.width=c,this.height=p;const w=this.framebuffer=i.gl.createFramebuffer();y&&(this.colorAttachment=new Rb(i,w)),v&&(this.depthAttachmentType=v,this.depthAttachment=v==="renderbuffer"?new kb(i,w):new lS(i,w))}destroy(){const i=this.context.gl;if(this.colorAttachment){const c=this.colorAttachment.get();c&&i.deleteTexture(c)}if(this.depthAttachment&&this.depthAttachmentType)if(this.depthAttachmentType==="renderbuffer"){const c=this.depthAttachment.get();c&&i.deleteRenderbuffer(c)}else{const c=this.depthAttachment.get();c&&i.deleteTexture(c)}i.deleteFramebuffer(this.framebuffer)}}class V_{constructor(i,c){this.gl=i,this.clearColor=new wb(this),this.clearDepth=new y_(this),this.clearStencil=new nS(this),this.colorMask=new rS(this),this.depthMask=new iS(this),this.stencilMask=new oS(this),this.stencilFunc=new Tb(this),this.stencilOp=new sS(this),this.stencilTest=new qp(this),this.depthRange=new aS(this),this.depthTest=new Sb(this),this.depthFunc=new v_(this),this.blend=new Kp(this),this.blendFunc=new b_(this),this.blendColor=new zu(this),this.blendEquation=new Hd(this),this.cullFace=new Zp(this),this.cullFaceSide=new Xp(this),this.frontFace=new Wd(this),this.program=new Eb(this),this.activeTexture=new x_(this),this.viewport=new Cb(this),this.bindFramebuffer=new qd(this),this.bindRenderbuffer=new Yp(this),this.bindTexture=new Jp(this),this.bindVertexBuffer=new w_(this),this.bindElementBuffer=new Qp(this),this.bindVertexArrayOES=new Sf(this),this.pixelStoreUnpack=new Ib(this),this.pixelStoreUnpackPremultiplyAlpha=new Ab(this),this.pixelStoreUnpackFlipY=new Pb(this),this.options=c?Object.assign({},c):{},this.options.extTextureFilterAnisotropicForceOff||(this.extTextureFilterAnisotropic=i.getExtension("EXT_texture_filter_anisotropic")||i.getExtension("MOZ_EXT_texture_filter_anisotropic")||i.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=i.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT))),this.extDebugRendererInfo=i.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=i.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=i.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),this.forceManualRenderingForInstanceIDShaders=c&&!!c.forceManualRenderingForInstanceIDShaders||this.renderer&&this.renderer.indexOf("PowerVR")!==-1,this.options.extTextureFloatLinearForceOff||(this.extTextureFloatLinear=i.getExtension("OES_texture_float_linear")),this.extRenderToTextureHalfFloat=i.getExtension("EXT_color_buffer_half_float"),this.extTimerQuery=i.getExtension("EXT_disjoint_timer_query_webgl2"),this.maxTextureSize=i.getParameter(i.MAX_TEXTURE_SIZE),this.maxPointSize=i.getParameter(i.ALIASED_POINT_SIZE_RANGE)[1]}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArrayOES.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(i,c,p){return new Dc(this,i,c,p)}createVertexBuffer(i,c,p,y,v){return new _S(this,i,c,p,y,v)}createRenderbuffer(i,c,p){const y=this.gl,v=y.createRenderbuffer();return this.bindRenderbuffer.set(v),y.renderbufferStorage(y.RENDERBUFFER,i,c,p),this.bindRenderbuffer.set(null),v}createFramebuffer(i,c,p,y){return new dm(this,i,c,p,y)}clear({color:i,depth:c,stencil:p,colorMask:y}){const v=this.gl;let w=0;i&&(w|=v.COLOR_BUFFER_BIT,this.clearColor.set(i.toNonPremultipliedRenderColor(null)),this.colorMask.set(y||[!0,!0,!0,!0])),c!==void 0&&(w|=v.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(c),this.depthMask.set(!0)),p!==void 0&&(w|=v.STENCIL_BUFFER_BIT,this.clearStencil.set(p),this.stencilMask.set(255)),v.clear(w)}setCullFace(i){i.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(i.mode),this.frontFace.set(i.frontFace))}setDepthMode(i){i.func!==this.gl.ALWAYS||i.mask?(this.depthTest.set(!0),this.depthFunc.set(i.func),this.depthMask.set(i.mask),this.depthRange.set(i.range)):this.depthTest.set(!1)}setStencilMode(i){i.test.func!==this.gl.ALWAYS||i.mask?(this.stencilTest.set(!0),this.stencilMask.set(i.mask),this.stencilOp.set([i.fail,i.depthFail,i.pass]),this.stencilFunc.set({func:i.test.func,ref:i.ref,mask:i.test.mask})):this.stencilTest.set(!1)}setColorMode(i){s.by(i.blendFunction,In.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(i.blendFunction),this.blendColor.set(i.blendColor),i.blendEquation?this.blendEquation.set(i.blendEquation):this.blendEquation.setDefault()),this.colorMask.set(i.mask)}unbindVAO(){this.bindVertexArrayOES.set(null)}}let Sl;function Af(m,i,c,p,y,v,w){const S=m.context,I=S.gl,O=m.transform,D=[s.aF(O.center.lng),s.aJ(O.center.lat)],N=c.layout.get("symbol-placement"),z=c.layout.get("text-variable-anchor"),U=c.layout.get("icon-rotation-alignment")==="map",G=c.layout.get("text-rotation-alignment")==="map",H=N!=="point",J=[];let Z=0,ee=0;for(let he=0;he<p.length;he++){const _e=p[he],Ke=i.getTile(_e),Le=Ke.getBucket(c);if(!Le)continue;const st=Le.getProjection().createInversionMatrix(O,_e.canonical),We=[],it=Dd(_e,Le,O),Pt=!w&&U&&H,qe=w&&G&&H,Ae=z&&Le.hasTextData(),at=Le.hasIconTextFit()&&Ae&&Le.hasIconData(),Je=Pt||qe||w&&Ae||at,_t=Le.projection.name==="globe",At=_t?s.aj(O.zoom):0;_t&&(We.push("PROJECTION_GLOBE_VIEW"),Je&&We.push("PROJECTED_POS_ON_VIEWPORT"));const Ut=m.getOrCreateProgram("collisionBox",{defines:We});let St=it;y[0]===0&&y[1]===0||(St=m.translatePosMatrix(it,Ke,y,v));const bt=w?Le.textCollisionBox:Le.iconCollisionBox,un=Le.collisionCircleArray;if(un.length>0){const an=s.bC(),Qt=St;s.cO(an,Le.placementInvProjMatrix,O.glCoordMatrix),s.cO(an,an,Le.placementViewportMatrix),J.push({circleArray:un,circleOffset:ee,transform:Qt,invTransform:an,projection:Le.getProjection()}),Z+=un.length/4,ee=Z}if(!bt)continue;m.terrain&&m.terrain.setupElevationDraw(Ke,Ut);const en=_t?[_e.canonical.x,_e.canonical.y,1<<_e.canonical.z]:[0,0,0];Ut.draw(m,I.LINES,Gt.disabled,Tn.disabled,m.colorModeForRenderPass(),Dn.disabled,O_(St,st,O,At,D,Ke,en,Le.getProjection()),c.id,bt.layoutVertexBuffer,bt.indexBuffer,bt.segments,null,O.zoom,null,[bt.collisionVertexBuffer,bt.collisionVertexBufferExt])}if(!w||!J.length)return;const ie=m.getOrCreateProgram("collisionCircle"),se=new s.dW;se.resize(4*Z),se._trim();let me=0;for(const he of J)for(let _e=0;_e<he.circleArray.length/4;_e++){const Ke=4*_e,Le=he.circleArray[Ke+0],st=he.circleArray[Ke+1],We=he.circleArray[Ke+2],it=he.circleArray[Ke+3];se.emplace(me++,Le,st,We,it,0),se.emplace(me++,Le,st,We,it,1),se.emplace(me++,Le,st,We,it,2),se.emplace(me++,Le,st,We,it,3)}(!Sl||Sl.length<2*Z)&&(Sl=(function(he){const _e=2*he,Ke=new s.b1;Ke.resize(_e),Ke._trim();for(let Le=0;Le<_e;Le++){const st=6*Le;Ke.uint16[st+0]=4*Le+0,Ke.uint16[st+1]=4*Le+1,Ke.uint16[st+2]=4*Le+2,Ke.uint16[st+3]=4*Le+2,Ke.uint16[st+4]=4*Le+3,Ke.uint16[st+5]=4*Le+0}return Ke})(Z));const fe=S.createIndexBuffer(Sl,!0),ge=S.createVertexBuffer(se,s.dX.members,!0);for(const he of J){const _e={u_matrix:he.transform,u_inv_matrix:he.invTransform,u_camera_to_center_distance:(pe=O).getCameraToCenterDistance(he.projection),u_viewport_size:[pe.width,pe.height]};ie.draw(m,I.TRIANGLES,Gt.disabled,Tn.disabled,m.colorModeForRenderPass(),Dn.disabled,_e,c.id,ge,fe,s.bg.simpleSegment(0,2*he.circleOffset,he.circleArray.length,he.circleArray.length/2),null,O.zoom)}var pe;ge.destroy(),fe.destroy()}const Lc=s.bC();function $_(m){const i=m._camera.getWorldToCamera(m.worldSize,1),c=s.aB([],i,m.globeMatrix);s.bl(c,c);const p=[0,0,0],y=[0,1,0,0];return s.aC(y,y,c),p[0]=y[0],p[1]=y[1],p[2]=y[2],s.aw(p,p),p}function hm({width:m,height:i,anchor:c,textOffset:p,textScale:y},v){const{horizontalAlign:w,verticalAlign:S}=s.c0(c),I=-(w-.5)*m,O=-(S-.5)*i,D=s.c1(c,p);return new s.P((I/y+D[0])*v,(O/y+D[1])*v)}function fm(m,i,c,p,y,v,w,S,I,O){const D=m.text.placedSymbolArray,N=m.text.dynamicLayoutVertexArray,z=m.icon.dynamicLayoutVertexArray,U={},G=m.getProjection(),H=Ji(w,G,y),J=y.elevation,Z=G.upVectorScale(w.canonical,y.center.lat,y.worldSize).metersToTile;N.clear();for(let ee=0;ee<D.length;ee++){const ie=D.get(ee),{tileAnchorX:se,tileAnchorY:me,numGlyphs:fe}=ie,ge=ie.hidden||!ie.crossTileID||m.allowVerticalPlacement&&!ie.placedOrientation?null:p[ie.crossTileID];if(ge){let pe=0,he=0,_e=0;if(J){const at=J?J.getAtTileOffset(w,se,me):0,[Je,_t,At]=G.upVector(w.canonical,se,me);pe=at*Je*Z,he=at*_t*Z,_e=at*At*Z}let[Ke,Le,st,We]=Oo(ie.projectedAnchorX+pe,ie.projectedAnchorY+he,ie.projectedAnchorZ+_e,c?H:v);const it=xl(y.getCameraToCenterDistance(G),We);let Pt=s.bM(m.textSizeData,I,ie)*it/s.bX;c&&(Pt*=m.tilePixelRatio/S);const qe=hm(ge,Pt);c?({x:Ke,y:Le,z:st}=G.projectTilePoint(se+qe.x,me+qe.y,w.canonical),[Ke,Le,st]=Oo(Ke+pe,Le+he,st+_e,v)):(i&&qe._rotate(-y.angle),Ke+=qe.x,Le+=qe.y,st=0);const Ae=m.allowVerticalPlacement&&ie.placedOrientation===s.bL.vertical?Math.PI/2:0;for(let at=0;at<fe;at++)s.bO(N,Ke,Le,st,Ae);O&&ie.associatedIconIndex>=0&&(U[ie.associatedIconIndex]={x:Ke,y:Le,z:st,angle:Ae})}else wn(fe,N)}if(O){z.clear();const ee=m.icon.placedSymbolArray;for(let ie=0;ie<ee.length;ie++){const se=ee.get(ie),{numGlyphs:me}=se,fe=U[ie];if(se.hidden||!fe)wn(me,z);else{const{x:ge,y:pe,z:he,angle:_e}=fe;for(let Ke=0;Ke<me;Ke++)s.bO(z,ge,pe,he,_e)}}m.icon.dynamicLayoutVertexBuffer.updateData(z)}m.text.dynamicLayoutVertexBuffer.updateData(N)}function Pf(m,i,c,p,y,v,w={}){const S=c.paint.get("icon-translate"),I=c.paint.get("text-translate"),O=c.paint.get("icon-translate-anchor"),D=c.paint.get("text-translate-anchor"),N=c.layout.get("icon-rotation-alignment"),z=c.layout.get("text-rotation-alignment"),U=c.layout.get("icon-pitch-alignment"),G=c.layout.get("text-pitch-alignment"),H=c.layout.get("icon-keep-upright"),J=c.layout.get("text-keep-upright"),Z=c.paint.get("icon-color-saturation"),ee=c.paint.get("icon-color-contrast"),ie=c.paint.get("icon-color-brightness-min"),se=c.paint.get("icon-color-brightness-max"),me=c.layout.get("symbol-elevation-reference")==="sea",fe=c.layout.get("icon-image-use-theme")==="none",ge=m.context,pe=ge.gl,he=m.transform,_e=N==="map",Ke=z==="map",Le=U==="map",st=G==="map",We=c.layout.get("symbol-sort-key").constantOr(1)!==void 0;let it=!1;const Pt=m.depthModeForSublayer(0,Gt.ReadOnly),qe=new Gt(m.context.gl.LEQUAL,Gt.ReadOnly,m.depthRangeFor3D),Ae=[s.aF(he.center.lng),s.aJ(he.center.lat)],at=c.layout.get("text-variable-anchor"),Je=he.projection.name==="globe",_t=[],At=[0,-1,0];for(const Ut of p){const St=i.getTile(Ut),bt=St.getBucket(c);if(!bt||bt.projection.name==="mercator"&&Je||bt.fullyClipped)continue;const un=bt.projection.name==="globe",en=un?s.aj(he.zoom):0,an=Ji(Ut,bt.getProjection(),he),Qt=he.calculatePixelsToTileUnitsMatrix(St),Ln=at&&bt.hasTextData(),Hn=bt.hasIconTextFit()&&Ln&&bt.hasIconData(),qn=bt.getProjection().createInversionMatrix(he,Ut.canonical),Wr=(1<<St.tileID.canonical.z)*s.al/m.transform.worldSize,Bn=Ci=>{let Kn=[0,0,0];if(Ci){const kn=m.style.directionalLight,qr=m.style.ambientLight;kn&&qr&&(Kn=Ja(m.style,kn,qr))}return Kn},Or=Ci=>{he.depthOcclusionForSymbolsAndCircles&&(c.hasOcclusionOpacityProperties||m.terrain)&&(Ci.push("DEPTH_D24"),Ci.push("DEPTH_OCCLUSION"))},Gr=Ci=>{c.lut&&!fe&&(c.lut.texture||(c.lut.texture=new s.dY(m.context,c.lut.image,[c.lut.image.height,c.lut.image.height,c.lut.image.height],ge.gl.RGBA8)),ge.activeTexture.set(ge.gl.TEXTURE0+_o.LUT),c.lut.texture&&c.lut.texture.bind(ge.gl.LINEAR,ge.gl.CLAMP_TO_EDGE),Ci.push("APPLY_LUT_ON_GPU"))},Ti=()=>{const Ci=_e&&c.layout.get("symbol-placement")!=="point",Kn=[];Or(Kn),Gr(Kn);const kn=Ci||Hn,qr=bt.elevationType==="road",qi=m.shadowRenderer,ki=qr&&Le&&!!qi&&qi.enabled,yo=Bn(ki),Ko=qr&&Le&&!m.terrain?qe:Pt,va=c.paint.get("icon-image-cross-fade");m.terrainRenderModeElevated()&&Le&&Kn.push("PITCH_WITH_MAP_TERRAIN"),un&&(Kn.push("PROJECTION_GLOBE_VIEW"),kn&&Kn.push("PROJECTED_POS_ON_VIEWPORT")),va>0&&bt.hasAnySecondaryIcon&&Kn.push("ICON_TRANSITION"),!bt.icon.zOffsetVertexBuffer||qr&&m.terrain||Kn.push("Z_OFFSET"),Z===0&&ee===0&&ie===0&&se===1||Kn.push("COLOR_ADJUSTMENT"),bt.sdfIcons&&Kn.push("RENDER_SDF"),ki&&Kn.push("RENDER_SHADOWS","DEPTH_TEXTURE","NORMAL_OFFSET"),qr&&Le&&!m.terrain&&bt.icon.orientationVertexBuffer&&Kn.push("ELEVATED_ROADS");const ba=bt.icon.programConfigurations.get(c.id),Ys=m.getOrCreateProgram("symbol",{config:ba,defines:Kn}),Js=St.imageAtlasTexture?St.imageAtlasTexture.size:[0,0],Ts=bt.iconSizeData,Ba=s.bK(Ts,he.zoom),nl=Le||!he.isOrthographic,eo=qs(an,St.tileID.canonical,Le,_e,he,bt.getProjection(),Qt),ro=Pu(an,St.tileID.canonical,Le,_e,he,bt.getProjection(),Qt),Oi=m.translatePosMatrix(ro,St,S,O,!0),Io=m.translatePosMatrix(an,St,S,O),$o=kn?Lc:eo,mo=_e&&!Le&&!Ci;let ns=At;!Je&&!he.mercatorFromTransition||_e||(ns=$_(he));const Al=un?ns:At,tc=c.getColorAdjustmentMatrix(Z,ee,ie,se),rl=B_(Ts.kind,Ba,mo,Le,m,Io,$o,Oi,me,!1,Js,[0,0],0,Ut,en,Ae,qn,Al,bt.getProjection(),yo,Wr,tc,va,null),Gc=St.imageAtlasTexture?St.imageAtlasTexture:null,Hc=c.layout.get("icon-size").constantOr(0)!==1||bt.iconsNeedLinear,Pl=bt.sdfIcons||m.options.rotating||m.options.zooming||Hc||nl?pe.LINEAR:pe.NEAREST,lh=bt.sdfIcons&&c.paint.get("icon-halo-width").constantOr(1)!==0,nc=m.terrain&&Le&&Ci?s.bl(s.bC(),eo):Lc;if(Ci&&bt.icon){const Rl=he.elevation,rc=Rl?Rl.getAtTileOffsetFunc(Ut,he.center.lat,he.worldSize,bt.getProjection()):null,Dm=bl(an,St.tileID.canonical,Le,_e,he,bt.getProjection(),Qt);Kl(bt,an,m,!1,Dm,ro,Le,H,rc,Ut)}return{program:Ys,buffers:bt.icon,uniformValues:rl,atlasTexture:Gc,atlasTextureIcon:null,atlasInterpolation:Pl,atlasInterpolationIcon:null,isSDF:bt.sdfIcons,hasHalo:lh,depthMode:Ko,tile:St,renderWithShadows:ki,labelPlaneMatrixInv:nc}},Wn=()=>{const Ci=Ke&&c.layout.get("symbol-placement")!=="point",Kn=[],kn=Ci||at||Hn,qr=bt.elevationType==="road",qi=m.shadowRenderer,ki=qr&&st&&!!qi&&qi.enabled,yo=Bn(ki),Ko=qr&&st&&!m.terrain?qe:Pt;m.terrainRenderModeElevated()&&st&&Kn.push("PITCH_WITH_MAP_TERRAIN"),un&&(Kn.push("PROJECTION_GLOBE_VIEW"),kn&&Kn.push("PROJECTED_POS_ON_VIEWPORT")),!bt.text.zOffsetVertexBuffer||qr&&m.terrain||Kn.push("Z_OFFSET"),bt.iconsInText&&Kn.push("RENDER_TEXT_AND_SYMBOL"),Kn.push("RENDER_SDF"),ki&&Kn.push("RENDER_SHADOWS","DEPTH_TEXTURE","NORMAL_OFFSET"),qr&&st&&!m.terrain&&bt.text.orientationVertexBuffer&&Kn.push("ELEVATED_ROADS"),Or(Kn);const va=bt.text.programConfigurations.get(c.id),ba=m.getOrCreateProgram("symbol",{config:va,defines:Kn});let Ys,Js=[0,0],Ts=null;const Ba=bt.textSizeData;bt.iconsInText&&(Js=St.imageAtlasTexture?St.imageAtlasTexture.size:[0,0],Ts=St.imageAtlasTexture?St.imageAtlasTexture:null,Ys=st||!he.isOrthographic||m.options.rotating||m.options.zooming||Ba.kind==="composite"||Ba.kind==="camera"?pe.LINEAR:pe.NEAREST);const nl=St.glyphAtlasTexture?St.glyphAtlasTexture.size:[0,0],eo=c.layout.get("text-size-scale-range"),ro=s.aA(m.scaleFactor,eo[0],eo[1]),Oi=s.bK(Ba,he.zoom,ro),Io=qs(an,St.tileID.canonical,st,Ke,he,bt.getProjection(),Qt),$o=Pu(an,St.tileID.canonical,st,Ke,he,bt.getProjection(),Qt),mo=m.translatePosMatrix($o,St,I,D,!0),ns=m.translatePosMatrix(an,St,I,D),Al=kn?Lc:Io,tc=Ke&&!st&&!Ci;let rl=At;!Je&&!he.mercatorFromTransition||Ke||(rl=$_(he));const Gc=B_(Ba.kind,Oi,tc,st,m,ns,Al,mo,me,!0,nl,Js,0,Ut,en,Ae,qn,un?rl:At,bt.getProjection(),yo,Wr,null,null,ro),Hc=St.glyphAtlasTexture?St.glyphAtlasTexture:null,Pl=pe.LINEAR,lh=c.paint.get("text-halo-width").constantOr(1)!==0,nc=m.terrain&&st&&Ci?s.bl(s.bC(),Io):Lc;if(Ci&&bt.text){const Rl=he.elevation,rc=Rl?Rl.getAtTileOffsetFunc(Ut,he.center.lat,he.worldSize,bt.getProjection()):null,Dm=bl(an,St.tileID.canonical,st,Ke,he,bt.getProjection(),Qt);Kl(bt,an,m,!0,Dm,$o,st,J,rc,Ut)}return{program:ba,buffers:bt.text,uniformValues:Gc,atlasTexture:Hc,atlasTextureIcon:Ts,atlasInterpolation:Pl,atlasInterpolationIcon:Ys,isSDF:!0,hasHalo:lh,depthMode:Ko,tile:St,renderWithShadows:ki,labelPlaneMatrixInv:nc}},Lr=bt.icon.segments.get().length,Mr=bt.text.segments.get().length,$r=Lr&&!w.onlyText?Ti():null,Ei=Mr&&!w.onlyIcons?Wn():null,no=c.paint.get("icon-opacity").constantOr(1),Vo=c.paint.get("text-opacity").constantOr(1);if(We&&bt.canOverlap){it=!0;const Ci=no&&!w.onlyText?bt.icon.segments.get():[],Kn=Vo&&!w.onlyIcons?bt.text.segments.get():[];for(const kn of Ci)_t.push({segments:new s.bg([kn]),sortKey:kn.sortKey,state:$r});for(const kn of Kn)_t.push({segments:new s.bg([kn]),sortKey:kn.sortKey,state:Ei})}else w.onlyText||_t.push({segments:no?bt.icon.segments:new s.bg([]),sortKey:0,state:$r}),w.onlyIcons||_t.push({segments:Vo?bt.text.segments:new s.bg([]),sortKey:0,state:Ei})}it&&_t.sort(((Ut,St)=>Ut.sortKey-St.sortKey));for(const Ut of _t){const St=Ut.state;if(St)if(m.terrain?m.terrain.setupElevationDraw(St.tile,St.program,{useDepthForOcclusion:he.depthOcclusionForSymbolsAndCircles,labelPlaneMatrixInv:St.labelPlaneMatrixInv}):m.setupDepthForOcclusion(he.depthOcclusionForSymbolsAndCircles,St.program),ge.activeTexture.set(pe.TEXTURE0),St.atlasTexture&&St.atlasTexture.bind(St.atlasInterpolation,pe.CLAMP_TO_EDGE,!0),St.atlasTextureIcon&&(ge.activeTexture.set(pe.TEXTURE1),St.atlasTextureIcon&&St.atlasTextureIcon.bind(St.atlasInterpolationIcon,pe.CLAMP_TO_EDGE,!0)),St.renderWithShadows&&m.shadowRenderer.setupShadows(St.tile.tileID.toUnwrapped(),St.program,"vector-tile"),m.uploadCommonLightUniforms(m.context,St.program),St.hasHalo){const bt=St.uniformValues;bt.u_is_halo=1,pm(St.buffers,Ut.segments,c,m,St.program,St.depthMode,y,v,bt,2),bt.u_is_halo=0}else{if(St.isSDF){const bt=St.uniformValues;St.hasHalo&&(bt.u_is_halo=1,pm(St.buffers,Ut.segments,c,m,St.program,St.depthMode,y,v,bt,1)),bt.u_is_halo=0}pm(St.buffers,Ut.segments,c,m,St.program,St.depthMode,y,v,St.uniformValues,1)}}}function pm(m,i,c,p,y,v,w,S,I,O){const D=[m.dynamicLayoutVertexBuffer,m.opacityVertexBuffer,m.iconTransitioningVertexBuffer,m.globeExtVertexBuffer,m.zOffsetVertexBuffer,m.orientationVertexBuffer];y.draw(p,p.context.gl.TRIANGLES,v,w,S,Dn.disabled,I,c.id,m.layoutVertexBuffer,m.indexBuffer,i,c.paint,p.transform.zoom,m.programConfigurations.get(c.id),D,O)}function zb(m,i){const c=1<<m.canonical.z,p=(i.x*c-m.canonical.x-m.wrap*c)*s.al,y=(i.y*c-m.canonical.y)*s.al,v=s.e5(i.z,i.y);return s.d4(p,y,v)}function Uu(m,i,c,p,y){if(!c.layout||c.layout.get("fill-elevation-reference")==="none")return;const v=m.context.gl,w=new Gt(m.context.gl.LEQUAL,Gt.ReadWrite,m.depthRangeFor3D),S=new Gt(m.context.gl.GREATER,Gt.ReadWrite,m.depthRangeFor3D),I=(function(U){let G=.01;return U.isOrthographic&&(G=s.ak(1e-4,G,s.c$(U.pitch>=Xl?1:U.pitch/Xl))),2*G})(m.transform),O=m.transform.getFreeCameraOptions().position,D="elevatedStructuresDepthReconstruct",N=m.getOrCreateProgram(D,{defines:["DEPTH_RECONSTRUCTION"]}),z=m.getOrCreateProgram(D);for(const U of p){const G=i.getTile(U),H=G.getBucket(c);if(!H)continue;const J=H.elevatedStructures;if(!J)continue;const Z=H.elevationBufferData.heightRange,ee=zb(U.toUnwrapped(),O),ie=m.translatePosMatrix(U.projMatrix,G,c.paint.get("fill-translate"),c.paint.get("fill-translate-anchor"));let se,me,fe,ge;if(y==="initialize"){if(!Z||Z.min>=1||J.depthSegments.segments[0].primitiveLength===0)continue;se=om(ie,ee,I,1,0),me=w,fe=J.depthSegments,ge=N}else if(y==="reset"){if(!Z||Z.min>=0||J.maskSegments.segments[0].primitiveLength===0)continue;se=om(ie,ee,0,0,1),me=S,fe=J.maskSegments,ge=N}else if(y==="geometry"){if(J.depthSegments.segments[0].primitiveLength===0)continue;se=om(ie,ee,I,1,0),me=w,fe=J.depthSegments,ge=z}ge.draw(m,v.TRIANGLES,me,Tn.disabled,In.disabled,Dn.disabled,se,c.id,J.vertexBuffer,J.indexBuffer,fe,c.paint,m.transform.zoom)}}function Yd(m,i,c){const{painter:p,sourceCache:y,layer:v,coords:w,colorMode:S,elevationType:I,terrainEnabled:O,pass:D}=m,N=p.context.gl,z=v.paint.get("fill-pattern"),U=v.paint.get("fill-pattern-cross-fade"),G=z.constantOr(null);let H=I;I!=="road"||i&&!O||(H="none");const J=H==="road",Z=m.painter.shadowRenderer,ee=J&&!!Z&&Z.enabled,ie=new Gt(p.context.gl.LEQUAL,Gt.ReadOnly,p.depthRangeFor3D);let se=[0,0,0];if(ee){const ge=p.style.directionalLight,pe=p.style.ambientLight;ge&&pe&&(se=Ja(p.style,ge,pe))}const me=z&&z.constantOr(1),fe=(ge,pe)=>{let he,_e,Ke,Le,st;pe?(he=me&&!v.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",Ke=N.LINES):(he=me?"fillPattern":"fill",Ke=N.TRIANGLES);for(const We of w){const it=y.getTile(We);if(me&&!it.patternsLoaded())continue;const Pt=it.getBucket(v);if(!Pt)continue;const qe=i?Pt.elevationBufferData:Pt.bufferData;if(qe.isEmpty())continue;p.prepareDrawTile();const Ae=qe.programConfigurations.get(v.id),at=p.isTileAffectedByFog(We),Je=[],_t=[];J&&(Je.push("ELEVATED_ROADS"),_t.push(qe.elevatedLayoutVertexBuffer)),ee&&Je.push("RENDER_SHADOWS","DEPTH_TEXTURE","NORMAL_OFFSET"),me&&(p.context.activeTexture.set(N.TEXTURE0),it.imageAtlasTexture&&it.imageAtlasTexture.bind(N.LINEAR,N.CLAMP_TO_EDGE),Ae.updatePaintBuffers());let At=!1;if(G&&it.imageAtlas){const en=it.imageAtlas,an=s.e0.from(G),Qt=an.getPrimary().scaleSelf(s.o.devicePixelRatio).toString(),Ln=an.getSecondary(),Hn=en.patternPositions.get(Qt),qn=Ln?en.patternPositions.get(Ln.scaleSelf(s.o.devicePixelRatio).toString()):null;At=!!Hn&&!!qn,Hn&&Ae.setConstantPatternPositions(Hn,qn)}U>0&&(At||Ae.getPatternTransitionVertexBuffer("fill-pattern"))&&Je.push("FILL_PATTERN_TRANSITION");const Ut=p.getOrCreateProgram(he,{config:Ae,overrideFog:at,defines:Je}),St=p.translatePosMatrix(We.projMatrix,it,v.paint.get("fill-translate"),v.paint.get("fill-translate-anchor"));ee&&Z.setupShadows(it.tileID.toUnwrapped(),Ut,"vector-tile");const bt=v.paint.get("fill-emissive-strength");if(pe){Le=qe.lineIndexBuffer,st=qe.lineSegments;const en=p.terrain&&p.terrain.renderingToTexture?p.terrain.drapeBufferSize:[N.drawingBufferWidth,N.drawingBufferHeight];_e=he==="fillOutlinePattern"&&me?hS(St,bt,p,it,en,se,U):dS(St,bt,en,se)}else Le=qe.indexBuffer,st=qe.triangleSegments,_e=me?Nu(St,bt,p,it,se,U):R_(St,bt,se);p.uploadCommonUniforms(p.context,Ut,We.toUnwrapped());let un=ge;(I==="road"&&!O||I==="offset")&&(un=ie),Ut.draw(p,Ke,un,c||p.stencilModeForClipping(We),S,Dn.disabled,_e,v.id,qe.layoutVertexBuffer,Le,st,v.paint,p.transform.zoom,Ae,_t)}};p.renderPass===D&&fe(p.depthModeForSublayer(1,p.renderPass==="opaque"?Gt.ReadWrite:Gt.ReadOnly),!1),H==="none"&&p.renderPass==="translucent"&&v.paint.get("fill-antialias")&&fe(p.depthModeForSublayer(v.getPaintProperty("fill-outline-color")?2:0,Gt.ReadOnly),!0)}function Wt(m,i,c,p,y,v,w,S){c.resetLayerRenderingStats(m);const I=m.context,O=I.gl,D=m.transform,N=c.paint.get("fill-extrusion-pattern"),z=c.paint.get("fill-extrusion-pattern-cross-fade"),U=N.constantOr(null),G=N.constantOr(1),H=c.paint.get("fill-extrusion-opacity"),J=m.style.enable3dLights(),Z=c.paint.get(J&&!G?"fill-extrusion-ambient-occlusion-wall-radius":"fill-extrusion-ambient-occlusion-radius"),ee=[c.paint.get("fill-extrusion-ambient-occlusion-intensity"),Z],ie=c.layout.get("fill-extrusion-edge-radius"),se=ie>0&&!c.paint.get("fill-extrusion-rounded-roof"),me=se?0:ie,fe=D.projection.name==="globe"?s.e8():0,ge=D.projection.name==="globe",pe=ge?s.aj(D.zoom):0,he=[s.aF(D.center.lng),s.aJ(D.center.lat)],_e=c.paint.get("fill-extrusion-flood-light-color-use-theme").constantOr("default")==="none",Ke=c.paint.get("fill-extrusion-flood-light-color").toNonPremultipliedRenderColor(_e?null:c.lut).toArray01().slice(0,3),Le=c.paint.get("fill-extrusion-flood-light-intensity"),st=c.paint.get("fill-extrusion-vertical-scale"),We=c.paint.get("fill-extrusion-line-width").constantOr(1)!==0,it=c.paint.get("fill-extrusion-height-alignment"),Pt=c.paint.get("fill-extrusion-base-alignment"),qe=Pc(m,c.paint.get("fill-extrusion-cutoff-fade-range")),Ae=[];let at;ge&&Ae.push("PROJECTION_GLOBE_VIEW"),ee[0]>0&&Ae.push("FAUX_AO"),se&&Ae.push("ZERO_ROOF_RADIUS"),S&&Ae.push("HAS_CENTROID"),Le>0&&Ae.push("FLOOD_LIGHT"),qe.shouldRenderCutoff&&Ae.push("RENDER_CUTOFF"),We&&Ae.push("RENDER_WALL_MODE");const Je=m.renderPass==="shadow",_t=m.shadowRenderer,At=Je&&!!_t,Ut=Je?Dn.disabled:Dn.backCCW;m.shadowRenderer&&(m.shadowRenderer.useNormalOffset=!0);let St=[0,0,0];if(_t){const en=m.style.directionalLight,an=m.style.ambientLight;en&&an&&(St=Ja(m.style,en,an)),Je||(Ae.push("RENDER_SHADOWS","DEPTH_TEXTURE"),_t.useNormalOffset&&Ae.push("NORMAL_OFFSET")),at=Ae.concat(["SHADOWS_SINGLE_CASCADE"])}const bt=At?"fillExtrusionDepth":G?"fillExtrusionPattern":"fillExtrusion",un=c.getLayerRenderingStats();for(const en of p){const an=i.getTile(en),Qt=an.getBucket(c);if(!Qt||Qt.projection.name!==D.projection.name)continue;let Ln=!1;_t&&(Ln=_t.getMaxCascadeForTile(en.toUnwrapped())===0);const Hn=m.isTileAffectedByFog(en),qn=Qt.programConfigurations.get(c.id);let Wr=!1;if(U&&an.imageAtlas){const Mr=an.imageAtlas,$r=s.e0.from(U),Ei=$r.getPrimary().scaleSelf(s.o.devicePixelRatio).toString(),no=$r.getSecondary(),Vo=Mr.patternPositions.get(Ei),Ci=no?Mr.patternPositions.get(no.scaleSelf(s.o.devicePixelRatio).toString()):null;Wr=!!Vo&&!!Ci,Vo&&qn.setConstantPatternPositions(Vo,Ci)}z>0&&(Wr||qn.getPatternTransitionVertexBuffer("fill-extrusion-pattern"))&&Ae.push("FILL_EXTRUSION_PATTERN_TRANSITION");const Bn=m.getOrCreateProgram(bt,{config:qn,defines:Ln?at:Ae,overrideFog:Hn});if(m.terrain&&m.terrain.setupElevationDraw(an,Bn,{useMeterToDem:!0}),!Qt.centroidVertexBuffer){const Mr=Bn.getAttributeLocation(O,"a_centroid_pos");Mr!==-1&&O.vertexAttrib2f(Mr,0,0)}!Je&&_t&&_t.setupShadows(an.tileID.toUnwrapped(),Bn,"vector-tile"),G&&(m.context.activeTexture.set(O.TEXTURE0),an.imageAtlasTexture&&an.imageAtlasTexture.bind(O.LINEAR,O.CLAMP_TO_EDGE),qn.updatePaintBuffers());const Or=c.paint.get("fill-extrusion-vertical-gradient"),Gr=1/Qt.tileToMeter;let Ti;if(Je&&_t){if(Fb(an.tileID,Qt.maxHeight,m))continue;const Mr=_t.calculateShadowPassMatrixFromTile(an.tileID.toUnwrapped());Ti=P_(Mr,me,Gr,st,it,Pt)}else{const Mr=m.translatePosMatrix(en.expandedProjMatrix,an,c.paint.get("fill-extrusion-translate"),c.paint.get("fill-extrusion-translate-anchor")),$r=D.projection.createInversionMatrix(D,en.canonical);Ti=G?Mb(Mr,m,Or,H,ee,me,Gr,en,an,fe,it,Pt,pe,he,$r,Ke,st,z):If(Mr,m,Or,H,ee,me,Gr,en,fe,it,Pt,pe,he,$r,Ke,st,Le,St)}m.uploadCommonUniforms(I,Bn,en.toUnwrapped(),null,qe);let Wn=Qt.segments;if(D.projection.name==="mercator"&&!Je&&(Wn=Qt.getVisibleSegments(an.tileID,m.terrain,m.transform.getFrustum(0)),!Wn.get().length))continue;if(un)if(Je)for(const Mr of Wn.get())un.numRenderedVerticesInShadowPass+=Mr.primitiveLength;else for(const Mr of Wn.get())un.numRenderedVerticesInTransparentPass+=Mr.primitiveLength;const Lr=[];(m.terrain||S)&&Lr.push(Qt.centroidVertexBuffer),ge&&Lr.push(Qt.layoutVertexExtBuffer),We&&Lr.push(Qt.wallVertexBuffer),Bn.draw(m,I.gl.TRIANGLES,y,v,w,Ut,Ti,c.id,Qt.layoutVertexBuffer,Qt.indexBuffer,Wn,c.paint,m.transform.zoom,qn,Lr)}m.shadowRenderer&&(m.shadowRenderer.useNormalOffset=!1)}class U_{constructor(){this.translate=[0,0],this.translateAnchor="map",this.edgeRadius=0,this.cutoffFadeRange=0}}function Yl(m,i,c,p,y,v,w,S,I,O,D,N,z,U,G,H,J,Z,ee,ie){const se=i.context,me=se.gl,fe=i.transform,ge=i.transform.zoom,pe=[],he=m.translate,_e=m.translateAnchor,Ke=m.edgeRadius,Le=Pc(i,m.cutoffFadeRange);D==="clear"?(pe.push("CLEAR_SUBPASS"),ie&&(pe.push("CLEAR_FROM_TEXTURE"),se.activeTexture.set(me.TEXTURE0),ie.bind(me.LINEAR,me.CLAMP_TO_EDGE))):D==="sdf"&&pe.push("SDF_SUBPASS"),Z&&pe.push("HAS_CENTROID"),Le.shouldRenderCutoff&&pe.push("RENDER_CUTOFF");const st=(We,it,Pt,qe,Ae)=>{const at=it.programConfigurations.get(p.id),Je=i.isTileAffectedByFog(We),_t=i.getOrCreateProgram("fillExtrusionGroundEffect",{config:at,defines:pe,overrideFog:Je}),At=((St,bt,un,en,an,Qt,Ln,Hn,qn,Wr,Bn)=>({u_matrix:bt,u_opacity:un,u_ao_pass:en?1:0,u_meter_to_tile:an,u_ao:Qt,u_flood_light_intensity:Ln,u_flood_light_color:Hn,u_attenuation:qn,u_edge_radius:Wr,u_fb:0,u_fb_size:Bn,u_dynamic_offset:1}))(0,qe,N,O,Ae,[z,U*Ae],G,H,J,ge>=17?0:Ke*Ae,ie?ie.size[0]:0),Ut=[];Z&&Ut.push(it.hiddenByLandmarkVertexBuffer),i.uploadCommonUniforms(se,_t,We.toUnwrapped(),null,Le),_t.draw(i,se.gl.TRIANGLES,v,w,S,I,At,p.id,it.vertexBuffer,it.indexBuffer,Pt,p.paint,ge,at,Ut)};for(const We of y){const it=c.getTile(We),Pt=it.getBucket(p);if(!Pt||Pt.projection.name!==fe.projection.name||!Pt.groundEffect||Pt.groundEffect&&!Pt.groundEffect.hasData())continue;const qe=Pt.groundEffect,Ae=1/Pt.tileToMeter;{const at=i.translatePosMatrix(We.projMatrix,it,he,_e),Je=qe.getDefaultSegment();st(We,qe,Je,at,Ae)}if(ee)for(let at=0;at<4;at++){const Je=s.e6[at](We),_t=c.getTile(Je);if(!_t)continue;const At=_t.getBucket(p);if(!At||At.projection.name!==fe.projection.name||!At.groundEffect||At.groundEffect&&!At.groundEffect.hasData())continue;const Ut=At.groundEffect;let St,bt;at===0?(St=[-s.al,0,0],bt=1):at===1?(St=[s.al,0,0],bt=0):at===2?(St=[0,-s.al,0],bt=3):(St=[0,s.al,0],bt=2);const un=Ut.regionSegments[bt];if(!un)continue;const en=new Float32Array(16);s.br(en,We.projMatrix,St),st(We,Ut,un,i.translatePosMatrix(en,it,he,_e),Ae)}}}function zc(m,i,c,p,y,v,w){p.centroidVertexArray.length===0&&p.createCentroidsBuffer();const S=v?v.findDEMTileFor(c):null;if(!(S&&S.dem||w))return;v&&S&&S.dem&&p.selfDEMTileTimestamp!==S.dem._timestamp&&(p.borderDoneWithNeighborZ=[-1,-1,-1,-1],p.selfDEMTileTimestamp=S.dem._timestamp);const I=Z=>new s.P(Math.ceil((Z+s.ea)*s.eb),0),O=Z=>{const ee=i.getSource().minzoom,ie=me=>{const fe=i.getTileByID(me);if(fe&&fe.hasData())return fe.getBucket(y)},se=[0,-1,1];for(const me of se){if(Z.overscaledZ+me<ee)continue;const fe=ie(Z.calculateScaledKey(Z.overscaledZ+me));if(fe)return fe}},D=[0,0,0],N=(Z,ee)=>(D[0]=Math.min(Z.min.y,ee.min.y),D[1]=Math.max(Z.max.y,ee.max.y),D[2]=s.al-ee.min.x>Z.max.x?ee.min.x-s.al:Z.max.x,D),z=(Z,ee)=>(D[0]=Math.min(Z.min.x,ee.min.x),D[1]=Math.max(Z.max.x,ee.max.x),D[2]=s.al-ee.min.y>Z.max.y?ee.min.y-s.al:Z.max.y,D),U=[(Z,ee)=>N(Z,ee),(Z,ee)=>N(ee,Z),(Z,ee)=>z(Z,ee),(Z,ee)=>z(ee,Z)],G=(Z,ee,ie,se,me,fe,ge)=>{if(!v)return 0;const pe=[[fe?ie:Z,fe?Z:ie,0],[fe?ie:ee,fe?ee:ie,0]],he=ge<0?s.al+ge:ge,_e=[fe?he:(Z+ee)/2,fe?(Z+ee)/2:he,0];return ie===0&&ge<0||ie!==0&&ge>0?v.getForTilePoints(me,[_e],!0,se):pe.push(_e),v.getForTilePoints(c,pe,!0,S),Math.max(pe[0][2],pe[1][2],_e[2])/v.exaggeration()};for(let Z=0;Z<4;Z++){const ee=p.borderFeatureIndices[Z];if(ee.length===0)continue;const ie=s.e6[Z](c),se=O(ie);if(!(se&&se instanceof s.e7))continue;const me=v?v.findDEMTileFor(ie):null;if(!(me&&me.dem||w)||(v&&me&&me.dem&&p.borderDEMTileTimestamp[Z]!==me.dem._timestamp&&(p.borderDoneWithNeighborZ[Z]=-1,p.borderDEMTileTimestamp[Z]=me.dem._timestamp),p.borderDoneWithNeighborZ[Z]===se.canonical.z))continue;se.centroidVertexArray.length===0&&se.createCentroidsBuffer();const fe=(Z<2?1:5)-Z,ge=se.borderDoneWithNeighborZ[fe]!==p.canonical.z,pe=se.borderFeatureIndices[fe];let he=0;if(p.canonical.z!==se.canonical.z){for(const _e of ee)p.showCentroid(p.featuresOnBorder[_e]);if(ge)for(const _e of pe)se.showCentroid(se.featuresOnBorder[_e]);p.borderDoneWithNeighborZ[Z]=se.canonical.z,se.borderDoneWithNeighborZ[fe]=p.canonical.z}for(const _e of ee){const Ke=p.featuresOnBorder[_e],Le=p.centroidData[Ke.centroidDataIndex],st=Ke.borders[Z];let We;for(;he<pe.length;){We=se.featuresOnBorder[pe[he]];const it=We.borders[fe];if(it[1]>st[0]+3||it[0]>st[0]-3)break;se.showCentroid(We),he++}if(We&&he<pe.length){const it=he;let Pt=0;for(;!(We.borders[fe][0]>st[1]-3)&&(Pt++,++he!==pe.length);)We=se.featuresOnBorder[pe[he]];We=se.featuresOnBorder[pe[it]];let qe=!1;if(Pt>=1){const Je=We.borders[fe];Math.abs(st[0]-Je[0])<3&&Math.abs(st[1]-Je[1])<3&&(Pt=1,qe=!0,he=it+1)}else if(Pt===0){p.showCentroid(Ke);continue}const Ae=se.centroidData[We.centroidDataIndex];w&&qe&&(((H=Le).flags|(J=Ae).flags)&s.e9?(H.flags|=s.e9,J.flags|=s.e9):(H.flags&=~s.e9,J.flags&=~s.e9));const at=Ke.intersectsCount()>1||We.intersectsCount()>1;if(Pt>1)he=it,Le.centroidXY=Ae.centroidXY=new s.P(0,0);else if(me&&me.dem&&!at){const Je=U[Z](Le,Ae),_t=Z%2?s.al-1:0,At=G(Je[0],Math.min(s.al-1,Je[1]),_t,me,ie,Z<2,Je[2]);Le.centroidXY=Ae.centroidXY=I(At)}else at?Le.centroidXY=Ae.centroidXY=new s.P(0,0):(Le.centroidXY=p.encodeBorderCentroid(Ke),Ae.centroidXY=se.encodeBorderCentroid(We));p.writeCentroidToBuffer(Le),se.writeCentroidToBuffer(Ae)}else p.showCentroid(Ke)}p.borderDoneWithNeighborZ[Z]=se.canonical.z,se.borderDoneWithNeighborZ[fe]=p.canonical.z}var H,J;(p.needsCentroidUpdate||!p.centroidVertexBuffer&&p.centroidVertexArray.length!==0)&&p.uploadCentroid(m)}const Fc=[1,0,0],Cn=[0,1,0],j_=[0,0,1];function Fb(m,i,c){const p=c.transform,y=c.shadowRenderer;if(!y)return!0;const v=m.toUnwrapped(),w=p.tileSize*y._cascades[c.currentShadowCascade].scale;let S=i;if(p.elevation){const H=p.elevation.getMinMaxForTile(m);H&&(S+=H.max)}const I=[...y.shadowDirection];I[2]=-I[2];const O=y.computeSimplifiedTileShadowVolume(v,S,w,I);if(!O)return!1;const D=[Fc,Cn,j_,I,[I[0],0,I[2]],[0,I[1],I[2]]],N=p.projection.name==="globe",z=p.scaleZoom(w),U=s.cA.fromInvProjectionMatrix(p.invProjMatrix,p.worldSize,z,!N),G=y.getCurrentCascadeFrustum();return U.intersectsPrecise(O.vertices,O.planes,D)===0||G.intersectsPrecise(O.vertices,O.planes,D)===0}function mm(m){const{painter:i,source:c,layer:p,coords:y}=m;let v=m.defines;const w=i.context,S=i.renderPass==="shadow",I=i.renderPass==="light-beam",O=i.shadowRenderer,D=s.ec(i.transform.center.lat,i.transform.zoom),N=Pc(i,p.paint.get("building-cutoff-fade-range"));N.shouldRenderCutoff&&(v=v.concat("RENDER_CUTOFF"));for(const z of y){const U=c.getTile(z),G=U.getBucket(p);if(!G)continue;O&&O.getMaxCascadeForTile(z.toUnwrapped())===0&&(v=v.concat("SHADOWS_SINGLE_CASCADE"));const H=G.programConfigurations.get(p.id);let J,Z,ee,ie=i.translatePosMatrix(z.expandedProjMatrix,U,[0,0],"map");if(ie=s.cR(s.bC(),ie,[1,1,m.verticalScale]),S&&O){if(Fb(U.tileID,G.maxHeight*D,i))continue;let me=O.calculateShadowPassMatrixFromTile(U.tileID.toUnwrapped());me=s.cR(s.bC(),me,[1,1,m.verticalScale]),ee=k_(me),J=Z=i.getOrCreateProgram("buildingDepth",{config:H,defines:v,overrideFog:!1})}else if(I)J=Z=i.getOrCreateProgram("buildingBloom",{config:H,defines:v,overrideFog:!1}),ee=mS(ie);else{const me=i.transform.calculatePosMatrix(z.toUnwrapped(),i.transform.worldSize);s.cR(me,me,[1,1,m.verticalScale]);const fe=s.bC();s.cR(fe,me,[1,-1,1/D]),s.bl(fe,fe),s.ed(fe,fe);const ge=i.transform.getFreeCameraOptions().position,pe=1<<z.canonical.z;ee=pS(ie,fe,m.opacity,m.facadeAOIntensity,[((ge.x-z.wrap)*pe-z.canonical.x)*s.al,(ge.y*pe-z.canonical.y)*s.al,ge.z*pe*s.al],G.tileToMeter,m.facadeEmissiveChance),Z=i.getOrCreateProgram("building",{config:H,defines:v,overrideFog:!1});const he=v.concat(["BUILDING_FAUX_FACADE","HAS_ATTRIBUTE_a_faux_facade_color_emissive"]);J=i.getOrCreateProgram("building",{config:H,defines:he,overrideFog:!1}),O&&(O.setupShadowsFromMatrix(me,Z,!0),O.setupShadowsFromMatrix(me,J,!0))}const se=(me,fe)=>{if(I){const ge=me.entranceBloom;fe.draw(i,w.gl.TRIANGLES,m.depthMode,Tn.disabled,m.blendMode,Dn.disabled,ee,p.id,ge.layoutVertexBuffer,ge.indexBuffer,ge.segmentsBucket,p.paint,i.transform.zoom,H,[ge.layoutAttenuationBuffer,ge.layoutColorBuffer])}else{const ge=me.segmentsBucket;let pe=[me.layoutNormalBuffer,me.layoutCentroidBuffer,me.layoutColorBuffer];me.layoutFacadePaintBuffer&&(pe=pe.concat([me.layoutFacadeDataBuffer,me.layoutFacadeVerticalRangeBuffer,me.layoutFacadePaintBuffer])),fe.draw(i,w.gl.TRIANGLES,m.depthMode,Tn.disabled,m.blendMode,S?Dn.disabled:Dn.backCW,ee,p.id,me.layoutVertexBuffer,me.indexBuffer,ge,p.paint,i.transform.zoom,H,pe)}};i.uploadCommonUniforms(w,Z,z.toUnwrapped(),null,N),G.buildingWithoutFacade&&se(G.buildingWithoutFacade,Z),J!==Z&&i.uploadCommonUniforms(w,J,z.toUnwrapped(),null,N),G.buildingWithFacade&&se(G.buildingWithFacade,J)}}function gm(m){return[m[0]*s.ee,m[1]*s.ee,m[2]*s.ee,0]}function _m(m,i,c,p,y,v,w,S,I){const O=p.getSource(),D=c.globeSharedBuffers;if(!D)return;let N,z,U;if(i&&(N=p.getTile(i)),O instanceof s.aS?(z=O.texture,U=s.dG(0,0,c.transform)):N&&i&&(z=N.texture,U=s.dG(i.canonical.z,i.canonical.x,c.transform)),!z||!U)return;m||(U=s.cR(s.bC(),U,[1,-1,1]));const G=c.context,H=G.gl,J=y.paint.get("raster-resampling")==="nearest"?H.NEAREST:H.LINEAR,Z=c.colorModeForDrapableLayerRenderPass(v),ee=w.defines;ee.push("GLOBE_POLES");const ie=new Gt(H.LEQUAL,Gt.ReadWrite,c.depthRangeFor3D),se=Float32Array.from(c.transform.expandedFarZProjMatrix),me=Float32Array.from(s.bk(s.dF(new s.cC(0,0,0))));c.terrain&&c.terrain.prepareDrawTile(),G.activeTexture.set(H.TEXTURE0),z.bind(J,H.CLAMP_TO_EDGE),G.activeTexture.set(H.TEXTURE1),z.bind(J,H.CLAMP_TO_EDGE),"useMipmap"in z&&G.extTextureFilterAnisotropic&&c.transform.pitch>20&&H.texParameterf(H.TEXTURE_2D,G.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,G.extTextureFilterAnisotropicMax);const[fe,ge,pe,he]=i?D.getPoleBuffers(i.canonical.z,!1):D.getPoleBuffers(0,!0),_e=y.paint.get("raster-elevation");let Ke;m?(Ke=fe,c.renderDefaultNorthPole=_e!==0):(Ke=ge,c.renderDefaultSouthPole=_e!==0);const Le=gm(w.mix),st=((it,Pt,qe,Ae,at,Je,_t,At,Ut,St,bt,un,en)=>sm(it,Pt,qe,new Float32Array(16),new Float32Array(9),[0,0],Ae,[0,0],[0,0,0,0],1,{opacity:1,mix:0},Je,[0,0],At,2,St,bt,un,1,0,en))(se,me,U,s.aj(c.transform.zoom),0,y,0,_e,0,Le,w.offset,w.range,v),We=c.getOrCreateProgram("raster",{defines:ee});c.uploadCommonUniforms(G,We,null),We.draw(c,H.TRIANGLES,ie,I,Z,S,st,y.id,Ke,pe,he)}function yS(m){const i=m._nearZ,c=m.projection.farthestPixelDistance(m),p=c-i,y=.2*m.height,v=i+y;return[i,c,(v-y-i)/p,(v-i)/p]}function Bb(m,i,c,p){if(m)return i instanceof gl&&m instanceof Su?i.getTextureDescriptor(m,c,!0):{texture:m.texture,mix:gm(p.mix),offset:p.offset,buffer:0,tileSize:1}}var vS=s.ef([{name:"a_index",type:"Int16",components:1}]);class bS{constructor(i,c,p,y){const v={width:p[0],height:p[1],data:null},w=i.gl;this.targetColorTexture=new s.T(i,v,w.RGBA8,{useMipmap:!1}),this.backgroundColorTexture=new s.T(i,v,w.RGBA8,{useMipmap:!1}),this.context=i,this.updateParticleTexture(c,y),this.lastInvalidatedAt=0}updateParticleTexture(i,c){if(this.particleTextureDimension===c.width)return;(this.particleTexture0||this.particleTexture1||this.particleIndexBuffer||this.particleSegment)&&(this.particleTexture0.destroy(),this.particleTexture1.destroy(),this.particleIndexBuffer.destroy(),this.particleSegment.destroy());const p=this.context.gl,y=c.width*c.height;this.particleTexture0=new s.T(this.context,c,p.RGBA8,{premultiply:!1,useMipmap:!1}),this.particleTexture1=new s.T(this.context,c,p.RGBA8,{premultiply:!1,useMipmap:!1});const v=new s.eg;v.reserve(y);for(let w=0;w<y;w++)v.emplaceBack(w);this.particleIndexBuffer=this.context.createVertexBuffer(v,vS.members,!0),this.particleSegment=s.bg.simpleSegment(0,0,this.particleIndexBuffer.length,0),this.particleTextureDimension=c.width}update(i){return!(this.lastInvalidatedAt<i&&(this.lastInvalidatedAt=s.o.now(),1))}destroy(){this.targetColorTexture.destroy(),this.backgroundColorTexture.destroy(),this.particleIndexBuffer.destroy(),this.particleTexture0.destroy(),this.particleTexture1.destroy(),this.particleSegment.destroy()}}function Xs(m,i,c){if(!m)return null;const p=i.getTextureDescriptor(m,c,!0);if(!p)return null;let{texture:y,mix:v,offset:w,tileSize:S,buffer:I,format:O}=p;if(!y||!O)return null;let D=!1;return O==="uint32"&&(D=!0,v[3]=0,v=D_(s.eh,v,[0,c.paint.get("raster-particle-max-speed")]),w=L_(s.eh,w,[0,c.paint.get("raster-particle-max-speed")])),{texture:y,textureOffset:[I/(S+2*I),S/(S+2*I)],tileSize:S,scalarData:D,scale:v,offset:w,defines:["RASTER_ARRAY",{uint8:"DATA_FORMAT_UINT8",uint16:"DATA_FORMAT_UINT16",uint32:"DATA_FORMAT_UINT32"}[O]]}}function G_(m){const i=m._nearZ,c=m.projection.farthestPixelDistance(m),p=c-i,y=.2*m.height,v=i+y;return[i,c,(v-y-i)/p,(v-i)/p]}const ws=new s.ao(1,0,0,1),Bc=new s.ao(0,1,0,1),Nb=new s.ao(0,0,1,1),H_=new s.ao(1,0,1,1),W_=new s.ao(0,1,1,1);function ym(m,i,c,p,y,v){for(let w=0;w<c.length;w++)if(y){const O=new s.ao(p.r*.8,p.g*.8,p.b*.8,1);ju(m,i,c[w],p,-1,-1,v),ju(m,i,c[w],p,-1,1,v),ju(m,i,c[w],p,1,1,v),ju(m,i,c[w],p,1,-1,v),ju(m,i,c[w],O,0,0,v)}else ju(m,i,c[w],p,0,0,v)}function ju(m,i,c,p,y,v,w){const S=m.context,I=m.transform,O=S.gl,D=I.projection.name==="globe",N=D?["PROJECTION_GLOBE_VIEW"]:[];let z=s.bz(c.projMatrix);if(D&&s.aj(I.zoom)>0){const Le=s.bj(c.canonical,I),st=s.ei(Le);z=s.aB(new Float32Array(16),I.globeMatrix,st),s.aB(z,I.projMatrix,z)}const U=s.bC();U[12]+=2*y/(s.o.devicePixelRatio*I.width),U[13]+=2*v/(s.o.devicePixelRatio*I.height),s.aB(z,U,z);const G=m.getOrCreateProgram("debug",{defines:N}),H=i.getTileByID(c.key);m.terrain&&m.terrain.setupElevationDraw(H,G);const J=Gt.disabled,Z=Tn.disabled,ee=m.colorModeForRenderPass(),ie="$debug";S.activeTexture.set(O.TEXTURE0),m.emptyTexture.bind(O.LINEAR,O.CLAMP_TO_EDGE),D?H._makeGlobeTileDebugBuffers(m.context,I):H._makeDebugTileBoundsBuffers(m.context,I.projection);const se=H._tileDebugBuffer||m.debugBuffer,me=H._tileDebugIndexBuffer||m.debugIndexBuffer,fe=H._tileDebugSegments||m.debugSegments;if(G.draw(m,O.LINE_STRIP,J,Z,ee,Dn.disabled,M_(z,p.toPremultipliedRenderColor(null)),ie,se,me,fe,null,null,null,[H._globeTileDebugBorderBuffer]),w){const Le=H.latestRawTileData,st=Math.floor((Le&&Le.byteLength||0)/1024);let We=c.canonical.toString();c.overscaledZ!==c.canonical.z&&(We+=` => ${c.overscaledZ}`),We+=` ${H.state}`,We+=` ${st}kb`,(function(it,Pt){it.initDebugOverlayCanvas();const qe=it.debugOverlayCanvas,Ae=it.context.gl,at=it.debugOverlayCanvas.getContext("2d");at.clearRect(0,0,qe.width,qe.height),at.shadowColor="white",at.shadowBlur=2,at.lineWidth=1.5,at.strokeStyle="white",at.textBaseline="top",at.font="bold 36px Open Sans, sans-serif",at.fillText(Pt,5,5),at.strokeText(Pt,5,5),it.debugOverlayTexture.update(qe),it.debugOverlayTexture.bind(Ae.LINEAR,Ae.CLAMP_TO_EDGE)})(m,We)}const ge=i.getTile(c).tileSize,pe=512/Math.min(ge,512)*(c.overscaledZ/I.zoom)*.5,he=H._tileDebugTextBuffer||m.debugBuffer,_e=H._tileDebugTextIndexBuffer||m.quadTriangleIndexBuffer,Ke=H._tileDebugTextSegments||m.debugSegments;G.draw(m,O.TRIANGLES,J,Z,In.alphaBlended,Dn.disabled,M_(z,s.ao.transparent.toPremultipliedRenderColor(null),pe),ie,he,_e,Ke,null,null,null,[H._globeTileDebugTextBuffer])}function El(m,i,c,p){Gu(m,0,i+c/2,m.transform.width,c,p)}function pi(m,i,c,p){Gu(m,i-c/2,0,c,m.transform.height,p)}function Gu(m,i,c,p,y,v){const w=m.context,S=w.gl;S.enable(S.SCISSOR_TEST),S.scissor(i*s.o.devicePixelRatio,c*s.o.devicePixelRatio,p*s.o.devicePixelRatio,y*s.o.devicePixelRatio),w.clear({color:v}),S.disable(S.SCISSOR_TEST)}const q_=s.ef([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:Vb}=q_;function Jl(m,i,c,p){m.emplaceBack(i,c,p)}class K_{constructor(i){this.vertexArray=new s.ej,this.indices=new s.b1,Jl(this.vertexArray,-1,-1,1),Jl(this.vertexArray,1,-1,1),Jl(this.vertexArray,-1,1,1),Jl(this.vertexArray,1,1,1),Jl(this.vertexArray,-1,-1,-1),Jl(this.vertexArray,1,-1,-1),Jl(this.vertexArray,-1,1,-1),Jl(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=i.createVertexBuffer(this.vertexArray,Vb),this.indexBuffer=i.createIndexBuffer(this.indices),this.segment=s.bg.simpleSegment(0,0,36,12)}}function Hu(m,i,c,p,y,v){const w=m.context.gl,S=i.paint.get("sky-atmosphere-color"),I=i.paint.get("sky-atmosphere-halo-color"),O=i.paint.get("sky-atmosphere-sun-intensity"),D=((N,z,U,G,H)=>({u_matrix_3f:N,u_sun_direction:z,u_sun_intensity:U,u_color_tint_r:[G.r,G.g,G.b,G.a],u_color_tint_m:[H.r,H.g,H.b,H.a],u_luminance:5e-5}))(s.el(s.dL(),p),y,O,S.toPremultipliedRenderColor(null),I.toPremultipliedRenderColor(null));w.framebufferTexture2D(w.FRAMEBUFFER,w.COLOR_ATTACHMENT0,w.TEXTURE_CUBE_MAP_POSITIVE_X+v,i.skyboxTexture,0),c.draw(m,w.TRIANGLES,Gt.disabled,Tn.disabled,In.unblended,Dn.frontCW,D,"skyboxCapture",i.skyboxGeometry.vertexBuffer,i.skyboxGeometry.indexBuffer,i.skyboxGeometry.segment)}const Wu=s.ef([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class qu{constructor(i){const c=new s.em;c.emplaceBack(-1,1,1,0,0),c.emplaceBack(1,1,1,1,0),c.emplaceBack(1,-1,1,1,1),c.emplaceBack(-1,-1,1,0,1);const p=new s.b1;p.emplaceBack(0,1,2),p.emplaceBack(2,3,0),this.vertexBuffer=i.createVertexBuffer(c,Wu.members),this.indexBuffer=i.createIndexBuffer(p),this.segments=s.bg.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const It=s.ef([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_size_scale",components:1},{type:"Float32",name:"a_fade_opacity",components:1}]);class $t{constructor(){this.starsCount=16e3,this.sizeMultiplier=.15,this.sizeRange=100,this.intensityRange=200}}class Jd{constructor(i){this.colorModeAlphaBlendedWriteRGB=new In([1,$i,1,$i],s.ao.transparent,[!0,!0,!0,!1]),this.colorModeWriteAlpha=new In([1,0,1,0],s.ao.transparent,[!1,!1,!1,!0]),this.params=new $t,this.updateNeeded=!0,i.tp.registerParameter(this.params,["Stars"],"starsCount",{min:100,max:16e3,step:1},(()=>{this.updateNeeded=!0})),i.tp.registerParameter(this.params,["Stars"],"sizeMultiplier",{min:.01,max:2,step:.01}),i.tp.registerParameter(this.params,["Stars"],"sizeRange",{min:0,max:200,step:1},(()=>{this.updateNeeded=!0})),i.tp.registerParameter(this.params,["Stars"],"intensityRange",{min:0,max:200,step:1},(()=>{this.updateNeeded=!0}))}update(i){const c=i.context;if(!this.atmosphereBuffer||this.updateNeeded){this.updateNeeded=!1,this.atmosphereBuffer=new qu(c);const p=this.params.sizeRange,y=this.params.intensityRange,v=(function(D){const N=s.eo(30),z=[];for(let U=0;U<D;++U){const G=2*Math.PI*N(),H=Math.acos(1-2*N())-.5*Math.PI;z.push(s.d4(Math.cos(H)*Math.cos(G),Math.cos(H)*Math.sin(G),Math.sin(H)))}return z})(this.params.starsCount),w=s.eo(300),S=new s.en,I=new s.b1;let O=0;for(let D=0;D<v.length;++D){const N=s.c4([],v[D],200),z=Math.max(0,1+.01*p*(1*w()-.5)),U=Math.max(0,1+.01*y*(1*w()-.5));S.emplaceBack(N[0],N[1],N[2],-1,-1,z,U),S.emplaceBack(N[0],N[1],N[2],1,-1,z,U),S.emplaceBack(N[0],N[1],N[2],1,1,z,U),S.emplaceBack(N[0],N[1],N[2],-1,1,z,U),I.emplaceBack(O+0,O+1,O+2),I.emplaceBack(O+0,O+2,O+3),O+=4}this.starsVx=c.createVertexBuffer(S,It.members),this.starsIdx=c.createIndexBuffer(I),this.starsSegments=s.bg.simpleSegment(0,0,S.length,I.length)}}destroy(){this.atmosphereBuffer&&this.atmosphereBuffer.destroy(),this.starsVx&&this.starsVx.destroy(),this.starsIdx&&this.starsIdx.destroy()}drawAtmosphereGlow(i,c){const p=i.context,y=p.gl,v=i.transform,w=new Gt(y.LEQUAL,Gt.ReadOnly,[0,1]),S=s.aj(v.zoom),I=i.style.getLut(c.scope),O=c.properties.get("color-use-theme")==="none",D=c.properties.get("color").toNonPremultipliedRenderColor(O?null:I),N=c.properties.get("high-color-use-theme")==="none",z=c.properties.get("high-color").toNonPremultipliedRenderColor(N?null:I),U=c.properties.get("space-color-use-theme")==="none",G=c.properties.get("space-color").toNonPremultipliedRenderColor(U?null:I),H=5e-4,J=s.ep(c.properties.get("horizon-blend"),0,1,H,.25),Z=s.dA(i,p,v)&&J===H?v.worldSize/(2*Math.PI*1.025)-1:v.globeRadius,ee=i.frameCounter/1e3%1,ie=s.ag(v.globeCenterInViewSpace),se=Math.sqrt(Math.pow(ie,2)-Math.pow(Z,2)),me=Math.acos(se/ie),fe=ge=>{const pe=v.projection.name==="globe"?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"];ge&&pe.push("ALPHA_PASS");const he=i.getOrCreateProgram("globeAtmosphere",{defines:pe}),_e=((Le,st,We,it,Pt,qe,Ae,at,Je,_t,At,Ut)=>({u_frustum_tl:Le,u_frustum_tr:st,u_frustum_br:We,u_frustum_bl:it,u_horizon:Pt,u_transition:qe,u_fadeout_range:Ae,u_atmosphere_fog_color:at.toArray01(),u_high_color:Je.toArray01(),u_space_color:_t.toArray01(),u_temporal_offset:At,u_horizon_angle:Ut}))(v.frustumCorners.TL,v.frustumCorners.TR,v.frustumCorners.BR,v.frustumCorners.BL,v.frustumCorners.horizon,S,J,D,z,G,ee,me);i.uploadCommonUniforms(p,he);const Ke=this.atmosphereBuffer;Ke&&he.draw(i,y.TRIANGLES,w,Tn.disabled,ge?this.colorModeWriteAlpha:this.colorModeAlphaBlendedWriteRGB,Dn.backCW,_e,ge?"atmosphere_glow_alpha":"atmosphere_glow",Ke.vertexBuffer,Ke.indexBuffer,Ke.segments)};fe(!1),fe(!0)}drawStars(i,c){const p=s.aA(c.properties.get("star-intensity"),0,1);if(p===0)return;const y=i.context,v=y.gl,w=i.transform,S=i.getOrCreateProgram("stars"),I=s.c6([]);s.c8(I,I,-w._pitch),s.c7(I,I,-w.angle),s.c8(I,I,s.an(w._center.lat)),s.eq(I,I,-s.an(w._center.lng));const O=s.cb(new Float32Array(16),I),D=s.aB([],w.starsProjMatrix,O),N=s.el([],O),z=s.er([],N),U=[0,1,0];s.dN(U,U,z),s.c4(U,U,this.params.sizeMultiplier);const G=[1,0,0];s.dN(G,G,z),s.c4(G,G,this.params.sizeMultiplier);const H=(J=U,Z=G,ee=p,{u_matrix:Float32Array.from(D),u_up:J,u_right:Z,u_intensity_multiplier:ee});var J,Z,ee;i.uploadCommonUniforms(y,S),this.starsVx&&this.starsIdx&&S.draw(i,v.TRIANGLES,Gt.disabled,Tn.disabled,this.colorModeAlphaBlendedWriteRGB,Dn.disabled,H,"atmosphere_stars",this.starsVx,this.starsIdx,this.starsSegments)}}class Wi{constructor(){this.visibleTiles=[]}updateBorders(i,c){const p=[],y=[],v=i._getRenderableCoordinates(!1,!0);for(const I of v){const O=i.getTile(I);if(!O.hasData())continue;const D=O.getBucket(c);D&&(D.isEmpty()||(p.push(I.key),y.push({bucket:D,tileID:I.canonical})))}let w=p.length!==this.visibleTiles.length;if(!w){p.sort();for(let I=0;I<p.length;I++)if(p[I]!==this.visibleTiles[I]){w=!0;break}}if(!w)return;const S=new Set;this.visibleTiles=p,y.sort(((I,O)=>I.tileID.z-O.tileID.z||I.tileID.x-O.tileID.x||I.tileID.y-O.tileID.y));for(const I of y){const O=new Array,D=new Array,N=I.bucket;for(const z of N.featuresOnBorder)S.has(z.featureId)?D.push(z.footprintIndex):(S.add(z.featureId),O.push(z.footprintIndex));N.updateFootprintHiddenFlags(O,s.es,!1),N.updateFootprintHiddenFlags(D,s.es,!0)}}}function $e(m,i){const c=[...m],p=i.cameraWorldSizeForFog/i.worldSize,y=s.bA([]);return s.cR(y,y,[p,p,1]),s.aB(c,y,c),s.aB(c,i.worldToFogMatrix,c),c}function vm(m,i,c,p,y){const v=c.material,w=p.context,{baseColorTexture:S,metallicRoughnessTexture:I}=v.pbrMetallicRoughness,{normalTexture:O,occlusionTexture:D,emissionTexture:N}=v;function z(G,H,J){if(G&&(m.push(H),w.activeTexture.set(w.gl.TEXTURE0+J),G.gfxTexture)){const{minFilter:Z,magFilter:ee,wrapS:ie,wrapT:se}=G.sampler;G.gfxTexture.bindExtraParam(Z,ee,ie,se)}}z(S,"HAS_TEXTURE_u_baseColorTexture",_o.BaseColor),z(I,"HAS_TEXTURE_u_metallicRoughnessTexture",_o.MetallicRoughness),z(O,"HAS_TEXTURE_u_normalTexture",_o.Normal),z(D,"HAS_TEXTURE_u_occlusionTexture",_o.Occlusion),z(N,"HAS_TEXTURE_u_emissionTexture",_o.Emission),y&&(y.texture||(y.texture=new s.dY(p.context,y.image,[y.image.height,y.image.height,y.image.height],w.gl.RGBA8)),w.activeTexture.set(w.gl.TEXTURE0+_o.LUT),y.texture&&y.texture.bind(w.gl.LINEAR,w.gl.CLAMP_TO_EDGE),m.push("APPLY_LUT_ON_GPU")),c.texcoordBuffer&&(m.push("HAS_ATTRIBUTE_a_uv_2f"),i.push(c.texcoordBuffer)),c.colorBuffer&&(m.push(c.colorBuffer.itemSize===12?"HAS_ATTRIBUTE_a_color_3f":"HAS_ATTRIBUTE_a_color_4f"),i.push(c.colorBuffer)),c.normalBuffer&&(m.push("HAS_ATTRIBUTE_a_normal_3f"),i.push(c.normalBuffer)),c.pbrBuffer&&(m.push("HAS_ATTRIBUTE_a_pbr"),m.push("HAS_ATTRIBUTE_a_heightBasedEmissiveStrength"),i.push(c.pbrBuffer)),v.alphaMode!=="OPAQUE"&&v.alphaMode!=="MASK"||m.push("UNPREMULT_TEXTURE_IN_SHADER"),v.defined||m.push("DIFFUSE_SHADED");const U=p.shadowRenderer;U&&(m.push("RENDER_SHADOWS","DEPTH_TEXTURE"),U.useNormalOffset&&m.push("NORMAL_OFFSET"))}function Ku(m,i,c,p,y,v){const w=c.paint.get("model-opacity").constantOr(1),S=i.context,I=new Gt(i.context.gl.LEQUAL,Gt.ReadWrite,i.depthRangeFor3D),O=i.transform,D=m.mesh,N=D.material,z=N.pbrMetallicRoughness,U=i.style.fog;let G;G=i.transform.projection.zAxisUnit==="pixels"?[...m.nodeModelMatrix]:s.aB([],p.zScaleMatrix,m.nodeModelMatrix),s.aB(G,p.negCameraPosMatrix,G);const H=s.bl([],G);s.ed(H,H);const J=c.paint.get("model-color-use-theme").constantOr("default")==="none",Z=c.paint.get("model-emissive-strength").constantOr(0),ee=um(new Float32Array(m.worldViewProjection),new Float32Array(G),new Float32Array(H),null,i,w,z.baseColorFactor,N.emissiveFactor,z.metallicFactor,z.roughnessFactor,N,Z,c),ie={defines:[]},se=[],me=i.shadowRenderer;me&&(me.useNormalOffset=!1),vm(ie.defines,se,D,i,J?null:c.lut);let fe=null;if(U){const he=$e(m.nodeModelMatrix,i.transform);if(fe=new Float32Array(he),O.projection.name!=="globe"){const _e=D.aabb.min,Ke=D.aabb.max,[Le,st]=U.getOpacityForBounds(he,_e[0],_e[1],Ke[0],Ke[1]);ie.overrideFog=Le>=on||st>=on}}const ge=Pc(i,c.paint.get("model-cutoff-fade-range"));ge.shouldRenderCutoff&&ie.defines.push("RENDER_CUTOFF");const pe=i.getOrCreateProgram("model",ie);i.uploadCommonUniforms(S,pe,null,fe,ge),i.renderPass!=="shadow"&&me&&me.setupShadowsFromMatrix(m.nodeModelMatrix,pe),pe.draw(i,S.gl.TRIANGLES,I,y,v,D.material.doubleSided?Dn.disabled:Dn.backCCW,ee,c.id,D.vertexBuffer,D.indexBuffer,D.segments,c.paint,i.transform.zoom,void 0,se)}function bm(m,i,c,p,y,v,w){let S;S=m.projection.name==="globe"?s.eu(c,m):[...c],s.aB(S,S,i.matrix);const I=s.aB([],p,S);if(i.meshes)for(const O of i.meshes){if(O.material.alphaMode!=="BLEND"){w.push({mesh:O,depth:0,modelIndex:y,worldViewProjection:I,nodeModelMatrix:S});continue}const D=s.af([],O.centroid,I);!m.isOrthographic&&D[2]<=0||v.push({mesh:O,depth:D[2],modelIndex:y,worldViewProjection:I,nodeModelMatrix:S})}if(i.children)for(const O of i.children)bm(m,O,c,p,y,v,w)}function Rf(m,i,c,p){const y=c.shadowRenderer;if(!y)return;const v=y.getShadowPassDepthMode(),w=y.getShadowPassColorMode(),S=y.calculateShadowPassMatrixFromMatrix(i),I=Xd(S);c.getOrCreateProgram("modelDepth",{defines:c._shadowMapDebug?[]:["DEPTH_TEXTURE"]}).draw(c,c.context.gl.TRIANGLES,v,Tn.disabled,w,Dn.backCCW,I,p.id,m.vertexBuffer,m.indexBuffer,m.segments,p.paint,c.transform.zoom,void 0,void 0)}function $b(m,i,c){const p=i.updateZoomBasedPaintProperties(),y=(function(v,w,S){let I,O,D,N=v.terrain?v.terrain.exaggeration():0;if(v.terrain&&N>0){const z=v.terrain,U=z.findDEMTileFor(S);U&&U.dem?I=s.ew.create(z,S,U):N=0}if(N===0&&(w.terrainElevationMin=0,w.terrainElevationMax=0),N===w.validForExaggeration&&(N===0||I&&I._demTile&&I._demTile.tileID===w.validForDEMTile.id&&I._dem._timestamp===w.validForDEMTile.timestamp))return!1;for(const z in w.instancesPerModel){const U=w.instancesPerModel[z];for(let G=0;G<U.instancedDataArray.length;++G){const H=(I?N*I.getElevationAt(0|U.instancedDataArray.float32[16*G],0|U.instancedDataArray.float32[16*G+1],!0,!0):0)+U.instancesEvaluatedElevation[G];U.instancedDataArray.float32[16*G+6]=H,O=O?Math.min(w.terrainElevationMin,H):H,D=D?Math.max(w.terrainElevationMax,H):H}}return w.terrainElevationMin=O||0,w.terrainElevationMax=D||0,w.validForExaggeration=N,w.validForDEMTile=I&&I._demTile?{id:I._demTile.tileID,timestamp:I._dem._timestamp}:{id:void 0,timestamp:0},!0})(m,i,c);(p||y)&&(i.uploaded=!1,i.upload(m.context))}const Qa={shadowUniformsInitialized:!1,useSingleShadowCascade:!1,tileMatrix:new Float64Array(16),shadowTileMatrix:new Float32Array(16),aabb:new s.d8([0,0,0],[s.al,s.al,0])};function Qd(m,i){const c=1<<m.canonical.z,p=i.getFreeCameraOptions().position,y=i.elevation,v=m.canonical.x/c,w=(m.canonical.x+1)/c,S=m.canonical.y/c,I=(m.canonical.y+1)/c;let O=i._centerAltitude;if(y){const U=y.getMinMaxForTile(m);U&&U.max>O&&(O=U.max)}const D=s.aA(p.x,v,w)-p.x,N=s.aA(p.y,S,I)-p.y,z=s.ce(O,i.center.lat)-p.z;return i._zoomFromMercatorZ(Math.sqrt(D*D+N*N+z*z))}function Ub(m,i,c,p,y,v,w){const S=m.context,I=m.renderPass==="shadow",O=m.shadowRenderer,D=I&&O?O.getShadowPassDepthMode():new Gt(S.gl.LEQUAL,Gt.ReadWrite,m.depthRangeFor3D),N=m.isTileAffectedByFog(v);if(c.meshes)for(const z of c.meshes){const U=["MODEL_POSITION_ON_GPU"],G=[];let H,J,Z;p.instancedDataArray.length>20&&U.push("INSTANCED_ARRAYS");const ee=Pc(m,i.paint.get("model-cutoff-fade-range"));if(ee.shouldRenderCutoff&&U.push("RENDER_CUTOFF"),I&&O)H=m.getOrCreateProgram("modelDepth",{defines:U}),J=Xd(w.shadowTileMatrix,w.shadowTileMatrix,Float32Array.from(c.matrix)),Z=O.getShadowPassColorMode();else{vm(U,G,z,m,i.paint.get("model-color-use-theme").constantOr("default")==="none"?null:i.lut),H=m.getOrCreateProgram("model",{defines:U,overrideFog:N});const se=z.material,me=se.pbrMetallicRoughness,fe=i.paint.get("model-opacity").constantOr(1),ge=i.paint.get("model-emissive-strength").constantOr(0);J=um(v.expandedProjMatrix,Float32Array.from(c.matrix),new Float32Array(16),null,m,fe,me.baseColorFactor,se.emissiveFactor,me.metallicFactor,me.roughnessFactor,se,ge,i,y),O&&(w.shadowUniformsInitialized?H.setShadowUniformValues(S,O.getShadowUniformValues()):(O.setupShadows(v.toUnwrapped(),H,"model-tile"),w.shadowUniformsInitialized=!0)),Z=ee.shouldRenderCutoff||fe<1||se.alphaMode!=="OPAQUE"?In.alphaBlended:In.unblended}m.uploadCommonUniforms(S,H,v.toUnwrapped(),null,ee);const ie=z.material.doubleSided?Dn.disabled:Dn.backCCW;if(p.instancedDataArray.length>20)G.push(p.instancedDataBuffer),H.draw(m,S.gl.TRIANGLES,D,Tn.disabled,Z,ie,J,i.id,z.vertexBuffer,z.indexBuffer,z.segments,i.paint,m.transform.zoom,void 0,G,p.instancedDataArray.length);else{const se=I?"u_instance":"u_normal_matrix";for(let me=0;me<p.instancedDataArray.length;++me)J[se]=new Float32Array(p.instancedDataArray.arrayBuffer,64*me,16),H.draw(m,S.gl.TRIANGLES,D,Tn.disabled,Z,ie,J,i.id,z.vertexBuffer,z.indexBuffer,z.segments,i.paint,m.transform.zoom,void 0,G)}}if(c.children)for(const z of c.children)Ub(m,i,z,p,y,v,w)}const xS=[1,-1,1];function jb(m,i,c,p){if(!c.modelManager)return!0;const y=c.modelManager;if(!c.shadowRenderer)return!0;const v=c.shadowRenderer,w=i.aabb;let S=!0,I=m.maxHeight;if(I===0){let D=0;for(const N in m.instancesPerModel){const z=y.getModel(N,p);z?D=Math.max(D,Math.max(Math.max(z.aabb.max[0],z.aabb.max[1]),z.aabb.max[2])):S=!1}I=m.maxScale*D*1.41+m.maxVerticalOffset,S&&(m.maxHeight=I)}w.max[2]=I,w.min[2]+=m.terrainElevationMin,w.max[2]+=m.terrainElevationMax,s.af(w.min,w.min,i.tileMatrix),s.af(w.max,w.max,i.tileMatrix);const O=w.intersects(v.getCurrentCascadeFrustum());return c.currentShadowCascade===0&&(m.isInsideFirstShadowMapFrustum=O===2),O===0}function xm(m,i){const c=m.uniformValues.u_cutoff_params[0],p=m.uniformValues.u_cutoff_params[1],y=m.uniformValues.u_cutoff_params[2],v=m.uniformValues.u_cutoff_params[3];return p===c||v===y?1:s.aA(((i-c)/(p-c)-y)/(v-y),0,1)}function Z_(m,i,c,p){if(i.pitch<20)return 1;const y=i.getWorldToCameraMatrix();s.aB(y,y,m);const v=s.bU(c.min[0],c.min[1],c.min[2],1);let w=s.aC(s.ex(),v,y),S=w,I=w;v[1]=c.max[1],w=s.aC(s.ex(),v,y),S=w[1]<S[1]?w:S,I=w[1]>I[1]?w:I,v[0]=c.max[0],w=s.aC(s.ex(),v,y),S=w[1]<S[1]?w:S,I=w[1]>I[1]?w:I,v[1]=c.min[1],w=s.aC(s.ex(),v,y),S=w[1]<S[1]?w:S,I=w[1]>I[1]?w:I;const O=s.aA(p[0],0,1),D=100*i.pixelsPerMeter*s.aA(p[1],0,1),N=s.aA(p[2],0,1),z=s.ey(s.ex(),S,I,O),U=Math.tan(.5*i.fovX),G=-z[2]*U;if(D===0)return z[1]<-Math.abs(G)?N:1;const H=(-Math.abs(G)-z[1])/D,J=(ee,ie,se)=>(1-se)*ee+se*ie,Z=s.aA(J(1,N,H),N,1);return J(1,Z,s.aA((i.pitch-20)/20,0,1))}class Gb{}class Hb{constructor(){this._storage=new Map}getLinesFromTrianglesBuffer(i,c,p){{const N=this._storage.get(c.id);if(N)return N.lastUsedFrameIdx=i,N.buf}const y=p.gl,v=y.getBufferParameter(y.ELEMENT_ARRAY_BUFFER,y.BUFFER_SIZE),w=new ArrayBuffer(v),S=new Int16Array(w);y.getBufferSubData(y.ELEMENT_ARRAY_BUFFER,0,new Int16Array(w));const I=new s.eA;for(let N=0;N<v/2;N+=3){const z=S[N],U=S[N+1],G=S[N+2];I.emplaceBack(z,U),I.emplaceBack(U,G),I.emplaceBack(G,z)}const O=p.bindVertexArrayOES.current,D=new Gb;return D.buf=new Dc(p,I),D.lastUsedFrameIdx=i,this._storage.set(c.id,D),p.bindVertexArrayOES.set(O),D.buf}update(i){for(const[c,p]of this._storage)i-p.lastUsedFrameIdx>30&&(p.buf.destroy(),this._storage.delete(c))}destroy(){for(const[i,c]of this._storage)c.buf.destroy(),this._storage.delete(i)}}class wm{constructor(i){this.occluderSize=30,this.depthOffset=-1e-4,i.registerParameter(this,["Occlusion"],"occluderSize",{min:1,max:100,step:1}),i.registerParameter(this,["Occlusion"],"depthOffset",{min:-.05,max:0,step:1e-5})}}const kf=s.ef([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_rainParticleData",components:4}]);class eh{registerParameter(){}registerButton(){}registerBinding(){}refreshUI(){}}class X_{constructor(i,c){this.revealStart=11,this.revealRange=2,i.registerParameter(this,[...c,"Reveal"],"revealStart",{min:0,max:17,step:.05}),i.registerParameter(this,[...c,"Reveal"],"revealRange",{min:.1,max:5.1,step:.05})}}const Wb=s.ef([{type:"Float32",name:"a_pos_2f",components:2}]);class wS{destroy(){this.vignetteVx&&this.vignetteVx.destroy(),this.vignetteIdx&&this.vignetteIdx.destroy()}draw(i,c){const p=i.getOrCreateProgram("vignette");if(!this.vignetteVx||!this.vignetteIdx){const w=new s.eB,S=new s.b1;w.emplaceBack(-1,-1),w.emplaceBack(1,-1),w.emplaceBack(1,1),w.emplaceBack(-1,1),S.emplaceBack(0,1,2),S.emplaceBack(0,2,3),this.vignetteVx=i.context.createVertexBuffer(w,Wb.members),this.vignetteIdx=i.context.createIndexBuffer(S)}const y=s.bg.simpleSegment(0,0,4,6);if(this.vignetteVx&&this.vignetteIdx){i.uploadCommonUniforms(i.context,p);const w={u_vignetteShape:(v={vignetteShape:[c.start,c.range,Math.pow(10,c.fadePower)],vignetteColor:[c.color.r,c.color.g,c.color.b,c.color.a*c.strength]}).vignetteShape,u_vignetteColor:v.vignetteColor};p.draw(i,i.context.gl.TRIANGLES,Gt.disabled,Tn.disabled,In.alphaBlended,Dn.disabled,w,"vignette",this.vignetteVx,this.vignetteIdx,y)}var v}}class qb{constructor(){this._accumulatedOffsetX=0,this._accumulatedOffsetY=0,this._accumulatedElevation=0}update(i,c){const p=i.getFreeCameraOptions().position,y=p.toAltitude(),v=p.toLngLat(),w=s.an(v.lng),S=s.an(v.lat),I=i.pixelsPerMeter/c,O=w*s.eD,D=s.eD*Math.log(Math.tan(Math.PI/4+S/2));if(this._offsetXPrev===void 0)this._offsetXPrev=0,this._offsetYPrev=0,this._elevationPrev=0,this._accumulatedOffsetX=0,this._accumulatedOffsetY=0,this._accumulatedElevation=0;else{const N=-this._offsetYPrev+D,z=-this._elevationPrev+y;this._accumulatedOffsetX+=(-this._offsetXPrev+O)*I,this._accumulatedOffsetY+=N*I,this._accumulatedElevation+=z*I,this._offsetXPrev=O,this._offsetYPrev=D,this._elevationPrev=y}}getPosition(){return[this._accumulatedOffsetX,this._accumulatedOffsetY,this._accumulatedElevation]}}function Kb(m,i){return[-(m[0]-Math.floor(m[0]/i)*i),-(m[1]-Math.floor(m[1]/i)*i),-(m[2]-Math.floor(m[2]/i)*i)]}function hs(m){const i=s.eo(1323123451230),c=[];for(let p=0;p<m;++p){const y=2*i()-1,v=2*i()-1,w=2*i()-1;c.push(s.d4(y,v,w))}return c}function Nc(m,i,c,p,y){const v=s.aA((y-c)/(p-c),0,1);return(1-v)*m+v*i}class th{constructor(i){this._movement=new qb,this._accumulatedTimeFromStart=0,this._prevTime=Date.now()/1e3,this._vignette=new wS,this._ppmScaleFactor=i}destroy(){this.particlesVx&&this.particlesVx.destroy(),this.particlesIdx&&this.particlesIdx.destroy(),this._vignette&&this._vignette.destroy()}updateOnRender(i,c){const p=i.transform;this._movement.update(p,this._ppmScaleFactor);const y=p.starsProjMatrix,v=s.c6([]);s.c8(v,v,s.an(90)-p._pitch),s.c7(v,v,-p.angle);const w=s.cb(new Float32Array(16),v),S=s.eC(1,0,0,0,0,0,1,0,0,-1,0,0,0,0,0,1),I=s.ed([],S),O=s.aB([],I,w),D=Date.now()/1e3;return this._accumulatedTimeFromStart+=(D-this._prevTime)*c,this._prevTime=D,{projectionMatrix:y,modelviewMatrix:O}}}class wi extends th{constructor(i){super(4.25),this._params={overrideStyleParameters:!1,intensity:.5,timeFactor:1,velocityConeAperture:0,velocity:300,boxSize:2500,dropletSizeX:1,dropletSizeYScale:10,distortionStrength:70,screenThinning:{intensity:.57,start:.46,range:1.17,fadePower:.17,affectedRatio:1,particleOffset:-.2},color:{r:.66,g:.68,b:.74,a:.7},direction:{x:-50,y:-35},shapeDirPower:2,shapeNormalPower:1},this._revealParams=new X_(i.tp,["Precipitation","Rain"]),this._vignetteParams={strength:1,start:.7,range:1,fadePower:.4,color:{r:.27,g:.27,b:.27,a:1}},this.particlesCount=16e3}update(i){const c=i.context;if(!this.particlesVx){const p=hs(this.particlesCount),y=new s.eE,v=new s.b1;let w=0;const S=s.eo(1323123451230);for(let I=0;I<p.length;++I){const O=p[I],D=[2*S()-1,S(),S(),S()];y.emplaceBack(O[0],O[1],O[2],-1,-1,...D),y.emplaceBack(O[0],O[1],O[2],1,-1,...D),y.emplaceBack(O[0],O[1],O[2],1,1,...D),y.emplaceBack(O[0],O[1],O[2],-1,1,...D),v.emplaceBack(w+0,w+1,w+2),v.emplaceBack(w+0,w+2,w+3),w+=4}this.particlesVx=c.createVertexBuffer(y,kf.members),this.particlesIdx=c.createIndexBuffer(v)}}draw(i){if(!this._params.overrideStyleParameters&&!i.style.rain)return;const c=this._params.overrideStyleParameters?this._revealParams:{revealStart:0,revealRange:.01},p=i.transform.zoom;if(c.revealStart>p)return;const y=Nc(0,1,c.revealStart,c.revealStart+c.revealRange,p);if(!this.particlesVx||!this.particlesIdx)return;const v=structuredClone(this._params);let w=[-v.direction.x,v.direction.y,-100];s.aw(w,w);const S=structuredClone(this._vignetteParams);S.strength*=y,v.overrideStyleParameters||(v.intensity=i.style.rain.state.density,v.timeFactor=i.style.rain.state.intensity,v.color=structuredClone(i.style.rain.state.color),w=structuredClone(i.style.rain.state.direction),v.screenThinning.intensity=i.style.rain.state.centerThinning,v.dropletSizeX=i.style.rain.state.dropletSize[0],v.dropletSizeYScale=i.style.rain.state.dropletSize[1]/i.style.rain.state.dropletSize[0],v.distortionStrength=100*i.style.rain.state.distortionStrength,S.strength=1,S.color=structuredClone(i.style.rain.state.vignetteColor));const I=this.updateOnRender(i,v.timeFactor),O=i.context,D=O.gl,N=i.transform;this.screenTexture&&this.screenTexture.size[0]===i.width&&this.screenTexture.size[1]===i.height||(this.screenTexture=new s.T(O,{width:i.width,height:i.height,data:null},D.RGBA8)),v.distortionStrength>0&&(O.activeTexture.set(D.TEXTURE0),this.screenTexture.bind(D.LINEAR,D.CLAMP_TO_EDGE),D.copyTexSubImage2D(D.TEXTURE_2D,0,0,0,0,0,i.width,i.height));const z=i.getOrCreateProgram("rainParticle");i.uploadCommonUniforms(O,z),O.activeTexture.set(D.TEXTURE0),this.screenTexture.bind(D.LINEAR,D.CLAMP_TO_EDGE);const U=[v.color.r,v.color.g,v.color.b,v.color.a],G=(H,J)=>{const Z=Kb(this._movement.getPosition(),H),ee=v.dropletSizeX,ie=v.dropletSizeX*v.dropletSizeYScale,se=i.width/2,me=i.height/2,fe=Nc(0,v.screenThinning.start,0,1,v.screenThinning.intensity),ge=Nc(.001,v.screenThinning.range,0,1,v.screenThinning.intensity),pe=Nc(0,v.screenThinning.particleOffset,0,1,v.screenThinning.intensity),he=(_e={modelview:I.modelviewMatrix,projection:I.projectionMatrix,time:this._accumulatedTimeFromStart,camPos:Z,velocityConeAperture:v.velocityConeAperture,velocity:v.velocity,boxSize:H,rainDropletSize:[ee,ie],distortionStrength:v.distortionStrength,rainDirection:w,color:U,screenSize:[N.width,N.height],thinningCenterPos:[se,me],thinningShape:[fe,ge,Math.pow(10,v.screenThinning.fadePower)],thinningAffectedRatio:v.screenThinning.affectedRatio,thinningParticleOffset:pe,shapeDirectionalPower:v.shapeDirPower,shapeNormalPower:v.shapeNormalPower,mode:J?0:1},{u_modelview:Float32Array.from(_e.modelview),u_projection:Float32Array.from(_e.projection),u_time:_e.time,u_cam_pos:_e.camPos,u_texScreen:0,u_velocityConeAperture:_e.velocityConeAperture,u_velocity:_e.velocity,u_boxSize:_e.boxSize,u_rainDropletSize:_e.rainDropletSize,u_distortionStrength:_e.distortionStrength,u_rainDirection:_e.rainDirection,u_color:_e.color,u_screenSize:_e.screenSize,u_thinningCenterPos:_e.thinningCenterPos,u_thinningShape:_e.thinningShape,u_thinningAffectedRatio:_e.thinningAffectedRatio,u_thinningParticleOffset:_e.thinningParticleOffset,u_shapeDirectionalPower:_e.shapeDirectionalPower,u_shapeNormalPower:_e.shapeNormalPower,u_mode:_e.mode});var _e;const Ke=Math.round(v.intensity*this.particlesCount),Le=s.bg.simpleSegment(0,0,4*Ke,2*Ke);z.draw(i,D.TRIANGLES,Gt.disabled,Tn.disabled,In.alphaBlended,Dn.disabled,he,"rain_particles",this.particlesVx,this.particlesIdx,Le)};v.distortionStrength>0&&G(v.boxSize,!0),G(v.boxSize,!1),this._vignette.draw(i,S)}}const gr=s.ef([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_snowParticleData",components:4},{type:"Float32",name:"a_snowParticleDataHorizontalOscillation",components:2}]);class Zb extends th{constructor(i){super(2.25),this._params={overrideStyleParameters:!1,intensity:.85,timeFactor:.75,velocityConeAperture:70,velocity:40,horizontalOscillationRadius:4,horizontalOscillationRate:1.5,boxSize:2e3,billboardSize:2,shapeFadeStart:.27,shapeFadePower:.21,screenThinning:{intensity:.4,start:.15,range:1.4,fadePower:.24,affectedRatio:1,particleOffset:-.2},color:{r:1,g:1,b:1,a:1},direction:{x:-50,y:-35}},this._revealParams=new X_(i.tp,["Precipitation","Snow"]),this._vignetteParams={strength:.3,start:.78,range:.46,fadePower:.2,color:{r:1,g:1,b:1,a:1}},this.particlesCount=16e3}update(i){const c=i.context;if(!this.particlesVx){const p=hs(this.particlesCount),y=new s.eF,v=new s.b1;let w=0;const S=s.eo(1323123451230);for(let I=0;I<p.length;++I){const O=p[I],D=S(),N=S(),z=S(),U=[I/p.length,D,N,z],G=[S(),S()];y.emplaceBack(O[0],O[1],O[2],-1,-1,...U,...G),y.emplaceBack(O[0],O[1],O[2],1,-1,...U,...G),y.emplaceBack(O[0],O[1],O[2],1,1,...U,...G),y.emplaceBack(O[0],O[1],O[2],-1,1,...U,...G),v.emplaceBack(w+0,w+1,w+2),v.emplaceBack(w+0,w+2,w+3),w+=4}this.particlesVx=c.createVertexBuffer(y,gr.members),this.particlesIdx=c.createIndexBuffer(v)}}draw(i){if(!this._params.overrideStyleParameters&&!i.style.snow)return;const c=structuredClone(this._params);let p=[-c.direction.x,c.direction.y,-100];s.aw(p,p);const y=structuredClone(this._vignetteParams),v=c.overrideStyleParameters?this._revealParams:{revealStart:0,revealRange:.01},w=i.transform.zoom;if(v.revealStart>w)return;const S=Nc(0,1,v.revealStart,v.revealStart+v.revealRange,w);y.strength*=S,c.overrideStyleParameters||(c.intensity=i.style.snow.state.density,c.timeFactor=i.style.snow.state.intensity,c.color=structuredClone(i.style.snow.state.color),p=structuredClone(i.style.snow.state.direction),c.screenThinning.intensity=i.style.snow.state.centerThinning,c.billboardSize=2.79*i.style.snow.state.flakeSize,y.strength=1,y.color=structuredClone(i.style.snow.state.vignetteColor));const I=this.updateOnRender(i,c.timeFactor);if(!this.particlesVx||!this.particlesIdx)return;const O=i.context,D=O.gl,N=i.transform,z=i.getOrCreateProgram("snowParticle");i.uploadCommonUniforms(O,z),((U,G,H)=>{const J=Kb(this._movement.getPosition(),U),Z=N.width/2,ee=N.height/2,ie=Nc(0,H.screenThinning.start,0,1,H.screenThinning.intensity),se=Nc(.001,H.screenThinning.range,0,1,H.screenThinning.intensity),me=Nc(0,H.screenThinning.particleOffset,0,1,H.screenThinning.intensity),fe=(ge={modelview:I.modelviewMatrix,projection:I.projectionMatrix,time:this._accumulatedTimeFromStart,camPos:J,velocityConeAperture:H.velocityConeAperture,velocity:H.velocity,horizontalOscillationRadius:H.horizontalOscillationRadius,horizontalOscillationRate:H.horizontalOscillationRate,boxSize:U,billboardSize:1*H.billboardSize,simpleShapeParameters:[H.shapeFadeStart,H.shapeFadePower],screenSize:[N.width,N.height],thinningCenterPos:[Z,ee],thinningShape:[ie,se,Math.pow(10,H.screenThinning.fadePower)],thinningAffectedRatio:H.screenThinning.affectedRatio,thinningParticleOffset:me,color:[H.color.r,H.color.g,H.color.b,H.color.a],direction:p},{u_modelview:Float32Array.from(ge.modelview),u_projection:Float32Array.from(ge.projection),u_time:ge.time,u_cam_pos:ge.camPos,u_velocityConeAperture:ge.velocityConeAperture,u_velocity:ge.velocity,u_horizontalOscillationRadius:ge.horizontalOscillationRadius,u_horizontalOscillationRate:ge.horizontalOscillationRate,u_boxSize:ge.boxSize,u_billboardSize:ge.billboardSize,u_simpleShapeParameters:ge.simpleShapeParameters,u_screenSize:ge.screenSize,u_thinningCenterPos:ge.thinningCenterPos,u_thinningShape:ge.thinningShape,u_thinningAffectedRatio:ge.thinningAffectedRatio,u_thinningParticleOffset:ge.thinningParticleOffset,u_particleColor:ge.color,u_direction:ge.direction});var ge;const pe=Math.round(H.intensity*this.particlesCount),he=s.bg.simpleSegment(0,0,4*pe,2*pe);this.particlesVx&&this.particlesIdx&&z.draw(i,D.TRIANGLES,Gt.disabled,Tn.disabled,In.alphaBlended,Dn.disabled,fe,"snow_particles",this.particlesVx,this.particlesIdx,he)})(c.boxSize,0,c),this._vignette.draw(i,y)}}const Vc={symbol:function(m,i,c,p,y){if(m.renderPass!=="translucent")return;const v=Tn.disabled,w=m.colorModeForRenderPass(),S=c.layout.get("text-variable-anchor"),I=c.layout.get("text-size-scale-range"),O=s.aA(m.scaleFactor,I[0],I[1]);S&&(function(z,U,G,H,J,Z,ee,ie){const se=U.transform,me=J==="map",fe=Z==="map";for(const ge of z){const pe=H.getTile(ge),he=pe.getBucket(G);if(!he||!he.text||!he.text.segments.get().length)continue;const _e=s.bK(he.textSizeData,se.zoom,ie),Ke=Ji(ge,he.getProjection(),se),Le=se.calculatePixelsToTileUnitsMatrix(pe),st=qs(Ke,pe.tileID.canonical,fe,me,se,he.getProjection(),Le),We=he.hasIconTextFit()&&he.hasIconData();_e&&fm(he,me,fe,ee,se,st,ge,Math.pow(2,se.zoom-pe.tileID.overscaledZ),_e,We)}})(p,m,c,i,c.layout.get("text-rotation-alignment"),c.layout.get("text-pitch-alignment"),y,O);const D=c.paint.get("icon-opacity").constantOr(1)!==0,N=c.paint.get("text-opacity").constantOr(1)!==0;c.layout.get("symbol-sort-key").constantOr(1)!==void 0&&(D||N)?Pf(m,i,c,p,v,w):(D&&Pf(m,i,c,p,v,w,{onlyIcons:!0}),N&&Pf(m,i,c,p,v,w,{onlyText:!0})),i.map.showCollisionBoxes&&(Af(m,i,c,p,c.paint.get("text-translate"),c.paint.get("text-translate-anchor"),!0),Af(m,i,c,p,c.paint.get("icon-translate"),c.paint.get("icon-translate-anchor"),!1))},circle:function(m,i,c,p){if(m.renderPass!=="translucent")return;const y=c.paint.get("circle-opacity"),v=c.paint.get("circle-stroke-width"),w=c.paint.get("circle-stroke-opacity"),S=c.layout.get("circle-sort-key").constantOr(1)!==void 0,I=c.paint.get("circle-emissive-strength");if(y.constantOr(1)===0&&(v.constantOr(1)===0||w.constantOr(1)===0))return;const O=m.context,D=O.gl,N=m.transform,z=!(!m.terrain||!m.terrain.enabled),U=c.layout.get("circle-elevation-reference"),G=m.depthModeForSublayer(0,Gt.ReadOnly),H=new Gt(m.context.gl.LEQUAL,Gt.ReadOnly,m.depthRangeFor3D),J=U==="none"||z?G:H,Z=Tn.disabled,ee=m.colorModeForDrapableLayerRenderPass(I),ie=N.projection.name==="globe",se=[s.aF(N.center.lng),s.aJ(N.center.lat)],me=[];for(let ge=0;ge<p.length;ge++){const pe=p[ge],he=i.getTile(pe),_e=he.getBucket(c);if(!_e||_e.projection.name!==N.projection.name)continue;const Ke=_e.programConfigurations.get(c.id),Le=_e.layoutVertexBuffer,st=_e.globeExtVertexBuffer,We=_e.indexBuffer,it=s.dZ(c),Pt=[st],qe=m.isTileAffectedByFog(pe);ie&&it.push("PROJECTION_GLOBE_VIEW"),it.push("DEPTH_D24"),m.terrain&&N.depthOcclusionForSymbolsAndCircles&&it.push("DEPTH_OCCLUSION"),_e.hasElevation&&!m.terrain&&(it.push("ELEVATED_ROADS"),Pt.push(_e.elevatedLayoutVertexBuffer));const Ae=m.getOrCreateProgram("circle",{config:Ke,defines:it,overrideFog:qe}),at=N.projection.createInversionMatrix(N,pe.canonical),Je={programConfiguration:Ke,program:Ae,layoutVertexBuffer:Le,dynamicBuffers:Pt,indexBuffer:We,uniformValues:s.d_(m,pe,he,at,se,c),tile:he};if(S){const _t=_e.segments.get();for(const At of _t)me.push({segments:new s.bg([At]),sortKey:At.sortKey,state:Je})}else me.push({segments:_e.segments,sortKey:0,state:Je})}S&&me.sort(((ge,pe)=>ge.sortKey-pe.sortKey));const fe={useDepthForOcclusion:N.depthOcclusionForSymbolsAndCircles};for(const ge of me){const{programConfiguration:pe,program:he,layoutVertexBuffer:_e,dynamicBuffers:Ke,indexBuffer:Le,uniformValues:st,tile:We}=ge.state,it=ge.segments;m.terrain&&m.terrain.setupElevationDraw(We,he,fe),m.uploadCommonUniforms(O,he,We.tileID.toUnwrapped()),he.draw(m,D.TRIANGLES,J,Z,ee,Dn.disabled,st,c.id,_e,Le,it,c.paint,N.zoom,pe,Ke)}},heatmap:function(m,i,c,p){if(c.paint.get("heatmap-opacity")!==0)if(m.renderPass==="offscreen"){const y=m.context,v=y.gl,w=Tn.disabled,S=new In([v.ONE,v.ONE,v.ONE,v.ONE],s.ao.transparent,[!0,!0,!0,!0]);(function(U,G,H,J){const Z=U.gl,ee=G.width*J,ie=G.height*J;U.activeTexture.set(Z.TEXTURE1),U.viewport.set([0,0,ee,ie]);let se=H.heatmapFbo;if(!se||se&&(se.width!==ee||se.height!==ie)){se&&se.destroy();const me=Z.createTexture();Z.bindTexture(Z.TEXTURE_2D,me),Z.texParameteri(Z.TEXTURE_2D,Z.TEXTURE_WRAP_S,Z.CLAMP_TO_EDGE),Z.texParameteri(Z.TEXTURE_2D,Z.TEXTURE_WRAP_T,Z.CLAMP_TO_EDGE),Z.texParameteri(Z.TEXTURE_2D,Z.TEXTURE_MIN_FILTER,Z.LINEAR),Z.texParameteri(Z.TEXTURE_2D,Z.TEXTURE_MAG_FILTER,Z.LINEAR),se=H.heatmapFbo=U.createFramebuffer(ee,ie,!0,null),(function(fe,ge,pe,he,_e,Ke){const Le=fe.gl;Le.texImage2D(Le.TEXTURE_2D,0,fe.extRenderToTextureHalfFloat?Le.RGBA16F:Le.RGBA,_e,Ke,0,Le.RGBA,fe.extRenderToTextureHalfFloat?Le.HALF_FLOAT:Le.UNSIGNED_BYTE,null),he.colorAttachment.set(pe)})(U,0,me,se,ee,ie)}else Z.bindTexture(Z.TEXTURE_2D,se.colorAttachment.get()),U.bindFramebuffer.set(se.framebuffer)})(y,m,c,m.transform.projection.name==="globe"?.5:.25),y.clear({color:s.ao.transparent});const I=m.transform,O=I.projection.name==="globe",D=O?["PROJECTION_GLOBE_VIEW"]:[],N=O?Dn.frontCCW:Dn.disabled,z=[s.aF(I.center.lng),s.aJ(I.center.lat)];for(let U=0;U<p.length;U++){const G=p[U];if(i.hasRenderableParent(G))continue;const H=i.getTile(G),J=H.getBucket(c);if(!J||J.projection.name!==I.projection.name)continue;const Z=m.isTileAffectedByFog(G),ee=J.programConfigurations.get(c.id),ie=m.getOrCreateProgram("heatmap",{config:ee,defines:D,overrideFog:Z}),{zoom:se}=m.transform;m.terrain&&m.terrain.setupElevationDraw(H,ie),m.uploadCommonUniforms(y,ie,G.toUnwrapped());const me=I.projection.createInversionMatrix(I,G.canonical);ie.draw(m,v.TRIANGLES,Gt.disabled,w,S,N,Db(m,G,H,me,z,se,c.paint.get("heatmap-intensity")),c.id,J.layoutVertexBuffer,J.indexBuffer,J.segments,c.paint,m.transform.zoom,ee,O?[J.globeExtVertexBuffer]:null)}y.viewport.set([0,0,m.width,m.height])}else m.renderPass==="translucent"&&(m.context.setColorMode(m.colorModeForRenderPass()),(function(y,v){const w=y.context,S=w.gl,I=v.heatmapFbo;if(!I)return;w.activeTexture.set(S.TEXTURE0),S.bindTexture(S.TEXTURE_2D,I.colorAttachment.get()),w.activeTexture.set(S.TEXTURE1);let O=v.colorRampTexture;O||(O=v.colorRampTexture=new s.T(w,v.colorRamp,S.RGBA8)),O.bind(S.LINEAR,S.CLAMP_TO_EDGE),y.getOrCreateProgram("heatmapTexture").draw(y,S.TRIANGLES,Gt.disabled,Tn.disabled,y.colorModeForRenderPass(),Dn.disabled,((D,N,z,U)=>({u_image:0,u_color_ramp:1,u_opacity:N.paint.get("heatmap-opacity")}))(0,v),v.id,y.viewportBuffer,y.quadTriangleIndexBuffer,y.viewportSegments,v.paint,y.transform.zoom)})(m,c))},line:function(m,i,c,p){if(m.renderPass!=="translucent")return;const y=c.paint.get("line-opacity"),v=c.paint.get("line-width");if(y.constantOr(1)===0||v.constantOr(1)===0)return;const w=c.paint.get("line-emissive-strength"),S=c.paint.get("line-occlusion-opacity"),I=c.layout.get("line-elevation-reference"),O=c.layout.get("line-width-unit")==="meters",D=I==="sea",N=!(!m.terrain||!m.terrain.enabled),z=m.context,U=z.gl;if(c.hasElevatedBuckets&&m.transform.projection.name==="globe")return;const G=c.layout.get("line-cross-slope"),H=G!==void 0,J=G<1,Z=m.colorModeForDrapableLayerRenderPass(w),ee=m.terrain&&m.terrain.renderingToTexture,ie=ee?1:s.o.devicePixelRatio,se=c.paint.get("line-dasharray"),me=se.constantOr(1),fe=c.layout.get("line-cap"),ge=se.constantOr(null),pe=fe.constantOr(null),he=c.paint.get("line-pattern"),_e=he.constantOr(1),Ke=c.paint.get("line-pattern-cross-fade"),Le=he.constantOr(null),st=c.paint.get("line-opacity").constantOr(1);let We=!_e&&st!==1||m.depthOcclusion&&S>0&&S<1;const it=c.paint.get("line-gradient"),Pt=_e?"linePattern":"line",qe=s.d$(c);let Ae;if(ee&&m.terrain&&m.terrain.clipOrMaskOverlapStencilType()&&(We=!1),S!==0&&m.depthOcclusion){const At=c.paint._values["line-opacity"];At&&At.value&&At.value.kind==="constant"?Ae=At.value:s.w(`Occlusion opacity for layer ${c.id} is supported only when line-opacity isn't data-driven.`)}v.value.kind!=="constant"&&v.value.isLineProgressConstant===!1&&qe.push("VARIABLE_LINE_WIDTH");const at=(At,Ut,St,bt,un,en)=>{for(const an of At){const Qt=i.getTile(an);if(_e&&!Qt.patternsLoaded())continue;const Ln=Qt.getBucket(c);if(!Ln||Ln.elevationType!=="none"&&!un||Ln.elevationType==="none"&&un)continue;m.prepareDrawTile();const Hn=[...Ut],qn=m.shadowRenderer,Wr=Ln.elevationType==="road"&&!!qn&&qn.enabled;let Bn=[0,0,0];if(Wr){const Kn=m.style.directionalLight,kn=m.style.ambientLight;Kn&&kn&&(Bn=Ja(m.style,Kn,kn)),Hn.push("RENDER_SHADOWS","DEPTH_TEXTURE","NORMAL_OFFSET")}const Or=Ln.programConfigurations.get(c.id);let Gr=!1;if(Le&&Qt.imageAtlas){const Kn=s.e0.from(Le),kn=Kn.getPrimary().scaleSelf(ie).toString(),qr=Qt.imageAtlas.patternPositions.get(kn),qi=Kn.getSecondary(),ki=qi?Qt.imageAtlas.patternPositions.get(qi.scaleSelf(ie).toString()):null;Gr=!!qr&&!!ki,qr&&Or.setConstantPatternPositions(qr,ki)}Ke>0&&(Gr||Or.getPatternTransitionVertexBuffer("line-pattern"))&&Hn.push("LINE_PATTERN_TRANSITION");const Ti=m.isTileAffectedByFog(an),Wn=m.getOrCreateProgram(Pt,{config:Or,defines:Hn,overrideFog:Ti});if(!_e&&ge&&pe&&Qt.lineAtlas){const Kn=Qt.lineAtlas.getDash(ge,pe);Kn&&Or.setConstantPatternPositions(Kn)}Wr&&qn.setupShadows(Qt.tileID.toUnwrapped(),Wn,"vector-tile");let[Lr,Mr]=c.paint.get("line-trim-offset");(pe==="round"||pe==="square")&&Lr!==Mr&&(Lr===0&&(Lr-=1),Mr===1&&(Mr+=1));const $r=ee?an.projMatrix:null,Ei=O?1/Ln.tileToMeter/s.ay(Qt,1,m.transform.zoom):1,no=O?1/Ln.tileToMeter/s.ay(Qt,1,Math.floor(m.transform.zoom)):1,Vo=_e?s.e1(m,Qt,c,$r,ie,Ei,no,[Lr,Mr],Bn,Ke):s.e2(m,Qt,c,$r,Ln.lineClipsArray.length,ie,Ei,no,[Lr,Mr],Bn);if(it){const Kn=Ln.gradients[c.id];let kn=Kn.texture;if(c.gradientVersion!==Kn.version){let qr=256;if(c.stepInterpolant){const qi=i.getSource().maxzoom,ki=an.canonical.z===qi?Math.ceil(1<<m.transform.maxZoom-an.canonical.z):1;qr=s.aA(s.e3(Ln.maxLineLength/s.al*1024*ki),256,z.maxTextureSize)}Kn.gradient=s.e4({expression:c.gradientExpression(),evaluationKey:"lineProgress",resolution:qr,image:Kn.gradient||void 0,clips:Ln.lineClipsArray}),Kn.texture?Kn.texture.update(Kn.gradient):Kn.texture=new s.T(z,Kn.gradient,U.RGBA8),Kn.version=c.gradientVersion,kn=Kn.texture}z.activeTexture.set(U.TEXTURE1),kn.bind(c.stepInterpolant?U.NEAREST:U.LINEAR,U.CLAMP_TO_EDGE)}me&&(z.activeTexture.set(U.TEXTURE0),Qt.lineAtlasTexture&&Qt.lineAtlasTexture.bind(U.LINEAR,U.REPEAT),Or.updatePaintBuffers()),_e&&(z.activeTexture.set(U.TEXTURE0),Qt.imageAtlasTexture&&Qt.imageAtlasTexture.bind(U.LINEAR,U.CLAMP_TO_EDGE),Or.updatePaintBuffers()),un&&!D&&m.terrain.setupElevationDraw(Qt,Wn),m.uploadCommonUniforms(z,Wn,an.toUnwrapped());const Ci=Kn=>{Ae!=null&&(Ae.value=st*S),Wn.draw(m,U.TRIANGLES,St,Kn,Z,Dn.disabled,Vo,c.id,Ln.layoutVertexBuffer,Ln.indexBuffer,Ln.segments,c.paint,m.transform.zoom,Or,[Ln.layoutVertexBuffer2,Ln.patternVertexBuffer,Ln.zOffsetVertexBuffer]),Ae!=null&&(Ae.value=st)};if(We&&!un){const Kn=m.stencilModeForClipping(an).ref;Kn===0&&ee&&z.clear({stencil:0});const kn={func:U.EQUAL,mask:255};Vo.u_alpha_discard_threshold=.8,Ci(new Tn(kn,Kn,255,U.KEEP,U.KEEP,U.INVERT)),Vo.u_alpha_discard_threshold=0,Ci(new Tn(kn,Kn,255,U.KEEP,U.KEEP,U.KEEP))}else Vo.u_alpha_discard_threshold=We&&un&&en?.8:0,Ci(un?bt:m.stencilModeForClipping(an))}};let Je=m.depthModeForSublayer(0,Gt.ReadOnly);const _t=new Gt(m.depthOcclusion?U.GREATER:U.LEQUAL,Gt.ReadOnly,m.depthRangeFor3D);if(c.hasNonElevatedBuckets){const At=!ee&&m.terrain;S!==0&&At?s.w(`Occlusion opacity for layer ${c.id} is supported on terrain only if the layer has line-z-offset enabled.`):At?s.w(`Cannot render non-elevated lines in immediate mode when terrain is enabled. Layer: ${c.id}.`):at(p,qe,Je,Tn.disabled,!1,!0)}if(c.hasElevatedBuckets){I==="hd-road-markup"?N||(Je=_t,qe.push("ELEVATED_ROADS")):(qe.push("ELEVATED"),Je=_t,H&&qe.push(J?"CROSS_SLOPE_HORIZONTAL":"CROSS_SLOPE_VERTICAL"),D&&qe.push("ELEVATION_REFERENCE_SEA"));const At=We?m.stencilModeFor3D():Tn.disabled;m.forceTerrainMode=!0,at(p,qe,Je,At,!0,!0),We&&at(p,qe,Je,At,!0,!1),m.forceTerrainMode=!1}We&&(m.resetStencilClippingMasks(),ee&&z.clear({stencil:0})),S===0||m.depthOcclusion||ee||m.layersWithOcclusionOpacity.push(m.currentLayer)},fill:function(m,i,c,p){const y=c.paint.get("fill-color"),v=c.paint.get("fill-opacity");if(v.constantOr(1)===0)return;const w=c.paint.get("fill-emissive-strength"),S=m.colorModeForDrapableLayerRenderPass(w),I=c.paint.get("fill-pattern"),O=m.opaquePassEnabledForLayer()&&!I.constantOr(1)&&y.constantOr(s.ao.transparent).a===1&&v.constantOr(0)===1?"opaque":"translucent";let D="none";c.layout.get("fill-elevation-reference")!=="none"?D="road":c.paint.get("fill-z-offset").constantOr(1)!==0&&(D="offset");const N=!(!m.terrain||!m.terrain.enabled),z={painter:m,sourceCache:i,layer:c,coords:p,colorMode:S,elevationType:D,terrainEnabled:N,pass:O};if(m.renderPass!=="shadow")if(D!=="offset"){if(Yd(z,!1),D==="road"){const U=!N&&m.renderPass==="translucent";U&&Uu(m,i,c,p,"geometry"),Yd(z,!0,Tn.disabled),U&&(function(G){const{painter:H,sourceCache:J,layer:Z,coords:ee,colorMode:ie}=G,se=H.context.gl,me=G.painter.shadowRenderer,fe=!!me&&me.enabled,ge=new Gt(H.context.gl.LEQUAL,Gt.ReadOnly,H.depthRangeFor3D);let pe=[0,0,0];if(fe){const _e=H.style.directionalLight,Ke=H.style.ambientLight;_e&&Ke&&(pe=Ja(H.style,_e,Ke))}const he=_e=>{for(const Ke of ee){const Le=J.getTile(Ke),st=Le.getBucket(Z);if(!st)continue;const We=st.elevatedStructures;if(!We)continue;let it,Pt;if(_e?(it=We.renderableBridgeSegments,Pt=We.bridgeProgramConfigurations.get(Z.id)):(it=We.renderableTunnelSegments,Pt=We.tunnelProgramConfigurations.get(Z.id)),!it||it.segments[0].primitiveLength===0)continue;Pt.updatePaintBuffers(),H.prepareDrawTile();const qe=H.isTileAffectedByFog(Ke),Ae=[];fe&&Ae.push("RENDER_SHADOWS","DEPTH_TEXTURE","NORMAL_OFFSET");const at=H.getOrCreateProgram("elevatedStructures",{config:Pt,overrideFog:qe,defines:Ae}),Je=H.translatePosMatrix(Ke.projMatrix,Le,Z.paint.get("fill-translate"),Z.paint.get("fill-translate-anchor"));fe&&me.setupShadows(Le.tileID.toUnwrapped(),at,"vector-tile");const _t=fS(Je,pe);H.uploadCommonUniforms(H.context,at,Ke.toUnwrapped()),at.draw(H,se.TRIANGLES,ge,Tn.disabled,ie,Dn.backCCW,_t,Z.id,We.vertexBuffer,We.indexBuffer,it,Z.paint,H.transform.zoom,Pt,[We.vertexBufferNormal])}};he(!0),he(!1)})(z)}}else Yd(z,!1,m.stencilModeFor3D());else m.shadowRenderer&&D==="road"&&!N&&(function(U){const{painter:G,sourceCache:H,layer:J,coords:Z}=U,ee=G.context.gl,ie=U.painter.shadowRenderer;for(const se of Z){const me=H.getTile(se),fe=me.getBucket(J);if(!fe)continue;const ge=fe.elevatedStructures;if(!ge||!ge.shadowCasterSegments||ge.shadowCasterSegments.segments[0].primitiveLength===0)continue;G.prepareDrawTile();const pe=fe.bufferData.programConfigurations.get(J.id),he=G.isTileAffectedByFog(se),_e=G.getOrCreateProgram("elevatedStructuresDepth",{config:pe,overrideFog:he}),Ke=ie.calculateShadowPassMatrixFromTile(me.tileID.toUnwrapped());G.uploadCommonUniforms(G.context,_e,se.toUnwrapped());const Le={u_matrix:Ke,u_depth_bias:0};_e.draw(G,ee.TRIANGLES,ie.getShadowPassDepthMode(),Tn.disabled,ie.getShadowPassColorMode(),Dn.disabled,Le,J.id,ge.vertexBuffer,ge.indexBuffer,ge.shadowCasterSegments,J.paint,G.transform.zoom,pe)}})(z)},"fill-extrusion":function(m,i,c,p){const y=c.paint.get("fill-extrusion-opacity"),v=m.context,w=v.gl,S=m.terrain,I=S&&S.renderingToTexture;if(y===0)return;const O=m.conflationActive&&m.style.isLayerClipped(c,i.getSource()),D=m.style.order.indexOf(c.fqid);if(O&&(function(N,z,U,G,H){for(const J of G){const Z=z.getTile(J).getBucket(U);Z&&(Z.updateReplacement(J,N.replacementSource,H),Z.uploadCentroid(N.context))}})(m,i,c,p,D),S||O)for(const N of p){const z=i.getTile(N).getBucket(c);z&&zc(m.context,i,N,z,c,S,O)}if(m.renderPass==="shadow"&&m.shadowRenderer){const N=m.shadowRenderer;if(S&&y<.65&&c._transitionablePaint._values["fill-extrusion-opacity"].value.expression instanceof s.ad)return;const z=N.getShadowPassDepthMode(),U=N.getShadowPassColorMode();Wt(m,i,c,p,z,Tn.disabled,U,O)}else if(m.renderPass==="translucent"){const N=!c.paint.get("fill-extrusion-pattern").constantOr(1),z=c.paint.get("fill-extrusion-color").constantOr(s.ao.white);if(!I&&z.a!==0){const U=new Gt(m.context.gl.LEQUAL,Gt.ReadWrite,m.depthRangeFor3D);y===1&&N?Wt(m,i,c,p,U,Tn.disabled,In.unblended,O):(Wt(m,i,c,p,U,Tn.disabled,In.disabled,O),Wt(m,i,c,p,U,m.stencilModeFor3D(),m.colorModeForRenderPass(),O),m.resetStencilClippingMasks())}if(m.style.enable3dLights()&&N&&(!S&&m.transform.projection.name!=="globe"||I)){const U=c.paint.get("fill-extrusion-opacity"),G=c.paint.get("fill-extrusion-ambient-occlusion-intensity"),H=c.paint.get("fill-extrusion-ambient-occlusion-ground-radius"),J=c.paint.get("fill-extrusion-flood-light-intensity"),Z=c.paint.get("fill-extrusion-flood-light-color-use-theme").constantOr("default")==="none",ee=c.paint.get("fill-extrusion-flood-light-color").toNonPremultipliedRenderColor(Z?null:c.lut).toArray01().slice(0,3),ie=G>0&&H>0,se=J>0,me=(pe,he,_e)=>(1-_e)*pe+_e*he,fe=new U_;fe.translate=c.paint.get("fill-extrusion-translate"),fe.translateAnchor=c.paint.get("fill-extrusion-translate-anchor"),fe.edgeRadius=c.layout.get("fill-extrusion-edge-radius"),fe.cutoffFadeRange=c.paint.get("fill-extrusion-cutoff-fade-range");const ge=pe=>{const he=m.depthModeForSublayer(1,Gt.ReadOnly,w.LEQUAL,!0),_e=c.paint.get(pe?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),Ke=me(.1,3,_e),Le=m._showOverdrawInspector;if(!Le){const st=new Tn({func:w.ALWAYS,mask:255},255,255,w.KEEP,w.KEEP,w.REPLACE),We=new In([w.ONE,w.ONE,w.ONE,w.ONE],s.ao.transparent,[!1,!1,!1,!0],w.MIN);Yl(fe,m,i,c,p,he,st,We,Dn.disabled,pe,"sdf",U,G,H,J,ee,Ke,O,!1)}{const st=Le?Tn.disabled:new Tn({func:w.EQUAL,mask:255},255,255,w.KEEP,w.DECR,w.DECR),We=Le?m.colorModeForRenderPass():new In([w.ONE_MINUS_DST_ALPHA,w.DST_ALPHA,w.ONE,w.ONE],s.ao.transparent,[!0,!0,!0,!0]);Yl(fe,m,i,c,p,he,st,We,Dn.disabled,pe,"color",U,G,H,J,ee,Ke,O,!1)}};if(I){const pe=(he,_e,Ke)=>{const Le=m.depthModeForSublayer(1,Gt.ReadOnly,w.LEQUAL,!1),st=c.paint.get(he?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),We=me(.1,3,st);{const it=new In([w.ONE,w.ONE,w.ONE,w.ONE],s.ao.transparent,[!1,!1,!1,!0]);Yl(fe,m,i,c,p,Le,Tn.disabled,it,Dn.disabled,he,"clear",U,G,H,J,ee,We,O,_e)}{const it=new Tn({func:w.ALWAYS,mask:255},255,255,w.KEEP,w.KEEP,w.REPLACE),Pt=new In([w.ONE,w.ONE,w.ONE,w.ONE],s.ao.transparent,[!1,!1,!1,!0],w.MIN);Yl(fe,m,i,c,p,Le,it,Pt,Dn.disabled,he,"sdf",U,G,H,J,ee,We,O,_e)}{const it=he?w.ZERO:w.ONE_MINUS_DST_ALPHA,Pt=new Tn({func:w.EQUAL,mask:255},255,255,w.KEEP,w.DECR,w.DECR),qe=new In([it,w.DST_ALPHA,w.ONE_MINUS_DST_ALPHA,w.ZERO],s.ao.transparent,[!0,!0,!0,!0]);Yl(fe,m,i,c,p,Le,Pt,qe,Dn.disabled,he,"color",U,G,H,J,ee,We,O,_e)}{const it=new In([w.ONE,w.ONE,w.ONE,he?w.ZERO:w.ONE],s.ao.transparent,[!1,!1,!1,!0],he?w.FUNC_ADD:w.MAX);Yl(fe,m,i,c,p,Le,Tn.disabled,it,Dn.disabled,he,"clear",U,G,H,J,ee,We,O,_e,Ke)}};if(ie||se){let he;if(m.prepareDrawTile(),S){const _e=S.drapeBufferSize[0],Ke=S.drapeBufferSize[1];he=S.framebufferCopyTexture,he&&(!he||he.size[0]===_e&&he.size[1]===Ke)||(he&&he.destroy(),he=S.framebufferCopyTexture=new s.T(v,new s.q({width:_e,height:Ke}),w.RGBA8)),he.bind(w.LINEAR,w.CLAMP_TO_EDGE),w.copyTexSubImage2D(w.TEXTURE_2D,0,0,0,0,0,_e,Ke)}ie&&pe(!0,!1,he),se&&pe(!1,!0,he)}}else ie&&ge(!0),se&&ge(!1),(ie||se)&&m.resetStencilClippingMasks()}}},building:function(m,i,c,p){m.currentLayer<m.firstLightBeamLayer&&(m.firstLightBeamLayer=m.currentLayer);const y=c.paint.get("building-ambient-occlusion-ground-intensity"),v=c.paint.get("building-ambient-occlusion-ground-radius"),w=c.paint.get("building-ambient-occlusion-ground-attenuation"),S=c.paint.get("building-opacity");if(S<=0)return;let I=y>0&&v>0,O=!0;const D=c.paint.get("building-vertical-scale");(!m.shadowRenderer||D<1)&&(O=!1);const N=m.conflationActive&&m.style.isLayerClipped(c,i.getSource()),z=m.style.order.indexOf(c.fqid);if((function(U,G,H,J,Z,ee){for(const ie of ee){const se=G.getTile(ie).getBucket(H);se&&(Z&&se.updateReplacement(ie,U.replacementSource,J),se.uploadUpdatedIndexBuffer(U.context))}})(m,i,c,z,N,p),(function(U,G,H,J){for(const Z of J){const ee=G.getTile(Z).getBucket(H);ee&&ee.needsEvaluation()&&ee.uploadUpdatedColorBuffer(U.context)}})(m,i,c,p),c.resetLayerRenderingStats(m),m.shadowRenderer&&(m.shadowRenderer.useNormalOffset=!0),m.renderPass==="shadow"&&m.shadowRenderer){const U=m.shadowRenderer,G=[],H=U.getShadowPassDepthMode();mm({painter:m,source:i,layer:c,coords:p,defines:G,blendMode:U.getShadowPassColorMode(),depthMode:H,opacity:S,verticalScale:D,facadeEmissiveChance:0,facadeAOIntensity:0})}else if(m.renderPass==="translucent"){let U=["HAS_ATTRIBUTE_a_part_color_emissive","LIGHTING_3D_MODE"];O&&(U=U.concat("RENDER_SHADOWS","DEPTH_TEXTURE")),m.shadowRenderer&&m.shadowRenderer.useNormalOffset&&(U=U.concat("NORMAL_OFFSET"));const G=c.paint.get("building-facade-emissive-chance"),H=c.paint.get("building-ambient-occlusion-intensity"),J=new Gt(m.context.gl.LEQUAL,Gt.ReadWrite,m.depthRangeFor3D);S<1&&mm({painter:m,source:i,layer:c,coords:p,defines:U,blendMode:In.disabled,depthMode:J,opacity:S,verticalScale:D,facadeEmissiveChance:G,facadeAOIntensity:H});const Z=m.colorModeForRenderPass();mm({painter:m,source:i,layer:c,coords:p,defines:U,blendMode:Z,depthMode:J,opacity:S,verticalScale:D,facadeEmissiveChance:G,facadeAOIntensity:H}),I&&(function(ee,ie,se,me,fe,ge,pe,he,_e,Ke,Le,st,We){const it=ee.context.gl,Pt=ee.depthModeForSublayer(1,Gt.ReadOnly,it.LEQUAL,!0),qe=.1*(1-(Ae=Le))+3*Ae;var Ae;const at=ee._showOverdrawInspector,Je=st,_t=new U_;at||Yl(_t,ee,ie,se,me,Pt,new Tn({func:it.ALWAYS,mask:255},255,255,it.KEEP,it.KEEP,it.REPLACE),new In([it.ONE,it.ONE,it.ONE,it.ONE],s.ao.transparent,[!1,!1,!1,!0],it.MIN),Dn.disabled,fe,"sdf",ge,pe,he,0,Ke,qe,Je,!1);{const At=at?Tn.disabled:new Tn({func:it.EQUAL,mask:255},255,255,it.KEEP,it.DECR,it.DECR),Ut=at?ee.colorModeForRenderPass():new In([it.ONE_MINUS_DST_ALPHA,it.DST_ALPHA,it.ONE,it.ONE],s.ao.transparent,[!0,!0,!0,!0]);Yl(_t,ee,ie,se,me,Pt,At,Ut,Dn.disabled,fe,"color",ge,pe,he,0,Ke,qe,Je,!1)}})(m,i,c,p,!0,S,y,v,0,[0,0,0],w,N)}else if(m.renderPass==="light-beam"){const U=["HAS_ATTRIBUTE_a_part_color_emissive","HAS_ATTRIBUTE_a_bloom_attenuation"],G=new Gt(m.context.gl.LEQUAL,Gt.ReadOnly,m.depthRangeFor3D);mm({painter:m,source:i,layer:c,coords:p,defines:U,blendMode:In.alphaBlended,depthMode:G,opacity:S,verticalScale:D,facadeEmissiveChance:0,facadeAOIntensity:0})}m.shadowRenderer&&(m.shadowRenderer.useNormalOffset=!1),m.resetStencilClippingMasks()},hillshade:function(m,i,c,p){if(m.renderPass!=="offscreen"&&m.renderPass!=="translucent"||m.style.disableElevatedTerrain)return;const y=m.context,v=m.terrain&&m.terrain.renderingToTexture,[w,S]=m.renderPass!=="translucent"||v?[{},p]:m.stencilConfigForOverlap(p);for(const I of S){const O=i.getTile(I);if(O.needsHillshadePrepare&&m.renderPass==="offscreen")tS(m,O,c);else if(m.renderPass==="translucent"){const D=m.depthModeForSublayer(0,Gt.ReadOnly),N=c.paint.get("hillshade-emissive-strength"),z=m.colorModeForDrapableLayerRenderPass(N),U=v&&m.terrain?m.terrain.stencilModeForRTTOverlap(I):w[I.overscaledZ];eS(m,I,O,c,D,U,z)}}y.viewport.set([0,0,m.width,m.height]),m.resetStencilClippingMasks()},raster:function(m,i,c,p,y,v){if(m.renderPass!=="translucent"||c.paint.get("raster-opacity")===0)return;const w=m.transform.projection.name==="globe",S=c.paint.get("raster-elevation")!==0,I=S&&w;if(m.renderElevatedRasterBackface&&!I)return;const O=m.context,D=O.gl,N=i.getSource(),z=(function(fe,ge,pe,he){const _e=ge.paint.get("raster-color"),Ke=fe.type==="raster-array",Le=[],st=ge.paint.get("raster-resampling"),We=ge.paint.get("raster-color-mix");let it=ge.paint.get("raster-color-range");const Pt=[We[0],We[1],We[2],0],qe=We[3];let Ae=st==="nearest"?he.NEAREST:he.LINEAR;if(Ke&&(Le.push("RASTER_ARRAY"),_e||Le.push("RASTER_COLOR"),st==="linear"&&Le.push("RASTER_ARRAY_LINEAR"),Ae=he.NEAREST,!it&&fe.rasterLayers)){const at=fe.rasterLayers.find((({id:Je})=>Je===ge.sourceLayer));at&&at.fields&&at.fields.range&&(it=at.fields.range)}if(it=it||[0,1],_e){Le.push("RASTER_COLOR"),pe.activeTexture.set(he.TEXTURE2),ge.updateColorRamp(it);let at=ge.colorRampTexture;at||(at=ge.colorRampTexture=new s.T(pe,ge.colorRamp,he.RGBA8)),at.bind(he.LINEAR,he.CLAMP_TO_EDGE)}return{mix:Pt,range:it,offset:qe,defines:Le,resampling:Ae}})(N,c,O,D);if(N instanceof s.aS&&!p.length&&!w)return;const U=c.paint.get("raster-emissive-strength"),G=m.colorModeForDrapableLayerRenderPass(U),H=m.terrain&&m.terrain.renderingToTexture,J=!m.options.moving,Z=c.paint.get("raster-resampling")==="nearest"?D.NEAREST:D.LINEAR;if(N instanceof s.aS&&!p.length&&(N.onNorthPole||N.onSouthPole)){const fe=S?m.stencilModeFor3D():Tn.disabled;return void _m(!!N.onNorthPole,null,m,i,c,U,z,Dn.disabled,fe)}if(!p.length)return;const[ee,ie]=N instanceof s.aS||H?[{},p]:m.stencilConfigForOverlap(p),se=ie[ie.length-1].overscaledZ;I&&z.defines.push("PROJECTION_GLOBE_VIEW"),S&&z.defines.push("RENDER_CUTOFF");const me=(fe,ge,pe)=>{for(const he of fe){const _e=he.toUnwrapped(),Ke=i.getTile(he);if(H&&(!Ke||!Ke.hasData()))continue;O.activeTexture.set(D.TEXTURE0);const Le=Bb(Ke,N,c,z);if(!Le||!Le.texture)continue;const{texture:st,mix:We,offset:it,tileSize:Pt,buffer:qe}=Le;let Ae,at;H?(Ae=Gt.disabled,at=he.projMatrix):S?(Ae=new Gt(D.LEQUAL,Gt.ReadWrite,m.depthRangeFor3D),at=w?Float32Array.from(m.transform.expandedFarZProjMatrix):m.transform.calculateProjMatrix(_e,J)):(Ae=m.depthModeForSublayer(he.overscaledZ-se,c.paint.get("raster-opacity")===1?Gt.ReadWrite:Gt.ReadOnly,D.LESS),at=m.transform.calculateProjMatrix(_e,J));const Je=m.terrain&&H?m.terrain.stencilModeForRTTOverlap(he):ee[he.overscaledZ],_t=v?0:c.paint.get("raster-fade-duration");Ke.registerFadeDuration(_t);const At=i.findLoadedParent(he,0),Ut=Bu(Ke,At,i,m.transform,_t);let St,bt;!Ut.isFading&&Ke.refreshedUponExpiration&&(Ke.refreshedUponExpiration=!1),m.terrain&&m.terrain.prepareDrawTile(),O.activeTexture.set(D.TEXTURE0),st.bind(Z,D.CLAMP_TO_EDGE),O.activeTexture.set(D.TEXTURE1),At?(At.texture&&At.texture.bind(Z,D.CLAMP_TO_EDGE),St=Math.pow(2,At.tileID.overscaledZ-Ke.tileID.overscaledZ),bt=[Ke.tileID.canonical.x*St%1,Ke.tileID.canonical.y*St%1]):st.bind(Z,D.CLAMP_TO_EDGE),"useMipmap"in st&&O.extTextureFilterAnisotropic&&m.transform.pitch>20&&D.texParameterf(D.TEXTURE_2D,O.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,O.extTextureFilterAnisotropicMax);const un=m.transform;let en;const an=S?yS(un):[0,0,0,0];let Qt,Ln,Hn,qn,Wr,Bn=0;if(I&&N instanceof s.aS&&N.coordinates.length>3)Qt=Float32Array.from(s.bk(s.dF(new s.cC(0,0,0)))),Ln=Float32Array.from(un.globeMatrix),Hn=Float32Array.from(s.dB(un)),qn=[s.aF(un.center.lng),s.aJ(un.center.lat)],en=N.elevatedGlobePerspectiveTransform,Wr=N.elevatedGlobeGridMatrix||new Float32Array(9);else if(I){const Wn=s.dC(he.canonical);Bn=s.dD(Wn.getCenter().lat),Qt=Float32Array.from(s.bk(s.dF(he.canonical))),Ln=Float32Array.from(un.globeMatrix),Hn=Float32Array.from(s.dB(un)),qn=[s.aF(un.center.lng),s.aJ(un.center.lat)],en=[0,0],Wr=Float32Array.from(s.dE(he.canonical,Wn,Bn,un.worldSize/un._pixelsPerMercatorPixel))}else en=N instanceof s.aS?N.perspectiveTransform:[0,0],Qt=new Float32Array(16),Ln=new Float32Array(9),Hn=new Float32Array(16),qn=[0,0],Wr=new Float32Array(9);const Or=sm(at,Qt,Ln,Hn,Wr,bt||[0,0],s.aj(m.transform.zoom),qn,an,St||1,Ut,c,en,S?c.paint.get("raster-elevation"):0,2,We,it,z.range,Pt,qe,U),Gr=m.isTileAffectedByFog(he),Ti=m.getOrCreateProgram("raster",{defines:z.defines,overrideFog:Gr});if(m.uploadCommonUniforms(O,Ti,_e),N instanceof s.aS){const Wn=N.elevatedGlobeVertexBuffer,Lr=N.elevatedGlobeIndexBuffer;if(H||!w)N.boundsBuffer&&N.boundsSegments&&Ti.draw(m,D.TRIANGLES,Ae,Tn.disabled,G,Dn.disabled,Or,c.id,N.boundsBuffer,m.quadTriangleIndexBuffer,N.boundsSegments);else if(Wn&&Lr){const Mr=un.zoom<=s.cZ?N.elevatedGlobeSegments:N.getSegmentsForLongitude(un.center.lng);Mr&&Ti.draw(m,D.TRIANGLES,Ae,Tn.disabled,G,ge,Or,c.id,Wn,Lr,Mr)}}else if(I){Ae=new Gt(D.LEQUAL,Gt.ReadOnly,m.depthRangeFor3D);const Wn=m.globeSharedBuffers;if(Wn){const[Lr,Mr,$r]=Wn.getGridBuffers(Bn,!1);Ti.draw(m,D.TRIANGLES,Ae,pe||Je,m.colorModeForRenderPass(),ge,Or,c.id,Lr,Mr,$r)}}else{const{tileBoundsBuffer:Wn,tileBoundsIndexBuffer:Lr,tileBoundsSegments:Mr}=m.getTileBoundsBuffers(Ke);Ti.draw(m,D.TRIANGLES,Ae,Je,G,Dn.disabled,Or,c.id,Wn,Lr,Mr)}}if(!(N instanceof s.aS)&&I)for(const he of fe){const _e=he.canonical.y===(1<<he.canonical.z)-1;he.canonical.y===0&&_m(!0,he,m,i,c,U,z,ge,pe||Tn.disabled),_e&&_m(!1,he,m,i,c,U,z,ge===Dn.frontCW?Dn.backCW:Dn.frontCW,pe||Tn.disabled)}};I?me(ie,m.renderElevatedRasterBackface?Dn.backCW:Dn.frontCW,m.stencilModeFor3D()):me(ie,Dn.disabled,void 0),m.resetStencilClippingMasks()},"raster-particle":function(m,i,c,p,y,v){m.renderPass==="offscreen"&&(function(w,S,I,O){if(!O.length)return;const D=w.context,N=D.gl,z=S.getSource();if(!(z instanceof gl))return;const U=Math.ceil(Math.sqrt(I.paint.get("raster-particle-count")));let G=I.particlePositionRGBAImage;if(!G||G.width!==U){const ie=(function(se){const me=se*se,fe=new Uint8Array(4*me),ge=function(he){return he|=0,he=Math.imul(2747636419^he,2654435769),he=Math.imul(he^he>>>16,2654435769),((he=Math.imul(he^he>>>16,2654435769))>>>0)/4294967296},pe=1/1.1;for(let he=0;he<me;he++){const _e=pe*(ge(2*he+0)+$u),Ke=pe*(ge(2*he+1)+$u),Le=255*_e%1,st=255*Ke%1,We=Le,it=Ke-st/255,Pt=st;fe[4*he+0]=255*(_e-Le/255),fe[4*he+1]=255*We,fe[4*he+2]=255*it,fe[4*he+3]=255*Pt}return fe})(U);G=I.particlePositionRGBAImage=new s.q({width:U,height:U},ie)}let H=I.particleFramebuffer;H?H.width!==U&&(H.destroy(),H=I.particleFramebuffer=D.createFramebuffer(U,U,!0,null)):H=I.particleFramebuffer=D.createFramebuffer(U,U,!0,null);const J=[];for(const ie of O){const se=S.getTile(ie);if(!(se instanceof Su))continue;const me=Xs(se,z,I);if(!me)continue;const fe=[se.tileSize,se.tileSize];let ge=I.tileFramebuffer;ge||(ge=I.tileFramebuffer=D.createFramebuffer(fe[0],fe[1],!0,null));let pe=se.rasterParticleState;pe||(pe=se.rasterParticleState=new bS(D,ie,fe,G));const he=pe.update(I.lastInvalidatedAt);pe.particleTextureDimension!==U&&pe.updateParticleTexture(ie,G);const _e=pe.targetColorTexture;pe.targetColorTexture=pe.backgroundColorTexture,pe.backgroundColorTexture=_e;const Ke=pe.particleTexture0;pe.particleTexture0=pe.particleTexture1,pe.particleTexture1=Ke,J.push([ie,me,pe,he])}if(J.length===0)return;const Z=s.o.now(),ee=I.previousDrawTimestamp?.001*(Z-I.previousDrawTimestamp):.0167;if(I.previousDrawTimestamp=Z,I.hasColorMap()){D.activeTexture.set(N.TEXTURE0+2);let ie=I.colorRampTexture;ie||(ie=I.colorRampTexture=new s.T(D,I.colorRamp,N.RGBA8)),ie.bind(N.LINEAR,N.CLAMP_TO_EDGE)}D.bindFramebuffer.set(I.tileFramebuffer.framebuffer),(function(ie,se,me){const fe=ie.context,ge=fe.gl,pe=se.tileFramebuffer;fe.activeTexture.set(ge.TEXTURE0);const he={u_texture:0,u_opacity:1.05*(Ke=se.paint.get("raster-particle-fade-opacity-factor"))/(Ke+.05)},_e=ie.getOrCreateProgram("rasterParticleTexture",{defines:[],overrideFog:!1});var Ke;for(const Le of me){const[,,st,We]=Le;pe.colorAttachment.set(st.targetColorTexture.texture),fe.viewport.set([0,0,pe.width,pe.height]),fe.clear({color:s.ao.transparent}),We&&(st.backgroundColorTexture.bind(ge.NEAREST,ge.CLAMP_TO_EDGE),_e.draw(ie,ge.TRIANGLES,Gt.disabled,Tn.disabled,In.alphaBlended,Dn.disabled,he,se.id,ie.viewportBuffer,ie.quadTriangleIndexBuffer,ie.viewportSegments))}})(w,I,J),(function(ie,se,me,fe){const ge=ie.context,pe=ge.gl,he=me.tileFramebuffer,_e=ie.transform.projection.name==="globe",Ke=me.paint.get("raster-particle-max-speed");for(const Le of fe){const[st,We,it]=Le;ge.activeTexture.set(pe.TEXTURE0+0),We.texture.bind(pe.LINEAR,pe.CLAMP_TO_EDGE),he.colorAttachment.set(it.targetColorTexture.texture);const Pt=ie.getOrCreateProgram("rasterParticleDraw",{defines:We.defines,overrideFog:!1});ge.activeTexture.set(pe.TEXTURE0+1);const qe=We.scalarData?[]:[0,1,2,3].map((Je=>s.e6[Je](st)));qe.push(st);const Ae=st.canonical.x,at=st.canonical.y;for(const Je of qe){const _t=se.getTile(_e?Je.wrapped():Je);if(!_t)continue;const At=_t.rasterParticleState;if(!At)continue;const Ut=Je.canonical.x+(1<<Je.canonical.z)*(Je.wrap-st.wrap),St=Je.canonical.y;At.particleTexture0.bind(pe.NEAREST,pe.CLAMP_TO_EDGE);const bt=z_(1,At.particleTexture0.size[0],[Ut-Ae,St-at],0,We.texture.size,2,Ke,We.textureOffset,We.scale,We.offset);Pt.draw(ie,pe.POINTS,Gt.disabled,Tn.disabled,In.alphaBlended,Dn.disabled,bt,me.id,At.particleIndexBuffer,void 0,At.particleSegment)}}})(w,S,I,J),D.bindFramebuffer.set(I.particleFramebuffer.framebuffer),(function(ie,se,me,fe){const ge=ie.context,pe=ge.gl,he=se.paint.get("raster-particle-max-speed"),_e=fe*se.paint.get("raster-particle-speed-factor")*.15,Ke=(function(st){return Math.pow(st,6)})(.01+1*se.paint.get("raster-particle-reset-rate-factor")),Le=se.particleFramebuffer;ge.viewport.set([0,0,Le.width,Le.height]);for(const st of me){const[,We,it]=st;ge.activeTexture.set(pe.TEXTURE0+0),We.texture.bind(pe.LINEAR,pe.CLAMP_TO_EDGE),ge.activeTexture.set(pe.TEXTURE0+1);const Pt=it.particleTexture0;Pt.bind(pe.NEAREST,pe.CLAMP_TO_EDGE);const qe=am(1,Pt.size[0],0,We.texture.size,he,_e,Ke,We.textureOffset,We.scale,We.offset);Le.colorAttachment.set(it.particleTexture1.texture),ge.clear({color:s.ao.transparent}),ie.getOrCreateProgram("rasterParticleUpdate",{defines:We.defines}).draw(ie,pe.TRIANGLES,Gt.disabled,Tn.disabled,In.unblended,Dn.disabled,qe,se.id,ie.viewportBuffer,ie.quadTriangleIndexBuffer,ie.viewportSegments)}})(w,I,J,ee)})(m,i,c,p),m.renderPass==="translucent"&&((function(w,S,I,O,D){const N=w.context,z=N.gl,U=S.getSource().tileSize,G=5*(1-s.ah(s.cK,s.cK+1,w.transform.zoom))*U+I.paint.get("raster-particle-elevation"),H=!w.options.moving,J=w.transform.projection.name==="globe";if(!O.length)return;const[Z,ee]=w.stencilConfigForOverlap(O),ie=[];J&&ie.push("PROJECTION_GLOBE_VIEW");const se=w.stencilModeFor3D();for(const me of ee){const fe=me.toUnwrapped(),ge=S.getTile(me);if(!ge.rasterParticleState)continue;const pe=ge.rasterParticleState,he=100;ge.registerFadeDuration(he);const _e=S.findLoadedParent(me,0),Ke=Bu(ge,_e,S,w.transform,he);let Le,st;w.terrain&&w.terrain.prepareDrawTile(),N.activeTexture.set(z.TEXTURE0),pe.targetColorTexture.bind(z.LINEAR,z.CLAMP_TO_EDGE),N.activeTexture.set(z.TEXTURE1),_e&&_e.rasterParticleState?(_e.rasterParticleState.targetColorTexture.bind(z.LINEAR,z.CLAMP_TO_EDGE),Le=Math.pow(2,_e.tileID.overscaledZ-ge.tileID.overscaledZ),st=[ge.tileID.canonical.x*Le%1,ge.tileID.canonical.y*Le%1]):pe.targetColorTexture.bind(z.LINEAR,z.CLAMP_TO_EDGE);const We=J?Float32Array.from(w.transform.expandedFarZProjMatrix):w.transform.calculateProjMatrix(fe,H),it=w.transform,Pt=G_(it),qe=s.dC(me.canonical),Ae=s.dD(qe.getCenter().lat);let at,Je,_t,At,Ut;J?(at=Float32Array.from(s.bk(s.dF(me.canonical))),Je=Float32Array.from(it.globeMatrix),_t=Float32Array.from(s.dB(it)),At=[s.aF(it.center.lng),s.aJ(it.center.lat)],Ut=Float32Array.from(s.dE(me.canonical,qe,Ae,it.worldSize/it._pixelsPerMercatorPixel))):(at=new Float32Array(16),Je=new Float32Array(9),_t=new Float32Array(16),At=[0,0],Ut=new Float32Array(9));const St=Mc(We,at,Je,_t,Ut,st||[0,0],s.aj(w.transform.zoom),At,Pt,Le||1,Ke,G),bt=w.isTileAffectedByFog(me),un=w.getOrCreateProgram("rasterParticle",{defines:ie,overrideFog:bt});if(w.uploadCommonUniforms(N,un,fe),J){const en=new Gt(z.LEQUAL,Gt.ReadOnly,w.depthRangeFor3D),an=0,Qt=w.globeSharedBuffers;if(Qt){const[Ln,Hn,qn]=Qt.getGridBuffers(Ae,an!==0);un.draw(w,z.TRIANGLES,en,se,In.alphaBlended,w.renderElevatedRasterBackface?Dn.frontCCW:Dn.backCCW,St,I.id,Ln,Hn,qn)}}else{const en=w.depthModeForSublayer(0,Gt.ReadOnly),an=Z[me.overscaledZ],{tileBoundsBuffer:Qt,tileBoundsIndexBuffer:Ln,tileBoundsSegments:Hn}=w.getTileBoundsBuffers(ge);un.draw(w,z.TRIANGLES,en,an,In.alphaBlended,Dn.disabled,St,I.id,Qt,Ln,Hn)}}w.resetStencilClippingMasks()})(m,i,c,p),m.style.map.triggerRepaint())},background:function(m,i,c,p){const y=c.paint.get("background-color"),v=c.paint.get("background-color-use-theme").constantOr("default")==="none",w=c.paint.get("background-opacity"),S=c.paint.get("background-emissive-strength"),I=c.paint.get("background-pitch-alignment")==="viewport";if(w===0)return;const O=m.context,D=O.gl,N=m.transform,z=N.tileSize,U=c.paint.get("background-pattern");let G;if(U!==void 0&&(U===null||(G=m.imageManager.getPattern(s.I.from(U.toString()),c.scope,m.style.getLut(c.scope)),!G)))return;const H=!U&&y.a===1&&w===1&&m.opaquePassEnabledForLayer()?"opaque":"translucent";if(m.renderPass!==H)return;const J=Tn.disabled,Z=m.depthModeForSublayer(0,H==="opaque"?Gt.ReadWrite:Gt.ReadOnly),ee=m.colorModeForDrapableLayerRenderPass(S),ie=U?"backgroundPattern":"background";let se,me=p;if(me||(se=m.getBackgroundTiles(),me=Object.values(se).map((fe=>fe.tileID))),U&&(O.activeTexture.set(D.TEXTURE0),m.imageManager.bind(m.context,c.scope)),I){const fe=m.getOrCreateProgram(ie,{overrideFog:!1,overrideRtt:!0}),ge=new Float32Array(s.bA([])),pe=new s.aO(0,0,0,0,0),he=U?cm(ge,S,w,m,0,c.scope,G,I,{tileID:pe,tileSize:z}):lm(ge,S,w,y.toPremultipliedRenderColor(v?null:c.lut));fe.draw(m,D.TRIANGLES,Z,J,ee,Dn.disabled,he,c.id,m.viewportBuffer,m.quadTriangleIndexBuffer,m.viewportSegments)}else for(const fe of me){const ge=m.isTileAffectedByFog(fe),pe=m.getOrCreateProgram(ie,{overrideFog:ge}),he=fe.toUnwrapped(),_e=p?fe.projMatrix:m.transform.calculateProjMatrix(he);m.prepareDrawTile();const Ke=i?i.getTile(fe):se?se[fe.key]:new vl(fe,z,N.zoom,m),Le=U?cm(_e,S,w,m,0,c.scope,G,I,{tileID:fe,tileSize:z}):lm(_e,S,w,y.toPremultipliedRenderColor(v?null:c.lut));m.uploadCommonUniforms(O,pe,he);const{tileBoundsBuffer:st,tileBoundsIndexBuffer:We,tileBoundsSegments:it}=m.getTileBoundsBuffers(Ke);pe.draw(m,D.TRIANGLES,Z,J,ee,Dn.disabled,Le,c.id,st,We,it)}},sky:function(m,i,c){const p=m._atmosphere?s.aj(m.transform.zoom):1,y=c.paint.get("sky-opacity")*p;if(y===0)return;const v=m.context,w=c.paint.get("sky-type"),S=new Gt(v.gl.LEQUAL,Gt.ReadOnly,[0,1]),I=m.frameCounter/1e3%1;w==="atmosphere"?m.renderPass==="offscreen"?c.needsSkyboxCapture(m)&&((function(O,D,N,z){const U=O.context,G=U.gl;let H=D.skyboxFbo;if(!H){H=D.skyboxFbo=U.createFramebuffer(32,32,!0,null),D.skyboxGeometry=new K_(U),D.skyboxTexture=U.gl.createTexture(),G.bindTexture(G.TEXTURE_CUBE_MAP,D.skyboxTexture),G.texParameteri(G.TEXTURE_CUBE_MAP,G.TEXTURE_WRAP_S,G.CLAMP_TO_EDGE),G.texParameteri(G.TEXTURE_CUBE_MAP,G.TEXTURE_WRAP_T,G.CLAMP_TO_EDGE),G.texParameteri(G.TEXTURE_CUBE_MAP,G.TEXTURE_MIN_FILTER,G.LINEAR),G.texParameteri(G.TEXTURE_CUBE_MAP,G.TEXTURE_MAG_FILTER,G.LINEAR);for(let ie=0;ie<6;++ie)G.texImage2D(G.TEXTURE_CUBE_MAP_POSITIVE_X+ie,0,G.RGBA,32,32,0,G.RGBA,G.UNSIGNED_BYTE,null)}U.bindFramebuffer.set(H.framebuffer),U.viewport.set([0,0,32,32]);const J=D.getCenter(O,!0),Z=O.getOrCreateProgram("skyboxCapture"),ee=new Float64Array(16);s.bA(ee),s.ek(ee,ee,.5*-Math.PI),Hu(O,D,Z,ee,J,0),s.bA(ee),s.ek(ee,ee,.5*Math.PI),Hu(O,D,Z,ee,J,1),s.bA(ee),s.cT(ee,ee,.5*-Math.PI),Hu(O,D,Z,ee,J,2),s.bA(ee),s.cT(ee,ee,.5*Math.PI),Hu(O,D,Z,ee,J,3),s.bA(ee),Hu(O,D,Z,ee,J,4),s.bA(ee),s.ek(ee,ee,Math.PI),Hu(O,D,Z,ee,J,5),U.viewport.set([0,0,O.width,O.height])})(m,c),c.markSkyboxValid(m)):m.renderPass==="sky"&&(function(O,D,N,z,U){const G=O.context,H=G.gl,J=O.transform,Z=O.getOrCreateProgram("skybox");G.activeTexture.set(H.TEXTURE0),H.bindTexture(H.TEXTURE_CUBE_MAP,D.skyboxTexture);const ee=((ie,se,me,fe,ge)=>({u_matrix:ie,u_sun_direction:se,u_cubemap:0,u_opacity:fe,u_temporal_offset:ge}))(J.skyboxMatrix,D.getCenter(O,!1),0,z,U);O.uploadCommonUniforms(G,Z),Z.draw(O,H.TRIANGLES,N,Tn.disabled,O.colorModeForRenderPass(),Dn.backCW,ee,"skybox",D.skyboxGeometry.vertexBuffer,D.skyboxGeometry.indexBuffer,D.skyboxGeometry.segment)})(m,c,S,y,I):w==="gradient"&&m.renderPass==="sky"&&(function(O,D,N,z,U){const G=O.context,H=G.gl,J=O.transform,Z=O.getOrCreateProgram("skyboxGradient");D.skyboxGeometry||(D.skyboxGeometry=new K_(G)),G.activeTexture.set(H.TEXTURE0);let ee=D.colorRampTexture;ee||(ee=D.colorRampTexture=new s.T(G,D.colorRamp,H.RGBA8)),ee.bind(H.LINEAR,H.CLAMP_TO_EDGE);const ie=((se,me,fe,ge,pe)=>({u_matrix:se,u_color_ramp:0,u_center_direction:me,u_radius:s.an(fe),u_opacity:ge,u_temporal_offset:pe}))(J.skyboxMatrix,D.getCenter(O,!1),D.paint.get("sky-gradient-radius"),z,U);O.uploadCommonUniforms(G,Z),Z.draw(O,H.TRIANGLES,N,Tn.disabled,O.colorModeForRenderPass(),Dn.backCW,ie,"skyboxGradient",D.skyboxGeometry.vertexBuffer,D.skyboxGeometry.indexBuffer,D.skyboxGeometry.segment)})(m,c,S,y,I)},custom:function(m,i,c,p){const y=m.context,v=c.implementation;if(!m.transform.projection.unsupportedLayers||!m.transform.projection.unsupportedLayers.includes("custom")||m.terrain&&(m.terrain.renderingToTexture||m.renderPass==="offscreen")&&c.isDraped(i)){if(m.renderPass==="offscreen"){const w=v.prerender;if(w){if(m.setCustomLayerDefaults(),y.setColorMode(m.colorModeForRenderPass()),m.transform.projection.name==="globe"){const S=m.transform.pointMerc;w.call(v,y.gl,m.transform.customLayerMatrix(),m.transform.getProjection(),m.transform.globeToMercatorMatrix(),s.aj(m.transform.zoom),[S.x,S.y],m.transform.pixelsPerMeterRatio)}else w.call(v,y.gl,m.transform.customLayerMatrix());y.setDirty(),m.setBaseState()}}else if(m.renderPass==="translucent"){if(m.terrain&&m.terrain.renderingToTexture){const S=v.renderToTile;if(S){const I=p[0].canonical,O={x:I.x+p[0].wrap*(v.wrapTileId?0:1<<I.z),y:I.y,z:I.z};y.setDepthMode(Gt.disabled),y.setStencilMode(Tn.disabled),y.setColorMode(m.colorModeForRenderPass()),m.setCustomLayerDefaults(),S.call(v,y.gl,O),y.setDirty(),m.setBaseState()}return}m.setCustomLayerDefaults(),y.setColorMode(m.colorModeForRenderPass()),y.setStencilMode(Tn.disabled);const w=v.renderingMode==="3d"?new Gt(m.context.gl.LEQUAL,Gt.ReadWrite,m.depthRangeFor3D):m.depthModeForSublayer(0,Gt.ReadOnly);if(y.setDepthMode(w),m.transform.projection.name==="globe"){const S=m.transform.pointMerc;v.render(y.gl,m.transform.customLayerMatrix(),m.transform.getProjection(),m.transform.globeToMercatorMatrix(),s.aj(m.transform.zoom),[S.x,S.y],m.transform.pixelsPerMeterRatio)}else v.render(y.gl,m.transform.customLayerMatrix());y.setDirty(),m.setBaseState(),y.bindFramebuffer.set(null)}}else s.w("Custom layers are not yet supported with this projection. Use mercator or globe to enable usage of custom layers.")},model:function(m,i,c,p){if(m.renderPass==="opaque")return;const y=c.paint.get("model-opacity").constantOr(1);if(y===0)return;const v=c.paint.get("model-cast-shadows");if(m.renderPass==="shadow"&&(!v||m.terrain&&y<.65&&c._transitionablePaint._values["model-opacity"].value.expression instanceof s.ad))return;const w=m.shadowRenderer,S=c.paint.get("model-receive-shadows");w&&(w.useNormalOffset=!0,S||(w.enabled=!1));const I=()=>{w&&(w.useNormalOffset=!0,S||(w.enabled=!0))},O=i.getSource();if(m.renderPass==="light-beam"&&O.type!=="batched-model")return;if(O.type==="vector"||O.type==="geojson")return(function(Z,ee,ie,se,me){const fe=Z.transform;if(fe.projection.name!=="mercator")return void s.w(`Drawing 3D models for ${fe.projection.name} projection is not yet implemented`);const ge=fe.getFreeCameraOptions().position;if(!Z.modelManager)return;const pe=Z.modelManager;ie.modelManager=pe;const he=Z.shadowRenderer;if(!ie._unevaluatedLayout._values.hasOwnProperty("model-id"))return;const _e=ie._unevaluatedLayout._values["model-id"],Ke=Object.assign({},ie.layout.get("model-id").parameters),Le=Z.style.order.indexOf(ie.fqid);for(const st of se){const We=ee.getTile(st).getBucket(ie);if(!We||We.projection.name!==fe.projection.name)continue;const it=We.getModelUris();it&&!We.modelsRequested&&(pe.addModelsFromBucket(it,me),We.modelsRequested=!0);const Pt=Qd(st,fe);Ke.zoom=Pt;const qe=_e.possiblyEvaluate(Ke);if($b(Z,We,st),Qa.shadowUniformsInitialized=!1,Qa.useSingleShadowCascade=!!he&&he.getMaxCascadeForTile(st.toUnwrapped())===0,Z.renderPass==="shadow"&&he){if(Z.currentShadowCascade===1&&We.isInsideFirstShadowMapFrustum)continue;const Je=fe.calculatePosMatrix(st.toUnwrapped(),fe.worldSize);if(Qa.tileMatrix.set(Je),Qa.shadowTileMatrix=Float32Array.from(he.calculateShadowPassMatrixFromMatrix(Je)),Qa.aabb.min=[0,0,0],Qa.aabb.max[0]=Qa.aabb.max[1]=s.al,Qa.aabb.max[2]=0,jb(We,Qa,Z,ie.scope))continue}const Ae=1<<st.canonical.z,at=[((ge.x-st.wrap)*Ae-st.canonical.x)*s.al,(ge.y*Ae-st.canonical.y)*s.al,ge.z*Ae*s.al];Z.conflationActive&&Object.keys(We.instancesPerModel).length>0&&Z.style.isLayerClipped(ie,ee.getSource())&&We.updateReplacement(st,Z.replacementSource,Le,me)&&(We.uploaded=!1,We.upload(Z.context));for(let Je in We.instancesPerModel){const _t=We.instancesPerModel[Je];_t.features.length>0&&(Je=qe.evaluate(_t.features[0].feature,{}));const At=pe.getModel(Je,me);if(At||pe.hasURLBeenRequested(Je)||We.modelUris.includes(Je)||(We.modelUris.push(Je),We.modelsRequested=!1),At&&At.uploaded)for(const Ut of At.nodes)Ub(Z,ie,Ut,_t,at,st,Qa)}}})(m,i,c,p,O.type==="vector"?c.scope:""),void I();if(!O.loaded())return;if(O.type==="batched-model")return(function(Z,ee,ie,se){ie.resetLayerRenderingStats(Z);const me=Z.context,fe=Z.transform,ge=Z.style.fog,pe=Z.shadowRenderer;if(fe.projection.name!=="mercator")return void s.w(`Drawing 3D landmark models for ${fe.projection.name} projection is not yet implemented`);const he=Z.transform.getFreeCameraOptions().position,_e=s.c4([],[he.x,he.y,he.z],Z.transform.worldSize),Ke=s.et([],_e),Le=s.bA([]),st=s.ec(fe.center.lat,fe.zoom),We=s.bq([],[1,1,1/st]);s.br(Le,Le,Ke);const it=ie.paint.get("model-opacity").constantOr(1),Pt=new Gt(me.gl.LEQUAL,Gt.ReadWrite,Z.depthRangeFor3D),qe=new Gt(me.gl.LEQUAL,Gt.ReadOnly,Z.depthRangeFor3D),Ae=new s.d8([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),at=Z.renderPass==="shadow",Je=at&&pe?pe.getCurrentCascadeFrustum():fe.getFrustum(fe.scaleZoom(fe.worldSize)),_t=ie.paint.get("model-front-cutoff"),At=_t[2]<1,Ut=Pc(Z,ie.paint.get("model-cutoff-fade-range")),St=ie.getLayerRenderingStats();(function(bt,un,en,an){const Qt=bt.terrain?bt.terrain.exaggeration():0,Ln=bt.transform.zoom;for(const Hn of an){const qn=un.getTile(Hn).getBucket(en);qn&&(qn.setFilter(en.filter),bt.conflationActive&&qn.updateReplacement(Hn,bt.replacementSource),qn.evaluateTransform(bt,en),bt.terrain&&Qt>0&&qn.elevationUpdate(bt.terrain,Qt,Hn,en.source),qn.needsReEvaluation(bt,Ln,en)&&qn.evaluate(en))}})(Z,ee,ie,se),(function(){let bt,un,en;At?(bt=se.length-1,un=-1,en=-1):(bt=0,un=se.length,en=1);const an=new Float64Array(16),Qt=s.cz(),Ln=new s.P(0,0);for(let Hn=bt;Hn!==un;Hn+=en){const qn=se[Hn],Wr=ee.getTile(qn).getBucket(ie);if(!Wr||!Wr.uploaded)continue;let Bn=!1;pe&&(Bn=pe.getMaxCascadeForTile(qn.toUnwrapped())===0);const Or=fe.calculatePosMatrix(qn.toUnwrapped(),fe.worldSize),Gr=Wr.modelTraits;!at&&At&&(s.bl(an,Or),s.af(Qt,_e,an),Ln.x=Qt[0],Ln.y=Qt[1]);const Ti=[];Wr.setFilter(ie.filter);for(const Wn of Wr.getNodesInfo()){if(Wn.hiddenByReplacement||!Wn.node.meshes)continue;const Lr=Wn.node;let Mr=0;Z.terrain&&Lr.elevation&&(Mr=Lr.elevation*Z.terrain.exaggeration());const $r=(()=>{const Ko=Wn.aabb;return Ae.min=[...Ko.min],Ae.max=[...Ko.max],Ae.min[2]+=Mr,Ae.max[2]+=Mr,s.af(Ae.min,Ae.min,Or),s.af(Ae.max,Ae.max,Or),Ae})(),Ei=Wn.evaluatedScale;if(Ei[0]<=1&&Ei[1]<=1&&Ei[2]<=1&&$r.intersects(Je)===0)continue;if(!at&&At){const Ko=.16666666666666666;Wn.cameraCollisionOpacity=_e[0]>$r.min[0]&&_e[0]<$r.max[0]&&_e[1]>$r.min[1]&&_e[1]<$r.max[1]&&_e[2]*st<$r.max[2]&&Lr.footprint&&s.b$(Ln,Lr.footprint)?Math.max(Wn.cameraCollisionOpacity-Ko,0):Math.min(1,Wn.cameraCollisionOpacity+Ko)}const no=[...Or],Vo=1/s.d6(qn.canonical),Ci=Lr.anchor?Lr.anchor[0]:0,Kn=Lr.anchor?Lr.anchor[1]:0;s.br(no,no,[Ci*(Ei[0]-1)+Wn.evaluatedTranslation[0]*Vo,Kn*(Ei[1]-1)+Wn.evaluatedTranslation[1]*Vo,Mr+Wn.evaluatedTranslation[2]]),s.cp(Ei,s.ev)||s.cR(no,no,Ei);const kn=s.aB([],no,Lr.matrix),qr=s.aB([],fe.expandedFarZProjMatrix,kn),qi=s.aB([],fe.expandedFarZProjMatrix,no),ki=s.aC([],[Ci,Kn,Mr,1],qr)[2];Lr.hidden=!1;let yo=it;at||(At&&(yo*=Wn.cameraCollisionOpacity,yo*=Z_(no,fe,Wn.aabb,_t)),yo*=xm(Ut,ki)),yo!==0?Ti.push({nodeInfo:Wn,depth:ki,opacity:yo,wvpForNode:qr,wvpForTile:qi,nodeModelMatrix:kn,tileModelMatrix:no}):Lr.hidden=!0}at||Ti.sort(((Wn,Lr)=>!At||Wn.opacity===1&&Lr.opacity===1?Wn.depth<Lr.depth?-1:1:Wn.opacity===1?-1:Lr.opacity===1?1:Wn.depth>Lr.depth?-1:1));for(const Wn of Ti){const Lr=Wn.nodeInfo,Mr=Lr.node;let $r=s.aB([],We,Wn.tileModelMatrix);s.aB($r,Le,$r);const Ei=s.bl([],$r);s.ed(Ei,Ei),s.cR(Ei,Ei,xS),$r=s.aB($r,$r,Mr.matrix);const no=Z.renderPass==="light-beam",Vo=ie.paint.get("model-color-use-theme").constantOr("default")==="none",Ci=Gr&s.ez.HasMapboxMeshFeatures,Kn=Ci?0:Lr.evaluatedRMEA[0][2];for(let kn=0;kn<Mr.meshes.length;++kn){const qr=Mr.meshes[kn],qi=kn===Mr.lightMeshIndex;let ki=Wn.wvpForNode;if(qi){if(!no&&!Z.terrain&&Z.shadowRenderer){Z.currentLayer<Z.firstLightBeamLayer&&(Z.firstLightBeamLayer=Z.currentLayer);continue}ki=Wn.wvpForTile}else if(no)continue;const yo={defines:[]},Ko=[];if(!at&&pe&&(pe.useNormalOffset=!!qr.normalBuffer),vm(yo.defines,Ko,qr,Z,Vo?null:ie.lut),Ci||yo.defines.push("DIFFUSE_SHADED"),Bn&&yo.defines.push("SHADOWS_SINGLE_CASCADE"),St&&(at?St.numRenderedVerticesInShadowPass+=qr.vertexArray.length:St.numRenderedVerticesInTransparentPass+=qr.vertexArray.length),at){Rf(qr,Wn.nodeModelMatrix,Z,ie);continue}let va=null;if(ge){const nl=$e(Wn.nodeModelMatrix,Z.transform);if(va=new Float32Array(nl),fe.projection.name!=="globe"){const eo=qr.aabb.min,ro=qr.aabb.max,[Oi,Io]=ge.getOpacityForBounds(nl,eo[0],eo[1],ro[0],ro[1]);yo.overrideFog=Oi>=on||Io>=on}}const ba=qr.material;let Ys;ba.occlusionTexture&&ba.occlusionTexture.offsetScale&&(Ys=ba.occlusionTexture.offsetScale,yo.defines.push("OCCLUSION_TEXTURE_TRANSFORM"));const Js=Z.getOrCreateProgram("model",yo);!at&&pe&&pe.setupShadowsFromMatrix(Wn.tileModelMatrix,Js,pe.useNormalOffset),Z.uploadCommonUniforms(me,Js,null,va);const Ts=ba.pbrMetallicRoughness;Ts.metallicFactor=.9,Ts.roughnessFactor=.5;const Ba=um(new Float32Array(ki),new Float32Array($r),new Float32Array(Ei),new Float32Array(Mr.matrix),Z,Wn.opacity,Ts.baseColorFactor,ba.emissiveFactor,Ts.metallicFactor,Ts.roughnessFactor,ba,Kn,ie,[0,0,0],Ys);!qi&&(Lr.hasTranslucentParts||Wn.opacity<1)&&Js.draw(Z,me.gl.TRIANGLES,Pt,Tn.disabled,In.disabled,Dn.backCCW,Ba,ie.id,qr.vertexBuffer,qr.indexBuffer,qr.segments,ie.paint,Z.transform.zoom,void 0,Ko),Js.draw(Z,me.gl.TRIANGLES,qi?qe:Pt,Tn.disabled,qi||Wn.opacity<1||Lr.hasTranslucentParts?In.alphaBlended:In.unblended,Dn.backCCW,Ba,ie.id,qr.vertexBuffer,qr.indexBuffer,qr.segments,ie.paint,Z.transform.zoom,void 0,Ko)}}}})()})(m,i,c,p),void I();if(O.type!=="model")return;const D=O.getModels(),N=[],z=m.transform.getFreeCameraOptions().position,U=s.c4([],[z.x,z.y,z.z],m.transform.worldSize);s.et(U,U);const G=[],H=[];let J=0;for(const Z of D){const ee=c.paint.get("model-rotation").constantOr(null),ie=c.paint.get("model-scale").constantOr(null),se=c.paint.get("model-translation").constantOr(null);Z.computeModelMatrix(m,ee,ie,se,!0,!0,!1);const me=s.bA([]),fe=s.ec(Z.position.lat,m.transform.zoom),ge=s.bq([],[1,1,1/fe]);s.br(me,me,U),N.push({zScaleMatrix:ge,negCameraPosMatrix:me});for(const pe of Z.nodes)bm(m.transform,pe,Z.matrix,m.transform.expandedFarZProjMatrix,J,G,H);J++}if(G.sort(((Z,ee)=>ee.depth-Z.depth)),m.renderPass!=="shadow"){if(y===1)for(const Z of H)Ku(Z,m,c,N[Z.modelIndex],Tn.disabled,m.colorModeForRenderPass());else{for(const Z of H)Ku(Z,m,c,N[Z.modelIndex],Tn.disabled,In.disabled);for(const Z of H)Ku(Z,m,c,N[Z.modelIndex],m.stencilModeFor3D(),m.colorModeForRenderPass());m.resetStencilClippingMasks()}for(const Z of G)Ku(Z,m,c,N[Z.modelIndex],Tn.disabled,m.colorModeForRenderPass());I()}else{for(const Z of H)Rf(Z.mesh,Z.nodeModelMatrix,m,c);for(const Z of G)Rf(Z.mesh,Z.nodeModelMatrix,m,c);I()}}},Zu={line:function(m,i,c){if(m.hasElevatedBuckets=!1,m.hasNonElevatedBuckets=!1,m._unevaluatedLayout.getValue("line-elevation-reference")!==void 0||m._unevaluatedLayout.getValue("line-z-offset")!==void 0){if(i){const p=i.getVisibleCoordinates();for(const y of p){const v=i.getTile(y).getBucket(m);if(v&&(v.elevationType!=="none"?m.hasElevatedBuckets=!0:m.hasNonElevatedBuckets=!0,m.hasElevatedBuckets&&m.hasNonElevatedBuckets))break}}}else m.hasNonElevatedBuckets=!0},model:function(m,i,c){const p=i.getSource();if(!p.loaded())return;if(p.type==="vector"||p.type==="geojson")return void(c.modelManager&&c.modelManager.upload(c,p.type==="vector"?m.scope:""));if(p.type==="batched-model"||p.type!=="model")return;const y=p.getModels();for(const v of y)v.upload(c.context)},raster:function(m,i,c){const p=i.getSource();if(!(p instanceof gl&&p.loaded()))return;const y=m.sourceLayer||p.rasterLayerIds&&p.rasterLayerIds[0];if(!y)return;const v=m.paint.get("raster-array-band")||p.getInitialBand(y);if(v==null)return;const w=i.getIds().map((S=>i.getTileByID(S)));for(const S of w)S.updateNeeded(m.id,v)&&p.prepareTile(S,y,m.id,v)},"raster-particle":function(m,i,c){const p=i.getSource();if(!(p instanceof gl&&p.loaded()))return;const y=m.sourceLayer||p.rasterLayerIds&&p.rasterLayerIds[0];if(!y)return;const v=m.paint.get("raster-particle-array-band")||p.getInitialBand(y);if(v==null)return;const w=i.getIds().map((S=>i.getTileByID(S)));for(const S of w)S.updateNeeded(m.id,v)&&p.prepareTile(S,y,m.id,v)}},Xu={fill:Uu},$c={fill:function(m,i,c,p){if(!c.layout||c.layout.get("fill-elevation-reference")==="none")return;const y=m.context.gl,v=new Gt(y.LEQUAL,Gt.ReadOnly,m.depthRangeFor3D),w=new Tn({func:y.ALWAYS,mask:255},255,255,y.KEEP,y.KEEP,y.REPLACE),S=m.transform.getFreeCameraOptions().position,I=m.getOrCreateProgram("elevatedStructuresDepthReconstruct");for(const O of p){const D=i.getTile(O),N=D.getBucket(c);if(!N)continue;const z=N.elevatedStructures;if(!z||z.depthSegments.segments[0].primitiveLength===0)continue;const U=zb(O.toUnwrapped(),S),G=m.translatePosMatrix(O.projMatrix,D,c.paint.get("fill-translate"),c.paint.get("fill-translate-anchor")),H=om(G,U,0,1,0);I.draw(m,y.TRIANGLES,v,w,In.disabled,Dn.disabled,H,c.id,z.vertexBuffer,z.indexBuffer,z.depthSegments,c.paint,m.transform.zoom)}}};class Y_{constructor(i,c,p,y,v,w){this.context=new V_(i,c),this.transform=p,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.tp=v,this._timeStamp=s.o.now(),this._averageFPS=0,this._fpsHistory=[],this._dt=0,this._debugParams={forceEnablePrecipitation:!1,showTerrainProxyTiles:!1,fpsWindow:30,continousRedraw:!1,enabledLayers:{}};const S=["fill","line","symbol","circle","heatmap","fill-extrusion","building","raster","raster-particle","hillshade","model","background","sky"];for(const O of S)this._debugParams.enabledLayers[O]=!0;v.registerParameter(this._debugParams,["Terrain"],"showTerrainProxyTiles",{},(()=>{this.style.map.triggerRepaint()})),v.registerParameter(this._debugParams,["Precipitation"],"forceEnablePrecipitation"),v.registerParameter(this._debugParams,["FPS"],"fpsWindow",{min:1,max:100,step:1}),v.registerBinding(this._debugParams,["FPS"],"continousRedraw",{readonly:!0,label:"continuous redraw"}),v.registerBinding(this,["FPS"],"_averageFPS",{readonly:!0,label:"value"}),v.registerBinding(this,["FPS"],"_averageFPS",{readonly:!0,label:"graph",view:"graph",min:0,max:200});for(const O of S)v.registerParameter(this._debugParams.enabledLayers,["Debug","Layers"],O);this.occlusionParams=new wm(v),this.setup(),this.numSublayers=vs.maxUnderzooming+vs.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={},this.conflationActive=!1,this.replacementSource=new s.eG,this.longestCutoffRange=0,this.minCutoffZoom=0,this._fogVisible=!1,this._cachedTileFogOpacities={},this._shadowRenderer=new ZT(this),this._wireframeDebugCache=new Hb,this.renderDefaultNorthPole=!0,this.renderDefaultSouthPole=!0,this.layersWithOcclusionOpacity=[];const I=new s.q({width:1,height:1},Uint8Array.of(0,0,0,0));this.emptyDepthTexture=new s.T(this.context,I,i.RGBA8),this._clippingActiveLastFrame=!1,this.scaleFactor=y,this.worldview=w}updateTerrain(i,c){const p=!!i&&!!i.terrain&&this.transform.projection.supportsTerrain;if(!(p||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new Ef(this,i));const y=this._terrain;this.transform.elevation=p?y:null,y.update(i,this.transform,c),this.transform.elevation&&!y.enabled&&(this.transform.elevation=null)}_updateFog(i){const c=i.fog;if(!c||this.transform.projection.name==="globe"||c.getOpacity(this.transform.pitch)<1||c.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[p,y]=c.getFovAdjustedRange(this.transform._fov);if(p>y)return void(this.transform.fogCullDistSq=null);const v=p+.78*(y-p);this.transform.fogCullDistSq=v*v}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled||this._forceTerrainMode?this._terrain:null}get forceTerrainMode(){return this._forceTerrainMode}set forceTerrainMode(i){i&&!this._terrain&&(this._terrain=new Ef(this,this.style)),this._forceTerrainMode=i}get shadowRenderer(){return this._shadowRenderer&&this._shadowRenderer.enabled?this._shadowRenderer:null}get wireframeDebugCache(){return this._wireframeDebugCache}resize(i,c){if(this.width=i*s.o.devicePixelRatio,this.height=c*s.o.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const p of this.style.order)this.style._mergedLayers[p].resize()}setup(){const i=this.context,c=new s.bd;c.emplaceBack(0,0),c.emplaceBack(s.al,0),c.emplaceBack(0,s.al),c.emplaceBack(s.al,s.al),this.tileExtentBuffer=i.createVertexBuffer(c,s.bf.members),this.tileExtentSegments=s.bg.simpleSegment(0,0,4,2);const p=new s.bd;p.emplaceBack(0,0),p.emplaceBack(s.al,0),p.emplaceBack(0,s.al),p.emplaceBack(s.al,s.al),this.debugBuffer=i.createVertexBuffer(p,s.bf.members),this.debugSegments=s.bg.simpleSegment(0,0,4,5);const y=new s.bd;y.emplaceBack(-1,-1),y.emplaceBack(1,-1),y.emplaceBack(-1,1),y.emplaceBack(1,1),this.viewportBuffer=i.createVertexBuffer(y,s.bf.members),this.viewportSegments=s.bg.simpleSegment(0,0,4,2);const v=new s.b0;v.emplaceBack(0,0,0,0),v.emplaceBack(s.al,0,s.al,0),v.emplaceBack(0,s.al,0,s.al),v.emplaceBack(s.al,s.al,s.al,s.al),this.mercatorBoundsBuffer=i.createVertexBuffer(v,s.bi.members),this.mercatorBoundsSegments=s.bg.simpleSegment(0,0,4,2);const w=new s.b1;w.emplaceBack(0,1,2),w.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=i.createIndexBuffer(w);const S=new s.be;for(const O of[0,1,3,2,0])S.emplaceBack(O);this.debugIndexBuffer=i.createIndexBuffer(S),this.emptyTexture=new s.T(i,new s.q({width:1,height:1},Uint8Array.of(0,0,0,0)),i.gl.RGBA8),this.identityMat=s.bC();const I=this.context.gl;this.stencilClearMode=new Tn({func:I.ALWAYS,mask:0},0,255,I.ZERO,I.ZERO,I.ZERO),this.loadTimeStamps.push(performance.now())}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(i){return i._makeTileBoundsBuffers(this.context,this.transform.projection),i._tileBoundsBuffer?{tileBoundsBuffer:i._tileBoundsBuffer,tileBoundsIndexBuffer:i._tileBoundsIndexBuffer,tileBoundsSegments:i._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const i=this.context.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.getOrCreateProgram("clippingMask").draw(this,i.TRIANGLES,Gt.disabled,this.stencilClearMode,In.disabled,Dn.disabled,Fu(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(i,c,p){if(!c||this.currentStencilSource===c.id||!i.isTileClipped()||!p||p.length===0)return;if(this._tileClippingMaskIDs&&!this.terrain){let S=!1;for(const I of p)if(this._tileClippingMaskIDs[I.key]===void 0){S=!0;break}if(!S)return}this.currentStencilSource=c.id;const y=this.context,v=y.gl;this.nextStencilID+p.length>256&&this.clearStencil(),y.setColorMode(In.disabled),y.setDepthMode(Gt.disabled);const w=this.getOrCreateProgram("clippingMask");this._tileClippingMaskIDs={};for(const S of p){const I=c.getTile(S),O=this._tileClippingMaskIDs[S.key]=this.nextStencilID++,{tileBoundsBuffer:D,tileBoundsIndexBuffer:N,tileBoundsSegments:z}=this.getTileBoundsBuffers(I);w.draw(this,v.TRIANGLES,Gt.disabled,new Tn({func:v.ALWAYS,mask:0},O,255,v.KEEP,v.KEEP,v.REPLACE),In.disabled,Dn.disabled,Fu(S.projMatrix),"$clipping",D,N,z)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const i=this.nextStencilID++,c=this.context.gl;return new Tn({func:c.NOTEQUAL,mask:255},i,255,c.KEEP,c.KEEP,c.REPLACE)}stencilModeForClipping(i){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(i);const c=this.context.gl;return new Tn({func:c.EQUAL,mask:255},this._tileClippingMaskIDs[i.key],0,c.KEEP,c.KEEP,c.REPLACE)}stencilConfigForOverlap(i){const c=this.context.gl,p=i.sort(((w,S)=>S.overscaledZ-w.overscaledZ)),y=p[p.length-1].overscaledZ,v=p[0].overscaledZ-y+1;if(v>1){this.currentStencilSource=void 0,this.nextStencilID+v>256&&this.clearStencil();const w={};for(let S=0;S<v;S++)w[S+y]=new Tn({func:c.GEQUAL,mask:255},S+this.nextStencilID,255,c.KEEP,c.KEEP,c.REPLACE);return this.nextStencilID+=v,[w,p]}return[{[y]:Tn.disabled},p]}colorModeForRenderPass(){const i=this.context.gl;return this._showOverdrawInspector?new In([i.CONSTANT_COLOR,i.ONE,i.CONSTANT_COLOR,i.ONE],new s.ao(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?In.unblended:In.alphaBlended}colorModeForDrapableLayerRenderPass(i){const c=this.context.gl;return this.style&&this.style.enable3dLights()&&this.terrain&&this.terrain.renderingToTexture&&this.renderPass==="translucent"?new In([c.ONE,c.ONE_MINUS_SRC_ALPHA,c.CONSTANT_ALPHA,c.ONE_MINUS_SRC_ALPHA],new s.ao(0,0,0,i===void 0?0:i),[!0,!0,!0,!0]):this.colorModeForRenderPass()}depthModeForSublayer(i,c,p,y=!1){if(this.depthOcclusion)return new Gt(this.context.gl.GREATER,Gt.ReadOnly,this.depthRangeFor3D);if(!this.opaquePassEnabledForLayer()&&!y)return Gt.disabled;const v=1-((1+this.currentLayer)*this.numSublayers+i)*this.depthEpsilon;return new Gt(p||this.context.gl.LEQUAL,c,[v,v])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}blitDepth(){const i=this.context.gl,c=Math.ceil(this.width),p=Math.ceil(this.height),y=this.context.bindFramebuffer.get(),v=i.getParameter(i.TEXTURE_BINDING_2D);this.depthFBO&&this.depthFBO.width===c&&this.depthFBO.height===p||(this.depthFBO&&(this.depthFBO.destroy(),this.depthFBO=void 0,this.depthTexture=void 0),c!==0&&p!==0&&(this.depthFBO=new dm(this.context,c,p,!1,"texture"),this.depthTexture=new s.T(this.context,{width:c,height:p,data:null},i.DEPTH24_STENCIL8),this.depthFBO.depthAttachment.set(this.depthTexture.texture))),this.context.bindFramebuffer.set(y),i.bindTexture(i.TEXTURE_2D,v),this.depthFBO&&(i.bindFramebuffer(i.READ_FRAMEBUFFER,null),i.bindFramebuffer(i.DRAW_FRAMEBUFFER,this.depthFBO.framebuffer),i.blitFramebuffer(0,0,c,p,0,0,c,p,i.DEPTH_BUFFER_BIT,i.NEAREST),i.bindFramebuffer(i.FRAMEBUFFER,this.context.bindFramebuffer.current))}updateAverageFPS(){this._fpsHistory.push(this._dt===0?0:1e3/this._dt),this._fpsHistory.length>this._debugParams.fpsWindow&&this._fpsHistory.splice(0,this._fpsHistory.length-this._debugParams.fpsWindow),this._averageFPS=Math.round(this._fpsHistory.reduce(((i,c)=>i+c/this._fpsHistory.length),0))}render(i,c){const p=s.o.now();this._dt=p-this._timeStamp,this._timeStamp=p,this._wireframeDebugCache.update(this.frameCounter),this._debugParams.continousRedraw=i.map.repaint,this.style=i,this.options=c;const y=this.style._mergedLayers,v=!(!this.terrain||!this.terrain.enabled),w=()=>this.style._getOrder(v).filter((qe=>{const Ae=y[qe];return!(Ae.type in this._debugParams.enabledLayers)||this._debugParams.enabledLayers[Ae.type]}));let S=w(),I=!1,O=!1,D=null;for(const qe of S){const Ae=y[qe];Ae.type==="circle"?I=!0:Ae.type==="building"?D=Ae:Ae.type==="symbol"&&(Ae.hasOcclusionOpacityProperties?O=!0:I=!0)}let N=S.map((qe=>y[qe]));const z=this.style._mergedSourceCaches;this.imageManager=i.imageManager,this.modelManager=i.modelManager,this.symbolFadeChange=i.placement.symbolFadeChange(s.o.now()),this.imageManager.beginFrame();let U=0,G=!1;for(const qe in z){const Ae=z[qe];Ae.used&&(Ae.prepare(this.context),Ae.getSource().usedInConflation&&++U)}let H=!1;for(const qe of N)qe.isHidden(this.transform.zoom)||(qe.type==="clip"&&(H=!0),this.prepareLayer(qe));const J={},Z={},ee={},ie={},se={};for(const qe in z){const Ae=z[qe];J[qe]=Ae.getVisibleCoordinates(),Z[qe]=J[qe].slice().reverse(),ee[qe]=Ae.getVisibleCoordinates(!0).reverse(),ie[qe]=Ae.getShadowCasterCoordinates(),se[qe]=Ae.sortCoordinatesByDistance(J[qe])}const me=qe=>{const Ae=this.style.getLayerSourceCache(qe);return Ae&&Ae.used?Ae.getSource():null};if(U||H||this._clippingActiveLastFrame){const qe=[],Ae=[];let at=0;for(const Je of N)this.isSourceForClippingOrConflation(Je,me(Je))&&(qe.push(Je),Ae.push(at)),at++;if(qe&&(H||qe.length>1)||this._clippingActiveLastFrame){H=!1;const Je=[];for(let _t=0;_t<qe.length;_t++){const At=qe[_t],Ut=Ae[_t],St=this.style.getLayerSourceCache(At);if(!St||!St.used||!St.getSource().usedInConflation&&At.type!=="clip"&&At.type!=="building")continue;let bt=s.eH,un=s.bZ.None;const en=[];let an=!0;if(At.type==="building")bt=s.eJ;else if(At.type==="clip"){bt=Ut;for(const Qt of At.layout.get("clip-layer-types"))un|=Qt==="model"?s.bZ.Model:Qt==="symbol"?s.bZ.Symbol:s.bZ.FillExtrusion;for(const Qt of At.layout.get("clip-layer-scope"))en.push(Qt);At.isHidden(this.transform.zoom)?an=!1:H=!0}an&&Je.push({layer:At.fqid,cache:St,order:bt,clipMask:un,clipScope:en})}this.replacementSource.setSources(Je),G=!0}}this._clippingActiveLastFrame=H,G||this.replacementSource.clear(),this.conflationActive=G,this.minCutoffZoom=0,this.longestCutoffRange=0,this.opaquePassCutoff=1/0,this._lastOcclusionLayer=-1,this.layersWithOcclusionOpacity=[];for(let qe=0;qe<N.length;qe++){const Ae=N[qe],at=Ae.cutoffRange();if(this.longestCutoffRange=Math.max(at,this.longestCutoffRange),at>0){const Je=me(Ae);Je&&(this.minCutoffZoom=Math.max(Je.minzoom,this.minCutoffZoom)),Ae.minzoom&&(this.minCutoffZoom=Math.max(Ae.minzoom,this.minCutoffZoom))}Ae.is3D(v)&&(this.opaquePassCutoff===1/0&&(this.opaquePassCutoff=qe),this._lastOcclusionLayer=qe)}const fe=this.style&&this.style.fog;fe?(this._fogVisible=fe.getOpacity(this.transform.pitch)!==0,this._fogVisible&&this.transform.projection.name!=="globe"&&(this._fogVisible=fe.isVisibleOnFrustum(this.transform.cameraFrustum))):this._fogVisible=!1,this._cachedTileFogOpacities={},this.terrain&&(this.terrain.updateTileBinding(ee),this.opaquePassCutoff=0,S=w(),N=S.map((qe=>y[qe])));const ge=this._shadowRenderer;if(ge){ge.updateShadowParameters(this.transform,this.style.directionalLight);for(const qe in z)for(const Ae of J[qe]){let at={min:0,max:0};this.terrain&&(at=this.terrain.getMinMaxForTile(Ae)||at),ge.addShadowReceiver(Ae.toUnwrapped(),at.min,at.max)}}this.transform.projection.name!=="globe"||this.globeSharedBuffers||(this.globeSharedBuffers=new s.eI(this.context)),this.style.fog&&this.transform.projection.supportsFog?(this._atmosphere||(this._atmosphere=new Jd(this)),this._atmosphere.update(this)):this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0);const pe=this._debugParams.forceEnablePrecipitation||!(!this.style||!this.style.snow),he=this._debugParams.forceEnablePrecipitation||!(!this.style||!this.style.rain);if(pe&&!this._snow&&(this._snow=new Zb(this)),!pe&&this._snow&&(this._snow.destroy(),delete this._snow),he&&!this._rain&&(this._rain=new wi(this)),!he&&this._rain&&(this._rain.destroy(),delete this._rain),this._snow&&this._snow.update(this),this._rain&&this._rain.update(this),D){this.buildingTileBorderManager||(this.buildingTileBorderManager=new Wi);const qe=this.style.getLayerSourceCache(D);this.buildingTileBorderManager.updateBorders(qe,D)}if(!Nr.has(this.context.gl))return;this.renderPass="offscreen";for(const qe of N){const Ae=i.getLayerSourceCache(qe);if(!qe.hasOffscreenPass()||qe.isHidden(this.transform.zoom))continue;const at=Ae?Z[Ae.id]:void 0;(qe.type==="custom"||qe.type==="raster"||qe.type==="raster-particle"||qe.isSky()||at&&at.length)&&this.renderLayer(this,Ae,qe,at)}this.depthRangeFor3D=[0,1-(N.length+2)*this.numSublayers*this.depthEpsilon],this._shadowRenderer&&(this.renderPass="shadow",this._shadowRenderer.drawShadowPass(this.style,ie)),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]);const _e=this.transform.projection.name==="globe"||this.transform.isHorizonVisible(),Ke=(()=>{if(c.showOverdrawInspector)return s.ao.black;const qe=this.style.fog;if(qe&&this.transform.projection.supportsFog){const Ae=this.style.getLut(qe.scope);if(!_e){const at=qe.properties.get("color-use-theme")==="none",Je=qe.properties.get("color").toNonPremultipliedRenderColor(at?null:Ae).toArray01();return new s.ao(...Je)}if(_e){const at=qe.properties.get("space-color-use-theme")==="none",Je=qe.properties.get("space-color").toNonPremultipliedRenderColor(at?null:Ae).toArray01();return new s.ao(...Je)}}return s.ao.transparent})();if(this.context.clear({color:Ke,depth:1}),this.clearStencil(),this._showOverdrawInspector=c.showOverdrawInspector,this.renderPass="opaque",this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&_e&&this._atmosphere.drawStars(this,this.style.fog),!this.terrain)for(this.currentLayer=S.length-1;this.currentLayer>=0;this.currentLayer--){const qe=N[this.currentLayer],Ae=i.getLayerSourceCache(qe);if(qe.isSky())continue;const at=Ae?(qe.is3D(v)?se:Z)[Ae.id]:void 0;this._renderTileClippingMasks(qe,Ae,at),this.renderLayer(this,Ae,qe,at)}if(this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&_e&&this._atmosphere.drawAtmosphereGlow(this,this.style.fog),this.renderPass="sky",(!this._atmosphere||s.aj(this.transform.zoom)>0)&&(this.transform.projection.name==="globe"||this.transform.isHorizonVisible()))for(this.currentLayer=0;this.currentLayer<S.length;this.currentLayer++){const qe=N[this.currentLayer],Ae=i.getLayerSourceCache(qe);qe.isSky()&&this.renderLayer(this,Ae,qe,Ae?Z[Ae.id]:void 0)}function Le(qe,Ae){let at;return Ae&&(at=(qe.type==="symbol"?ee:qe.is3D(v)?se:Z)[Ae.id]),at}if(this.renderPass="translucent",this.transform.projection.name==="globe"){for(this.renderElevatedRasterBackface=!0,this.currentLayer=0;this.currentLayer<S.length;){const qe=N[this.currentLayer];if(qe.type==="raster"||qe.type==="raster-particle"){const Ae=i.getLayerSourceCache(qe);this.renderLayer(this,Ae,qe,Le(qe,Ae))}++this.currentLayer}this.renderElevatedRasterBackface=!1}this.currentLayer=0,this.firstLightBeamLayer=Number.MAX_SAFE_INTEGER;let st=0;ge&&(st=ge.getShadowCastingLayerCount());let We=!1,it=-1;for(let qe=0;qe<S.length;++qe){const Ae=N[qe];Ae.isHidden(this.transform.zoom)||Ae.is3D(v)&&(it=qe)}O&&it===-1&&(I=!0);let Pt=!1;for(;this.currentLayer<S.length;){const qe=N[this.currentLayer],Ae=i.getLayerSourceCache(qe);if(qe.isSky())++this.currentLayer;else if(this.terrain&&this.style.isLayerDraped(qe)){if(qe.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer),this._lastOcclusionLayer=Math.max(this.currentLayer,this._lastOcclusionLayer)}else{if(!Pt&&qe.is3D(v)&&!v){const at=this.currentLayer,Je=_t=>{for(this.currentLayer=0;this.currentLayer<N.length;this.currentLayer++){const At=N[this.currentLayer];if(Xu[At.type]){const Ut=this.style.getLayerSourceCache(At);Xu[At.type](this,Ut,At,Le(At,Ut),_t)}}};Je("initialize"),Je("reset"),this.currentLayer=at,Pt=!0}if(I&&!We&&this.terrain&&!this.transform.isOrthographic&&(We=!0,this.blitDepth()),O&&it!==-1&&this.currentLayer===it+1&&!this.transform.isOrthographic&&this.blitDepth(),this.terrain||this._renderTileClippingMasks(qe,Ae,Ae?J[Ae.id]:void 0),this.renderLayer(this,Ae,qe,Le(qe,Ae)),!this.terrain&&ge&&st>0&&qe.hasShadowPass()&&--st==0){{this.clearStencil(),this.resetStencilClippingMasks();const at=this.currentLayer;for(this.currentLayer=0;this.currentLayer<N.length;this.currentLayer++){const Je=N[this.currentLayer];if($c[Je.type]){const _t=this.style.getLayerSourceCache(Je);$c[Je.type](this,_t,Je,Le(Je,_t))}}this.currentLayer=at}if(ge.drawGroundShadows(),this.firstLightBeamLayer<=this.currentLayer){const at=this.currentLayer;for(this.renderPass="light-beam",this.currentLayer=this.firstLightBeamLayer;this.currentLayer<=at;this.currentLayer++){const Je=N[this.currentLayer];if(!Je.hasLightBeamPass())continue;const _t=i.getLayerSourceCache(Je);this.renderLayer(this,_t,Je,_t?Z[_t.id]:void 0)}this.currentLayer=at,this.renderPass="translucent"}}if(this.currentLayer>=this._lastOcclusionLayer&&this.layersWithOcclusionOpacity.length>0){const at=this.currentLayer;this.depthOcclusion=!0;for(const Je of this.layersWithOcclusionOpacity){this.currentLayer=Je;const _t=N[this.currentLayer],At=i.getLayerSourceCache(_t),Ut=At?Z[At.id]:void 0;this.terrain||this._renderTileClippingMasks(_t,At,At?J[At.id]:void 0),this.renderLayer(this,At,_t,Ut)}this.depthOcclusion=!1,this.currentLayer=at,this.renderPass="translucent",this.layersWithOcclusionOpacity=[]}++this.currentLayer}}if(this.terrain&&this.terrain.postRender(),this._snow&&this._snow.draw(this),this._rain&&this._rain.draw(this),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let qe=null;N.forEach((Ae=>{const at=i.getLayerSourceCache(Ae);at&&!Ae.isHidden(this.transform.zoom)&&at.getVisibleCoordinates().length&&(!qe||qe.getSource().maxzoom<at.getSource().maxzoom)&&(qe=at)})),qe&&this.options.showTileBoundaries&&ym(this,qe,qe.getVisibleCoordinates(),s.ao.red,!1,this.options.showParseStatus)}this.terrain&&this._debugParams.showTerrainProxyTiles&&ym(this,this.terrain.proxySourceCache,this.terrain.proxyCoords,new s.ao(1,.8,.1,1),!0,this.options.showParseStatus),this.options.showPadding&&(function(qe){const Ae=qe.transform.padding;El(qe,qe.transform.height-(Ae.top||0),3,ws),El(qe,Ae.bottom||0,3,Bc),pi(qe,Ae.left||0,3,Nb),pi(qe,qe.transform.width-(Ae.right||0),3,H_);const at=qe.transform.centerPoint;(function(Je,_t,At,Ut){Gu(Je,_t-1,At-10,2,20,Ut),Gu(Je,_t-10,At-1,20,2,Ut)})(qe,at.x,qe.transform.height-at.y,W_)})(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(performance.now()),this.saveCanvasCopy()),G||(this.conflationActive=!1)}prepareLayer(i){this.gpuTimingStart(i);const{unsupportedLayers:c}=this.transform.projection,p=!c||!c.includes(i.type);if(Zu[i.type]&&(p||this.terrain&&i.type==="custom")){const y=this.style.getLayerSourceCache(i);Zu[i.type](i,y,this)}this.gpuTimingEnd()}renderLayer(i,c,p,y){p.isHidden(this.transform.zoom)||(p.type==="background"||p.type==="sky"||p.type==="custom"||p.type==="model"||p.type==="raster"||p.type==="raster-particle"||y&&y.length)&&(this.id=p.id,this.gpuTimingStart(p),i.transform.projection.unsupportedLayers&&i.transform.projection.unsupportedLayers.includes(p.type)&&(!i.terrain||p.type!=="custom")||p.type==="clip"||Vc[p.type](i,c,p,y,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(i){if(!this.options.gpuTiming)return;const c=this.context.extTimerQuery,p=this.context.gl;let y=this.gpuTimers[i.id];y||(y=this.gpuTimers[i.id]={calls:0,cpuTime:0,query:p.createQuery()}),y.calls++,p.beginQuery(c.TIME_ELAPSED_EXT,y.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const i=this.context.extTimerQuery,c=this.context.gl,p=c.createQuery();this.deferredRenderGpuTimeQueries.push(p),c.beginQuery(i.TIME_ELAPSED_EXT,p)}}gpuTimingDeferredRenderEnd(){this.options.gpuTimingDeferredRender&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}gpuTimingEnd(){this.options.gpuTiming&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}collectGpuTimers(){const i=this.gpuTimers;return this.gpuTimers={},i}collectDeferredRenderGpuQueries(){const i=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],i}queryGpuTimers(i){const c={};for(const p in i){const y=i[p],v=this.context.extTimerQuery,w=v.getQueryParameter(y.query,this.context.gl.QUERY_RESULT)/1e6;v.deleteQueryEXT(y.query),c[p]=w}return c}queryGpuTimeDeferredRender(i){if(!this.options.gpuTimingDeferredRender)return 0;const c=this.context.gl;let p=0;for(const y of i)p+=c.getQueryParameter(y,c.QUERY_RESULT)/1e6,c.deleteQuery(y);return p}translatePosMatrix(i,c,p,y,v){if(!p[0]&&!p[1])return i;const w=v?y==="map"?this.transform.angle:0:y==="viewport"?-this.transform.angle:0;if(w){const O=Math.sin(w),D=Math.cos(w);p=[p[0]*D-p[1]*O,p[0]*O+p[1]*D]}const S=[v?p[0]:s.ay(c,p[0],this.transform.zoom),v?p[1]:s.ay(c,p[1],this.transform.zoom),0],I=new Float32Array(16);return s.br(I,i,S),I}saveTileTexture(i){if(i.context!==this.context)return;const c=i.size[0],p=this._tileTextures[c];p?p.push(i):this._tileTextures[c]=[i]}getTileTexture(i){const c=this._tileTextures[i];return c&&c.length>0?c.pop():null}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture||this.forceTerrainMode}linearFloatFilteringSupported(){return this.context.extTextureFloatLinear!=null}currentGlobalDefines(i,c,p){const y=p===void 0?this.terrain&&this.terrain.renderingToTexture:p,v=[];return this.style&&this.style.enable3dLights()&&(i==="globeRaster"||i==="terrainRaster"?(v.push("LIGHTING_3D_MODE"),v.push("LIGHTING_3D_ALPHA_EMISSIVENESS")):y||v.push("LIGHTING_3D_MODE")),this.renderPass==="shadow"&&(this._shadowMapDebug||v.push("DEPTH_TEXTURE")),this.terrainRenderModeElevated()&&(v.push("TERRAIN"),this.linearFloatFilteringSupported()&&v.push("TERRAIN_DEM_FLOAT_FORMAT")),this.transform.projection.name==="globe"&&v.push("GLOBE"),!this._fogVisible||y||c!==void 0&&!c||v.push("FOG","FOG_DITHERING"),y&&v.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&v.push("OVERDRAW_INSPECTOR"),v}getOrCreateProgram(i,c){this.cache=this.cache||{};const p=c&&c.defines||[],y=c&&c.config,v=this.currentGlobalDefines(i,c&&c.overrideFog,c&&c.overrideRtt).concat(p),w=im.cacheKey(Hp[i],i,v,y);return this.cache[w]||(this.cache[w]=new im(this.context,i,Hp[i],y,gS[i],v)),this.cache[w]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const i=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(i.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new s.T(this.context,this.debugOverlayCanvas,this.context.gl.RGBA8))}destroy(){this._terrain&&this._terrain.destroy(),this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this._wireframeDebugCache.destroy(),this.depthFBO&&(this.depthFBO.destroy(),this.depthFBO=void 0,this.depthTexture=void 0),this.emptyDepthTexture&&this.emptyDepthTexture.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}uploadCommonLightUniforms(i,c){if(this.style.enable3dLights()){const p=this.style.directionalLight,y=this.style.ambientLight;if(p&&y){const v=((w,S,I)=>{const O=w.properties.get("direction"),D=w.properties.get("color-use-theme")==="none",N=w.properties.get("color").toNonPremultipliedRenderColor(D?null:I.getLut(w.scope)).toArray01(),z=w.properties.get("intensity"),U=S.properties.get("color-use-theme")==="none",G=S.properties.get("color").toNonPremultipliedRenderColor(U?null:I.getLut(S.scope)).toArray01(),H=S.properties.get("intensity"),J=[O.x,O.y,O.z],Z=s.dK(G,H),ee=s.dK(N,z);return{u_lighting_ambient_color:Z,u_lighting_directional_dir:J,u_lighting_directional_color:ee,u_ground_radiance:rm(J,ee,Z)}})(p,y,this.style);c.setLightsUniformValues(i,v)}}}uploadCommonUniforms(i,c,p,y,v){if(this.uploadCommonLightUniforms(i,c),this.terrain&&this.terrain.renderingToTexture)return;const w=this.style.fog;if(w){const S=w.getOpacity(this.transform.pitch),I=((O,D,N,z,U,G,H,J,Z,ee,ie,se)=>{const me=O.transform,fe=D.properties.get("color-use-theme")==="none",ge=D.properties.get("color").toNonPremultipliedRenderColor(fe?null:O.style.getLut(D.scope)).toArray01();ge[3]=z;const pe=O.frameCounter/1e3%1,[he,_e]=D.properties.get("vertical-range");return{u_fog_matrix:N?me.calculateFogTileMatrix(N):se||O.identityMat,u_fog_range:D.getFovAdjustedRange(me._fov),u_fog_color:ge,u_fog_horizon_blend:D.properties.get("horizon-blend"),u_fog_vertical_limit:[Math.min(he,_e),_e],u_fog_temporal_offset:pe,u_frustum_tl:U,u_frustum_tr:G,u_frustum_br:H,u_frustum_bl:J,u_globe_pos:Z,u_globe_radius:ee,u_viewport:ie,u_globe_transition:s.aj(me.zoom),u_is_globe:+(me.projection.name==="globe")}})(this,w,p,S,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*s.o.devicePixelRatio,this.transform.height*s.o.devicePixelRatio],y);c.setFogUniformValues(i,I)}v&&c.setCutoffUniformValues(i,v.uniformValues)}setTileLoadedFlag(i){this.tileLoaded=i}saveCanvasCopy(){const i=this.canvasCopy();i&&(this.frameCopies.push(i),this.tileLoaded=!1)}canvasCopy(){const i=this.context.gl,c=i.createTexture();return i.bindTexture(i.TEXTURE_2D,c),i.copyTexImage2D(i.TEXTURE_2D,0,i.RGBA,0,0,i.drawingBufferWidth,i.drawingBufferHeight,0),c}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const i=this.style&&this.style.fog;return!!i&&i.getOpacity(this.transform.pitch)!==0}getBackgroundTiles(){const i=this._backgroundTiles,c=this._backgroundTiles={},p=this.transform.coveringTiles({tileSize:512});for(const y of p)c[y.key]=i[y.key]||new vl(y,512,this.transform.tileZoom,this,void 0,this.worldview);return c}clearBackgroundTiles(){this._backgroundTiles={}}isSourceForClippingOrConflation(i,c){return!(!i.is3D(!(!this.terrain||!this.terrain.enabled))||i.type!=="clip"&&i.type!=="building"&&(i.minzoom&&i.minzoom>this.transform.zoom||(this.style._clipLayerPresent||i.sourceLayer!=="building"&&i.sourceLayer!=="procedural_buildings")&&(!c||c.type!=="batched-model")))}isTileAffectedByFog(i){if(!this.style||!this.style.fog)return!1;if(this.transform.projection.name==="globe")return!0;let c=this._cachedTileFogOpacities[i.key];return c||(this._cachedTileFogOpacities[i.key]=c=this.style.fog.getOpacityForTile(i)),c[0]>=on||c[1]>=on}setupDepthForOcclusion(i,c,p){const y=this.context,v=y.gl,w=!!p;var S;p||(p={u_dem:2,u_dem_prev:4,u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_depth_range_unpack:[0,1],u_occluder_half_size:16,u_occlusion_depth_offset:-1e-4,u_exaggeration:0}),y.activeTexture.set(v.TEXTURE3),i&&this.depthFBO&&this.depthTexture?(this.depthTexture.bind(v.NEAREST,v.CLAMP_TO_EDGE),p.u_depth_size_inv=[1/this.depthFBO.width,1/this.depthFBO.height],p.u_depth_range_unpack=[2/((S=this.depthRangeFor3D)[1]-S[0]),-1-2*S[0]/(S[1]-S[0])],p.u_occluder_half_size=.5*this.occlusionParams.occluderSize,p.u_occlusion_depth_offset=this.occlusionParams.depthOffset):this.emptyDepthTexture.bind(v.NEAREST,v.CLAMP_TO_EDGE),y.activeTexture.set(v.TEXTURE0),w||c.setTerrainUniformValues(y,p)}}function Tm(m,i){let c=!1,p=null;const y=()=>{p=null,c&&(m(),p=setTimeout(y,i),c=!1)};return()=>(c=!0,p||y(),p)}class J_{constructor(i){this._hashName=i&&encodeURIComponent(i),s.aY(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=Tm(this._updateHashUnthrottled.bind(this),300)}addTo(i){return this._map=i,window.addEventListener("hashchange",this._onHashChange,!1),i.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const i=this._map;if(!i)return"";const c=Sm(i);if(this._hashName){const p=this._hashName;let y=!1;const v=location.hash.slice(1).split("&").map((w=>{const S=w.split("=")[0];return S===p?(y=!0,`${S}=${c}`):w})).filter((w=>w));return y||v.push(`${p}=${c}`),`#${v.join("&")}`}return`#${c}`}_getCurrentHash(){const i=location.hash.replace("#","");if(this._hashName){let c;return i.split("&").map((p=>p.split("="))).forEach((p=>{p[0]===this._hashName&&(c=p)})),(c&&c[1]||"").split("/")}return i.split("/")}_onHashChange(){const i=this._map;if(!i)return!1;const c=this._getCurrentHash();if(c.length>=3&&!c.some((p=>isNaN(Number(p))))){const p=i.dragRotate.isEnabled()&&i.touchZoomRotate.isEnabled()?+(c[3]||0):i.getBearing();return i.jumpTo({center:[+c[2],+c[1]],zoom:+c[0],bearing:p,pitch:+(c[4]||0)}),!0}return!1}_updateHashUnthrottled(){history.replaceState(history.state,"",location.href.replace(/(#.+)?$/,this.getHashString()))}}function Sm(m,i){const c=m.getCenter(),p=Math.round(100*m.getZoom())/100,y=Math.ceil((p*Math.LN2+Math.log(512/360/.5))/Math.LN10),v=Math.pow(10,y),w=Math.round(c.lng*v)/v,S=Math.round(c.lat*v)/v,I=m.getBearing(),O=m.getPitch();let D=i?`/${w}/${S}/${p}`:`${p}/${S}/${w}`;return(I||O)&&(D+="/"+Math.round(10*I)/10),O&&(D+=`/${Math.round(O)}`),D}const Bs={linearity:.3,easing:s.eK(0,0,.3,1)},Uc=Object.assign({deceleration:2500,maxSpeed:1400},Bs),nh=Object.assign({deceleration:20,maxSpeed:1400},Bs),Em=Object.assign({deceleration:1e3,maxSpeed:360},Bs),Q_=Object.assign({deceleration:1e3,maxSpeed:90},Bs);class ey{constructor(i){this._map=i,this.clear()}clear(){this._inertiaBuffer=[]}record(i){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:s.o.now(),settings:i})}_drainInertiaBuffer(){const i=this._inertiaBuffer,c=s.o.now();for(;i.length>0&&c-i[0].time>160;)i.shift()}_onMoveEnd(i){if(this._map._prefersReducedMotion()||(this._drainInertiaBuffer(),this._inertiaBuffer.length<2))return;const c={zoom:0,bearing:0,pitch:0,pan:new s.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:v}of this._inertiaBuffer)c.zoom+=v.zoomDelta||0,c.bearing+=v.bearingDelta||0,c.pitch+=v.pitchDelta||0,v.panDelta&&c.pan._add(v.panDelta),v.around&&(c.around=v.around),v.pinchAround&&(c.pinchAround=v.pinchAround);const p=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,y={};if(c.pan.mag()){const v=rh(c.pan.mag(),p,Object.assign({},Uc,i||{}));y.offset=c.pan.mult(v.amount/c.pan.mag()),y.center=this._map.transform.center,el(y,v)}if(c.zoom){const v=rh(c.zoom,p,nh);y.zoom=this._map.transform.zoom+v.amount,el(y,v)}if(c.bearing){const v=rh(c.bearing,p,Em);y.bearing=this._map.transform.bearing+s.aA(v.amount,-179,179),el(y,v)}if(c.pitch){const v=rh(c.pitch,p,Q_);y.pitch=this._map.transform.pitch+v.amount,el(y,v)}if(y.zoom||y.bearing){const v=c.pinchAround===void 0?c.around:c.pinchAround;y.around=v?this._map.unproject(v):this._map.getCenter()}return this.clear(),y.noMoveStart=!0,y}}function el(m,i){(!m.duration||m.duration<i.duration)&&(m.duration=i.duration,m.easing=i.easing)}function rh(m,i,c){const{maxSpeed:p,linearity:y,deceleration:v}=c,w=s.aA(m*y/(i/1e3),-p,p),S=Math.abs(w)/(v*y);return{easing:c.easing,duration:1e3*S,amount:w*(S/2)}}class Co extends s.z{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(i,c,p,y={}){const v=we(c.getCanvasContainer(),p),w=c.unproject(v);super(i,Object.assign({point:v,lngLat:w,originalEvent:p},y)),this._defaultPrevented=!1,this.target=c}}class ih extends s.z{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(i,c,p){const y=i==="touchend"?p.changedTouches:p.touches,v=Se(c.getCanvasContainer(),y),w=v.map((I=>c.unproject(I))),S=v.reduce(((I,O,D,N)=>I.add(O.div(N.length))),new s.P(0,0));super(i,{points:v,point:S,lngLats:w,lngLat:c.unproject(S),originalEvent:p}),this._defaultPrevented=!1}}class Cm extends s.z{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(i,c){super("wheel",{originalEvent:c}),this._defaultPrevented=!1}}class ty{constructor(i,c){this._map=i,this._clickTolerance=c.clickTolerance}reset(){this._mousedownPos=void 0}wheel(i){return this._firePreventable(new Cm(this._map,i))}mousedown(i,c){return this._mousedownPos=c,this._firePreventable(new Co(i.type,this._map,i))}mouseup(i){this._map.fire(new Co(i.type,this._map,i))}preclick(i){const c=new MouseEvent("preclick",i);this._map.fire(new Co(c.type,this._map,c))}click(i,c){this._mousedownPos&&this._mousedownPos.dist(c)>=this._clickTolerance||(this.preclick(i),this._map.fire(new Co(i.type,this._map,i)))}dblclick(i){return this._firePreventable(new Co(i.type,this._map,i))}mouseover(i){this._map.fire(new Co(i.type,this._map,i))}mouseout(i){this._map.fire(new Co(i.type,this._map,i))}touchstart(i){return this._firePreventable(new ih(i.type,this._map,i))}touchmove(i){this._map.fire(new ih(i.type,this._map,i))}touchend(i){this._map.fire(new ih(i.type,this._map,i))}touchcancel(i){this._map.fire(new ih(i.type,this._map,i))}_firePreventable(i){if(this._map.fire(i),i.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class ny{constructor(i){this._map=i}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(i){this._map.fire(new Co(i.type,this._map,i))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Co("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(i){this._delayContextMenu?this._contextMenuEvent=i:this._map.fire(new Co(i.type,this._map,i)),this._map.listens("contextmenu")&&i.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Mo{constructor(i,c){this._map=i,this._el=i.getCanvasContainer(),this._container=i.getContainer(),this._clickTolerance=c.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(i,c){this.isEnabled()&&i.shiftKey&&i.button===0&&(Ne(),this._startPos=this._lastPos=c,this._active=!0)}mousemoveWindow(i,c){if(!this._active)return;const p=c,y=this._startPos,v=this._lastPos;if(!y||!v||v.equals(p)||!this._box&&p.dist(y)<this._clickTolerance)return;this._lastPos=p,this._box||(this._box=de("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",i));const w=Math.min(y.x,p.x),S=Math.max(y.x,p.x),I=Math.min(y.y,p.y),O=Math.max(y.y,p.y);this._map._requestDomTask((()=>{this._box&&(this._box.style.transform=`translate(${w}px,${I}px)`,this._box.style.width=S-w+"px",this._box.style.height=O-I+"px")}))}mouseupWindow(i,c){if(!this._active)return;const p=this._startPos,y=c;if(p&&i.button===0){if(this.reset(),Pe(),p.x!==y.x||p.y!==y.y)return this._map.fire(new s.z("boxzoomend",{originalEvent:i})),{cameraAnimation:v=>v.fitScreenCoordinates(p,y,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",i)}}keydown(i){this._active&&i.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",i))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),Mt(),delete this._startPos,delete this._lastPos}_fireEvent(i,c){return this._map.fire(new s.z(i,{originalEvent:c}))}}function Of(m,i){const c={};for(let p=0;p<m.length;p++)c[m[p].identifier]=i[p];return c}class ry{constructor(i){this.reset(),this.numTouches=i.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(i,c,p){(this.centroid||p.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===0&&(this.startTime=i.timeStamp),p.length===this.numTouches&&(this.centroid=(function(y){const v=new s.P(0,0);for(const w of y)v._add(w);return v.div(y.length)})(c),this.touches=Of(p,c)))}touchmove(i,c,p){if(this.aborted||!this.centroid)return;const y=Of(p,c);for(const v in this.touches){const w=y[v];(!w||w.dist(this.touches[v])>30)&&(this.aborted=!0)}}touchend(i,c,p){if((!this.centroid||i.timeStamp-this.startTime>500)&&(this.aborted=!0),p.length===0){const y=!this.aborted&&this.centroid;if(this.reset(),y)return y}}}class Mf{constructor(i){this.singleTap=new ry(i),this.numTaps=i.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(i,c,p){this.singleTap.touchstart(i,c,p)}touchmove(i,c,p){this.singleTap.touchmove(i,c,p)}touchend(i,c,p){const y=this.singleTap.touchend(i,c,p);if(y){const v=i.timeStamp-this.lastTime<500,w=!this.lastTap||this.lastTap.dist(y)<30;if(v&&w||this.reset(),this.count++,this.lastTime=i.timeStamp,this.lastTap=y,this.count===this.numTaps)return this.reset(),y}}}class Yu{constructor(){this._zoomIn=new Mf({numTouches:1,numTaps:2}),this._zoomOut=new Mf({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(i,c,p){this._zoomIn.touchstart(i,c,p),this._zoomOut.touchstart(i,c,p)}touchmove(i,c,p){this._zoomIn.touchmove(i,c,p),this._zoomOut.touchmove(i,c,p)}touchend(i,c,p){const y=this._zoomIn.touchend(i,c,p),v=this._zoomOut.touchend(i,c,p);return y?(this._active=!0,i.preventDefault(),setTimeout((()=>this.reset()),0),{cameraAnimation:w=>w.easeTo({duration:300,zoom:w.getZoom()+1,around:w.unproject(y)},{originalEvent:i})}):v?(this._active=!0,i.preventDefault(),setTimeout((()=>this.reset()),0),{cameraAnimation:w=>w.easeTo({duration:300,zoom:w.getZoom()-1,around:w.unproject(v)},{originalEvent:i})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const iy={0:1,2:2},Im={Control:"ctrlKey",Alt:"altKey",Shift:"shiftKey",Meta:"metaKey"};class Df{constructor(i){this.reset(),this._clickTolerance=i.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(i,c){return!1}_move(i,c){return{}}mousedown(i,c){if(this._lastPoint)return;const p=je(i);this._correctButton(i,p)&&(this._lastPoint=c,this._eventButton=p)}mousemoveWindow(i,c){const p=this._lastPoint;if(p){if(i.preventDefault(),this._eventButton!=null&&(function(y,v){const w=iy[v];return y.buttons===void 0||(y.buttons&w)!==w})(i,this._eventButton))this.reset();else if(this._moved||!(c.dist(p)<this._clickTolerance))return this._moved=!0,this._lastPoint=c,this._move(p,c)}}mouseupWindow(i){this._lastPoint&&je(i)===this._eventButton&&(this._moved&&Pe(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class oh extends Df{mousedown(i,c){super.mousedown(i,c),this._lastPoint&&(this._active=!0)}_correctButton(i,c){return c===0&&!i.ctrlKey}_move(i,c){return{around:c,panDelta:c.sub(i)}}}class Am extends Df{constructor(i){super(i),this._pitchRotateKey=i.pitchRotateKey?Im[i.pitchRotateKey]:void 0}_correctButton(i,c){return this._pitchRotateKey?c===0&&i[this._pitchRotateKey]:c===0&&i.ctrlKey||c===2}_move(i,c){const p=.8*(c.x-i.x);if(p)return this._active=!0,{bearingDelta:p}}contextmenu(i){this._pitchRotateKey||i.preventDefault()}}class Pm extends Df{constructor(i){super(i),this._pitchRotateKey=i.pitchRotateKey?Im[i.pitchRotateKey]:void 0}_correctButton(i,c){return this._pitchRotateKey?c===0&&i[this._pitchRotateKey]:c===0&&i.ctrlKey||c===2}_move(i,c){const p=-.5*(c.y-i.y);if(p)return this._active=!0,{pitchDelta:p}}contextmenu(i){this._pitchRotateKey||i.preventDefault()}}class oy{constructor(i,c){this._map=i,this._el=i.getCanvasContainer(),this._minTouches=1,this._clickTolerance=c.clickTolerance||1,this.reset(),s.aY(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new s.P(0,0)}touchstart(i,c,p){return this._calculateTransform(i,c,p)}touchmove(i,c,p){if(this._active&&!(p.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(p.length===1&&!s.eL())return void this._showTouchPanBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return i.cancelable&&i.preventDefault(),this._calculateTransform(i,c,p)}}touchend(i,c,p){this._calculateTransform(i,c,p),this._active&&p.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(i,c,p){p.length>0&&(this._active=!0);const y=Of(p,c),v=new s.P(0,0),w=new s.P(0,0);let S=0;for(const O in y){const D=y[O],N=this._touches[O];N&&(v._add(D),w._add(D.sub(N)),S++,y[O]=D)}if(this._touches=y,S<this._minTouches||!w.mag())return;const I=w.div(S);return this._sum._add(I),this._sum.mag()<this._clickTolerance?void 0:{around:v.div(S),panDelta:I}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=de("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=window.setTimeout((()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.removeAttribute("role")}),500)}}class sh{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(i){}_move(i,c,p){return{}}touchstart(i,c,p){this._firstTwoTouches||p.length<2||(this._firstTwoTouches=[p[0].identifier,p[1].identifier],this._start([c[0],c[1]]))}touchmove(i,c,p){const y=this._firstTwoTouches;if(!y)return;i.preventDefault();const[v,w]=y,S=ah(p,c,v),I=ah(p,c,w);if(!S||!I)return;const O=this._aroundCenter?null:S.add(I).div(2);return this._move([S,I],O,i)}touchend(i,c,p){if(!this._firstTwoTouches)return;const[y,v]=this._firstTwoTouches,w=ah(p,c,y),S=ah(p,c,v);w&&S||(this._active&&Pe(),this.reset())}touchcancel(){this.reset()}enable(i){this._enabled=!0,this._aroundCenter=!!i&&i.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function ah(m,i,c){for(let p=0;p<m.length;p++)if(m[p].identifier===c)return i[p]}function Rm(m,i){return Math.log2(m/i)}class Xb extends sh{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(i){this._startDistance=this._distance=i[0].dist(i[1])}_move(i,c){const p=this._distance;if(this._distance=i[0].dist(i[1]),this._active||!(Math.abs(Rm(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Rm(this._distance,p),pinchAround:c}}}function sy(m,i){return 180*m.angleWith(i)/Math.PI}class Yb extends sh{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(i){this._startVector=this._vector=i[0].sub(i[1]),this._minDiameter=i[0].dist(i[1])}_move(i,c){const p=this._vector;if(this._vector=i[0].sub(i[1]),p&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:sy(this._vector,p),pinchAround:c}}_isBelowThreshold(i){this._minDiameter=Math.min(this._minDiameter,i.mag());const c=25/(Math.PI*this._minDiameter)*360,p=this._startVector;if(!p)return!1;const y=sy(i,p);return Math.abs(y)<c}}function km(m){return Math.abs(m.y)>Math.abs(m.x)}class Jb extends sh{constructor(i){super(),this._map=i}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(i){this._lastPoints=i,km(i[0].sub(i[1]))&&(this._valid=!1)}_move(i,c,p){const y=this._lastPoints;if(!y)return;const v=i[0].sub(y[0]),w=i[1].sub(y[1]);return this._map._cooperativeGestures&&!s.eL()&&p.touches.length<3||(this._valid=this.gestureBeginsVertically(v,w,p.timeStamp),!this._valid)?void 0:(this._lastPoints=i,this._active=!0,{pitchDelta:(v.y+w.y)/2*-.5})}gestureBeginsVertically(i,c,p){if(this._valid!==void 0)return this._valid;const y=i.mag()>=2,v=c.mag()>=2;if(!y&&!v)return;if(!y||!v)return this._firstMove==null&&(this._firstMove=p),p-this._firstMove<100&&void 0;const w=i.y>0==c.y>0;return km(i)&&km(c)&&w}}const Qb={panStep:100,bearingStep:15,pitchStep:10};class e1{constructor(){const i=Qb;this._panStep=i.panStep,this._bearingStep=i.bearingStep,this._pitchStep=i.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(i){if(i.altKey||i.ctrlKey||i.metaKey)return;let c=0,p=0,y=0,v=0,w=0;switch(i.keyCode){case 61:case 107:case 171:case 187:c=1;break;case 189:case 109:case 173:c=-1;break;case 37:i.shiftKey?p=-1:(i.preventDefault(),v=-1);break;case 39:i.shiftKey?p=1:(i.preventDefault(),v=1);break;case 38:i.shiftKey?y=1:(i.preventDefault(),w=-1);break;case 40:i.shiftKey?y=-1:(i.preventDefault(),w=1);break;default:return}return this._rotationDisabled&&(p=0,y=0),{cameraAnimation:S=>{const I=S.getZoom();S.easeTo({duration:300,easeId:"keyboardHandler",easing:t1,zoom:c?Math.round(I)+c*(i.shiftKey?2:1):I,bearing:S.getBearing()+p*this._bearingStep,pitch:S.getPitch()+y*this._pitchStep,offset:[-v*this._panStep,-w*this._panStep],center:S.getCenter()},{originalEvent:i})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function t1(m){return m*(2-m)}const ay=4.000244140625,n1=1/450;class r1{constructor(i,c){this._map=i,this._el=i.getCanvasContainer(),this._handler=c,this._delta=0,this._lastDelta=0,this._defaultZoomRate=.01,this._wheelZoomRate=n1,s.aY(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(i){this._defaultZoomRate=i}setWheelZoomRate(i){this._wheelZoomRate=i}isEnabled(){return!!this._enabled}isActive(){return this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(i){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!i&&i.around==="center",this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(i){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(i.ctrlKey||i.metaKey||this.isZooming()||s.eL()))return void this._showBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let c=i.deltaMode===WheelEvent.DOM_DELTA_LINE?40*i.deltaY:i.deltaY;const p=s.o.now(),y=p-(this._lastWheelEventTime||0);this._lastWheelEventTime=p,c!==0&&c%ay==0?this._type="wheel":c!==0&&Math.abs(c)<4?this._type="trackpad":y>400?(this._type=null,this._lastValue=c,this._timeout=window.setTimeout(this._onTimeout,40,i)):this._type||(this._type=Math.abs(y*c)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,c+=this._lastValue)),i.shiftKey&&c&&(c/=4),this._type&&(this._lastWheelEvent=i,this._delta-=c,this._active||this._start(i)),i.preventDefault()}_onTimeout(i){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(i)}_start(i){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const c=we(this._el,i);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:c,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const i=this._map.transform;this._type==="wheel"&&i.projection.wrap&&(i._center.lng>=180||i._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);const c=()=>i._terrainEnabled()&&this._aroundCoord?i.computeZoomRelativeTo(this._aroundCoord):i.zoom;if(this._delta!==0){const O=this._type==="wheel"&&Math.abs(this._delta)>ay?this._wheelZoomRate:this._defaultZoomRate;let D=2/(1+Math.exp(-Math.abs(this._delta*O)));this._delta<0&&D!==0&&(D=1/D);const N=c(),z=Math.pow(2,N),U=typeof this._targetZoom=="number"?i.zoomScale(this._targetZoom):z;this._targetZoom=Math.min(i.maxZoom,Math.max(i.minZoom,i.scaleZoom(U*D))),this._type==="wheel"&&(this._startZoom=N,this._easing=this._smoothOutEasing(200)),this._lastDelta=this._delta,this._delta=0}const p=typeof this._targetZoom=="number"?this._targetZoom:c(),y=this._startZoom,v=this._easing;let w,S=!1;if(this._type==="wheel"&&y&&v){const O=Math.min((s.o.now()-this._lastWheelEventTime)/200,1),D=v(O);w=s.ak(y,p,D),O<1?this._frameId||(this._frameId=!0):S=!0}else w=p,S=!0;this._active=!0,S&&(this._active=!1,this._finishTimeout=window.setTimeout((()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout}),200));let I=w-c();return I*this._lastDelta<0&&(I=0),{noInertia:!0,needsRenderFrame:!S,zoomDelta:I,around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(i){let c=s.eM;if(this._prevEase){const p=this._prevEase,y=(s.o.now()-p.start)/p.duration,v=p.easing(y+.01)-p.easing(y),w=.27/Math.sqrt(v*v+1e-4)*.01,S=Math.sqrt(.0729-w*w);c=s.eK(w,S,.25,1)}return this._prevEase={start:s.o.now(),duration:i,easing:c},c}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=de("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=window.setTimeout((()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.removeAttribute("role")}),200)}}class i1{constructor(i,c){this._clickZoom=i,this._tapZoom=c}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class o1{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(i,c){return i.preventDefault(),{cameraAnimation:p=>{p.easeTo({duration:300,zoom:p.getZoom()+(i.shiftKey?-1:1),around:p.unproject(c)},{originalEvent:i})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class TS{constructor(){this._tap=new Mf({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(i,c,p){this._swipePoint||(this._tapTime&&i.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?p.length>0&&(this._swipePoint=c[0],this._swipeTouch=p[0].identifier):this._tap.touchstart(i,c,p))}touchmove(i,c,p){if(this._tapTime){if(this._swipePoint){if(p[0].identifier!==this._swipeTouch)return;const y=c[0],v=y.y-this._swipePoint.y;return this._swipePoint=y,i.preventDefault(),this._active=!0,{zoomDelta:v/128}}}else this._tap.touchmove(i,c,p)}touchend(i,c,p){this._tapTime?this._swipePoint&&p.length===0&&this.reset():this._tap.touchend(i,c,p)&&(this._tapTime=i.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class SS{constructor(i,c,p){this._el=i,this._mousePan=c,this._touchPan=p}enable(i){this._inertiaOptions=i||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class ES{constructor(i,c,p){this._pitchWithRotate=i.pitchWithRotate,this._mouseRotate=c,this._mousePitch=p}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class Bi{constructor(i,c,p,y){this._el=i,this._touchZoom=c,this._touchRotate=p,this._tapDragZoom=y,this._rotationDisabled=!1,this._enabled=!0}enable(i){this._touchZoom.enable(i),this._rotationDisabled||this._touchRotate.enable(i),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const Lf=m=>m.zoom||m.drag||m.pitch||m.rotate;class CS extends s.z{}class IS{constructor(){this.constants=[1,1,.01],this.radius=0}setup(i,c){const p=s.av([],c,i);this.radius=s.ag(p[2]<0?s.eO([],p,this.constants):[p[0],p[1],0])}projectRay(i){s.eO(i,i,this.constants),s.aw(i,i),s.eP(i,i,this.constants);const c=s.c4([],i,this.radius);if(c[2]>0){const p=s.c4([],[0,0,1],s.bJ(c,[0,0,1])),y=s.c4([],s.aw([],[c[0],c[1],0]),this.radius),v=s.d7([],c,s.c4([],s.av([],s.d7([],y,p),c),2));c[0]=v[0],c[1]=v[1]}return c}}function Om(m){return m.panDelta&&m.panDelta.mag()||m.zoomDelta||m.bearingDelta||m.pitchDelta}class zf{constructor(i,c){this._map=i,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new ey(i),this._bearingSnap=c.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new IS,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(c),s.aY(["handleEvent","handleWindowEvent"],this);const p=this._el;this._listeners=[[p,"touchstart",{passive:!0}],[p,"touchmove",{passive:!1}],[p,"touchend",void 0],[p,"touchcancel",void 0],[p,"mousedown",void 0],[p,"mousemove",void 0],[p,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[p,"mouseover",void 0],[p,"mouseout",void 0],[p,"dblclick",void 0],[p,"click",void 0],[p,"keydown",{capture:!1}],[p,"keyup",void 0],[p,"wheel",{passive:!1}],[p,"contextmenu",void 0],[window,"blur",void 0]];for(const[y,v,w]of this._listeners){const S=y===document?this.handleWindowEvent:this.handleEvent;y.addEventListener(v,S,w)}}destroy(){for(const[i,c,p]of this._listeners){const y=i===document?this.handleWindowEvent:this.handleEvent;i.removeEventListener(c,y,p)}}_addDefaultHandlers(i){const c=this._map,p=c.getCanvasContainer();this._add("mapEvent",new ty(c,i));const y=c.boxZoom=new Mo(c,i);this._add("boxZoom",y);const v=new Yu,w=new o1;c.doubleClickZoom=new i1(w,v),this._add("tapZoom",v),this._add("clickZoom",w);const S=new TS;this._add("tapDragZoom",S);const I=c.touchPitch=new Jb(c);this._add("touchPitch",I);const O=new Am(i),D=new Pm(i);c.dragRotate=new ES(i,O,D),this._add("mouseRotate",O,["mousePitch"]),this._add("mousePitch",D,["mouseRotate"]);const N=new oh(i),z=new oy(c,i);c.dragPan=new SS(p,N,z),this._add("mousePan",N),this._add("touchPan",z,["touchZoom","touchRotate"]);const U=new Yb,G=new Xb;c.touchZoomRotate=new Bi(p,G,U,S),this._add("touchRotate",U,["touchPan","touchZoom"]),this._add("touchZoom",G,["touchPan","touchRotate"]),this._add("blockableMapEvent",new ny(c));const H=c.scrollZoom=new r1(c,this);this._add("scrollZoom",H,["mousePan"]);const J=c.keyboard=new e1;this._add("keyboard",J);for(const Z of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])i.interactive&&i[Z]&&c[Z].enable(i[Z])}_add(i,c,p){this._handlers.push({handlerName:i,handler:c,allowed:p}),this._handlersById[i]=c}stop(i){if(!this._updatingCamera){for(const{handler:c}of this._handlers)c.reset();this._inertia.clear(),this._fireEvents({},{},i),this._changes=[],this._originalZoom=void 0}}isActive(){for(const{handler:i}of this._handlers)if(i.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Lf(this._eventsInProgress)||this.isZooming()}_isDragging(){return!!this._eventsInProgress.drag}_blockedByActive(i,c,p){for(const y in i)if(y!==p&&(!c||c.indexOf(y)<0))return!0;return!1}handleWindowEvent(i){this.handleEvent(i,`${i.type}Window`)}_getMapTouches(i){const c=[];for(const p of i)this._el.contains(p.target)&&c.push(p);return c}handleEvent(i,c){this._updatingCamera=!0;const p=i.type==="renderFrame",y=p?void 0:i,v={needsRenderFrame:!1},w={},S={},I=i.touches?this._getMapTouches(i.touches):void 0,O=I?Se(this._el,I):p?void 0:we(this._el,i);for(const{handlerName:z,handler:U,allowed:G}of this._handlers){if(!U.isEnabled())continue;let H;this._blockedByActive(S,G,z)?U.reset():U[c||i.type]&&(H=U[c||i.type](i,O,I),this.mergeHandlerResult(v,w,H,z,y),H&&H.needsRenderFrame&&this._triggerRenderFrame()),(H||U.isActive())&&(S[z]=U)}const D={};for(const z in this._previousActiveHandlers)S[z]||(D[z]=y);this._previousActiveHandlers=S,(Object.keys(D).length||Om(v))&&(this._changes.push([v,w,D]),this._triggerRenderFrame()),(Object.keys(S).length||Om(v))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:N}=v;N&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],N(this._map))}mergeHandlerResult(i,c,p,y,v){if(!p)return;Object.assign(i,p);const w={handlerName:y,originalEvent:p.originalEvent||v};p.zoomDelta!==void 0&&(c.zoom=w),p.panDelta!==void 0&&(c.drag=w),p.pitchDelta!==void 0&&(c.pitch=w),p.bearingDelta!==void 0&&(c.rotate=w)}_applyChanges(){const i={},c={},p={};for(const[y,v,w]of this._changes)y.panDelta&&(i.panDelta=(i.panDelta||new s.P(0,0))._add(y.panDelta)),y.zoomDelta&&(i.zoomDelta=(i.zoomDelta||0)+y.zoomDelta),y.bearingDelta&&(i.bearingDelta=(i.bearingDelta||0)+y.bearingDelta),y.pitchDelta&&(i.pitchDelta=(i.pitchDelta||0)+y.pitchDelta),y.around!==void 0&&(i.around=y.around),y.aroundCoord!==void 0&&(i.aroundCoord=y.aroundCoord),y.pinchAround!==void 0&&(i.pinchAround=y.pinchAround),y.noInertia&&(i.noInertia=y.noInertia),Object.assign(c,v),Object.assign(p,w);this._updateMapTransform(i,c,p),this._changes=[]}_updateMapTransform(i,c,p){const y=this._map,v=y.transform,w=ee=>[ee.x,ee.y,ee.z];if((ee=>{const ie=this._eventsInProgress.drag;return ie&&!this._handlersById[ie.handlerName].isActive()})()&&!Om(i)){const ee=v.zoom;v.cameraElevationReference="sea",this._originalZoom!=null&&v._orthographicProjectionAtLowPitch&&v.projection.name!=="globe"&&v.pitch===0?(v.cameraElevationReference="ground",v.zoom=this._originalZoom):(v.recenterOnTerrain(),v.cameraElevationReference="ground"),ee!==v.zoom&&this._map._update(!0)}if(v._isCameraConstrained&&y._stop(!0),!Om(i))return void this._fireEvents(c,p,!0);let{panDelta:S,zoomDelta:I,bearingDelta:O,pitchDelta:D,around:N,aroundCoord:z,pinchAround:U}=i;v._isCameraConstrained&&(I>0&&(I=0),v._isCameraConstrained=!1),U!==void 0&&(N=U),(I||(ee=>c[ee]&&!this._eventsInProgress[ee])("drag"))&&N&&(this._dragOrigin=w(v.pointCoordinate3D(N)),this._originalZoom=v.zoom,this._trackingEllipsoid.setup(v._camera.position,this._dragOrigin)),v.cameraElevationReference="sea",y._stop(!0),N=N||y.transform.centerPoint,O&&(v.bearing+=O),D&&(v.pitch+=D),v._updateCameraState();const G=[0,0,0];if(S)if(v.projection.name==="mercator"){const ee=this._trackingEllipsoid.projectRay(v.screenPointToMercatorRay(N).dir),ie=this._trackingEllipsoid.projectRay(v.screenPointToMercatorRay(N.sub(S)).dir);G[0]=ie[0]-ee[0],G[1]=ie[1]-ee[1]}else{const ee=v.pointCoordinate(N);if(v.projection.name==="globe"){S=S.rotate(-v.angle);const ie=v._pixelsPerMercatorPixel/v.worldSize;G[0]=-S.x*s.eN(s.a$(ee.y))*ie,G[1]=-S.y*s.eN(v.center.lat)*ie}else{const ie=v.pointCoordinate(N.sub(S));ee&&ie&&(G[0]=ie.x-ee.x,G[1]=ie.y-ee.y)}}const H=v.zoom,J=[0,0,0];if(I){const ee=w(z||v.pointCoordinate3D(N)),ie={dir:s.aw([],s.av([],ee,v._camera.position))};if(ie.dir[2]<0){const se=v.zoomDeltaToMovement(ee,I);s.c4(J,ie.dir,se)}}const Z=s.d7(G,G,J);v._translateCameraConstrained(Z),I&&Math.abs(v.zoom-H)>1e-4&&v.recenterOnTerrain(),v.cameraElevationReference="ground",this._map._update(),i.noInertia||this._inertia.record(i),this._fireEvents(c,p,!0)}_fireEvents(i,c,p){const y=Lf(this._eventsInProgress),v=Lf(i),w={};for(const D in i){const{originalEvent:N}=i[D];this._eventsInProgress[D]||(w[`${D}start`]=N),this._eventsInProgress[D]=i[D]}!y&&v&&this._fireEvent("movestart",v.originalEvent);for(const D in w)this._fireEvent(D,w[D]);v&&this._fireEvent("move",v.originalEvent);for(const D in i){const{originalEvent:N}=i[D];this._fireEvent(D,N)}const S={};let I;for(const D in this._eventsInProgress){const{handlerName:N,originalEvent:z}=this._eventsInProgress[D];this._handlersById[N].isActive()||(delete this._eventsInProgress[D],I=c[N]||z,S[`${D}end`]=I)}for(const D in S)this._fireEvent(D,S[D]);const O=Lf(this._eventsInProgress);if(p&&(y||v)&&!O){this._updatingCamera=!0;const D=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),N=z=>z!==0&&-this._bearingSnap<z&&z<this._bearingSnap;D?(N(D.bearing||this._map.getBearing())&&(D.bearing=0),this._map.easeTo(D,{originalEvent:I})):(this._map.fire(new s.z("moveend",{originalEvent:I})),N(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(i,c){this._map.fire(new s.z(i,c?{originalEvent:c}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add((i=>{this._frameId=void 0,this.handleEvent(new CS("renderFrame",{timeStamp:i})),this._applyChanges()}))}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}const ly="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class cy extends s.E{constructor(i,c){super(),this._moving=!1,this._zooming=!1,this.transform=i,this._bearingSnap=c.bearingSnap,this._respectPrefersReducedMotion=c.respectPrefersReducedMotion!==!1,s.aY(["_renderFrameCallback"],this)}getCenter(){return new s.aR(this.transform.center.lng,this.transform.center.lat)}setCenter(i,c){return this.jumpTo({center:i},c)}panBy(i,c,p){return i=s.P.convert(i).mult(-1),this.panTo(this.transform.center,Object.assign({offset:i},c),p)}panTo(i,c,p){return this.easeTo(Object.assign({center:i},c),p)}getZoom(){return this.transform.zoom}setZoom(i,c){return this.jumpTo({zoom:i},c),this}zoomTo(i,c,p){return this.easeTo(Object.assign({zoom:i},c),p)}zoomIn(i,c){return this.zoomTo(this.getZoom()+1,i,c),this}zoomOut(i,c){return this.zoomTo(this.getZoom()-1,i,c),this}getBearing(){return this.transform.bearing}setBearing(i,c){return this.jumpTo({bearing:i},c),this}getPadding(){return this.transform.padding}setPadding(i,c){return this.jumpTo({padding:i},c),this}rotateTo(i,c,p){return this.easeTo(Object.assign({bearing:i},c),p)}resetNorth(i,c){return this.rotateTo(0,Object.assign({duration:1e3},i),c),this}resetNorthPitch(i,c){return this.easeTo(Object.assign({bearing:0,pitch:0,duration:1e3},i),c),this}snapToNorth(i,c){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(i,c):this}getPitch(){return this.transform.pitch}setPitch(i,c){return this.jumpTo({pitch:i},c),this}cameraForBounds(i,c){i=s.aI.convert(i);const p=c&&c.bearing||0,y=c&&c.pitch||0,v=i.getNorthWest(),w=i.getSouthEast();return this._cameraForBounds(this.transform,v,w,p,y,c)}_extendPadding(i){const c={top:0,right:0,bottom:0,left:0};return i==null?Object.assign({},c,this.transform.padding):typeof i=="number"?{top:i,bottom:i,right:i,left:i}:Object.assign({},c,i)}_extendCameraOptions(i){return(i=Object.assign({offset:[0,0],maxZoom:this.transform.maxZoom},i)).padding=this._extendPadding(i.padding),i}_minimumAABBFrustumDistance(i,c){const p=c.max[0]-c.min[0],y=c.max[1]-c.min[1];return p/y>i.aspect?p/(2*Math.tan(.5*i.fovX)*i.aspect):y/(2*Math.tan(.5*i.fovY)*i.aspect)}_cameraForBoundsOnGlobe(i,c,p,y,v,w){const S=i.clone(),I=this._extendCameraOptions(w);S.bearing=y,S.pitch=v;const O=s.aR.convert(c),D=s.aR.convert(p),N=.5*(O.lat+D.lat),z=.5*(O.lng+D.lng),U=s.eQ(N,z),G=s.aw([],U),H=s.aw([],s.bI([],G,[0,1,0])),J=s.bI([],H,G),Z=[H[0],H[1],H[2],0,J[0],J[1],J[2],0,G[0],G[1],G[2],0,0,0,0,1],ee=[U,s.eQ(O.lat,O.lng),s.eQ(D.lat,O.lng),s.eQ(D.lat,D.lng),s.eQ(O.lat,D.lng),s.eQ(N,O.lng),s.eQ(N,D.lng),s.eQ(O.lat,z),s.eQ(D.lat,z)];let ie=s.d8.fromPoints(ee.map((Je=>[s.bJ(H,Je),s.bJ(J,Je),s.bJ(G,Je)])));const se=s.af([],ie.center,Z);s.eR(se)===0&&s.eS(se,0,0,1),s.aw(se,se),s.c4(se,se,s.aD),S.center=s.eT(se);const me=S.getWorldToCameraMatrix(),fe=s.bl(new Float64Array(16),me);ie=s.d8.applyTransform(ie,s.aB([],me,Z));const ge=this._extendAABB(ie,S,I,y);if(!ge)return void s.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");ie=ge,s.af(se,se,me);const pe=.5*(ie.max[2]-ie.min[2]),he=this._minimumAABBFrustumDistance(S,ie),_e=s.c4([],[0,0,1],pe),Ke=s.d7(_e,se,_e),Le=he+(S.pitch===0?0:s.bG(se,Ke)),st=S.globeCenterInViewSpace,We=s.av([],se,[st[0],st[1],st[2]]);s.aw(We,We),s.c4(We,We,Le);const it=s.d7([],se,We);s.af(it,it,fe);const Pt=s.eD/s.aD,qe=s.ag(it),Ae=s.ce(Math.max(qe*Pt-s.eD,Number.EPSILON),0),at=Math.min(S.zoomFromMercatorZAdjusted(Ae),I.maxZoom);return at>.5*(s.cZ+s.cK)?(S.setProjection({name:"mercator"}),S.zoom=at,this._cameraForBounds(S,c,p,y,v,w)):{center:S.center,zoom:at,bearing:y,pitch:v}}_extendAABB(i,c,p,y){const v=.5*((p.padding.left||0)+(p.padding.right||0)),w=.5*((p.padding.top||0)+(p.padding.bottom||0)),S=w,I=v,O=v,D=w,N=c.width-(I+O),z=c.height-(S+D),U=s.av([],i.max,i.min),G=Math.min(N/U[0],z/U[1]),H=Math.min(c.scaleZoom(c.scale*G),p.maxZoom);if(isNaN(H))return null;const J=c.scale/c.zoomScale(H),Z=new s.d8([i.min[0]-I*J,i.min[1]-D*J,i.min[2]],[i.max[0]+O*J,i.max[1]+S*J,i.max[2]]),ee=(typeof p.offset.x=="number"&&typeof p.offset.y=="number"?new s.P(p.offset.x,p.offset.y):s.P.convert(p.offset)).rotate(-s.an(y));return Z.center[0]-=ee.x*J,Z.center[1]+=ee.y*J,Z}queryTerrainElevation(i,c){const p=this.transform.elevation;return p?(c=Object.assign({},{exaggerated:!0},c),p.getAtPoint(s.ae.fromLngLat(i),null,c.exaggerated)):null}_cameraForBounds(i,c,p,y,v,w){if(i.projection.name==="globe")return this._cameraForBoundsOnGlobe(i,c,p,y,v,w);const S=i.clone(),I=this._extendCameraOptions(w);S.bearing=y,S.pitch=v;const O=s.aR.convert(c),D=s.aR.convert(p),N=new s.aR(O.lng,D.lat),z=new s.aR(D.lng,O.lat),U=S.project(O),G=S.project(D),H=this.queryTerrainElevation(O),J=this.queryTerrainElevation(D),Z=this.queryTerrainElevation(N),ee=this.queryTerrainElevation(z),ie=[[U.x,U.y,Math.min(H||0,J||0,Z||0,ee||0)],[G.x,G.y,Math.max(H||0,J||0,Z||0,ee||0)]];let se=s.d8.fromPoints(ie);const me=S.getWorldToCameraMatrix(),fe=s.bl(new Float64Array(16),me);se=s.d8.applyTransform(se,me);const ge=this._extendAABB(se,S,I,y);if(!ge)return void s.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");se=ge;const pe=.5*s.av([],se.max,se.min)[2],he=this._minimumAABBFrustumDistance(S,se),_e=[0,0,1,0];s.aC(_e,_e,me),s.eU(_e,_e);const Ke=s.c4([],_e,he+pe),Le=s.d7([],se.center,Ke);s.af(se.center,se.center,fe),s.af(Le,Le,fe);const st=S.unproject(new s.P(se.center[0],se.center[1])),We=s.eV(S.projection,st),it=Math.pow(2,We),Pt=Math.min(S._zoomFromMercatorZ(Le[2]*S.pixelsPerMeter*it/S.worldSize),I.maxZoom);return S.mercatorFromTransition&&Pt<.5*(s.cZ+s.cK)?(S.setProjection({name:"globe"}),S.zoom=Pt,this._cameraForBounds(S,c,p,y,v,w)):{center:st,zoom:Pt,bearing:y,pitch:v}}fitBounds(i,c,p){const y=this.cameraForBounds(i,c);return this._fitInternal(y,c,p)}fitScreenCoordinates(i,c,p,y,v){const w=s.P.convert(i),S=s.P.convert(c),I=new s.P(Math.min(w.x,S.x),Math.min(w.y,S.y)),O=new s.P(Math.max(w.x,S.x),Math.max(w.y,S.y));if(this.transform.projection.name==="mercator"&&this.transform.anyCornerOffEdge(w,S))return this;const D=this.transform.pointLocation3D(I),N=this.transform.pointLocation3D(O),z=this.transform.pointLocation3D(new s.P(I.x,O.y)),U=this.transform.pointLocation3D(new s.P(O.x,I.y)),G=[Math.min(D.lng,N.lng,z.lng,U.lng),Math.min(D.lat,N.lat,z.lat,U.lat)],H=[Math.max(D.lng,N.lng,z.lng,U.lng),Math.max(D.lat,N.lat,z.lat,U.lat)],J=y&&y.pitch?y.pitch:this.getPitch(),Z=this._cameraForBounds(this.transform,G,H,p,J,y);return this._fitInternal(Z,y,v)}_fitInternal(i,c,p){return i?(c=Object.assign(i,c)).linear?this.easeTo(c,p):this.flyTo(c,p):this}jumpTo(i,c){this.stop();const p=i.preloadOnly?this.transform.clone():this.transform;let y=!1,v=!1,w=!1;"zoom"in i&&p.zoom!==+i.zoom&&(y=!0,p.zoom=+i.zoom),i.center!==void 0&&(p.center=s.aR.convert(i.center)),"bearing"in i&&p.bearing!==+i.bearing&&(v=!0,p.bearing=+i.bearing),"pitch"in i&&p.pitch!==+i.pitch&&(w=!0,p.pitch=+i.pitch);const S=typeof i.padding=="number"?this._extendPadding(i.padding):i.padding;if(i.padding!=null&&!p.isPaddingEqual(S))if(i.retainPadding===!1){const I=p.clone();I.padding=S,p.setLocationAtPoint(p.center,I.centerPoint)}else p.padding=S;return i.preloadOnly?(this._preloadTiles(p),this):(this.fire(new s.z("movestart",c)).fire(new s.z("move",c)),y&&this.fire(new s.z("zoomstart",c)).fire(new s.z("zoom",c)).fire(new s.z("zoomend",c)),v&&this.fire(new s.z("rotatestart",c)).fire(new s.z("rotate",c)).fire(new s.z("rotateend",c)),w&&this.fire(new s.z("pitchstart",c)).fire(new s.z("pitch",c)).fire(new s.z("pitchend",c)),this.fire(new s.z("moveend",c)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||s.w(ly),this.transform.getFreeCameraOptions()}setFreeCameraOptions(i,c){const p=this.transform;if(!p.projection.supportsFreeCamera)return s.w(ly),this;this.stop();const y=p.zoom,v=p.pitch,w=p.bearing;p.setFreeCameraOptions(i);const S=y!==p.zoom,I=v!==p.pitch,O=w!==p.bearing;return this.fire(new s.z("movestart",c)).fire(new s.z("move",c)),S&&this.fire(new s.z("zoomstart",c)).fire(new s.z("zoom",c)).fire(new s.z("zoomend",c)),O&&this.fire(new s.z("rotatestart",c)).fire(new s.z("rotate",c)).fire(new s.z("rotateend",c)),I&&this.fire(new s.z("pitchstart",c)).fire(new s.z("pitch",c)).fire(new s.z("pitchend",c)),this.fire(new s.z("moveend",c)),this}easeTo(i,c){this._stop(!1,i.easeId),((i=Object.assign({offset:[0,0],duration:500,easing:s.eM},i)).animate===!1||this._prefersReducedMotion(i))&&(i.duration=0);const p=this.transform,y=this.getZoom(),v=this.getBearing(),w=this.getPitch(),S=this.getPadding(),I="zoom"in i?+i.zoom:y,O="bearing"in i?this._normalizeBearing(i.bearing,v):v,D="pitch"in i?+i.pitch:w,N=this._extendPadding(i.padding),z=s.P.convert(i.offset);let U,G,H;if(p.projection.name==="globe"){const _e=s.ae.fromLngLat(p.center),Ke=z.rotate(-p.angle);_e.x+=Ke.x/p.worldSize,_e.y+=Ke.y/p.worldSize;const Le=_e.toLngLat(),st=s.aR.convert(i.center||Le);this._normalizeCenter(st),U=p.centerPoint.add(Ke),G=new s.P(_e.x,_e.y).mult(p.worldSize),H=new s.P(s.aF(st.lng),s.aJ(st.lat)).mult(p.worldSize).sub(G)}else{U=p.centerPoint.add(z);const _e=p.pointLocation(U),Ke=s.aR.convert(i.center||_e);this._normalizeCenter(Ke),G=p.project(_e),H=p.project(Ke).sub(G)}const J=p.zoomScale(I-y);let Z,ee;i.around&&(Z=s.aR.convert(i.around),ee=p.locationPoint(Z));const ie=this._zooming||I!==y,se=this._rotating||v!==O,me=this._pitching||D!==w,fe=!p.isPaddingEqual(N),ge=i.retainPadding===!1?p.clone():p,pe=_e=>Ke=>{if(ie&&(_e.zoom=s.ak(y,I,Ke)),se&&(_e.bearing=s.ak(v,O,Ke)),me&&(_e.pitch=s.ak(w,D,Ke)),fe&&(ge.interpolatePadding(S,N,Ke),U=ge.centerPoint.add(z)),Z)_e.setLocationAtPoint(Z,ee);else{const Le=_e.zoomScale(_e.zoom-y),st=I>y?Math.min(2,J):Math.max(.5,J),We=Math.pow(st,1-Ke),it=_e.unproject(G.add(H.mult(Ke*We)).mult(Le));_e.setLocationAtPoint(_e.renderWorldCopies?it.wrap():it,U)}return i.preloadOnly||this._fireMoveEvents(c),_e};if(i.preloadOnly){const _e=this._emulate(pe,i.duration,p);return this._preloadTiles(_e),this}const he={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=ie,this._rotating=se,this._pitching=me,this._padding=fe,this._easeId=i.easeId,this._prepareEase(c,i.noMoveStart,he),this._ease(pe(p),(_e=>{p.cameraElevationReference==="sea"&&p.recenterOnTerrain(),this._afterEase(c,_e)}),i),this}_prepareEase(i,c,p={}){this._moving=!0,this.transform.cameraElevationReference="sea",this.transform._orthographicProjectionAtLowPitch&&this.transform.pitch===0&&this.transform.projection.name!=="globe"&&(this.transform.cameraElevationReference="ground"),c||p.moving||this.fire(new s.z("movestart",i)),this._zooming&&!p.zooming&&this.fire(new s.z("zoomstart",i)),this._rotating&&!p.rotating&&this.fire(new s.z("rotatestart",i)),this._pitching&&!p.pitching&&this.fire(new s.z("pitchstart",i))}_fireMoveEvents(i){this.fire(new s.z("move",i)),this._zooming&&this.fire(new s.z("zoom",i)),this._rotating&&this.fire(new s.z("rotate",i)),this._pitching&&this.fire(new s.z("pitch",i))}_afterEase(i,c){if(this._easeId&&c&&this._easeId===c)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const p=this._zooming,y=this._rotating,v=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,p&&this.fire(new s.z("zoomend",i)),y&&this.fire(new s.z("rotateend",i)),v&&this.fire(new s.z("pitchend",i)),this.fire(new s.z("moveend",i))}flyTo(i,c){if(this._prefersReducedMotion(i)){const Je=s.aH(i,["center","zoom","bearing","pitch","around","padding","retainPadding"]);return this.jumpTo(Je,c)}this.stop(),i=Object.assign({offset:[0,0],speed:1.2,curve:1.42,easing:s.eM},i);const p=this.transform,y=this.getZoom(),v=this.getBearing(),w=this.getPitch(),S=this.getPadding(),I="zoom"in i?s.aA(+i.zoom,p.minZoom,p.maxZoom):y,O="bearing"in i?this._normalizeBearing(i.bearing,v):v,D="pitch"in i?+i.pitch:w,N=this._extendPadding(i.padding),z=p.zoomScale(I-y),U=s.P.convert(i.offset);let G=p.centerPoint.add(U);const H=p.pointLocation(G),J=s.aR.convert(i.center||H);this._normalizeCenter(J);const Z=p.project(H),ee=p.project(J).sub(Z);let ie=i.curve;const se=Math.max(p.width,p.height),me=se/z,fe=ee.mag();if("minZoom"in i){const Je=s.aA(Math.min(i.minZoom,y,I),p.minZoom,p.maxZoom),_t=se/p.zoomScale(Je-y);ie=Math.sqrt(_t/fe*2)}const ge=ie*ie;function pe(Je){const _t=(me*me-se*se+(Je?-1:1)*ge*ge*fe*fe)/(2*(Je?me:se)*ge*fe);return Math.log(Math.sqrt(_t*_t+1)-_t)}function he(Je){return(Math.exp(Je)-Math.exp(-Je))/2}function _e(Je){return(Math.exp(Je)+Math.exp(-Je))/2}const Ke=pe(0);let Le=function(Je){return _e(Ke)/_e(Ke+ie*Je)},st=function(Je){return se*((_e(Ke)*(he(_t=Ke+ie*Je)/_e(_t))-he(Ke))/ge)/fe;var _t},We=(pe(1)-Ke)/ie;if(Math.abs(fe)<1e-6||!isFinite(We)){if(Math.abs(se-me)<1e-6)return this.easeTo(i,c);const Je=me<se?-1:1;We=Math.abs(Math.log(me/se))/ie,st=function(){return 0},Le=function(_t){return Math.exp(Je*ie*_t)}}i.duration="duration"in i?+i.duration:1e3*We/("screenSpeed"in i?+i.screenSpeed/ie:+i.speed),i.maxDuration&&i.duration>i.maxDuration&&(i.duration=0);const it=v!==O,Pt=D!==w,qe=!p.isPaddingEqual(N),Ae=i.retainPadding===!1?p.clone():p,at=Je=>_t=>{const At=_t*We,Ut=1/Le(At);Je.zoom=_t===1?I:y+Je.scaleZoom(Ut),it&&(Je.bearing=s.ak(v,O,_t)),Pt&&(Je.pitch=s.ak(w,D,_t)),qe&&(Ae.interpolatePadding(S,N,_t),G=Ae.centerPoint.add(U));const St=_t===1?J:Je.unproject(Z.add(ee.mult(st(At))).mult(Ut));return Je.setLocationAtPoint(Je.renderWorldCopies?St.wrap():St,G),Je._updateCameraOnTerrain(),i.preloadOnly||this._fireMoveEvents(c),Je};if(i.preloadOnly){const Je=this._emulate(at,i.duration,p);return this._preloadTiles(Je),this}return this._zooming=!0,this._rotating=it,this._pitching=Pt,this._padding=qe,this._prepareEase(c,!1),this._ease(at(p),(()=>this._afterEase(c)),i),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_requestRenderFrame(i){}_cancelRenderFrame(i){}_stop(i,c){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const p=this._onEaseEnd;this._onEaseEnd=void 0,p.call(this,c)}if(!i){const p=this.handlers;p&&p.stop(!1)}return this}_ease(i,c,p){p.animate===!1||p.duration===0?(i(1),c()):(this._easeStart=s.o.now(),this._easeOptions=p,this._onEaseFrame=i,this._onEaseEnd=c,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const i=Math.min((s.o.now()-this._easeStart)/this._easeOptions.duration,1),c=this._onEaseFrame;c&&c(this._easeOptions.easing(i)),i<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(i,c){i=s.bT(i,-180,180);const p=Math.abs(i-c);return Math.abs(i-360-c)<p&&(i-=360),Math.abs(i+360-c)<p&&(i+=360),i}_normalizeCenter(i){const c=this.transform;if(c.maxBounds||c.projection.name!=="globe"&&!c.renderWorldCopies)return;const p=i.lng-c.center.lng;i.lng+=p>180?-360:p<-180?360:0}_prefersReducedMotion(i){return this._respectPrefersReducedMotion&&s.o.prefersReducedMotion&&!(i&&i.essential)}_emulate(i,c,p){const y=Math.ceil(15*c/1e3),v=[],w=i(p.clone());for(let S=0;S<=y;S++){const I=w(S/y);v.push(I.clone())}return v}_preloadTiles(i,c){}}class Ff{constructor(i={}){this.options=i,s.aY(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(i){const c=this.options&&this.options.compact,p=i._getUIString("AttributionControl.ToggleAttribution");this._map=i,this._container=de("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=de("button","mapboxgl-ctrl-attrib-button",this._container),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._compactButton.setAttribute("aria-label",p);const y=de("span","mapboxgl-ctrl-icon",this._compactButton);return y.setAttribute("aria-hidden","true"),y.setAttribute("title",p),this._innerContainer=de("div","mapboxgl-ctrl-attrib-inner",this._container),c&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),c===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let i=this._editLink;i||(i=this._editLink=this._container.querySelector(".mapbox-improve-map"));const c=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||s.e.ACCESS_TOKEN}];if(i){const p=c.reduce(((y,v,w)=>(v.value&&(y+=`${v.key}=${v.value}${w<c.length-1?"&":""}`),y)),"?");i.href=`${s.e.FEEDBACK_URL}/${p}#${Sm(this._map,!0)}`,i.rel="noopener nofollow"}}_updateData(i){!i||(i.dataType!=="source"||i.sourceDataType!=="metadata"&&i.sourceDataType!=="visibility")&&i.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let i=[];if(this._map.style.stylesheet){const y=this._map.style.stylesheet;this.styleOwner=y.owner,this.styleId=y.id}const c=this._map.style._mergedSourceCaches;for(const y in c){const v=c[y];if(v.used){const w=v.getSource();w.attribution&&i.indexOf(w.attribution)<0&&i.push(w.attribution)}}i.sort(((y,v)=>y.length-v.length)),i=i.filter(((y,v)=>{for(let w=v+1;w<i.length;w++)if(i[w].indexOf(y)>=0)return!1;return!0})),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?i=[...this.options.customAttribution,...i]:i.unshift(this.options.customAttribution));const p=i.join(" | ");p!==this._attribHTML&&(this._attribHTML=p,i.length?(this._innerContainer.innerHTML=p,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class Cl{constructor(){s.aY(["_updateLogo","_updateCompact"],this)}onAdd(i){this._map=i,this._container=de("div","mapboxgl-ctrl");const c=de("a","mapboxgl-ctrl-logo");return c.target="_blank",c.rel="noopener nofollow",c.href="https://www.mapbox.com/",c.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),c.setAttribute("rel","noopener nofollow"),this._container.appendChild(c),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(i){i&&i.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const i=this._map.style._sourceCaches;if(Object.entries(i).length===0)return!0;for(const c in i){const p=i[c].getSource();if(p.hasOwnProperty("mapbox_logo")&&!p.mapbox_logo)return!1}return!0}_updateCompact(){const i=this._container.children;if(i.length){const c=i[0];this._map.getCanvasContainer().offsetWidth<250?c.classList.add("mapboxgl-compact"):c.classList.remove("mapboxgl-compact")}}}class Bf{constructor(){s.aY(["_onIndoorUpdate"],this)}onAdd(i){return this._map=i,this._container=de("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._map.indoor.on("indoorupdate",(c=>this._onIndoorUpdate({selectedFloorId:c.selectedFloorId,floors:c.floors}))),this._container}_createButton(i,c){const p=de("button",i,this._container);return p.type="button",p.addEventListener("click",c),p}_createSeparator(){return de("div","mapboxgl-ctrl-separator",this._container)}_setButtonTitle(i,c){this._map&&(i.setAttribute("aria-label",c),i.textContent=c)}onRemove(){this._container&&this._container.remove(),this._map&&this._map.indoor&&(this._map.indoor.off("indoorupdate",this._onIndoorUpdate),this._map=null)}getDefaultPosition(){return"right"}_onIndoorUpdate(i){if(!i||!i.floors)return void(this._container.style.display="none");const c=this._model;this._model=i,this._container.style.display="inline-block",this._container.style.borderRadius="8px";const p=i.floors.sort(((y,v)=>v.levelOrder-y.levelOrder));c?(Array.from(this._container.children).forEach((y=>y.remove())),this.addCurrentFloors(p)):this.addCurrentFloors(p)}addCurrentFloors(i){for(let c=0;c<i.length;c++){const p=i[c],y=this._createButton("mapboxgl-ctrl-level-button",(()=>{this._map._selectIndoorFloor(p.id),this._model&&(this._model.selectedFloorId=p.id),Array.from(this._container.children).forEach((v=>{v.classList.contains("mapboxgl-ctrl-level-button")&&v.classList.remove("mapboxgl-ctrl-level-button-selected")})),y.classList.add("mapboxgl-ctrl-level-button-selected")}));this._setButtonTitle(y,p.shortName),this._model&&p.id===this._model.selectedFloorId&&y.classList.add("mapboxgl-ctrl-level-button-selected"),this._container.append(y),c<i.length-1&&this._createSeparator()}}}class po{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(i){const c=++this._id;return this._queue.push({callback:i,id:c,cancelled:!1}),c}remove(i){const c=this._currentlyRunning,p=c?this._queue.concat(c):this._queue;for(const y of p)if(y.id===i)return void(y.cancelled=!0)}run(i=0){const c=this._currentlyRunning=this._queue;this._queue=[];for(const p of c)if(!p.cancelled&&(p.callback(i),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}class Il{constructor(i){this.jumpTo(i)}getValue(i){if(i<=this._startTime)return this._start;if(i>=this._endTime)return this._end;const c=s.dz((i-this._startTime)/(this._endTime-this._startTime));return this._start*(1-c)+this._end*c}isEasing(i){return i>=this._startTime&&i<=this._endTime}jumpTo(i){this._startTime=-1/0,this._endTime=-1/0,this._start=i,this._end=i}easeTo(i,c,p){this._start=this.getValue(c),this._end=i,this._startTime=c,this._endTime=c+p}}const Nf={"AttributionControl.ToggleAttribution":"Toggle attribution","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox homepage","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use  + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"};class Vf extends s.z{constructor(i,c,p,y){const{point:v,lngLat:w,originalEvent:S,target:I}=i;super(i.type,{point:v,lngLat:w,originalEvent:S,target:I}),this.preventDefault=()=>{i.preventDefault()},this.id=c,this.interaction=p,this.feature=y}}class s1{constructor(i){this.map=i,this.interactionsByType=new Map,this.delegatedInteractions=new Map,this.typeById=new Map,this.filters=new Map,this.handleType=this.handleType.bind(this),this.handleMove=this.handleMove.bind(this),this.handleOut=this.handleOut.bind(this),this.hoveredFeatures=new Map,this.prevHoveredFeatures=new Map}add(i,c){if(this.typeById.has(i))throw new Error(`Interaction id "${i}" already exists.`);const p=c.filter;let y=c.type;p&&this.filters.set(i,s.b6(p)),y==="mouseover"&&(y="mouseenter"),y==="mouseout"&&(y="mouseleave");const v=this.interactionsByType.get(y)||new Map;y==="mouseenter"||y==="mouseleave"?(this.delegatedInteractions.size===0&&(this.map.on("mousemove",this.handleMove),this.map.on("mouseout",this.handleOut)),this.delegatedInteractions.set(i,c)):v.size===0&&this.map.on(y,this.handleType),v.size===0&&this.interactionsByType.set(y,v),v.set(i,c),this.typeById.set(i,y)}get(i){const c=this.typeById.get(i);if(!c)return;const p=this.interactionsByType.get(c);return p?p.get(i):void 0}remove(i){const c=this.typeById.get(i);if(!c)return;this.typeById.delete(i),this.filters.delete(i);const p=this.interactionsByType.get(c);p&&(p.delete(i),c==="mouseenter"||c==="mouseleave"?(this.delegatedInteractions.delete(i),this.delegatedInteractions.size===0&&(this.map.off("mousemove",this.handleMove),this.map.off("mouseout",this.handleOut))):p.size===0&&this.map.off(c,this.handleType))}queryTargets(i,c){const p=[];for(const[y,v]of c)v.target&&p.push({targetId:y,target:v.target,filter:this.filters.get(y)});return this.map.style.queryRenderedTargets(i,p,this.map.transform)}handleMove(i){this.prevHoveredFeatures=this.hoveredFeatures,this.hoveredFeatures=new Map;const c=this.queryTargets(i.point,Array.from(this.delegatedInteractions).reverse());c.length&&(i.type="mouseenter",this.handleType(i,c));const p=new Map;for(const[y,{feature:v}]of this.prevHoveredFeatures)this.hoveredFeatures.has(y)||p.set(v.id,v);p.size&&(i.type="mouseleave",this.handleType(i,Array.from(p.values())))}handleOut(i){const c=Array.from(this.hoveredFeatures.values()).map((({feature:p})=>p));c.length&&(i.type="mouseleave",this.handleType(i,c)),this.hoveredFeatures.clear()}handleType(i,c){const p=i.type==="mouseenter";if(p&&!this.interactionsByType.has(i.type))return void s.w("mouseenter interaction required for mouseleave to work.");const y=Array.from(this.interactionsByType.get(i.type)).reverse(),v=!!c;c=c||this.queryTargets(i.point,y);let w=!1;const S=new Set;for(const I of c){for(const[O,D]of y){if(!D.target)continue;const N=I.variants?I.variants[O]:null;if(N){for(const z of N){if(_l(z,I,S,O))continue;const U=new s.dt(I,z),G=Tc(z,I,O);v&&(U.state=this.map.getFeatureState(U));const H=p?this.prevHoveredFeatures.get(G):null,J=new Vf(i,O,D,U),Z=H?H.stop:D.handler(J);if(p&&this.hoveredFeatures.set(G,{feature:I,stop:Z}),Z!==!1){w=!0;break}}if(w)break}}if(w)break}if(!w)for(const[I,O]of y){const{handler:D,target:N}=O;if(!N&&D(new Vf(i,I,O,null))!==!1)break}}}function AS(m,i){if(Array.isArray(m)&&Array.isArray(i)){const c=new Set(m),p=new Set(i);return c.size===p.size&&m.every((y=>p.has(y)))}return s.by(m,i)}const $f={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,antialias:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,respectPrefersReducedMotion:!0,crossSourceCollisions:!0,collectResourceTiming:!1,testMode:!1,precompilePrograms:!0,scaleFactor:1,spriteFormat:"auto"},PS={showCompass:!0,showZoom:!0,visualizePitch:!1};class RS{constructor(i,c,p=!1){this._clickTolerance=10,this.element=c,this.mouseRotate=new Am({clickTolerance:i.dragRotate._mouseRotate._clickTolerance}),this.map=i,p&&(this.mousePitch=new Pm({clickTolerance:i.dragRotate._mousePitch._clickTolerance})),s.aY(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),c.addEventListener("mousedown",this.mousedown),c.addEventListener("touchstart",this.touchstart,{passive:!1}),c.addEventListener("touchmove",this.touchmove),c.addEventListener("touchend",this.touchend),c.addEventListener("touchcancel",this.reset)}down(i,c){this.mouseRotate.mousedown(i,c),this.mousePitch&&this.mousePitch.mousedown(i,c),Ne()}move(i,c){const p=this.map,y=this.mouseRotate.mousemoveWindow(i,c),v=y&&y.bearingDelta;if(v&&p.setBearing(p.getBearing()+v),this.mousePitch){const w=this.mousePitch.mousemoveWindow(i,c),S=w&&w.pitchDelta;S&&p.setPitch(p.getPitch()+S)}}off(){const i=this.element;i.removeEventListener("mousedown",this.mousedown),i.removeEventListener("touchstart",this.touchstart),i.removeEventListener("touchmove",this.touchmove),i.removeEventListener("touchend",this.touchend),i.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){Mt(),window.removeEventListener("mousemove",this.mousemove),window.removeEventListener("mouseup",this.mouseup)}mousedown(i){this.down(Object.assign({},i,{ctrlKey:!0,preventDefault:()=>i.preventDefault()}),we(this.element,i)),window.addEventListener("mousemove",this.mousemove),window.addEventListener("mouseup",this.mouseup)}mousemove(i){this.move(i,we(this.element,i))}mouseup(i){this.mouseRotate.mouseupWindow(i),this.mousePitch&&this.mousePitch.mouseupWindow(i),this.offTemp()}touchstart(i){i.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=Se(this.element,i.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>i.preventDefault()},this._startPos))}touchmove(i){i.targetTouches.length!==1?this.reset():(this._lastPos=Se(this.element,i.targetTouches)[0],this.move({preventDefault:()=>i.preventDefault()},this._lastPos))}touchend(i){i.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}function Mm(m,i,c){if(m=new s.aR(m.lng,m.lat),i){const p=new s.aR(m.lng-360,m.lat),y=new s.aR(m.lng+360,m.lat),v=360*Math.ceil(Math.abs(m.lng-c.center.lng)/360),w=c.locationPoint3D(m).distSqr(i),S=i.x<0||i.y<0||i.x>c.width||i.y>c.height;c.locationPoint3D(p).distSqr(i)<w&&(S||Math.abs(p.lng-c.center.lng)<v)?m=p:c.locationPoint3D(y).distSqr(i)<w&&(S||Math.abs(y.lng-c.center.lng)<v)&&(m=y)}for(;Math.abs(m.lng-c.center.lng)>180;){const p=c.locationPoint3D(m);if(p.x>=0&&p.y>=0&&p.x<=c.width&&p.y<=c.height)break;m.lng>c.center.lng?m.lng-=360:m.lng+=360}return m}const Uf={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"},ya={rotation:0,rotationAlignment:"auto",pitchAlignment:"auto",occludedOpacity:.2,altitude:0};class Ju extends s.E{constructor(i,c){super(),(i instanceof HTMLElement||c)&&(i=Object.assign({element:i},c)),s.aY(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this);const{anchor:p="center",color:y="#3FB1CE",scale:v=1,draggable:w=!1,clickTolerance:S=0,rotation:I=ya.rotation,rotationAlignment:O=ya.rotationAlignment,pitchAlignment:D=ya.pitchAlignment,occludedOpacity:N=ya.occludedOpacity,altitude:z=ya.altitude}=i||{};this._anchor=p,this._color=y,this._scale=v,this._draggable=w,this._clickTolerance=S,this._rotation=I,this._rotationAlignment=O,this._pitchAlignment=D,this._occludedOpacity=N,this._altitude=z,this._state="inactive",this._isDragging=!1,this._updateMoving=()=>this._update(!0),i&&i.element?(this._element=i.element,this._offset=s.P.convert(i&&i.offset||[0,0])):(this._defaultMarker=!0,this._element=this._createDefaultMarker(),this._offset=s.P.convert(i&&i.offset||[0,-14])),this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.hasAttribute("role")||this._element.setAttribute("role","img"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",(H=>{H.preventDefault()})),this._element.addEventListener("mousedown",(H=>{H.preventDefault()}));const U=this._element.classList;for(const H in Uf)U.remove(`mapboxgl-marker-anchor-${H}`);U.add(`mapboxgl-marker-anchor-${this._anchor}`);const G=i&&i.className?i.className.trim().split(/\s+/):[];U.add(...G),this._popup=null}_createDefaultMarker(){const i=de("div"),c=Te("svg",{display:"block",height:41*this._scale+"px",width:27*this._scale+"px",viewBox:"0 0 27 41"},i);if(this._altitude===0){const p=Te("radialGradient",{id:"shadowGradient"},Te("defs",{},c));Te("stop",{offset:"10%","stop-opacity":.4},p),Te("stop",{offset:"100%","stop-opacity":.05},p),Te("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},c)}return Te("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},c),Te("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},c),Te("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},c),i}addTo(i){return i===this._map||(this.remove(),this._map=i,i.getCanvasContainer().appendChild(this._element),i.on("move",this._updateMoving),i.on("moveend",this._update),i.on("remove",this._clearFadeTimer),i._addMarker(this),this.setDraggable(this._draggable),this._update(),i.on("click",this._onMapClick)),this}remove(){const i=this._map;return i&&(i.off("click",this._onMapClick),i.off("move",this._updateMoving),i.off("moveend",this._update),i.off("mousedown",this._addDragHandler),i.off("touchstart",this._addDragHandler),i.off("mouseup",this._onUp),i.off("touchend",this._onUp),i.off("mousemove",this._onMove),i.off("touchmove",this._onMove),i.off("remove",this._clearFadeTimer),i._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(i){return this._lngLat=s.aR.convert(i),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}setAltitude(i){return i===this._altitude||(this._defaultMarker&&(this._altitude===0&&i!==0||this._altitude!==0&&i===0)&&(this._element=this._createDefaultMarker()),this._altitude=i||ya.altitude,this._update()),this}getAltitude(){return this._altitude}getElement(){return this._element}setPopup(i){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),i){if(!("offset"in i.options)){const y=Math.sqrt(Math.pow(13.5,2)/2);i.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[y,-1*(38.1-13.5+y)],"bottom-right":[-y,-1*(38.1-13.5+y)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=i,i._marker=this,i._altitude=this._altitude,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(i){const c=i.code,p=i.charCode||i.keyCode;c!=="Space"&&c!=="Enter"&&p!==32&&p!==13||this.togglePopup()}_onMapClick(i){const c=i.originalEvent.target,p=this._element;this._popup&&(c===p||p.contains(c))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const i=this._popup;return i?(i.isOpen()?(i.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(i.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const i=this._map,c=this._pos;if(!i||!c)return!1;const p=i.unproject(c,this._altitude),y=i.getFreeCameraOptions();if(!y.position)return!1;const v=y.position.toLngLat();return v.distanceTo(p)<.9*v.distanceTo(this._lngLat)}_evaluateOpacity(){const i=this._map;if(!i)return;const c=this._pos;if(!c||c.x<0||c.x>i.transform.width||c.y<0||c.y>i.transform.height)return void this._clearFadeTimer();const p=i.unproject(c,this._altitude);let y;i._showingGlobe()&&s.eY(i.transform,this._lngLat)?y=0:(y=1-i._queryFogOpacity(p),i.transform._terrainEnabled()&&i.getTerrain()&&this._behindTerrain()&&(y*=this._occludedOpacity)),this._element.style.opacity=`${y}`,this._element.style.pointerEvents=y>0?"auto":"none",this._popup&&this._popup._setOpacity(y),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const i=this._pos;if(!i||!this._map)return;const c=this._offset.mult(this._scale);this._element.style.transform=`
            translate(${i.x}px,${i.y}px)
            ${Uf[this._anchor]}
            ${this._calculateXYTransform()} ${this._calculateZTransform()}
            translate(${c.x}px,${c.y}px)
        `}_calculateXYTransform(){const i=this._pos,c=this._map,p=this.getPitchAlignment();if(!c||!i||p!=="map")return"";if(!c._showingGlobe()){const I=c.getPitch();return I?`rotateX(${I}deg)`:""}const y=s.cW(s.eZ(c.transform,this._lngLat)),v=i.sub(s.e_(c.transform)),w=Math.abs(v.x)+Math.abs(v.y);if(w===0)return"";const S=y/w;return`rotateX(${-v.y*S}deg) rotateY(${v.x*S}deg)`}_calculateZTransform(){const i=this._pos,c=this._map;if(!c||!i)return"";let p=0;const y=this.getRotationAlignment();if(y==="map")if(c._showingGlobe()){const v=c.project(new s.aR(this._lngLat.lng,this._lngLat.lat+.001),this._altitude),w=c.project(new s.aR(this._lngLat.lng,this._lngLat.lat-.001),this._altitude).sub(v);p=s.cW(Math.atan2(w.y,w.x))-90}else p=-c.getBearing();else if(y==="horizon"){const v=s.ah(4,6,c.getZoom()),w=s.e_(c.transform);w.y+=v*c.transform.height;const S=i.sub(w),I=s.cW(Math.atan2(S.y,S.x));p=(I>90?I-270:I+90)*(1-v)}return p+=this._rotation,p?`rotateZ(${p}deg)`:""}_update(i){cancelAnimationFrame(this._updateFrameId);const c=this._map;c&&(c.transform.renderWorldCopies&&(this._lngLat=Mm(this._lngLat,this._pos,c.transform)),this._pos=c.project(this._lngLat,this._altitude),i===!0?this._updateFrameId=requestAnimationFrame((()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())})):this._pos=this._pos.round(),c._requestDomTask((()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(c._showingGlobe()||c.getTerrain()||c.getFog())&&!this._fadeTimer&&(this._fadeTimer=window.setTimeout(this._evaluateOpacity.bind(this),60)))})))}getOffset(){return this._offset}setOffset(i){return this._offset=s.P.convert(i),this._update(),this}addClassName(i){return this._element.classList.add(i),this}removeClassName(i){return this._element.classList.remove(i),this}toggleClassName(i){return this._element.classList.toggle(i)}_onMove(i){const c=this._map;if(!c)return;const p=this._pointerdownPos,y=this._positionDelta;if(p&&y){if(!this._isDragging){const v=this._clickTolerance||c._clickTolerance;if(i.point.dist(p)<v)return;this._isDragging=!0}this._pos=i.point.sub(y),this._lngLat=c.unproject(this._pos,this._altitude),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new s.z("dragstart"))),this.fire(new s.z("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const i=this._map;i&&(i.off("mousemove",this._onMove),i.off("touchmove",this._onMove)),this._state==="active"&&this.fire(new s.z("dragend")),this._state="inactive"}_addDragHandler(i){const c=this._map,p=this._pos;c&&p&&this._element.contains(i.originalEvent.target)&&(i.preventDefault(),this._positionDelta=i.point.sub(p),this._pointerdownPos=i.point,this._state="pending",c.on("mousemove",this._onMove),c.on("touchmove",this._onMove),c.once("mouseup",this._onUp),c.once("touchend",this._onUp))}setDraggable(i){this._draggable=!!i;const c=this._map;return c&&(i?(c.on("mousedown",this._addDragHandler),c.on("touchstart",this._addDragHandler)):(c.off("mousedown",this._addDragHandler),c.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(i){return this._rotation=i||ya.rotation,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(i){return this._rotationAlignment=i||ya.rotationAlignment,this._update(),this}getRotationAlignment(){return this._rotationAlignment==="auto"||this._rotationAlignment==="horizon"&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(i){return this._pitchAlignment=i||ya.pitchAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment==="auto"?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(i){return this._occludedOpacity=i||ya.occludedOpacity,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}const jc={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},Ql={maxWidth:100,unit:"metric"},ec={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"},Qu={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",altitude:0},tl=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function a1(m=new s.P(0,0),i="bottom"){if(typeof m=="number"){const c=Math.round(Math.sqrt(.5*Math.pow(m,2)));switch(i){case"top":return new s.P(0,m);case"top-left":return new s.P(c,c);case"top-right":return new s.P(-c,c);case"bottom":return new s.P(0,-m);case"bottom-left":return new s.P(c,-c);case"bottom-right":return new s.P(-c,-c);case"left":return new s.P(m,0);case"right":return new s.P(-m,0)}return new s.P(0,0)}return m instanceof s.P||Array.isArray(m)?s.P.convert(m):s.P.convert(m[i]||[0,0])}return{version:C,supported:ue.supported,setRTLTextPlugin:s.f2,getRTLTextPluginStatus:s.f1,Map:class extends cy{constructor(m){L.mark(P.create);const i=m;if((m=Object.assign({},$f,m)).minZoom!=null&&m.maxZoom!=null&&m.minZoom>m.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(m.minPitch!=null&&m.maxPitch!=null&&m.minPitch>m.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(m.minPitch!=null&&m.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(m.maxPitch!=null&&m.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(m.antialias&&s.eW(window)&&(m.antialias=!1,s.w("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new xs(m.minZoom,m.maxZoom,m.minPitch,m.maxPitch,m.renderWorldCopies,null,null),m),this._repaint=!!m.repaint,this._interactive=m.interactive,this._minTileCacheSize=m.minTileCacheSize,this._maxTileCacheSize=m.maxTileCacheSize,this._failIfMajorPerformanceCaveat=m.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=m.preserveDrawingBuffer,this._antialias=m.antialias,this._trackResize=m.trackResize,this._bearingSnap=m.bearingSnap,this._refreshExpiredTiles=m.refreshExpiredTiles,this._fadeDuration=m.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=m.crossSourceCollisions,this._collectResourceTiming=m.collectResourceTiming,this._language=this._parseLanguage(m.language),this._worldview=m.worldview,this._renderTaskQueue=new po,this._domRenderTaskQueue=new po,this._controls=[],this._markers=[],this._popups=[],this._mapId=s.b2(),this._locale=Object.assign({},Nf,m.locale),this._clickTolerance=m.clickTolerance,this._cooperativeGestures=m.cooperativeGestures,this._performanceMetricsCollection=m.performanceMetricsCollection,this._tessellationStep=m.tessellationStep,this._containerWidth=0,this._containerHeight=0,this._showParseStatus=!0,this._precompilePrograms=m.precompilePrograms,this._scaleFactorChanged=!1,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new Il(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._frameId=0,this._scaleFactor=m.scaleFactor,this._requestManager=new Mn(m.transformRequest,m.accessToken,m.testMode),this._silenceAuthErrors=!!m.testMode,this._contextCreateOptions=m.contextCreateOptions?Object.assign({},m.contextCreateOptions):{},typeof m.container=="string"){const c=document.getElementById(m.container);if(!c)throw new Error(`Container '${m.container.toString()}' not found.`);this._container=c}else{if(!(m.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=m.container}if(this._container.childNodes.length>0&&s.w("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),m.maxBounds&&this.setMaxBounds(m.maxBounds),this._spriteFormat=m.spriteFormat,s.aY(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._tp||(this._tp=new eh),this._tp.registerParameter(this,["Debug"],"showOverdrawInspector"),this._tp.registerParameter(this,["Debug"],"showTileBoundaries"),this._tp.registerParameter(this,["Debug"],"showParseStatus"),this._tp.registerParameter(this,["Debug"],"repaint"),this._tp.registerParameter(this,["Debug"],"showTileAABBs"),this._tp.registerParameter(this,["Debug"],"showPadding"),this._tp.registerParameter(this,["Debug"],"showCollisionBoxes",{noSave:!0}),this._tp.registerParameter(this.transform,["Debug"],"freezeTileCoverage",{noSave:!0},(()=>{this._update()})),this._tp.registerParameter(this,["Debug","Wireframe"],"showTerrainWireframe"),this._tp.registerParameter(this,["Debug","Wireframe"],"showLayers2DWireframe"),this._tp.registerParameter(this,["Debug","Wireframe"],"showLayers3DWireframe"),this._tp.registerParameter(this,["Scaling"],"_scaleFactor",{min:.1,max:10,step:.1},(()=>{this.setScaleFactor(this._scaleFactor)})),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");if(this.on("move",(()=>this._update(!1))),this.on("moveend",(()=>this._update(!1))),this.on("zoom",(()=>this._update(!0))),this._fullscreenchangeEvent="onfullscreenchange"in document?"fullscreenchange":"webkitfullscreenchange",window.addEventListener("online",this._onWindowOnline,!1),window.addEventListener("resize",this._onWindowResize,!1),window.addEventListener("orientationchange",this._onWindowResize,!1),window.addEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),window.addEventListener("visibilitychange",this._onVisibilityChange,!1),this.handlers=new zf(this,m),this._localFontFamily=m.localFontFamily,this._localIdeographFontFamily=m.localIdeographFontFamily,(m.style||!m.testMode)&&this.setStyle(m.style||s.e.DEFAULT_STYLE,{config:m.config,localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),m.projection&&this.setProjection(m.projection),this.indoor=new Lu(this),m.hash&&(this._hash=new J_(typeof m.hash=="string"&&m.hash||void 0).addTo(this)),!this._hash||!this._hash._onHashChange()){i.center==null&&i.zoom==null||(this.transform._unmodified=!1),this.jumpTo({center:m.center,zoom:m.zoom,bearing:m.bearing,pitch:m.pitch});const c=m.bounds;c&&(this.resize(),this.fitBounds(c,Object.assign({},m.fitBoundsOptions,{duration:0})))}this.resize(),m.attributionControl&&this.addControl(new Ff({customAttribution:m.customAttribution})),this._logoControl=new Cl,this.addControl(this._logoControl,m.logoPosition),this.on("style.load",(()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet),this._postStyleLoadEvent()})),this.on("data",(c=>{this._update(c.dataType==="style"),this.fire(new s.z(`${c.dataType}data`,c))})),this.on("dataloading",(c=>{this.fire(new s.z(`${c.dataType}dataloading`,c))})),this._interactions=new s1(this)}_getMapId(){return this._mapId}addControl(m,i){if(i===void 0&&(i=m.getDefaultPosition?m.getDefaultPosition():"top-right"),!m||!m.onAdd)return this.fire(new s.y(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const c=m.onAdd(this);this._controls.push(m);const p=this._controlPositions[i];return i.indexOf("bottom")!==-1?p.insertBefore(c,p.firstChild):p.appendChild(c),this}removeControl(m){if(!m||!m.onRemove)return this.fire(new s.y(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const i=this._controls.indexOf(m);return i>-1&&this._controls.splice(i,1),m.onRemove(this),this}hasControl(m){return this._controls.indexOf(m)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(m){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const i=!this._moving;return i&&this.fire(new s.z("movestart",m)).fire(new s.z("move",m)),this.fire(new s.z("resize",m)),i&&this.fire(new s.z("moveend",m)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(m){return this.transform.setMaxBounds(s.aI.convert(m)),this._update()}setMinZoom(m){if((m=m??-2)>=-2&&m<=this.transform.maxZoom)return this.transform.minZoom=m,this._update(),this.getZoom()<m?this.setZoom(m):this.fire(new s.z("zoomstart")).fire(new s.z("zoom")).fire(new s.z("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(m){if((m=m??22)>=this.transform.minZoom)return this.transform.maxZoom=m,this._update(),this.getZoom()>m?this.setZoom(m):this.fire(new s.z("zoomstart")).fire(new s.z("zoom")).fire(new s.z("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(m){if((m=m??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(m>=0&&m<=this.transform.maxPitch)return this.transform.minPitch=m,this._update(),this.getPitch()<m?this.setPitch(m):this.fire(new s.z("pitchstart")).fire(new s.z("pitch")).fire(new s.z("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(m){if((m=m??85)>85)throw new Error("maxPitch must be less than or equal to 85");if(m>=this.transform.minPitch)return this.transform.maxPitch=m,this._update(),this.getPitch()>m?this.setPitch(m):this.fire(new s.z("pitchstart")).fire(new s.z("pitch")).fire(new s.z("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getScaleFactor(){return this._scaleFactor}setScaleFactor(m){return this._scaleFactor=m,this.painter.scaleFactor=m,this._tp.refreshUI(),this._scaleFactorChanged=!0,this.style._updateFilteredLayers((i=>i.type==="symbol")),this._update(!0),this}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(m){return this.transform.renderWorldCopies=m,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(m){return m==="auto"?navigator.language:Array.isArray(m)?m.length===0?void 0:m.map((i=>i==="auto"?navigator.language:i)):m}setLanguage(m){const i=this._parseLanguage(m);if(!this.style||i===this._language)return this;this._language=i,this.style.reloadSources();for(const c of this._controls)c._setLanguage&&c._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(m){return this.style&&m!==this._worldview?(this._worldview=m,this._styleDirty=!0,this.style.reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return this.transform.projection.name==="globe"}setProjection(m){return this._lazyInitEmptyStyle(),m?typeof m=="string"&&(m={name:m}):m=null,this._useExplicitProjection=!!m,this._prioritizeAndUpdateProjection(m,this.style.projection)}_updateProjectionTransition(){if(this.getProjection().name!=="globe")return;const m=this.transform,i=m.projection.name;let c;i==="globe"&&m.zoom>=s.cK?(m.setMercatorFromTransition(),c=!0):i==="mercator"&&m.zoom<s.cK&&(m.setProjection({name:"globe"}),c=!0),c&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate(),this._update(!0))}_prioritizeAndUpdateProjection(m,i){return this._updateProjection(m||i||{name:"mercator"})}_updateProjection(m){let i;return i=m.name==="globe"&&this.transform.zoom>=s.cK?this.transform.setMercatorFromTransition():this.transform.setProjection(m),this.style.applyProjectionUpdate(),i&&(this.painter.clearBackgroundTiles(),this.style.clearSources(),this._update(!0),this._forceMarkerAndPopupUpdate(!0)),this}project(m,i){return this.transform.locationPoint3D(s.aR.convert(m),i)}unproject(m,i){return this.transform.pointLocation3D(s.P.convert(m),i)}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_isDragging(){return this.handlers&&this.handlers._isDragging()||!1}_createDelegatedListener(m,i,c){const p=y=>{let v=[];if(Array.isArray(i)){const w=i.filter((S=>this.getLayer(S)));v=w.length?this.queryRenderedFeatures(y,{layers:w}):[]}else v=this.queryRenderedFeatures(y,{target:i});return v};if(m==="mouseenter"||m==="mouseover"){let y=!1;return{listener:c,targets:i,delegates:{mousemove:w=>{const S=p(w.point);S.length?y||(y=!0,c.call(this,new Co(m,this,w.originalEvent,{features:S}))):y=!1},mouseout:()=>{y=!1}}}}if(m==="mouseleave"||m==="mouseout"){let y=!1;return{listener:c,targets:i,delegates:{mousemove:S=>{p(S.point).length?y=!0:y&&(y=!1,c.call(this,new Co(m,this,S.originalEvent)))},mouseout:S=>{y&&(y=!1,c.call(this,new Co(m,this,S.originalEvent)))}}}}{const y=v=>{const w=p(v.point);w.length&&(v.features=w,c.call(this,v),delete v.features)};return{listener:c,targets:i,delegates:{[m]:y}}}}on(m,i,c){if(typeof i=="function"||c===void 0)return super.on(m,i);if(typeof i=="string"&&(i=[i]),!this._areTargetsValid(i))return this;const p=this._createDelegatedListener(m,i,c);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[m]=this._delegatedListeners[m]||[],this._delegatedListeners[m].push(p);for(const y in p.delegates)this.on(y,p.delegates[y]);return this}once(m,i,c){if(typeof i=="function"||c===void 0)return super.once(m,i);if(typeof i=="string"&&(i=[i]),!this._areTargetsValid(i))return this;const p=this._createDelegatedListener(m,i,c);for(const y in p.delegates)this.once(y,p.delegates[y]);return this}off(m,i,c){if(typeof i=="function"||c===void 0)return super.off(m,i);if(typeof i=="string"&&(i=[i]),!this._areTargetsValid(i))return this;const p=this._delegatedListeners?this._delegatedListeners[m]:void 0;return p&&(y=>{for(let v=0;v<y.length;v++){const w=y[v];if(w.listener===c&&AS(w.targets,i)){for(const S in w.delegates)this.off(S,w.delegates[S]);return y.splice(v,1),this}}})(p),this}queryRenderedFeatures(m,i){if(!this.style)return[];if(m===void 0||m instanceof s.P||Array.isArray(m)||i!==void 0||(i=m,m=void 0),m=m||[[0,0],[this.transform.width,this.transform.height]],!i){const v=this.style.queryRenderedFeatures(m,void 0,this.transform),w=this.style.queryRenderedFeatureset(m,void 0,this.transform);return v.concat(w)}let c=!0;if(i.target&&(c=this._isTargetValid(i.target),c&&!i.layers))return this.style.queryRenderedFeatureset(m,i,this.transform);let p=!0;if(i.layers&&Array.isArray(i.layers)){for(const v of i.layers)if(!this._isValidId(v)){p=!1;break}if(p&&!i.target)return this.style.queryRenderedFeatures(m,i,this.transform)}let y=[];return p&&(y=y.concat(this.style.queryRenderedFeatures(m,i,this.transform))),c&&(y=y.concat(this.style.queryRenderedFeatureset(m,i,this.transform))),y}querySourceFeatures(m,i){return!m||typeof m=="string"&&!this._isValidId(m)?[]:this.style.querySourceFeatures(m,i)}queryRasterValue(m,i,c){return this._isValidId(m)?this.style.queryRasterValue(m,i,c):Promise.resolve(null)}isPointOnSurface(m){const{name:i}=this.transform.projection;return i!=="globe"&&i!=="mercator"&&s.w(`${i} projection does not support isPointOnSurface, this API may behave unexpectedly.`),this.transform.isPointOnSurface(s.P.convert(m))}addInteraction(m,i){return this._interactions.add(m,i),this}removeInteraction(m){return this._interactions.remove(m),this}getCooperativeGestures(){return this._cooperativeGestures}setCooperativeGestures(m){return this._cooperativeGestures=m,this}setStyle(m,i){return i=Object.assign({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},i),this.style&&m&&i.diff!==!1&&i.localFontFamily===this._localFontFamily&&i.localIdeographFontFamily===this._localIdeographFontFamily&&!i.config?(this.style._diffStyle(m,((c,p)=>{if(c){const y=typeof c=="string"?c:c instanceof Error?c.message:c.error;s.w(`Unable to perform style diff: ${y}. Rebuilding the style from scratch.`),this._updateStyle(m,i)}else p&&this._update(!0)}),(()=>this._postStyleLoadEvent())),this):(this._localIdeographFontFamily=i.localIdeographFontFamily,this._localFontFamily=i.localFontFamily,this._updateStyle(m,i))}_getUIString(m){const i=this._locale[m];if(i==null)throw new Error(`Missing UI string '${m}'`);return i}_updateStyle(m,i){if(this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),m){const c=Object.assign({},i);i&&i.config&&(c.initialConfig=i.config,delete c.config),this.style=new za(this,c).load(m),this.style.setEventedParent(this,{style:this.style})}return this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new za(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(s.w("There is no style added to the map."),!1)}_isValidId(m){return m==null?(this.fire(new s.y(new Error("IDs can't be empty."))),!1):!s.dm(m)||(this.fire(new s.y(new Error(`IDs can't contain special symbols: "${m}".`))),!1)}_isTargetValid(m){return"featuresetId"in m?this._isValidId("importId"in m?m.importId:m.featuresetId):"layerId"in m&&this._isValidId(m.layerId)}_areTargetsValid(m){if(Array.isArray(m)){for(const i of m)if(!this._isValidId(i))return!1;return!0}return this._isTargetValid(m)}addSource(m,i){return this._isValidId(m)?(this._lazyInitEmptyStyle(),this.style.addSource(m,i),this._update(!0)):this}isSourceLoaded(m){return!!this._isValidId(m)&&!!this.style&&this.style._isSourceCacheLoaded(m)}areTilesLoaded(){return this.style.areTilesLoaded()}addSourceType(m,i,c){this._lazyInitEmptyStyle(),this.style.addSourceType(m,i,c)}removeSource(m){return this._isValidId(m)?(this.style.removeSource(m),this._updateTerrain(),this._update(!0)):this}getSource(m){return this._isValidId(m)?this.style.getOwnSource(m):null}addImage(m,i,{pixelRatio:c=1,sdf:p=!1,stretchX:y,stretchY:v,content:w}={}){this._lazyInitEmptyStyle();const S=s.I.from(m);if(i instanceof HTMLImageElement||ImageBitmap&&i instanceof ImageBitmap){const{width:I,height:O,data:D}=s.o.getImageData(i);this.style.addImage(S,{data:new s.q({width:I,height:O},D),pixelRatio:c,stretchX:y,stretchY:v,content:w,sdf:p,version:0,usvg:!1})}else if(i.width===void 0||i.height===void 0)this.fire(new s.y(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:I,height:O}=i,D=i;this.style.addImage(S,{data:new s.q({width:I,height:O},new Uint8Array(D.data)),pixelRatio:c,stretchX:y,stretchY:v,content:w,sdf:p,usvg:!1,version:0,userImage:D}),D.onAdd&&D.onAdd(this,m)}}updateImage(m,i){this._lazyInitEmptyStyle();const c=s.I.from(m),p=this.style.getImage(c);if(!p)return void this.fire(new s.y(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const y=i instanceof HTMLImageElement||ImageBitmap&&i instanceof ImageBitmap?s.o.getImageData(i):i,{width:v,height:w,data:S}=y;if(v===void 0||w===void 0)return void this.fire(new s.y(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(v!==(p.usvg?p.icon.usvg_tree.width:p.data.width)||w!==(p.usvg?p.icon.usvg_tree.height:p.data.height))return void this.fire(new s.y(new Error(`The width and height of the updated image (${v}, ${w})
                must be that same as the previous version of the image
                (${p.data.width}, ${p.data.height})`)));const I=!(i instanceof HTMLImageElement||ImageBitmap&&i instanceof ImageBitmap);let O=!1;p.usvg?(p.data=new s.q({width:v,height:w},new Uint8Array(S)),p.usvg=!1,p.icon=void 0,O=!0):p.data.replace(S,I),this.style.updateImage(c,p,O)}hasImage(m){return m?!!this.style&&!!this.style.getImage(s.I.from(m)):(this.fire(new s.y(new Error("Missing required image id"))),!1)}removeImage(m){this.style.removeImage(s.I.from(m))}loadImage(m,i){s.n(this._requestManager.transformRequest(m,s.R.Image),((c,p)=>{i(c,p instanceof HTMLImageElement?s.o.getImageData(p):p)}))}listImages(){return this.style.listImages().map((m=>m.name))}addModel(m,i){this._lazyInitEmptyStyle(),this.style.addModel(m,i)}hasModel(m){return m?this.style.hasModel(m):(this.fire(new s.y(new Error("Missing required model id"))),!1)}removeModel(m){this.style.removeModel(m)}listModels(){return this.style.listModels()}addLayer(m,i){return this._isValidId(m.id)?(this._lazyInitEmptyStyle(),this.style.addLayer(m,i),this._update(!0)):this}getSlot(m){const i=this.getLayer(m);return i&&i.slot||null}setSlot(m,i){return this.style.setSlot(m,i),this.style.mergeLayers(),this._update(!0)}addImport(m,i){return this.style.addImport(m,i).catch((c=>this.fire(new s.y(new Error("Failed to add import",c))))),this}updateImport(m,i){return typeof i!="string"&&i.id!==m?(this.removeImport(m),this.addImport(i)):(this.style.updateImport(m,i),this._update(!0))}removeImport(m){return this.style.removeImport(m),this}moveImport(m,i){return this.style.moveImport(m,i),this._update(!0)}moveLayer(m,i){return this._isValidId(m)?(this.style.moveLayer(m,i),this._update(!0)):this}removeLayer(m){return this._isValidId(m)?(this.style.removeLayer(m),this._update(!0)):this}getLayer(m){if(!this._isValidId(m))return null;const i=this.style.getOwnLayer(m);return i?i.type==="custom"?i.implementation:i.serialize():void 0}getSlots(){return this.style.getSlots()}setLayerZoomRange(m,i,c){return this._isValidId(m)?(this.style.setLayerZoomRange(m,i,c),this._update(!0)):this}setFilter(m,i,c={}){return this._isValidId(m)?(this.style.setFilter(m,i,c),this._update(!0)):this}getFilter(m){return this._isValidId(m)?this.style.getFilter(m):null}setPaintProperty(m,i,c,p={}){return this._isValidId(m)?(this.style.setPaintProperty(m,i,c,p),this._update(!0)):this}getPaintProperty(m,i){return this._isValidId(m)?this.style.getPaintProperty(m,i):null}setLayoutProperty(m,i,c,p={}){return this._isValidId(m)?(this.style.setLayoutProperty(m,i,c,p),this._update(!0)):this}getLayoutProperty(m,i){return this._isValidId(m)?this.style.getLayoutProperty(m,i):null}getGlyphsUrl(){return this.style.getGlyphsUrl()}setGlyphsUrl(m){return this.style.setGlyphsUrl(m),this._update(!0)}getSchema(m){return this.style.getSchema(m)}setSchema(m,i){return this.style.setSchema(m,i),this._update(!0)}getConfig(m){return this.style.getConfig(m)}setConfig(m,i){return this.style.setConfig(m,i),this._update(!0)}getConfigProperty(m,i){return this.style.getConfigProperty(m,i)}setConfigProperty(m,i,c){return this.style.setConfigProperty(m,i,c),this._update(!0)}getFeaturesetDescriptors(m){return this.style.getFeaturesetDescriptors(m)}setLights(m){if(this._lazyInitEmptyStyle(),m&&m.length===1&&m[0].type==="flat"){const i=m[0];i.properties?this.style.setFlatLight(i.properties,i.id,{}):this.style.setFlatLight({},"flat")}else this.style.setLights(m),this.painter.terrain&&(this.painter.terrain.invalidateRenderCache=!0);return this._update(!0)}getLights(){const m=this.style.getLights()||[];return m.length===0&&m.push({id:this.style.light.id,type:"flat",properties:this.style.getFlatLight()}),m}setLight(m,i={}){return console.log("The `map.setLight` function is deprecated, prefer using `map.setLights` with `flat` light type instead."),this.setLights([{id:"flat",type:"flat",properties:m}])}getLight(){return console.log("The `map.getLight` function is deprecated, prefer using `map.getLights` instead."),this.style.getFlatLight()}setTerrain(m){return this._lazyInitEmptyStyle(),!m&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(m),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(m){return this._lazyInitEmptyStyle(),this.style.setFog(m),this._update(!0)}getFog(){return this.style?this.style.getFog():null}setSnow(m){return this._lazyInitEmptyStyle(),this.style.setSnow(m),this._update(!0)}getSnow(){return this.style?this.style.getSnow():null}setRain(m){return this._lazyInitEmptyStyle(),this.style.setRain(m),this._update(!0)}getRain(){return this.style?this.style.getRain():null}setColorTheme(m){return this._lazyInitEmptyStyle(),this.style.setColorTheme(m),this._update(!0)}setImportColorTheme(m,i){return this._lazyInitEmptyStyle(),this.style.setImportColorTheme(m,i),this._update(!0)}setCamera(m){return this.style.setCamera(m),this._triggerCameraUpdate(m)}_triggerCameraUpdate(m){return this._update(this.transform.setOrthographicProjectionAtLowPitch(m["camera-projection"]==="orthographic"))}getCamera(){return this.style.camera}_queryFogOpacity(m){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(s.aR.convert(m),this.transform):0}setFeatureState(m,i){return m.source&&!this._isValidId(m.source)?this:(this.style.setFeatureState(m,i),this._update())}removeFeatureState(m,i){return m.source&&!this._isValidId(m.source)?this:(this.style.removeFeatureState(m,i),this._update())}getFeatureState(m){return m.source&&!this._isValidId(m.source)?null:this.style.getFeatureState(m)}_selectIndoorFloor(m){this.indoor.selectFloor(m)}_addIndoorControl(){this._indoorControl||(this._indoorControl=new Bf),this.addControl(this._indoorControl,"right")}_removeIndoorControl(){this._indoorControl&&this.removeControl(this._indoorControl)}_updateContainerDimensions(){if(!this._container)return;const m=this._container.getBoundingClientRect().width||400,i=this._container.getBoundingClientRect().height||300;let c,p,y,v=this._container;for(;v&&(!p||!y);){const w=window.getComputedStyle(v).transform;w&&w!=="none"&&(c=w.match(/matrix.*\((.+)\)/)[1].split(", "),c[0]&&c[0]!=="0"&&c[0]!=="1"&&(p=c[0]),c[3]&&c[3]!=="0"&&c[3]!=="1"&&(y=c[3])),v=v.parentElement}this._containerWidth=p?Math.abs(m/p):m,this._containerHeight=y?Math.abs(i/y):i}_detectMissingCSS(){window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&s.w("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const m=this._container;m.classList.add("mapboxgl-map"),(this._missingCSSCanary=de("div","mapboxgl-canary",m)).style.visibility="hidden",this._detectMissingCSS();const i=this._canvasContainer=de("div","mapboxgl-canvas-container",m);this._canvas=de("canvas","mapboxgl-canvas",i),this._interactive&&(i.classList.add("mapboxgl-interactive"),this._canvas.setAttribute("tabindex","0")),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const c=this._controlContainer=de("div","mapboxgl-control-container",m),p=this._controlPositions={};["top-left","top","top-right","right","bottom-right","bottom","bottom-left","left"].forEach((y=>{p[y]=de("div",`mapboxgl-ctrl-${y}`,c)})),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(m,i){const c=s.o.devicePixelRatio||1;this._canvas.width=c*Math.ceil(m),this._canvas.height=c*Math.ceil(i),this._canvas.style.width=`${m}px`,this._canvas.style.height=`${i}px`}_addMarker(m){this._markers.push(m)}_removeMarker(m){const i=this._markers.indexOf(m);i!==-1&&this._markers.splice(i,1)}_addPopup(m){this._popups.push(m)}_removePopup(m){const i=this._popups.indexOf(m);i!==-1&&this._popups.splice(i,1)}_setupPainter(){const m=Object.assign({},ue.supported.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),i=this._canvas.getContext("webgl2",m);i?(He(i,!0),this.painter=new Y_(i,this._contextCreateOptions,this.transform,this._scaleFactor,this._tp,this._worldview),this.on("data",(c=>{c.dataType==="source"&&this.painter.setTileLoadedFlag(!0)})),s.k.testSupport(i)):this.fire(new s.y(new Error("Failed to initialize WebGL")))}_contextLost(m){m.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new s.z("webglcontextlost",{originalEvent:m}))}_contextRestored(m){this._setupPainter(),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight)),this._updateTerrain(),this.style&&(this.style.clearLayers(),this.style.imageManager.destroyAtlasTextures(),this.style.reloadModels(),this.style.clearSources()),this._update(),this.fire(new s.z("webglcontextrestored",{originalEvent:m}))}_onMapScroll(m){if(m.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}idle(){return!this.isMoving()&&this.loaded()}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}frameReady(){return this.loaded()&&!this._placementDirty}_update(m){return this.style?(this._styleDirty=this._styleDirty||m,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(m){return this._update(),this._renderTaskQueue.add(m)}_cancelRenderFrame(m){this._renderTaskQueue.remove(m)}_requestDomTask(m){!this.loaded()||this.loaded()&&!this.isMoving()?m():this._domRenderTaskQueue.add(m)}_render(m){let i;this.fire(new s.z("renderstart")),++this._frameId;const c=this.painter.context.extTimerQuery,p=s.o.now(),y=this.painter.context.gl;if(this.listens("gpu-timing-frame")&&(i=y.createQuery(),y.beginQuery(c.TIME_ELAPSED_EXT,i)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],performance.now())),this._renderTaskQueue.run(m),this._domRenderTaskQueue.run(m),this._removed)return;this._updateProjectionTransition();const v=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const O=this.transform.zoom,D=this.transform.pitch,N=s.o.now(),z=new s.ac(O,{now:N,fadeDuration:v,pitch:D,transition:this.style.transition,worldview:this._worldview});this.style.update(z)}this.style&&this.style.hasFogTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let w=!1;this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),w=this._updateAverageElevation(p),this.style.updateSources(this.transform),this.style.updateImageProviders(),this.isMoving()||this._forceMarkerAndPopupUpdate()):w=this._updateAverageElevation(p);const S=this.style&&this.style._updatePlacement(this.painter,this.painter.transform,this.showCollisionBoxes,v,this._crossSourceCollisions,this.painter.replacementSource,this._scaleFactorChanged);if(this._scaleFactorChanged&&(this._scaleFactorChanged=!1),S&&(this._placementDirty=S.needsRerender),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showParseStatus:this.showParseStatus,wireframe:{terrain:this.showTerrainWireframe,layers2D:this.showLayers2DWireframe,layers3D:this.showLayers3DWireframe},showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:v,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new s.z("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,L.mark(P.load),this.fire(new s.z("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&(this.style.snow||this.style.rain)&&(this._styleDirty=!0),this.style&&this.style.imageManager.hasPatternsInFlight()&&(this._styleDirty=!0),this.style&&!this.style.modelManager.isLoaded()&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),i){const O=s.o.now()-p;y.endQuery(c.TIME_ELAPSED_EXT),setTimeout((()=>{const D=y.getQueryParameter(i,y.QUERY_RESULT)/1e6;y.deleteQuery(i),this.fire(new s.z("gpu-timing-frame",{cpuTime:O,gpuTime:D}))}),50)}if(this.listens("gpu-timing-layer")){const O=this.painter.collectGpuTimers();setTimeout((()=>{const D=this.painter.queryGpuTimers(O);this.fire(new s.z("gpu-timing-layer",{layerTimes:D}))}),50)}if(this.listens("gpu-timing-deferred-render")){const O=this.painter.collectDeferredRenderGpuQueries();setTimeout((()=>{const D=this.painter.queryGpuTimeDeferredRender(O);this.fire(new s.z("gpu-timing-deferred-render",{gpuTime:D}))}),50)}const I=this._sourcesDirty||this._styleDirty||this._placementDirty||w;if(I||this._repaint)this.triggerRepaint();else{const O=this.idle();if(O&&(w=this._updateAverageElevation(p,!0)),w)this.triggerRepaint();else if(this._triggerFrame(!1),O&&(this.fire(new s.z("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const D=this._calculateSpeedIndex();this.fire(new s.z("speedindexcompleted",{speedIndex:D})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||I||(this._fullyLoaded=!0,L.mark(P.fullLoad),this._performanceMetricsCollection&&ln(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(m){for(const i of this._markers)m&&!this.getRenderWorldCopies()&&(i._lngLat=i._lngLat.wrap()),i._update();for(const i of this._popups)!m||this.getRenderWorldCopies()||i._trackPointer||(i._lngLat=i._lngLat.wrap()),i._update()}_updateAverageElevation(m,i=!1){const c=y=>(this.transform.averageElevation=y,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return this.transform.averageElevation!==0&&c(0);const p=this.transform.elevation&&this.transform.elevation.exaggeration()!==this._averageElevationExaggeration;if(p||(i||m-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(m)){const y=this.transform.averageElevation;let v=this.transform.sampleAverageElevation();this.transform.elevation!=null&&(this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(v)?v=0:this._averageElevationLastSampledAt=m;const w=Math.abs(y-v);if(w>1){if(this._isInitialLoad||p)return this._averageElevation.jumpTo(v),c(v);this._averageElevation.easeTo(v,m,300)}else if(w>1e-4)return this._averageElevation.jumpTo(v),c(v)}return!!this._averageElevation.isEasing(m)&&c(this._averageElevation.getValue(m))}_authenticate(){vn(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,(m=>{if(m&&(m.message===ke||m.status===401)){const i=this.painter.context.gl;He(i,!1),this._logoControl instanceof Cl&&this._logoControl._updateLogo(),i&&i.clear(i.DEPTH_BUFFER_BIT|i.COLOR_BUFFER_BIT|i.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new s.y(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}})),uo(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,(()=>{}))}_postStyleLoadEvent(){this.style.globalId&&ur(this._requestManager._customAccessToken,{map:this,style:this.style.globalId,importedStyles:this.style.getImportGlobalIds()})}_updateTerrain(){const m=this._isDragging();this.painter.updateTerrain(this.style,m)}_calculateSpeedIndex(){const m=this.painter.canvasCopy(),i=this.painter.getCanvasCopiesAndTimestamps();i.timeStamps.push(performance.now());const c=this.painter.context.gl,p=c.createFramebuffer();function y(v){c.framebufferTexture2D(c.FRAMEBUFFER,c.COLOR_ATTACHMENT0,c.TEXTURE_2D,v,0);const w=new Uint8Array(c.drawingBufferWidth*c.drawingBufferHeight*4);return c.readPixels(0,0,c.drawingBufferWidth,c.drawingBufferHeight,c.RGBA,c.UNSIGNED_BYTE,w),w}return c.bindFramebuffer(c.FRAMEBUFFER,p),this._canvasPixelComparison(y(m),i.canvasCopies.map(y),i.timeStamps)}_canvasPixelComparison(m,i,c){let p=c[1]-c[0];const y=m.length/4;for(let v=0;v<i.length;v++){const w=i[v];let S=0;for(let I=0;I<w.length;I+=4)w[I]===m[I]&&w[I+1]===m[I+1]&&w[I+2]===m[I+2]&&w[I+3]===m[I+3]&&(S+=1);p+=(c[v+2]-c[v+1])*(1-S/y)}return p}remove(){this._hash&&this._hash.remove();for(const i of this._controls)i.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.indoor.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),window.removeEventListener("resize",this._onWindowResize,!1),window.removeEventListener("orientationchange",this._onWindowResize,!1),window.removeEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),window.removeEventListener("online",this._onWindowOnline,!1),window.removeEventListener("visibilitychange",this._onVisibilityChange,!1);const m=this.painter.context.gl.getExtension("WEBGL_lose_context");m&&m.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),Nr.delete(this.painter.context.gl),yn.remove(),oi.remove(),this._removed=!0,this.fire(new s.z("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(m){this._renderNextFrame=this._renderNextFrame||m,this.style&&!this._frame&&(this._frame=s.o.frame((i=>{const c=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,c&&this._render(i)})))}_preloadTiles(m){const i=this.style?this.style.getSourceCaches():[];return s.bw(i,((c,p)=>c._preloadTiles(m,p)),(()=>{this.triggerRepaint()})),this}_onWindowOnline(){this._update()}_onWindowResize(m){this._trackResize&&this.resize({originalEvent:m})._update()}_onVisibilityChange(){document.visibilityState==="hidden"&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(m){this._showTileBoundaries!==m&&(this._showTileBoundaries=m,this._tp.refreshUI(),this._update())}get showParseStatus(){return!!this._showParseStatus}set showParseStatus(m){this._showParseStatus!==m&&(this._showParseStatus=m,this._tp.refreshUI(),this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(m){this._showTerrainWireframe!==m&&(this._showTerrainWireframe=m,this._tp.refreshUI(),this._update())}get showLayers2DWireframe(){return!!this._showLayers2DWireframe}set showLayers2DWireframe(m){this._showLayers2DWireframe!==m&&(this._showLayers2DWireframe=m,this._tp.refreshUI(),this._update())}get showLayers3DWireframe(){return!!this._showLayers3DWireframe}set showLayers3DWireframe(m){this._showLayers3DWireframe!==m&&(this._showLayers3DWireframe=m,this._tp.refreshUI(),this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(m){this._speedIndexTiming!==m&&(this._speedIndexTiming=m,this._update())}get showPadding(){return!!this._showPadding}set showPadding(m){this._showPadding!==m&&(this._showPadding=m,this._tp.refreshUI(),this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(m){this._showCollisionBoxes!==m&&(this._showCollisionBoxes=m,this._tp.refreshUI(),m?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(m){this._showOverdrawInspector!==m&&(this._showOverdrawInspector=m,this._tp.refreshUI(),this._update())}get repaint(){return!!this._repaint}set repaint(m){this._repaint!==m&&(this._repaint=m,this._tp.refreshUI(),this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(m){this._vertices=m,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(m){this._showTileAABBs!==m&&(this._showTileAABBs=m,this._tp.refreshUI(),m&&this._update())}_setCacheLimits(m,i){s.eX(m,i)}get version(){return C}},NavigationControl:class{constructor(m={}){this.options=Object.assign({},PS,m),this._container=de("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",(i=>i.preventDefault())),this.options.showZoom&&(s.aY(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",(i=>{this._map&&this._map.zoomIn({},{originalEvent:i})})),de("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",(i=>{this._map&&this._map.zoomOut({},{originalEvent:i})})),de("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(s.aY(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",(i=>{const c=this._map;c&&(this.options.visualizePitch?c.resetNorthPitch({},{originalEvent:i}):c.resetNorth({},{originalEvent:i}))})),this._compassIcon=de("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const m=this._map;if(!m)return;const i=m.getZoom(),c=i===m.getMaxZoom(),p=i===m.getMinZoom();this._zoomInButton.disabled=c,this._zoomOutButton.disabled=p,this._zoomInButton.setAttribute("aria-disabled",c.toString()),this._zoomOutButton.setAttribute("aria-disabled",p.toString())}_rotateCompassArrow(){const m=this._map;if(!m)return;const i=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(m.transform.pitch*(Math.PI/180)),.5)}) rotateX(${m.transform.pitch}deg) rotateZ(${m.transform.angle*(180/Math.PI)}deg)`:`rotate(${m.transform.angle*(180/Math.PI)}deg)`;m._requestDomTask((()=>{this._compassIcon&&(this._compassIcon.style.transform=i)}))}onAdd(m){return this._map=m,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),m.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&m.on("pitch",this._rotateCompassArrow),m.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new RS(m,this._compass,this.options.visualizePitch)),this._container}onRemove(){const m=this._map;m&&(this._container.remove(),this.options.showZoom&&m.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&m.off("pitch",this._rotateCompassArrow),m.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(m,i){const c=de("button",m,this._container);return c.type="button",c.addEventListener("click",i),c}_setButtonTitle(m,i){if(!this._map)return;const c=this._map._getUIString(`NavigationControl.${i}`);m.setAttribute("aria-label",c),m.firstElementChild&&m.firstElementChild.setAttribute("title",c)}},GeolocateControl:class extends s.E{constructor(m={}){super();const i=navigator.geolocation;this.options=Object.assign({geolocation:i},jc,m),s.aY(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=Tm(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(m){return this._map=m,this._container=de("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){this._geolocationWatchID!==void 0&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(m){const i=(c=!!this.options.geolocation)=>{this._supportsGeolocation=c,m(c)};this._supportsGeolocation!==void 0?m(this._supportsGeolocation):navigator.permissions!==void 0?navigator.permissions.query({name:"geolocation"}).then((c=>i(c.state!=="denied"))).catch((()=>i())):i()}_isOutOfMapMaxBounds(m){const i=this._map.getMaxBounds(),c=m.coords;return!!i&&(c.longitude<i.getWest()||c.longitude>i.getEast()||c.latitude<i.getSouth()||c.latitude>i.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(m){if(this._map){if(this._isOutOfMapMaxBounds(m))return this._setErrorState(),this.fire(new s.z("outofmaxbounds",m)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=m,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(m),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(m),this.options.showUserLocation&&this._userLocationDotMarker.removeClassName("mapboxgl-user-location-dot-stale"),this.fire(new s.z("geolocate",m)),this._finish()}}_updateCamera(m){const i=new s.aR(m.coords.longitude,m.coords.latitude),c=m.coords.accuracy,p=this._map.getBearing(),y=Object.assign({bearing:p},this.options.fitBoundsOptions);this._map.fitBounds(i.toBounds(c),y,{geolocateSource:!0})}_updateMarker(m){if(m){const i=new s.aR(m.coords.longitude,m.coords.latitude);this._accuracyCircleMarker.setLngLat(i).addTo(this._map),this._userLocationDotMarker.setLngLat(i).addTo(this._map),this._accuracy=m.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const m=this._map.transform,i=s.ce(1,m._center.lat)*m.worldSize,c=Math.ceil(2*this._accuracy*i);this._circleElement.style.width=`${c}px`,this._circleElement.style.height=`${c}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&typeof this._heading=="number"?(this._userLocationDotMarker.setRotation(this._heading),this._userLocationDotMarker.addClassName("mapboxgl-user-location-show-heading")):(this._userLocationDotMarker.removeClassName("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(m){if(this._map){if(this.options.trackUserLocation)if(m.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const i=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",i),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",i),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(m.code===3&&this._noTimeout)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._userLocationDotMarker.addClassName("mapboxgl-user-location-dot-stale"),this.fire(new s.z("error",m)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(m){if(this._map!==void 0){if(this._container.addEventListener("contextmenu",(i=>i.preventDefault())),this._geolocateButton=de("button","mapboxgl-ctrl-geolocate",this._container),de("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",m===!1){s.w("Geolocation support is not available so the GeolocateControl will be disabled.");const i=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",i),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",i)}else{const i=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",i),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",i)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=de("div","mapboxgl-user-location"),this._dotElement.appendChild(de("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(de("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new Ju({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=de("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Ju({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",(i=>{i.geolocateSource||this._watchState!=="ACTIVE_LOCK"||i.originalEvent&&i.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new s.z("trackuserlocationend")))}))}}_onDeviceOrientation(m){this._userLocationDotMarker&&(m.webkitCompassHeading?this._heading=m.webkitCompassHeading:m.absolute===!0&&(this._heading=-1*m.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return s.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new s.z("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new s.z("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new s.z("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let m;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(m={maximumAge:6e5,timeout:0},this._noTimeout=!0):(m=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,m),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=window.setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const m=()=>{"ondeviceorientationabsolute"in window?window.addEventListener("deviceorientationabsolute",this._onDeviceOrientation):window.addEventListener("deviceorientation",this._onDeviceOrientation)};typeof DeviceMotionEvent<"u"&&typeof DeviceMotionEvent.requestPermission=="function"?DeviceOrientationEvent.requestPermission().then((i=>{i==="granted"&&m()})).catch(console.error):m()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),window.removeEventListener("deviceorientation",this._onDeviceOrientation),window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:Ff,ScaleControl:class{constructor(m={}){this.options=Object.assign({},Ql,m),this._isNumberFormatSupported=(function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"short",unit:"meter"}),!0}catch{return!1}})(),s.aY(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const m=this.options.maxWidth||100,i=this._map,c=i._containerHeight/2,p=i._containerWidth/2-m/2,y=i.unproject([p,c]),v=i.unproject([p+m,c]),w=y.distanceTo(v);if(this.options.unit==="imperial"){const S=3.2808*w;S>5280?this._setScale(m,S/5280,"mile"):this._setScale(m,S,"foot")}else this.options.unit==="nautical"?this._setScale(m,w/1852,"nautical-mile"):w>=1e3?this._setScale(m,w/1e3,"kilometer"):this._setScale(m,w,"meter")}_setScale(m,i,c){this._map._requestDomTask((()=>{const p=(function(v){const w=Math.pow(10,`${Math.floor(v)}`.length-1);let S=v/w;return S=S>=10?10:S>=5?5:S>=3?3:S>=2?2:S>=1?1:(function(I){const O=Math.pow(10,Math.ceil(-Math.log(I)/Math.LN10));return Math.round(I*O)/O})(S),w*S})(i),y=p/i;this._container.innerHTML=this._isNumberFormatSupported&&c!=="nautical-mile"?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"short",unit:c}).format(p):`${p}&nbsp;${ec[c]}`,this._container.style.width=m*y+"px"}))}onAdd(m){return this._map=m,this._language=m.getLanguage(),this._container=de("div","mapboxgl-ctrl mapboxgl-ctrl-scale",m.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(m){this._language=m,this._update()}setUnit(m){this.options.unit=m,this._update()}},FullscreenControl:class{constructor(m={}){this._fullscreen=!1,m&&m.container&&(m.container instanceof HTMLElement?this._container=m.container:s.w("Full screen control 'container' must be a DOM element.")),s.aY(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(m){return this._map=m,this._container||(this._container=this._map.getContainer()),this._controlContainer=de("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",s.w("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!document.fullscreenEnabled&&!document.webkitFullscreenEnabled)}_setupUI(){const m=this._fullscreenButton=de("button","mapboxgl-ctrl-fullscreen",this._controlContainer);de("span","mapboxgl-ctrl-icon",m).setAttribute("aria-hidden","true"),m.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const m=this._getTitle();this._fullscreenButton.setAttribute("aria-label",m),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",m)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(document.fullscreenElement||document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?document.exitFullscreen?document.exitFullscreen():document.webkitCancelFullScreen&&document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},IndoorControl:Bf,Popup:class extends s.E{constructor(m){super(),this.options=Object.assign(Object.create(Qu),m),this._altitude=this.options.altitude,s.aY(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(m&&m.className?m.className.trim().split(/\s+/):[])}addTo(m){return this._map&&this.remove(),this._map=m,this.options.closeOnClick&&m.on("preclick",this._onClose),this.options.closeOnMove&&m.on("move",this._onClose),m.on("remove",this.remove),this._update(),m._addPopup(this),this._focusFirstElement(),this._trackPointer?(m.on("mousemove",this._onMouseEvent),m.on("mouseup",this._onMouseEvent),m._canvasContainer.classList.add("mapboxgl-track-pointer")):m.on("move",this._update),this.fire(new s.z("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const m=this._map;return m&&(m.off("move",this._update),m.off("move",this._onClose),m.off("preclick",this._onClose),m.off("click",this._onClose),m.off("remove",this.remove),m.off("mousemove",this._onMouseEvent),m.off("mouseup",this._onMouseEvent),m.off("drag",this._onMouseEvent),m._canvasContainer&&m._canvasContainer.classList.remove("mapboxgl-track-pointer"),m._removePopup(this),this._map=void 0),this.fire(new s.z("close")),this}getLngLat(){return this._lngLat}setLngLat(m){this._lngLat=s.aR.convert(m),this._pos=null,this._trackPointer=!1,this._update();const i=this._map;return i&&(i.on("move",this._update),i.off("mousemove",this._onMouseEvent),i._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}getAltitude(){return this._altitude}setAltitude(m){return this._altitude=m,this._update(),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const m=this._map;return m&&(m.off("move",this._update),m.on("mousemove",this._onMouseEvent),m.on("drag",this._onMouseEvent),m._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(m){return this.setDOMContent(document.createTextNode(m))}setHTML(m){const i=document.createDocumentFragment(),c=document.createElement("body");let p;for(c.innerHTML=m;p=c.firstChild,p;)i.appendChild(p);return this.setDOMContent(i)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(m){return this.options.maxWidth=m,this._update(),this}setDOMContent(m){let i=this._content;if(i)for(;i.hasChildNodes();)i.firstChild&&i.removeChild(i.firstChild);else i=this._content=de("div","mapboxgl-popup-content",this._container||void 0);if(i.appendChild(m),this.options.closeButton){const c=this._closeButton=de("button","mapboxgl-popup-close-button",i);c.type="button",c.setAttribute("aria-label","Close popup"),c.innerHTML='<span aria-hidden="true">&#215;</span>',c.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(m){return this._classList.add(m),this._updateClassList(),this}removeClassName(m){return this._classList.delete(m),this._updateClassList(),this}setOffset(m){return this.options.offset=m,this._update(),this}toggleClassName(m){let i;return this._classList.delete(m)?i=!1:(this._classList.add(m),i=!0),this._updateClassList(),i}_onMouseEvent(m){this._update(m.point)}_getAnchor(m){if(this.options.anchor)return this.options.anchor;const i=this._map,c=this._container,p=this._pos;if(!i||!c||!p)return"bottom";const y=c.offsetWidth,v=c.offsetHeight,w=p.x<y/2,S=p.x>i.transform.width-y/2;if(p.y+m<v)return w?"top-left":S?"top-right":"top";if(p.y>i.transform.height-v){if(w)return"bottom-left";if(S)return"bottom-right"}return w?"left":S?"right":"bottom"}_updateClassList(){const m=this._container;if(!m)return;const i=[...this._classList];i.push("mapboxgl-popup"),this._anchor&&i.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&i.push("mapboxgl-popup-track-pointer"),m.className=i.join(" ")}_update(m){const i=this._map,c=this._content;if(!i||!this._lngLat&&!this._trackPointer||!c)return;let p=this._container;if(p||(p=this._container=de("div","mapboxgl-popup",i.getContainer()),this._tip=de("div","mapboxgl-popup-tip",p),p.appendChild(c)),this.options.maxWidth&&p.style.maxWidth!==this.options.maxWidth&&(p.style.maxWidth=this.options.maxWidth),i.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Mm(this._lngLat,this._pos,i.transform)),!this._trackPointer||m){const y=this._pos=this._trackPointer&&m instanceof s.P?m:i.project(this._lngLat,this._altitude),v=a1(this.options.offset),w=this._anchor=this._getAnchor(v.y),S=a1(this.options.offset,w),I=y.add(S).round();i._requestDomTask((()=>{this._container&&w&&(this._container.style.transform=`${Uf[w]} translate(${I.x}px,${I.y}px)`)}))}if(!this._marker&&i._showingGlobe()){const y=s.eY(i.transform,this._lngLat)?0:1;this._setOpacity(y)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const m=this._container.querySelector(tl);m&&m.focus()}_onClose(){this.remove()}_setOpacity(m){this._container&&(this._container.style.opacity=`${m}`),this._content&&(this._content.style.pointerEvents=m?"auto":"none")}},Marker:Ju,Style:za,LngLat:s.aR,LngLatBounds:s.aI,Point:s.P,MercatorCoordinate:s.ae,FreeCameraOptions:h_,Evented:s.E,config:s.e,prewarm:s.f0,clearPrewarmedResources:s.e$,get accessToken(){return s.e.ACCESS_TOKEN},set accessToken(m){s.e.ACCESS_TOKEN=m},get baseApiUrl(){return s.e.API_URL},set baseApiUrl(m){s.e.API_URL=m},get workerCount(){return s.f9.workerCount},set workerCount(m){s.f9.workerCount=m},get maxParallelImageRequests(){return s.e.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(m){s.e.MAX_PARALLEL_IMAGE_REQUESTS=m},clearStorage(m){s.f8(m)},get workerUrl(){return s.f7.workerUrl},set workerUrl(m){s.f7.workerUrl=m},get workerClass(){return s.f7.workerClass},set workerClass(m){s.f7.workerClass=m},get workerParams(){return s.f7.workerParams},set workerParams(m){s.f7.workerParams=m},get dracoUrl(){return s.f6()},set dracoUrl(m){s.f5(m)},get meshoptUrl(){return s.f4()},set meshoptUrl(m){s.f3(m)},setNow:s.o.setNow,restoreNow:s.o.restoreNow}}));var x=d;return x}))})(Yx)),Yx.exports}var mde=pde();const tv=hde(mde),gde={id:"main",role:"main"},_de={class:"container py-5","aria-labelledby":"pageTitle"},yde={key:0,class:"text-center py-5",role:"status","aria-live":"polite"},vde={key:1,class:"alert alert-danger",role:"alert","aria-live":"assertive"},bde={key:2,class:"row g-4"},xde={class:"col-lg-7","aria-labelledby":"pageTitle"},wde={class:"mb-4"},Tde={class:"text-uppercase text-muted small mb-1"},Sde={id:"pageTitle",class:"h3 mb-2"},Ede={class:"lead mb-3"},Cde={class:"list-inline small text-muted"},Ide={class:"list-inline-item"},Ade={class:"list-inline-item"},Pde={class:"list-inline-item"},Rde={class:"card shadow-sm","aria-labelledby":"venueHeading"},kde={class:"card-header bg-white d-flex justify-content-between align-items-center"},Ode={class:"h6 mb-0"},Mde={class:"card-body"},Dde={key:0,class:"mb-2 text-muted small"},Lde={class:"col-lg-5","aria-labelledby":"formHeading"},zde={class:"card-body"},Fde={class:"mb-3"},Bde=["aria-invalid"],Nde={class:"mb-3"},Vde=["aria-invalid"],$de={class:"mb-3"},Ude={key:0,class:"alert alert-danger small mb-3",role:"alert","aria-live":"assertive"},jde={key:1,class:"alert alert-success small mb-3",role:"status","aria-live":"polite"},Gde={class:"card-footer bg-white text-end"},Hde=["disabled","aria-disabled"],Wde={key:0,class:"spinner-border spinner-border-sm me-2",role:"status","aria-label":"Submitting"},qde=vu({__name:"RegisterView",setup(t){tv.accessToken="pk.eyJ1Ijoibm1vdDI3IiwiYSI6ImNtZXFuODg2aTJhaDMybm9vZXptaGY5MWcifQ.G1B9DBjo7HhXMvhAU0PUjw";const e=dH(),n=ps(()=>e.params.id),{user:l}=ab(),d=bi(null),f=bi(!0),x=bi(""),s=bi(""),C=bi(!1),P=Fl({fullName:"",email:"",notes:""}),L=ps(()=>d.value?.nextStartDate?new Date(d.value.nextStartDate).toLocaleDateString():"TBA"),$=bi(null),V={lat:-37.8136,lng:144.9631};let j=null,ue=null,de=null;function Te(Ge){if(!$.value)return;const Ye=Ge??V,Ne=[Ye.lng,Ye.lat];j?j.flyTo({center:Ne,zoom:13,essential:!0}):(j=new tv.Map({container:$.value,style:"mapbox://styles/mapbox/streets-v12",center:Ne,zoom:13}),j.addControl(new tv.NavigationControl,"top-right"),j.addControl(new tv.GeolocateControl({positionOptions:{enableHighAccuracy:!0},trackUserLocation:!0,showUserHeading:!0})),j.once("load",()=>j?.resize())),ue?ue.setLngLat(Ne):ue=new tv.Marker().setLngLat(Ne).addTo(j)}ru(n,Ge=>{if(!Ge)return;f.value=!0,x.value="",s.value="",C.value=!1,de?.();const Ye=kv(hp,"programs",Ge);de=wJ(Ye,Ne=>{if(!Ne.exists()){d.value=null,f.value=!1;return}const Mt=Ne.data();d.value={id:Ne.id,...Mt},f.value=!1,G0(()=>{const kt=d.value?.venue;if(kt&&kt.lat&&kt.lon){const Pe={lat:kt.lat,lng:kt.lon};Te(Pe)}else Te(void 0)})},Ne=>{console.error(Ne),x.value="Could not load program details.",f.value=!1})},{immediate:!0}),VI(()=>{de?.(),j?.remove()});async function Be(){if(C.value)return;if(x.value="",s.value="",!d.value){x.value="Program is no longer available.";return}if(!l.value){x.value="Please sign in again to confirm your registration.";return}if(!P.fullName||!P.email){x.value="Please complete the required fields.";return}C.value=!0;const Ge=kv(hp,"programs",n.value),Ye=Aw(Ge,"registrations"),Ne=kv(Ye,l.value.uid),Mt=ZA(XA,"sendReply");try{await IJ(hp,async kt=>{if((await kt.get(Ne)).exists())throw new Error("You have already registered for this program.");kt.set(Ne,{uid:l.value?.uid,fullName:P.fullName,email:P.email,notes:P.notes,createdAt:oL()}),kt.update(Ge,{registrationCount:PJ(1),lastRegistrationAt:oL()})}),await Mt({name:P.fullName,email:P.email}),s.value="Thanks! You're on the list. We'll be in touch shortly."}catch(kt){console.error(kt),x.value=kt instanceof Error?kt.message:"We could not save your registration. Please try again."}finally{C.value=!1}}return(Ge,Ye)=>(Me(),ft("main",gde,[Ze("section",_de,[f.value?(Me(),ft("div",yde,[...Ye[3]||(Ye[3]=[Ze("span",{class:"spinner-border text-primary",role:"status","aria-label":"Loading"},null,-1),Ze("p",{class:"mt-3"},"Loading program details",-1)])])):d.value?(Me(),ft("div",bde,[Ze("article",xde,[Ze("header",wde,[Ze("p",Tde,Fr(d.value.level)+"  "+Fr(d.value.audience),1),Ze("h1",Sde,Fr(d.value.title),1),Ze("p",Ede,Fr(d.value.summary),1),Ze("ul",Cde,[Ze("li",Ide,[Ye[4]||(Ye[4]=Ze("i",{class:"bi bi-calendar-event me-1","aria-hidden":"true"},null,-1)),Ra(" Starts "+Fr(L.value),1)]),Ze("li",Ade,[Ye[5]||(Ye[5]=Ze("i",{class:"bi bi-clock-history me-1","aria-hidden":"true"},null,-1)),Ra(Fr(d.value.durationWeeks)+" weeks",1)]),Ze("li",Pde,[Ye[6]||(Ye[6]=Ze("i",{class:"bi bi-people me-1","aria-hidden":"true"},null,-1)),Ra(" "+Fr(d.value.registrationCount??0)+" confirmed",1)])])]),Xi(Ze("div",Rde,[Ze("div",kde,[Ze("div",null,[Ze("h2",Ode,Fr(d.value.venue?.name??"Location to be confirmed"),1),Ye[7]||(Ye[7]=Ze("small",{class:"text-muted"},"In-person sessions",-1))]),Ye[8]||(Ye[8]=Ze("span",{class:"badge bg-success","aria-label":"Registration open"},"Open",-1))]),Ze("div",Mde,[d.value.venue?Pn("",!0):(Me(),ft("p",Dde," Location details are not available yetshowing default map view. ")),Ze("div",{ref_key:"mapContainer",ref:$,class:"mapbox-container"},null,512)])],512),[[Vj,!f.value&&!!d.value]])]),Ze("aside",Lde,[Ze("form",{class:"card shadow-sm",onSubmit:Id(Be,["prevent"]),novalidate:"","aria-describedby":"formNote"},[Ze("div",zde,[Ye[12]||(Ye[12]=Ze("h2",{class:"h5 mb-3"},"Reserve your place",-1)),Ye[13]||(Ye[13]=Ze("p",{id:"formNote",class:"visually-hidden"},"All fields marked required must be completed.",-1)),Ze("div",Fde,[Ye[9]||(Ye[9]=Ze("label",{class:"form-label",for:"fullName"},"Full name",-1)),Xi(Ze("input",{id:"fullName","onUpdate:modelValue":Ye[0]||(Ye[0]=Ne=>P.fullName=Ne),type:"text",class:"form-control",required:"",autocomplete:"name","aria-invalid":!!x.value},null,8,Bde),[[Ps,P.fullName,void 0,{trim:!0}]])]),Ze("div",Nde,[Ye[10]||(Ye[10]=Ze("label",{class:"form-label",for:"email"},"Email",-1)),Xi(Ze("input",{id:"email","onUpdate:modelValue":Ye[1]||(Ye[1]=Ne=>P.email=Ne),type:"email",class:"form-control",required:"",autocomplete:"email","aria-invalid":!!x.value},null,8,Vde),[[Ps,P.email,void 0,{trim:!0}]])]),Ze("div",$de,[Ye[11]||(Ye[11]=Ze("label",{class:"form-label",for:"notes"},"Dietary needs / notes",-1)),Xi(Ze("textarea",{id:"notes","onUpdate:modelValue":Ye[2]||(Ye[2]=Ne=>P.notes=Ne),rows:"3",class:"form-control",placeholder:"Optional: allergies, accessibility requirements, etc.","aria-describedby":"notesHelp"},null,512),[[Ps,P.notes,void 0,{trim:!0}]])]),x.value?(Me(),ft("div",Ude,Fr(x.value),1)):Pn("",!0),s.value?(Me(),ft("div",jde,Fr(s.value),1)):Pn("",!0)]),Ze("div",Gde,[Ze("button",{type:"submit",class:"btn btn-primary",disabled:C.value||!!s.value,"aria-disabled":C.value||!!s.value},[C.value?(Me(),ft("span",Wde)):Pn("",!0),Ra(" "+Fr(s.value?"Registered":"Confirm my spot"),1)],8,Hde)])],32)])])):(Me(),ft("div",vde," We couldnt find that program. Please return to the programs list. "))])]))}}),Kde=lb(qde,[["__scopeId","data-v-cadde5e2"]]),Zde=[{path:"/",name:"home",component:XQ},{path:"/programs",name:"programs",component:Rce,meta:{requiresAuth:!0}},{path:"/get-involved/volunteer",name:"volunteer",component:oue},{path:"/login",name:"login",component:gue},{path:"/signup",name:"signup",component:Rue},{path:"/admin",name:"admin",component:lde,meta:{requiresAuth:!0,role:"admin"}},{path:"/:pathMatch(.*)*",name:"not-found",component:dde},{path:"/programs/:id/register",name:"program-register",component:Kde,props:!0}],iV=cH({history:VG("/"),routes:Zde});iV.beforeEach(async t=>{if(t.meta.requiresAuth||t.meta.role){if(!await new Promise(n=>{const l=Fz(o_,d=>{l(),n(d)})}))return"/login";if(t.meta.role){const{role:n}=ab();if(n.value!==t.meta.role)return"/"}}return!0});/*!
 * pinia v3.0.3
 * (c) 2025 Eduardo San Martin Morote
 * @license MIT
 */const Xde=Symbol();var k5;(function(t){t.direct="direct",t.patchObject="patch object",t.patchFunction="patch function"})(k5||(k5={}));function Yde(){const t=Z9(!0),e=t.run(()=>bi({}));let n=[],l=[];const d=U4({install(f){d._a=f,f.provide(Xde,d),f.config.globalProperties.$pinia=d,l.forEach(x=>n.push(x)),l=[]},use(f){return this._a?n.push(f):l.push(f),this},_p:n,_a:null,_e:t,_s:new Map,state:e});return d}var ka="top",fl="bottom",pl="right",Oa="left",$T="auto",a_=[ka,fl,pl,Oa],xp="start",Gg="end",oV="clippingParents",hP="viewport",dg="popper",sV="reference",vI=a_.reduce(function(t,e){return t.concat([e+"-"+xp,e+"-"+Gg])},[]),fP=[].concat(a_,[$T]).reduce(function(t,e){return t.concat([e,e+"-"+xp,e+"-"+Gg])},[]),aV="beforeRead",lV="read",cV="afterRead",uV="beforeMain",dV="main",hV="afterMain",fV="beforeWrite",pV="write",mV="afterWrite",gV=[aV,lV,cV,uV,dV,hV,fV,pV,mV];function yu(t){return t?(t.nodeName||"").toLowerCase():null}function ml(t){if(t==null)return window;if(t.toString()!=="[object Window]"){var e=t.ownerDocument;return e&&e.defaultView||window}return t}function wp(t){var e=ml(t).Element;return t instanceof e||t instanceof Element}function Ll(t){var e=ml(t).HTMLElement;return t instanceof e||t instanceof HTMLElement}function pP(t){if(typeof ShadowRoot>"u")return!1;var e=ml(t).ShadowRoot;return t instanceof e||t instanceof ShadowRoot}function Jde(t){var e=t.state;Object.keys(e.elements).forEach(function(n){var l=e.styles[n]||{},d=e.attributes[n]||{},f=e.elements[n];!Ll(f)||!yu(f)||(Object.assign(f.style,l),Object.keys(d).forEach(function(x){var s=d[x];s===!1?f.removeAttribute(x):f.setAttribute(x,s===!0?"":s)}))})}function Qde(t){var e=t.state,n={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(e.elements.popper.style,n.popper),e.styles=n,e.elements.arrow&&Object.assign(e.elements.arrow.style,n.arrow),function(){Object.keys(e.elements).forEach(function(l){var d=e.elements[l],f=e.attributes[l]||{},x=Object.keys(e.styles.hasOwnProperty(l)?e.styles[l]:n[l]),s=x.reduce(function(C,P){return C[P]="",C},{});!Ll(d)||!yu(d)||(Object.assign(d.style,s),Object.keys(f).forEach(function(C){d.removeAttribute(C)}))})}}const mP={name:"applyStyles",enabled:!0,phase:"write",fn:Jde,effect:Qde,requires:["computeStyles"]};function hu(t){return t.split("-")[0]}var mp=Math.max,Uw=Math.min,Hg=Math.round;function bI(){var t=navigator.userAgentData;return t!=null&&t.brands&&Array.isArray(t.brands)?t.brands.map(function(e){return e.brand+"/"+e.version}).join(" "):navigator.userAgent}function _V(){return!/^((?!chrome|android).)*safari/i.test(bI())}function Wg(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!1);var l=t.getBoundingClientRect(),d=1,f=1;e&&Ll(t)&&(d=t.offsetWidth>0&&Hg(l.width)/t.offsetWidth||1,f=t.offsetHeight>0&&Hg(l.height)/t.offsetHeight||1);var x=wp(t)?ml(t):window,s=x.visualViewport,C=!_V()&&n,P=(l.left+(C&&s?s.offsetLeft:0))/d,L=(l.top+(C&&s?s.offsetTop:0))/f,$=l.width/d,V=l.height/f;return{width:$,height:V,top:L,right:P+$,bottom:L+V,left:P,x:P,y:L}}function gP(t){var e=Wg(t),n=t.offsetWidth,l=t.offsetHeight;return Math.abs(e.width-n)<=1&&(n=e.width),Math.abs(e.height-l)<=1&&(l=e.height),{x:t.offsetLeft,y:t.offsetTop,width:n,height:l}}function yV(t,e){var n=e.getRootNode&&e.getRootNode();if(t.contains(e))return!0;if(n&&pP(n)){var l=e;do{if(l&&t.isSameNode(l))return!0;l=l.parentNode||l.host}while(l)}return!1}function Sd(t){return ml(t).getComputedStyle(t)}function ehe(t){return["table","td","th"].indexOf(yu(t))>=0}function df(t){return((wp(t)?t.ownerDocument:t.document)||window.document).documentElement}function UT(t){return yu(t)==="html"?t:t.assignedSlot||t.parentNode||(pP(t)?t.host:null)||df(t)}function O5(t){return!Ll(t)||Sd(t).position==="fixed"?null:t.offsetParent}function the(t){var e=/firefox/i.test(bI()),n=/Trident/i.test(bI());if(n&&Ll(t)){var l=Sd(t);if(l.position==="fixed")return null}var d=UT(t);for(pP(d)&&(d=d.host);Ll(d)&&["html","body"].indexOf(yu(d))<0;){var f=Sd(d);if(f.transform!=="none"||f.perspective!=="none"||f.contain==="paint"||["transform","perspective"].indexOf(f.willChange)!==-1||e&&f.willChange==="filter"||e&&f.filter&&f.filter!=="none")return d;d=d.parentNode}return null}function db(t){for(var e=ml(t),n=O5(t);n&&ehe(n)&&Sd(n).position==="static";)n=O5(n);return n&&(yu(n)==="html"||yu(n)==="body"&&Sd(n).position==="static")?e:n||the(t)||e}function _P(t){return["top","bottom"].indexOf(t)>=0?"x":"y"}function Mv(t,e,n){return mp(t,Uw(e,n))}function nhe(t,e,n){var l=Mv(t,e,n);return l>n?n:l}function vV(){return{top:0,right:0,bottom:0,left:0}}function bV(t){return Object.assign({},vV(),t)}function xV(t,e){return e.reduce(function(n,l){return n[l]=t,n},{})}var rhe=function(e,n){return e=typeof e=="function"?e(Object.assign({},n.rects,{placement:n.placement})):e,bV(typeof e!="number"?e:xV(e,a_))};function ihe(t){var e,n=t.state,l=t.name,d=t.options,f=n.elements.arrow,x=n.modifiersData.popperOffsets,s=hu(n.placement),C=_P(s),P=[Oa,pl].indexOf(s)>=0,L=P?"height":"width";if(!(!f||!x)){var $=rhe(d.padding,n),V=gP(f),j=C==="y"?ka:Oa,ue=C==="y"?fl:pl,de=n.rects.reference[L]+n.rects.reference[C]-x[C]-n.rects.popper[L],Te=x[C]-n.rects.reference[C],Be=db(f),Ge=Be?C==="y"?Be.clientHeight||0:Be.clientWidth||0:0,Ye=de/2-Te/2,Ne=$[j],Mt=Ge-V[L]-$[ue],kt=Ge/2-V[L]/2+Ye,Pe=Mv(Ne,kt,Mt),we=C;n.modifiersData[l]=(e={},e[we]=Pe,e.centerOffset=Pe-kt,e)}}function ohe(t){var e=t.state,n=t.options,l=n.element,d=l===void 0?"[data-popper-arrow]":l;d!=null&&(typeof d=="string"&&(d=e.elements.popper.querySelector(d),!d)||yV(e.elements.popper,d)&&(e.elements.arrow=d))}const wV={name:"arrow",enabled:!0,phase:"main",fn:ihe,effect:ohe,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function qg(t){return t.split("-")[1]}var she={top:"auto",right:"auto",bottom:"auto",left:"auto"};function ahe(t,e){var n=t.x,l=t.y,d=e.devicePixelRatio||1;return{x:Hg(n*d)/d||0,y:Hg(l*d)/d||0}}function M5(t){var e,n=t.popper,l=t.popperRect,d=t.placement,f=t.variation,x=t.offsets,s=t.position,C=t.gpuAcceleration,P=t.adaptive,L=t.roundOffsets,$=t.isFixed,V=x.x,j=V===void 0?0:V,ue=x.y,de=ue===void 0?0:ue,Te=typeof L=="function"?L({x:j,y:de}):{x:j,y:de};j=Te.x,de=Te.y;var Be=x.hasOwnProperty("x"),Ge=x.hasOwnProperty("y"),Ye=Oa,Ne=ka,Mt=window;if(P){var kt=db(n),Pe="clientHeight",we="clientWidth";if(kt===ml(n)&&(kt=df(n),Sd(kt).position!=="static"&&s==="absolute"&&(Pe="scrollHeight",we="scrollWidth")),kt=kt,d===ka||(d===Oa||d===pl)&&f===Gg){Ne=fl;var Se=$&&kt===Mt&&Mt.visualViewport?Mt.visualViewport.height:kt[Pe];de-=Se-l.height,de*=C?1:-1}if(d===Oa||(d===ka||d===fl)&&f===Gg){Ye=pl;var je=$&&kt===Mt&&Mt.visualViewport?Mt.visualViewport.width:kt[we];j-=je-l.width,j*=C?1:-1}}var Re=Object.assign({position:s},P&&she),Ve=L===!0?ahe({x:j,y:de},ml(n)):{x:j,y:de};if(j=Ve.x,de=Ve.y,C){var ke;return Object.assign({},Re,(ke={},ke[Ne]=Ge?"0":"",ke[Ye]=Be?"0":"",ke.transform=(Mt.devicePixelRatio||1)<=1?"translate("+j+"px, "+de+"px)":"translate3d("+j+"px, "+de+"px, 0)",ke))}return Object.assign({},Re,(e={},e[Ne]=Ge?de+"px":"",e[Ye]=Be?j+"px":"",e.transform="",e))}function lhe(t){var e=t.state,n=t.options,l=n.gpuAcceleration,d=l===void 0?!0:l,f=n.adaptive,x=f===void 0?!0:f,s=n.roundOffsets,C=s===void 0?!0:s,P={placement:hu(e.placement),variation:qg(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:d,isFixed:e.options.strategy==="fixed"};e.modifiersData.popperOffsets!=null&&(e.styles.popper=Object.assign({},e.styles.popper,M5(Object.assign({},P,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:x,roundOffsets:C})))),e.modifiersData.arrow!=null&&(e.styles.arrow=Object.assign({},e.styles.arrow,M5(Object.assign({},P,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:C})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})}const yP={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:lhe,data:{}};var wx={passive:!0};function che(t){var e=t.state,n=t.instance,l=t.options,d=l.scroll,f=d===void 0?!0:d,x=l.resize,s=x===void 0?!0:x,C=ml(e.elements.popper),P=[].concat(e.scrollParents.reference,e.scrollParents.popper);return f&&P.forEach(function(L){L.addEventListener("scroll",n.update,wx)}),s&&C.addEventListener("resize",n.update,wx),function(){f&&P.forEach(function(L){L.removeEventListener("scroll",n.update,wx)}),s&&C.removeEventListener("resize",n.update,wx)}}const vP={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:che,data:{}};var uhe={left:"right",right:"left",bottom:"top",top:"bottom"};function Jx(t){return t.replace(/left|right|bottom|top/g,function(e){return uhe[e]})}var dhe={start:"end",end:"start"};function D5(t){return t.replace(/start|end/g,function(e){return dhe[e]})}function bP(t){var e=ml(t),n=e.pageXOffset,l=e.pageYOffset;return{scrollLeft:n,scrollTop:l}}function xP(t){return Wg(df(t)).left+bP(t).scrollLeft}function hhe(t,e){var n=ml(t),l=df(t),d=n.visualViewport,f=l.clientWidth,x=l.clientHeight,s=0,C=0;if(d){f=d.width,x=d.height;var P=_V();(P||!P&&e==="fixed")&&(s=d.offsetLeft,C=d.offsetTop)}return{width:f,height:x,x:s+xP(t),y:C}}function fhe(t){var e,n=df(t),l=bP(t),d=(e=t.ownerDocument)==null?void 0:e.body,f=mp(n.scrollWidth,n.clientWidth,d?d.scrollWidth:0,d?d.clientWidth:0),x=mp(n.scrollHeight,n.clientHeight,d?d.scrollHeight:0,d?d.clientHeight:0),s=-l.scrollLeft+xP(t),C=-l.scrollTop;return Sd(d||n).direction==="rtl"&&(s+=mp(n.clientWidth,d?d.clientWidth:0)-f),{width:f,height:x,x:s,y:C}}function wP(t){var e=Sd(t),n=e.overflow,l=e.overflowX,d=e.overflowY;return/auto|scroll|overlay|hidden/.test(n+d+l)}function TV(t){return["html","body","#document"].indexOf(yu(t))>=0?t.ownerDocument.body:Ll(t)&&wP(t)?t:TV(UT(t))}function Dv(t,e){var n;e===void 0&&(e=[]);var l=TV(t),d=l===((n=t.ownerDocument)==null?void 0:n.body),f=ml(l),x=d?[f].concat(f.visualViewport||[],wP(l)?l:[]):l,s=e.concat(x);return d?s:s.concat(Dv(UT(x)))}function xI(t){return Object.assign({},t,{left:t.x,top:t.y,right:t.x+t.width,bottom:t.y+t.height})}function phe(t,e){var n=Wg(t,!1,e==="fixed");return n.top=n.top+t.clientTop,n.left=n.left+t.clientLeft,n.bottom=n.top+t.clientHeight,n.right=n.left+t.clientWidth,n.width=t.clientWidth,n.height=t.clientHeight,n.x=n.left,n.y=n.top,n}function L5(t,e,n){return e===hP?xI(hhe(t,n)):wp(e)?phe(e,n):xI(fhe(df(t)))}function mhe(t){var e=Dv(UT(t)),n=["absolute","fixed"].indexOf(Sd(t).position)>=0,l=n&&Ll(t)?db(t):t;return wp(l)?e.filter(function(d){return wp(d)&&yV(d,l)&&yu(d)!=="body"}):[]}function ghe(t,e,n,l){var d=e==="clippingParents"?mhe(t):[].concat(e),f=[].concat(d,[n]),x=f[0],s=f.reduce(function(C,P){var L=L5(t,P,l);return C.top=mp(L.top,C.top),C.right=Uw(L.right,C.right),C.bottom=Uw(L.bottom,C.bottom),C.left=mp(L.left,C.left),C},L5(t,x,l));return s.width=s.right-s.left,s.height=s.bottom-s.top,s.x=s.left,s.y=s.top,s}function SV(t){var e=t.reference,n=t.element,l=t.placement,d=l?hu(l):null,f=l?qg(l):null,x=e.x+e.width/2-n.width/2,s=e.y+e.height/2-n.height/2,C;switch(d){case ka:C={x,y:e.y-n.height};break;case fl:C={x,y:e.y+e.height};break;case pl:C={x:e.x+e.width,y:s};break;case Oa:C={x:e.x-n.width,y:s};break;default:C={x:e.x,y:e.y}}var P=d?_P(d):null;if(P!=null){var L=P==="y"?"height":"width";switch(f){case xp:C[P]=C[P]-(e[L]/2-n[L]/2);break;case Gg:C[P]=C[P]+(e[L]/2-n[L]/2);break}}return C}function Kg(t,e){e===void 0&&(e={});var n=e,l=n.placement,d=l===void 0?t.placement:l,f=n.strategy,x=f===void 0?t.strategy:f,s=n.boundary,C=s===void 0?oV:s,P=n.rootBoundary,L=P===void 0?hP:P,$=n.elementContext,V=$===void 0?dg:$,j=n.altBoundary,ue=j===void 0?!1:j,de=n.padding,Te=de===void 0?0:de,Be=bV(typeof Te!="number"?Te:xV(Te,a_)),Ge=V===dg?sV:dg,Ye=t.rects.popper,Ne=t.elements[ue?Ge:V],Mt=ghe(wp(Ne)?Ne:Ne.contextElement||df(t.elements.popper),C,L,x),kt=Wg(t.elements.reference),Pe=SV({reference:kt,element:Ye,placement:d}),we=xI(Object.assign({},Ye,Pe)),Se=V===dg?we:kt,je={top:Mt.top-Se.top+Be.top,bottom:Se.bottom-Mt.bottom+Be.bottom,left:Mt.left-Se.left+Be.left,right:Se.right-Mt.right+Be.right},Re=t.modifiersData.offset;if(V===dg&&Re){var Ve=Re[d];Object.keys(je).forEach(function(ke){var Mn=[pl,fl].indexOf(ke)>=0?1:-1,bn=[ka,fl].indexOf(ke)>=0?"y":"x";je[ke]+=Ve[bn]*Mn})}return je}function _he(t,e){e===void 0&&(e={});var n=e,l=n.placement,d=n.boundary,f=n.rootBoundary,x=n.padding,s=n.flipVariations,C=n.allowedAutoPlacements,P=C===void 0?fP:C,L=qg(l),$=L?s?vI:vI.filter(function(ue){return qg(ue)===L}):a_,V=$.filter(function(ue){return P.indexOf(ue)>=0});V.length===0&&(V=$);var j=V.reduce(function(ue,de){return ue[de]=Kg(t,{placement:de,boundary:d,rootBoundary:f,padding:x})[hu(de)],ue},{});return Object.keys(j).sort(function(ue,de){return j[ue]-j[de]})}function yhe(t){if(hu(t)===$T)return[];var e=Jx(t);return[D5(t),e,D5(e)]}function vhe(t){var e=t.state,n=t.options,l=t.name;if(!e.modifiersData[l]._skip){for(var d=n.mainAxis,f=d===void 0?!0:d,x=n.altAxis,s=x===void 0?!0:x,C=n.fallbackPlacements,P=n.padding,L=n.boundary,$=n.rootBoundary,V=n.altBoundary,j=n.flipVariations,ue=j===void 0?!0:j,de=n.allowedAutoPlacements,Te=e.options.placement,Be=hu(Te),Ge=Be===Te,Ye=C||(Ge||!ue?[Jx(Te)]:yhe(Te)),Ne=[Te].concat(Ye).reduce(function(uo,Gi){return uo.concat(hu(Gi)===$T?_he(e,{placement:Gi,boundary:L,rootBoundary:$,padding:P,flipVariations:ue,allowedAutoPlacements:de}):Gi)},[]),Mt=e.rects.reference,kt=e.rects.popper,Pe=new Map,we=!0,Se=Ne[0],je=0;je<Ne.length;je++){var Re=Ne[je],Ve=hu(Re),ke=qg(Re)===xp,Mn=[ka,fl].indexOf(Ve)>=0,bn=Mn?"width":"height",mn=Kg(e,{placement:Re,boundary:L,rootBoundary:$,altBoundary:V,padding:P}),Sn=Mn?ke?pl:Oa:ke?fl:ka;Mt[bn]>kt[bn]&&(Sn=Jx(Sn));var ar=Jx(Sn),Br=[];if(f&&Br.push(mn[Ve]<=0),s&&Br.push(mn[Sn]<=0,mn[ar]<=0),Br.every(function(uo){return uo})){Se=Re,we=!1;break}Pe.set(Re,Br)}if(we)for(var ei=ue?3:1,or=function(Gi){var ur=Ne.find(function(Ot){var ln=Pe.get(Ot);if(ln)return ln.slice(0,Gi).every(function(yn){return yn})});if(ur)return Se=ur,"break"},vr=ei;vr>0;vr--){var oi=or(vr);if(oi==="break")break}e.placement!==Se&&(e.modifiersData[l]._skip=!0,e.placement=Se,e.reset=!0)}}const EV={name:"flip",enabled:!0,phase:"main",fn:vhe,requiresIfExists:["offset"],data:{_skip:!1}};function z5(t,e,n){return n===void 0&&(n={x:0,y:0}),{top:t.top-e.height-n.y,right:t.right-e.width+n.x,bottom:t.bottom-e.height+n.y,left:t.left-e.width-n.x}}function F5(t){return[ka,pl,fl,Oa].some(function(e){return t[e]>=0})}function bhe(t){var e=t.state,n=t.name,l=e.rects.reference,d=e.rects.popper,f=e.modifiersData.preventOverflow,x=Kg(e,{elementContext:"reference"}),s=Kg(e,{altBoundary:!0}),C=z5(x,l),P=z5(s,d,f),L=F5(C),$=F5(P);e.modifiersData[n]={referenceClippingOffsets:C,popperEscapeOffsets:P,isReferenceHidden:L,hasPopperEscaped:$},e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-reference-hidden":L,"data-popper-escaped":$})}const CV={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:bhe};function xhe(t,e,n){var l=hu(t),d=[Oa,ka].indexOf(l)>=0?-1:1,f=typeof n=="function"?n(Object.assign({},e,{placement:t})):n,x=f[0],s=f[1];return x=x||0,s=(s||0)*d,[Oa,pl].indexOf(l)>=0?{x:s,y:x}:{x,y:s}}function whe(t){var e=t.state,n=t.options,l=t.name,d=n.offset,f=d===void 0?[0,0]:d,x=fP.reduce(function(L,$){return L[$]=xhe($,e.rects,f),L},{}),s=x[e.placement],C=s.x,P=s.y;e.modifiersData.popperOffsets!=null&&(e.modifiersData.popperOffsets.x+=C,e.modifiersData.popperOffsets.y+=P),e.modifiersData[l]=x}const IV={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:whe};function The(t){var e=t.state,n=t.name;e.modifiersData[n]=SV({reference:e.rects.reference,element:e.rects.popper,placement:e.placement})}const TP={name:"popperOffsets",enabled:!0,phase:"read",fn:The,data:{}};function She(t){return t==="x"?"y":"x"}function Ehe(t){var e=t.state,n=t.options,l=t.name,d=n.mainAxis,f=d===void 0?!0:d,x=n.altAxis,s=x===void 0?!1:x,C=n.boundary,P=n.rootBoundary,L=n.altBoundary,$=n.padding,V=n.tether,j=V===void 0?!0:V,ue=n.tetherOffset,de=ue===void 0?0:ue,Te=Kg(e,{boundary:C,rootBoundary:P,padding:$,altBoundary:L}),Be=hu(e.placement),Ge=qg(e.placement),Ye=!Ge,Ne=_P(Be),Mt=She(Ne),kt=e.modifiersData.popperOffsets,Pe=e.rects.reference,we=e.rects.popper,Se=typeof de=="function"?de(Object.assign({},e.rects,{placement:e.placement})):de,je=typeof Se=="number"?{mainAxis:Se,altAxis:Se}:Object.assign({mainAxis:0,altAxis:0},Se),Re=e.modifiersData.offset?e.modifiersData.offset[e.placement]:null,Ve={x:0,y:0};if(kt){if(f){var ke,Mn=Ne==="y"?ka:Oa,bn=Ne==="y"?fl:pl,mn=Ne==="y"?"height":"width",Sn=kt[Ne],ar=Sn+Te[Mn],Br=Sn-Te[bn],ei=j?-we[mn]/2:0,or=Ge===xp?Pe[mn]:we[mn],vr=Ge===xp?-we[mn]:-Pe[mn],oi=e.elements.arrow,uo=j&&oi?gP(oi):{width:0,height:0},Gi=e.modifiersData["arrow#persistent"]?e.modifiersData["arrow#persistent"].padding:vV(),ur=Gi[Mn],Ot=Gi[bn],ln=Mv(0,Pe[mn],uo[mn]),yn=Ye?Pe[mn]/2-ei-ln-ur-je.mainAxis:or-ln-ur-je.mainAxis,vn=Ye?-Pe[mn]/2+ei+ln+Ot+je.mainAxis:vr+ln+Ot+je.mainAxis,Nr=e.elements.arrow&&db(e.elements.arrow),He=Nr?Ne==="y"?Nr.clientTop||0:Nr.clientLeft||0:0,Qe=(ke=Re?.[Ne])!=null?ke:0,dt=Sn+yn-Qe-He,Lt=Sn+vn-Qe,qt=Mv(j?Uw(ar,dt):ar,Sn,j?mp(Br,Lt):Br);kt[Ne]=qt,Ve[Ne]=qt-Sn}if(s){var jt,Rn=Ne==="x"?ka:Oa,fn=Ne==="x"?fl:pl,cn=kt[Mt],Zt=Mt==="y"?"height":"width",Xn=cn+Te[Rn],En=cn-Te[fn],jn=[ka,Oa].indexOf(Be)!==-1,dr=(jt=Re?.[Mt])!=null?jt:0,Gn=jn?Xn:cn-Pe[Zt]-we[Zt]-dr+je.altAxis,hr=jn?cn+Pe[Zt]+we[Zt]-dr-je.altAxis:En,Yr=j&&jn?nhe(Gn,cn,hr):Mv(j?Gn:Xn,cn,j?hr:En);kt[Mt]=Yr,Ve[Mt]=Yr-cn}e.modifiersData[l]=Ve}}const AV={name:"preventOverflow",enabled:!0,phase:"main",fn:Ehe,requiresIfExists:["offset"]};function Che(t){return{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}}function Ihe(t){return t===ml(t)||!Ll(t)?bP(t):Che(t)}function Ahe(t){var e=t.getBoundingClientRect(),n=Hg(e.width)/t.offsetWidth||1,l=Hg(e.height)/t.offsetHeight||1;return n!==1||l!==1}function Phe(t,e,n){n===void 0&&(n=!1);var l=Ll(e),d=Ll(e)&&Ahe(e),f=df(e),x=Wg(t,d,n),s={scrollLeft:0,scrollTop:0},C={x:0,y:0};return(l||!l&&!n)&&((yu(e)!=="body"||wP(f))&&(s=Ihe(e)),Ll(e)?(C=Wg(e,!0),C.x+=e.clientLeft,C.y+=e.clientTop):f&&(C.x=xP(f))),{x:x.left+s.scrollLeft-C.x,y:x.top+s.scrollTop-C.y,width:x.width,height:x.height}}function Rhe(t){var e=new Map,n=new Set,l=[];t.forEach(function(f){e.set(f.name,f)});function d(f){n.add(f.name);var x=[].concat(f.requires||[],f.requiresIfExists||[]);x.forEach(function(s){if(!n.has(s)){var C=e.get(s);C&&d(C)}}),l.push(f)}return t.forEach(function(f){n.has(f.name)||d(f)}),l}function khe(t){var e=Rhe(t);return gV.reduce(function(n,l){return n.concat(e.filter(function(d){return d.phase===l}))},[])}function Ohe(t){var e;return function(){return e||(e=new Promise(function(n){Promise.resolve().then(function(){e=void 0,n(t())})})),e}}function Mhe(t){var e=t.reduce(function(n,l){var d=n[l.name];return n[l.name]=d?Object.assign({},d,l,{options:Object.assign({},d.options,l.options),data:Object.assign({},d.data,l.data)}):l,n},{});return Object.keys(e).map(function(n){return e[n]})}var B5={placement:"bottom",modifiers:[],strategy:"absolute"};function N5(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return!e.some(function(l){return!(l&&typeof l.getBoundingClientRect=="function")})}function jT(t){t===void 0&&(t={});var e=t,n=e.defaultModifiers,l=n===void 0?[]:n,d=e.defaultOptions,f=d===void 0?B5:d;return function(s,C,P){P===void 0&&(P=f);var L={placement:"bottom",orderedModifiers:[],options:Object.assign({},B5,f),modifiersData:{},elements:{reference:s,popper:C},attributes:{},styles:{}},$=[],V=!1,j={state:L,setOptions:function(Be){var Ge=typeof Be=="function"?Be(L.options):Be;de(),L.options=Object.assign({},f,L.options,Ge),L.scrollParents={reference:wp(s)?Dv(s):s.contextElement?Dv(s.contextElement):[],popper:Dv(C)};var Ye=khe(Mhe([].concat(l,L.options.modifiers)));return L.orderedModifiers=Ye.filter(function(Ne){return Ne.enabled}),ue(),j.update()},forceUpdate:function(){if(!V){var Be=L.elements,Ge=Be.reference,Ye=Be.popper;if(N5(Ge,Ye)){L.rects={reference:Phe(Ge,db(Ye),L.options.strategy==="fixed"),popper:gP(Ye)},L.reset=!1,L.placement=L.options.placement,L.orderedModifiers.forEach(function(je){return L.modifiersData[je.name]=Object.assign({},je.data)});for(var Ne=0;Ne<L.orderedModifiers.length;Ne++){if(L.reset===!0){L.reset=!1,Ne=-1;continue}var Mt=L.orderedModifiers[Ne],kt=Mt.fn,Pe=Mt.options,we=Pe===void 0?{}:Pe,Se=Mt.name;typeof kt=="function"&&(L=kt({state:L,options:we,name:Se,instance:j})||L)}}}},update:Ohe(function(){return new Promise(function(Te){j.forceUpdate(),Te(L)})}),destroy:function(){de(),V=!0}};if(!N5(s,C))return j;j.setOptions(P).then(function(Te){!V&&P.onFirstUpdate&&P.onFirstUpdate(Te)});function ue(){L.orderedModifiers.forEach(function(Te){var Be=Te.name,Ge=Te.options,Ye=Ge===void 0?{}:Ge,Ne=Te.effect;if(typeof Ne=="function"){var Mt=Ne({state:L,name:Be,instance:j,options:Ye}),kt=function(){};$.push(Mt||kt)}})}function de(){$.forEach(function(Te){return Te()}),$=[]}return j}}var Dhe=jT(),Lhe=[vP,TP,yP,mP],zhe=jT({defaultModifiers:Lhe}),Fhe=[vP,TP,yP,mP,IV,EV,AV,wV,CV],SP=jT({defaultModifiers:Fhe});const PV=Object.freeze(Object.defineProperty({__proto__:null,afterMain:hV,afterRead:cV,afterWrite:mV,applyStyles:mP,arrow:wV,auto:$T,basePlacements:a_,beforeMain:uV,beforeRead:aV,beforeWrite:fV,bottom:fl,clippingParents:oV,computeStyles:yP,createPopper:SP,createPopperBase:Dhe,createPopperLite:zhe,detectOverflow:Kg,end:Gg,eventListeners:vP,flip:EV,hide:CV,left:Oa,main:dV,modifierPhases:gV,offset:IV,placements:fP,popper:dg,popperGenerator:jT,popperOffsets:TP,preventOverflow:AV,read:lV,reference:sV,right:pl,start:xp,top:ka,variationPlacements:vI,viewport:hP,write:pV},Symbol.toStringTag,{value:"Module"}));/*!
  * Bootstrap v5.3.8 (https://getbootstrap.com/)
  * Copyright 2011-2025 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */const wh=new Map,TC={set(t,e,n){wh.has(t)||wh.set(t,new Map);const l=wh.get(t);if(!l.has(e)&&l.size!==0){console.error(`Bootstrap doesn't allow more than one instance per element. Bound instance: ${Array.from(l.keys())[0]}.`);return}l.set(e,n)},get(t,e){return wh.has(t)&&wh.get(t).get(e)||null},remove(t,e){if(!wh.has(t))return;const n=wh.get(t);n.delete(e),n.size===0&&wh.delete(t)}},Bhe=1e6,Nhe=1e3,wI="transitionend",RV=t=>(t&&window.CSS&&window.CSS.escape&&(t=t.replace(/#([^\s"#']+)/g,(e,n)=>`#${CSS.escape(n)}`)),t),Vhe=t=>t==null?`${t}`:Object.prototype.toString.call(t).match(/\s([a-z]+)/i)[1].toLowerCase(),$he=t=>{do t+=Math.floor(Math.random()*Bhe);while(document.getElementById(t));return t},Uhe=t=>{if(!t)return 0;let{transitionDuration:e,transitionDelay:n}=window.getComputedStyle(t);const l=Number.parseFloat(e),d=Number.parseFloat(n);return!l&&!d?0:(e=e.split(",")[0],n=n.split(",")[0],(Number.parseFloat(e)+Number.parseFloat(n))*Nhe)},kV=t=>{t.dispatchEvent(new Event(wI))},gd=t=>!t||typeof t!="object"?!1:(typeof t.jquery<"u"&&(t=t[0]),typeof t.nodeType<"u"),ef=t=>gd(t)?t.jquery?t[0]:t:typeof t=="string"&&t.length>0?document.querySelector(RV(t)):null,l_=t=>{if(!gd(t)||t.getClientRects().length===0)return!1;const e=getComputedStyle(t).getPropertyValue("visibility")==="visible",n=t.closest("details:not([open])");if(!n)return e;if(n!==t){const l=t.closest("summary");if(l&&l.parentNode!==n||l===null)return!1}return e},tf=t=>!t||t.nodeType!==Node.ELEMENT_NODE||t.classList.contains("disabled")?!0:typeof t.disabled<"u"?t.disabled:t.hasAttribute("disabled")&&t.getAttribute("disabled")!=="false",OV=t=>{if(!document.documentElement.attachShadow)return null;if(typeof t.getRootNode=="function"){const e=t.getRootNode();return e instanceof ShadowRoot?e:null}return t instanceof ShadowRoot?t:t.parentNode?OV(t.parentNode):null},jw=()=>{},hb=t=>{t.offsetHeight},MV=()=>window.jQuery&&!document.body.hasAttribute("data-bs-no-jquery")?window.jQuery:null,SC=[],jhe=t=>{document.readyState==="loading"?(SC.length||document.addEventListener("DOMContentLoaded",()=>{for(const e of SC)e()}),SC.push(t)):t()},Bl=()=>document.documentElement.dir==="rtl",$l=t=>{jhe(()=>{const e=MV();if(e){const n=t.NAME,l=e.fn[n];e.fn[n]=t.jQueryInterface,e.fn[n].Constructor=t,e.fn[n].noConflict=()=>(e.fn[n]=l,t.jQueryInterface)}})},Ua=(t,e=[],n=t)=>typeof t=="function"?t.call(...e):n,DV=(t,e,n=!0)=>{if(!n){Ua(t);return}const d=Uhe(e)+5;let f=!1;const x=({target:s})=>{s===e&&(f=!0,e.removeEventListener(wI,x),Ua(t))};e.addEventListener(wI,x),setTimeout(()=>{f||kV(e)},d)},EP=(t,e,n,l)=>{const d=t.length;let f=t.indexOf(e);return f===-1?!n&&l?t[d-1]:t[0]:(f+=n?1:-1,l&&(f=(f+d)%d),t[Math.max(0,Math.min(f,d-1))])},Ghe=/[^.]*(?=\..*)\.|.*/,Hhe=/\..*/,Whe=/::\d+$/,EC={};let V5=1;const LV={mouseenter:"mouseover",mouseleave:"mouseout"},qhe=new Set(["click","dblclick","mouseup","mousedown","contextmenu","mousewheel","DOMMouseScroll","mouseover","mouseout","mousemove","selectstart","selectend","keydown","keypress","keyup","orientationchange","touchstart","touchmove","touchend","touchcancel","pointerdown","pointermove","pointerup","pointerleave","pointercancel","gesturestart","gesturechange","gestureend","focus","blur","change","reset","select","submit","focusin","focusout","load","unload","beforeunload","resize","move","DOMContentLoaded","readystatechange","error","abort","scroll"]);function zV(t,e){return e&&`${e}::${V5++}`||t.uidEvent||V5++}function FV(t){const e=zV(t);return t.uidEvent=e,EC[e]=EC[e]||{},EC[e]}function Khe(t,e){return function n(l){return CP(l,{delegateTarget:t}),n.oneOff&&pn.off(t,l.type,e),e.apply(t,[l])}}function Zhe(t,e,n){return function l(d){const f=t.querySelectorAll(e);for(let{target:x}=d;x&&x!==this;x=x.parentNode)for(const s of f)if(s===x)return CP(d,{delegateTarget:x}),l.oneOff&&pn.off(t,d.type,e,n),n.apply(x,[d])}}function BV(t,e,n=null){return Object.values(t).find(l=>l.callable===e&&l.delegationSelector===n)}function NV(t,e,n){const l=typeof e=="string",d=l?n:e||n;let f=VV(t);return qhe.has(f)||(f=t),[l,d,f]}function $5(t,e,n,l,d){if(typeof e!="string"||!t)return;let[f,x,s]=NV(e,n,l);e in LV&&(x=(ue=>function(de){if(!de.relatedTarget||de.relatedTarget!==de.delegateTarget&&!de.delegateTarget.contains(de.relatedTarget))return ue.call(this,de)})(x));const C=FV(t),P=C[s]||(C[s]={}),L=BV(P,x,f?n:null);if(L){L.oneOff=L.oneOff&&d;return}const $=zV(x,e.replace(Ghe,"")),V=f?Zhe(t,n,x):Khe(t,x);V.delegationSelector=f?n:null,V.callable=x,V.oneOff=d,V.uidEvent=$,P[$]=V,t.addEventListener(s,V,f)}function TI(t,e,n,l,d){const f=BV(e[n],l,d);f&&(t.removeEventListener(n,f,!!d),delete e[n][f.uidEvent])}function Xhe(t,e,n,l){const d=e[n]||{};for(const[f,x]of Object.entries(d))f.includes(l)&&TI(t,e,n,x.callable,x.delegationSelector)}function VV(t){return t=t.replace(Hhe,""),LV[t]||t}const pn={on(t,e,n,l){$5(t,e,n,l,!1)},one(t,e,n,l){$5(t,e,n,l,!0)},off(t,e,n,l){if(typeof e!="string"||!t)return;const[d,f,x]=NV(e,n,l),s=x!==e,C=FV(t),P=C[x]||{},L=e.startsWith(".");if(typeof f<"u"){if(!Object.keys(P).length)return;TI(t,C,x,f,d?n:null);return}if(L)for(const $ of Object.keys(C))Xhe(t,C,$,e.slice(1));for(const[$,V]of Object.entries(P)){const j=$.replace(Whe,"");(!s||e.includes(j))&&TI(t,C,x,V.callable,V.delegationSelector)}},trigger(t,e,n){if(typeof e!="string"||!t)return null;const l=MV(),d=VV(e),f=e!==d;let x=null,s=!0,C=!0,P=!1;f&&l&&(x=l.Event(e,n),l(t).trigger(x),s=!x.isPropagationStopped(),C=!x.isImmediatePropagationStopped(),P=x.isDefaultPrevented());const L=CP(new Event(e,{bubbles:s,cancelable:!0}),n);return P&&L.preventDefault(),C&&t.dispatchEvent(L),L.defaultPrevented&&x&&x.preventDefault(),L}};function CP(t,e={}){for(const[n,l]of Object.entries(e))try{t[n]=l}catch{Object.defineProperty(t,n,{configurable:!0,get(){return l}})}return t}function U5(t){if(t==="true")return!0;if(t==="false")return!1;if(t===Number(t).toString())return Number(t);if(t===""||t==="null")return null;if(typeof t!="string")return t;try{return JSON.parse(decodeURIComponent(t))}catch{return t}}function CC(t){return t.replace(/[A-Z]/g,e=>`-${e.toLowerCase()}`)}const _d={setDataAttribute(t,e,n){t.setAttribute(`data-bs-${CC(e)}`,n)},removeDataAttribute(t,e){t.removeAttribute(`data-bs-${CC(e)}`)},getDataAttributes(t){if(!t)return{};const e={},n=Object.keys(t.dataset).filter(l=>l.startsWith("bs")&&!l.startsWith("bsConfig"));for(const l of n){let d=l.replace(/^bs/,"");d=d.charAt(0).toLowerCase()+d.slice(1),e[d]=U5(t.dataset[l])}return e},getDataAttribute(t,e){return U5(t.getAttribute(`data-bs-${CC(e)}`))}};class fb{static get Default(){return{}}static get DefaultType(){return{}}static get NAME(){throw new Error('You have to implement the static method "NAME", for each component!')}_getConfig(e){return e=this._mergeConfigObj(e),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}_configAfterMerge(e){return e}_mergeConfigObj(e,n){const l=gd(n)?_d.getDataAttribute(n,"config"):{};return{...this.constructor.Default,...typeof l=="object"?l:{},...gd(n)?_d.getDataAttributes(n):{},...typeof e=="object"?e:{}}}_typeCheckConfig(e,n=this.constructor.DefaultType){for(const[l,d]of Object.entries(n)){const f=e[l],x=gd(f)?"element":Vhe(f);if(!new RegExp(d).test(x))throw new TypeError(`${this.constructor.NAME.toUpperCase()}: Option "${l}" provided type "${x}" but expected type "${d}".`)}}}const Yhe="5.3.8";class vc extends fb{constructor(e,n){super(),e=ef(e),e&&(this._element=e,this._config=this._getConfig(n),TC.set(this._element,this.constructor.DATA_KEY,this))}dispose(){TC.remove(this._element,this.constructor.DATA_KEY),pn.off(this._element,this.constructor.EVENT_KEY);for(const e of Object.getOwnPropertyNames(this))this[e]=null}_queueCallback(e,n,l=!0){DV(e,n,l)}_getConfig(e){return e=this._mergeConfigObj(e,this._element),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}static getInstance(e){return TC.get(ef(e),this.DATA_KEY)}static getOrCreateInstance(e,n={}){return this.getInstance(e)||new this(e,typeof n=="object"?n:null)}static get VERSION(){return Yhe}static get DATA_KEY(){return`bs.${this.NAME}`}static get EVENT_KEY(){return`.${this.DATA_KEY}`}static eventName(e){return`${e}${this.EVENT_KEY}`}}const IC=t=>{let e=t.getAttribute("data-bs-target");if(!e||e==="#"){let n=t.getAttribute("href");if(!n||!n.includes("#")&&!n.startsWith("."))return null;n.includes("#")&&!n.startsWith("#")&&(n=`#${n.split("#")[1]}`),e=n&&n!=="#"?n.trim():null}return e?e.split(",").map(n=>RV(n)).join(","):null},Ir={find(t,e=document.documentElement){return[].concat(...Element.prototype.querySelectorAll.call(e,t))},findOne(t,e=document.documentElement){return Element.prototype.querySelector.call(e,t)},children(t,e){return[].concat(...t.children).filter(n=>n.matches(e))},parents(t,e){const n=[];let l=t.parentNode.closest(e);for(;l;)n.push(l),l=l.parentNode.closest(e);return n},prev(t,e){let n=t.previousElementSibling;for(;n;){if(n.matches(e))return[n];n=n.previousElementSibling}return[]},next(t,e){let n=t.nextElementSibling;for(;n;){if(n.matches(e))return[n];n=n.nextElementSibling}return[]},focusableChildren(t){const e=["a","button","input","textarea","select","details","[tabindex]",'[contenteditable="true"]'].map(n=>`${n}:not([tabindex^="-"])`).join(",");return this.find(e,t).filter(n=>!tf(n)&&l_(n))},getSelectorFromElement(t){const e=IC(t);return e&&Ir.findOne(e)?e:null},getElementFromSelector(t){const e=IC(t);return e?Ir.findOne(e):null},getMultipleElementsFromSelector(t){const e=IC(t);return e?Ir.find(e):[]}},GT=(t,e="hide")=>{const n=`click.dismiss${t.EVENT_KEY}`,l=t.NAME;pn.on(document,n,`[data-bs-dismiss="${l}"]`,function(d){if(["A","AREA"].includes(this.tagName)&&d.preventDefault(),tf(this))return;const f=Ir.getElementFromSelector(this)||this.closest(`.${l}`);t.getOrCreateInstance(f)[e]()})},Jhe="alert",Qhe="bs.alert",$V=`.${Qhe}`,efe=`close${$V}`,tfe=`closed${$V}`,nfe="fade",rfe="show";class HT extends vc{static get NAME(){return Jhe}close(){if(pn.trigger(this._element,efe).defaultPrevented)return;this._element.classList.remove(rfe);const n=this._element.classList.contains(nfe);this._queueCallback(()=>this._destroyElement(),this._element,n)}_destroyElement(){this._element.remove(),pn.trigger(this._element,tfe),this.dispose()}static jQueryInterface(e){return this.each(function(){const n=HT.getOrCreateInstance(this);if(typeof e=="string"){if(n[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);n[e](this)}})}}GT(HT,"close");$l(HT);const ife="button",ofe="bs.button",sfe=`.${ofe}`,afe=".data-api",lfe="active",j5='[data-bs-toggle="button"]',cfe=`click${sfe}${afe}`;class WT extends vc{static get NAME(){return ife}toggle(){this._element.setAttribute("aria-pressed",this._element.classList.toggle(lfe))}static jQueryInterface(e){return this.each(function(){const n=WT.getOrCreateInstance(this);e==="toggle"&&n[e]()})}}pn.on(document,cfe,j5,t=>{t.preventDefault();const e=t.target.closest(j5);WT.getOrCreateInstance(e).toggle()});$l(WT);const ufe="swipe",c_=".bs.swipe",dfe=`touchstart${c_}`,hfe=`touchmove${c_}`,ffe=`touchend${c_}`,pfe=`pointerdown${c_}`,mfe=`pointerup${c_}`,gfe="touch",_fe="pen",yfe="pointer-event",vfe=40,bfe={endCallback:null,leftCallback:null,rightCallback:null},xfe={endCallback:"(function|null)",leftCallback:"(function|null)",rightCallback:"(function|null)"};class Gw extends fb{constructor(e,n){super(),this._element=e,!(!e||!Gw.isSupported())&&(this._config=this._getConfig(n),this._deltaX=0,this._supportPointerEvents=!!window.PointerEvent,this._initEvents())}static get Default(){return bfe}static get DefaultType(){return xfe}static get NAME(){return ufe}dispose(){pn.off(this._element,c_)}_start(e){if(!this._supportPointerEvents){this._deltaX=e.touches[0].clientX;return}this._eventIsPointerPenTouch(e)&&(this._deltaX=e.clientX)}_end(e){this._eventIsPointerPenTouch(e)&&(this._deltaX=e.clientX-this._deltaX),this._handleSwipe(),Ua(this._config.endCallback)}_move(e){this._deltaX=e.touches&&e.touches.length>1?0:e.touches[0].clientX-this._deltaX}_handleSwipe(){const e=Math.abs(this._deltaX);if(e<=vfe)return;const n=e/this._deltaX;this._deltaX=0,n&&Ua(n>0?this._config.rightCallback:this._config.leftCallback)}_initEvents(){this._supportPointerEvents?(pn.on(this._element,pfe,e=>this._start(e)),pn.on(this._element,mfe,e=>this._end(e)),this._element.classList.add(yfe)):(pn.on(this._element,dfe,e=>this._start(e)),pn.on(this._element,hfe,e=>this._move(e)),pn.on(this._element,ffe,e=>this._end(e)))}_eventIsPointerPenTouch(e){return this._supportPointerEvents&&(e.pointerType===_fe||e.pointerType===gfe)}static isSupported(){return"ontouchstart"in document.documentElement||navigator.maxTouchPoints>0}}const wfe="carousel",Tfe="bs.carousel",hf=`.${Tfe}`,UV=".data-api",Sfe="ArrowLeft",Efe="ArrowRight",Cfe=500,nv="next",eg="prev",hg="left",Qx="right",Ife=`slide${hf}`,AC=`slid${hf}`,Afe=`keydown${hf}`,Pfe=`mouseenter${hf}`,Rfe=`mouseleave${hf}`,kfe=`dragstart${hf}`,Ofe=`load${hf}${UV}`,Mfe=`click${hf}${UV}`,jV="carousel",Tx="active",Dfe="slide",Lfe="carousel-item-end",zfe="carousel-item-start",Ffe="carousel-item-next",Bfe="carousel-item-prev",GV=".active",HV=".carousel-item",Nfe=GV+HV,Vfe=".carousel-item img",$fe=".carousel-indicators",Ufe="[data-bs-slide], [data-bs-slide-to]",jfe='[data-bs-ride="carousel"]',Gfe={[Sfe]:Qx,[Efe]:hg},Hfe={interval:5e3,keyboard:!0,pause:"hover",ride:!1,touch:!0,wrap:!0},Wfe={interval:"(number|boolean)",keyboard:"boolean",pause:"(string|boolean)",ride:"(boolean|string)",touch:"boolean",wrap:"boolean"};class pb extends vc{constructor(e,n){super(e,n),this._interval=null,this._activeElement=null,this._isSliding=!1,this.touchTimeout=null,this._swipeHelper=null,this._indicatorsElement=Ir.findOne($fe,this._element),this._addEventListeners(),this._config.ride===jV&&this.cycle()}static get Default(){return Hfe}static get DefaultType(){return Wfe}static get NAME(){return wfe}next(){this._slide(nv)}nextWhenVisible(){!document.hidden&&l_(this._element)&&this.next()}prev(){this._slide(eg)}pause(){this._isSliding&&kV(this._element),this._clearInterval()}cycle(){this._clearInterval(),this._updateInterval(),this._interval=setInterval(()=>this.nextWhenVisible(),this._config.interval)}_maybeEnableCycle(){if(this._config.ride){if(this._isSliding){pn.one(this._element,AC,()=>this.cycle());return}this.cycle()}}to(e){const n=this._getItems();if(e>n.length-1||e<0)return;if(this._isSliding){pn.one(this._element,AC,()=>this.to(e));return}const l=this._getItemIndex(this._getActive());if(l===e)return;const d=e>l?nv:eg;this._slide(d,n[e])}dispose(){this._swipeHelper&&this._swipeHelper.dispose(),super.dispose()}_configAfterMerge(e){return e.defaultInterval=e.interval,e}_addEventListeners(){this._config.keyboard&&pn.on(this._element,Afe,e=>this._keydown(e)),this._config.pause==="hover"&&(pn.on(this._element,Pfe,()=>this.pause()),pn.on(this._element,Rfe,()=>this._maybeEnableCycle())),this._config.touch&&Gw.isSupported()&&this._addTouchEventListeners()}_addTouchEventListeners(){for(const l of Ir.find(Vfe,this._element))pn.on(l,kfe,d=>d.preventDefault());const n={leftCallback:()=>this._slide(this._directionToOrder(hg)),rightCallback:()=>this._slide(this._directionToOrder(Qx)),endCallback:()=>{this._config.pause==="hover"&&(this.pause(),this.touchTimeout&&clearTimeout(this.touchTimeout),this.touchTimeout=setTimeout(()=>this._maybeEnableCycle(),Cfe+this._config.interval))}};this._swipeHelper=new Gw(this._element,n)}_keydown(e){if(/input|textarea/i.test(e.target.tagName))return;const n=Gfe[e.key];n&&(e.preventDefault(),this._slide(this._directionToOrder(n)))}_getItemIndex(e){return this._getItems().indexOf(e)}_setActiveIndicatorElement(e){if(!this._indicatorsElement)return;const n=Ir.findOne(GV,this._indicatorsElement);n.classList.remove(Tx),n.removeAttribute("aria-current");const l=Ir.findOne(`[data-bs-slide-to="${e}"]`,this._indicatorsElement);l&&(l.classList.add(Tx),l.setAttribute("aria-current","true"))}_updateInterval(){const e=this._activeElement||this._getActive();if(!e)return;const n=Number.parseInt(e.getAttribute("data-bs-interval"),10);this._config.interval=n||this._config.defaultInterval}_slide(e,n=null){if(this._isSliding)return;const l=this._getActive(),d=e===nv,f=n||EP(this._getItems(),l,d,this._config.wrap);if(f===l)return;const x=this._getItemIndex(f),s=j=>pn.trigger(this._element,j,{relatedTarget:f,direction:this._orderToDirection(e),from:this._getItemIndex(l),to:x});if(s(Ife).defaultPrevented||!l||!f)return;const P=!!this._interval;this.pause(),this._isSliding=!0,this._setActiveIndicatorElement(x),this._activeElement=f;const L=d?zfe:Lfe,$=d?Ffe:Bfe;f.classList.add($),hb(f),l.classList.add(L),f.classList.add(L);const V=()=>{f.classList.remove(L,$),f.classList.add(Tx),l.classList.remove(Tx,$,L),this._isSliding=!1,s(AC)};this._queueCallback(V,l,this._isAnimated()),P&&this.cycle()}_isAnimated(){return this._element.classList.contains(Dfe)}_getActive(){return Ir.findOne(Nfe,this._element)}_getItems(){return Ir.find(HV,this._element)}_clearInterval(){this._interval&&(clearInterval(this._interval),this._interval=null)}_directionToOrder(e){return Bl()?e===hg?eg:nv:e===hg?nv:eg}_orderToDirection(e){return Bl()?e===eg?hg:Qx:e===eg?Qx:hg}static jQueryInterface(e){return this.each(function(){const n=pb.getOrCreateInstance(this,e);if(typeof e=="number"){n.to(e);return}if(typeof e=="string"){if(n[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);n[e]()}})}}pn.on(document,Mfe,Ufe,function(t){const e=Ir.getElementFromSelector(this);if(!e||!e.classList.contains(jV))return;t.preventDefault();const n=pb.getOrCreateInstance(e),l=this.getAttribute("data-bs-slide-to");if(l){n.to(l),n._maybeEnableCycle();return}if(_d.getDataAttribute(this,"slide")==="next"){n.next(),n._maybeEnableCycle();return}n.prev(),n._maybeEnableCycle()});pn.on(window,Ofe,()=>{const t=Ir.find(jfe);for(const e of t)pb.getOrCreateInstance(e)});$l(pb);const qfe="collapse",Kfe="bs.collapse",mb=`.${Kfe}`,Zfe=".data-api",Xfe=`show${mb}`,Yfe=`shown${mb}`,Jfe=`hide${mb}`,Qfe=`hidden${mb}`,epe=`click${mb}${Zfe}`,PC="show",gg="collapse",Sx="collapsing",tpe="collapsed",npe=`:scope .${gg} .${gg}`,rpe="collapse-horizontal",ipe="width",ope="height",spe=".collapse.show, .collapse.collapsing",SI='[data-bs-toggle="collapse"]',ape={parent:null,toggle:!0},lpe={parent:"(null|element)",toggle:"boolean"};class B0 extends vc{constructor(e,n){super(e,n),this._isTransitioning=!1,this._triggerArray=[];const l=Ir.find(SI);for(const d of l){const f=Ir.getSelectorFromElement(d),x=Ir.find(f).filter(s=>s===this._element);f!==null&&x.length&&this._triggerArray.push(d)}this._initializeChildren(),this._config.parent||this._addAriaAndCollapsedClass(this._triggerArray,this._isShown()),this._config.toggle&&this.toggle()}static get Default(){return ape}static get DefaultType(){return lpe}static get NAME(){return qfe}toggle(){this._isShown()?this.hide():this.show()}show(){if(this._isTransitioning||this._isShown())return;let e=[];if(this._config.parent&&(e=this._getFirstLevelChildren(spe).filter(s=>s!==this._element).map(s=>B0.getOrCreateInstance(s,{toggle:!1}))),e.length&&e[0]._isTransitioning||pn.trigger(this._element,Xfe).defaultPrevented)return;for(const s of e)s.hide();const l=this._getDimension();this._element.classList.remove(gg),this._element.classList.add(Sx),this._element.style[l]=0,this._addAriaAndCollapsedClass(this._triggerArray,!0),this._isTransitioning=!0;const d=()=>{this._isTransitioning=!1,this._element.classList.remove(Sx),this._element.classList.add(gg,PC),this._element.style[l]="",pn.trigger(this._element,Yfe)},x=`scroll${l[0].toUpperCase()+l.slice(1)}`;this._queueCallback(d,this._element,!0),this._element.style[l]=`${this._element[x]}px`}hide(){if(this._isTransitioning||!this._isShown()||pn.trigger(this._element,Jfe).defaultPrevented)return;const n=this._getDimension();this._element.style[n]=`${this._element.getBoundingClientRect()[n]}px`,hb(this._element),this._element.classList.add(Sx),this._element.classList.remove(gg,PC);for(const d of this._triggerArray){const f=Ir.getElementFromSelector(d);f&&!this._isShown(f)&&this._addAriaAndCollapsedClass([d],!1)}this._isTransitioning=!0;const l=()=>{this._isTransitioning=!1,this._element.classList.remove(Sx),this._element.classList.add(gg),pn.trigger(this._element,Qfe)};this._element.style[n]="",this._queueCallback(l,this._element,!0)}_isShown(e=this._element){return e.classList.contains(PC)}_configAfterMerge(e){return e.toggle=!!e.toggle,e.parent=ef(e.parent),e}_getDimension(){return this._element.classList.contains(rpe)?ipe:ope}_initializeChildren(){if(!this._config.parent)return;const e=this._getFirstLevelChildren(SI);for(const n of e){const l=Ir.getElementFromSelector(n);l&&this._addAriaAndCollapsedClass([n],this._isShown(l))}}_getFirstLevelChildren(e){const n=Ir.find(npe,this._config.parent);return Ir.find(e,this._config.parent).filter(l=>!n.includes(l))}_addAriaAndCollapsedClass(e,n){if(e.length)for(const l of e)l.classList.toggle(tpe,!n),l.setAttribute("aria-expanded",n)}static jQueryInterface(e){const n={};return typeof e=="string"&&/show|hide/.test(e)&&(n.toggle=!1),this.each(function(){const l=B0.getOrCreateInstance(this,n);if(typeof e=="string"){if(typeof l[e]>"u")throw new TypeError(`No method named "${e}"`);l[e]()}})}}pn.on(document,epe,SI,function(t){(t.target.tagName==="A"||t.delegateTarget&&t.delegateTarget.tagName==="A")&&t.preventDefault();for(const e of Ir.getMultipleElementsFromSelector(this))B0.getOrCreateInstance(e,{toggle:!1}).toggle()});$l(B0);const G5="dropdown",cpe="bs.dropdown",kp=`.${cpe}`,IP=".data-api",upe="Escape",H5="Tab",dpe="ArrowUp",W5="ArrowDown",hpe=2,fpe=`hide${kp}`,ppe=`hidden${kp}`,mpe=`show${kp}`,gpe=`shown${kp}`,WV=`click${kp}${IP}`,qV=`keydown${kp}${IP}`,_pe=`keyup${kp}${IP}`,fg="show",ype="dropup",vpe="dropend",bpe="dropstart",xpe="dropup-center",wpe="dropdown-center",lp='[data-bs-toggle="dropdown"]:not(.disabled):not(:disabled)',Tpe=`${lp}.${fg}`,ew=".dropdown-menu",Spe=".navbar",Epe=".navbar-nav",Cpe=".dropdown-menu .dropdown-item:not(.disabled):not(:disabled)",Ipe=Bl()?"top-end":"top-start",Ape=Bl()?"top-start":"top-end",Ppe=Bl()?"bottom-end":"bottom-start",Rpe=Bl()?"bottom-start":"bottom-end",kpe=Bl()?"left-start":"right-start",Ope=Bl()?"right-start":"left-start",Mpe="top",Dpe="bottom",Lpe={autoClose:!0,boundary:"clippingParents",display:"dynamic",offset:[0,2],popperConfig:null,reference:"toggle"},zpe={autoClose:"(boolean|string)",boundary:"(string|element)",display:"string",offset:"(array|string|function)",popperConfig:"(null|object|function)",reference:"(string|element|object)"};class fu extends vc{constructor(e,n){super(e,n),this._popper=null,this._parent=this._element.parentNode,this._menu=Ir.next(this._element,ew)[0]||Ir.prev(this._element,ew)[0]||Ir.findOne(ew,this._parent),this._inNavbar=this._detectNavbar()}static get Default(){return Lpe}static get DefaultType(){return zpe}static get NAME(){return G5}toggle(){return this._isShown()?this.hide():this.show()}show(){if(tf(this._element)||this._isShown())return;const e={relatedTarget:this._element};if(!pn.trigger(this._element,mpe,e).defaultPrevented){if(this._createPopper(),"ontouchstart"in document.documentElement&&!this._parent.closest(Epe))for(const l of[].concat(...document.body.children))pn.on(l,"mouseover",jw);this._element.focus(),this._element.setAttribute("aria-expanded",!0),this._menu.classList.add(fg),this._element.classList.add(fg),pn.trigger(this._element,gpe,e)}}hide(){if(tf(this._element)||!this._isShown())return;const e={relatedTarget:this._element};this._completeHide(e)}dispose(){this._popper&&this._popper.destroy(),super.dispose()}update(){this._inNavbar=this._detectNavbar(),this._popper&&this._popper.update()}_completeHide(e){if(!pn.trigger(this._element,fpe,e).defaultPrevented){if("ontouchstart"in document.documentElement)for(const l of[].concat(...document.body.children))pn.off(l,"mouseover",jw);this._popper&&this._popper.destroy(),this._menu.classList.remove(fg),this._element.classList.remove(fg),this._element.setAttribute("aria-expanded","false"),_d.removeDataAttribute(this._menu,"popper"),pn.trigger(this._element,ppe,e)}}_getConfig(e){if(e=super._getConfig(e),typeof e.reference=="object"&&!gd(e.reference)&&typeof e.reference.getBoundingClientRect!="function")throw new TypeError(`${G5.toUpperCase()}: Option "reference" provided type "object" without a required "getBoundingClientRect" method.`);return e}_createPopper(){if(typeof PV>"u")throw new TypeError("Bootstrap's dropdowns require Popper (https://popper.js.org/docs/v2/)");let e=this._element;this._config.reference==="parent"?e=this._parent:gd(this._config.reference)?e=ef(this._config.reference):typeof this._config.reference=="object"&&(e=this._config.reference);const n=this._getPopperConfig();this._popper=SP(e,this._menu,n)}_isShown(){return this._menu.classList.contains(fg)}_getPlacement(){const e=this._parent;if(e.classList.contains(vpe))return kpe;if(e.classList.contains(bpe))return Ope;if(e.classList.contains(xpe))return Mpe;if(e.classList.contains(wpe))return Dpe;const n=getComputedStyle(this._menu).getPropertyValue("--bs-position").trim()==="end";return e.classList.contains(ype)?n?Ape:Ipe:n?Rpe:Ppe}_detectNavbar(){return this._element.closest(Spe)!==null}_getOffset(){const{offset:e}=this._config;return typeof e=="string"?e.split(",").map(n=>Number.parseInt(n,10)):typeof e=="function"?n=>e(n,this._element):e}_getPopperConfig(){const e={placement:this._getPlacement(),modifiers:[{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"offset",options:{offset:this._getOffset()}}]};return(this._inNavbar||this._config.display==="static")&&(_d.setDataAttribute(this._menu,"popper","static"),e.modifiers=[{name:"applyStyles",enabled:!1}]),{...e,...Ua(this._config.popperConfig,[void 0,e])}}_selectMenuItem({key:e,target:n}){const l=Ir.find(Cpe,this._menu).filter(d=>l_(d));l.length&&EP(l,n,e===W5,!l.includes(n)).focus()}static jQueryInterface(e){return this.each(function(){const n=fu.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof n[e]>"u")throw new TypeError(`No method named "${e}"`);n[e]()}})}static clearMenus(e){if(e.button===hpe||e.type==="keyup"&&e.key!==H5)return;const n=Ir.find(Tpe);for(const l of n){const d=fu.getInstance(l);if(!d||d._config.autoClose===!1)continue;const f=e.composedPath(),x=f.includes(d._menu);if(f.includes(d._element)||d._config.autoClose==="inside"&&!x||d._config.autoClose==="outside"&&x||d._menu.contains(e.target)&&(e.type==="keyup"&&e.key===H5||/input|select|option|textarea|form/i.test(e.target.tagName)))continue;const s={relatedTarget:d._element};e.type==="click"&&(s.clickEvent=e),d._completeHide(s)}}static dataApiKeydownHandler(e){const n=/input|textarea/i.test(e.target.tagName),l=e.key===upe,d=[dpe,W5].includes(e.key);if(!d&&!l||n&&!l)return;e.preventDefault();const f=this.matches(lp)?this:Ir.prev(this,lp)[0]||Ir.next(this,lp)[0]||Ir.findOne(lp,e.delegateTarget.parentNode),x=fu.getOrCreateInstance(f);if(d){e.stopPropagation(),x.show(),x._selectMenuItem(e);return}x._isShown()&&(e.stopPropagation(),x.hide(),f.focus())}}pn.on(document,qV,lp,fu.dataApiKeydownHandler);pn.on(document,qV,ew,fu.dataApiKeydownHandler);pn.on(document,WV,fu.clearMenus);pn.on(document,_pe,fu.clearMenus);pn.on(document,WV,lp,function(t){t.preventDefault(),fu.getOrCreateInstance(this).toggle()});$l(fu);const KV="backdrop",Fpe="fade",q5="show",K5=`mousedown.bs.${KV}`,Bpe={className:"modal-backdrop",clickCallback:null,isAnimated:!1,isVisible:!0,rootElement:"body"},Npe={className:"string",clickCallback:"(function|null)",isAnimated:"boolean",isVisible:"boolean",rootElement:"(element|string)"};class ZV extends fb{constructor(e){super(),this._config=this._getConfig(e),this._isAppended=!1,this._element=null}static get Default(){return Bpe}static get DefaultType(){return Npe}static get NAME(){return KV}show(e){if(!this._config.isVisible){Ua(e);return}this._append();const n=this._getElement();this._config.isAnimated&&hb(n),n.classList.add(q5),this._emulateAnimation(()=>{Ua(e)})}hide(e){if(!this._config.isVisible){Ua(e);return}this._getElement().classList.remove(q5),this._emulateAnimation(()=>{this.dispose(),Ua(e)})}dispose(){this._isAppended&&(pn.off(this._element,K5),this._element.remove(),this._isAppended=!1)}_getElement(){if(!this._element){const e=document.createElement("div");e.className=this._config.className,this._config.isAnimated&&e.classList.add(Fpe),this._element=e}return this._element}_configAfterMerge(e){return e.rootElement=ef(e.rootElement),e}_append(){if(this._isAppended)return;const e=this._getElement();this._config.rootElement.append(e),pn.on(e,K5,()=>{Ua(this._config.clickCallback)}),this._isAppended=!0}_emulateAnimation(e){DV(e,this._getElement(),this._config.isAnimated)}}const Vpe="focustrap",$pe="bs.focustrap",Hw=`.${$pe}`,Upe=`focusin${Hw}`,jpe=`keydown.tab${Hw}`,Gpe="Tab",Hpe="forward",Z5="backward",Wpe={autofocus:!0,trapElement:null},qpe={autofocus:"boolean",trapElement:"element"};class XV extends fb{constructor(e){super(),this._config=this._getConfig(e),this._isActive=!1,this._lastTabNavDirection=null}static get Default(){return Wpe}static get DefaultType(){return qpe}static get NAME(){return Vpe}activate(){this._isActive||(this._config.autofocus&&this._config.trapElement.focus(),pn.off(document,Hw),pn.on(document,Upe,e=>this._handleFocusin(e)),pn.on(document,jpe,e=>this._handleKeydown(e)),this._isActive=!0)}deactivate(){this._isActive&&(this._isActive=!1,pn.off(document,Hw))}_handleFocusin(e){const{trapElement:n}=this._config;if(e.target===document||e.target===n||n.contains(e.target))return;const l=Ir.focusableChildren(n);l.length===0?n.focus():this._lastTabNavDirection===Z5?l[l.length-1].focus():l[0].focus()}_handleKeydown(e){e.key===Gpe&&(this._lastTabNavDirection=e.shiftKey?Z5:Hpe)}}const X5=".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",Y5=".sticky-top",Ex="padding-right",J5="margin-right";class EI{constructor(){this._element=document.body}getWidth(){const e=document.documentElement.clientWidth;return Math.abs(window.innerWidth-e)}hide(){const e=this.getWidth();this._disableOverFlow(),this._setElementAttributes(this._element,Ex,n=>n+e),this._setElementAttributes(X5,Ex,n=>n+e),this._setElementAttributes(Y5,J5,n=>n-e)}reset(){this._resetElementAttributes(this._element,"overflow"),this._resetElementAttributes(this._element,Ex),this._resetElementAttributes(X5,Ex),this._resetElementAttributes(Y5,J5)}isOverflowing(){return this.getWidth()>0}_disableOverFlow(){this._saveInitialAttribute(this._element,"overflow"),this._element.style.overflow="hidden"}_setElementAttributes(e,n,l){const d=this.getWidth(),f=x=>{if(x!==this._element&&window.innerWidth>x.clientWidth+d)return;this._saveInitialAttribute(x,n);const s=window.getComputedStyle(x).getPropertyValue(n);x.style.setProperty(n,`${l(Number.parseFloat(s))}px`)};this._applyManipulationCallback(e,f)}_saveInitialAttribute(e,n){const l=e.style.getPropertyValue(n);l&&_d.setDataAttribute(e,n,l)}_resetElementAttributes(e,n){const l=d=>{const f=_d.getDataAttribute(d,n);if(f===null){d.style.removeProperty(n);return}_d.removeDataAttribute(d,n),d.style.setProperty(n,f)};this._applyManipulationCallback(e,l)}_applyManipulationCallback(e,n){if(gd(e)){n(e);return}for(const l of Ir.find(e,this._element))n(l)}}const Kpe="modal",Zpe="bs.modal",Nl=`.${Zpe}`,Xpe=".data-api",Ype="Escape",Jpe=`hide${Nl}`,Qpe=`hidePrevented${Nl}`,YV=`hidden${Nl}`,JV=`show${Nl}`,eme=`shown${Nl}`,tme=`resize${Nl}`,nme=`click.dismiss${Nl}`,rme=`mousedown.dismiss${Nl}`,ime=`keydown.dismiss${Nl}`,ome=`click${Nl}${Xpe}`,Q5="modal-open",sme="fade",e4="show",RC="modal-static",ame=".modal.show",lme=".modal-dialog",cme=".modal-body",ume='[data-bs-toggle="modal"]',dme={backdrop:!0,focus:!0,keyboard:!0},hme={backdrop:"(boolean|string)",focus:"boolean",keyboard:"boolean"};class Zg extends vc{constructor(e,n){super(e,n),this._dialog=Ir.findOne(lme,this._element),this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._isShown=!1,this._isTransitioning=!1,this._scrollBar=new EI,this._addEventListeners()}static get Default(){return dme}static get DefaultType(){return hme}static get NAME(){return Kpe}toggle(e){return this._isShown?this.hide():this.show(e)}show(e){this._isShown||this._isTransitioning||pn.trigger(this._element,JV,{relatedTarget:e}).defaultPrevented||(this._isShown=!0,this._isTransitioning=!0,this._scrollBar.hide(),document.body.classList.add(Q5),this._adjustDialog(),this._backdrop.show(()=>this._showElement(e)))}hide(){!this._isShown||this._isTransitioning||pn.trigger(this._element,Jpe).defaultPrevented||(this._isShown=!1,this._isTransitioning=!0,this._focustrap.deactivate(),this._element.classList.remove(e4),this._queueCallback(()=>this._hideModal(),this._element,this._isAnimated()))}dispose(){pn.off(window,Nl),pn.off(this._dialog,Nl),this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}handleUpdate(){this._adjustDialog()}_initializeBackDrop(){return new ZV({isVisible:!!this._config.backdrop,isAnimated:this._isAnimated()})}_initializeFocusTrap(){return new XV({trapElement:this._element})}_showElement(e){document.body.contains(this._element)||document.body.append(this._element),this._element.style.display="block",this._element.removeAttribute("aria-hidden"),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.scrollTop=0;const n=Ir.findOne(cme,this._dialog);n&&(n.scrollTop=0),hb(this._element),this._element.classList.add(e4);const l=()=>{this._config.focus&&this._focustrap.activate(),this._isTransitioning=!1,pn.trigger(this._element,eme,{relatedTarget:e})};this._queueCallback(l,this._dialog,this._isAnimated())}_addEventListeners(){pn.on(this._element,ime,e=>{if(e.key===Ype){if(this._config.keyboard){this.hide();return}this._triggerBackdropTransition()}}),pn.on(window,tme,()=>{this._isShown&&!this._isTransitioning&&this._adjustDialog()}),pn.on(this._element,rme,e=>{pn.one(this._element,nme,n=>{if(!(this._element!==e.target||this._element!==n.target)){if(this._config.backdrop==="static"){this._triggerBackdropTransition();return}this._config.backdrop&&this.hide()}})})}_hideModal(){this._element.style.display="none",this._element.setAttribute("aria-hidden",!0),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._isTransitioning=!1,this._backdrop.hide(()=>{document.body.classList.remove(Q5),this._resetAdjustments(),this._scrollBar.reset(),pn.trigger(this._element,YV)})}_isAnimated(){return this._element.classList.contains(sme)}_triggerBackdropTransition(){if(pn.trigger(this._element,Qpe).defaultPrevented)return;const n=this._element.scrollHeight>document.documentElement.clientHeight,l=this._element.style.overflowY;l==="hidden"||this._element.classList.contains(RC)||(n||(this._element.style.overflowY="hidden"),this._element.classList.add(RC),this._queueCallback(()=>{this._element.classList.remove(RC),this._queueCallback(()=>{this._element.style.overflowY=l},this._dialog)},this._dialog),this._element.focus())}_adjustDialog(){const e=this._element.scrollHeight>document.documentElement.clientHeight,n=this._scrollBar.getWidth(),l=n>0;if(l&&!e){const d=Bl()?"paddingLeft":"paddingRight";this._element.style[d]=`${n}px`}if(!l&&e){const d=Bl()?"paddingRight":"paddingLeft";this._element.style[d]=`${n}px`}}_resetAdjustments(){this._element.style.paddingLeft="",this._element.style.paddingRight=""}static jQueryInterface(e,n){return this.each(function(){const l=Zg.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof l[e]>"u")throw new TypeError(`No method named "${e}"`);l[e](n)}})}}pn.on(document,ome,ume,function(t){const e=Ir.getElementFromSelector(this);["A","AREA"].includes(this.tagName)&&t.preventDefault(),pn.one(e,JV,d=>{d.defaultPrevented||pn.one(e,YV,()=>{l_(this)&&this.focus()})});const n=Ir.findOne(ame);n&&Zg.getInstance(n).hide(),Zg.getOrCreateInstance(e).toggle(this)});GT(Zg);$l(Zg);const fme="offcanvas",pme="bs.offcanvas",Rd=`.${pme}`,QV=".data-api",mme=`load${Rd}${QV}`,gme="Escape",t4="show",n4="showing",r4="hiding",_me="offcanvas-backdrop",e8=".offcanvas.show",yme=`show${Rd}`,vme=`shown${Rd}`,bme=`hide${Rd}`,i4=`hidePrevented${Rd}`,t8=`hidden${Rd}`,xme=`resize${Rd}`,wme=`click${Rd}${QV}`,Tme=`keydown.dismiss${Rd}`,Sme='[data-bs-toggle="offcanvas"]',Eme={backdrop:!0,keyboard:!0,scroll:!1},Cme={backdrop:"(boolean|string)",keyboard:"boolean",scroll:"boolean"};class nf extends vc{constructor(e,n){super(e,n),this._isShown=!1,this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._addEventListeners()}static get Default(){return Eme}static get DefaultType(){return Cme}static get NAME(){return fme}toggle(e){return this._isShown?this.hide():this.show(e)}show(e){if(this._isShown||pn.trigger(this._element,yme,{relatedTarget:e}).defaultPrevented)return;this._isShown=!0,this._backdrop.show(),this._config.scroll||new EI().hide(),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.classList.add(n4);const l=()=>{(!this._config.scroll||this._config.backdrop)&&this._focustrap.activate(),this._element.classList.add(t4),this._element.classList.remove(n4),pn.trigger(this._element,vme,{relatedTarget:e})};this._queueCallback(l,this._element,!0)}hide(){if(!this._isShown||pn.trigger(this._element,bme).defaultPrevented)return;this._focustrap.deactivate(),this._element.blur(),this._isShown=!1,this._element.classList.add(r4),this._backdrop.hide();const n=()=>{this._element.classList.remove(t4,r4),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._config.scroll||new EI().reset(),pn.trigger(this._element,t8)};this._queueCallback(n,this._element,!0)}dispose(){this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}_initializeBackDrop(){const e=()=>{if(this._config.backdrop==="static"){pn.trigger(this._element,i4);return}this.hide()},n=!!this._config.backdrop;return new ZV({className:_me,isVisible:n,isAnimated:!0,rootElement:this._element.parentNode,clickCallback:n?e:null})}_initializeFocusTrap(){return new XV({trapElement:this._element})}_addEventListeners(){pn.on(this._element,Tme,e=>{if(e.key===gme){if(this._config.keyboard){this.hide();return}pn.trigger(this._element,i4)}})}static jQueryInterface(e){return this.each(function(){const n=nf.getOrCreateInstance(this,e);if(typeof e=="string"){if(n[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);n[e](this)}})}}pn.on(document,wme,Sme,function(t){const e=Ir.getElementFromSelector(this);if(["A","AREA"].includes(this.tagName)&&t.preventDefault(),tf(this))return;pn.one(e,t8,()=>{l_(this)&&this.focus()});const n=Ir.findOne(e8);n&&n!==e&&nf.getInstance(n).hide(),nf.getOrCreateInstance(e).toggle(this)});pn.on(window,mme,()=>{for(const t of Ir.find(e8))nf.getOrCreateInstance(t).show()});pn.on(window,xme,()=>{for(const t of Ir.find("[aria-modal][class*=show][class*=offcanvas-]"))getComputedStyle(t).position!=="fixed"&&nf.getOrCreateInstance(t).hide()});GT(nf);$l(nf);const Ime=/^aria-[\w-]*$/i,n8={"*":["class","dir","id","lang","role",Ime],a:["target","href","title","rel"],area:[],b:[],br:[],col:[],code:[],dd:[],div:[],dl:[],dt:[],em:[],hr:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],i:[],img:["src","srcset","alt","title","width","height"],li:[],ol:[],p:[],pre:[],s:[],small:[],span:[],sub:[],sup:[],strong:[],u:[],ul:[]},Ame=new Set(["background","cite","href","itemtype","longdesc","poster","src","xlink:href"]),Pme=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:/?#]*(?:[/?#]|$))/i,Rme=(t,e)=>{const n=t.nodeName.toLowerCase();return e.includes(n)?Ame.has(n)?!!Pme.test(t.nodeValue):!0:e.filter(l=>l instanceof RegExp).some(l=>l.test(n))};function kme(t,e,n){if(!t.length)return t;if(n&&typeof n=="function")return n(t);const d=new window.DOMParser().parseFromString(t,"text/html"),f=[].concat(...d.body.querySelectorAll("*"));for(const x of f){const s=x.nodeName.toLowerCase();if(!Object.keys(e).includes(s)){x.remove();continue}const C=[].concat(...x.attributes),P=[].concat(e["*"]||[],e[s]||[]);for(const L of C)Rme(L,P)||x.removeAttribute(L.nodeName)}return d.body.innerHTML}const Ome="TemplateFactory",Mme={allowList:n8,content:{},extraClass:"",html:!1,sanitize:!0,sanitizeFn:null,template:"<div></div>"},Dme={allowList:"object",content:"object",extraClass:"(string|function)",html:"boolean",sanitize:"boolean",sanitizeFn:"(null|function)",template:"string"},Lme={entry:"(string|element|function|null)",selector:"(string|element)"};class zme extends fb{constructor(e){super(),this._config=this._getConfig(e)}static get Default(){return Mme}static get DefaultType(){return Dme}static get NAME(){return Ome}getContent(){return Object.values(this._config.content).map(e=>this._resolvePossibleFunction(e)).filter(Boolean)}hasContent(){return this.getContent().length>0}changeContent(e){return this._checkContent(e),this._config.content={...this._config.content,...e},this}toHtml(){const e=document.createElement("div");e.innerHTML=this._maybeSanitize(this._config.template);for(const[d,f]of Object.entries(this._config.content))this._setContent(e,f,d);const n=e.children[0],l=this._resolvePossibleFunction(this._config.extraClass);return l&&n.classList.add(...l.split(" ")),n}_typeCheckConfig(e){super._typeCheckConfig(e),this._checkContent(e.content)}_checkContent(e){for(const[n,l]of Object.entries(e))super._typeCheckConfig({selector:n,entry:l},Lme)}_setContent(e,n,l){const d=Ir.findOne(l,e);if(d){if(n=this._resolvePossibleFunction(n),!n){d.remove();return}if(gd(n)){this._putElementInTemplate(ef(n),d);return}if(this._config.html){d.innerHTML=this._maybeSanitize(n);return}d.textContent=n}}_maybeSanitize(e){return this._config.sanitize?kme(e,this._config.allowList,this._config.sanitizeFn):e}_resolvePossibleFunction(e){return Ua(e,[void 0,this])}_putElementInTemplate(e,n){if(this._config.html){n.innerHTML="",n.append(e);return}n.textContent=e.textContent}}const Fme="tooltip",Bme=new Set(["sanitize","allowList","sanitizeFn"]),kC="fade",Nme="modal",Cx="show",Vme=".tooltip-inner",o4=`.${Nme}`,s4="hide.bs.modal",rv="hover",OC="focus",MC="click",$me="manual",Ume="hide",jme="hidden",Gme="show",Hme="shown",Wme="inserted",qme="click",Kme="focusin",Zme="focusout",Xme="mouseenter",Yme="mouseleave",Jme={AUTO:"auto",TOP:"top",RIGHT:Bl()?"left":"right",BOTTOM:"bottom",LEFT:Bl()?"right":"left"},Qme={allowList:n8,animation:!0,boundary:"clippingParents",container:!1,customClass:"",delay:0,fallbackPlacements:["top","right","bottom","left"],html:!1,offset:[0,6],placement:"top",popperConfig:null,sanitize:!0,sanitizeFn:null,selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',title:"",trigger:"hover focus"},ege={allowList:"object",animation:"boolean",boundary:"(string|element)",container:"(string|element|boolean)",customClass:"(string|function)",delay:"(number|object)",fallbackPlacements:"array",html:"boolean",offset:"(array|string|function)",placement:"(string|function)",popperConfig:"(null|object|function)",sanitize:"boolean",sanitizeFn:"(null|function)",selector:"(string|boolean)",template:"string",title:"(string|element|function)",trigger:"string"};class u_ extends vc{constructor(e,n){if(typeof PV>"u")throw new TypeError("Bootstrap's tooltips require Popper (https://popper.js.org/docs/v2/)");super(e,n),this._isEnabled=!0,this._timeout=0,this._isHovered=null,this._activeTrigger={},this._popper=null,this._templateFactory=null,this._newContent=null,this.tip=null,this._setListeners(),this._config.selector||this._fixTitle()}static get Default(){return Qme}static get DefaultType(){return ege}static get NAME(){return Fme}enable(){this._isEnabled=!0}disable(){this._isEnabled=!1}toggleEnabled(){this._isEnabled=!this._isEnabled}toggle(){if(this._isEnabled){if(this._isShown()){this._leave();return}this._enter()}}dispose(){clearTimeout(this._timeout),pn.off(this._element.closest(o4),s4,this._hideModalHandler),this._element.getAttribute("data-bs-original-title")&&this._element.setAttribute("title",this._element.getAttribute("data-bs-original-title")),this._disposePopper(),super.dispose()}show(){if(this._element.style.display==="none")throw new Error("Please use show on visible elements");if(!(this._isWithContent()&&this._isEnabled))return;const e=pn.trigger(this._element,this.constructor.eventName(Gme)),l=(OV(this._element)||this._element.ownerDocument.documentElement).contains(this._element);if(e.defaultPrevented||!l)return;this._disposePopper();const d=this._getTipElement();this._element.setAttribute("aria-describedby",d.getAttribute("id"));const{container:f}=this._config;if(this._element.ownerDocument.documentElement.contains(this.tip)||(f.append(d),pn.trigger(this._element,this.constructor.eventName(Wme))),this._popper=this._createPopper(d),d.classList.add(Cx),"ontouchstart"in document.documentElement)for(const s of[].concat(...document.body.children))pn.on(s,"mouseover",jw);const x=()=>{pn.trigger(this._element,this.constructor.eventName(Hme)),this._isHovered===!1&&this._leave(),this._isHovered=!1};this._queueCallback(x,this.tip,this._isAnimated())}hide(){if(!this._isShown()||pn.trigger(this._element,this.constructor.eventName(Ume)).defaultPrevented)return;if(this._getTipElement().classList.remove(Cx),"ontouchstart"in document.documentElement)for(const d of[].concat(...document.body.children))pn.off(d,"mouseover",jw);this._activeTrigger[MC]=!1,this._activeTrigger[OC]=!1,this._activeTrigger[rv]=!1,this._isHovered=null;const l=()=>{this._isWithActiveTrigger()||(this._isHovered||this._disposePopper(),this._element.removeAttribute("aria-describedby"),pn.trigger(this._element,this.constructor.eventName(jme)))};this._queueCallback(l,this.tip,this._isAnimated())}update(){this._popper&&this._popper.update()}_isWithContent(){return!!this._getTitle()}_getTipElement(){return this.tip||(this.tip=this._createTipElement(this._newContent||this._getContentForTemplate())),this.tip}_createTipElement(e){const n=this._getTemplateFactory(e).toHtml();if(!n)return null;n.classList.remove(kC,Cx),n.classList.add(`bs-${this.constructor.NAME}-auto`);const l=$he(this.constructor.NAME).toString();return n.setAttribute("id",l),this._isAnimated()&&n.classList.add(kC),n}setContent(e){this._newContent=e,this._isShown()&&(this._disposePopper(),this.show())}_getTemplateFactory(e){return this._templateFactory?this._templateFactory.changeContent(e):this._templateFactory=new zme({...this._config,content:e,extraClass:this._resolvePossibleFunction(this._config.customClass)}),this._templateFactory}_getContentForTemplate(){return{[Vme]:this._getTitle()}}_getTitle(){return this._resolvePossibleFunction(this._config.title)||this._element.getAttribute("data-bs-original-title")}_initializeOnDelegatedTarget(e){return this.constructor.getOrCreateInstance(e.delegateTarget,this._getDelegateConfig())}_isAnimated(){return this._config.animation||this.tip&&this.tip.classList.contains(kC)}_isShown(){return this.tip&&this.tip.classList.contains(Cx)}_createPopper(e){const n=Ua(this._config.placement,[this,e,this._element]),l=Jme[n.toUpperCase()];return SP(this._element,e,this._getPopperConfig(l))}_getOffset(){const{offset:e}=this._config;return typeof e=="string"?e.split(",").map(n=>Number.parseInt(n,10)):typeof e=="function"?n=>e(n,this._element):e}_resolvePossibleFunction(e){return Ua(e,[this._element,this._element])}_getPopperConfig(e){const n={placement:e,modifiers:[{name:"flip",options:{fallbackPlacements:this._config.fallbackPlacements}},{name:"offset",options:{offset:this._getOffset()}},{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"arrow",options:{element:`.${this.constructor.NAME}-arrow`}},{name:"preSetPlacement",enabled:!0,phase:"beforeMain",fn:l=>{this._getTipElement().setAttribute("data-popper-placement",l.state.placement)}}]};return{...n,...Ua(this._config.popperConfig,[void 0,n])}}_setListeners(){const e=this._config.trigger.split(" ");for(const n of e)if(n==="click")pn.on(this._element,this.constructor.eventName(qme),this._config.selector,l=>{const d=this._initializeOnDelegatedTarget(l);d._activeTrigger[MC]=!(d._isShown()&&d._activeTrigger[MC]),d.toggle()});else if(n!==$me){const l=n===rv?this.constructor.eventName(Xme):this.constructor.eventName(Kme),d=n===rv?this.constructor.eventName(Yme):this.constructor.eventName(Zme);pn.on(this._element,l,this._config.selector,f=>{const x=this._initializeOnDelegatedTarget(f);x._activeTrigger[f.type==="focusin"?OC:rv]=!0,x._enter()}),pn.on(this._element,d,this._config.selector,f=>{const x=this._initializeOnDelegatedTarget(f);x._activeTrigger[f.type==="focusout"?OC:rv]=x._element.contains(f.relatedTarget),x._leave()})}this._hideModalHandler=()=>{this._element&&this.hide()},pn.on(this._element.closest(o4),s4,this._hideModalHandler)}_fixTitle(){const e=this._element.getAttribute("title");e&&(!this._element.getAttribute("aria-label")&&!this._element.textContent.trim()&&this._element.setAttribute("aria-label",e),this._element.setAttribute("data-bs-original-title",e),this._element.removeAttribute("title"))}_enter(){if(this._isShown()||this._isHovered){this._isHovered=!0;return}this._isHovered=!0,this._setTimeout(()=>{this._isHovered&&this.show()},this._config.delay.show)}_leave(){this._isWithActiveTrigger()||(this._isHovered=!1,this._setTimeout(()=>{this._isHovered||this.hide()},this._config.delay.hide))}_setTimeout(e,n){clearTimeout(this._timeout),this._timeout=setTimeout(e,n)}_isWithActiveTrigger(){return Object.values(this._activeTrigger).includes(!0)}_getConfig(e){const n=_d.getDataAttributes(this._element);for(const l of Object.keys(n))Bme.has(l)&&delete n[l];return e={...n,...typeof e=="object"&&e?e:{}},e=this._mergeConfigObj(e),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}_configAfterMerge(e){return e.container=e.container===!1?document.body:ef(e.container),typeof e.delay=="number"&&(e.delay={show:e.delay,hide:e.delay}),typeof e.title=="number"&&(e.title=e.title.toString()),typeof e.content=="number"&&(e.content=e.content.toString()),e}_getDelegateConfig(){const e={};for(const[n,l]of Object.entries(this._config))this.constructor.Default[n]!==l&&(e[n]=l);return e.selector=!1,e.trigger="manual",e}_disposePopper(){this._popper&&(this._popper.destroy(),this._popper=null),this.tip&&(this.tip.remove(),this.tip=null)}static jQueryInterface(e){return this.each(function(){const n=u_.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof n[e]>"u")throw new TypeError(`No method named "${e}"`);n[e]()}})}}$l(u_);const tge="popover",nge=".popover-header",rge=".popover-body",ige={...u_.Default,content:"",offset:[0,8],placement:"right",template:'<div class="popover" role="tooltip"><div class="popover-arrow"></div><h3 class="popover-header"></h3><div class="popover-body"></div></div>',trigger:"click"},oge={...u_.DefaultType,content:"(null|string|element|function)"};class AP extends u_{static get Default(){return ige}static get DefaultType(){return oge}static get NAME(){return tge}_isWithContent(){return this._getTitle()||this._getContent()}_getContentForTemplate(){return{[nge]:this._getTitle(),[rge]:this._getContent()}}_getContent(){return this._resolvePossibleFunction(this._config.content)}static jQueryInterface(e){return this.each(function(){const n=AP.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof n[e]>"u")throw new TypeError(`No method named "${e}"`);n[e]()}})}}$l(AP);const sge="scrollspy",age="bs.scrollspy",PP=`.${age}`,lge=".data-api",cge=`activate${PP}`,a4=`click${PP}`,uge=`load${PP}${lge}`,dge="dropdown-item",tg="active",hge='[data-bs-spy="scroll"]',DC="[href]",fge=".nav, .list-group",l4=".nav-link",pge=".nav-item",mge=".list-group-item",gge=`${l4}, ${pge} > ${l4}, ${mge}`,_ge=".dropdown",yge=".dropdown-toggle",vge={offset:null,rootMargin:"0px 0px -25%",smoothScroll:!1,target:null,threshold:[.1,.5,1]},bge={offset:"(number|null)",rootMargin:"string",smoothScroll:"boolean",target:"element",threshold:"array"};class qT extends vc{constructor(e,n){super(e,n),this._targetLinks=new Map,this._observableSections=new Map,this._rootElement=getComputedStyle(this._element).overflowY==="visible"?null:this._element,this._activeTarget=null,this._observer=null,this._previousScrollData={visibleEntryTop:0,parentScrollTop:0},this.refresh()}static get Default(){return vge}static get DefaultType(){return bge}static get NAME(){return sge}refresh(){this._initializeTargetsAndObservables(),this._maybeEnableSmoothScroll(),this._observer?this._observer.disconnect():this._observer=this._getNewObserver();for(const e of this._observableSections.values())this._observer.observe(e)}dispose(){this._observer.disconnect(),super.dispose()}_configAfterMerge(e){return e.target=ef(e.target)||document.body,e.rootMargin=e.offset?`${e.offset}px 0px -30%`:e.rootMargin,typeof e.threshold=="string"&&(e.threshold=e.threshold.split(",").map(n=>Number.parseFloat(n))),e}_maybeEnableSmoothScroll(){this._config.smoothScroll&&(pn.off(this._config.target,a4),pn.on(this._config.target,a4,DC,e=>{const n=this._observableSections.get(e.target.hash);if(n){e.preventDefault();const l=this._rootElement||window,d=n.offsetTop-this._element.offsetTop;if(l.scrollTo){l.scrollTo({top:d,behavior:"smooth"});return}l.scrollTop=d}}))}_getNewObserver(){const e={root:this._rootElement,threshold:this._config.threshold,rootMargin:this._config.rootMargin};return new IntersectionObserver(n=>this._observerCallback(n),e)}_observerCallback(e){const n=x=>this._targetLinks.get(`#${x.target.id}`),l=x=>{this._previousScrollData.visibleEntryTop=x.target.offsetTop,this._process(n(x))},d=(this._rootElement||document.documentElement).scrollTop,f=d>=this._previousScrollData.parentScrollTop;this._previousScrollData.parentScrollTop=d;for(const x of e){if(!x.isIntersecting){this._activeTarget=null,this._clearActiveClass(n(x));continue}const s=x.target.offsetTop>=this._previousScrollData.visibleEntryTop;if(f&&s){if(l(x),!d)return;continue}!f&&!s&&l(x)}}_initializeTargetsAndObservables(){this._targetLinks=new Map,this._observableSections=new Map;const e=Ir.find(DC,this._config.target);for(const n of e){if(!n.hash||tf(n))continue;const l=Ir.findOne(decodeURI(n.hash),this._element);l_(l)&&(this._targetLinks.set(decodeURI(n.hash),n),this._observableSections.set(n.hash,l))}}_process(e){this._activeTarget!==e&&(this._clearActiveClass(this._config.target),this._activeTarget=e,e.classList.add(tg),this._activateParents(e),pn.trigger(this._element,cge,{relatedTarget:e}))}_activateParents(e){if(e.classList.contains(dge)){Ir.findOne(yge,e.closest(_ge)).classList.add(tg);return}for(const n of Ir.parents(e,fge))for(const l of Ir.prev(n,gge))l.classList.add(tg)}_clearActiveClass(e){e.classList.remove(tg);const n=Ir.find(`${DC}.${tg}`,e);for(const l of n)l.classList.remove(tg)}static jQueryInterface(e){return this.each(function(){const n=qT.getOrCreateInstance(this,e);if(typeof e=="string"){if(n[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);n[e]()}})}}pn.on(window,uge,()=>{for(const t of Ir.find(hge))qT.getOrCreateInstance(t)});$l(qT);const xge="tab",wge="bs.tab",Op=`.${wge}`,Tge=`hide${Op}`,Sge=`hidden${Op}`,Ege=`show${Op}`,Cge=`shown${Op}`,Ige=`click${Op}`,Age=`keydown${Op}`,Pge=`load${Op}`,Rge="ArrowLeft",c4="ArrowRight",kge="ArrowUp",u4="ArrowDown",LC="Home",d4="End",cp="active",h4="fade",zC="show",Oge="dropdown",r8=".dropdown-toggle",Mge=".dropdown-menu",FC=`:not(${r8})`,Dge='.list-group, .nav, [role="tablist"]',Lge=".nav-item, .list-group-item",zge=`.nav-link${FC}, .list-group-item${FC}, [role="tab"]${FC}`,i8='[data-bs-toggle="tab"], [data-bs-toggle="pill"], [data-bs-toggle="list"]',BC=`${zge}, ${i8}`,Fge=`.${cp}[data-bs-toggle="tab"], .${cp}[data-bs-toggle="pill"], .${cp}[data-bs-toggle="list"]`;class Xg extends vc{constructor(e){super(e),this._parent=this._element.closest(Dge),this._parent&&(this._setInitialAttributes(this._parent,this._getChildren()),pn.on(this._element,Age,n=>this._keydown(n)))}static get NAME(){return xge}show(){const e=this._element;if(this._elemIsActive(e))return;const n=this._getActiveElem(),l=n?pn.trigger(n,Tge,{relatedTarget:e}):null;pn.trigger(e,Ege,{relatedTarget:n}).defaultPrevented||l&&l.defaultPrevented||(this._deactivate(n,e),this._activate(e,n))}_activate(e,n){if(!e)return;e.classList.add(cp),this._activate(Ir.getElementFromSelector(e));const l=()=>{if(e.getAttribute("role")!=="tab"){e.classList.add(zC);return}e.removeAttribute("tabindex"),e.setAttribute("aria-selected",!0),this._toggleDropDown(e,!0),pn.trigger(e,Cge,{relatedTarget:n})};this._queueCallback(l,e,e.classList.contains(h4))}_deactivate(e,n){if(!e)return;e.classList.remove(cp),e.blur(),this._deactivate(Ir.getElementFromSelector(e));const l=()=>{if(e.getAttribute("role")!=="tab"){e.classList.remove(zC);return}e.setAttribute("aria-selected",!1),e.setAttribute("tabindex","-1"),this._toggleDropDown(e,!1),pn.trigger(e,Sge,{relatedTarget:n})};this._queueCallback(l,e,e.classList.contains(h4))}_keydown(e){if(![Rge,c4,kge,u4,LC,d4].includes(e.key))return;e.stopPropagation(),e.preventDefault();const n=this._getChildren().filter(d=>!tf(d));let l;if([LC,d4].includes(e.key))l=n[e.key===LC?0:n.length-1];else{const d=[c4,u4].includes(e.key);l=EP(n,e.target,d,!0)}l&&(l.focus({preventScroll:!0}),Xg.getOrCreateInstance(l).show())}_getChildren(){return Ir.find(BC,this._parent)}_getActiveElem(){return this._getChildren().find(e=>this._elemIsActive(e))||null}_setInitialAttributes(e,n){this._setAttributeIfNotExists(e,"role","tablist");for(const l of n)this._setInitialAttributesOnChild(l)}_setInitialAttributesOnChild(e){e=this._getInnerElement(e);const n=this._elemIsActive(e),l=this._getOuterElement(e);e.setAttribute("aria-selected",n),l!==e&&this._setAttributeIfNotExists(l,"role","presentation"),n||e.setAttribute("tabindex","-1"),this._setAttributeIfNotExists(e,"role","tab"),this._setInitialAttributesOnTargetPanel(e)}_setInitialAttributesOnTargetPanel(e){const n=Ir.getElementFromSelector(e);n&&(this._setAttributeIfNotExists(n,"role","tabpanel"),e.id&&this._setAttributeIfNotExists(n,"aria-labelledby",`${e.id}`))}_toggleDropDown(e,n){const l=this._getOuterElement(e);if(!l.classList.contains(Oge))return;const d=(f,x)=>{const s=Ir.findOne(f,l);s&&s.classList.toggle(x,n)};d(r8,cp),d(Mge,zC),l.setAttribute("aria-expanded",n)}_setAttributeIfNotExists(e,n,l){e.hasAttribute(n)||e.setAttribute(n,l)}_elemIsActive(e){return e.classList.contains(cp)}_getInnerElement(e){return e.matches(BC)?e:Ir.findOne(BC,e)}_getOuterElement(e){return e.closest(Lge)||e}static jQueryInterface(e){return this.each(function(){const n=Xg.getOrCreateInstance(this);if(typeof e=="string"){if(n[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);n[e]()}})}}pn.on(document,Ige,i8,function(t){["A","AREA"].includes(this.tagName)&&t.preventDefault(),!tf(this)&&Xg.getOrCreateInstance(this).show()});pn.on(window,Pge,()=>{for(const t of Ir.find(Fge))Xg.getOrCreateInstance(t)});$l(Xg);const Bge="toast",Nge="bs.toast",ff=`.${Nge}`,Vge=`mouseover${ff}`,$ge=`mouseout${ff}`,Uge=`focusin${ff}`,jge=`focusout${ff}`,Gge=`hide${ff}`,Hge=`hidden${ff}`,Wge=`show${ff}`,qge=`shown${ff}`,Kge="fade",f4="hide",Ix="show",Ax="showing",Zge={animation:"boolean",autohide:"boolean",delay:"number"},Xge={animation:!0,autohide:!0,delay:5e3};class KT extends vc{constructor(e,n){super(e,n),this._timeout=null,this._hasMouseInteraction=!1,this._hasKeyboardInteraction=!1,this._setListeners()}static get Default(){return Xge}static get DefaultType(){return Zge}static get NAME(){return Bge}show(){if(pn.trigger(this._element,Wge).defaultPrevented)return;this._clearTimeout(),this._config.animation&&this._element.classList.add(Kge);const n=()=>{this._element.classList.remove(Ax),pn.trigger(this._element,qge),this._maybeScheduleHide()};this._element.classList.remove(f4),hb(this._element),this._element.classList.add(Ix,Ax),this._queueCallback(n,this._element,this._config.animation)}hide(){if(!this.isShown()||pn.trigger(this._element,Gge).defaultPrevented)return;const n=()=>{this._element.classList.add(f4),this._element.classList.remove(Ax,Ix),pn.trigger(this._element,Hge)};this._element.classList.add(Ax),this._queueCallback(n,this._element,this._config.animation)}dispose(){this._clearTimeout(),this.isShown()&&this._element.classList.remove(Ix),super.dispose()}isShown(){return this._element.classList.contains(Ix)}_maybeScheduleHide(){this._config.autohide&&(this._hasMouseInteraction||this._hasKeyboardInteraction||(this._timeout=setTimeout(()=>{this.hide()},this._config.delay)))}_onInteraction(e,n){switch(e.type){case"mouseover":case"mouseout":{this._hasMouseInteraction=n;break}case"focusin":case"focusout":{this._hasKeyboardInteraction=n;break}}if(n){this._clearTimeout();return}const l=e.relatedTarget;this._element===l||this._element.contains(l)||this._maybeScheduleHide()}_setListeners(){pn.on(this._element,Vge,e=>this._onInteraction(e,!0)),pn.on(this._element,$ge,e=>this._onInteraction(e,!1)),pn.on(this._element,Uge,e=>this._onInteraction(e,!0)),pn.on(this._element,jge,e=>this._onInteraction(e,!1))}_clearTimeout(){clearTimeout(this._timeout),this._timeout=null}static jQueryInterface(e){return this.each(function(){const n=KT.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof n[e]>"u")throw new TypeError(`No method named "${e}"`);n[e](this)}})}}GT(KT);$l(KT);function N0(t){"@babel/helpers - typeof";return N0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},N0(t)}function p4(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);e&&(l=l.filter(function(d){return Object.getOwnPropertyDescriptor(t,d).enumerable})),n.push.apply(n,l)}return n}function Px(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?p4(Object(n),!0).forEach(function(l){Yge(t,l,n[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):p4(Object(n)).forEach(function(l){Object.defineProperty(t,l,Object.getOwnPropertyDescriptor(n,l))})}return t}function Yge(t,e,n){return(e=Jge(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Jge(t){var e=Qge(t,"string");return N0(e)=="symbol"?e:e+""}function Qge(t,e){if(N0(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var l=n.call(t,e);if(N0(l)!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var e_e={ripple:!1,inputStyle:null,inputVariant:null,locale:{startsWith:"Starts with",contains:"Contains",notContains:"Not contains",endsWith:"Ends with",equals:"Equals",notEquals:"Not equals",noFilter:"No Filter",lt:"Less than",lte:"Less than or equal to",gt:"Greater than",gte:"Greater than or equal to",dateIs:"Date is",dateIsNot:"Date is not",dateBefore:"Date is before",dateAfter:"Date is after",clear:"Clear",apply:"Apply",matchAll:"Match All",matchAny:"Match Any",addRule:"Add Rule",removeRule:"Remove Rule",accept:"Yes",reject:"No",choose:"Choose",upload:"Upload",cancel:"Cancel",completed:"Completed",pending:"Pending",fileSizeTypes:["B","KB","MB","GB","TB","PB","EB","ZB","YB"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],chooseYear:"Choose Year",chooseMonth:"Choose Month",chooseDate:"Choose Date",prevDecade:"Previous Decade",nextDecade:"Next Decade",prevYear:"Previous Year",nextYear:"Next Year",prevMonth:"Previous Month",nextMonth:"Next Month",prevHour:"Previous Hour",nextHour:"Next Hour",prevMinute:"Previous Minute",nextMinute:"Next Minute",prevSecond:"Previous Second",nextSecond:"Next Second",am:"am",pm:"pm",today:"Today",weekHeader:"Wk",firstDayOfWeek:0,showMonthAfterYear:!1,dateFormat:"mm/dd/yy",weak:"Weak",medium:"Medium",strong:"Strong",passwordPrompt:"Enter a password",emptyFilterMessage:"No results found",searchMessage:"{0} results are available",selectionMessage:"{0} items selected",emptySelectionMessage:"No selected item",emptySearchMessage:"No results found",fileChosenMessage:"{0} files",noFileChosenMessage:"No file chosen",emptyMessage:"No available options",aria:{trueLabel:"True",falseLabel:"False",nullLabel:"Not Selected",star:"1 star",stars:"{star} stars",selectAll:"All items selected",unselectAll:"All items unselected",close:"Close",previous:"Previous",next:"Next",navigation:"Navigation",scrollTop:"Scroll Top",moveTop:"Move Top",moveUp:"Move Up",moveDown:"Move Down",moveBottom:"Move Bottom",moveToTarget:"Move to Target",moveToSource:"Move to Source",moveAllToTarget:"Move All to Target",moveAllToSource:"Move All to Source",pageLabel:"Page {page}",firstPageLabel:"First Page",lastPageLabel:"Last Page",nextPageLabel:"Next Page",prevPageLabel:"Previous Page",rowsPerPageLabel:"Rows per page",jumpToPageDropdownLabel:"Jump to Page Dropdown",jumpToPageInputLabel:"Jump to Page Input",selectRow:"Row Selected",unselectRow:"Row Unselected",expandRow:"Row Expanded",collapseRow:"Row Collapsed",showFilterMenu:"Show Filter Menu",hideFilterMenu:"Hide Filter Menu",filterOperator:"Filter Operator",filterConstraint:"Filter Constraint",editRow:"Row Edit",saveEdit:"Save Edit",cancelEdit:"Cancel Edit",listView:"List View",gridView:"Grid View",slide:"Slide",slideNumber:"{slideNumber}",zoomImage:"Zoom Image",zoomIn:"Zoom In",zoomOut:"Zoom Out",rotateRight:"Rotate Right",rotateLeft:"Rotate Left",listLabel:"Option List"}},filterMatchModeOptions:{text:[lo.STARTS_WITH,lo.CONTAINS,lo.NOT_CONTAINS,lo.ENDS_WITH,lo.EQUALS,lo.NOT_EQUALS],numeric:[lo.EQUALS,lo.NOT_EQUALS,lo.LESS_THAN,lo.LESS_THAN_OR_EQUAL_TO,lo.GREATER_THAN,lo.GREATER_THAN_OR_EQUAL_TO],date:[lo.DATE_IS,lo.DATE_IS_NOT,lo.DATE_BEFORE,lo.DATE_AFTER]},zIndex:{modal:1100,overlay:1e3,menu:1e3,tooltip:1100},theme:void 0,unstyled:!1,pt:void 0,ptOptions:{mergeSections:!0,mergeProps:!1},csp:{nonce:void 0}},t_e=Symbol();function n_e(t,e){var n={config:Fl(e)};return t.config.globalProperties.$primevue=n,t.provide(t_e,n),r_e(),i_e(t,n),n}var _g=[];function r_e(){Vs.clear(),_g.forEach(function(t){return t?.()}),_g=[]}function i_e(t,e){var n=bi(!1),l=function(){var P;if(((P=e.config)===null||P===void 0?void 0:P.theme)!=="none"&&!vo.isStyleNameLoaded("common")){var L,$,V=((L=xi.getCommonTheme)===null||L===void 0?void 0:L.call(xi))||{},j=V.primitive,ue=V.semantic,de=V.global,Te=V.style,Be={nonce:($=e.config)===null||$===void 0||($=$.csp)===null||$===void 0?void 0:$.nonce};xi.load(j?.css,Px({name:"primitive-variables"},Be)),xi.load(ue?.css,Px({name:"semantic-variables"},Be)),xi.load(de?.css,Px({name:"global-variables"},Be)),xi.loadStyle(Px({name:"global-style"},Be),Te),vo.setLoadedStyleName("common")}};Vs.on("theme:change",function(C){n.value||(t.config.globalProperties.$primevue.config.theme=C,n.value=!0)});var d=ru(e.config,function(C,P){zh.emit("config:change",{newValue:C,oldValue:P})},{immediate:!0,deep:!0}),f=ru(function(){return e.config.ripple},function(C,P){zh.emit("config:ripple:change",{newValue:C,oldValue:P})},{immediate:!0,deep:!0}),x=ru(function(){return e.config.theme},function(C,P){n.value||vo.setTheme(C),e.config.unstyled||l(),n.value=!1,zh.emit("config:theme:change",{newValue:C,oldValue:P})},{immediate:!0,deep:!1}),s=ru(function(){return e.config.unstyled},function(C,P){!C&&e.config.theme&&l(),zh.emit("config:unstyled:change",{newValue:C,oldValue:P})},{immediate:!0,deep:!0});_g.push(d),_g.push(f),_g.push(x),_g.push(s)}var o_e={install:function(e,n){var l=aee(e_e,n);n_e(e,l)}},s_e={transitionDuration:"{transition.duration}"},a_e={borderWidth:"0 0 1px 0",borderColor:"{content.border.color}"},l_e={color:"{text.muted.color}",hoverColor:"{text.color}",activeColor:"{text.color}",activeHoverColor:"{text.color}",padding:"1.125rem",fontWeight:"600",borderRadius:"0",borderWidth:"0",borderColor:"{content.border.color}",background:"{content.background}",hoverBackground:"{content.background}",activeBackground:"{content.background}",activeHoverBackground:"{content.background}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"-1px",shadow:"{focus.ring.shadow}"},toggleIcon:{color:"{text.muted.color}",hoverColor:"{text.color}",activeColor:"{text.color}",activeHoverColor:"{text.color}"},first:{topBorderRadius:"{content.border.radius}",borderWidth:"0"},last:{bottomBorderRadius:"{content.border.radius}",activeBottomBorderRadius:"0"}},c_e={borderWidth:"0",borderColor:"{content.border.color}",background:"{content.background}",color:"{text.color}",padding:"0 1.125rem 1.125rem 1.125rem"},u_e={root:s_e,panel:a_e,header:l_e,content:c_e},d_e={background:"{form.field.background}",disabledBackground:"{form.field.disabled.background}",filledBackground:"{form.field.filled.background}",filledHoverBackground:"{form.field.filled.hover.background}",filledFocusBackground:"{form.field.filled.focus.background}",borderColor:"{form.field.border.color}",hoverBorderColor:"{form.field.hover.border.color}",focusBorderColor:"{form.field.focus.border.color}",invalidBorderColor:"{form.field.invalid.border.color}",color:"{form.field.color}",disabledColor:"{form.field.disabled.color}",placeholderColor:"{form.field.placeholder.color}",invalidPlaceholderColor:"{form.field.invalid.placeholder.color}",shadow:"{form.field.shadow}",paddingX:"{form.field.padding.x}",paddingY:"{form.field.padding.y}",borderRadius:"{form.field.border.radius}",focusRing:{width:"{form.field.focus.ring.width}",style:"{form.field.focus.ring.style}",color:"{form.field.focus.ring.color}",offset:"{form.field.focus.ring.offset}",shadow:"{form.field.focus.ring.shadow}"},transitionDuration:"{form.field.transition.duration}"},h_e={background:"{overlay.select.background}",borderColor:"{overlay.select.border.color}",borderRadius:"{overlay.select.border.radius}",color:"{overlay.select.color}",shadow:"{overlay.select.shadow}"},f_e={padding:"{list.padding}",gap:"{list.gap}"},p_e={focusBackground:"{list.option.focus.background}",selectedBackground:"{list.option.selected.background}",selectedFocusBackground:"{list.option.selected.focus.background}",color:"{list.option.color}",focusColor:"{list.option.focus.color}",selectedColor:"{list.option.selected.color}",selectedFocusColor:"{list.option.selected.focus.color}",padding:"{list.option.padding}",borderRadius:"{list.option.border.radius}"},m_e={background:"{list.option.group.background}",color:"{list.option.group.color}",fontWeight:"{list.option.group.font.weight}",padding:"{list.option.group.padding}"},g_e={width:"2.5rem",sm:{width:"2rem"},lg:{width:"3rem"},borderColor:"{form.field.border.color}",hoverBorderColor:"{form.field.border.color}",activeBorderColor:"{form.field.border.color}",borderRadius:"{form.field.border.radius}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},__e={borderRadius:"{border.radius.sm}"},y_e={padding:"{list.option.padding}"},v_e={light:{chip:{focusBackground:"{surface.200}",focusColor:"{surface.800}"},dropdown:{background:"{surface.100}",hoverBackground:"{surface.200}",activeBackground:"{surface.300}",color:"{surface.600}",hoverColor:"{surface.700}",activeColor:"{surface.800}"}},dark:{chip:{focusBackground:"{surface.700}",focusColor:"{surface.0}"},dropdown:{background:"{surface.800}",hoverBackground:"{surface.700}",activeBackground:"{surface.600}",color:"{surface.300}",hoverColor:"{surface.200}",activeColor:"{surface.100}"}}},b_e={root:d_e,overlay:h_e,list:f_e,option:p_e,optionGroup:m_e,dropdown:g_e,chip:__e,emptyMessage:y_e,colorScheme:v_e},x_e={width:"2rem",height:"2rem",fontSize:"1rem",background:"{content.border.color}",color:"{content.color}",borderRadius:"{content.border.radius}"},w_e={size:"1rem"},T_e={borderColor:"{content.background}",offset:"-0.75rem"},S_e={width:"3rem",height:"3rem",fontSize:"1.5rem",icon:{size:"1.5rem"},group:{offset:"-1rem"}},E_e={width:"4rem",height:"4rem",fontSize:"2rem",icon:{size:"2rem"},group:{offset:"-1.5rem"}},C_e={root:x_e,icon:w_e,group:T_e,lg:S_e,xl:E_e},I_e={borderRadius:"{border.radius.md}",padding:"0 0.5rem",fontSize:"0.75rem",fontWeight:"700",minWidth:"1.5rem",height:"1.5rem"},A_e={size:"0.5rem"},P_e={fontSize:"0.625rem",minWidth:"1.25rem",height:"1.25rem"},R_e={fontSize:"0.875rem",minWidth:"1.75rem",height:"1.75rem"},k_e={fontSize:"1rem",minWidth:"2rem",height:"2rem"},O_e={light:{primary:{background:"{primary.color}",color:"{primary.contrast.color}"},secondary:{background:"{surface.100}",color:"{surface.600}"},success:{background:"{green.500}",color:"{surface.0}"},info:{background:"{sky.500}",color:"{surface.0}"},warn:{background:"{orange.500}",color:"{surface.0}"},danger:{background:"{red.500}",color:"{surface.0}"},contrast:{background:"{surface.950}",color:"{surface.0}"}},dark:{primary:{background:"{primary.color}",color:"{primary.contrast.color}"},secondary:{background:"{surface.800}",color:"{surface.300}"},success:{background:"{green.400}",color:"{green.950}"},info:{background:"{sky.400}",color:"{sky.950}"},warn:{background:"{orange.400}",color:"{orange.950}"},danger:{background:"{red.400}",color:"{red.950}"},contrast:{background:"{surface.0}",color:"{surface.950}"}}},M_e={root:I_e,dot:A_e,sm:P_e,lg:R_e,xl:k_e,colorScheme:O_e},D_e={borderRadius:{none:"0",xs:"2px",sm:"4px",md:"6px",lg:"8px",xl:"12px"},emerald:{50:"#ecfdf5",100:"#d1fae5",200:"#a7f3d0",300:"#6ee7b7",400:"#34d399",500:"#10b981",600:"#059669",700:"#047857",800:"#065f46",900:"#064e3b",950:"#022c22"},green:{50:"#f0fdf4",100:"#dcfce7",200:"#bbf7d0",300:"#86efac",400:"#4ade80",500:"#22c55e",600:"#16a34a",700:"#15803d",800:"#166534",900:"#14532d",950:"#052e16"},lime:{50:"#f7fee7",100:"#ecfccb",200:"#d9f99d",300:"#bef264",400:"#a3e635",500:"#84cc16",600:"#65a30d",700:"#4d7c0f",800:"#3f6212",900:"#365314",950:"#1a2e05"},red:{50:"#fef2f2",100:"#fee2e2",200:"#fecaca",300:"#fca5a5",400:"#f87171",500:"#ef4444",600:"#dc2626",700:"#b91c1c",800:"#991b1b",900:"#7f1d1d",950:"#450a0a"},orange:{50:"#fff7ed",100:"#ffedd5",200:"#fed7aa",300:"#fdba74",400:"#fb923c",500:"#f97316",600:"#ea580c",700:"#c2410c",800:"#9a3412",900:"#7c2d12",950:"#431407"},amber:{50:"#fffbeb",100:"#fef3c7",200:"#fde68a",300:"#fcd34d",400:"#fbbf24",500:"#f59e0b",600:"#d97706",700:"#b45309",800:"#92400e",900:"#78350f",950:"#451a03"},yellow:{50:"#fefce8",100:"#fef9c3",200:"#fef08a",300:"#fde047",400:"#facc15",500:"#eab308",600:"#ca8a04",700:"#a16207",800:"#854d0e",900:"#713f12",950:"#422006"},teal:{50:"#f0fdfa",100:"#ccfbf1",200:"#99f6e4",300:"#5eead4",400:"#2dd4bf",500:"#14b8a6",600:"#0d9488",700:"#0f766e",800:"#115e59",900:"#134e4a",950:"#042f2e"},cyan:{50:"#ecfeff",100:"#cffafe",200:"#a5f3fc",300:"#67e8f9",400:"#22d3ee",500:"#06b6d4",600:"#0891b2",700:"#0e7490",800:"#155e75",900:"#164e63",950:"#083344"},sky:{50:"#f0f9ff",100:"#e0f2fe",200:"#bae6fd",300:"#7dd3fc",400:"#38bdf8",500:"#0ea5e9",600:"#0284c7",700:"#0369a1",800:"#075985",900:"#0c4a6e",950:"#082f49"},blue:{50:"#eff6ff",100:"#dbeafe",200:"#bfdbfe",300:"#93c5fd",400:"#60a5fa",500:"#3b82f6",600:"#2563eb",700:"#1d4ed8",800:"#1e40af",900:"#1e3a8a",950:"#172554"},indigo:{50:"#eef2ff",100:"#e0e7ff",200:"#c7d2fe",300:"#a5b4fc",400:"#818cf8",500:"#6366f1",600:"#4f46e5",700:"#4338ca",800:"#3730a3",900:"#312e81",950:"#1e1b4b"},violet:{50:"#f5f3ff",100:"#ede9fe",200:"#ddd6fe",300:"#c4b5fd",400:"#a78bfa",500:"#8b5cf6",600:"#7c3aed",700:"#6d28d9",800:"#5b21b6",900:"#4c1d95",950:"#2e1065"},purple:{50:"#faf5ff",100:"#f3e8ff",200:"#e9d5ff",300:"#d8b4fe",400:"#c084fc",500:"#a855f7",600:"#9333ea",700:"#7e22ce",800:"#6b21a8",900:"#581c87",950:"#3b0764"},fuchsia:{50:"#fdf4ff",100:"#fae8ff",200:"#f5d0fe",300:"#f0abfc",400:"#e879f9",500:"#d946ef",600:"#c026d3",700:"#a21caf",800:"#86198f",900:"#701a75",950:"#4a044e"},pink:{50:"#fdf2f8",100:"#fce7f3",200:"#fbcfe8",300:"#f9a8d4",400:"#f472b6",500:"#ec4899",600:"#db2777",700:"#be185d",800:"#9d174d",900:"#831843",950:"#500724"},rose:{50:"#fff1f2",100:"#ffe4e6",200:"#fecdd3",300:"#fda4af",400:"#fb7185",500:"#f43f5e",600:"#e11d48",700:"#be123c",800:"#9f1239",900:"#881337",950:"#4c0519"},slate:{50:"#f8fafc",100:"#f1f5f9",200:"#e2e8f0",300:"#cbd5e1",400:"#94a3b8",500:"#64748b",600:"#475569",700:"#334155",800:"#1e293b",900:"#0f172a",950:"#020617"},gray:{50:"#f9fafb",100:"#f3f4f6",200:"#e5e7eb",300:"#d1d5db",400:"#9ca3af",500:"#6b7280",600:"#4b5563",700:"#374151",800:"#1f2937",900:"#111827",950:"#030712"},zinc:{50:"#fafafa",100:"#f4f4f5",200:"#e4e4e7",300:"#d4d4d8",400:"#a1a1aa",500:"#71717a",600:"#52525b",700:"#3f3f46",800:"#27272a",900:"#18181b",950:"#09090b"},neutral:{50:"#fafafa",100:"#f5f5f5",200:"#e5e5e5",300:"#d4d4d4",400:"#a3a3a3",500:"#737373",600:"#525252",700:"#404040",800:"#262626",900:"#171717",950:"#0a0a0a"},stone:{50:"#fafaf9",100:"#f5f5f4",200:"#e7e5e4",300:"#d6d3d1",400:"#a8a29e",500:"#78716c",600:"#57534e",700:"#44403c",800:"#292524",900:"#1c1917",950:"#0c0a09"}},L_e={transitionDuration:"0.2s",focusRing:{width:"1px",style:"solid",color:"{primary.color}",offset:"2px",shadow:"none"},disabledOpacity:"0.6",iconSize:"1rem",anchorGutter:"2px",primary:{50:"{emerald.50}",100:"{emerald.100}",200:"{emerald.200}",300:"{emerald.300}",400:"{emerald.400}",500:"{emerald.500}",600:"{emerald.600}",700:"{emerald.700}",800:"{emerald.800}",900:"{emerald.900}",950:"{emerald.950}"},formField:{paddingX:"0.75rem",paddingY:"0.5rem",sm:{fontSize:"0.875rem",paddingX:"0.625rem",paddingY:"0.375rem"},lg:{fontSize:"1.125rem",paddingX:"0.875rem",paddingY:"0.625rem"},borderRadius:"{border.radius.md}",focusRing:{width:"0",style:"none",color:"transparent",offset:"0",shadow:"none"},transitionDuration:"{transition.duration}"},list:{padding:"0.25rem 0.25rem",gap:"2px",header:{padding:"0.5rem 1rem 0.25rem 1rem"},option:{padding:"0.5rem 0.75rem",borderRadius:"{border.radius.sm}"},optionGroup:{padding:"0.5rem 0.75rem",fontWeight:"600"}},content:{borderRadius:"{border.radius.md}"},mask:{transitionDuration:"0.15s"},navigation:{list:{padding:"0.25rem 0.25rem",gap:"2px"},item:{padding:"0.5rem 0.75rem",borderRadius:"{border.radius.sm}",gap:"0.5rem"},submenuLabel:{padding:"0.5rem 0.75rem",fontWeight:"600"},submenuIcon:{size:"0.875rem"}},overlay:{select:{borderRadius:"{border.radius.md}",shadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -2px rgba(0, 0, 0, 0.1)"},popover:{borderRadius:"{border.radius.md}",padding:"0.75rem",shadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -2px rgba(0, 0, 0, 0.1)"},modal:{borderRadius:"{border.radius.xl}",padding:"1.25rem",shadow:"0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 8px 10px -6px rgba(0, 0, 0, 0.1)"},navigation:{shadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -2px rgba(0, 0, 0, 0.1)"}},colorScheme:{light:{surface:{0:"#ffffff",50:"{slate.50}",100:"{slate.100}",200:"{slate.200}",300:"{slate.300}",400:"{slate.400}",500:"{slate.500}",600:"{slate.600}",700:"{slate.700}",800:"{slate.800}",900:"{slate.900}",950:"{slate.950}"},primary:{color:"{primary.500}",contrastColor:"#ffffff",hoverColor:"{primary.600}",activeColor:"{primary.700}"},highlight:{background:"{primary.50}",focusBackground:"{primary.100}",color:"{primary.700}",focusColor:"{primary.800}"},mask:{background:"rgba(0,0,0,0.4)",color:"{surface.200}"},formField:{background:"{surface.0}",disabledBackground:"{surface.200}",filledBackground:"{surface.50}",filledHoverBackground:"{surface.50}",filledFocusBackground:"{surface.50}",borderColor:"{surface.300}",hoverBorderColor:"{surface.400}",focusBorderColor:"{primary.color}",invalidBorderColor:"{red.400}",color:"{surface.700}",disabledColor:"{surface.500}",placeholderColor:"{surface.500}",invalidPlaceholderColor:"{red.600}",floatLabelColor:"{surface.500}",floatLabelFocusColor:"{primary.600}",floatLabelActiveColor:"{surface.500}",floatLabelInvalidColor:"{form.field.invalid.placeholder.color}",iconColor:"{surface.400}",shadow:"0 0 #0000, 0 0 #0000, 0 1px 2px 0 rgba(18, 18, 23, 0.05)"},text:{color:"{surface.700}",hoverColor:"{surface.800}",mutedColor:"{surface.500}",hoverMutedColor:"{surface.600}"},content:{background:"{surface.0}",hoverBackground:"{surface.100}",borderColor:"{surface.200}",color:"{text.color}",hoverColor:"{text.hover.color}"},overlay:{select:{background:"{surface.0}",borderColor:"{surface.200}",color:"{text.color}"},popover:{background:"{surface.0}",borderColor:"{surface.200}",color:"{text.color}"},modal:{background:"{surface.0}",borderColor:"{surface.200}",color:"{text.color}"}},list:{option:{focusBackground:"{surface.100}",selectedBackground:"{highlight.background}",selectedFocusBackground:"{highlight.focus.background}",color:"{text.color}",focusColor:"{text.hover.color}",selectedColor:"{highlight.color}",selectedFocusColor:"{highlight.focus.color}",icon:{color:"{surface.400}",focusColor:"{surface.500}"}},optionGroup:{background:"transparent",color:"{text.muted.color}"}},navigation:{item:{focusBackground:"{surface.100}",activeBackground:"{surface.100}",color:"{text.color}",focusColor:"{text.hover.color}",activeColor:"{text.hover.color}",icon:{color:"{surface.400}",focusColor:"{surface.500}",activeColor:"{surface.500}"}},submenuLabel:{background:"transparent",color:"{text.muted.color}"},submenuIcon:{color:"{surface.400}",focusColor:"{surface.500}",activeColor:"{surface.500}"}}},dark:{surface:{0:"#ffffff",50:"{zinc.50}",100:"{zinc.100}",200:"{zinc.200}",300:"{zinc.300}",400:"{zinc.400}",500:"{zinc.500}",600:"{zinc.600}",700:"{zinc.700}",800:"{zinc.800}",900:"{zinc.900}",950:"{zinc.950}"},primary:{color:"{primary.400}",contrastColor:"{surface.900}",hoverColor:"{primary.300}",activeColor:"{primary.200}"},highlight:{background:"color-mix(in srgb, {primary.400}, transparent 84%)",focusBackground:"color-mix(in srgb, {primary.400}, transparent 76%)",color:"rgba(255,255,255,.87)",focusColor:"rgba(255,255,255,.87)"},mask:{background:"rgba(0,0,0,0.6)",color:"{surface.200}"},formField:{background:"{surface.950}",disabledBackground:"{surface.700}",filledBackground:"{surface.800}",filledHoverBackground:"{surface.800}",filledFocusBackground:"{surface.800}",borderColor:"{surface.600}",hoverBorderColor:"{surface.500}",focusBorderColor:"{primary.color}",invalidBorderColor:"{red.300}",color:"{surface.0}",disabledColor:"{surface.400}",placeholderColor:"{surface.400}",invalidPlaceholderColor:"{red.400}",floatLabelColor:"{surface.400}",floatLabelFocusColor:"{primary.color}",floatLabelActiveColor:"{surface.400}",floatLabelInvalidColor:"{form.field.invalid.placeholder.color}",iconColor:"{surface.400}",shadow:"0 0 #0000, 0 0 #0000, 0 1px 2px 0 rgba(18, 18, 23, 0.05)"},text:{color:"{surface.0}",hoverColor:"{surface.0}",mutedColor:"{surface.400}",hoverMutedColor:"{surface.300}"},content:{background:"{surface.900}",hoverBackground:"{surface.800}",borderColor:"{surface.700}",color:"{text.color}",hoverColor:"{text.hover.color}"},overlay:{select:{background:"{surface.900}",borderColor:"{surface.700}",color:"{text.color}"},popover:{background:"{surface.900}",borderColor:"{surface.700}",color:"{text.color}"},modal:{background:"{surface.900}",borderColor:"{surface.700}",color:"{text.color}"}},list:{option:{focusBackground:"{surface.800}",selectedBackground:"{highlight.background}",selectedFocusBackground:"{highlight.focus.background}",color:"{text.color}",focusColor:"{text.hover.color}",selectedColor:"{highlight.color}",selectedFocusColor:"{highlight.focus.color}",icon:{color:"{surface.500}",focusColor:"{surface.400}"}},optionGroup:{background:"transparent",color:"{text.muted.color}"}},navigation:{item:{focusBackground:"{surface.800}",activeBackground:"{surface.800}",color:"{text.color}",focusColor:"{text.hover.color}",activeColor:"{text.hover.color}",icon:{color:"{surface.500}",focusColor:"{surface.400}",activeColor:"{surface.400}"}},submenuLabel:{background:"transparent",color:"{text.muted.color}"},submenuIcon:{color:"{surface.500}",focusColor:"{surface.400}",activeColor:"{surface.400}"}}}}},z_e={primitive:D_e,semantic:L_e},F_e={borderRadius:"{content.border.radius}"},B_e={root:F_e},N_e={padding:"1rem",background:"{content.background}",gap:"0.5rem",transitionDuration:"{transition.duration}"},V_e={color:"{text.muted.color}",hoverColor:"{text.color}",borderRadius:"{content.border.radius}",gap:"{navigation.item.gap}",icon:{color:"{navigation.item.icon.color}",hoverColor:"{navigation.item.icon.focus.color}"},focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},$_e={color:"{navigation.item.icon.color}"},U_e={root:N_e,item:V_e,separator:$_e},j_e={borderRadius:"{form.field.border.radius}",roundedBorderRadius:"2rem",gap:"0.5rem",paddingX:"{form.field.padding.x}",paddingY:"{form.field.padding.y}",iconOnlyWidth:"2.5rem",sm:{fontSize:"{form.field.sm.font.size}",paddingX:"{form.field.sm.padding.x}",paddingY:"{form.field.sm.padding.y}",iconOnlyWidth:"2rem"},lg:{fontSize:"{form.field.lg.font.size}",paddingX:"{form.field.lg.padding.x}",paddingY:"{form.field.lg.padding.y}",iconOnlyWidth:"3rem"},label:{fontWeight:"500"},raisedShadow:"0 3px 1px -2px rgba(0, 0, 0, 0.2), 0 2px 2px 0 rgba(0, 0, 0, 0.14), 0 1px 5px 0 rgba(0, 0, 0, 0.12)",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",offset:"{focus.ring.offset}"},badgeSize:"1rem",transitionDuration:"{form.field.transition.duration}"},G_e={light:{root:{primary:{background:"{primary.color}",hoverBackground:"{primary.hover.color}",activeBackground:"{primary.active.color}",borderColor:"{primary.color}",hoverBorderColor:"{primary.hover.color}",activeBorderColor:"{primary.active.color}",color:"{primary.contrast.color}",hoverColor:"{primary.contrast.color}",activeColor:"{primary.contrast.color}",focusRing:{color:"{primary.color}",shadow:"none"}},secondary:{background:"{surface.100}",hoverBackground:"{surface.200}",activeBackground:"{surface.300}",borderColor:"{surface.100}",hoverBorderColor:"{surface.200}",activeBorderColor:"{surface.300}",color:"{surface.600}",hoverColor:"{surface.700}",activeColor:"{surface.800}",focusRing:{color:"{surface.600}",shadow:"none"}},info:{background:"{sky.500}",hoverBackground:"{sky.600}",activeBackground:"{sky.700}",borderColor:"{sky.500}",hoverBorderColor:"{sky.600}",activeBorderColor:"{sky.700}",color:"#ffffff",hoverColor:"#ffffff",activeColor:"#ffffff",focusRing:{color:"{sky.500}",shadow:"none"}},success:{background:"{green.500}",hoverBackground:"{green.600}",activeBackground:"{green.700}",borderColor:"{green.500}",hoverBorderColor:"{green.600}",activeBorderColor:"{green.700}",color:"#ffffff",hoverColor:"#ffffff",activeColor:"#ffffff",focusRing:{color:"{green.500}",shadow:"none"}},warn:{background:"{orange.500}",hoverBackground:"{orange.600}",activeBackground:"{orange.700}",borderColor:"{orange.500}",hoverBorderColor:"{orange.600}",activeBorderColor:"{orange.700}",color:"#ffffff",hoverColor:"#ffffff",activeColor:"#ffffff",focusRing:{color:"{orange.500}",shadow:"none"}},help:{background:"{purple.500}",hoverBackground:"{purple.600}",activeBackground:"{purple.700}",borderColor:"{purple.500}",hoverBorderColor:"{purple.600}",activeBorderColor:"{purple.700}",color:"#ffffff",hoverColor:"#ffffff",activeColor:"#ffffff",focusRing:{color:"{purple.500}",shadow:"none"}},danger:{background:"{red.500}",hoverBackground:"{red.600}",activeBackground:"{red.700}",borderColor:"{red.500}",hoverBorderColor:"{red.600}",activeBorderColor:"{red.700}",color:"#ffffff",hoverColor:"#ffffff",activeColor:"#ffffff",focusRing:{color:"{red.500}",shadow:"none"}},contrast:{background:"{surface.950}",hoverBackground:"{surface.900}",activeBackground:"{surface.800}",borderColor:"{surface.950}",hoverBorderColor:"{surface.900}",activeBorderColor:"{surface.800}",color:"{surface.0}",hoverColor:"{surface.0}",activeColor:"{surface.0}",focusRing:{color:"{surface.950}",shadow:"none"}}},outlined:{primary:{hoverBackground:"{primary.50}",activeBackground:"{primary.100}",borderColor:"{primary.200}",color:"{primary.color}"},secondary:{hoverBackground:"{surface.50}",activeBackground:"{surface.100}",borderColor:"{surface.200}",color:"{surface.500}"},success:{hoverBackground:"{green.50}",activeBackground:"{green.100}",borderColor:"{green.200}",color:"{green.500}"},info:{hoverBackground:"{sky.50}",activeBackground:"{sky.100}",borderColor:"{sky.200}",color:"{sky.500}"},warn:{hoverBackground:"{orange.50}",activeBackground:"{orange.100}",borderColor:"{orange.200}",color:"{orange.500}"},help:{hoverBackground:"{purple.50}",activeBackground:"{purple.100}",borderColor:"{purple.200}",color:"{purple.500}"},danger:{hoverBackground:"{red.50}",activeBackground:"{red.100}",borderColor:"{red.200}",color:"{red.500}"},contrast:{hoverBackground:"{surface.50}",activeBackground:"{surface.100}",borderColor:"{surface.700}",color:"{surface.950}"},plain:{hoverBackground:"{surface.50}",activeBackground:"{surface.100}",borderColor:"{surface.200}",color:"{surface.700}"}},text:{primary:{hoverBackground:"{primary.50}",activeBackground:"{primary.100}",color:"{primary.color}"},secondary:{hoverBackground:"{surface.50}",activeBackground:"{surface.100}",color:"{surface.500}"},success:{hoverBackground:"{green.50}",activeBackground:"{green.100}",color:"{green.500}"},info:{hoverBackground:"{sky.50}",activeBackground:"{sky.100}",color:"{sky.500}"},warn:{hoverBackground:"{orange.50}",activeBackground:"{orange.100}",color:"{orange.500}"},help:{hoverBackground:"{purple.50}",activeBackground:"{purple.100}",color:"{purple.500}"},danger:{hoverBackground:"{red.50}",activeBackground:"{red.100}",color:"{red.500}"},contrast:{hoverBackground:"{surface.50}",activeBackground:"{surface.100}",color:"{surface.950}"},plain:{hoverBackground:"{surface.50}",activeBackground:"{surface.100}",color:"{surface.700}"}},link:{color:"{primary.color}",hoverColor:"{primary.color}",activeColor:"{primary.color}"}},dark:{root:{primary:{background:"{primary.color}",hoverBackground:"{primary.hover.color}",activeBackground:"{primary.active.color}",borderColor:"{primary.color}",hoverBorderColor:"{primary.hover.color}",activeBorderColor:"{primary.active.color}",color:"{primary.contrast.color}",hoverColor:"{primary.contrast.color}",activeColor:"{primary.contrast.color}",focusRing:{color:"{primary.color}",shadow:"none"}},secondary:{background:"{surface.800}",hoverBackground:"{surface.700}",activeBackground:"{surface.600}",borderColor:"{surface.800}",hoverBorderColor:"{surface.700}",activeBorderColor:"{surface.600}",color:"{surface.300}",hoverColor:"{surface.200}",activeColor:"{surface.100}",focusRing:{color:"{surface.300}",shadow:"none"}},info:{background:"{sky.400}",hoverBackground:"{sky.300}",activeBackground:"{sky.200}",borderColor:"{sky.400}",hoverBorderColor:"{sky.300}",activeBorderColor:"{sky.200}",color:"{sky.950}",hoverColor:"{sky.950}",activeColor:"{sky.950}",focusRing:{color:"{sky.400}",shadow:"none"}},success:{background:"{green.400}",hoverBackground:"{green.300}",activeBackground:"{green.200}",borderColor:"{green.400}",hoverBorderColor:"{green.300}",activeBorderColor:"{green.200}",color:"{green.950}",hoverColor:"{green.950}",activeColor:"{green.950}",focusRing:{color:"{green.400}",shadow:"none"}},warn:{background:"{orange.400}",hoverBackground:"{orange.300}",activeBackground:"{orange.200}",borderColor:"{orange.400}",hoverBorderColor:"{orange.300}",activeBorderColor:"{orange.200}",color:"{orange.950}",hoverColor:"{orange.950}",activeColor:"{orange.950}",focusRing:{color:"{orange.400}",shadow:"none"}},help:{background:"{purple.400}",hoverBackground:"{purple.300}",activeBackground:"{purple.200}",borderColor:"{purple.400}",hoverBorderColor:"{purple.300}",activeBorderColor:"{purple.200}",color:"{purple.950}",hoverColor:"{purple.950}",activeColor:"{purple.950}",focusRing:{color:"{purple.400}",shadow:"none"}},danger:{background:"{red.400}",hoverBackground:"{red.300}",activeBackground:"{red.200}",borderColor:"{red.400}",hoverBorderColor:"{red.300}",activeBorderColor:"{red.200}",color:"{red.950}",hoverColor:"{red.950}",activeColor:"{red.950}",focusRing:{color:"{red.400}",shadow:"none"}},contrast:{background:"{surface.0}",hoverBackground:"{surface.100}",activeBackground:"{surface.200}",borderColor:"{surface.0}",hoverBorderColor:"{surface.100}",activeBorderColor:"{surface.200}",color:"{surface.950}",hoverColor:"{surface.950}",activeColor:"{surface.950}",focusRing:{color:"{surface.0}",shadow:"none"}}},outlined:{primary:{hoverBackground:"color-mix(in srgb, {primary.color}, transparent 96%)",activeBackground:"color-mix(in srgb, {primary.color}, transparent 84%)",borderColor:"{primary.700}",color:"{primary.color}"},secondary:{hoverBackground:"rgba(255,255,255,0.04)",activeBackground:"rgba(255,255,255,0.16)",borderColor:"{surface.700}",color:"{surface.400}"},success:{hoverBackground:"color-mix(in srgb, {green.400}, transparent 96%)",activeBackground:"color-mix(in srgb, {green.400}, transparent 84%)",borderColor:"{green.700}",color:"{green.400}"},info:{hoverBackground:"color-mix(in srgb, {sky.400}, transparent 96%)",activeBackground:"color-mix(in srgb, {sky.400}, transparent 84%)",borderColor:"{sky.700}",color:"{sky.400}"},warn:{hoverBackground:"color-mix(in srgb, {orange.400}, transparent 96%)",activeBackground:"color-mix(in srgb, {orange.400}, transparent 84%)",borderColor:"{orange.700}",color:"{orange.400}"},help:{hoverBackground:"color-mix(in srgb, {purple.400}, transparent 96%)",activeBackground:"color-mix(in srgb, {purple.400}, transparent 84%)",borderColor:"{purple.700}",color:"{purple.400}"},danger:{hoverBackground:"color-mix(in srgb, {red.400}, transparent 96%)",activeBackground:"color-mix(in srgb, {red.400}, transparent 84%)",borderColor:"{red.700}",color:"{red.400}"},contrast:{hoverBackground:"{surface.800}",activeBackground:"{surface.700}",borderColor:"{surface.500}",color:"{surface.0}"},plain:{hoverBackground:"{surface.800}",activeBackground:"{surface.700}",borderColor:"{surface.600}",color:"{surface.0}"}},text:{primary:{hoverBackground:"color-mix(in srgb, {primary.color}, transparent 96%)",activeBackground:"color-mix(in srgb, {primary.color}, transparent 84%)",color:"{primary.color}"},secondary:{hoverBackground:"{surface.800}",activeBackground:"{surface.700}",color:"{surface.400}"},success:{hoverBackground:"color-mix(in srgb, {green.400}, transparent 96%)",activeBackground:"color-mix(in srgb, {green.400}, transparent 84%)",color:"{green.400}"},info:{hoverBackground:"color-mix(in srgb, {sky.400}, transparent 96%)",activeBackground:"color-mix(in srgb, {sky.400}, transparent 84%)",color:"{sky.400}"},warn:{hoverBackground:"color-mix(in srgb, {orange.400}, transparent 96%)",activeBackground:"color-mix(in srgb, {orange.400}, transparent 84%)",color:"{orange.400}"},help:{hoverBackground:"color-mix(in srgb, {purple.400}, transparent 96%)",activeBackground:"color-mix(in srgb, {purple.400}, transparent 84%)",color:"{purple.400}"},danger:{hoverBackground:"color-mix(in srgb, {red.400}, transparent 96%)",activeBackground:"color-mix(in srgb, {red.400}, transparent 84%)",color:"{red.400}"},contrast:{hoverBackground:"{surface.800}",activeBackground:"{surface.700}",color:"{surface.0}"},plain:{hoverBackground:"{surface.800}",activeBackground:"{surface.700}",color:"{surface.0}"}},link:{color:"{primary.color}",hoverColor:"{primary.color}",activeColor:"{primary.color}"}}},H_e={root:j_e,colorScheme:G_e},W_e={background:"{content.background}",borderRadius:"{border.radius.xl}",color:"{content.color}",shadow:"0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px -1px rgba(0, 0, 0, 0.1)"},q_e={padding:"1.25rem",gap:"0.5rem"},K_e={gap:"0.5rem"},Z_e={fontSize:"1.25rem",fontWeight:"500"},X_e={color:"{text.muted.color}"},Y_e={root:W_e,body:q_e,caption:K_e,title:Z_e,subtitle:X_e},J_e={transitionDuration:"{transition.duration}"},Q_e={gap:"0.25rem"},eye={padding:"1rem",gap:"0.5rem"},tye={width:"2rem",height:"0.5rem",borderRadius:"{content.border.radius}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},nye={light:{indicator:{background:"{surface.200}",hoverBackground:"{surface.300}",activeBackground:"{primary.color}"}},dark:{indicator:{background:"{surface.700}",hoverBackground:"{surface.600}",activeBackground:"{primary.color}"}}},rye={root:J_e,content:Q_e,indicatorList:eye,indicator:tye,colorScheme:nye},iye={background:"{form.field.background}",disabledBackground:"{form.field.disabled.background}",filledBackground:"{form.field.filled.background}",filledHoverBackground:"{form.field.filled.hover.background}",filledFocusBackground:"{form.field.filled.focus.background}",borderColor:"{form.field.border.color}",hoverBorderColor:"{form.field.hover.border.color}",focusBorderColor:"{form.field.focus.border.color}",invalidBorderColor:"{form.field.invalid.border.color}",color:"{form.field.color}",disabledColor:"{form.field.disabled.color}",placeholderColor:"{form.field.placeholder.color}",invalidPlaceholderColor:"{form.field.invalid.placeholder.color}",shadow:"{form.field.shadow}",paddingX:"{form.field.padding.x}",paddingY:"{form.field.padding.y}",borderRadius:"{form.field.border.radius}",focusRing:{width:"{form.field.focus.ring.width}",style:"{form.field.focus.ring.style}",color:"{form.field.focus.ring.color}",offset:"{form.field.focus.ring.offset}",shadow:"{form.field.focus.ring.shadow}"},transitionDuration:"{form.field.transition.duration}",sm:{fontSize:"{form.field.sm.font.size}",paddingX:"{form.field.sm.padding.x}",paddingY:"{form.field.sm.padding.y}"},lg:{fontSize:"{form.field.lg.font.size}",paddingX:"{form.field.lg.padding.x}",paddingY:"{form.field.lg.padding.y}"}},oye={width:"2.5rem",color:"{form.field.icon.color}"},sye={background:"{overlay.select.background}",borderColor:"{overlay.select.border.color}",borderRadius:"{overlay.select.border.radius}",color:"{overlay.select.color}",shadow:"{overlay.select.shadow}"},aye={padding:"{list.padding}",gap:"{list.gap}",mobileIndent:"1rem"},lye={focusBackground:"{list.option.focus.background}",selectedBackground:"{list.option.selected.background}",selectedFocusBackground:"{list.option.selected.focus.background}",color:"{list.option.color}",focusColor:"{list.option.focus.color}",selectedColor:"{list.option.selected.color}",selectedFocusColor:"{list.option.selected.focus.color}",padding:"{list.option.padding}",borderRadius:"{list.option.border.radius}",icon:{color:"{list.option.icon.color}",focusColor:"{list.option.icon.focus.color}",size:"0.875rem"}},cye={color:"{form.field.icon.color}"},uye={root:iye,dropdown:oye,overlay:sye,list:aye,option:lye,clearIcon:cye},dye={borderRadius:"{border.radius.sm}",width:"1.25rem",height:"1.25rem",background:"{form.field.background}",checkedBackground:"{primary.color}",checkedHoverBackground:"{primary.hover.color}",disabledBackground:"{form.field.disabled.background}",filledBackground:"{form.field.filled.background}",borderColor:"{form.field.border.color}",hoverBorderColor:"{form.field.hover.border.color}",focusBorderColor:"{form.field.border.color}",checkedBorderColor:"{primary.color}",checkedHoverBorderColor:"{primary.hover.color}",checkedFocusBorderColor:"{primary.color}",checkedDisabledBorderColor:"{form.field.border.color}",invalidBorderColor:"{form.field.invalid.border.color}",shadow:"{form.field.shadow}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"},transitionDuration:"{form.field.transition.duration}",sm:{width:"1rem",height:"1rem"},lg:{width:"1.5rem",height:"1.5rem"}},hye={size:"0.875rem",color:"{form.field.color}",checkedColor:"{primary.contrast.color}",checkedHoverColor:"{primary.contrast.color}",disabledColor:"{form.field.disabled.color}",sm:{size:"0.75rem"},lg:{size:"1rem"}},fye={root:dye,icon:hye},pye={borderRadius:"16px",paddingX:"0.75rem",paddingY:"0.5rem",gap:"0.5rem",transitionDuration:"{transition.duration}"},mye={width:"2rem",height:"2rem"},gye={size:"1rem"},_ye={size:"1rem",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{form.field.focus.ring.shadow}"}},yye={light:{root:{background:"{surface.100}",color:"{surface.800}"},icon:{color:"{surface.800}"},removeIcon:{color:"{surface.800}"}},dark:{root:{background:"{surface.800}",color:"{surface.0}"},icon:{color:"{surface.0}"},removeIcon:{color:"{surface.0}"}}},vye={root:pye,image:mye,icon:gye,removeIcon:_ye,colorScheme:yye},bye={transitionDuration:"{transition.duration}"},xye={width:"1.5rem",height:"1.5rem",borderRadius:"{form.field.border.radius}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},wye={shadow:"{overlay.popover.shadow}",borderRadius:"{overlay.popover.borderRadius}"},Tye={light:{panel:{background:"{surface.800}",borderColor:"{surface.900}"},handle:{color:"{surface.0}"}},dark:{panel:{background:"{surface.900}",borderColor:"{surface.700}"},handle:{color:"{surface.0}"}}},Sye={root:bye,preview:xye,panel:wye,colorScheme:Tye},Eye={size:"2rem",color:"{overlay.modal.color}"},Cye={gap:"1rem"},Iye={icon:Eye,content:Cye},Aye={background:"{overlay.popover.background}",borderColor:"{overlay.popover.border.color}",color:"{overlay.popover.color}",borderRadius:"{overlay.popover.border.radius}",shadow:"{overlay.popover.shadow}",gutter:"10px",arrowOffset:"1.25rem"},Pye={padding:"{overlay.popover.padding}",gap:"1rem"},Rye={size:"1.5rem",color:"{overlay.popover.color}"},kye={gap:"0.5rem",padding:"0 {overlay.popover.padding} {overlay.popover.padding} {overlay.popover.padding}"},Oye={root:Aye,content:Pye,icon:Rye,footer:kye},Mye={background:"{content.background}",borderColor:"{content.border.color}",color:"{content.color}",borderRadius:"{content.border.radius}",shadow:"{overlay.navigation.shadow}",transitionDuration:"{transition.duration}"},Dye={padding:"{navigation.list.padding}",gap:"{navigation.list.gap}"},Lye={focusBackground:"{navigation.item.focus.background}",activeBackground:"{navigation.item.active.background}",color:"{navigation.item.color}",focusColor:"{navigation.item.focus.color}",activeColor:"{navigation.item.active.color}",padding:"{navigation.item.padding}",borderRadius:"{navigation.item.border.radius}",gap:"{navigation.item.gap}",icon:{color:"{navigation.item.icon.color}",focusColor:"{navigation.item.icon.focus.color}",activeColor:"{navigation.item.icon.active.color}"}},zye={mobileIndent:"1rem"},Fye={size:"{navigation.submenu.icon.size}",color:"{navigation.submenu.icon.color}",focusColor:"{navigation.submenu.icon.focus.color}",activeColor:"{navigation.submenu.icon.active.color}"},Bye={borderColor:"{content.border.color}"},Nye={root:Mye,list:Dye,item:Lye,submenu:zye,submenuIcon:Fye,separator:Bye},Vye={transitionDuration:"{transition.duration}"},$ye={background:"{content.background}",borderColor:"{datatable.border.color}",color:"{content.color}",borderWidth:"0 0 1px 0",padding:"0.75rem 1rem",sm:{padding:"0.375rem 0.5rem"},lg:{padding:"1rem 1.25rem"}},Uye={background:"{content.background}",hoverBackground:"{content.hover.background}",selectedBackground:"{highlight.background}",borderColor:"{datatable.border.color}",color:"{content.color}",hoverColor:"{content.hover.color}",selectedColor:"{highlight.color}",gap:"0.5rem",padding:"0.75rem 1rem",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"-1px",shadow:"{focus.ring.shadow}"},sm:{padding:"0.375rem 0.5rem"},lg:{padding:"1rem 1.25rem"}},jye={fontWeight:"600"},Gye={background:"{content.background}",hoverBackground:"{content.hover.background}",selectedBackground:"{highlight.background}",color:"{content.color}",hoverColor:"{content.hover.color}",selectedColor:"{highlight.color}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"-1px",shadow:"{focus.ring.shadow}"}},Hye={borderColor:"{datatable.border.color}",padding:"0.75rem 1rem",sm:{padding:"0.375rem 0.5rem"},lg:{padding:"1rem 1.25rem"}},Wye={background:"{content.background}",borderColor:"{datatable.border.color}",color:"{content.color}",padding:"0.75rem 1rem",sm:{padding:"0.375rem 0.5rem"},lg:{padding:"1rem 1.25rem"}},qye={fontWeight:"600"},Kye={background:"{content.background}",borderColor:"{datatable.border.color}",color:"{content.color}",borderWidth:"0 0 1px 0",padding:"0.75rem 1rem",sm:{padding:"0.375rem 0.5rem"},lg:{padding:"1rem 1.25rem"}},Zye={color:"{primary.color}"},Xye={width:"0.5rem"},Yye={width:"1px",color:"{primary.color}"},Jye={color:"{text.muted.color}",hoverColor:"{text.hover.muted.color}",size:"0.875rem"},Qye={size:"2rem"},eve={hoverBackground:"{content.hover.background}",selectedHoverBackground:"{content.background}",color:"{text.muted.color}",hoverColor:"{text.color}",selectedHoverColor:"{primary.color}",size:"1.75rem",borderRadius:"50%",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},tve={inlineGap:"0.5rem",overlaySelect:{background:"{overlay.select.background}",borderColor:"{overlay.select.border.color}",borderRadius:"{overlay.select.border.radius}",color:"{overlay.select.color}",shadow:"{overlay.select.shadow}"},overlayPopover:{background:"{overlay.popover.background}",borderColor:"{overlay.popover.border.color}",borderRadius:"{overlay.popover.border.radius}",color:"{overlay.popover.color}",shadow:"{overlay.popover.shadow}",padding:"{overlay.popover.padding}",gap:"0.5rem"},rule:{borderColor:"{content.border.color}"},constraintList:{padding:"{list.padding}",gap:"{list.gap}"},constraint:{focusBackground:"{list.option.focus.background}",selectedBackground:"{list.option.selected.background}",selectedFocusBackground:"{list.option.selected.focus.background}",color:"{list.option.color}",focusColor:"{list.option.focus.color}",selectedColor:"{list.option.selected.color}",selectedFocusColor:"{list.option.selected.focus.color}",separator:{borderColor:"{content.border.color}"},padding:"{list.option.padding}",borderRadius:"{list.option.border.radius}"}},nve={borderColor:"{datatable.border.color}",borderWidth:"0 0 1px 0"},rve={borderColor:"{datatable.border.color}",borderWidth:"0 0 1px 0"},ive={light:{root:{borderColor:"{content.border.color}"},row:{stripedBackground:"{surface.50}"},bodyCell:{selectedBorderColor:"{primary.100}"}},dark:{root:{borderColor:"{surface.800}"},row:{stripedBackground:"{surface.950}"},bodyCell:{selectedBorderColor:"{primary.900}"}}},ove={root:Vye,header:$ye,headerCell:Uye,columnTitle:jye,row:Gye,bodyCell:Hye,footerCell:Wye,columnFooter:qye,footer:Kye,dropPoint:Zye,columnResizer:Xye,resizeIndicator:Yye,sortIcon:Jye,loadingIcon:Qye,rowToggleButton:eve,filter:tve,paginatorTop:nve,paginatorBottom:rve,colorScheme:ive},sve={borderColor:"transparent",borderWidth:"0",borderRadius:"0",padding:"0"},ave={background:"{content.background}",color:"{content.color}",borderColor:"{content.border.color}",borderWidth:"0 0 1px 0",padding:"0.75rem 1rem",borderRadius:"0"},lve={background:"{content.background}",color:"{content.color}",borderColor:"transparent",borderWidth:"0",padding:"0",borderRadius:"0"},cve={background:"{content.background}",color:"{content.color}",borderColor:"{content.border.color}",borderWidth:"1px 0 0 0",padding:"0.75rem 1rem",borderRadius:"0"},uve={borderColor:"{content.border.color}",borderWidth:"0 0 1px 0"},dve={borderColor:"{content.border.color}",borderWidth:"1px 0 0 0"},hve={root:sve,header:ave,content:lve,footer:cve,paginatorTop:uve,paginatorBottom:dve},fve={transitionDuration:"{transition.duration}"},pve={background:"{content.background}",borderColor:"{content.border.color}",color:"{content.color}",borderRadius:"{content.border.radius}",shadow:"{overlay.popover.shadow}",padding:"{overlay.popover.padding}"},mve={background:"{content.background}",borderColor:"{content.border.color}",color:"{content.color}",padding:"0 0 0.5rem 0"},gve={gap:"0.5rem",fontWeight:"500"},_ve={width:"2.5rem",sm:{width:"2rem"},lg:{width:"3rem"},borderColor:"{form.field.border.color}",hoverBorderColor:"{form.field.border.color}",activeBorderColor:"{form.field.border.color}",borderRadius:"{form.field.border.radius}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},yve={color:"{form.field.icon.color}"},vve={hoverBackground:"{content.hover.background}",color:"{content.color}",hoverColor:"{content.hover.color}",padding:"0.25rem 0.5rem",borderRadius:"{content.border.radius}"},bve={hoverBackground:"{content.hover.background}",color:"{content.color}",hoverColor:"{content.hover.color}",padding:"0.25rem 0.5rem",borderRadius:"{content.border.radius}"},xve={borderColor:"{content.border.color}",gap:"{overlay.popover.padding}"},wve={margin:"0.5rem 0 0 0"},Tve={padding:"0.25rem",fontWeight:"500",color:"{content.color}"},Sve={hoverBackground:"{content.hover.background}",selectedBackground:"{primary.color}",rangeSelectedBackground:"{highlight.background}",color:"{content.color}",hoverColor:"{content.hover.color}",selectedColor:"{primary.contrast.color}",rangeSelectedColor:"{highlight.color}",width:"2rem",height:"2rem",borderRadius:"50%",padding:"0.25rem",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},Eve={margin:"0.5rem 0 0 0"},Cve={padding:"0.375rem",borderRadius:"{content.border.radius}"},Ive={margin:"0.5rem 0 0 0"},Ave={padding:"0.375rem",borderRadius:"{content.border.radius}"},Pve={padding:"0.5rem 0 0 0",borderColor:"{content.border.color}"},Rve={padding:"0.5rem 0 0 0",borderColor:"{content.border.color}",gap:"0.5rem",buttonGap:"0.25rem"},kve={light:{dropdown:{background:"{surface.100}",hoverBackground:"{surface.200}",activeBackground:"{surface.300}",color:"{surface.600}",hoverColor:"{surface.700}",activeColor:"{surface.800}"},today:{background:"{surface.200}",color:"{surface.900}"}},dark:{dropdown:{background:"{surface.800}",hoverBackground:"{surface.700}",activeBackground:"{surface.600}",color:"{surface.300}",hoverColor:"{surface.200}",activeColor:"{surface.100}"},today:{background:"{surface.700}",color:"{surface.0}"}}},Ove={root:fve,panel:pve,header:mve,title:gve,dropdown:_ve,inputIcon:yve,selectMonth:vve,selectYear:bve,group:xve,dayView:wve,weekDay:Tve,date:Sve,monthView:Eve,month:Cve,yearView:Ive,year:Ave,buttonbar:Pve,timePicker:Rve,colorScheme:kve},Mve={background:"{overlay.modal.background}",borderColor:"{overlay.modal.border.color}",color:"{overlay.modal.color}",borderRadius:"{overlay.modal.border.radius}",shadow:"{overlay.modal.shadow}"},Dve={padding:"{overlay.modal.padding}",gap:"0.5rem"},Lve={fontSize:"1.25rem",fontWeight:"600"},zve={padding:"0 {overlay.modal.padding} {overlay.modal.padding} {overlay.modal.padding}"},Fve={padding:"0 {overlay.modal.padding} {overlay.modal.padding} {overlay.modal.padding}",gap:"0.5rem"},Bve={root:Mve,header:Dve,title:Lve,content:zve,footer:Fve},Nve={borderColor:"{content.border.color}"},Vve={background:"{content.background}",color:"{text.color}"},$ve={margin:"1rem 0",padding:"0 1rem",content:{padding:"0 0.5rem"}},Uve={margin:"0 1rem",padding:"0.5rem 0",content:{padding:"0.5rem 0"}},jve={root:Nve,content:Vve,horizontal:$ve,vertical:Uve},Gve={background:"rgba(255, 255, 255, 0.1)",borderColor:"rgba(255, 255, 255, 0.2)",padding:"0.5rem",borderRadius:"{border.radius.xl}"},Hve={borderRadius:"{content.border.radius}",padding:"0.5rem",size:"3rem",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},Wve={root:Gve,item:Hve},qve={background:"{overlay.modal.background}",borderColor:"{overlay.modal.border.color}",color:"{overlay.modal.color}",shadow:"{overlay.modal.shadow}"},Kve={padding:"{overlay.modal.padding}"},Zve={fontSize:"1.5rem",fontWeight:"600"},Xve={padding:"0 {overlay.modal.padding} {overlay.modal.padding} {overlay.modal.padding}"},Yve={padding:"{overlay.modal.padding}"},Jve={root:qve,header:Kve,title:Zve,content:Xve,footer:Yve},Qve={background:"{content.background}",borderColor:"{content.border.color}",borderRadius:"{content.border.radius}"},e0e={color:"{text.muted.color}",hoverColor:"{text.color}",activeColor:"{primary.color}"},t0e={background:"{overlay.select.background}",borderColor:"{overlay.select.border.color}",borderRadius:"{overlay.select.border.radius}",color:"{overlay.select.color}",shadow:"{overlay.select.shadow}",padding:"{list.padding}"},n0e={focusBackground:"{list.option.focus.background}",color:"{list.option.color}",focusColor:"{list.option.focus.color}",padding:"{list.option.padding}",borderRadius:"{list.option.border.radius}"},r0e={background:"{content.background}",borderColor:"{content.border.color}",color:"{content.color}",borderRadius:"{content.border.radius}"},i0e={toolbar:Qve,toolbarItem:e0e,overlay:t0e,overlayOption:n0e,content:r0e},o0e={background:"{content.background}",borderColor:"{content.border.color}",borderRadius:"{content.border.radius}",color:"{content.color}",padding:"0 1.125rem 1.125rem 1.125rem",transitionDuration:"{transition.duration}"},s0e={background:"{content.background}",hoverBackground:"{content.hover.background}",color:"{content.color}",hoverColor:"{content.hover.color}",borderRadius:"{content.border.radius}",borderWidth:"1px",borderColor:"transparent",padding:"0.5rem 0.75rem",gap:"0.5rem",fontWeight:"600",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},a0e={color:"{text.muted.color}",hoverColor:"{text.hover.muted.color}"},l0e={padding:"0"},c0e={root:o0e,legend:s0e,toggleIcon:a0e,content:l0e},u0e={background:"{content.background}",borderColor:"{content.border.color}",color:"{content.color}",borderRadius:"{content.border.radius}",transitionDuration:"{transition.duration}"},d0e={background:"transparent",color:"{text.color}",padding:"1.125rem",borderColor:"unset",borderWidth:"0",borderRadius:"0",gap:"0.5rem"},h0e={highlightBorderColor:"{primary.color}",padding:"0 1.125rem 1.125rem 1.125rem",gap:"1rem"},f0e={padding:"1rem",gap:"1rem",borderColor:"{content.border.color}",info:{gap:"0.5rem"}},p0e={gap:"0.5rem"},m0e={height:"0.25rem"},g0e={gap:"0.5rem"},_0e={root:u0e,header:d0e,content:h0e,file:f0e,fileList:p0e,progressbar:m0e,basic:g0e},y0e={color:"{form.field.float.label.color}",focusColor:"{form.field.float.label.focus.color}",activeColor:"{form.field.float.label.active.color}",invalidColor:"{form.field.float.label.invalid.color}",transitionDuration:"0.2s",positionX:"{form.field.padding.x}",positionY:"{form.field.padding.y}",fontWeight:"500",active:{fontSize:"0.75rem",fontWeight:"400"}},v0e={active:{top:"-1.25rem"}},b0e={input:{paddingTop:"1.5rem",paddingBottom:"{form.field.padding.y}"},active:{top:"{form.field.padding.y}"}},x0e={borderRadius:"{border.radius.xs}",active:{background:"{form.field.background}",padding:"0 0.125rem"}},w0e={root:y0e,over:v0e,in:b0e,on:x0e},T0e={borderWidth:"1px",borderColor:"{content.border.color}",borderRadius:"{content.border.radius}",transitionDuration:"{transition.duration}"},S0e={background:"rgba(255, 255, 255, 0.1)",hoverBackground:"rgba(255, 255, 255, 0.2)",color:"{surface.100}",hoverColor:"{surface.0}",size:"3rem",gutter:"0.5rem",prev:{borderRadius:"50%"},next:{borderRadius:"50%"},focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},E0e={size:"1.5rem"},C0e={background:"{content.background}",padding:"1rem 0.25rem"},I0e={size:"2rem",borderRadius:"{content.border.radius}",gutter:"0.5rem",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},A0e={size:"1rem"},P0e={background:"rgba(0, 0, 0, 0.5)",color:"{surface.100}",padding:"1rem"},R0e={gap:"0.5rem",padding:"1rem"},k0e={width:"1rem",height:"1rem",activeBackground:"{primary.color}",borderRadius:"50%",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},O0e={background:"rgba(0, 0, 0, 0.5)"},M0e={background:"rgba(255, 255, 255, 0.4)",hoverBackground:"rgba(255, 255, 255, 0.6)",activeBackground:"rgba(255, 255, 255, 0.9)"},D0e={size:"3rem",gutter:"0.5rem",background:"rgba(255, 255, 255, 0.1)",hoverBackground:"rgba(255, 255, 255, 0.2)",color:"{surface.50}",hoverColor:"{surface.0}",borderRadius:"50%",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},L0e={size:"1.5rem"},z0e={light:{thumbnailNavButton:{hoverBackground:"{surface.100}",color:"{surface.600}",hoverColor:"{surface.700}"},indicatorButton:{background:"{surface.200}",hoverBackground:"{surface.300}"}},dark:{thumbnailNavButton:{hoverBackground:"{surface.700}",color:"{surface.400}",hoverColor:"{surface.0}"},indicatorButton:{background:"{surface.700}",hoverBackground:"{surface.600}"}}},F0e={root:T0e,navButton:S0e,navIcon:E0e,thumbnailsContent:C0e,thumbnailNavButton:I0e,thumbnailNavButtonIcon:A0e,caption:P0e,indicatorList:R0e,indicatorButton:k0e,insetIndicatorList:O0e,insetIndicatorButton:M0e,closeButton:D0e,closeButtonIcon:L0e,colorScheme:z0e},B0e={color:"{form.field.icon.color}"},N0e={icon:B0e},V0e={color:"{form.field.float.label.color}",focusColor:"{form.field.float.label.focus.color}",invalidColor:"{form.field.float.label.invalid.color}",transitionDuration:"0.2s",positionX:"{form.field.padding.x}",top:"{form.field.padding.y}",fontSize:"0.75rem",fontWeight:"400"},$0e={paddingTop:"1.5rem",paddingBottom:"{form.field.padding.y}"},U0e={root:V0e,input:$0e},j0e={transitionDuration:"{transition.duration}"},G0e={icon:{size:"1.5rem"},mask:{background:"{mask.background}",color:"{mask.color}"}},H0e={position:{left:"auto",right:"1rem",top:"1rem",bottom:"auto"},blur:"8px",background:"rgba(255,255,255,0.1)",borderColor:"rgba(255,255,255,0.2)",borderWidth:"1px",borderRadius:"30px",padding:".5rem",gap:"0.5rem"},W0e={hoverBackground:"rgba(255,255,255,0.1)",color:"{surface.50}",hoverColor:"{surface.0}",size:"3rem",iconSize:"1.5rem",borderRadius:"50%",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},q0e={root:j0e,preview:G0e,toolbar:H0e,action:W0e},K0e={size:"15px",hoverSize:"30px",background:"rgba(255,255,255,0.3)",hoverBackground:"rgba(255,255,255,0.3)",borderColor:"unset",hoverBorderColor:"unset",borderWidth:"0",borderRadius:"50%",transitionDuration:"{transition.duration}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"rgba(255,255,255,0.3)",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},Z0e={handle:K0e},X0e={padding:"{form.field.padding.y} {form.field.padding.x}",borderRadius:"{content.border.radius}",gap:"0.5rem"},Y0e={fontWeight:"500"},J0e={size:"1rem"},Q0e={light:{info:{background:"color-mix(in srgb, {blue.50}, transparent 5%)",borderColor:"{blue.200}",color:"{blue.600}",shadow:"0px 4px 8px 0px color-mix(in srgb, {blue.500}, transparent 96%)"},success:{background:"color-mix(in srgb, {green.50}, transparent 5%)",borderColor:"{green.200}",color:"{green.600}",shadow:"0px 4px 8px 0px color-mix(in srgb, {green.500}, transparent 96%)"},warn:{background:"color-mix(in srgb,{yellow.50}, transparent 5%)",borderColor:"{yellow.200}",color:"{yellow.600}",shadow:"0px 4px 8px 0px color-mix(in srgb, {yellow.500}, transparent 96%)"},error:{background:"color-mix(in srgb, {red.50}, transparent 5%)",borderColor:"{red.200}",color:"{red.600}",shadow:"0px 4px 8px 0px color-mix(in srgb, {red.500}, transparent 96%)"},secondary:{background:"{surface.100}",borderColor:"{surface.200}",color:"{surface.600}",shadow:"0px 4px 8px 0px color-mix(in srgb, {surface.500}, transparent 96%)"},contrast:{background:"{surface.900}",borderColor:"{surface.950}",color:"{surface.50}",shadow:"0px 4px 8px 0px color-mix(in srgb, {surface.950}, transparent 96%)"}},dark:{info:{background:"color-mix(in srgb, {blue.500}, transparent 84%)",borderColor:"color-mix(in srgb, {blue.700}, transparent 64%)",color:"{blue.500}",shadow:"0px 4px 8px 0px color-mix(in srgb, {blue.500}, transparent 96%)"},success:{background:"color-mix(in srgb, {green.500}, transparent 84%)",borderColor:"color-mix(in srgb, {green.700}, transparent 64%)",color:"{green.500}",shadow:"0px 4px 8px 0px color-mix(in srgb, {green.500}, transparent 96%)"},warn:{background:"color-mix(in srgb, {yellow.500}, transparent 84%)",borderColor:"color-mix(in srgb, {yellow.700}, transparent 64%)",color:"{yellow.500}",shadow:"0px 4px 8px 0px color-mix(in srgb, {yellow.500}, transparent 96%)"},error:{background:"color-mix(in srgb, {red.500}, transparent 84%)",borderColor:"color-mix(in srgb, {red.700}, transparent 64%)",color:"{red.500}",shadow:"0px 4px 8px 0px color-mix(in srgb, {red.500}, transparent 96%)"},secondary:{background:"{surface.800}",borderColor:"{surface.700}",color:"{surface.300}",shadow:"0px 4px 8px 0px color-mix(in srgb, {surface.500}, transparent 96%)"},contrast:{background:"{surface.0}",borderColor:"{surface.100}",color:"{surface.950}",shadow:"0px 4px 8px 0px color-mix(in srgb, {surface.950}, transparent 96%)"}}},ebe={root:X0e,text:Y0e,icon:J0e,colorScheme:Q0e},tbe={padding:"{form.field.padding.y} {form.field.padding.x}",borderRadius:"{content.border.radius}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"},transitionDuration:"{transition.duration}"},nbe={hoverBackground:"{content.hover.background}",hoverColor:"{content.hover.color}"},rbe={root:tbe,display:nbe},ibe={background:"{form.field.background}",disabledBackground:"{form.field.disabled.background}",filledBackground:"{form.field.filled.background}",filledFocusBackground:"{form.field.filled.focus.background}",borderColor:"{form.field.border.color}",hoverBorderColor:"{form.field.hover.border.color}",focusBorderColor:"{form.field.focus.border.color}",invalidBorderColor:"{form.field.invalid.border.color}",color:"{form.field.color}",disabledColor:"{form.field.disabled.color}",placeholderColor:"{form.field.placeholder.color}",shadow:"{form.field.shadow}",paddingX:"{form.field.padding.x}",paddingY:"{form.field.padding.y}",borderRadius:"{form.field.border.radius}",focusRing:{width:"{form.field.focus.ring.width}",style:"{form.field.focus.ring.style}",color:"{form.field.focus.ring.color}",offset:"{form.field.focus.ring.offset}",shadow:"{form.field.focus.ring.shadow}"},transitionDuration:"{form.field.transition.duration}"},obe={borderRadius:"{border.radius.sm}"},sbe={light:{chip:{focusBackground:"{surface.200}",color:"{surface.800}"}},dark:{chip:{focusBackground:"{surface.700}",color:"{surface.0}"}}},abe={root:ibe,chip:obe,colorScheme:sbe},lbe={background:"{form.field.background}",borderColor:"{form.field.border.color}",color:"{form.field.icon.color}",borderRadius:"{form.field.border.radius}",padding:"0.5rem",minWidth:"2.5rem"},cbe={addon:lbe},ube={transitionDuration:"{transition.duration}"},dbe={width:"2.5rem",borderRadius:"{form.field.border.radius}",verticalPadding:"{form.field.padding.y}"},hbe={light:{button:{background:"transparent",hoverBackground:"{surface.100}",activeBackground:"{surface.200}",borderColor:"{form.field.border.color}",hoverBorderColor:"{form.field.border.color}",activeBorderColor:"{form.field.border.color}",color:"{surface.400}",hoverColor:"{surface.500}",activeColor:"{surface.600}"}},dark:{button:{background:"transparent",hoverBackground:"{surface.800}",activeBackground:"{surface.700}",borderColor:"{form.field.border.color}",hoverBorderColor:"{form.field.border.color}",activeBorderColor:"{form.field.border.color}",color:"{surface.400}",hoverColor:"{surface.300}",activeColor:"{surface.200}"}}},fbe={root:ube,button:dbe,colorScheme:hbe},pbe={gap:"0.5rem"},mbe={width:"2.5rem",sm:{width:"2rem"},lg:{width:"3rem"}},gbe={root:pbe,input:mbe},_be={background:"{form.field.background}",disabledBackground:"{form.field.disabled.background}",filledBackground:"{form.field.filled.background}",filledHoverBackground:"{form.field.filled.hover.background}",filledFocusBackground:"{form.field.filled.focus.background}",borderColor:"{form.field.border.color}",hoverBorderColor:"{form.field.hover.border.color}",focusBorderColor:"{form.field.focus.border.color}",invalidBorderColor:"{form.field.invalid.border.color}",color:"{form.field.color}",disabledColor:"{form.field.disabled.color}",placeholderColor:"{form.field.placeholder.color}",invalidPlaceholderColor:"{form.field.invalid.placeholder.color}",shadow:"{form.field.shadow}",paddingX:"{form.field.padding.x}",paddingY:"{form.field.padding.y}",borderRadius:"{form.field.border.radius}",focusRing:{width:"{form.field.focus.ring.width}",style:"{form.field.focus.ring.style}",color:"{form.field.focus.ring.color}",offset:"{form.field.focus.ring.offset}",shadow:"{form.field.focus.ring.shadow}"},transitionDuration:"{form.field.transition.duration}",sm:{fontSize:"{form.field.sm.font.size}",paddingX:"{form.field.sm.padding.x}",paddingY:"{form.field.sm.padding.y}"},lg:{fontSize:"{form.field.lg.font.size}",paddingX:"{form.field.lg.padding.x}",paddingY:"{form.field.lg.padding.y}"}},ybe={root:_be},vbe={transitionDuration:"{transition.duration}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},bbe={background:"{primary.color}"},xbe={background:"{content.border.color}"},wbe={color:"{text.muted.color}"},Tbe={root:vbe,value:bbe,range:xbe,text:wbe},Sbe={background:"{form.field.background}",disabledBackground:"{form.field.disabled.background}",borderColor:"{form.field.border.color}",invalidBorderColor:"{form.field.invalid.border.color}",color:"{form.field.color}",disabledColor:"{form.field.disabled.color}",shadow:"{form.field.shadow}",borderRadius:"{form.field.border.radius}",transitionDuration:"{form.field.transition.duration}"},Ebe={padding:"{list.padding}",gap:"{list.gap}",header:{padding:"{list.header.padding}"}},Cbe={focusBackground:"{list.option.focus.background}",selectedBackground:"{list.option.selected.background}",selectedFocusBackground:"{list.option.selected.focus.background}",color:"{list.option.color}",focusColor:"{list.option.focus.color}",selectedColor:"{list.option.selected.color}",selectedFocusColor:"{list.option.selected.focus.color}",padding:"{list.option.padding}",borderRadius:"{list.option.border.radius}"},Ibe={background:"{list.option.group.background}",color:"{list.option.group.color}",fontWeight:"{list.option.group.font.weight}",padding:"{list.option.group.padding}"},Abe={color:"{list.option.color}",gutterStart:"-0.375rem",gutterEnd:"0.375rem"},Pbe={padding:"{list.option.padding}"},Rbe={light:{option:{stripedBackground:"{surface.50}"}},dark:{option:{stripedBackground:"{surface.900}"}}},kbe={root:Sbe,list:Ebe,option:Cbe,optionGroup:Ibe,checkmark:Abe,emptyMessage:Pbe,colorScheme:Rbe},Obe={background:"{content.background}",borderColor:"{content.border.color}",borderRadius:"{content.border.radius}",color:"{content.color}",gap:"0.5rem",verticalOrientation:{padding:"{navigation.list.padding}",gap:"{navigation.list.gap}"},horizontalOrientation:{padding:"0.5rem 0.75rem",gap:"0.5rem"},transitionDuration:"{transition.duration}"},Mbe={borderRadius:"{content.border.radius}",padding:"{navigation.item.padding}"},Dbe={focusBackground:"{navigation.item.focus.background}",activeBackground:"{navigation.item.active.background}",color:"{navigation.item.color}",focusColor:"{navigation.item.focus.color}",activeColor:"{navigation.item.active.color}",padding:"{navigation.item.padding}",borderRadius:"{navigation.item.border.radius}",gap:"{navigation.item.gap}",icon:{color:"{navigation.item.icon.color}",focusColor:"{navigation.item.icon.focus.color}",activeColor:"{navigation.item.icon.active.color}"}},Lbe={padding:"0",background:"{content.background}",borderColor:"{content.border.color}",borderRadius:"{content.border.radius}",color:"{content.color}",shadow:"{overlay.navigation.shadow}",gap:"0.5rem"},zbe={padding:"{navigation.list.padding}",gap:"{navigation.list.gap}"},Fbe={padding:"{navigation.submenu.label.padding}",fontWeight:"{navigation.submenu.label.font.weight}",background:"{navigation.submenu.label.background}",color:"{navigation.submenu.label.color}"},Bbe={size:"{navigation.submenu.icon.size}",color:"{navigation.submenu.icon.color}",focusColor:"{navigation.submenu.icon.focus.color}",activeColor:"{navigation.submenu.icon.active.color}"},Nbe={borderColor:"{content.border.color}"},Vbe={borderRadius:"50%",size:"1.75rem",color:"{text.muted.color}",hoverColor:"{text.hover.muted.color}",hoverBackground:"{content.hover.background}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},$be={root:Obe,baseItem:Mbe,item:Dbe,overlay:Lbe,submenu:zbe,submenuLabel:Fbe,submenuIcon:Bbe,separator:Nbe,mobileButton:Vbe},Ube={background:"{content.background}",borderColor:"{content.border.color}",color:"{content.color}",borderRadius:"{content.border.radius}",shadow:"{overlay.navigation.shadow}",transitionDuration:"{transition.duration}"},jbe={padding:"{navigation.list.padding}",gap:"{navigation.list.gap}"},Gbe={focusBackground:"{navigation.item.focus.background}",color:"{navigation.item.color}",focusColor:"{navigation.item.focus.color}",padding:"{navigation.item.padding}",borderRadius:"{navigation.item.border.radius}",gap:"{navigation.item.gap}",icon:{color:"{navigation.item.icon.color}",focusColor:"{navigation.item.icon.focus.color}"}},Hbe={padding:"{navigation.submenu.label.padding}",fontWeight:"{navigation.submenu.label.font.weight}",background:"{navigation.submenu.label.background}",color:"{navigation.submenu.label.color}"},Wbe={borderColor:"{content.border.color}"},qbe={root:Ube,list:jbe,item:Gbe,submenuLabel:Hbe,separator:Wbe},Kbe={background:"{content.background}",borderColor:"{content.border.color}",borderRadius:"{content.border.radius}",color:"{content.color}",gap:"0.5rem",padding:"0.5rem 0.75rem",transitionDuration:"{transition.duration}"},Zbe={borderRadius:"{content.border.radius}",padding:"{navigation.item.padding}"},Xbe={focusBackground:"{navigation.item.focus.background}",activeBackground:"{navigation.item.active.background}",color:"{navigation.item.color}",focusColor:"{navigation.item.focus.color}",activeColor:"{navigation.item.active.color}",padding:"{navigation.item.padding}",borderRadius:"{navigation.item.border.radius}",gap:"{navigation.item.gap}",icon:{color:"{navigation.item.icon.color}",focusColor:"{navigation.item.icon.focus.color}",activeColor:"{navigation.item.icon.active.color}"}},Ybe={padding:"{navigation.list.padding}",gap:"{navigation.list.gap}",background:"{content.background}",borderColor:"{content.border.color}",borderRadius:"{content.border.radius}",shadow:"{overlay.navigation.shadow}",mobileIndent:"1rem",icon:{size:"{navigation.submenu.icon.size}",color:"{navigation.submenu.icon.color}",focusColor:"{navigation.submenu.icon.focus.color}",activeColor:"{navigation.submenu.icon.active.color}"}},Jbe={borderColor:"{content.border.color}"},Qbe={borderRadius:"50%",size:"1.75rem",color:"{text.muted.color}",hoverColor:"{text.hover.muted.color}",hoverBackground:"{content.hover.background}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},e1e={root:Kbe,baseItem:Zbe,item:Xbe,submenu:Ybe,separator:Jbe,mobileButton:Qbe},t1e={borderRadius:"{content.border.radius}",borderWidth:"1px",transitionDuration:"{transition.duration}"},n1e={padding:"0.5rem 0.75rem",gap:"0.5rem",sm:{padding:"0.375rem 0.625rem"},lg:{padding:"0.625rem 0.875rem"}},r1e={fontSize:"1rem",fontWeight:"500",sm:{fontSize:"0.875rem"},lg:{fontSize:"1.125rem"}},i1e={size:"1.125rem",sm:{size:"1rem"},lg:{size:"1.25rem"}},o1e={width:"1.75rem",height:"1.75rem",borderRadius:"50%",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",offset:"{focus.ring.offset}"}},s1e={size:"1rem",sm:{size:"0.875rem"},lg:{size:"1.125rem"}},a1e={root:{borderWidth:"1px"}},l1e={content:{padding:"0"}},c1e={light:{info:{background:"color-mix(in srgb, {blue.50}, transparent 5%)",borderColor:"{blue.200}",color:"{blue.600}",shadow:"0px 4px 8px 0px color-mix(in srgb, {blue.500}, transparent 96%)",closeButton:{hoverBackground:"{blue.100}",focusRing:{color:"{blue.600}",shadow:"none"}},outlined:{color:"{blue.600}",borderColor:"{blue.600}"},simple:{color:"{blue.600}"}},success:{background:"color-mix(in srgb, {green.50}, transparent 5%)",borderColor:"{green.200}",color:"{green.600}",shadow:"0px 4px 8px 0px color-mix(in srgb, {green.500}, transparent 96%)",closeButton:{hoverBackground:"{green.100}",focusRing:{color:"{green.600}",shadow:"none"}},outlined:{color:"{green.600}",borderColor:"{green.600}"},simple:{color:"{green.600}"}},warn:{background:"color-mix(in srgb,{yellow.50}, transparent 5%)",borderColor:"{yellow.200}",color:"{yellow.600}",shadow:"0px 4px 8px 0px color-mix(in srgb, {yellow.500}, transparent 96%)",closeButton:{hoverBackground:"{yellow.100}",focusRing:{color:"{yellow.600}",shadow:"none"}},outlined:{color:"{yellow.600}",borderColor:"{yellow.600}"},simple:{color:"{yellow.600}"}},error:{background:"color-mix(in srgb, {red.50}, transparent 5%)",borderColor:"{red.200}",color:"{red.600}",shadow:"0px 4px 8px 0px color-mix(in srgb, {red.500}, transparent 96%)",closeButton:{hoverBackground:"{red.100}",focusRing:{color:"{red.600}",shadow:"none"}},outlined:{color:"{red.600}",borderColor:"{red.600}"},simple:{color:"{red.600}"}},secondary:{background:"{surface.100}",borderColor:"{surface.200}",color:"{surface.600}",shadow:"0px 4px 8px 0px color-mix(in srgb, {surface.500}, transparent 96%)",closeButton:{hoverBackground:"{surface.200}",focusRing:{color:"{surface.600}",shadow:"none"}},outlined:{color:"{surface.500}",borderColor:"{surface.500}"},simple:{color:"{surface.500}"}},contrast:{background:"{surface.900}",borderColor:"{surface.950}",color:"{surface.50}",shadow:"0px 4px 8px 0px color-mix(in srgb, {surface.950}, transparent 96%)",closeButton:{hoverBackground:"{surface.800}",focusRing:{color:"{surface.50}",shadow:"none"}},outlined:{color:"{surface.950}",borderColor:"{surface.950}"},simple:{color:"{surface.950}"}}},dark:{info:{background:"color-mix(in srgb, {blue.500}, transparent 84%)",borderColor:"color-mix(in srgb, {blue.700}, transparent 64%)",color:"{blue.500}",shadow:"0px 4px 8px 0px color-mix(in srgb, {blue.500}, transparent 96%)",closeButton:{hoverBackground:"rgba(255, 255, 255, 0.05)",focusRing:{color:"{blue.500}",shadow:"none"}},outlined:{color:"{blue.500}",borderColor:"{blue.500}"},simple:{color:"{blue.500}"}},success:{background:"color-mix(in srgb, {green.500}, transparent 84%)",borderColor:"color-mix(in srgb, {green.700}, transparent 64%)",color:"{green.500}",shadow:"0px 4px 8px 0px color-mix(in srgb, {green.500}, transparent 96%)",closeButton:{hoverBackground:"rgba(255, 255, 255, 0.05)",focusRing:{color:"{green.500}",shadow:"none"}},outlined:{color:"{green.500}",borderColor:"{green.500}"},simple:{color:"{green.500}"}},warn:{background:"color-mix(in srgb, {yellow.500}, transparent 84%)",borderColor:"color-mix(in srgb, {yellow.700}, transparent 64%)",color:"{yellow.500}",shadow:"0px 4px 8px 0px color-mix(in srgb, {yellow.500}, transparent 96%)",closeButton:{hoverBackground:"rgba(255, 255, 255, 0.05)",focusRing:{color:"{yellow.500}",shadow:"none"}},outlined:{color:"{yellow.500}",borderColor:"{yellow.500}"},simple:{color:"{yellow.500}"}},error:{background:"color-mix(in srgb, {red.500}, transparent 84%)",borderColor:"color-mix(in srgb, {red.700}, transparent 64%)",color:"{red.500}",shadow:"0px 4px 8px 0px color-mix(in srgb, {red.500}, transparent 96%)",closeButton:{hoverBackground:"rgba(255, 255, 255, 0.05)",focusRing:{color:"{red.500}",shadow:"none"}},outlined:{color:"{red.500}",borderColor:"{red.500}"},simple:{color:"{red.500}"}},secondary:{background:"{surface.800}",borderColor:"{surface.700}",color:"{surface.300}",shadow:"0px 4px 8px 0px color-mix(in srgb, {surface.500}, transparent 96%)",closeButton:{hoverBackground:"{surface.700}",focusRing:{color:"{surface.300}",shadow:"none"}},outlined:{color:"{surface.400}",borderColor:"{surface.400}"},simple:{color:"{surface.400}"}},contrast:{background:"{surface.0}",borderColor:"{surface.100}",color:"{surface.950}",shadow:"0px 4px 8px 0px color-mix(in srgb, {surface.950}, transparent 96%)",closeButton:{hoverBackground:"{surface.100}",focusRing:{color:"{surface.950}",shadow:"none"}},outlined:{color:"{surface.0}",borderColor:"{surface.0}"},simple:{color:"{surface.0}"}}}},u1e={root:t1e,content:n1e,text:r1e,icon:i1e,closeButton:o1e,closeIcon:s1e,outlined:a1e,simple:l1e,colorScheme:c1e},d1e={borderRadius:"{content.border.radius}",gap:"1rem"},h1e={background:"{content.border.color}",size:"0.5rem"},f1e={gap:"0.5rem"},p1e={size:"0.5rem"},m1e={size:"1rem"},g1e={verticalGap:"0.5rem",horizontalGap:"1rem"},_1e={root:d1e,meters:h1e,label:f1e,labelMarker:p1e,labelIcon:m1e,labelList:g1e},y1e={background:"{form.field.background}",disabledBackground:"{form.field.disabled.background}",filledBackground:"{form.field.filled.background}",filledHoverBackground:"{form.field.filled.hover.background}",filledFocusBackground:"{form.field.filled.focus.background}",borderColor:"{form.field.border.color}",hoverBorderColor:"{form.field.hover.border.color}",focusBorderColor:"{form.field.focus.border.color}",invalidBorderColor:"{form.field.invalid.border.color}",color:"{form.field.color}",disabledColor:"{form.field.disabled.color}",placeholderColor:"{form.field.placeholder.color}",invalidPlaceholderColor:"{form.field.invalid.placeholder.color}",shadow:"{form.field.shadow}",paddingX:"{form.field.padding.x}",paddingY:"{form.field.padding.y}",borderRadius:"{form.field.border.radius}",focusRing:{width:"{form.field.focus.ring.width}",style:"{form.field.focus.ring.style}",color:"{form.field.focus.ring.color}",offset:"{form.field.focus.ring.offset}",shadow:"{form.field.focus.ring.shadow}"},transitionDuration:"{form.field.transition.duration}",sm:{fontSize:"{form.field.sm.font.size}",paddingX:"{form.field.sm.padding.x}",paddingY:"{form.field.sm.padding.y}"},lg:{fontSize:"{form.field.lg.font.size}",paddingX:"{form.field.lg.padding.x}",paddingY:"{form.field.lg.padding.y}"}},v1e={width:"2.5rem",color:"{form.field.icon.color}"},b1e={background:"{overlay.select.background}",borderColor:"{overlay.select.border.color}",borderRadius:"{overlay.select.border.radius}",color:"{overlay.select.color}",shadow:"{overlay.select.shadow}"},x1e={padding:"{list.padding}",gap:"{list.gap}",header:{padding:"{list.header.padding}"}},w1e={focusBackground:"{list.option.focus.background}",selectedBackground:"{list.option.selected.background}",selectedFocusBackground:"{list.option.selected.focus.background}",color:"{list.option.color}",focusColor:"{list.option.focus.color}",selectedColor:"{list.option.selected.color}",selectedFocusColor:"{list.option.selected.focus.color}",padding:"{list.option.padding}",borderRadius:"{list.option.border.radius}",gap:"0.5rem"},T1e={background:"{list.option.group.background}",color:"{list.option.group.color}",fontWeight:"{list.option.group.font.weight}",padding:"{list.option.group.padding}"},S1e={color:"{form.field.icon.color}"},E1e={borderRadius:"{border.radius.sm}"},C1e={padding:"{list.option.padding}"},I1e={root:y1e,dropdown:v1e,overlay:b1e,list:x1e,option:w1e,optionGroup:T1e,chip:E1e,clearIcon:S1e,emptyMessage:C1e},A1e={gap:"1.125rem"},P1e={gap:"0.5rem"},R1e={root:A1e,controls:P1e},k1e={gutter:"0.75rem",transitionDuration:"{transition.duration}"},O1e={background:"{content.background}",hoverBackground:"{content.hover.background}",selectedBackground:"{highlight.background}",borderColor:"{content.border.color}",color:"{content.color}",selectedColor:"{highlight.color}",hoverColor:"{content.hover.color}",padding:"0.75rem 1rem",toggleablePadding:"0.75rem 1rem 1.25rem 1rem",borderRadius:"{content.border.radius}"},M1e={background:"{content.background}",hoverBackground:"{content.hover.background}",borderColor:"{content.border.color}",color:"{text.muted.color}",hoverColor:"{text.color}",size:"1.5rem",borderRadius:"50%",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},D1e={color:"{content.border.color}",borderRadius:"{content.border.radius}",height:"24px"},L1e={root:k1e,node:O1e,nodeToggleButton:M1e,connector:D1e},z1e={outline:{width:"2px",color:"{content.background}"}},F1e={root:z1e},B1e={padding:"0.5rem 1rem",gap:"0.25rem",borderRadius:"{content.border.radius}",background:"{content.background}",color:"{content.color}",transitionDuration:"{transition.duration}"},N1e={background:"transparent",hoverBackground:"{content.hover.background}",selectedBackground:"{highlight.background}",color:"{text.muted.color}",hoverColor:"{text.hover.muted.color}",selectedColor:"{highlight.color}",width:"2.5rem",height:"2.5rem",borderRadius:"50%",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},V1e={color:"{text.muted.color}"},$1e={maxWidth:"2.5rem"},U1e={root:B1e,navButton:N1e,currentPageReport:V1e,jumpToPageInput:$1e},j1e={background:"{content.background}",borderColor:"{content.border.color}",color:"{content.color}",borderRadius:"{content.border.radius}"},G1e={background:"transparent",color:"{text.color}",padding:"1.125rem",borderColor:"{content.border.color}",borderWidth:"0",borderRadius:"0"},H1e={padding:"0.375rem 1.125rem"},W1e={fontWeight:"600"},q1e={padding:"0 1.125rem 1.125rem 1.125rem"},K1e={padding:"0 1.125rem 1.125rem 1.125rem"},Z1e={root:j1e,header:G1e,toggleableHeader:H1e,title:W1e,content:q1e,footer:K1e},X1e={gap:"0.5rem",transitionDuration:"{transition.duration}"},Y1e={background:"{content.background}",borderColor:"{content.border.color}",borderWidth:"1px",color:"{content.color}",padding:"0.25rem 0.25rem",borderRadius:"{content.border.radius}",first:{borderWidth:"1px",topBorderRadius:"{content.border.radius}"},last:{borderWidth:"1px",bottomBorderRadius:"{content.border.radius}"}},J1e={focusBackground:"{navigation.item.focus.background}",color:"{navigation.item.color}",focusColor:"{navigation.item.focus.color}",gap:"0.5rem",padding:"{navigation.item.padding}",borderRadius:"{content.border.radius}",icon:{color:"{navigation.item.icon.color}",focusColor:"{navigation.item.icon.focus.color}"}},Q1e={indent:"1rem"},exe={color:"{navigation.submenu.icon.color}",focusColor:"{navigation.submenu.icon.focus.color}"},txe={root:X1e,panel:Y1e,item:J1e,submenu:Q1e,submenuIcon:exe},nxe={background:"{content.border.color}",borderRadius:"{content.border.radius}",height:".75rem"},rxe={color:"{form.field.icon.color}"},ixe={background:"{overlay.popover.background}",borderColor:"{overlay.popover.border.color}",borderRadius:"{overlay.popover.border.radius}",color:"{overlay.popover.color}",padding:"{overlay.popover.padding}",shadow:"{overlay.popover.shadow}"},oxe={gap:"0.5rem"},sxe={light:{strength:{weakBackground:"{red.500}",mediumBackground:"{amber.500}",strongBackground:"{green.500}"}},dark:{strength:{weakBackground:"{red.400}",mediumBackground:"{amber.400}",strongBackground:"{green.400}"}}},axe={meter:nxe,icon:rxe,overlay:ixe,content:oxe,colorScheme:sxe},lxe={gap:"1.125rem"},cxe={gap:"0.5rem"},uxe={root:lxe,controls:cxe},dxe={background:"{overlay.popover.background}",borderColor:"{overlay.popover.border.color}",color:"{overlay.popover.color}",borderRadius:"{overlay.popover.border.radius}",shadow:"{overlay.popover.shadow}",gutter:"10px",arrowOffset:"1.25rem"},hxe={padding:"{overlay.popover.padding}"},fxe={root:dxe,content:hxe},pxe={background:"{content.border.color}",borderRadius:"{content.border.radius}",height:"1.25rem"},mxe={background:"{primary.color}"},gxe={color:"{primary.contrast.color}",fontSize:"0.75rem",fontWeight:"600"},_xe={root:pxe,value:mxe,label:gxe},yxe={light:{root:{colorOne:"{red.500}",colorTwo:"{blue.500}",colorThree:"{green.500}",colorFour:"{yellow.500}"}},dark:{root:{colorOne:"{red.400}",colorTwo:"{blue.400}",colorThree:"{green.400}",colorFour:"{yellow.400}"}}},vxe={colorScheme:yxe},bxe={width:"1.25rem",height:"1.25rem",background:"{form.field.background}",checkedBackground:"{primary.color}",checkedHoverBackground:"{primary.hover.color}",disabledBackground:"{form.field.disabled.background}",filledBackground:"{form.field.filled.background}",borderColor:"{form.field.border.color}",hoverBorderColor:"{form.field.hover.border.color}",focusBorderColor:"{form.field.border.color}",checkedBorderColor:"{primary.color}",checkedHoverBorderColor:"{primary.hover.color}",checkedFocusBorderColor:"{primary.color}",checkedDisabledBorderColor:"{form.field.border.color}",invalidBorderColor:"{form.field.invalid.border.color}",shadow:"{form.field.shadow}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"},transitionDuration:"{form.field.transition.duration}",sm:{width:"1rem",height:"1rem"},lg:{width:"1.5rem",height:"1.5rem"}},xxe={size:"0.75rem",checkedColor:"{primary.contrast.color}",checkedHoverColor:"{primary.contrast.color}",disabledColor:"{form.field.disabled.color}",sm:{size:"0.5rem"},lg:{size:"1rem"}},wxe={root:bxe,icon:xxe},Txe={gap:"0.25rem",transitionDuration:"{transition.duration}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},Sxe={size:"1rem",color:"{text.muted.color}",hoverColor:"{primary.color}",activeColor:"{primary.color}"},Exe={root:Txe,icon:Sxe},Cxe={light:{root:{background:"rgba(0,0,0,0.1)"}},dark:{root:{background:"rgba(255,255,255,0.3)"}}},Ixe={colorScheme:Cxe},Axe={transitionDuration:"{transition.duration}"},Pxe={size:"9px",borderRadius:"{border.radius.sm}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},Rxe={light:{bar:{background:"{surface.100}"}},dark:{bar:{background:"{surface.800}"}}},kxe={root:Axe,bar:Pxe,colorScheme:Rxe},Oxe={background:"{form.field.background}",disabledBackground:"{form.field.disabled.background}",filledBackground:"{form.field.filled.background}",filledHoverBackground:"{form.field.filled.hover.background}",filledFocusBackground:"{form.field.filled.focus.background}",borderColor:"{form.field.border.color}",hoverBorderColor:"{form.field.hover.border.color}",focusBorderColor:"{form.field.focus.border.color}",invalidBorderColor:"{form.field.invalid.border.color}",color:"{form.field.color}",disabledColor:"{form.field.disabled.color}",placeholderColor:"{form.field.placeholder.color}",invalidPlaceholderColor:"{form.field.invalid.placeholder.color}",shadow:"{form.field.shadow}",paddingX:"{form.field.padding.x}",paddingY:"{form.field.padding.y}",borderRadius:"{form.field.border.radius}",focusRing:{width:"{form.field.focus.ring.width}",style:"{form.field.focus.ring.style}",color:"{form.field.focus.ring.color}",offset:"{form.field.focus.ring.offset}",shadow:"{form.field.focus.ring.shadow}"},transitionDuration:"{form.field.transition.duration}",sm:{fontSize:"{form.field.sm.font.size}",paddingX:"{form.field.sm.padding.x}",paddingY:"{form.field.sm.padding.y}"},lg:{fontSize:"{form.field.lg.font.size}",paddingX:"{form.field.lg.padding.x}",paddingY:"{form.field.lg.padding.y}"}},Mxe={width:"2.5rem",color:"{form.field.icon.color}"},Dxe={background:"{overlay.select.background}",borderColor:"{overlay.select.border.color}",borderRadius:"{overlay.select.border.radius}",color:"{overlay.select.color}",shadow:"{overlay.select.shadow}"},Lxe={padding:"{list.padding}",gap:"{list.gap}",header:{padding:"{list.header.padding}"}},zxe={focusBackground:"{list.option.focus.background}",selectedBackground:"{list.option.selected.background}",selectedFocusBackground:"{list.option.selected.focus.background}",color:"{list.option.color}",focusColor:"{list.option.focus.color}",selectedColor:"{list.option.selected.color}",selectedFocusColor:"{list.option.selected.focus.color}",padding:"{list.option.padding}",borderRadius:"{list.option.border.radius}"},Fxe={background:"{list.option.group.background}",color:"{list.option.group.color}",fontWeight:"{list.option.group.font.weight}",padding:"{list.option.group.padding}"},Bxe={color:"{form.field.icon.color}"},Nxe={color:"{list.option.color}",gutterStart:"-0.375rem",gutterEnd:"0.375rem"},Vxe={padding:"{list.option.padding}"},$xe={root:Oxe,dropdown:Mxe,overlay:Dxe,list:Lxe,option:zxe,optionGroup:Fxe,clearIcon:Bxe,checkmark:Nxe,emptyMessage:Vxe},Uxe={borderRadius:"{form.field.border.radius}"},jxe={light:{root:{invalidBorderColor:"{form.field.invalid.border.color}"}},dark:{root:{invalidBorderColor:"{form.field.invalid.border.color}"}}},Gxe={root:Uxe,colorScheme:jxe},Hxe={borderRadius:"{content.border.radius}"},Wxe={light:{root:{background:"{surface.200}",animationBackground:"rgba(255,255,255,0.4)"}},dark:{root:{background:"rgba(255, 255, 255, 0.06)",animationBackground:"rgba(255, 255, 255, 0.04)"}}},qxe={root:Hxe,colorScheme:Wxe},Kxe={transitionDuration:"{transition.duration}"},Zxe={background:"{content.border.color}",borderRadius:"{content.border.radius}",size:"3px"},Xxe={background:"{primary.color}"},Yxe={width:"20px",height:"20px",borderRadius:"50%",background:"{content.border.color}",hoverBackground:"{content.border.color}",content:{borderRadius:"50%",hoverBackground:"{content.background}",width:"16px",height:"16px",shadow:"0px 0.5px 0px 0px rgba(0, 0, 0, 0.08), 0px 1px 1px 0px rgba(0, 0, 0, 0.14)"},focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},Jxe={light:{handle:{content:{background:"{surface.0}"}}},dark:{handle:{content:{background:"{surface.950}"}}}},Qxe={root:Kxe,track:Zxe,range:Xxe,handle:Yxe,colorScheme:Jxe},ewe={gap:"0.5rem",transitionDuration:"{transition.duration}"},twe={root:ewe},nwe={borderRadius:"{form.field.border.radius}",roundedBorderRadius:"2rem",raisedShadow:"0 3px 1px -2px rgba(0, 0, 0, 0.2), 0 2px 2px 0 rgba(0, 0, 0, 0.14), 0 1px 5px 0 rgba(0, 0, 0, 0.12)"},rwe={root:nwe},iwe={background:"{content.background}",borderColor:"{content.border.color}",color:"{content.color}",transitionDuration:"{transition.duration}"},owe={background:"{content.border.color}"},swe={size:"24px",background:"transparent",borderRadius:"{content.border.radius}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},awe={root:iwe,gutter:owe,handle:swe},lwe={transitionDuration:"{transition.duration}"},cwe={background:"{content.border.color}",activeBackground:"{primary.color}",margin:"0 0 0 1.625rem",size:"2px"},uwe={padding:"0.5rem",gap:"1rem"},dwe={padding:"0",borderRadius:"{content.border.radius}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"},gap:"0.5rem"},hwe={color:"{text.muted.color}",activeColor:"{primary.color}",fontWeight:"500"},fwe={background:"{content.background}",activeBackground:"{content.background}",borderColor:"{content.border.color}",activeBorderColor:"{content.border.color}",color:"{text.muted.color}",activeColor:"{primary.color}",size:"2rem",fontSize:"1.143rem",fontWeight:"500",borderRadius:"50%",shadow:"0px 0.5px 0px 0px rgba(0, 0, 0, 0.06), 0px 1px 1px 0px rgba(0, 0, 0, 0.12)"},pwe={padding:"0.875rem 0.5rem 1.125rem 0.5rem"},mwe={background:"{content.background}",color:"{content.color}",padding:"0",indent:"1rem"},gwe={root:lwe,separator:cwe,step:uwe,stepHeader:dwe,stepTitle:hwe,stepNumber:fwe,steppanels:pwe,steppanel:mwe},_we={transitionDuration:"{transition.duration}"},ywe={background:"{content.border.color}"},vwe={borderRadius:"{content.border.radius}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"},gap:"0.5rem"},bwe={color:"{text.muted.color}",activeColor:"{primary.color}",fontWeight:"500"},xwe={background:"{content.background}",activeBackground:"{content.background}",borderColor:"{content.border.color}",activeBorderColor:"{content.border.color}",color:"{text.muted.color}",activeColor:"{primary.color}",size:"2rem",fontSize:"1.143rem",fontWeight:"500",borderRadius:"50%",shadow:"0px 0.5px 0px 0px rgba(0, 0, 0, 0.06), 0px 1px 1px 0px rgba(0, 0, 0, 0.12)"},wwe={root:_we,separator:ywe,itemLink:vwe,itemLabel:bwe,itemNumber:xwe},Twe={transitionDuration:"{transition.duration}"},Swe={borderWidth:"0 0 1px 0",background:"{content.background}",borderColor:"{content.border.color}"},Ewe={background:"transparent",hoverBackground:"transparent",activeBackground:"transparent",borderWidth:"0 0 1px 0",borderColor:"{content.border.color}",hoverBorderColor:"{content.border.color}",activeBorderColor:"{primary.color}",color:"{text.muted.color}",hoverColor:"{text.color}",activeColor:"{primary.color}",padding:"1rem 1.125rem",fontWeight:"600",margin:"0 0 -1px 0",gap:"0.5rem",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},Cwe={color:"{text.muted.color}",hoverColor:"{text.color}",activeColor:"{primary.color}"},Iwe={height:"1px",bottom:"-1px",background:"{primary.color}"},Awe={root:Twe,tablist:Swe,item:Ewe,itemIcon:Cwe,activeBar:Iwe},Pwe={transitionDuration:"{transition.duration}"},Rwe={borderWidth:"0 0 1px 0",background:"{content.background}",borderColor:"{content.border.color}"},kwe={background:"transparent",hoverBackground:"transparent",activeBackground:"transparent",borderWidth:"0 0 1px 0",borderColor:"{content.border.color}",hoverBorderColor:"{content.border.color}",activeBorderColor:"{primary.color}",color:"{text.muted.color}",hoverColor:"{text.color}",activeColor:"{primary.color}",padding:"1rem 1.125rem",fontWeight:"600",margin:"0 0 -1px 0",gap:"0.5rem",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"-1px",shadow:"{focus.ring.shadow}"}},Owe={background:"{content.background}",color:"{content.color}",padding:"0.875rem 1.125rem 1.125rem 1.125rem",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"inset {focus.ring.shadow}"}},Mwe={background:"{content.background}",color:"{text.muted.color}",hoverColor:"{text.color}",width:"2.5rem",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"-1px",shadow:"{focus.ring.shadow}"}},Dwe={height:"1px",bottom:"-1px",background:"{primary.color}"},Lwe={light:{navButton:{shadow:"0px 0px 10px 50px rgba(255, 255, 255, 0.6)"}},dark:{navButton:{shadow:"0px 0px 10px 50px color-mix(in srgb, {content.background}, transparent 50%)"}}},zwe={root:Pwe,tablist:Rwe,tab:kwe,tabpanel:Owe,navButton:Mwe,activeBar:Dwe,colorScheme:Lwe},Fwe={transitionDuration:"{transition.duration}"},Bwe={background:"{content.background}",borderColor:"{content.border.color}"},Nwe={borderColor:"{content.border.color}",activeBorderColor:"{primary.color}",color:"{text.muted.color}",hoverColor:"{text.color}",activeColor:"{primary.color}"},Vwe={background:"{content.background}",color:"{content.color}"},$we={background:"{content.background}",color:"{text.muted.color}",hoverColor:"{text.color}"},Uwe={light:{navButton:{shadow:"0px 0px 10px 50px rgba(255, 255, 255, 0.6)"}},dark:{navButton:{shadow:"0px 0px 10px 50px color-mix(in srgb, {content.background}, transparent 50%)"}}},jwe={root:Fwe,tabList:Bwe,tab:Nwe,tabPanel:Vwe,navButton:$we,colorScheme:Uwe},Gwe={fontSize:"0.875rem",fontWeight:"700",padding:"0.25rem 0.5rem",gap:"0.25rem",borderRadius:"{content.border.radius}",roundedBorderRadius:"{border.radius.xl}"},Hwe={size:"0.75rem"},Wwe={light:{primary:{background:"{primary.100}",color:"{primary.700}"},secondary:{background:"{surface.100}",color:"{surface.600}"},success:{background:"{green.100}",color:"{green.700}"},info:{background:"{sky.100}",color:"{sky.700}"},warn:{background:"{orange.100}",color:"{orange.700}"},danger:{background:"{red.100}",color:"{red.700}"},contrast:{background:"{surface.950}",color:"{surface.0}"}},dark:{primary:{background:"color-mix(in srgb, {primary.500}, transparent 84%)",color:"{primary.300}"},secondary:{background:"{surface.800}",color:"{surface.300}"},success:{background:"color-mix(in srgb, {green.500}, transparent 84%)",color:"{green.300}"},info:{background:"color-mix(in srgb, {sky.500}, transparent 84%)",color:"{sky.300}"},warn:{background:"color-mix(in srgb, {orange.500}, transparent 84%)",color:"{orange.300}"},danger:{background:"color-mix(in srgb, {red.500}, transparent 84%)",color:"{red.300}"},contrast:{background:"{surface.0}",color:"{surface.950}"}}},qwe={root:Gwe,icon:Hwe,colorScheme:Wwe},Kwe={background:"{form.field.background}",borderColor:"{form.field.border.color}",color:"{form.field.color}",height:"18rem",padding:"{form.field.padding.y} {form.field.padding.x}",borderRadius:"{form.field.border.radius}"},Zwe={gap:"0.25rem"},Xwe={margin:"2px 0"},Ywe={root:Kwe,prompt:Zwe,commandResponse:Xwe},Jwe={background:"{form.field.background}",disabledBackground:"{form.field.disabled.background}",filledBackground:"{form.field.filled.background}",filledHoverBackground:"{form.field.filled.hover.background}",filledFocusBackground:"{form.field.filled.focus.background}",borderColor:"{form.field.border.color}",hoverBorderColor:"{form.field.hover.border.color}",focusBorderColor:"{form.field.focus.border.color}",invalidBorderColor:"{form.field.invalid.border.color}",color:"{form.field.color}",disabledColor:"{form.field.disabled.color}",placeholderColor:"{form.field.placeholder.color}",invalidPlaceholderColor:"{form.field.invalid.placeholder.color}",shadow:"{form.field.shadow}",paddingX:"{form.field.padding.x}",paddingY:"{form.field.padding.y}",borderRadius:"{form.field.border.radius}",focusRing:{width:"{form.field.focus.ring.width}",style:"{form.field.focus.ring.style}",color:"{form.field.focus.ring.color}",offset:"{form.field.focus.ring.offset}",shadow:"{form.field.focus.ring.shadow}"},transitionDuration:"{form.field.transition.duration}",sm:{fontSize:"{form.field.sm.font.size}",paddingX:"{form.field.sm.padding.x}",paddingY:"{form.field.sm.padding.y}"},lg:{fontSize:"{form.field.lg.font.size}",paddingX:"{form.field.lg.padding.x}",paddingY:"{form.field.lg.padding.y}"}},Qwe={root:Jwe},eTe={background:"{content.background}",borderColor:"{content.border.color}",color:"{content.color}",borderRadius:"{content.border.radius}",shadow:"{overlay.navigation.shadow}",transitionDuration:"{transition.duration}"},tTe={padding:"{navigation.list.padding}",gap:"{navigation.list.gap}"},nTe={focusBackground:"{navigation.item.focus.background}",activeBackground:"{navigation.item.active.background}",color:"{navigation.item.color}",focusColor:"{navigation.item.focus.color}",activeColor:"{navigation.item.active.color}",padding:"{navigation.item.padding}",borderRadius:"{navigation.item.border.radius}",gap:"{navigation.item.gap}",icon:{color:"{navigation.item.icon.color}",focusColor:"{navigation.item.icon.focus.color}",activeColor:"{navigation.item.icon.active.color}"}},rTe={mobileIndent:"1rem"},iTe={size:"{navigation.submenu.icon.size}",color:"{navigation.submenu.icon.color}",focusColor:"{navigation.submenu.icon.focus.color}",activeColor:"{navigation.submenu.icon.active.color}"},oTe={borderColor:"{content.border.color}"},sTe={root:eTe,list:tTe,item:nTe,submenu:rTe,submenuIcon:iTe,separator:oTe},aTe={minHeight:"5rem"},lTe={eventContent:{padding:"1rem 0"}},cTe={eventContent:{padding:"0 1rem"}},uTe={size:"1.125rem",borderRadius:"50%",borderWidth:"2px",background:"{content.background}",borderColor:"{content.border.color}",content:{borderRadius:"50%",size:"0.375rem",background:"{primary.color}",insetShadow:"0px 0.5px 0px 0px rgba(0, 0, 0, 0.06), 0px 1px 1px 0px rgba(0, 0, 0, 0.12)"}},dTe={color:"{content.border.color}",size:"2px"},hTe={event:aTe,horizontal:lTe,vertical:cTe,eventMarker:uTe,eventConnector:dTe},fTe={width:"25rem",borderRadius:"{content.border.radius}",borderWidth:"1px",transitionDuration:"{transition.duration}"},pTe={size:"1.125rem"},mTe={padding:"{overlay.popover.padding}",gap:"0.5rem"},gTe={gap:"0.5rem"},_Te={fontWeight:"500",fontSize:"1rem"},yTe={fontWeight:"500",fontSize:"0.875rem"},vTe={width:"1.75rem",height:"1.75rem",borderRadius:"50%",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",offset:"{focus.ring.offset}"}},bTe={size:"1rem"},xTe={light:{root:{blur:"1.5px"},info:{background:"color-mix(in srgb, {blue.50}, transparent 5%)",borderColor:"{blue.200}",color:"{blue.600}",detailColor:"{surface.700}",shadow:"0px 4px 8px 0px color-mix(in srgb, {blue.500}, transparent 96%)",closeButton:{hoverBackground:"{blue.100}",focusRing:{color:"{blue.600}",shadow:"none"}}},success:{background:"color-mix(in srgb, {green.50}, transparent 5%)",borderColor:"{green.200}",color:"{green.600}",detailColor:"{surface.700}",shadow:"0px 4px 8px 0px color-mix(in srgb, {green.500}, transparent 96%)",closeButton:{hoverBackground:"{green.100}",focusRing:{color:"{green.600}",shadow:"none"}}},warn:{background:"color-mix(in srgb,{yellow.50}, transparent 5%)",borderColor:"{yellow.200}",color:"{yellow.600}",detailColor:"{surface.700}",shadow:"0px 4px 8px 0px color-mix(in srgb, {yellow.500}, transparent 96%)",closeButton:{hoverBackground:"{yellow.100}",focusRing:{color:"{yellow.600}",shadow:"none"}}},error:{background:"color-mix(in srgb, {red.50}, transparent 5%)",borderColor:"{red.200}",color:"{red.600}",detailColor:"{surface.700}",shadow:"0px 4px 8px 0px color-mix(in srgb, {red.500}, transparent 96%)",closeButton:{hoverBackground:"{red.100}",focusRing:{color:"{red.600}",shadow:"none"}}},secondary:{background:"{surface.100}",borderColor:"{surface.200}",color:"{surface.600}",detailColor:"{surface.700}",shadow:"0px 4px 8px 0px color-mix(in srgb, {surface.500}, transparent 96%)",closeButton:{hoverBackground:"{surface.200}",focusRing:{color:"{surface.600}",shadow:"none"}}},contrast:{background:"{surface.900}",borderColor:"{surface.950}",color:"{surface.50}",detailColor:"{surface.0}",shadow:"0px 4px 8px 0px color-mix(in srgb, {surface.950}, transparent 96%)",closeButton:{hoverBackground:"{surface.800}",focusRing:{color:"{surface.50}",shadow:"none"}}}},dark:{root:{blur:"10px"},info:{background:"color-mix(in srgb, {blue.500}, transparent 84%)",borderColor:"color-mix(in srgb, {blue.700}, transparent 64%)",color:"{blue.500}",detailColor:"{surface.0}",shadow:"0px 4px 8px 0px color-mix(in srgb, {blue.500}, transparent 96%)",closeButton:{hoverBackground:"rgba(255, 255, 255, 0.05)",focusRing:{color:"{blue.500}",shadow:"none"}}},success:{background:"color-mix(in srgb, {green.500}, transparent 84%)",borderColor:"color-mix(in srgb, {green.700}, transparent 64%)",color:"{green.500}",detailColor:"{surface.0}",shadow:"0px 4px 8px 0px color-mix(in srgb, {green.500}, transparent 96%)",closeButton:{hoverBackground:"rgba(255, 255, 255, 0.05)",focusRing:{color:"{green.500}",shadow:"none"}}},warn:{background:"color-mix(in srgb, {yellow.500}, transparent 84%)",borderColor:"color-mix(in srgb, {yellow.700}, transparent 64%)",color:"{yellow.500}",detailColor:"{surface.0}",shadow:"0px 4px 8px 0px color-mix(in srgb, {yellow.500}, transparent 96%)",closeButton:{hoverBackground:"rgba(255, 255, 255, 0.05)",focusRing:{color:"{yellow.500}",shadow:"none"}}},error:{background:"color-mix(in srgb, {red.500}, transparent 84%)",borderColor:"color-mix(in srgb, {red.700}, transparent 64%)",color:"{red.500}",detailColor:"{surface.0}",shadow:"0px 4px 8px 0px color-mix(in srgb, {red.500}, transparent 96%)",closeButton:{hoverBackground:"rgba(255, 255, 255, 0.05)",focusRing:{color:"{red.500}",shadow:"none"}}},secondary:{background:"{surface.800}",borderColor:"{surface.700}",color:"{surface.300}",detailColor:"{surface.0}",shadow:"0px 4px 8px 0px color-mix(in srgb, {surface.500}, transparent 96%)",closeButton:{hoverBackground:"{surface.700}",focusRing:{color:"{surface.300}",shadow:"none"}}},contrast:{background:"{surface.0}",borderColor:"{surface.100}",color:"{surface.950}",detailColor:"{surface.950}",shadow:"0px 4px 8px 0px color-mix(in srgb, {surface.950}, transparent 96%)",closeButton:{hoverBackground:"{surface.100}",focusRing:{color:"{surface.950}",shadow:"none"}}}}},wTe={root:fTe,icon:pTe,content:mTe,text:gTe,summary:_Te,detail:yTe,closeButton:vTe,closeIcon:bTe,colorScheme:xTe},TTe={padding:"0.25rem",borderRadius:"{content.border.radius}",gap:"0.5rem",fontWeight:"500",disabledBackground:"{form.field.disabled.background}",disabledBorderColor:"{form.field.disabled.background}",disabledColor:"{form.field.disabled.color}",invalidBorderColor:"{form.field.invalid.border.color}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"},transitionDuration:"{form.field.transition.duration}",sm:{fontSize:"{form.field.sm.font.size}",padding:"0.25rem"},lg:{fontSize:"{form.field.lg.font.size}",padding:"0.25rem"}},STe={disabledColor:"{form.field.disabled.color}"},ETe={padding:"0.25rem 0.75rem",borderRadius:"{content.border.radius}",checkedShadow:"0px 1px 2px 0px rgba(0, 0, 0, 0.02), 0px 1px 2px 0px rgba(0, 0, 0, 0.04)",sm:{padding:"0.25rem 0.75rem"},lg:{padding:"0.25rem 0.75rem"}},CTe={light:{root:{background:"{surface.100}",checkedBackground:"{surface.100}",hoverBackground:"{surface.100}",borderColor:"{surface.100}",color:"{surface.500}",hoverColor:"{surface.700}",checkedColor:"{surface.900}",checkedBorderColor:"{surface.100}"},content:{checkedBackground:"{surface.0}"},icon:{color:"{surface.500}",hoverColor:"{surface.700}",checkedColor:"{surface.900}"}},dark:{root:{background:"{surface.950}",checkedBackground:"{surface.950}",hoverBackground:"{surface.950}",borderColor:"{surface.950}",color:"{surface.400}",hoverColor:"{surface.300}",checkedColor:"{surface.0}",checkedBorderColor:"{surface.950}"},content:{checkedBackground:"{surface.800}"},icon:{color:"{surface.400}",hoverColor:"{surface.300}",checkedColor:"{surface.0}"}}},ITe={root:TTe,icon:STe,content:ETe,colorScheme:CTe},ATe={width:"2.5rem",height:"1.5rem",borderRadius:"30px",gap:"0.25rem",shadow:"{form.field.shadow}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"},borderWidth:"1px",borderColor:"transparent",hoverBorderColor:"transparent",checkedBorderColor:"transparent",checkedHoverBorderColor:"transparent",invalidBorderColor:"{form.field.invalid.border.color}",transitionDuration:"{form.field.transition.duration}",slideDuration:"0.2s"},PTe={borderRadius:"50%",size:"1rem"},RTe={light:{root:{background:"{surface.300}",disabledBackground:"{form.field.disabled.background}",hoverBackground:"{surface.400}",checkedBackground:"{primary.color}",checkedHoverBackground:"{primary.hover.color}"},handle:{background:"{surface.0}",disabledBackground:"{form.field.disabled.color}",hoverBackground:"{surface.0}",checkedBackground:"{surface.0}",checkedHoverBackground:"{surface.0}",color:"{text.muted.color}",hoverColor:"{text.color}",checkedColor:"{primary.color}",checkedHoverColor:"{primary.hover.color}"}},dark:{root:{background:"{surface.700}",disabledBackground:"{surface.600}",hoverBackground:"{surface.600}",checkedBackground:"{primary.color}",checkedHoverBackground:"{primary.hover.color}"},handle:{background:"{surface.400}",disabledBackground:"{surface.900}",hoverBackground:"{surface.300}",checkedBackground:"{surface.900}",checkedHoverBackground:"{surface.900}",color:"{surface.900}",hoverColor:"{surface.800}",checkedColor:"{primary.color}",checkedHoverColor:"{primary.hover.color}"}}},kTe={root:ATe,handle:PTe,colorScheme:RTe},OTe={background:"{content.background}",borderColor:"{content.border.color}",borderRadius:"{content.border.radius}",color:"{content.color}",gap:"0.5rem",padding:"0.75rem"},MTe={root:OTe},DTe={maxWidth:"12.5rem",gutter:"0.25rem",shadow:"{overlay.popover.shadow}",padding:"0.5rem 0.75rem",borderRadius:"{overlay.popover.border.radius}"},LTe={light:{root:{background:"{surface.700}",color:"{surface.0}"}},dark:{root:{background:"{surface.700}",color:"{surface.0}"}}},zTe={root:DTe,colorScheme:LTe},FTe={background:"{content.background}",color:"{content.color}",padding:"1rem",gap:"2px",indent:"1rem",transitionDuration:"{transition.duration}"},BTe={padding:"0.25rem 0.5rem",borderRadius:"{content.border.radius}",hoverBackground:"{content.hover.background}",selectedBackground:"{highlight.background}",color:"{text.color}",hoverColor:"{text.hover.color}",selectedColor:"{highlight.color}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"-1px",shadow:"{focus.ring.shadow}"},gap:"0.25rem"},NTe={color:"{text.muted.color}",hoverColor:"{text.hover.muted.color}",selectedColor:"{highlight.color}"},VTe={borderRadius:"50%",size:"1.75rem",hoverBackground:"{content.hover.background}",selectedHoverBackground:"{content.background}",color:"{text.muted.color}",hoverColor:"{text.hover.muted.color}",selectedHoverColor:"{primary.color}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},$Te={size:"2rem"},UTe={margin:"0 0 0.5rem 0"},jTe={root:FTe,node:BTe,nodeIcon:NTe,nodeToggleButton:VTe,loadingIcon:$Te,filter:UTe},GTe={background:"{form.field.background}",disabledBackground:"{form.field.disabled.background}",filledBackground:"{form.field.filled.background}",filledHoverBackground:"{form.field.filled.hover.background}",filledFocusBackground:"{form.field.filled.focus.background}",borderColor:"{form.field.border.color}",hoverBorderColor:"{form.field.hover.border.color}",focusBorderColor:"{form.field.focus.border.color}",invalidBorderColor:"{form.field.invalid.border.color}",color:"{form.field.color}",disabledColor:"{form.field.disabled.color}",placeholderColor:"{form.field.placeholder.color}",invalidPlaceholderColor:"{form.field.invalid.placeholder.color}",shadow:"{form.field.shadow}",paddingX:"{form.field.padding.x}",paddingY:"{form.field.padding.y}",borderRadius:"{form.field.border.radius}",focusRing:{width:"{form.field.focus.ring.width}",style:"{form.field.focus.ring.style}",color:"{form.field.focus.ring.color}",offset:"{form.field.focus.ring.offset}",shadow:"{form.field.focus.ring.shadow}"},transitionDuration:"{form.field.transition.duration}",sm:{fontSize:"{form.field.sm.font.size}",paddingX:"{form.field.sm.padding.x}",paddingY:"{form.field.sm.padding.y}"},lg:{fontSize:"{form.field.lg.font.size}",paddingX:"{form.field.lg.padding.x}",paddingY:"{form.field.lg.padding.y}"}},HTe={width:"2.5rem",color:"{form.field.icon.color}"},WTe={background:"{overlay.select.background}",borderColor:"{overlay.select.border.color}",borderRadius:"{overlay.select.border.radius}",color:"{overlay.select.color}",shadow:"{overlay.select.shadow}"},qTe={padding:"{list.padding}"},KTe={padding:"{list.option.padding}"},ZTe={borderRadius:"{border.radius.sm}"},XTe={color:"{form.field.icon.color}"},YTe={root:GTe,dropdown:HTe,overlay:WTe,tree:qTe,emptyMessage:KTe,chip:ZTe,clearIcon:XTe},JTe={transitionDuration:"{transition.duration}"},QTe={background:"{content.background}",borderColor:"{treetable.border.color}",color:"{content.color}",borderWidth:"0 0 1px 0",padding:"0.75rem 1rem"},eSe={background:"{content.background}",hoverBackground:"{content.hover.background}",selectedBackground:"{highlight.background}",borderColor:"{treetable.border.color}",color:"{content.color}",hoverColor:"{content.hover.color}",selectedColor:"{highlight.color}",gap:"0.5rem",padding:"0.75rem 1rem",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"-1px",shadow:"{focus.ring.shadow}"}},tSe={fontWeight:"600"},nSe={background:"{content.background}",hoverBackground:"{content.hover.background}",selectedBackground:"{highlight.background}",color:"{content.color}",hoverColor:"{content.hover.color}",selectedColor:"{highlight.color}",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"-1px",shadow:"{focus.ring.shadow}"}},rSe={borderColor:"{treetable.border.color}",padding:"0.75rem 1rem",gap:"0.5rem"},iSe={background:"{content.background}",borderColor:"{treetable.border.color}",color:"{content.color}",padding:"0.75rem 1rem"},oSe={fontWeight:"600"},sSe={background:"{content.background}",borderColor:"{treetable.border.color}",color:"{content.color}",borderWidth:"0 0 1px 0",padding:"0.75rem 1rem"},aSe={width:"0.5rem"},lSe={width:"1px",color:"{primary.color}"},cSe={color:"{text.muted.color}",hoverColor:"{text.hover.muted.color}",size:"0.875rem"},uSe={size:"2rem"},dSe={hoverBackground:"{content.hover.background}",selectedHoverBackground:"{content.background}",color:"{text.muted.color}",hoverColor:"{text.color}",selectedHoverColor:"{primary.color}",size:"1.75rem",borderRadius:"50%",focusRing:{width:"{focus.ring.width}",style:"{focus.ring.style}",color:"{focus.ring.color}",offset:"{focus.ring.offset}",shadow:"{focus.ring.shadow}"}},hSe={borderColor:"{content.border.color}",borderWidth:"0 0 1px 0"},fSe={borderColor:"{content.border.color}",borderWidth:"0 0 1px 0"},pSe={light:{root:{borderColor:"{content.border.color}"},bodyCell:{selectedBorderColor:"{primary.100}"}},dark:{root:{borderColor:"{surface.800}"},bodyCell:{selectedBorderColor:"{primary.900}"}}},mSe={root:JTe,header:QTe,headerCell:eSe,columnTitle:tSe,row:nSe,bodyCell:rSe,footerCell:iSe,columnFooter:oSe,footer:sSe,columnResizer:aSe,resizeIndicator:lSe,sortIcon:cSe,loadingIcon:uSe,nodeToggleButton:dSe,paginatorTop:hSe,paginatorBottom:fSe,colorScheme:pSe},gSe={mask:{background:"{content.background}",color:"{text.muted.color}"},icon:{size:"2rem"}},_Se={loader:gSe},ySe=Object.defineProperty,vSe=Object.defineProperties,bSe=Object.getOwnPropertyDescriptors,m4=Object.getOwnPropertySymbols,xSe=Object.prototype.hasOwnProperty,wSe=Object.prototype.propertyIsEnumerable,g4=(t,e,n)=>e in t?ySe(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,_4,TSe=(_4=((t,e)=>{for(var n in e||(e={}))xSe.call(e,n)&&g4(t,n,e[n]);if(m4)for(var n of m4(e))wSe.call(e,n)&&g4(t,n,e[n]);return t})({},z_e),vSe(_4,bSe({components:{accordion:u_e,autocomplete:b_e,avatar:C_e,badge:M_e,blockui:B_e,breadcrumb:U_e,button:H_e,card:Y_e,carousel:rye,cascadeselect:uye,checkbox:fye,chip:vye,colorpicker:Sye,confirmdialog:Iye,confirmpopup:Oye,contextmenu:Nye,datatable:ove,dataview:hve,datepicker:Ove,dialog:Bve,divider:jve,dock:Wve,drawer:Jve,editor:i0e,fieldset:c0e,fileupload:_0e,floatlabel:w0e,galleria:F0e,iconfield:N0e,iftalabel:U0e,image:q0e,imagecompare:Z0e,inlinemessage:ebe,inplace:rbe,inputchips:abe,inputgroup:cbe,inputnumber:fbe,inputotp:gbe,inputtext:ybe,knob:Tbe,listbox:kbe,megamenu:$be,menu:qbe,menubar:e1e,message:u1e,metergroup:_1e,multiselect:I1e,orderlist:R1e,organizationchart:L1e,overlaybadge:F1e,paginator:U1e,panel:Z1e,panelmenu:txe,password:axe,picklist:uxe,popover:fxe,progressbar:_xe,progressspinner:vxe,radiobutton:wxe,rating:Exe,ripple:Ixe,scrollpanel:kxe,select:$xe,selectbutton:Gxe,skeleton:qxe,slider:Qxe,speeddial:twe,splitbutton:rwe,splitter:awe,stepper:gwe,steps:wwe,tabmenu:Awe,tabs:zwe,tabview:jwe,tag:qwe,terminal:Ywe,textarea:Qwe,tieredmenu:sTe,timeline:hTe,toast:wTe,togglebutton:ITe,toggleswitch:kTe,toolbar:MTe,tooltip:zTe,tree:jTe,treeselect:YTe,treetable:mSe,virtualscroller:_Se}})));const Mp=aG(HQ);Mp.use(Yde());Mp.use(iV);Mp.use(o_e,{theme:{preset:TSe}});Mp.component("Chart",dP);Mp.component("DataTable",$w);Mp.component("Column",na);Mp.mount("#app");
